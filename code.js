//////////////////////////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////////////////////////

//Initialize variables and data structure

//////////////////////////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////////////////////////

var debug = false;

data.weaponTypes = ["sword","lance","axe","redtome","bluetome","greentome","graytome","dragon","bow","dagger","staff","beast"];
data.rangedWeapons = ["redtome","bluetome","greentome","graytome","bow","dagger","staff"];
data.meleeWeapons = ["sword","lance","axe","dragon","beast"];
data.physicalWeapons = ["sword","lance","axe","bow","dagger","beast"];
data.magicalWeapons = ["redtome","bluetome","greentome","graytome","dragon","staff"];
data.moveTypes = ["infantry","armored","flying","cavalry"];
data.colors = ["red","blue","green","gray"];
data.skillSlots = ["weapon","special","a","b","c","s","x"];
data.buffTypes = ["buffs","debuffs","spur"];
data.buffStats = ["atk","spd","def","res"];
data.stats = ["hp","atk","spd","def","res"];
data.defensiveSpecials = ["Buckler","Holy Vestments","Escutcheon","Pavise","Sacred Cowl","Aegis","Miracle","Ice Mirror","Ice Mirror 2","Life Unending","Godlike Reflexes","Frostbite Mirror","Negating Fang","Negating Fang 2","Dual Ice Mirrors","Life Unending 2"];
data.gaeSpecials = ["Galeforce","Njorun's Zeal","Njorun's Zeal 2"];
data.AOESpecials = ["Rising Thunder","Rising Wind","Rising Light","Rising Flame","Growing Thunder","Growing Wind","Growing Light","Growing Flame","Gifted Magic 2","Gift for Magic"];
data.AOEMultiSpecials = ["Blazing Thunder","Blazing Wind","Blazing Light","Blazing Flame","Override"];
data.upgradedBreath = ["Flametongue","Lightning Breath","Light Breath","Dark Breath","Flametongue+","Lightning Breath+","Light Breath+","Dark Breath+"];
data.killerWeapon = ["Killing Edge","Killing Edge+","Killer Lance","Killer Lance+","Killer Axe","Killer Axe+","Killer Bow","Killer Bow+","Slaying Edge","Slaying Edge+","Slaying Lance","Slaying Lance+","Slaying Axe","Slaying Axe+","Slaying Bow","Slaying Bow+","Kagami Mochi","Kagami Mochi+","Barb Shuriken","Barb Shuriken+","Mystletainn","Dark Mystletainn","Hauteclere","Urvan","Cursed Lance","Audhulma","Basilikos","Berserk Armads","Nameless Blade","Mjolnir","Vassal's Blade","Dauntless Lance","Maltet","Missiletainn","Victorious Axe","Hoarfrost Knife","Solitary Blade","Missiletain","Golden Dagger","Shanna's Lance","Draconic Rage","Scarlet Sword","Whitewing Lance","Festive Siegmund","Wolf Queen Fang","Grado Poleax","Niles's Bow","Peri's Lance","Daybreak Lance","Shadow Sword","Loyal Greatlance","Creator Sword","Beruka's Axe","Hunting Blade","Scythe of Sariel","Sable Lance","Ethereal Breath","Guardian's Axe","Golden Naginata","Prized Lance","Guardian's Bow","Knightly Lance","Mareeta's Sword","Vouge","New Foxkit Fang","Imbued Koma","Larcei's Edge","Rebecca's Bow","Thorn Lance","Hades O","Bun-Bun Baton","Rinkah's Club","Winds of Change","Dragoon Axe","Weighted Lance","Bow of Beauty","Bride's Fang","Amatsu","Summer Strikers","Crimson Axe","Sun's Percussors","Blade of Shadow","Spear of Shadow","Hel's Reaper","Sky-Pirate Claw","Gate-Anchor Axe","Flower Hauteclere","Wind Parthia","Daniel-Made Bow","Primordial Breath","Double Bow","Talregan Axe","Survivalist Bow","Areadbhar","Tailwind Shuriken","Tiger-Roar Axe","Studied Forblaze","Renewed Fang","Grafcalibur","Fell Flambeau","Spy-Song Bow","Loyalist Axe","Failnaught","Luin","Gullinkambi Egg","Lilac-Jade Breath","Shamshir","Hotshot Lance","Lance of Frelia","Blade of Renais","Bow of Frelia","Hallowed Tyrfing","Axe of Despair","Twin-Crest Power","Wedding-Bell Axe","Professorial Text","Fair-Fury Axe","Holy Yewfelle","Sea-Sear Lance","Crossbones Claw","Genesis Falchion","Binding Reginleif","Whirling Grace","Bow of Twelve","Honorable Blade","Demonic Tome","Moonstrike Breath","Eerie Scripture","Spendy Scimitar","Nifl's Bite","Fanged Basilikos","Kaze's Needle","Fireman's Hook","Flame of Muspell","War-God Mjolnir","Lioness Blade","Horn of Opening","Sweet Yule Log","Professorial Guide","Jotnar Bow","Blade of Jehanna","Argent Aura","Royal Hatari Fang","Dryblade Lance","Achimenes Furl","Destiny's Bow","Bow of Verdane","Dew Dragonstone","Bright-Shell Egg","Magic Rabbits","Ascending Blade","Sharp War Sword","Adroit War Tome","Thunderer Tome","Thunder's Mjolnir","Headsman Glitnir","Ruinous Frost","True-Love Roses","Blazing Polearms","Godly Breath","New-Height Bow","Unyielding Oar","Moonlight Drop","Frozen Delight","Regal Sunshade","Ebon Bolverk","Caring Conch","Chilled Breath","Divine Whimsy","Mila's Testament","Illuminating Horn","Wanderer Blade","Soothing Scent","Inner Wellspring","Holytide Tyrfing","Remote Breath","Geirdriful","Spirit Forest Writ","Firelight Lance","Breath of Flame","Kindling Taiko","Wind Genesis","Fuming Freikugel","Arcane Eljudnir","Moonlight Stone","Starlight Stone","Ghostly Lanterns","Arcane Grima","Blade of Favors","Everliving Ymir","Rite of Souls","Flowery Scroll","Flamefrost Bow","Arcane Downfall","Coyote's Lance","Awoken Breath","Enclosing Dark","Enclosing Claw","Arcane Eclipse","Prodigy Polearm","Seidr","Solemn Axe","Inseverable Spear","Heralding Horn","Fang of Finality","Keen Rabbit Fang","Duality Vessel","Child's Compass","Crow's Crystal","Guide's Hourglass","Celestial Globe","Arcane Qiang","Joyous Tome","Dreaming Spear","Liberation","Ravager","Brilliant Starlight","Dawnsweet Box","Duskbloom Bow","Dusk-Dawn Staff","Queenslance","Crimean Scepter","Master's Tactics","Bow of Repose","Sisterly War Axe","Frelian Lance","Frelian Blade","Arcane Nastrond","Abyssal Blade","Valiant War Axe","Fiery War Sword","Gusty War Bow","Total War Tome","Lone-Wolf Blade","Revealing Breath","Arcane Luin","Horn of the Land","Revenger Lance","Captain's Sword","Sacrifice Staff","Silent Breath","Arcane Devourer","Heartbroker Bow","Chon'sin Sprig","Twin Divinestone","Fujin-Raijin Yumi","Vassal-Saint Steel","Ilian Merc Lance","Heidr","Seafoam Splitter","Partnership Bow","Radiant Aureola","Divine Draught","Ice-Bound Brand","Sparkling Sun","Fair-Fight Blade","Tome of Luxuries","Arcane Darkbow","Arcane Nihility","New Foxkit Fang 2","Dream Horn","Baked Treats","Knightly Manner","Teatime's Edge","Vallastone","Arch-Sage Tome","The Cycle's Turn","Dragon's Fist","Playful Pinwheel","Fujin Uchiwa","Brightwind Fans","Heired Forseti","Heired Yewfelle","Arcane Euphoria","Absolute Amiti","Inspirited Spear","Kitty-Cat Parasol","Arcane Caliburnus","Worldly Lance","Flower of Tribute","Flower of Caring","Obscurite","Scarlet Spear","Spy's Shuriken","Radiant Scrolls","Arcane Void","Guarding Lance","Troubling Blade","Gondul","Corsair Cleaver","Incipit Kvasir","Quietus Gullveig","Sacaen-Wolf Bow","Arcane Thrima","Striving Sword","World-Tree Tail","Silent Yule Knife","Black Yule Lance","Blue Yule Axe","Holy Yule Blade","Bewitching Tome","Cute Paper Crane","Faded Paper Fan","Goddess Temari","Thief","Repair","Arcane Thunder","Arcadian Axes","Blade of Sands","Sandglass Bow","Monarch's Stone","Hero-King Sword","Loving Breath","Righteous Lance","Tender Vessel","Axe of Adoration","Arcane Charmer","Icebound Tome","Divine One's Arts","Hippity-Hop Axe","Flingster Spear","Sky-Hopper Egg","Pure-Wing Spear","Lightburst Tome","Tender Excalibur","Emblem Ragnell","Exalt's War Staff","New War Axe","Draconic Pacts","Forager Naginata","Perspicacious","Supreme Thokk","Fell Child's Might","Dead-Crow Tome","Ereshkigal","Arcane Fellstone","Closing Florets","Wildflower Edge","United Bouquet","Hoshido's Breath","Caladbolg","Arcane Tempest","Silver of Dawn","Love of Nerthuz","Prince's Lance","Golden Sunlight","Caring Magic","Maritime Arts","Breaker Bow","Diva-Pair Parasol","Lance of Grado","Wild Wind Sword","Nidavellir Ballista","Sisterly Axe","Nectar Horn","Quieting Antler","Summertime Axe","Fluttering Fan","Exalt's Tactics","The Inexhaustible","Majestic Glitnir","Berserker Axe","Dual Sword","Ice-Tribe Axe","Ilian Frost Blade","Ice-Crystal Spear","Desert Spear","Sentinel Bow","Suave Blade","Dvergr Wayfinder","Holy-War Spear","Horn of Harvest","Hungry Cat Fang","Stone of Delights","Opposing Stones","Arcane Blutgang","Just Bow","Vedrfolnir's Edge","Quieting Claw","Scroll of Curses","Scroll of Teas","Bold Kusarigama","Ylisse Ninja Bow","Arcane Truthfire","Arcane Giant Axe","Enticing Dose","Quieting Branch","Arcane Sly Knife","Fellowship Blade","Odr of Creation","Icy Ravager","Red-Fist Blades","Snowman Staff","Wintery Arts","Lady's Bow","Snaking Sword","New Year Talon","New Year Fang","New Year Treats","Staff of Yngvi","Rampart Bow","Divine Yewfelle","Swirling Lance","Swirling Scimitar","Laconic Axe","Sword of Isaach","Blessed Aureola","Eagle's Heart","Lion's Heart","Deer's Heart","Devoted Breath","Arcane Fell Arts","Fell Slaystone","Hidden Blade","Salvage","Gentle Fell Egg","Petaldream Horn","Arcane Medusa","Prior's Tome","True-Bond Bow","Azure Twin Edge","Tome of Dusk","Axe of Dusk","Duskstone","Ancient Majesty","Fundament","Ancient Voice","Jaws of Closure","Sword of Peace"];
data.murderWeapon = ["New Levin Sword"];
data.toggleSkills = ["Royal Sword","Flame Siegmund","Forblaze","Huginn's Egg","Muninn's Egg","Chilling Seal","Hinoka's Spear","Camilla's Axe","Garm","Swift Mulagir","Thunder Armads","Laws Of Sacae","With Everyone","Blue Flame","Storm Sieglinde","Draconic Rage","Book Of Shadows","Gjoll","Freezing Seal","Festive Siegmund","Joint Hone Spd","Taguel Fang","Human Virtue","Covert Cat Fang","Brazen Cat Fang","Kriemhild","Solitary Dream","Freikugel","Scythe of Sariel","Yune's Whispers","Dracofalchion","Joint Hone Atk","Ifingr","Killing Intent","Dignified Bow","Joint Hone Def","Reginleif","Ashera's Chosen","Mareeta's Sword","Winds of Silesse","Mirage Feather","Sokkvabekkr","Deadly Balance","Frost Breath","Constant Dagger","Zephyr Breath","Aymr","Raging Storm","Flower of Ease","Joint Hone Res","Binding Necklace","Hrist","Renewed Fang","Fell Flambeau","Thjalfi","Icy Fimbulvetr","Gullinkambi Egg","Staff of Rausten","Vengeful Lance","Murderous Lion","Atk Res Menace","Atk Def Menace","Armored Wall","Chilling Seal 2","Rose-Quartz Bow","Wedding-Bell Axe","Def Res Menace","Atk Spd Menace","Sunshade Staff","Laws of Sacae 2","Raydream Horn","Dolphin-Dive Axe","Fair-Fury Axe","Domain of Ice","Surtr's Portent","Crossbones Claw","Ebon-Pirate Claw","Ostia's Pulse 2","Agnea's Arrow","Domain of Flame","Moonstrike Breath","Spendy Scimitar","Nifl's Bite","Kaze's Needle","With Everyone 2","Fireman's Hook","Flame of Muspell","Inviolable Axe","Ancient Ragnell","Carnage Amatsu","Dreamflake","Nidavellir Sprig","Jotnar Bow","Ancient Codex","Rapid-Crier Bow","Argent Aura","Royal Hatari Fang","Sinmara","Surtr's Menace","Chaos Named","Eckesachs","Elena's Staff","Gloom Breath","Valflame","Wargod's Tome","Destiny's Bow","Bow of Verdane","Hurricane Dagger","Freezing Seal 2","Dew Dragonstone","Magic Rabbits","Quick Mulagir","Sharp War Sword","Spd Res Menace","Silent Power","Wild Tiger Fang","True-Love Roses","Blazing Polearms","Godly Breath","Darkling Guardian","Demonic Breath","New-Height Bow","Jolly Jade Lance","Morph Fimbulvetr","Unyielding Oar","Spd Def Menace","Moonlight Drop","Frozen Delight","Regal Sunshade","Human Virtue 2","Caring Conch","Chilled Breath","Divine Whimsy","Mila's Testament","Everliving Domain","Illuminating Horn","Opened Domain","Divine Fang+","Shadowy Quill","Heir to Light","Breaker Lance","Spirit Forest Writ","Breath of Flame","Fuming Freikugel","Faithful Breath","Vision of Arcadia 2","Chaos Named+","Severance","Seidr","Aurgelmir","Inseverable Spear","Keen Rabbit Fang","Duality Vessel","Wary Rabbit Fang","Ashera's Chosen+","Guide's Hourglass","Celestial Globe","Arcane Qiang","Dreaming Spear","Dusk-Dawn Staff","Crimean Scepter","Sisterly War Axe","Mila's Turnwheel 2","Arcane Nastrond","Abyssal Blade","Masked Lance","Valiant War Axe","Fiery War Sword","Inborn Idealism","Total War Tome","Lone-Wolf Blade","Knightly Devotion","Asclepius","Fruit of Life","Revenger Lance","Valbar's Lance","Raging Storm 2","Deadly Balance+","Sacrifice Staff","Chon'sin Sprig","Bern's New Way","Sparkling Sun","Get Behind Me","Power of Nihility","Packleader Tome","Taguel Fang 2","Brazen Cat Fang 2","Covert Cat Fang 2","Binding Necklace+","Western Axe","Baked Treats","Desperation 4","Flow Desperation","The Cycle's Turn","Gold Unwinding","Atk Spd Pledge","Atk Spd Hexblade","Spd Res Hexblade","Def Res Ploy 3","Inspirited Spear","Atk Res Ploy 3","Flower of Tribute","Flower of Caring","Ruler of Nihility","Guarding Lance","Incipit Kvasir","Quietus Gullveig","Arcane Thrima","Grimleal Text","Faded Paper Fan","Inf Null Follow 4","Goddess Temari","Atk Spd Ploy 3","Thunder's Fist","Dragon Monarch","Flower of Sorrow","Wings of Light+","Def Res Pledge","Divine Deceit","Corrupted Dragon","Absolute Closure","Wildflower Edge","Bond Blast","Sunstone's Blade","Atk Spd Mastery","Lone Wolf","Fortifications","Ice-Tribe Axe","Suave Blade","Override","DR Twin N Save","AR Twin F Save","Spd Res Ploy 3","Spd Def Detect","AD Twin N Save","AD Twin F Save","Dark Perfume","Pulse Up Ploy","Higher Ground","Laconic Axe","Lower Ground","AR Twin N Save","Trained to Kill","Taciturn Axe","Tome of Dusk","Atk Res Detect","Axe of Dusk","Trample"];
data.toggleNumberSkills = ["Fresh Bouquet","Ardent Service","Chill Atk","Chill Spd","Chill Def","Chill Res","Atk Res Bond","Atk Def Bond","Spd Def Bond","Atk Spd Bond","Spd Res Bond","Atk Res Solo","Atk Spd Solo","Def Res Link","Spd Feint","Def Feint","Atk Def Link","Spd Res Link","Atk Spd Link","Atk Res Link","Sorcery Blade","Def Res Bond","Atk Def Solo","Kabura Ya","Kumade","Geishun","Wagasa","Atk Feint","Def Res Solo","Faithful Axe","Blarblooms","Gronnblooms","Heart's Blade","Loyal Wreath","Res Feint","Sabotage Atk","Spd Def Link","Sabotage Res","Spd Def Solo","Sudden Panic","Tropical Treats","Buoyboard","Sandfort Spade","Shoreline Rake","Scallop Blade","Big-Catch Bow","Petal Parasol","Def Res Ruse","Sabotage Def","Rouse Atk Def","Atk Spd Ruse","Spd Res Ruse","Sabotage Spd","Rouse Def Res","Fortune Bow","Temari","Spd Res Solo","Spd Def Ruse","Rouse Spd Res","Atk Def Ruse","Rouse Spd Def","Gilt Fork","Carrot Cudgel","Chill Atk Res","Chill Atk Spd","Rouse Atk Res","Chill Spd Def","Pledged Blade","Huge Fan","Spd Res Snag","Spd Def Snag","Guard Bearing","Hidden Thorns","Melon Float","Chill Spd Res","Conch Bouquet","Helm Bow","Spirited Spear","Blackfire Breath","Pale Breath","Rouse Atk Spd","Chill Atk Def","Atk Res Ruse","Candy Cane","Reindeer Bow","Atk Def Snag","Plegian Torch","Chill Def Res","Plegian Bow","Plegian Axe","DR Near Save","Unity Blooms","AR Far Save","Amity Blooms","Pact Blooms","Atk Spd Catch","Steadfast Axe","AD Near Save","Atk Spd Snag","Atk Spd Ideal","Atk Def Catch","Atk Def Ideal","Observant Staff","Love Bouquet","Love Candelabra","Atk Res Ideal","Blarrabbit","Def Res Catch","Trident","Shellpoint Lance","Steadfast Lance","Raudrrabbit","Def Res Ideal","Atk Res Catch","AR Near Save","Def Res Snag","Steadfast Sword","Snow Globe","DR Far Save","Winter Rapier","Tannenbow","Threat Atk Spd","Threat Atk Res","Threat Atk Def","Threat Spd Def","Threat Spd Res","Threat Def Res","Threaten Atk","Threaten Spd","Threaten Def","Threaten Res","Atk Ploy","Spd Ploy","Def Ploy","Res Ploy","Panic Ploy","AD Far Save","Staff of Tribute","Spd Def Ideal","Hvitrvulture","Carrot-Tip Bow","Carrot-Tip Spear","Allied Lance","Raudrvulture","Gronnvulture","Spirited Axe","Spirited Sword","Spd Def Catch","Allied Sword","Vulture Blade","Coral Saber","Seahorse Axe","Pursual Lance","Vulture Axe","Atk Res Snag","AS Near Save","Gronnrabbit","Vulture Lance","Unbound Bow","Magical Lantern","Spd Res Ideal","Protection Bow","AS Far Save","Spd Res Catch","Protection Pike","Sabotage AR","Allied Axe","Sabotage SR","Vulture Bow","Sabotage AD","Dragonbloom","Harp Bow","Blarvulture","Pursual Axe"];
data.toggleRefined = ["Cymbeline","Regal Blade","Aura","Breath Of Fog","Excalibur","Fensalir","Odin's Grimoire","Vidofnir","Gladiator's Blade","Whitewing Blade","Whitewing Lance","Whitewing Spear","Tyrfing","Grado Poleax","Dark Aura","Argent Bow","Panther Sword","Bull Spear","Loyal Greatlance","Rowdy Sword","Book of Orchids","Knightly Lance","Lordly Lance","Arthur's Axe","Laslow's Blade","Jakob's Tray","Father's Tactics","Laid-Back Blade","Veteran Lance","Dark Greatsword","Runeaxe","Stalwart Sword","Sniper's Bow","Great Flame","Bright Naginata","Setsuna's Yumi","Effie's Lance","Cursed Lance","Tome of Favors","Springtime Staff","Giga Excalibur","Spy-Song Bow","Gae Bolg","Shamshir","Flower Lance","Raijinto","Hoarfrost Knife","Stout Tomahawk","Masking Axe","Punishment Staff","Dusk Dragonstone","Sanngridr","Missiletain","Loptous","Fruit of Idunn","Summer's Breath","Spirit Breath","Sworn Lance","Cherche's Axe","Lyfjaberg","Foxkit Fang","Icy Maltet","Fell Breath","Saehrimnir","Gjallarbru","Divine Breath","Worldsea Wave","Dark Spikes T","Moon Gradivus","Virtuous Naga","Tempest's Claw","Razing Breath","Ardent Durandal","Snide Bow","Athame","Meisterbogen","Volunteer Bow","Mercurius","Sol Lance","Saintly Seraphim","Imbued Koma","Staff of Lilies","Pupil's Tome","Violdrake Bow","Desert-Tiger Axe","Father's-Son Axe",,"Foxkit Fang 2","Virtuous Tyrfing","Hel's Reaper","Hyperion Lance","Flame Battleaxe","Geirdriful"];
data.toggleOwl = ["Gronnowl+","Blarowl+","Raudrowl+","Gronnowl","Blarowl","Raudrowl","Muspell Fireposy","Nidhogg","Glittering Breath","Glittering Breath+","Goodie Boot","Goodie Boot+"];
data.toggleRefineIgnore = ["Gronnowl+", "Blarowl+", "Raudrowl+", "Gronnowl", "Blarowl", "Raudrowl","Forblaze","Hinoka's Spear","Camilla's Axe","Fresh Bouquet","Fresh Bouquet+","Ardent Service","Ardent Service+","Reese's Tome","Glittering Breath","Glittering Breath+","Goodie Boot","Goodie Boot+"];
data.toggleBothRefine = ["Weirding Tome","Inveterate Axe","Eternal Breath","Gjoll","Tome of Reason","Hikami","Azure Lance","Aversa's Night","Wind Parthia","Chaos Manifest","Oracle's Breath","Retainer's Report","Tanngrisnir","Victorious Axe","Void Tome","Starpoint Lance","Banshee TH","Silesse Frost"];
data.toggleAnyRefine = ["Sealed Falchion","Warrior Princess","Grimoire","Mjolnir","Grima's Truth","Vassal's Blade","Ninis's Ice Lance","Imhullu","Luna Arc","Bunny Fang","Hunting Blade","Flower of Joy","Guardian Fang","Creator Sword","Guardian Fang 2","Bunny Fang 2","Flower of Plenty","Dark Scripture","Sky-Pirate Claw"];
data.toggleBothPostRefine = ["Light of Dawn","Laevatein","Exalted Falchion","Byleistr","Thogn","Cunning Bow","Scepter of Love"];
data.toggleBase = [];
data.toggleStartDuring = ["Gusty War Bow","Mystic War Staff","Alarm Atk Spd","Rallying Cry","Ilian Merc Lance","Alarm Spd Def","Heidr","Alarm Atk Def","Dream Deliverer","Tip the Scales!","Pumpkin Stem","Pumpkin Stem+","Payday Pouch","Farmer's Tool","Farmer's Tool+","Worldly Lance","Obscurite","Alarm Def Res","Darkling Dragon","Hippity-Hop Axe","Doubler Bow","Doubler Bow+","Full Rabbit Fang","Doubler Sword","Doubler Sword+","Doubler Lance","Doubler Lance+"];
data.toggleStartTurn = ["Gondul","Fanged Ties","Corsair Cleaver","Blade Royale","Atk Spd Oath","Atk Def Oath","Atk Res Oath","Spd Def Oath","Spd Res Oath","Def Res Oath","Atk Oath Echo","Blade of Sands","Nabata Beacon","Nabata Lance","Carrot Bow","Pure-Wing Spear","Lightburst Tome","Heavy War Axe","Forager Naginata","Raudrlantern","Tri-Path Splitter","Beast Threaten","Ice Prince's Seal","Plegian War Axe","Order's Restraint","Order's Restraint+","Lance of Grado","Sisterly Axe","Nectar Horn","Quieting Antler","According to Plan","Majestic Glitnir","Goddess Bearer","Goddess Bearer 2","Inner Wellspring","Air Orders 4","Connected World","Vedrfolnir's Edge","Incite Atk Spd","Incite Atk Res","Light of Etruria","Brutal Ferocity","Enticing Dose","Fellowship Blade","Font of Wisdom","Delivering Antler","Lady's Bow","New Year Talon","New Year Fang","Incite Spd Def","Divine Yewfelle","I Remember...","Swirling Lance","Swirling Scimitar","Jehanna Dagger","Jehanna Dagger+","Jehanna Lance","Jehanna Lance+","Ebon Bolverk","Aerial Longsword","Lion's Heart","Deer's Heart","Gronnlantern","Salvage","Gentle Fell Egg","Mounting Fear","Hexblade Sword","True-Bond Bow","Azure Twin Edge","Divine God Fang","Atk Res Havoc","Ancient Voice"];
data.toggleRefinedStartTurn = ["Mirage Rod","Dragoon Axe","Persecution Bow","Lucky Bow","Brutal Breath","Daniel-Made Bow","Caduceus Staff","Aureola","Talregan Axe","Frostfire Breath","Wing-Lifted Spear","Sparking Tome","Twin Star Axe","Tome of Fury"];
data.toggleAnyRefinedStartTurn = ["Apotheosis Spear","Kia Staff"];
data.selfBuffSkills = ["Fresh Bouquet","Fresh Bouquet+","Ardent Service","Ardent Service+","Odin's Grimoire","Trident","Trident+","Shellpoint Lance","Shellpoint Lance+","Byleistr","Iris's Tome","Book of Orchids","Mercurius","Eternal Breath","Grima's Truth","Masking Axe","Punishment Staff","Laevatein","Wolf Berg","Def Res Link 1","Def Res Link 2","Def Res Link 3","Atk Def Link 1","Atk Def Link 2","Atk Def Link 3","Spd Res Link 1","Spd Res Link 2","Spd Res Link 3","Atk Spd Link 1","Atk Spd Link 2","Atk Spd Link 3","Atk Spd Link 4","Atk Res Link 1","Atk Res Link 2","Atk Res Link 3","With Everyone","Joint Hone Spd","Human Virtue","Spd Def Link 1","Spd Def Link 2","Spd Def Link 3","Solitary Dream","Rouse Atk Def 1","Rouse Atk Def 2","Rouse Atk Def 3","Atk Res Oath 1","Atk Res Oath 2","Atk Res Oath 3","Joint Hone Atk","Joint Hone Def","Rouse Def Res 1","Rouse Def Res 2","Rouse Def Res 3","Atk Def Oath 1","Atk Def Oath 2","Atk Def Oath 3","Atk Spd Oath 1","Atk Spd Oath 2","Atk Spd Oath 3","Def Res Oath 1","Def Res Oath 2","Def Res Oath 3","Rouse Spd Res 1","Rouse Spd Res 2","Rouse Spd Res 3","Rouse Spd Def 1","Rouse Spd Def 2","Rouse Spd Def 3","Spd Def Oath 1","Spd Def Oath 2","Spd Def Oath 3","Rouse Atk Res 1","Rouse Atk Res 2","Rouse Atk Res 3","Joint Hone Res","Rouse Atk Spd 1","Rouse Atk Spd 2","Rouse Atk Spd 3","Spd Res Oath 1","Spd Res Oath 2","Spd Res Oath 3","Atk Res Menace","Atk Def Menace","Order's Restraint","Order's Restraint+","Def Res Menace","Atk Spd Menace","Surtr's Portent","Ostia's Pulse 2","With Everyone 2","Rouse Atk Spd 4","Rouse Spd Def 4","Goddess Bearer","Rouse Atk Def 4","Threat Atk Spd 3","Threat Atk Res 3","Threat Atk Def 3","Threat Spd Def 3","Surtr's Menace","Tome of Reason","Azure Lance","Vedrfolnir's Egg","Sharp War Sword","Spd Res Menace","Fiery Bolganone","Shadow Breath","Silent Power","Icy Maltet","Faith in Humanity","Darkling Guardian","Wolfpup Fang","Rouse Atk Res 4","Spd Def Menace","Ebon Bolverk","Human Virtue 2","Atk Spd Oath 4","Divine Fang+","Inner Wellspring","Heir to Light","Wind Genesis","Blade of Favors","Atk Res Oath 4","Ardent Durandal","Vision of Arcadia 2","Coyote's Lance","Severance","Oracle's Breath","Seidr","Cunning Bow","Crow's Crystal","Guide's Hourglass","Celestial Globe","Magical Lantern","Magical Lantern+","Brilliant Starlight","Crimean Scepter","Master's Tactics","Mila's Turnwheel 2","Saintly Seraphim","Atk Spd Hexblade","Inborn Idealism","Mystic War Staff","Alarm Atk Spd","Rallying Cry","Ilian Merc Lance","Alarm Spd Def","Alarm Atk Def","Desert-Tiger Axe","Tome of Luxuries","Dream Deliverer","Winds of Silesse","Tip the Scales!","Atk Spd Pledge","Playful Pinwheel","Whitewind Bow","Whitewind Bow+","Wind Tribe Club","Wind Tribe Club+","Heired Forseti","Spd Res Hexblade","Heired Gungnir","Heart of Crimea","Pumpkin Stem","Pumpkin Stem+","Payday Pouch","Farmer's Tool","Farmer's Tool+","Atk Oath Echo","Worldly Lance","Obscurite","Spy's Shuriken","Guarding Lance","Gondul","Corsair Cleaver","Incite Atk Spd","Iago's Tome","Alarm Def Res","Blue Yule Axe","Spoil Rotten","Inf Null Follow 4","Goddess Temari","Dragoon Axe","Blade Royale","Blade of Sands","Atk Def Oath 4","Nabata Beacon","Nabata Beacon+","Pulse Up Blades","Nabata Lance","Nabata Lance+","Darkling Dragon","Incite Atk Res","Glittering Anima","Penitent Lance","Brutal Breath","Sky-Hopper Egg","Pure-Wing Spear","Def Res Pledge","Lightburst Tome","Astral Breath","Daniel-Made Bow","Heavy War Axe","Forager Naginata","Raudrlantern","Raudrlantern+","Tri-Path Splitter","Lucrative Bow","Lucrative Bow+","Blood Tome","Dead-Crow Tome","Ereshkigal","Def Res Oath 4","Dead-Wolf Blade","Absolute Closure","United Bouquet","Apotheosis Spear","Exotic Fruit Juice","Doubler Bow","Doubler Bow+","Beast Threaten","Odd Def Wave 4","Odd Spd Wave 4","Sea Tambourine","Sea Tambourine+","Tropical Conch","Tropical Conch+","Starpoint Lance","Plegian War Axe","Even Res Wave D","Even Atk Wave N","Lance of Grado","Nidavellir Ballista","Sisterly Axe","Divine Nectar","Quieting Antler","Summertime Axe","Juicy Bucketful","Juicy Bucketful+","Stall-Game Bow","Stall-Game Bow+","According to Plan","Paranoia","Majestic Glitnir","Goddess Bearer 2","Geirdriful","Air Orders 4","Suave Blade","Spd Def Link 4","Praise-Piner Axe","Caduceus Staff","Vedrfolnir's Edge","Gainful Dagger","Gainful Dagger+","Aureola","Auto-Lofnheidr","Talregan Axe","Scroll of Curses","Doubler Sword","Doubler Sword+","Doubler Lance","Doubler Lance+","Arcane Truthfire","Thunderbrand","Spear","Red-Fist Blades","Twinkling Anima","Delivering Antler","Lady's Bow","Speedtaker 1","Speedtaker 2","Speedtaker 3","Speedtaker 4","Nectar's Magic","Fimbulvetr Morn","Incite Spd Def","Divine Yewfelle","Sword of Isaach","Aerial Longsword","Frostfire Breath","Assault Rush","Lion's Heart","Deer's Heart","AS Incite Hone","Gronnlantern","Gronnlantern+","Salvage","Staff of the Saint","Sparking Tome","Twin Star Axe","Kia Staff","Arcane Medusa","Hexblade Sword","Hexblade Sword+","True-Bond Bow","Raudrcrab","Raudrcrab+","Azure Twin Edge","Tome of Fury","AR Incite Hone","Tut-Tut","Baton of Dusk","Ancient Voice"];
data.toggleForm = ["Atk Spd Form 1","Atk Spd Form 2","Atk Spd Form 3","Spd Def Form 1","Spd Def Form 2","Spd Def Form 3","Atk Def Form 1","Atk Def Form 2","Atk Def Form 3","Spd Res Form 1","Spd Res Form 2","Spd Res Form 3","Atk Res Form 1","Atk Res Form 2","Atk Res Form 3","Def Res Form 1","Def Res Form 2","Def Res Form 3"];

//Growth shifts of 3 are what make some banes/boons +/- 4
//growth table from https://feheroes.wiki/Stat_Growth
data.growths = [[6,8,9,11,13,14,16,18,19,21,23,24,26,28,30,31],
[7,8,10,12,14,15,17,19,21,23,25,26,28,30,32,34],
[7,9,11,13,15,17,19,21,23,25,27,29,31,33,35,37],
[8,10,12,14,16,18,20,22,24,26,28,31,33,35,37,39],
[8,10,13,15,17,19,22,24,26,28,30,33,35,37,39,42]];

//Remember: heroes, skills, prereqs, and heroskills arrays come from PHP-created script
data.heroPossibleSkills = [];
data.heroBaseSkills = [];
data.heroMaxSkills = [[],[],[],[],[]]; //2d array; 1st num rarity, 2nd num skillindex
data.captainSkills = [];
data.captainDescriptions = [];

data.skillsThatArePrereq = [];
//Prereq exceptions are Sol, Luna, Astra, Assault, DB3, Draconic Aura, Bonfire, Steady Stance 3, Sturdy Blow 2, Fury 3, Distant Def 3, Moonbow, Darting Blow 3, Flashing Blade 3, Warding Stance 3, Swift Sparrow 2, Mirror Strike 2, Brazen Atk Spd 3, Noontime, Atk Spd Push 3, Atk Res Bond 3, Atk Spd Bond 3, Atk Res Push 3, Heavy Blade 3, Life and Death 3, Iceberg, Mirror Stance 2, Fortify Res 3, Steady Posture 2, Sturdy Stance 2, Atk Def Push 3, Glimmer, Bracing Stance 2, Kestrel Stance 2, Atk Def Solo 3, Atk Def Bond 3, Dragon Fang, Close Def 3, Def Res Solo 3, Ignis, Blazing Flame, Atk Spd Solo 3, Steady Blow 2, Swift Stance 2, AR-D Atk Spd 3, DC, Glacies, CC, AR-D Def Res 3, Miracle, Escutcheon, Quick Riposte, Reprisal, Time's Pulse, Wrathful Staff, Dazzling Staff, Sabotage Atk and Res, Sacred Cowl, Vengeance, Wary Fighter, Blazing Light, Hardy Fighter, DR Near Save, AR Far Save, AD Near Save, AD Far Save, C Feud
data.skillPrereqExceptions = [125,162,168,170,231,163,165,618,479,219,440,169,228,757,737,385,547,827,167,1108,750,929,1666,421,222,171,957,339,1215,951,1540,161,1163,1070,1363,776,164,518,1455,166,188,1306,606,983,2313,251,172,250,1663,201,191,285,173,1746,443,467,1505,1558,193,174,279,186,2857,2513,2518,2553,2998,2934];

//Build Captain skills
var cpBlow = data.captainString.split("@");
for(var i = 0; i < cpBlow.length; i++){
	var cChunk = cpBlow[i].split("$");
	data.captainSkills.push(cChunk[0]);
	data.captainDescriptions.push(cChunk[1]);
}

function initOptions(){
	//Initializes options from localStorage or from scratch

	//Holder for options that aren't hero-specific
	options = {};
	options.enemy = {};
	options.autoCalculate = true;
	options.startTurn = 1;
	options.useGaleforce = true;
	options.threatenRule = "Normal";
	options.fortress = 0;
	options.showOnlyMaxSkills = true;
	options.hideUnaffectingSkills = true;
	options.viewFilter = "all";
	options.customEnemyList = 1;
	options.customEnemySelected = -1;
	options.challengerSelected = -1;
	options.roundInitiators = ["Challenger initiates"];
	options.enemyMass = false;
	options.sortType = -1;
	options.result = {"melee":true,"ranged":true,"red":true,"blue":true,"green":true,"gray":true,"physical":true,"magical":true,"infantry":true,"cavalry":true,"flying":true,"armored":true};

	//Holder for challenger options and pre-calculated stats
	challenger = [];
	//Holder for enemy options and pre-calculated stats
	enemies = {};
	enemies.cl = {}; //Custom list
	enemies.cl.list = [];
	//set mass variables
	mass = {};
	mass.buffs = {"atk":0,"spd":0,"def":0,"res":0};
	mass.debuffs = {"atk":0,"spd":0,"def":0,"res":0};
	mass.spur = {"atk":0,"spd":0,"def":0,"res":0};
	mass.hp = 100;
	mass.precharge = 0;
	mass.merge = 0;
	mass.blessing = ["none","none","none","none","none","none"];
	
	if(options.challengerSelected >= challenger.length){
		options.challengerSelected = challenger.length - 1;
	}
	if(options.customEnemySelected >= enemies.cl.list.length){
		options.customEnemySelected = enemies.cl.list.length - 1;
	}
}

initOptions();

var fightResults = []; //Needs to be global variable to get info for tooltip
var resultHTML = []; //Needs to be a global variable to flip sort order without

var showingTooltip = false;
var calcuwaiting = false;
var calcuwaitTime = 0;
var danceCount = 0;

//Make list of all skill ids that are a strictly inferior prereq to exclude from dropdown boxes
for(var i = 0; i < data.prereqs.length;i++){
	if(data.skillsThatArePrereq.indexOf(data.prereqs[i].required_id)==-1 && data.skillPrereqExceptions.indexOf(data.prereqs[i].required_id)==-1){
		data.skillsThatArePrereq.push(data.prereqs[i].required_id);
	}
}

//Find hero skills
for(var i = 0; i < data.heroes.length;i++){
	data.heroPossibleSkills.push(getValidSkills({index:i}));

	var baseSkills = getHeroSkills(i);
	
	data.heroBaseSkills.push(baseSkills);
	for(var j = 0; j < 5; j++){
		data.heroMaxSkills[j].push(getMaxSkills(baseSkills,j));
	}
}

//////////////////////////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////////////////////////

//Put DOM stuff in place

//////////////////////////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////////////////////////

$(document).ready(function(){

	//Show incompatibility message: code does not work fr IE<9
	//(Analytics show that the % of people who use IE<9 on my site is EXTREMELY low, like 1 in 30,000)
	if(![].forEach){
		console.log("Unsupported JavaScript");
		$("#update_text").html("Your browser does not appear to support some of the code this app uses (JavaScript ES5). The app probably won't work.");
	}
	
	//initiate overlay plugin
	$("#chbuff").popup({
		transition: "all 0.5s",
		type: "tooltip",
		offsetleft: "450",
		offsettop: "9",
		vertical: "topedge",
		horizontal: "rightedge",
		background: "true",
		onclose: function(){
			if($(".challenger_bonus:checked").length > 0 || $("#challenger_divinely").val() > 0 || $("#challenger_empathy").val() > 0 || $("#challenger_gtAtk").val() > 0 || $("#challenger_gtSpd").val() > 0 || $("#challenger_gtDef").val() > 0 || $("#challenger_gtRes").val() > 0 || $("#challenger_nectar").val() > 0 || $("#challenger_bExtra").val() > 0){
				$("#ch_bonus").removeClass("notincluded");
				$("#ch_bonus").addClass("chincluded");
			}
			else{
				$("#ch_bonus").removeClass("chincluded");
				$("#ch_bonus").addClass("notincluded");
			}
		}
	});
	$("#chsupport").popup({
		transition: "all 0.5s",
		type: "tooltip",
		offsetleft: "450",
		offsettop: "9",
		vertical: "topedge",
		horizontal: "rightedge",
		background: "true",
		onclose: function(){
			if($(".challenger_support:checked").length > 0 || $("#challenger_baura").val() > 0 || $("#challenger_hini").val() > 0 || $("#challenger_tPulse").val() > 0 || $("#challenger_rsd").val() > 0 || $("#challenger_flutter").val() > 0 || $("#challenger_sunper").val() > 0 || $("#challenger_trueDmg").val() > 0 || $("#challenger_trueFirstDR").val() > 0 || $("#challenger_diva").val() > 0 || $("#challenger_cnlove").val() > 0 || $("#challenger_nlove").val() > 0 || $("#challenger_rdw").val() > 0 || $("#challenger_persp").val() > 0 || $("#challenger_crux").val() > 0 || $("#challenger_dfu").val() > 0 || $("#challenger_hippity").val() > 0 || $("#challenger_mboost").val() > 0 || $("#challenger_caduceus").val() > 0 || $("#challenger_doi").val() > 0 || $("#challenger_dof").val() > 0 || $("#challenger_hg").val() > 0 || $("#challenger_fellProtect").val() > 0 || $("#challenger_fellSuccess").val() > 0){
				$("#ch_support").removeClass("notincluded");
				$("#ch_support").addClass("chincluded");
			}
			else{
				$("#ch_support").removeClass("chincluded");
				$("#ch_support").addClass("notincluded");
			}
		}
	});
	$("#chephase").popup({
		transition: "all 0.5s",
		type: "tooltip",
		offsetleft: "190",
		offsettop: "9",
		vertical: "topedge",
		horizontal: "rightedge",
		background: "true",
		onclose: function(){
			if($(".challenger_ephase:checked").length > 0 || $("#challenger_ep_heal").val() > 0){
				$("#ch_ephase").removeClass("notincluded");
				$("#ch_ephase").addClass("chincluded");
			}
			else{
				$("#ch_ephase").removeClass("chincluded");
				$("#ch_ephase").addClass("notincluded");
			}
		}
	});
	$("#chpenalty").popup({
		transition: "all 0.5s",
		type: "tooltip",
		offsetleft: "190",
		offsettop: "9",
		vertical: "topedge",
		horizontal: "rightedge",
		background: "true",
		onclose: function(){
			if($(".challenger_penalty:checked").length > 0 || $("#challenger_pExtra").val() > 0 || $("#challenger_chip").val() > 0){
				$("#ch_penalty").removeClass("notincluded");
				$("#ch_penalty").addClass("chincluded");
			}
			else{
				$("#ch_penalty").removeClass("chincluded");
				$("#ch_penalty").addClass("notincluded");
			}
		}
	});
	$("#chally").popup({
		transition: "all 0.5s",
		type: "tooltip",
		offsetleft: "190",
		offsettop: "9",
		vertical: "topedge",
		horizontal: "rightedge",
		background: "true",
		onclose: function(){
			$('#checkboxId').is(':checked')
			if($(".challenger_ally:checked").length > 0 || $("#challenger_erorc").val() > 0 || $("#challenger_rank").val() != "N" || $("#challenger_spaces").val() > 0 || $("#challenger_rorc").val() > 0 || $("#challenger_adjacent").val() > 0 || $("#challenger_two").val() > 0 || $("#challenger_three").val() > 0 || $("#challenger_bbatk").val() > 0 || $("#challenger_bbspd").val() > 0 || $("#challenger_bbdef").val() > 0 || $("#challenger_bbres").val() > 0 || $("#challenger_bdatk").val() < 0 || $("#challenger_bdspd").val() < 0 || $("#challenger_bddef").val() < 0 || $("#challenger_bdres").val() < 0){
				$("#ch_ally").removeClass("notincluded");
				$("#ch_ally").addClass("chincluded");
			}
			else{
				$("#ch_ally").removeClass("chincluded");
				$("#ch_ally").addClass("notincluded");
			}
		}
	});
	$("#clbuff").popup({
		transition: "all 0.5s",
		type: "tooltip",
		offsetleft: "450",
		offsettop: "9",
		vertical: "topedge",
		horizontal: "rightedge",
		background: "true",
		onclose: function(){
			if($(".cl_enemy_bonus:checked").length > 0 || $("#cl_enemy_divinely").val() > 0 || $("#cl_enemy_empathy").val() > 0 || $("#cl_enemy_gtAtk").val() > 0 || $("#cl_enemy_gtSpd").val() > 0 || $("#cl_enemy_gtDef").val() > 0 || $("#cl_enemy_gtRes").val() > 0 || $("#cl_enemy_nectar").val() > 0 || $("#cl_enemy_bExtra").val() > 0){
				$("#cl_bonus").removeClass("notincluded");
				$("#cl_bonus").addClass("clincluded");
			}
			else{
				$("#cl_bonus").removeClass("clincluded");
				$("#cl_bonus").addClass("notincluded");
			}
		}
	});
	$("#clsupport").popup({
		transition: "all 0.5s",
		type: "tooltip",
		offsetleft: "450",
		offsettop: "9",
		vertical: "topedge",
		horizontal: "rightedge",
		background: "true",
		onclose: function(){
			if($(".cl_enemy_support:checked").length > 0 || $("#cl_enemy_baura").val() > 0 || $("#cl_enemy_hini").val() > 0 || $("#cl_enemy_tPulse").val() > 0 || $("#cl_enemy_rsd").val() > 0 || $("#cl_enemy_flutter").val() > 0 || $("#cl_enemy_sunper").val() > 0 || $("#cl_enemy_trueDmg").val() > 0 || $("#cl_enemy_trueFirstDR").val() > 0 || $("#cl_enemy_diva").val() > 0 || $("#cl_enemy_cnlove").val() > 0 || $("#cl_enemy_nlove").val() > 0 || $("#cl_enemy_rdw").val() > 0 || $("#cl_enemy_persp").val() > 0 || $("#cl_enemy_crux").val() > 0 || $("#cl_enemy_dfu").val() > 0 || $("#cl_enemy_hippity").val() > 0 || $("#cl_enemy_mboost").val() > 0 || $("#cl_enemy_caduceus").val() > 0 || $("#cl_enemy_doi").val() > 0 || $("#cl_enemy_dof").val() > 0 || $("#cl_enemy_hg").val() > 0 || $("#cl_enemy_fellProtect").val() > 0 || $("#cl_enemy_fellSuccess").val() > 0){
				$("#cl_support").removeClass("notincluded");
				$("#cl_support").addClass("clincluded");
			}
			else{
				$("#cl_support").removeClass("clincluded");
				$("#cl_support").addClass("notincluded");
			}
		}
	});
	$("#clephase").popup({
		transition: "all 0.5s",
		type: "tooltip",
		offsetleft: "190",
		offsettop: "9",
		vertical: "topedge",
		horizontal: "rightedge",
		background: "true",
		onclose: function(){
			if($(".cl_enemy_ephase:checked").length > 0 || $("#cl_enemy_ep_heal").val() > 0){
				$("#cl_ephase").removeClass("notincluded");
				$("#cl_ephase").addClass("clincluded");
			}
			else{
				$("#cl_ephase").removeClass("clincluded");
				$("#cl_ephase").addClass("notincluded");
			}
		}
	});
	$("#clpenalty").popup({
		transition: "all 0.5s",
		type: "tooltip",
		offsetleft: "190",
		offsettop: "9",
		vertical: "topedge",
		horizontal: "rightedge",
		background: "true",
		onclose: function(){
			if($(".cl_enemy_penalty:checked").length > 0 || $("#cl_enemy_pExtra").val() > 0 || $("#cl_enemy_chip").val() > 0){
				$("#cl_penalty").removeClass("notincluded");
				$("#cl_penalty").addClass("clincluded");
			}
			else{
				$("#cl_penalty").removeClass("clincluded");
				$("#cl_penalty").addClass("notincluded");
			}
		}
	});
	$("#clally").popup({
		transition: "all 0.5s",
		type: "tooltip",
		offsetleft: "190",
		offsettop: "9",
		vertical: "topedge",
		horizontal: "rightedge",
		background: "true",
		onclose: function(){
			if($(".cl_enemy_ally:checked").length > 0 || $("#cl_enemy_erorc").val() > 0 || $("#cl_enemy_rank").val() != "N" || $("#cl_enemy_spaces").val() > 0 || $("#cl_enemy_rorc").val() > 0 || $("#cl_enemy_adjacent").val() > 0 || $("#cl_enemy_two").val() > 0 || $("#cl_enemy_three").val() > 0 || $("#cl_enemy_bbatk").val() > 0 || $("#cl_enemy_bbspd").val() > 0 || $("#cl_enemy_bbdef").val() > 0 || $("#cl_enemy_bbres").val() > 0 || $("#cl_enemy_bdatk").val() < 0 || $("#cl_enemy_bdspd").val() < 0 || $("#cl_enemy_bddef").val() < 0 || $("#cl_enemy_bdres").val() < 0){
				$("#cl_ally").removeClass("notincluded");
				$("#cl_ally").addClass("clincluded");
			}
			else{
				$("#cl_ally").removeClass("clincluded");
				$("#cl_ally").addClass("notincluded");
			}
		}
	});

	//Populate hero select options
	heroHTML = "<option value=-1 class=\"hero_option\">&#183; Select Hero</option>";
	clHeroHTML = heroHTML;
	for(var i = 0; i < data.heroes.length; i++){
		//Populate Challenger list without generic units
		if(data.heroes[i].name.indexOf("generic") == -1){
			heroHTML += "<option value=" + i + " class=\"hero_option\">" + data.heroes[i].name + "</option>";
		}
		
		var gName = changeGenericName(data.heroes[i].name);
		clHeroHTML += "<option value=" + i + " class=\"hero_option\">" + gName + "</option>";
	}
	$("#challenger_name").html(heroHTML).select2({
		sorter: data => data.sort((a, b) => a.text.localeCompare(b.text)),
	});
	$("#cl_enemy_name").html(clHeroHTML).select2({
		sorter: data => data.sort((a, b) => a.text.localeCompare(b.text)),
	});
	//updateFullUI();
	resetStats();
	
	//do I need to add hero here?
	$("#cl_enemy_name").change(function(){
		resetStats();
	});

	//Create listener on whole body and check data-var to see which var to replace
	//TODO: make click listeners work similarly
	$("input, select").on("change", function(e){
		var dataVar = $(this).attr("data-var");
		if(dataVar){
			var varsThatChangeStats = [
				".rarity",".merge",".boon",".bane",".weapon",".a",".s",".replaceWeapon",".replaceA", ".summoner", ".refined", ".blessing.0", ".blessing.1", ".blessing.2", ".blessing.3", ".blessing.4", ".blessing.5", ".abonus", ".transform", ".resplendent", ".dragonflower", ".ascended", ".emblem", ".emerge", ".talent.atk", ".talent.spd", ".talent.def", ".talent.res", ".aides", ".reinforcement"
			];
			var varsThatChangeSkills = [
				".rarity",".replaceWeapon",".replaceSpecial",".replaceA",".replaceB",".replaceC"
			];
			var genericStats = [
				".hp",".atk",".spd",".def",".res"
			];

			var newVal = $(this).val();
			var useCalcuwait = false;
			var blockCalculate = false;
			var heroType = ["hero","challenger","ch"];
			var hero;
			if(beginsWith(dataVar,"challenger.")){
				if(options.challengerSelected == -1){
					addHero();
				}
				hero = challenger[options.challengerSelected];
			}
			else if(beginsWith(dataVar,"enemies.cl.list") || beginsWith(dataVar,"mass") || endsWith(dataVar,".enemyMass")){
				if(options.customEnemySelected == -1){
					addClEnemy();
				}
				hero = enemies.cl.list[options.customEnemySelected];
				heroType = ["cl","cl_enemy","cl"];
			}
			

			var inputType = $(this).attr("type");
			if(inputType=="number"){
				var min = $(this).attr("min");
				var max = $(this).attr("max");
				useCalcuwait = true;
				if(typeof min != "undefined" && typeof max != "undefined"){
					newVal = verifyNumberInput(this,min,max);
				}
				else{
					newVal = parseInt(newVal);
				}
			}
			else if(inputType=="checkbox"){
				newVal = $(this).is(":checked");
			}

			//Change val to numeric if it looks numeric
			//All numbers used by this program are ints
			if($.isNumeric(newVal)){
				newVal = parseInt(newVal);
			}
			//Apply new dataVar value
			changeDataVar(dataVar,newVal);

			//Stuff specific to changing skill
			if(newVal != -1 && (endsWith(dataVar,".weapon") || endsWith(dataVar,".special") || endsWith(dataVar,".a") || endsWith(dataVar,".b") || endsWith(dataVar,".c") || endsWith(dataVar,".s") || endsWith(dataVar,".x"))){

				var dataToPass = data.skills[newVal].name;
				if(endsWith(dataVar,".s")){
					//Rename s skills to differentate from regular skills
					dataToPass = "s_" + dataToPass;
				}
				/*if(hero.challenger){
					dataLayer.push({"event":"changeSkill","skill_name":dataToPass});
				}
				else{
					dataLayer.push({"event":"changeEnemySkill","skill_name":dataToPass});
				}*/
			}

			//Stuff specific to changing hero
			if(endsWith(dataVar,".index")){
				if(newVal != -1){
					hero.index = newVal;
					//find hero's starting skills
					hero.arcane = 0;
					hero.x = -1;
					initHero(hero);
					var refine = getValidRefine(hero.weapon);
					hero.refined = -1;
					if(refine.length > 0){
						$("#refined_" + heroType[0] + "_row").show();
						$("#" + heroType[1] + "_refined").html(refine.join(" "));
					}
					else{
						$("#refined_" + heroType[0] + "_row").hide();
						$("#" + heroType[1] + "_refined").html("<option>No Refinement</option>");
					}
					var wToggle = getValidToggle(hero.weapon, hero.refined, hero.index);
					hero.toggle.weapon = 0;
					if(wToggle.length > 0){
						$("#toggle_" + heroType[0] + "_weapon").show();
						$("#" + heroType[1] + "_wtoggle").html(wToggle.join(" "));
					}
					else{
						$("#toggle_" + heroType[0] + "_weapon").hide();
						$("#" + heroType[1] + "_wtoggle").html("<option>Disabled</option>");
					}
					var aToggle = getValidToggle(hero.a, -1, hero.index);
					hero.toggle.a = 0;
					if(aToggle.length > 0){
						$("#toggle_" + heroType[0] + "_a").show();
						$("#" + heroType[1] + "_atoggle").html(aToggle.join(" "));
					}
					else{
						$("#toggle_" + heroType[0] + "_a").hide();
						$("#" + heroType[1] + "_atoggle").html("<option>Disabled</option>");
					}
					var bToggle = getValidToggle(hero.b, -1, hero.index);
					hero.toggle.b = 0;
					if(bToggle.length > 0){
						$("#toggle_" + heroType[0] + "_b").show();
						$("#" + heroType[1] + "_btoggle").html(bToggle.join(" "));
					}
					else{
						$("#toggle_" + heroType[0] + "_b").hide();
						$("#" + heroType[1] + "_btoggle").html("<option>Disabled</option>");
					}
					var cToggle = getValidToggle(hero.c, -1, hero.index);
					hero.toggle.c = 0;
					if(cToggle.length > 0){
						$("#toggle_" + heroType[0] + "_c").show();
						$("#" + heroType[1] + "_ctoggle").html(cToggle.join(" "));
					}
					else{
						$("#toggle_" + heroType[0] + "_c").hide();
						$("#" + heroType[1] + "_ctoggle").html("<option>Disabled</option>");
					}
					var sToggle = getValidToggle(hero.s, -1, hero.index);
					hero.toggle.s = 0;
					if(sToggle.length > 0){
						$("#toggle_" + heroType[0] + "_s").show();
						$("#" + heroType[1] + "_stoggle").html(sToggle.join(" "));
					}
					else{
						$("#toggle_" + heroType[0] + "_s").hide();
						$("#" + heroType[1] + "_stoggle").html("<option>Disabled</option>");
					}
					var xToggle = getValidToggle(hero.x, -1, hero.index);
					hero.toggle.x = 0;
					if(xToggle.length > 0){
						$("#toggle_" + heroType[0] + "_x").show();
						$("#" + heroType[1] + "_xtoggle").html(sToggle.join(" "));
					}
					else{
						$("#toggle_" + heroType[0] + "_x").hide();
						$("#" + heroType[1] + "_xtoggle").html("<option>Disabled</option>");
					}
					var sdToggle = getValidSDToggle(hero.sd);
					hero.toggle.sd = 0;
					if(sdToggle.length > 0){
						$("#toggle_" + heroType[0] + "_sd").show();
						$("#" + heroType[1] + "_sdtoggle").html(sdToggle.join(" "));
					}
					else{
						$("#toggle_" + heroType[0] + "_sd").hide();
						$("#" + heroType[1] + "_sdtoggle").html("<option>Disabled</option>");
					}
					var spToggle = getValidToggle(hero.special, -1, hero.index);
					hero.toggle.special = 0;
					if(spToggle.length > 0){
						$("#toggle_" + heroType[0] + "_special").show();
						$("#" + heroType[1] + "_specialtoggle").html(spToggle.join(" "));
					}
					else{
						$("#toggle_" + heroType[0] + "_special").hide();
						$("#" + heroType[1] + "_specialtoggle").html("<option>Disabled</option>");
					}
					if(data.heroes[hero.index].weapontype == "beast"){
						$("#" + heroType[2] + "_trans").show();
					}
					else{
						$("#" + heroType[2] + "_trans").hide();
					}
					if(data.heroes[hero.index].rating == 20 || data.heroes[hero.index].rating == 30 || data.heroes[hero.index].rating == 40 || data.heroes[hero.index].rating == 50){
						$("#" + heroType[2] + "_resp").show();
					}
					else{
						$("#" + heroType[2] + "_resp").hide();
					}
					//Unique skills that require additional value input
					//Human Virtue 2
					if(hero.c != -1 && data.skills[hero.c].skill_id == 3161){
						$("#" + heroType[2] + "_prf_value").show();
						$("#" + heroType[2] + "_pv_text").html("1st Hit DR%");
						$("#" + heroType[1] + "_prf_value").attr({"max":40});
					}
					//Chaos Manifest
					else if(hero.weapon != -1 && data.skills[hero.weapon].skill_id == 1555 && hero.refined > 0){
						$("#" + heroType[2] + "_prf_value").show();
						$("#" + heroType[2] + "_pv_text").html("Total Penalties");
						$("#" + heroType[1] + "_prf_value").attr({"max":88});
					}
					else{
						$("#" + heroType[2] + "_prf_value").hide();
						$("#" + heroType[2] + "_pv_text").html("Prf Skill");
						$("#" + heroType[1] + "_prf_value").attr({"max":99});
					}
					//Set maximum Dragonflower values
					if(data.heroes[hero.index].hero_id < 370 && data.heroes[hero.index].movetype == "infantry"){
						$("#" + heroType[1] + "_dragonflower").prop("max", 35);
					}
					else if(data.heroes[hero.index].hero_id < 586){
						$("#" + heroType[1] + "_dragonflower").prop("max", 30);
						if($("#" + heroType[1] + "_dragonflower").val() > 30){
							$("#" + heroType[1] + "_dragonflower").val(30);
						}
					}
					else if(data.heroes[hero.index].hero_id < 740){
						$("#" + heroType[1] + "_dragonflower").prop("max", 25);
						if($("#" + heroType[1] + "_dragonflower").val() > 25){
							$("#" + heroType[1] + "_dragonflower").val(25);
						}
					}
					else if(data.heroes[hero.index].hero_id < 884){
						$("#" + heroType[1] + "_dragonflower").prop("max", 20);
						if($("#" + heroType[1] + "_dragonflower").val() > 20){
							$("#" + heroType[1] + "_dragonflower").val(20);
						}
					}
					else if(data.heroes[hero.index].hero_id < 1031){
						$("#" + heroType[1] + "_dragonflower").prop("max", 15);
						if($("#" + heroType[1] + "_dragonflower").val() > 15){
							$("#" + heroType[1] + "_dragonflower").val(15);
						}
					}
					else if(data.heroes[hero.index].hero_id < 1176){
						$("#" + heroType[1] + "_dragonflower").prop("max", 10);
						if($("#" + heroType[1] + "_dragonflower").val() > 10){
							$("#" + heroType[1] + "_dragonflower").val(10);
						}
					}
					else{
						$("#" + heroType[1] + "_dragonflower").prop("max", 5);
						if($("#" + heroType[1] + "_dragonflower").val() > 5){
							$("#" + heroType[1] + "_dragonflower").val(5);
						}
					}
					//enable Fallen Star bonus if it's LClaude/SClaude/BChrom
					if(data.heroes[hero.index].hero_id == 664 || data.heroes[hero.index].hero_id == 863 || data.heroes[hero.index].hero_id == 887){
						
						$("#" + heroType[1] + "_fallen_star").show();
					}
					else{
						$("#" + heroType[1] + "_fallen_star").hide();
					}
					//enable Deep Star bonus if it's WClaude/BChrom
					if(data.heroes[hero.index].hero_id == 664 || data.heroes[hero.index].hero_id == 887 || data.heroes[hero.index].hero_id == 1037){
						
						$("#" + heroType[1] + "_deep_star").show();
					}
					else{
						$("#" + heroType[1] + "_deep_star").hide();
					}
					//reconstruct Emblem options
					$("#" + heroType[1] + "_emblem").find("option:disabled").prop("disabled", false);
					//disable self-Emblem values (Can't engage themselves)
					if(data.heroes[hero.index].rating == 19){
						var emName = data.heroes[hero.index].name.split(" ");
						$("#" + heroType[1] + "_emblem option:contains(\"" + emName[0] + "\")").prop("disabled", true);
					}
					resetHero(hero);
					//check for default style (must come after reset)
					//Styles:  1 - Emblem Lyn, 2 - Astra Storm, 3 - Wind Sword
					if(hero.special != -1 && data.skills[hero.special].name == "Astra Storm"){
						hero.style = 2;
					}
					else if(hero.index != -1 && data.heroes[hero.index].name == "Eirika (Emblem)"){
						hero.style = 3;
					}
					/*if(hero.challenger){

						//Analytics
						dataLayer.push({"event":"changeHero","challenger_name":data.heroes[newVal].name});
					}
					else{
						updateClList();

						//Analytics
						dataLayer.push({"event":"changeEnemy","challenger_name":data.heroes[newVal].name});
					}*/
				}
			}
			else if(endsWith(dataVar,".showOnlyMaxSkills") || endsWith(dataVar,".hideUnaffectingSkills")){
				blockCalculate = true;
				updateFullUI();
				//Not hero so won't automatically update uis
			}
			else if(endsWith(dataVar,".viewFilter") || endsWith(dataVar,".sortType")){
				blockCalculate = true;
			}
			else if(endsWith(dataVar,".autoCalculate")){
				if(newVal == 0){
					blockCalculate = true;
				}
			}
			else if(endsWith(dataVar,".fortress")){
				var cHero = challenger[options.challengerSelected];
				var cEnemy;
				if(options.customEnemyList >= 1){
					cEnemy = enemies.cl.list[options.customEnemySelected];
				}
				setStats(cHero);
				setStats(cEnemy);
				updateFullUI();
			}
			else if(endsWith(dataVar,".weapon") && !dataVar.includes("toggle")){
				if(hero.weapon >= 0){
					var refine = getValidRefine(hero.weapon);
					hero.refined = -1;
					if(refine.length > 0){
						$("#refined_" + heroType[0] + "_row").show();
						$("#" + heroType[1] + "_refined").html(refine.join(" "));
					}
					else{
						$("#refined_" + heroType[0] + "_row").hide();
						$("#" + heroType[1] + "_refined").html("<option>No Refinement</option>");
					}
					var wToggle = getValidToggle(hero.weapon, hero.refined, hero.index);
					hero.toggle.weapon = 0;
					if(wToggle.length > 0){
						$("#toggle_" + heroType[0] + "_weapon").show();
						$("#" + heroType[1] + "_wtoggle").html(wToggle.join(" "));
					}
					else{
						$("#toggle_" + heroType[0] + "_weapon").hide();
						$("#" + heroType[1] + "_wtoggle").html("<option>Disabled</option>");
					}
						
					//Remove PRF skills if Arcane weapon is chosen when not Rearmed/Attuned
					if(data.skills[hero.weapon].name.indexOf("Arcane") != -1 && data.heroes[hero.index].rating != 17 && data.heroes[hero.index].rating != 18){
						hero.arcane = 1;
						hero.validSpecialSkills = getValidSkills(hero,"special");
						hero.validASkills = getValidSkills(hero,"a");
						hero.validBSkills = getValidSkills(hero,"b");
						hero.validCSkills = getValidSkills(hero,"c");
						if(hero.special != -1 && data.skills[hero.special].inheritrule == "unique"){
							hero.special = -1;
						}
						if(hero.a != -1 && data.skills[hero.a].inheritrule == "unique"){
							hero.a = -1;
						}
						if(hero.b != -1 && data.skills[hero.b].inheritrule == "unique"){
							hero.b = -1;
						}
						if(hero.c != -1 && data.skills[hero.c].inheritrule == "unique"){
							hero.c = -1;
						}
					}
					else if(hero.arcane == 1 && data.skills[hero.weapon].name.indexOf("Arcane") == -1){
						hero.arcane = 0;
						hero.validSpecialSkills = getValidSkills(hero,"special");
						hero.validASkills = getValidSkills(hero,"a");
						hero.validBSkills = getValidSkills(hero,"b");
						hero.validCSkills = getValidSkills(hero,"c");
					}
					if(data.heroes[hero.index].name == "Eirika (Emblem)"){
						if(newVal != -1 && data.skills[newVal].name == "Azure Twin Edge"){
							if(hero.style == 0){
								hero.style = 3;
							}
							else{
								hero.style = 0;
							}
						}
						else{
							hero.style = 0;
						}
					}
				}
				else{
					$("#refined_" + heroType[0] + "_row").hide();
					$("#" + heroType[1] + "_refined").html("<option>No Refinement</option>");
					$("#toggle_" + heroType[0] + "_weapon").hide();
					$("#" + heroType[1] + "_wtoggle").html("<option>Disabled</option>");
					$("#toggle_" + heroType[0] + "_a").hide();
					$("#" + heroType[1] + "_atoggle").html("<option>Disabled</option>");
					$("#toggle_" + heroType[0] + "_b").hide();
					$("#" + heroType[1] + "_btoggle").html("<option>Disabled</option>");
					$("#toggle_" + heroType[0] + "_c").hide();
					$("#" + heroType[1] + "_ctoggle").html("<option>Disabled</option>");
					$("#toggle_" + heroType[0] + "_s").hide();
					$("#" + heroType[1] + "_stoggle").html("<option>Disabled</option>");
					$("#toggle_" + heroType[0] + "_x").hide();
					$("#" + heroType[1] + "_xtoggle").html("<option>Disabled</option>");
					$("#toggle_" + heroType[0] + "_sd").hide();
					$("#" + heroType[1] + "_sdtoggle").html("<option>Disabled</option>");
					$("#toggle_" + heroType[0] + "_special").hide();
					$("#" + heroType[1] + "_specialtoggle").html("<option>Disabled</option>");
				}
			}
			else if(endsWith(dataVar,".refined") && data.toggleRefineIgnore.indexOf(data.skills[hero.weapon].name) == -1){
				var wToggle = getValidToggle(hero.weapon, hero.refined, hero.index);
				hero.toggle.weapon = 0;
				if(wToggle.length > 0){
					$("#toggle_" + heroType[0] + "_weapon").show();
					$("#" + heroType[1] + "_wtoggle").html(wToggle.join(" "));
				}
				else{
					$("#toggle_" + heroType[0] + "_weapon").hide();
					$("#" + heroType[1] + "_wtoggle").html("<option>Disabled</option>");
				}
			}
			else if(endsWith(dataVar,".a") && !dataVar.includes("toggle")){
				if(hero.a >= 0){
					var aToggle = getValidToggle(hero.a, -1, hero.index);
					hero.toggle.a = 0;
					if(aToggle.length > 0){
						$("#toggle_" + heroType[0] + "_a").show();
						$("#" + heroType[1] + "_atoggle").html(aToggle.join(" "));
					}
					else{
						$("#toggle_" + heroType[0] + "_a").hide();
						$("#" + heroType[1] + "_atoggle").html("<option>Disabled</option>");
					}
				}
			}
			else if(endsWith(dataVar,".b") && !dataVar.includes("toggle")){
				if(hero.b >= 0){
					var bToggle = getValidToggle(hero.b, -1, hero.index);
					hero.toggle.b = 0;
					if(bToggle.length > 0){
						$("#toggle_" + heroType[0] + "_b").show();
						$("#" + heroType[1] + "_btoggle").html(bToggle.join(" "));
					}
					else{
						$("#toggle_" + heroType[0] + "_b").hide();
						$("#" + heroType[1] + "_btoggle").html("<option>Disabled</option>");
					}
				}
			}
			else if(endsWith(dataVar,".c") && !dataVar.includes("toggle")){
				if(hero.c >= 0){
					var cToggle = getValidToggle(hero.c, -1, hero.index);
					hero.toggle.c = 0;
					if(cToggle.length > 0){
						$("#toggle_" + heroType[0] + "_c").show();
						$("#" + heroType[1] + "_ctoggle").html(cToggle.join(" "));
					}
					else{
						$("#toggle_" + heroType[0] + "_c").hide();
						$("#" + heroType[1] + "_ctoggle").html("<option>Disabled</option>");
					}
				}
			}
			else if(endsWith(dataVar,".s") && !dataVar.includes("toggle")){
				if(hero.s >= 0){
					var sToggle = getValidToggle(hero.s, -1, hero.index);
					hero.toggle.s = 0;
					if(sToggle.length > 0){
						$("#toggle_" + heroType[0] + "_s").show();
						$("#" + heroType[1] + "_stoggle").html(sToggle.join(" "));
					}
					else{
						$("#toggle_" + heroType[0] + "_s").hide();
						$("#" + heroType[1] + "_stoggle").html("<option>Disabled</option>");
					}
				}
			}
			else if(endsWith(dataVar,".x") && !dataVar.includes("toggle")){
				if(data.heroes[hero.index].rating != 17 && data.heroes[hero.index].rating != 18){
					if(hero.special != -1 && data.skills[hero.special].inheritrule == "unique"){
						hero.special = -1;
					}
					if(hero.a != -1 && data.skills[hero.a].inheritrule == "unique"){
						hero.a = -1;
					}
					if(hero.b != -1 && data.skills[hero.b].inheritrule == "unique"){
						hero.b = -1;
					}
					if(hero.c != -1 && data.skills[hero.c].inheritrule == "unique"){
						hero.c = -1;
					}
				}
				hero.validSpecialSkills = getValidSkills(hero,"special");
				hero.validASkills = getValidSkills(hero,"a");
				hero.validBSkills = getValidSkills(hero,"b");
				hero.validCSkills = getValidSkills(hero,"c");
				if(hero.x >= 0){
					var xToggle = getValidToggle(hero.x, -1, hero.index);
					hero.toggle.x = 0;
					if(xToggle.length > 0){
						$("#toggle_" + heroType[0] + "_x").show();
						$("#" + heroType[1] + "_xtoggle").html(xToggle.join(" "));
					}
					else{
						$("#toggle_" + heroType[0] + "_x").hide();
						$("#" + heroType[1] + "_xtoggle").html("<option>Disabled</option>");
					}
				}
			}
			else if(endsWith(dataVar,".sd") && !dataVar.includes("toggle")){
				if(hero.sd >= 0){
					var sdToggle = getValidSDToggle(hero.s);
					hero.toggle.sd = 0;
					if(sdToggle.length > 0){
						$("#toggle_" + heroType[0] + "_sd").show();
						$("#" + heroType[1] + "_sdtoggle").html(sdToggle.join(" "));
					}
					else{
						$("#toggle_" + heroType[0] + "_sd").hide();
						$("#" + heroType[1] + "_sdtoggle").html("<option>Disabled</option>");
					}
				}
			}
			else if(endsWith(dataVar,".special") && !dataVar.includes("toggle")){
				if(hero.special >= 0){
					var spToggle = getValidToggle(hero.special, -1, hero.index);
					hero.toggle.special = 0;
					if(spToggle.length > 0){
						$("#toggle_" + heroType[0] + "_special").show();
						$("#" + heroType[1] + "_specialtoggle").html(spToggle.join(" "));
					}
					else{
						$("#toggle_" + heroType[0] + "_special").hide();
						$("#" + heroType[1] + "_specialtoggle").html("<option>Disabled</option>");
					}
				}
				if(data.heroes[hero.index].name == "Lyn (Emblem)"){
					if(newVal != -1 && data.skills[newVal].name == "Astra Storm"){
						if(hero.style == 0){
							hero.style = 2;
						}
						else{
							hero.style = 0;
						}
					}
					else{
						hero.style = 0;
					}
				}
			}
			//style checks (.special & .emblem)
			else if(endsWith(dataVar,".emblem")){
				hero.emerge = 0;
				if(data.heroes[hero.index].name != "Lyn (Emblem)"){
					if(hero.emblem == "Lyn" && data.rangedWeapons.indexOf(data.heroes[hero.index].weapontype) != -1){
						if(hero.style == 0){
							hero.style = 1;
						}
						else{
							hero.style = 0;
						}
					}
					else{
						hero.style = 0;
						//Fix Eirika's style
						if(data.heroes[hero.index].name == "Eirika (Emblem)" && hero.weapon != -1 && data.skills[hero.weapon].name == "Azure Twin Edge"){
							hero.style = 3;
						}
					}
				}
			}
			else if(endsWith(dataVar,".blessing.0")){
				hero.blessing[0] = newVal;
			}
			else if(endsWith(dataVar,".blessing.1")){
				hero.blessing[1] = newVal;
			}
			else if(endsWith(dataVar,".blessing.2")){
				hero.blessing[2] = newVal;
			}
			else if(endsWith(dataVar,".blessing.3")){
				hero.blessing[3] = newVal;
			}
			else if(endsWith(dataVar,".blessing.4")){
				hero.blessing[4] = newVal;
			}
			else if(endsWith(dataVar,".blessing.5")){
				hero.blessing[5] = newVal;
			}
			else if(endsWith(dataVar,".enemyMass")){
				//unchecked
				if(newVal == 0){
					//reenable top area
					$("#plus_value").show();
					$("#cl_enemy_merge").show();
					$("#buff_text").show();
					$("#debuff_text").show();
					$("#spur_text").show();
					$("#cl_enemy_atk_buff").show();
					$("#cl_enemy_spd_buff").show();
					$("#cl_enemy_def_buff").show();
					$("#cl_enemy_res_buff").show();
					$("#cl_enemy_atk_debuff").show();
					$("#cl_enemy_spd_debuff").show();
					$("#cl_enemy_def_debuff").show();
					$("#cl_enemy_res_debuff").show();
					$("#cl_enemy_atk_spur").show();
					$("#cl_enemy_spd_spur").show();
					$("#cl_enemy_def_spur").show();
					$("#cl_enemy_res_spur").show();
					$("#mass_ind_blessing_1").show();
					$("#mass_ind_blessing_2").show();
					$("#mass_ind_blessing_3").show();
					$("#mass_ind_blessing_4").show();
					$("#mass_ind_blessing_5").show();
					$("#mass_ind_blessing_6").show();
					$("#mass_ind_dmg").show();
					$("#mass_ind_precharge").show();
					//hide frame
					$("#mass_frame_rules").hide();
					options.enemyMass = false;
					refreshBuffsUI("cl_enemy");
					refreshStatsUI("cl_enemy",hero);
				}
				//checked
				else{
					//hide top info
					$("#plus_value").hide();
					$("#cl_enemy_merge").hide();
					$("#buff_text").hide();
					$("#debuff_text").hide();
					$("#spur_text").hide();
					$("#cl_enemy_atk_buff").hide();
					$("#cl_enemy_spd_buff").hide();
					$("#cl_enemy_def_buff").hide();
					$("#cl_enemy_res_buff").hide();
					$("#cl_enemy_atk_debuff").hide();
					$("#cl_enemy_spd_debuff").hide();
					$("#cl_enemy_def_debuff").hide();
					$("#cl_enemy_res_debuff").hide();
					$("#cl_enemy_atk_spur").hide();
					$("#cl_enemy_spd_spur").hide();
					$("#cl_enemy_def_spur").hide();
					$("#cl_enemy_res_spur").hide();
					$("#mass_ind_blessing_1").hide();
					$("#mass_ind_blessing_2").hide();
					$("#mass_ind_blessing_3").hide();
					$("#mass_ind_blessing_4").hide();
					$("#mass_ind_blessing_5").hide();
					$("#mass_ind_blessing_6").hide();
					$("#mass_ind_dmg").hide();
					$("#mass_ind_precharge").hide();
					//show frame
					$("#mass_frame_rules").show();
					resetMass();
					options.enemyMass = true;
				}
			}
			else if(endsWith(dataVar,".fStar")){
				hero.bonus.dStar = false;
			}
			else if(endsWith(dataVar,".dStar")){
				hero.bonus.fStar = false;
			}
			else if(endsWith(dataVar,".threatenRule")){
				if(newVal == "Summ. Duels"){
					$("#cl_sd").show();
					$("#hero_sd").show();
				}
				else{
					$("#hero_sd").hide();
					$("#cl_sd").hide();
					$("#toggle_hero_sd").hide();
					$("#toggle_cl_sd").hide();
					for(var i = 0; i < challenger.length; i++){
						challenger[i].sd = -1;
						challenger[i].toggle.sd = 0;
					}
					for(var i = 0; i < enemies.cl.list.length; i++){
						enemies.cl.list[i].sd = -1;
						enemies.cl.list[i].toggle.sd = 0;
					}
				}
			}
			for(var i = 0; i < varsThatChangeSkills.length; i++){
				if(endsWith(dataVar,varsThatChangeSkills[i])){
					setSkills(hero);
					break;
				}
			}
			for(var i = 0; i < varsThatChangeStats.length; i++){
				if(endsWith(dataVar,varsThatChangeStats[i])){
					setStats(hero);
					break;
				}
			}
			
			if(heroType[0] == "hero"){
				updateChallengerUI();
			}
			else if(heroType[0] == "cl"){
				updateEnemyUI();
			}

			if(!blockCalculate){
				if(useCalcuwait){
					if(heroType[0] == "cl"){
						for(var i = 0; i < genericStats.length; i++){
							if(endsWith(dataVar,".generic" + genericStats[i])){
								//pass weapon,a,s values to make sure
								setStats(hero, heroType);
								break;
							}
						}
					}
					calcuWait(300);
				}
				else{
					calculate();
				}
			}
			else{
				outputResults();
			}
		}

		//Don't check parent elements
		e.stopPropagation();
	});

	$("#add_turn_challenger").click(function(){
		addTurn("Challenger initiates");
	});
	$("#add_turn_enemy").click(function(){
		addTurn("Enemy initiates");
	});
	$("#add_dance").click(function(){
		addTurn("Dance");
	});
	//Quick Buff Buttons
	$("#fourfour").click(function(){
		qBuff("fourfour");
	});
	$("#tier_list").click(function(){
		qBuff("tier_list");
	});
	$("#hone").click(function(){
		qBuff("hone");
	});
	$("#full").click(function(){
		qBuff("full");
	});
	$("#buff_reset").click(function(){
		qBuff();
	});

	$(".button_importexport").click(function(){
		var target = "challenger";
		var type = "import";
		if(this.id.indexOf("enemies") != -1){
			target = "enemies";
		}
		if(this.id.indexOf("export") != -1){
			type = "export";
		}
		showImportDialog(target,type);
	});

	$("#import_exit").click(function(){
		hideImportDialog();
	});

	$("#reset_challenger").click(function(){
		resetHero(challenger[options.challengerSelected]);
	});

	$("#reset_cl_enemy").click(function(){
		if(enemies.cl.list[options.customEnemySelected]){
			resetHero(enemies.cl.list[options.customEnemySelected]);
		}
	});
	
	$(".skill_select").mousemove(function(e){
		var tooltipHeight = $("#skill_desc").height();
		if(e.pageY + (tooltipHeight/2) + 10 > $("body").height()){
			$("#skill_desc").css({
				"left": e.pageX + 20 + "px",
				"top": e.pageY - tooltipHeight - 10 + "px"
			});
		}
		else{
			$("#skill_desc").css({
				"left": e.pageX + 20 + "px",
				"top": e.pageY - (tooltipHeight/2) + "px"
			});
		}
	});
	$(".skill_select").mouseover(function(){
		var dataVar = $(this).attr("data-var").split(".");
		var sElement = {};
		var skillText = "";
		if(dataVar[0] == "challenger" && challenger.length > 0 && challenger[options.challengerSelected].index != -1){
			sElement = challenger[options.challengerSelected];
		}
		else if(dataVar[0] == "enemies" && enemies.cl.list.length > 0 && enemies.cl.list[options.customEnemySelected].index != -1){
			dataVar.splice(1,2);
			sElement = enemies.cl.list[options.customEnemySelected];
		}
		if(Object.keys(sElement).length > 0 && sElement[dataVar[1]] != -1){
			if(dataVar[1] == "weapon"){
				if(sElement.refined == 5){
					//split up Falchion
					if(data.skills[sElement[dataVar[1]]].name == "Falchion"){
						var fText = data.skills[sElement[dataVar[1]]].description_S.split("###");
						if(data.heroes[sElement.index].name == "Marth"){
							skillText += fText[0];
						}
						else if(data.heroes[sElement.index].name == "Alm"){
							skillText += fText[2];
						}
						else{
							skillText += fText[1];
						}
					}
					else{
						skillText += data.skills[sElement[dataVar[1]]].description_S;
					}
				}
				else if(sElement.refined < 5 && sElement.refined > 0 && data.skills[sElement[dataVar[1]]].description_R != ""){
					skillText += data.skills[sElement[dataVar[1]]].description_R;
				}
				else{
					skillText += data.skills[sElement[dataVar[1]]].description;
				}
			}
			else if(dataVar[1] == "sd"){
				skillText += data.captainDescriptions[sElement[dataVar[1]]];
			}
			else{
				skillText += data.skills[sElement[dataVar[1]]].description;
			}
			
			$("#skill_desc").html(skillText);
			$("#skill_desc").show();
		}
	});
	$(".skill_select").mouseout(function(){
		$("#skill_desc").html("");
		$("#skill_desc").hide();
	});

	$(document).mousemove(function(e){
		if(showingTooltip){
			var tooltipHeight = $("#frame_tooltip").height();
			if(e.pageY + (tooltipHeight/2) + 10 > $("body").height()){
				$("#frame_tooltip").css({
					"left": e.pageX + 20 + "px",
					"top": e.pageY - tooltipHeight - 10 + "px"
				});
			}
			else{
				$("#frame_tooltip").css({
					"left": e.pageX + 20 + "px",
					"top": e.pageY - (tooltipHeight/2) + "px"
				});
			}
		}
	});
	//Show update notice if hasn't been show for this cookie
	doUpdateNotice();
});

//////////////////////////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////////////////////////

//Data manipulating helper functions

//////////////////////////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////////////////////////

function initHero(hero,alreadyHasSkills){
	if(hero.index != -1){
		hero.naturalSkills = data.heroBaseSkills[hero.index];

		hero.validWeaponSkills = getValidSkills(hero,"weapon");
		hero.validSpecialSkills = getValidSkills(hero,"special");
		hero.validASkills = getValidSkills(hero,"a");
		hero.validBSkills = getValidSkills(hero,"b");
		hero.validCSkills = getValidSkills(hero,"c");
		hero.validSSkills = getValidSkills(hero,"s");
		hero.validXSkills = getValidSkills(hero,"x");
		if(!alreadyHasSkills){
			setSkills(hero);
		}
		else{
			//validate that the skills it already has are okay
			if(!hero.rarity){
				hero.rarity = 5;
			}
			data.skillSlots.forEach(function(slot){
				if(hero["valid" + capitalize(slot) + "Skills"].indexOf(hero[slot]) == -1){
					hero[slot] = -1;
				}
			});
		}
		setSkillOptions(hero);
		setStats(hero);
	}
}

function getValidSkills(hero,slot){
	//returns an array of indices on "skills" array for skills that hero can learn
	//If hero has no index, returns all skills in slot except unique
	//if not given slot, gives all

	var validSkills = [];
	for(var i = 0; i < data.skills.length; i++){
		var inheritRules = data.skills[i].inheritrule.split(","); //Thanks Galeforce (melee,physical)
		if(!slot || data.skills[i].slot == slot){
			if(hero.index != undefined){
				var attackType = getAttackTypeFromWeapon(data.heroes[hero.index].weapontype);
				var inheritRuleMatches = 0;
				for(var ruleNum = 0; ruleNum < inheritRules.length; ruleNum++){
					//console.log("Trying " + slot + ": " + data.skills[i].name);
					if(hero.naturalSkills){
						var natSkills = hero.naturalSkills.flat();
						if(inheritRules[ruleNum] == "unique" && hero.arcane == 0 && (data.heroes[hero.index].rating == 17 || data.heroes[hero.index].rating == 18 || hero.x < 0 || (hero.x > 0 && slot == "weapon"))){
							//can only use if hero starts with it
							for(var j = 0; j < hero.naturalSkills.length; j++){
								if(hero.naturalSkills[j][0] == data.skills[i].skill_id){
									inheritRuleMatches++;
								}
							}
						}
					}
					if(attackType == inheritRules[ruleNum]){
						//inherit if weapon is right attacking type
						inheritRuleMatches++;
					}
					else if(data.weaponTypes.indexOf(inheritRules[ruleNum])!=-1){
						//inherit if weapon is right
						if(data.heroes[hero.index].weapontype==inheritRules[ruleNum]){
							inheritRuleMatches++;
						}
					}
					else if(data.moveTypes.indexOf(inheritRules[ruleNum])!=-1){
						//inherit if movetype is right
						if(data.heroes[hero.index].movetype==inheritRules[ruleNum]){
							inheritRuleMatches++;
						}
					}
					else if(data.weaponTypes.indexOf(inheritRules[ruleNum].replace("non",""))!=-1){
						//inherit if not a certain weapon
						if(data.heroes[hero.index].weapontype!=inheritRules[ruleNum].replace("non","")){
							inheritRuleMatches++;
						}
					}
					else if(data.moveTypes.indexOf(inheritRules[ruleNum].replace("non",""))!=-1){
						//inherit if not a certain movement type
						if(data.heroes[hero.index].movetype!=inheritRules[ruleNum].replace("non","")){
							inheritRuleMatches++;
						}
					}
					else if(data.colors.indexOf(inheritRules[ruleNum].replace("non",""))!=-1){
						//inherit if not a certain color
						if(data.heroes[hero.index].color!=inheritRules[ruleNum].replace("non","")){
							inheritRuleMatches++;
						}
					}
					else if(inheritRules[ruleNum]=="ranged"){
						//inherit if weapon type in ranged group
						if(data.rangedWeapons.indexOf(data.heroes[hero.index].weapontype) != -1){
							inheritRuleMatches++;
						}
					}
					else if(inheritRules[ruleNum]=="melee"){
						//inherit if weapon type in melee group
						if(data.meleeWeapons.indexOf(data.heroes[hero.index].weapontype) != -1){
							inheritRuleMatches++;
						}
					}
					else if(inheritRules[ruleNum]==""){
						//everyone can inherit!
						inheritRuleMatches++;
					}
					else{
						//shouldn't get here
						//console.log("Issue finding logic for inheritrule " + inheritRules[ruleNum]);
					}

					if(inheritRuleMatches == inheritRules.length){
						validSkills.push({"index":i, "name":data.skills[i].name});
					}
				}
			}
			else{
				//It's the right slot, not given hero.index, so it's valid unless unique
				if(inheritRules[0] != "unique"){
					validSkills.push({"index":i, "name":data.skills[i].name});
				}
			}
		}
	}
	validSkills.sort((a,b) => (a.name.toLowerCase() > b.name.toLowerCase()) ? 1 : ((b.name.toLowerCase() > a.name.toLowerCase()) ? -1 : 0));
	var sortedSkills = [];
	for(var i = 0; i < validSkills.length; i++){
		sortedSkills.push(validSkills[i].index);
	}
	return sortedSkills;
}

function getHeroSkills(heroIndex){
	//returns an array of arrays of skill-rarity pairs
	var skillset = [];
	for(var i = 0; i < data.heroSkills.length;i++){
		if(data.heroSkills[i].hero_id==data.heroes[heroIndex].hero_id){
			var skillPair = [data.heroSkills[i].skill_id,data.heroSkills[i].rarity];
			skillset.push(skillPair);
		}
	}
	return skillset;
}

function getMaxSkills(skillset,rarity){
	//Finds max skills based on rarity
	//Gets one with highest sp cost
	var maxSkillset = {"weapon":-1,"special":-1,"a":-1,"b":-1,"c":-1,"x":-1};
	for(var i = 0; i < skillset.length;i++){
		var skillIndex = getSkillIndexFromId(skillset[i][0]);
		var skill = data.skills[skillIndex];
		if((skill.slot != "s" && skill.slot != "assist") && skillset[i][1] <= rarity + 1){
			if(maxSkillset[skill.slot]==-1){
				maxSkillset[skill.slot] = skillIndex;
			}
			else{
				if(data.skills[maxSkillset[skill.slot]].sp < skill.sp){
					maxSkillset[skill.slot] = skillIndex;
				}
			}
		}
	}
	return maxSkillset;
}

function getValidRefine(skillIndex){
	//Finds valid refine options for selected weapon
	var reflist = [];
	if(skillIndex != -1){
		var upgrade = data.skills[skillIndex].upgrade;
		if(upgrade > 0){
			if(upgrade == 1 || upgrade == 2){
				reflist.push("<option value=-1>No Refinement</option>");
				reflist.push("<option value=1>Atk Boost</option>");
				reflist.push("<option value=2>Spd Boost</option>");
				reflist.push("<option value=3>Def Boost</option>");
				reflist.push("<option value=4>Res Boost</option>");
			}
			else if(upgrade == 3 || upgrade == 4){
				reflist.push("<option value=-1>No Refinement</option>");
				reflist.push("<option value=5>Special Skill</option>");
				reflist.push("<option value=1>Atk Boost</option>");
				reflist.push("<option value=2>Spd Boost</option>");
				reflist.push("<option value=3>Def Boost</option>");
				reflist.push("<option value=4>Res Boost</option>");
			}
			else if(upgrade == 5){
				reflist.push("<option value=-1>No Refinement</option>");
				reflist.push("<option value=6>Wrathful Staff</option>");
				reflist.push("<option value=7>Dazzling Staff</option>");
			}
			else if(upgrade == 6){
				reflist.push("<option value=-1>No Refinement</option>");
				reflist.push("<option value=1>Wrathful - Atk</option>");
				reflist.push("<option value=2>Wrathful - Spd</option>");
				reflist.push("<option value=3>Wrathful - Def</option>");
				reflist.push("<option value=4>Wrathful - Res</option>");
				reflist.push("<option value=11>Dazzling - Atk</option>");
				reflist.push("<option value=12>Dazzling - Spd</option>");
				reflist.push("<option value=13>Dazzling - Def</option>");
				reflist.push("<option value=14>Dazzling - Res</option>");
			}
		}
	}
	return reflist;
}

function getValidSDToggle(skillIndex){
	//Finds captain skills that have different effects for captain and ally
	var togglelist = [];
	if(skillIndex != -1){
		var skName = data.captainSkills[skillIndex];
		if(skName == "Adroit Captain" || skName == "Effulgence" || skName == "Flash of Steel" || skName == "Secret Maneuver" || skName == "Storm of Blows" || skName == "Reversal" || skName == "Fault"){
			togglelist.push("<option value=0>Captain</option>");
			togglelist.push("<option value=1>Ally</option>");
		}
		else if(skName == "Dauntless"){
			togglelist.push("<option value=0>2 Spaces</option>");
			togglelist.push("<option value=1>Cardinal</option>");
			togglelist.push("<option value=2>Both</option>");
		}
		else if(skName == "Mass Confusion"){
			togglelist.push("<option value=0>Captain</option>");
			togglelist.push("<option value=1>Enemy Adjacent</option>");
			togglelist.push("<option value=2>Both</option>");
		}
	}
	return togglelist;
}

function getValidToggle(skillIndex,refine,unitIndex){
	//Finds weapons/skills that can be enabled/disabled
	var togglelist = [];
	if(skillIndex != -1){
		var skName = data.skills[skillIndex].name;
		var trName = "";
		if($.isNumeric(skName.charAt(skName.length-1))){
			trName = skName.slice(0,skName.length-2);
		}
		if(skName.charAt(skName.length-1) == "+"){
			trName = skName.slice(0,skName.length-1);;
		}
		//Wind's Brand is unique in that it can trigger owl and enable/disable at the same time
		//Do it first to remove it from pool
		if(skName == "Wind's Brand"){
			if(refine == 5){
				togglelist.push("<option value=0>Disabled, No Ally</option>");
				togglelist.push("<option value=1>Disabled, 1x Ally</option>");
				togglelist.push("<option value=2>Disabled, 2x Ally</option>");
				togglelist.push("<option value=3>Disabled, 3x Ally</option>");
				togglelist.push("<option value=4>Disabled, 4x Ally</option>");
				togglelist.push("<option value=10>Enabled, No Ally</option>");
				togglelist.push("<option value=11>Enabled, 1x Ally</option>");
				togglelist.push("<option value=12>Enabled, 2x Ally</option>");
				togglelist.push("<option value=13>Enabled, 3x Ally</option>");
				togglelist.push("<option value=14>Enabled, 4x Ally</option>");
			}
			else{
				togglelist.push("<option value=0>Disabled</option>");
				togglelist.push("<option value=1>Enabled</option>");
			}
		}
		else if(skName == "Reese's Tome" || skName == "Bull Blade" || skName == "Panther Lance"){
			if(refine == 5){
				togglelist.push("<option value=0>Disabled, No Ally</option>");
				togglelist.push("<option value=1>Disabled, 1x Ally</option>");
				togglelist.push("<option value=2>Disabled, 2x Ally</option>");
				togglelist.push("<option value=3>Disabled, 3x Ally</option>");
				togglelist.push("<option value=4>Disabled, 4x Ally</option>");
				togglelist.push("<option value=10>Enabled, No Ally</option>");
				togglelist.push("<option value=11>Enabled, 1x Ally</option>");
				togglelist.push("<option value=12>Enabled, 2x Ally</option>");
				togglelist.push("<option value=13>Enabled, 3x Ally</option>");
				togglelist.push("<option value=14>Enabled, 4x Ally</option>");
			}
			else{
				togglelist.push("<option value=0>No Ally</option>");
				togglelist.push("<option value=1>1x Ally</option>");
				togglelist.push("<option value=2>2x Ally</option>");
				togglelist.push("<option value=3>3x Ally</option>");
				togglelist.push("<option value=4>4x Ally</option>");
			}
		}
		//AR Tier 4 skills tied to # of structures
		else if(skName.indexOf("AR-") != -1 && skName.endsWith("4")){
			togglelist.push("<option value=0>Disabled</option>");
			togglelist.push("<option value=3><= 3</option>");
			togglelist.push("<option value=4>4</option>");
			togglelist.push("<option value=5>>= 5</option>");
		}
		//AR skills tied to # of structures
		else if(skName.indexOf("AR-") != -1){
			togglelist.push("<option value=0>Disabled</option>");
			togglelist.push("<option value=2><= 2</option>");
			togglelist.push("<option value=3>3</option>");
			togglelist.push("<option value=4>4</option>");
			togglelist.push("<option value=5>>= 5</option>");
		}
		//Savage/Divine Breath scales to 3x ally count
		else if(skName == "Savage Breath" || skName == "Divine Breath" || skName == "Charging Horn" || skName == "Sturdy War Sword" || skName == "Assured Rebirth" || ((skName == "Covert Cat Fang" || skName == "Covert Cat Fang 2" || skName == "Sun's Percussors") && refine == 5) || skName == "Tender Excalibur" || skName == "Perspicacious" || skName == "Silver of Dawn" || skName == "Scroll of Teas" || data.toggleForm.indexOf(skName) != -1){
			togglelist.push("<option value=0>No Ally</option>");
			togglelist.push("<option value=1>1x Ally</option>");
			togglelist.push("<option value=2>2x Ally</option>");
			if(skName == "Savage Breath" && refine > 0){
				togglelist.push("<option value=3>3x Ally</option>");
				togglelist.push("<option value=4>4+ Ally</option>");
			}
			else{
				togglelist.push("<option value=3>3+ Ally</option>");
			}
		}
		//Do Falchion next, as there's different versions.  Only applies to Awakening Falchion
		else if(skName == "Falchion" && refine == 5 && (data.heroes[unitIndex].name == "Lucina" || data.heroes[unitIndex].name == "Marth (Masked)" || data.heroes[unitIndex].name == "Chrom")){
			togglelist.push("<option value=0>Disabled</option>");
			togglelist.push("<option value=1>Enabled</option>");
		}
		//Owl-type skill
		else if(data.toggleOwl.indexOf(skName) != -1 || (skName == "Hermit's Tome" && refine == 5)){
			togglelist.push("<option value=0>No Ally</option>");
			togglelist.push("<option value=1>1x Ally</option>");
			togglelist.push("<option value=2>2x Ally</option>");
			togglelist.push("<option value=3>3x Ally</option>");
			togglelist.push("<option value=4>4x Ally</option>");
		}
		//Shield/blade Session is 0, 1, 2+
		else if(skName.indexOf("Shield Session") != -1 || skName.indexOf("Blade Session") != -1 || skName == "Mirage Falchion" || (skName == "Mirage Axe" && refine > 0)){
			togglelist.push("<option value=0>0 acted</option>");
			togglelist.push("<option value=1>1 acted</option>");
			togglelist.push("<option value=2>2+ acted</option>");
		}
		//Whitedown Spear
		else if(skName == "Whitedown Spear"){
			if(refine > 0){
				togglelist.push("<option value=0>Disabled</option>");
				togglelist.push("<option value=1>>= 2 Fliers in 3</option>");
			}
			else{
				togglelist.push("<option value=0>Disabled</option>");
				togglelist.push("<option value=1>>= 3 Fliers</option>");
				togglelist.push("<option value=2>>= 2 Fliers in 2</option>");
				togglelist.push("<option value=3>Both Enabed</option>");
			}
		}
		//Dark Creator S
		else if(skName == "Dark Creator S"){
			togglelist.push("<option value=0>Disabled</option>");
			togglelist.push("<option value=11>[1st Com] 1x Ally</option>");
			togglelist.push("<option value=12>[1st Com] 2x Ally</option>");
			togglelist.push("<option value=13>[1st Com] 3x Ally</option>");
			togglelist.push("<option value=1>1x Ally</option>");
			togglelist.push("<option value=2>2x Ally</option>");
			togglelist.push("<option value=3>3x Ally</option>");
		}
		//Blade of Renais/Bright-Shell Egg
		else if(skName == "Blade of Renais" || skName == "Bright-Shell Egg"){
			togglelist.push("<option value=0>Disabled, No Bonus/Penalty</option>");
			togglelist.push("<option value=1>Disabled, Bonus/Penalty</option>");
			togglelist.push("<option value=2>Enabled, No Bonus/Penalty</option>");
			togglelist.push("<option value=3>Enabled, Bonus/Penalty</option>");
		}
		//Muninn's Egg has 3 variations depending on refine
		else if(skName == "Muninn's Egg" && refine == 5){
			togglelist.push("<option value=0>Disabled, No Ally</option>");
			togglelist.push("<option value=1>Atk Only, No Ally</option>");
			togglelist.push("<option value=2>Res Only, No Ally</option>");
			togglelist.push("<option value=3>Atk & Res, No Ally</option>");
			togglelist.push("<option value=10>Disabled, Ally</option>");
			togglelist.push("<option value=11>Atk Only, Ally</option>");
			togglelist.push("<option value=12>Res Only, Ally</option>");
			togglelist.push("<option value=13>Atk & Res, Ally</option>");
		}
		else if(skName == "Muninn's Egg" && refine > 0){
			togglelist.push("<option value=0>Disabled</option>");
			togglelist.push("<option value=1>Atk Only</option>");
			togglelist.push("<option value=2>Res Only</option>");
			togglelist.push("<option value=3>Atk & Res</option>");
		}
		//Huginn's Egg also has 3 variations depending on refine
		else if(skName == "Huginn's Egg" && refine == 5){
			togglelist.push("<option value=0>Disabled, No Ally</option>");
			togglelist.push("<option value=1>Atk Only, No Ally</option>");
			togglelist.push("<option value=2>Spd Only, No Ally</option>");
			togglelist.push("<option value=3>Atk & Spd, No Ally</option>");
			togglelist.push("<option value=10>Disabled, Ally</option>");
			togglelist.push("<option value=11>Atk Only, Ally</option>");
			togglelist.push("<option value=12>Spd Only, Ally</option>");
			togglelist.push("<option value=13>Atk & Spd, Ally</option>");
		}
		else if(skName == "Huginn's Egg" && refine > 0){
			togglelist.push("<option value=0>Disabled</option>");
			togglelist.push("<option value=1>Atk Only</option>");
			togglelist.push("<option value=2>Spd Only</option>");
			togglelist.push("<option value=3>Atk & Spd</option>");
		}
		else if(skName == "Nifl Frostflowers" || skName == "Verdict of Sacae" || skName == "All Together!" || skName == "Heralding Horn" || skName == "Joyous Tome" || skName == "Liberation" || skName == "Dawnsweet Box" || skName == "Dragon's Fist" || skName == "World-Tree Tail" || skName == "Divine One's Arts" || skName == "Sky-Hopper Egg" || skName == "Closing Florets" || skName == "United Bouquet" || skName == "Love of Nerthuz" || skName == "Maritime Arts" || skName == "Breaker Bow" || skName == "Small Spade" || skName == "Small Spade+" || skName == "Anchor Axe" || skName == "Anchor Axe+" || skName == "Wintery Arts" || skName == "Helping Dagger" || skName == "Helping Dagger+" || skName == "Called to Serve" || skName == "Ancient Betrayal"){
			togglelist.push("<option value=0>No Ally</option>");
			togglelist.push("<option value=1>1x Ally</option>");
			if((skName == "Nifl Frostflowers" && refine > 0) || skName == "Verdict of Sacae" || skName == "All Together!" || skName == "Liberation" || skName == "Dawnsweet Box" || skName == "Dragon's Fist" || skName == "Divine One's Arts" || skName == "Sky-Hopper Egg" || skName == "Ancient Betrayal"){
				togglelist.push("<option value=2>2+ Ally</option>");
			}
			else{
				togglelist.push("<option value=2>2x Ally</option>");
				togglelist.push("<option value=3>3+ Ally</option>");
			}
		}
		else if(skName == "Genesis Falchion"){
			togglelist.push("<option value=0>Disabled</option>");
			togglelist.push("<option value=1>>= 10</option>");
			togglelist.push("<option value=2>>= 25</option>");
			togglelist.push("<option value=3>>= 60</option>");
		}
		else if(skName == "Shield of Hope"){
			togglelist.push("<option value=0>Disabled</option>");
			togglelist.push("<option value=1>>= 20</option>");
			togglelist.push("<option value=2>>= 40</option>");
			togglelist.push("<option value=3>>= 60</option>");
			togglelist.push("<option value=4>>= 60, 1st</option>");
		}
		else if(skName == "Wolf Queen Fang"){
			if(refine < 0){
				togglelist.push("<option value=0>No Ally</option>");
				togglelist.push("<option value=1>1x Ally</option>");
				togglelist.push("<option value=2>2x Ally</option>");
				togglelist.push("<option value=3>3x Ally</option>");
			}
			else{
				togglelist.push("<option value=0>Disabled</option>");
				togglelist.push("<option value=1>Enabled</option>");
			}
		}
		else if(skName == "Wolf Berg"){
			if(refine > 0){
				togglelist.push("<option value=0>No Enemy, Disabled</option>");
				togglelist.push("<option value=1>Enemy in 4, Disabled</option>");
				togglelist.push("<option value=2>No Enemy, Enabled</option>");
				togglelist.push("<option value=3>Enemy in 4, Enabled</option>");
			}
			else{
				togglelist.push("<option value=0>Disabled</option>");
				togglelist.push("<option value=1>Enabled</option>");
			}
		}
		else if(skName == "Thokk"){
			if(refine == 5){
				togglelist.push("<option value=0>Both Disabled</option>");
				togglelist.push("<option value=1>Cardinal, Disabled</option>");
				togglelist.push("<option value=2>Disabled, Low Spd</option>");
				togglelist.push("<option value=3>Cardinal, Low Spd</option>");
			}
			else if(refine > 0){
				togglelist.push("<option value=0>Disabled</option>");
				togglelist.push("<option value=1>Enabled</option>");
			}
		}
		else if(skName == "Blade of Jehanna"){
			togglelist.push("<option value=0>Diagonal</option>");
			togglelist.push("<option value=1>Cardinal</option>");
		}
		else if(skName == "Achimenes Furl"){
			togglelist.push("<option value=0>Disabled</option>");
			togglelist.push("<option value=1>>= 1 Move Type</option>");
			togglelist.push("<option value=2>>= 2 Move Types</option>");
			togglelist.push("<option value=3>>= 3 Move Types</option>");
		}
		else if(skName == "Book of Dreams"){
			if(refine > 0){
				togglelist.push("<option value=0>Disabled</option>");
				togglelist.push("<option value=1>Within 2 Spaces</option>");
				togglelist.push("<option value=2>Closest Enemy</option>");
				togglelist.push("<option value=3>Both Enabled</option>");
			}
			else{
				togglelist.push("<option value=0>Disabled</option>");
				togglelist.push("<option value=1>Enabled</option>");
			}
		}
		else if((skName == "Vedrfolnir's Egg" || skName == "Saintly Seraphim") && refine == 5){
			togglelist.push("<option value=0>Disabled</option>");
			togglelist.push("<option value=1>2 Spaces</option>");
			togglelist.push("<option value=2>3 Spaces</option>");
		}
		else if(skName == "Fiery Bolganone"){
			togglelist.push("<option value=0>Disabled</option>");
			togglelist.push("<option value=1>Within 4 Spaces</option>");
			togglelist.push("<option value=2>Not Adjacent</option>");
			togglelist.push("<option value=3>Both Enabled</option>");
		}
		else if(skName == "True Dragon Wall" || skName == "Pure Dragon Wall"){
			togglelist.push("<option value=0>Disabled</option>");
			togglelist.push("<option value=1>First Combat</option>");
			togglelist.push("<option value=2>Dragon/Beast Ally</option>");
			togglelist.push("<option value=3>Both Enabled</option>");
		}
		else if((skName == "Kitsune Fang" || skName == "Kitsune Fang 2") && refine > 0){
			togglelist.push("<option value=0>Disabled</option>");
			togglelist.push("<option value=1>3 Spaces</option>");
			if(refine == 5){
				togglelist.push("<option value=2>2 Spaces</option>");
			}
		}
		else if(skName == "Faith in Humanity"){
			togglelist.push("<option value=0>Disabled</option>");
			togglelist.push("<option value=1>3 Spaces Human Ally</option>");
			togglelist.push("<option value=2>>= 2 Human Allies</option>");
			togglelist.push("<option value=3>Both Enabled</option>");
		}
		else if(skName == "Wolfpup Fang" && refine > 0){
			if(refine == 5){
				togglelist.push("<option value=0>Disabled</option>");
				togglelist.push("<option value=1>2 Spaces</option>");
				togglelist.push("<option value=2>3 Spaces (S.Partner)</option>");
				togglelist.push("<option value=3>Both Enabled</option>");
			}
			else{
				togglelist.push("<option value=0>Disabled</option>");
				togglelist.push("<option value=1>Enabled</option>");
			}
		}
		else if(skName == "Kormt" || skName == "Icy Ravager"){
			togglelist.push("<option value=0>0 Conditions</option>");
			togglelist.push("<option value=1>1 Condition</option>");
			togglelist.push("<option value=2>2 Conditions</option>");
			togglelist.push("<option value=3>3+ Conditions</option>");
		}
		else if(skName == "Sabertooth Fang"){
			if(refine == 5){
				togglelist.push("<option value=0>Disabled</option>");
				togglelist.push("<option value=1>Move Assist</option>");
				togglelist.push("<option value=2>Ally 3 Spaces</option>");
				togglelist.push("<option value=3>Both Enabled</option>");
			}
			else{
				togglelist.push("<option value=0>Disabled</option>");
				togglelist.push("<option value=1>Enabled</option>");
			}
		}
		else if(skName == "Silent Yule Knife" || skName == "Black Yule Lance" || skName == "Blue Yule Axe" || skName == "Holy Yule Blade" || skName.indexOf("Golden Yule Bow") != -1){
			togglelist.push("<option value=0>0 Space</option>");
			togglelist.push("<option value=1>1 Space</option>");
			togglelist.push("<option value=2>2 Spaces</option>");
			togglelist.push("<option value=3>3 Spaces</option>");
		}
		else if(skName == "Queenslance"){
			togglelist.push("<option value=0>Disabled</option>");
			togglelist.push("<option value=1>Within 2 Spaces</option>");
			togglelist.push("<option value=2>Bonus Active</option>");
			togglelist.push("<option value=3>Both Enabled</option>");
		}
		else if(skName == "Flower Hauteclere" && refine == 5){
			togglelist.push("<option value=0>Disabled</option>");
			togglelist.push("<option value=1>0 Space</option>");
			togglelist.push("<option value=2>1 Space</option>");
			togglelist.push("<option value=3>2 Spaces</option>");
			togglelist.push("<option value=4>3 Spaces</option>");
		}
		else if(skName == "Blade of Favors" || skName == "Rite of Souls" || skName == "Duskbloom Bow"){
			togglelist.push("<option value=0>Disabled</option>");
			togglelist.push("<option value=1>In Position</option>");
			togglelist.push("<option value=2>Ally 2 Spaces</option>");
			togglelist.push("<option value=3>Both Enabled</option>");
		}
		else if(skName == "Lance of Heroics"){
			if(refine == 5){
				togglelist.push("<option value=0>0, No ally</option>");
				togglelist.push("<option value=1>1, No ally</option>");
				togglelist.push("<option value=2>2, No ally</option>");
				togglelist.push("<option value=3>3, No ally</option>");
				togglelist.push("<option value=4>4+, No ally</option>");
				togglelist.push("<option value=10>0, Ally in 3</option>");
				togglelist.push("<option value=11>1, Ally in 3</option>");
				togglelist.push("<option value=12>2, Ally in 3</option>");
				togglelist.push("<option value=13>3, Ally in 3</option>");
				togglelist.push("<option value=14>4+, Ally in 3</option>");
			}
			else{
				togglelist.push("<option value=0>0 Spaces</option>");
				togglelist.push("<option value=1>1 Space</option>");
				togglelist.push("<option value=2>2 Spaces</option>");
				togglelist.push("<option value=3>3 Spaces</option>");
				togglelist.push("<option value=4>4+ Spaces</option>");
			}
		}
		else if(skName == "Coyote's Lance"){
			togglelist.push("<option value=0>Disabled</option>");
			togglelist.push("<option value=1>Within 3 Spaces</option>");
			togglelist.push("<option value=2>Ally 2 Spaces</option>");
			togglelist.push("<option value=3>Both Enabled</option>");
		}
		else if(skName == "Enclosing Dark" || skName == "Fang of Finality"){
			togglelist.push("<option value=0>Disabled, 0 Foes</option>");
			togglelist.push("<option value=1>Disabled, 1 Foe</option>");
			togglelist.push("<option value=2>Disabled, 2+ Foes</option>");
			togglelist.push("<option value=10>Alone, 0 Foes</option>");
			togglelist.push("<option value=11>Alone, 1 Foe</option>");
			togglelist.push("<option value=12>Alone, 2+ Foes</option>");
		}
		else if(skName == "Sable Lance" || skName == "Command Lance" || skName == "Sisterly Axe" || skName.indexOf("Incite Hone") != -1){
			if(refine == 5 || skName == "Sisterly Axe" || skName.indexOf("Incite Hone") != -1){
				togglelist.push("<option value=0>0, Disabled</option>");
				togglelist.push("<option value=1>1, Disabled</option>");
				togglelist.push("<option value=2>2, Disabled</option>");
				togglelist.push("<option value=3>3+, Disabled</option>");
				togglelist.push("<option value=10>0, Enabled</option>");
				togglelist.push("<option value=11>1, Enabled</option>");
				togglelist.push("<option value=12>2, Enabled</option>");
				togglelist.push("<option value=13>3+, Enabled</option>");
			}
			else{
				togglelist.push("<option value=0>Disabled</option>");
				togglelist.push("<option value=10>Enabled</option>");
			}
		}
		else if(skName == "Child's Compass" || (skName == "Binding Reginleif" && refine == 5) || skName == "Lull Spd Def 4" || skName == "Lull Atk Def 4" || skName == "Lull Spd Res 4"){
			togglelist.push("<option value=0>Disabled</option>");
			togglelist.push("<option value=1>1 Bonus</option>");
			togglelist.push("<option value=2>2 Bonus</option>");
			togglelist.push("<option value=3>3 Bonus</option>");
			togglelist.push("<option value=4>4+ Bonus</option>");
		}
		else if(skName == "Killing Intent+"){
			togglelist.push("<option value=0>Disabled</option>");
			togglelist.push("<option value=1>Exposure</option>");
			togglelist.push("<option value=2>Only Penalty</option>");
		}
		else if((skName == "Astra Blade" && refine > 0) || skName == "Bow of Repose" || skName == "The Fire Emblem"){
			if((skName == "Astra Blade" && refine == 5) || skName == "Bow of Repose" || skName == "The Fire Emblem"){
				togglelist.push("<option value=0>No ally, 0</option>");
				togglelist.push("<option value=1>No ally, 1</option>");
				togglelist.push("<option value=2>No ally, 2</option>");
				togglelist.push("<option value=3>No ally, 3</option>");
				togglelist.push("<option value=4>No ally, 4+</option>");
				togglelist.push("<option value=10>Ally in 2, 0</option>");
				togglelist.push("<option value=11>Ally in 2, 1</option>");
				togglelist.push("<option value=12>Ally in 2, 2</option>");
				togglelist.push("<option value=13>Ally in 2, 3</option>");
				togglelist.push("<option value=14>Ally in 2, 4+</option>");
			}
			else{
				togglelist.push("<option value=0>Disabled</option>");
				togglelist.push("<option value=10>Enabled</option>");
			}
		}
		else if(skName == "Fimbulvetr"){
			if(refine == 5){
				togglelist.push("<option value=0>Disabled</option>");
				togglelist.push("<option value=1>Penalty active</option>");
				togglelist.push("<option value=2>Ally 3 Spaces</option>");
				togglelist.push("<option value=3>Support 3 Spaces</option>");
				togglelist.push("<option value=4>Penalty + Ally</option>");
				togglelist.push("<option value=5>Penalty + Support</option>");
			}
			else{
				togglelist.push("<option value=0>Disabled</option>");
				togglelist.push("<option value=1>Enabled</option>");
			}
		}
		else if(skName == "Sunlight Bangle"){
			togglelist.push("<option value=0>Disabled</option>");
			togglelist.push("<option value=1>0 Spaces</option>");
			togglelist.push("<option value=2>1 Space</option>");
			togglelist.push("<option value=3>2 Spaces</option>");
			togglelist.push("<option value=4>3 Spaces</option>");
			togglelist.push("<option value=5>4 Spaces</option>");
		}
		else if(skName.indexOf("Seaside Parasol") != -1|| skName == "Partnership Bow"){
			togglelist.push("<option value=0>Disabled, 0 Effects</option>");
			togglelist.push("<option value=1>Disabled, 1 Effects</option>");
			togglelist.push("<option value=2>Disabled, 2 Effects</option>");
			togglelist.push("<option value=3>Disabled, 3 Effects</option>");
			togglelist.push("<option value=4>Disabled, 4 Effects</option>");
			togglelist.push("<option value=10>Enabled, 0 Effects</option>");
			togglelist.push("<option value=11>Enabled, 1 Effects</option>");
			togglelist.push("<option value=12>Enabled, 2 Effects</option>");
			togglelist.push("<option value=13>Enabled, 3 Effects</option>");
			togglelist.push("<option value=14>Enabled, 4 Effects</option>");
		}
		else if(skName == "Randgridr" && refine == 5){
			togglelist.push("<option value=0>Disabled</option>");
			togglelist.push("<option value=1>Ally, No Bonus</option>");
			togglelist.push("<option value=2>No Ally, Bonus</option>");
			togglelist.push("<option value=3>Both Enabled</option>");
		}
		else if(skName == "Divine Draught"){
			togglelist.push("<option value=0>Disabled</option>");
			togglelist.push("<option value=1>1 Condition</option>");
			togglelist.push("<option value=2>Both</option>");
		}
		else if(skName == "Eagle's Egg"){
			if(refine == 5){
				togglelist.push("<option value=0>Disabled</option>");
				togglelist.push("<option value=1>Within 2 Spaces</option>");
				togglelist.push("<option value=2>Turn Start/Trigger</option>");
				togglelist.push("<option value=3>Penalty On</option>");
				togglelist.push("<option value=4>2 Sp + T Start</option>");
				togglelist.push("<option value=5>2 Sp + Penalty</option>");
				togglelist.push("<option value=6>T Start + Penalty</option>");
				togglelist.push("<option value=7>All 3 Enabled</option>");
			}
			else{
				togglelist.push("<option value=0>Disabled</option>");
				togglelist.push("<option value=1>Enabled</option>");
			}
		}
		else if(skName == "Spy's Shuriken"){
			togglelist.push("<option value=0>Disabled</option>");
			togglelist.push("<option value=1>Enabled, Not Cardinal</option>");
			togglelist.push("<option value=2>Both Enabled</option>");
		}
		else if(skName == "Great Aether" || skName == "Rampart Bow"){
			togglelist.push("<option value=1>1 Enemy</option>");
			togglelist.push("<option value=2>2 Enemies</option>");
			togglelist.push("<option value=3>3 Enemies</option>");
			if(skName == "Great Aether"){
				togglelist.push("<option value=4>4 Enemies</option>");
				togglelist.push("<option value=5>5 Enemies</option>");
				togglelist.push("<option value=6>6 Enemies</option>");
				togglelist.push("<option value=7>7 Enemies</option>");
				togglelist.push("<option value=8>8 Enemies</option>");
			}
			else{
				togglelist.push("<option value=4>4+ Enemies</option>");
			}
		}
		else if(skName == "Astral Breath" && refine > 0){
			if(refine == 5){
				togglelist.push("<option value=0>Disabled, 0 Spaces</option>");
				togglelist.push("<option value=1>Disabled, 1 Space</option>");
				togglelist.push("<option value=2>Disabled, 2 Spaces</option>");
				togglelist.push("<option value=3>Disabled, 3 Spaces</option>");
				togglelist.push("<option value=4>Disabled, 4+ Spaces</option>");
				togglelist.push("<option value=10>Start, 0 Spaces</option>");
				togglelist.push("<option value=11>Start, 1 Space</option>");
				togglelist.push("<option value=12>Start, 2 Spaces</option>");
				togglelist.push("<option value=13>Start, 3 Spaces</option>");
				togglelist.push("<option value=14>Start, 4+ Spaces</option>");
			}
			else{
				togglelist.push("<option value=0>Disabled</option>");
				togglelist.push("<option value=10>Start of Turn</option>");
			}
		}
		else if(skName == "Professorial Text"){
			if(refine == 5){
				togglelist.push("<option value=0>No Ally</option>");
				togglelist.push("<option value=1>1 Ally</option>");
				togglelist.push("<option value=2>2 Allies</option>");
				togglelist.push("<option value=3>3 Allies</option>");
				togglelist.push("<option value=4>4 Allies</option>");
				togglelist.push("<option value=5>5 Allies</option>");
				togglelist.push("<option value=6>6 Allies</option>");
				togglelist.push("<option value=7>7 Allies</option>");
			}
			else{
				togglelist.push("<option value=0>Disabled</option>");
				togglelist.push("<option value=1>Enabled</option>");
			}
		}
		else if(skName == "Obsidian Tactics"){
			togglelist.push("<option value=0>No Bonus</option>");
			togglelist.push("<option value=1>1 Bonus</option>");
			togglelist.push("<option value=2>2 Bonuses</option>");
			togglelist.push("<option value=3>3 Bonuses</option>");
			togglelist.push("<option value=4>4 Bonuses</option>");
			togglelist.push("<option value=5>5 Bonuses</option>");
			togglelist.push("<option value=6>6+ Bonuses</option>");
		}
		else if(skName == "Atk Spd Link 4" || skName == "Spd Def Link 4"){
			togglelist.push("<option value=0>Disabled</option>");
			togglelist.push("<option value=1>Assist</option>");
			togglelist.push("<option value=2>Canto On</option>");
			togglelist.push("<option value=3>Both Enabled</option>");
		}
		else if(skName == "Divine Nectar" || skName == "Nectar's Magic"){
			togglelist.push("<option value=0>Disabled</option>");
			togglelist.push("<option value=1>Start of Turn</option>");
			togglelist.push("<option value=2>Start + 1st</option>");
		}
		else if(skName == "Dual Sword"){
			togglelist.push("<option value=0>Disabled</option>");
			togglelist.push("<option value=1>1 Instance</option>");
			togglelist.push("<option value=2>2+ Instances</option>");
		}
		else if(skName == "Spd Res Discord" || skName == "Atk Res Discord" || skName == "Def Res Discord"){
			togglelist.push("<option value=0>Disabled, 0</option>");
			togglelist.push("<option value=1>Disabled, 1</option>");
			togglelist.push("<option value=2>Disabled, 2+</option>");
			togglelist.push("<option value=10>Start, 0</option>");
			togglelist.push("<option value=11>Start, 1</option>");
			togglelist.push("<option value=12>Start, 2+</option>");
		}
		else if(skName == "Quieting Claw"){
			togglelist.push("<option value=0>Disabled</option>");
			togglelist.push("<option value=1>1 Condition</option>");
			togglelist.push("<option value=2>2+ Conditions</option>");
		}
		else if(skName == "Yggdrasill's Alter"){
			togglelist.push("<option value=0>Disabled, 0 Enemy</option>");
			togglelist.push("<option value=1>Disabled, 1 Enemy</option>");
			togglelist.push("<option value=2>Disabled, 2+ Enemies</option>");
			togglelist.push("<option value=10>Enabled, 0 Enemy</option>");
			togglelist.push("<option value=11>Enabled, 1 Enemy</option>");
			togglelist.push("<option value=12>Enabled, 2+ Enemies</option>");
		}
		else if(skName == "Pure Storm"){
			togglelist.push("<option value=0>Disabled</option>");
			togglelist.push("<option value=1>Debuff</option>");
			togglelist.push("<option value=2>Entered Combat</option>");
			togglelist.push("<option value=3>Both Enabled</option>");
		}
		//Skills that have a start turn/trigger toggle and a during combat toggle
		else if(data.toggleStartDuring.indexOf(skName) != -1){
			togglelist.push("<option value=0>Disabled</option>");
			togglelist.push("<option value=1>Start of Turn</option>");
			togglelist.push("<option value=2>During Combat</option>");
			togglelist.push("<option value=3>Both Enabled</option>");
		}
		//Skills that have a start of turn skill
		else if(data.toggleStartTurn.indexOf(skName) != -1 || (trName != "" && data.toggleStartTurn.indexOf(trName) != -1)){
			togglelist.push("<option value=0>Disabled</option>");
			togglelist.push("<option value=1>Start of Turn</option>");
		}
		else if((data.toggleRefinedStartTurn.indexOf(skName) != -1 && refine == 5) || (data.toggleAnyRefinedStartTurn.indexOf(skName) != -1 && refine > 0)){
			togglelist.push("<option value=0>Disabled</option>");
			togglelist.push("<option value=1>Start of Turn</option>");
		}
		//Weapons that have a toggle for any refine and different toggle activation for special refine
		else if(data.toggleBothPostRefine.indexOf(skName) != -1 && refine > 0){
			if(refine == 5){
				togglelist.push("<option value=0>Disabled</option>");
				togglelist.push("<option value=1>Only Refined</option>");
				togglelist.push("<option value=2>Only Special Refined</option>");
				togglelist.push("<option value=3>Both Enabled</option>");
			}
			else{
				togglelist.push("<option value=0>Disabled</option>");
				togglelist.push("<option value=1>Enabled</option>");
			}
		}
		//Weapons that have a toggle for base weapon and different toggle activation for special refine
		else if(data.toggleBothRefine.indexOf(skName) != -1 && refine == 5){
			togglelist.push("<option value=0>Disabled</option>");
			togglelist.push("<option value=1>Only Base</option>");
			togglelist.push("<option value=2>Only Refined</option>");
			togglelist.push("<option value=3>Both Enabled</option>");
		}
		//List of various skills that have tiers (1 to 4 or + for weapons) or any outstanding skill (like Fensalir)
		else if(trName != "" && data.toggleNumberSkills.indexOf(trName) != -1 || (skName == "Fensalir" && refine < 0)){
			togglelist.push("<option value=0>Disabled</option>");
			togglelist.push("<option value=1>Enabled</option>");
		}
		//The rest
		else if(data.toggleSkills.indexOf(skName) != -1 || (data.toggleRefined.indexOf(skName) != -1 && refine == 5) || (data.toggleBothRefine.indexOf(skName) != -1 && refine != 5) || (data.toggleAnyRefine.indexOf(skName) != -1 && refine > 0) || (data.toggleBase.indexOf(skName) != -1 && refine < 0) || (skName == "Fensalir" && refine < 0)){
			togglelist.push("<option value=0>Disabled</option>");
			togglelist.push("<option value=1>Enabled</option>");
		}
	}
	return togglelist;
}

function setStats(hero, heroType){
	if(hero.index != -1 && data.heroes[hero.index].name.indexOf("generic") != -1){
		if(typeof hero.generic != "undefined"){
			hero.hp = hero.generic.hp;
			hero.atk = hero.generic.atk;
			hero.spd = hero.generic.spd;
			hero.def = hero.generic.def;
			hero.res = hero.generic.res;
		}
		//Only add weapon stats if weapon has been changed
		if(!heroType){
			//Add stats based on skills
			if(hero.weapon != -1){
				hero.hp += data.skills[hero.weapon].hp;
				hero.atk += data.skills[hero.weapon].atk;
				hero.spd += data.skills[hero.weapon].spd;
				hero.def += data.skills[hero.weapon].def;
				hero.res += data.skills[hero.weapon].res;
				
				//Add Refinement boost
				if(hero.refined != -1 && ((data.skills[hero.weapon].upgrade < 5 && data.skills[hero.weapon].upgrade > 0) || data.skills[hero.weapon].upgrade == 6)){
					var modifier = data.skills[hero.weapon].upgrade % 2;
					if(modifier == 0){
						hero.hp += 2;
					}
					else if(modifier == 1){
						hero.hp += 5;
					}
					hero.atk += data.skills[hero.weapon].bonusmt;
					if(hero.refined % 10 == 1){
						hero.atk += modifier + 1;
					}
					else if(hero.refined % 10 == 2){
						hero.spd += modifier + 2;
					}
					else if(hero.refined % 10 == 3){
						hero.def += modifier + 3;
					}
					else if(hero.refined % 10 == 4){
						hero.res += modifier + 3;
					}
					else if(hero.refined == 5){
						hero.hp -= 2;
					}
					if((data.skills[hero.weapon].name == "Mystletainn" || data.skills[hero.weapon].name == "Axe of Virility" || data.skills[hero.weapon].name == "Hinata's Katana") && hero.refined == 5){
						hero.atk += 3;
						hero.spd += 3;
						hero.def += 3;
						hero.res += 3;
					}
					else if((data.skills[hero.weapon].name == "Basilikos" || data.skills[hero.weapon].name == "Solitary Blade") && hero.refined == 5){
						hero.atk += 5;
						hero.spd += 5;
						hero.def -= 5;
						hero.res -= 5;
					}
					else if(data.skills[hero.weapon].name == "Yato"){
						hero.atk += 2;
						hero.spd += 2;
						hero.def += 2;
						hero.res += 2;
					}
					else if(data.skills[hero.weapon].name == "Cursed Lance" && hero.refined > 0){
						hero.atk += 1;
						hero.spd += 1;
						hero.def += 3;
						hero.res += 3;
					}
					else if(data.skills[hero.weapon].name == "Ayra's Blade" && hero.refined > 0){
						hero.atk += 3;
					}
					else if(data.skills[hero.weapon].name == "Nurturing Breath" && hero.refined == 5){
						hero.atk += 4;
						hero.spd += 4;
						hero.def += 4;
						hero.res += 4;
					}
					else if(data.skills[hero.weapon].name == "Goddess Axe" && hero.refined > 0){
						hero.hp += 5;
						hero.atk += 6;
						hero.def += 1;
					}
					else if(data.skills[hero.weapon].name == "Twin Star Axe" && hero.refined > 0){
						hero.atk += 5;
						hero.def += 5;
						hero.res += 5;
					}
					else if(data.skills[hero.weapon].name == "Tailwind Shuriken" && hero.refined > 0){
						hero.atk += 6;
						hero.spd += 2;
					}
				}
			}
	
			//A-passive and S only ones that affects stats
			if(hero.a != -1){
				hero.hp += data.skills[hero.a].hp;
				hero.atk += data.skills[hero.a].atk;
				hero.spd += data.skills[hero.a].spd;
				hero.def += data.skills[hero.a].def;
				hero.res += data.skills[hero.a].res;
			}
			if(hero.s != -1){
				hero.hp += data.skills[hero.s].hp;
				hero.atk += data.skills[hero.s].atk;
				hero.spd += data.skills[hero.s].spd;
				hero.def += data.skills[hero.s].def;
				hero.res += data.skills[hero.s].res;
			}
		}
		else{
			//remove weapon, A, S so calcs don't go crazy
			hero.weapon = -1;
			hero.a = -1;
			hero.s = -1;
			$("#cl_enemy_weapon").val(hero.weapon);
			$("#cl_enemy_a").val(hero.a);
			$("#cl_enemy_s").val(hero.s);
		}
		if(options.customEnemyList >= 1 && !hero.challenger){
			refreshStatsUI("cl_enemy",hero);
		}
	}
	else if(typeof hero.index != "undefined" && hero.index != -1){
		var growthValMod = {"hp":0,"atk":0,"spd":0,"def":0,"res":0};
		if(hero.boon!="none"){
			growthValMod[hero.boon]+=1;
		}
		if(hero.bane!="none"){
			growthValMod[hero.bane]-=1;
		}

		var base = {};
		base.hp = data.heroes[hero.index].basehp + growthValMod.hp;
		base.atk = data.heroes[hero.index].baseatk + growthValMod.atk;
		base.spd = data.heroes[hero.index].basespd + growthValMod.spd;
		base.def = data.heroes[hero.index].basedef + growthValMod.def;
		base.res = data.heroes[hero.index].baseres + growthValMod.res;

		hero.hp = base.hp + data.growths[hero.rarity-1][data.heroes[hero.index].hpgrowth + growthValMod.hp];
		hero.atk = base.atk + data.growths[hero.rarity-1][data.heroes[hero.index].atkgrowth + growthValMod.atk];
		hero.spd = base.spd + data.growths[hero.rarity-1][data.heroes[hero.index].spdgrowth + growthValMod.spd];
		hero.def = base.def + data.growths[hero.rarity-1][data.heroes[hero.index].defgrowth + growthValMod.def];
		hero.res = base.res + data.growths[hero.rarity-1][data.heroes[hero.index].resgrowth + growthValMod.res];

		//Add merge bonuses
		var mergeBoost = {"hp":0,"atk":0,"spd":0,"def":0,"res":0};

		//Order that merges happen is highest base stats, tiebreakers go hp->atk->spd->def->res
		var mergeOrder = ["atk","spd","def","res"];
		var boostPriority = {"atk":3,"spd":2,"def":1,"res":0};
		mergeOrder.sort(function(a,b){
			if(base[a]>base[b]){
				return -1;
			}
			else if(base[a]<base[b]){
				return 1;
			}
			else{
				if(boostPriority[a]>boostPriority[b]){
					return -1;
				}
				else{
					return 1;
				}
			}
		});
		mergeOrder.unshift("hp");

		var mergeBoostCount = 0;
		mergeBoostCount = hero.merge*2;
		
		for(var i = 0; i < mergeBoostCount; i++){
			mergeBoost[mergeOrder[i%5]]++;
		}
		//Ascended Boost
		if(hero.ascended!="none" && hero.boon!=hero.ascended){
			var gText = hero.ascended + "growth";
			var gVal = data.heroes[hero.index][gText] + growthValMod[hero.ascended];
			//Check difference between growth rate, determine if +3 or +4 stats
			if(data.growths[hero.rarity-1][gVal+1] - data.growths[hero.rarity-1][gVal] == 3){
				mergeBoost[hero.ascended] += 4;
			}
			else{
				mergeBoost[hero.ascended] += 3;
			}
		}
		
		//if unit is at least +1 merge, add additional stats to remove bane
		if(hero.merge > 0){
			//when unit has neutral IV, add 1 stat to top 3 base stats
			if(hero.bane == hero.boon){
				var j = 0;
				for(var i = 0; i < 3; i++){
					//skip to next highest stat if ascended stat has already been applied
					if(hero.ascended == mergeOrder[j]){
						j++;
					}
					mergeBoost[mergeOrder[j]]++;
					j++;
				}
			}
			//check for bane, then reverse it
			else if(hero.bane != "none"){
				var gText = hero.bane + "growth";
				var gVal = data.heroes[hero.index][gText] + growthValMod[hero.bane];
				//if bane == ascended, +1 to array index to get next growth value
				if(hero.bane == hero.ascended){
					gVal++;
				}
				//Check difference between growth rate, determine if +3 or +4 stats
				if(data.growths[hero.rarity-1][gVal+1] - data.growths[hero.rarity-1][gVal] == 3){
					mergeBoost[hero.bane] += 4;
				}
				else{
					mergeBoost[hero.bane] += 3;
				}
			}
		}

		if(hero.rarity<5){
			//Modify base stats based on rarity
			//Order that base stats increase by rarity is similar to merge bonuses, except HP always happens at 3* and 5*
			//Rarity base boosts don't taken into account boons/banes, so modify bases again and sort again
			base.atk = base.atk - growthValMod.atk;
			base.spd = base.spd - growthValMod.spd;
			base.def = base.def - growthValMod.def;
			base.res = base.res - growthValMod.res;

			var rarityBaseOrder = ["atk","spd","def","res"];
			rarityBaseOrder.sort(function(a,b){
				if(base[a]>base[b]){
					return -1;
				}
				else if(base[a]<base[b]){
					return 1;
				}
				else{
					if(boostPriority[a]>boostPriority[b]){
						return -1;
					}
					else{
						return 1;
					}
				}
			});

			rarityBaseOrder.push("hp");
			var rarityBoostCount = Math.floor((hero.rarity-1) * 2.5);

			//Just going to dump these stat boosts in mergeBoost
			for(var i = 0; i < rarityBoostCount; i++){
				mergeBoost[rarityBaseOrder[i%5]]++;
			}

			//Subtract 2 from every stat since bases are pulled in at 5*
			mergeBoost.hp -= 2;
			mergeBoost.atk -= 2;
			mergeBoost.spd -= 2;
			mergeBoost.def -= 2;
			mergeBoost.res -= 2;
		}

		hero.hp += mergeBoost.hp;
		hero.atk += mergeBoost.atk;
		hero.spd += mergeBoost.spd;
		hero.def += mergeBoost.def;
		hero.res += mergeBoost.res;

		//Add stats based on skills
		if(hero.weapon != -1){
			hero.hp += data.skills[hero.weapon].hp;
			hero.atk += data.skills[hero.weapon].atk;
			hero.spd += data.skills[hero.weapon].spd;
			hero.def += data.skills[hero.weapon].def;
			hero.res += data.skills[hero.weapon].res;
			
			//Add Refinement boost
			if(hero.refined != -1 && typeof hero.refined != "undefined" && ((data.skills[hero.weapon].upgrade < 5 && data.skills[hero.weapon].upgrade > 0) || data.skills[hero.weapon].upgrade == 6)){
				var modifier = data.skills[hero.weapon].upgrade % 2;
				if(modifier == 0){
					hero.hp += 2;
				}
				else if(modifier == 1){
					hero.hp += 5;
				}
				hero.atk += data.skills[hero.weapon].bonusmt;
				if(hero.refined % 10 == 1){
					hero.atk += modifier + 1;
					//Add exception for Cherche's Axe
					if(data.skills[hero.weapon].name == "Cherche's Axe"){
						hero.atk -= 1;
					}
				}
				else if(hero.refined % 10 == 2){
					hero.spd += modifier + 2;
				}
				else if(hero.refined % 10 == 3){
					hero.def += modifier + 3;
				}
				else if(hero.refined % 10 == 4){
					hero.res += modifier + 3;
				}
				else if(hero.refined == 5){
					hero.hp -= 2;
				}
				if((data.skills[hero.weapon].name == "Mystletainn" || data.skills[hero.weapon].name == "Axe of Virility" || data.skills[hero.weapon].name == "Hinata's Katana") && hero.refined == 5){
					hero.atk += 3;
					hero.spd += 3;
					hero.def += 3;
					hero.res += 3;
				}
				else if((data.skills[hero.weapon].name == "Basilikos" || data.skills[hero.weapon].name == "Solitary Blade") && hero.refined == 5){
					hero.atk += 5;
					hero.spd += 5;
					hero.def -= 5;
					hero.res -= 5;
				}
				else if(data.skills[hero.weapon].name == "Yato"){
					hero.atk += 2;
					hero.spd += 2;
					hero.def += 2;
					hero.res += 2;
				}
				else if(data.skills[hero.weapon].name == "Cursed Lance" && hero.refined > 0){
					hero.atk += 1;
					hero.spd += 1;
					hero.def += 3;
					hero.res += 3;
				}
				else if(data.skills[hero.weapon].name == "Ayra's Blade" && hero.refined > 0){
					hero.atk += 3;
				}
				else if(data.skills[hero.weapon].name == "Nurturing Breath" && hero.refined == 5){
					hero.atk += 4;
					hero.spd += 4;
					hero.def += 4;
					hero.res += 4;
				}
				else if(data.skills[hero.weapon].name == "Goddess Axe" && hero.refined > 0){
					hero.hp += 5;
					hero.atk += 6;
					hero.def += 1;
				}
				else if(data.skills[hero.weapon].name == "Twin Star Axe" && hero.refined > 0){
					hero.atk += 5;
					hero.def += 5;
					hero.res += 5;
				}
				else if(data.skills[hero.weapon].name == "Tailwind Shuriken" && hero.refined > 0){
					hero.atk += 6;
					hero.spd += 2;
				}
			}
		}

		//A-passive and S only ones that affects stats
		if(hero.a != -1){
			hero.hp += data.skills[hero.a].hp;
			hero.atk += data.skills[hero.a].atk;
			hero.spd += data.skills[hero.a].spd;
			hero.def += data.skills[hero.a].def;
			hero.res += data.skills[hero.a].res;
		}

		if(hero.s != -1){
			hero.hp += data.skills[hero.s].hp;
			hero.atk += data.skills[hero.s].atk;
			hero.spd += data.skills[hero.s].spd;
			hero.def += data.skills[hero.s].def;
			hero.res += data.skills[hero.s].res;
		}
		//get values for summoner support
		if(typeof hero.summoner != -1){
			var summonerValMod = {"hp":0,"atk":0,"spd":0,"def":0,"res":0};
			
			if(hero.summoner == "S"){
				summonerValMod = {"hp":5,"atk":2,"spd":2,"def":2,"res":2};
			}
			else if(hero.summoner == "A"){
				summonerValMod = {"hp":4,"atk":0,"spd":2,"def":2,"res":2};
			}
			else if(hero.summoner == "B"){
				summonerValMod = {"hp":4,"atk":0,"spd":0,"def":2,"res":2};
			}
			else if(hero.summoner == "C"){
				summonerValMod = {"hp":3,"atk":0,"spd":0,"def":0,"res":2};
			}
			hero.hp += summonerValMod.hp;
			hero.atk += summonerValMod.atk;
			hero.spd += summonerValMod.spd;
			hero.def += summonerValMod.def;
			hero.res += summonerValMod.res;
		}
		//add stats for Dragonflowers
		//Floor dragonflower to max if over its limit
		if(hero.dragonflower > 30 && (data.heroes[hero.index].hero_id > 369 || data.heroes[hero.index].movetype != "infantry")){
			hero.dragonflower = 30;
		}
		if(hero.dragonflower > 25 && data.heroes[hero.index].hero_id > 585){
			hero.dragonflower = 25;
		}
		if(hero.dragonflower > 20 && data.heroes[hero.index].hero_id > 739){
			hero.dragonflower = 20;
		}
		if(hero.dragonflower > 15 && data.heroes[hero.index].hero_id > 883){
			hero.dragonflower = 15;
		}
		if(hero.dragonflower > 10 && data.heroes[hero.index].hero_id > 1030){
			hero.dragonflower = 10;
		}
		if(hero.dragonflower > 5 && data.heroes[hero.index].hero_id > 1175){
			hero.dragonflower = 5;
		}
		var dragonBoost = {"hp":0,"atk":0,"spd":0,"def":0,"res":0};
		for(var i = 0; i < hero.dragonflower; i++){
			dragonBoost[mergeOrder[i%5]]++;
		}
		hero.hp += dragonBoost.hp;
		hero.atk += dragonBoost.atk;
		hero.spd += dragonBoost.spd;
		hero.def += dragonBoost.def;
		hero.res += dragonBoost.res;		
		//add stats for Emblem Merges
		if(hero.emblem != "none" && hero.emerge > 0){
			dragonBoost = {"hp":0,"atk":0,"spd":0,"def":0,"res":0};
			for(var i = 0; i < hero.emerge; i++){
				dragonBoost[mergeOrder[i%5]]++;
			}
			hero.hp += dragonBoost.hp;
			hero.atk += dragonBoost.atk;
			hero.spd += dragonBoost.spd;
			hero.def += dragonBoost.def;
			hero.res += dragonBoost.res;	
		}
		//add stats for reinforcement
		if(hero.reinforcement > 0){
			var rStats = hero.reinforcement * 2;
			dragonBoost = {"hp":0,"atk":0,"spd":0,"def":0,"res":0};
			for(var i = 0; i < rStats; i++){
				dragonBoost[mergeOrder[i%5]]++;
			}
			hero.hp += dragonBoost.hp;
			hero.atk += dragonBoost.atk;
			hero.spd += dragonBoost.spd;
			hero.def += dragonBoost.def;
			hero.res += dragonBoost.res;	
		}
		//add stats if unit is arena bonus unit
		if(typeof hero.abonus != -1 && hero.abonus == true){
			hero.hp += 10;
			hero.atk += 4;
			hero.spd += 4;
			hero.def += 4;
			hero.res += 4;
		}
		//add stats if unit has Aide's Essence
		if((typeof hero.aides != -1 && hero.aides == true && data.heroes[hero.index].rating != 21) || data.heroes[hero.index].rating == 21){
			hero.hp += 1;
			hero.atk += 1;
			hero.spd += 1;
			hero.def += 1;
			hero.res += 1;
		}
		//add stats if unit is a beast unit and transformed or unit is switched to resplendent form
		if(typeof hero.transform != -1 && hero.transform == true){
			if(data.heroes[hero.index].weapontype == "beast"){
				hero.atk += 2;
			}
		}
		if(typeof hero.resplendent != -1 && hero.resplendent == true){
			if(data.heroes[hero.index].rating == 20 || data.heroes[hero.index].rating == 30 || data.heroes[hero.index].rating == 40 || data.heroes[hero.index].rating == 50){
				hero.hp += 2;
				hero.atk += 2;
				hero.spd += 2;
				hero.def += 2;
				hero.res += 2;
			}
		}
		//add stats based on AR fortress difference
		if(options.fortress != 0){
			var fortBonus = 0;
			if(hero.challenger && options.fortress > 0){
				fortBonus = 4 * options.fortress;
				hero.atk += fortBonus;
				hero.spd += fortBonus;
				hero.def += fortBonus;
				hero.res += fortBonus;
			}
			else if(!hero.challenger && options.fortress < 0){
				fortBonus = -4 * options.fortress;
				hero.atk += fortBonus;
				hero.spd += fortBonus;
				hero.def += fortBonus;
				hero.res += fortBonus;
			}
		}
		//get values for blessings
		if(typeof hero.blessing != "undefined"){
			var blessingValMod = {"hp":0,"atk":0,"spd":0,"def":0,"res":0};
			//Add Legend boosts if you're not a Legend (including Mythic)
			if(data.heroes[hero.index].rating < 1000 || data.heroes[hero.index].rating >= 1200){
				for(var i = 0; i < hero.blessing.length; i++){
					if(hero.blessing[i] == 1){
						blessingValMod.hp += 3;
					}
					else if(hero.blessing[i] == 2){
						blessingValMod.hp += 3;
						blessingValMod.atk += 2;
					}
					else if(hero.blessing[i] == 3){
						blessingValMod.hp += 3;
						blessingValMod.spd += 3;
					}
					else if(hero.blessing[i] == 4){
						blessingValMod.hp += 3;
						blessingValMod.def += 4;
					}
					else if(hero.blessing[i] == 5){
						blessingValMod.hp += 3;
						blessingValMod.res += 4;
					}
				}
			}
			//Add Mythic boosts if you're not a Mythic (including Legend)
			if(data.heroes[hero.index].rating < 1200){
				for(var i = 0; i < hero.blessing.length; i++){
					if(hero.blessing[i] == 6){
						blessingValMod.hp += 5;
						blessingValMod.atk += 3;
					}
					else if(hero.blessing[i] == 7){
						blessingValMod.hp += 5;
						blessingValMod.spd += 4;
					}
					else if(hero.blessing[i] == 8){
						blessingValMod.hp += 5;
						blessingValMod.def += 5;
					}
					else if(hero.blessing[i] == 9){
						blessingValMod.hp += 5;
						blessingValMod.res += 5;
					}
				}
			}
			hero.hp += blessingValMod.hp;
			hero.atk += blessingValMod.atk;
			hero.spd += blessingValMod.spd;
			hero.def += blessingValMod.def;
			hero.res += blessingValMod.res;
		}
		//Great Talent
		if(hero.talent.atk > 0){
			hero.atk += hero.talent.atk;
		}
		if(hero.talent.spd > 0){
			hero.spd += hero.talent.spd;
		}
		if(hero.talent.def > 0){
			hero.def += hero.talent.def;
		}
		if(hero.talent.res > 0){
			hero.res += hero.talent.res;
		}
		
		hero.hp = Math.min(hero.hp,99);
		hero.atk = Math.min(hero.atk,99);
		hero.spd = Math.min(hero.spd,99);
		hero.def = Math.min(hero.def,99);
		hero.res = Math.min(hero.res,99);
	}
}

function setSkills(hero){
	if(typeof hero.index != "undefined" && hero.index != -1){
		hero.weapon = data.heroMaxSkills[hero.rarity-1][hero.index].weapon;
		hero.special = data.heroMaxSkills[hero.rarity-1][hero.index].special;
		hero.a = data.heroMaxSkills[hero.rarity-1][hero.index].a;
		hero.b = data.heroMaxSkills[hero.rarity-1][hero.index].b;
		hero.c = data.heroMaxSkills[hero.rarity-1][hero.index].c;
		hero.s = -1;
		hero.x = data.heroMaxSkills[hero.rarity-1][hero.index].x;
		hero.sd = -1;
	}
}

function getBST(hero){
	var bst = 0;
	if(typeof hero.index != "undefined" && hero.index != -1){
		var growthValMod = {"hp":0,"atk":0,"spd":0,"def":0,"res":0};
		if(hero.boon!="none"){
			growthValMod[hero.boon]+=1;
		}
		if(hero.bane!="none"){
			growthValMod[hero.bane]-=1;
		}
	
		var base = {};
		base.hp = data.heroes[hero.index].basehp + growthValMod.hp;
		base.atk = data.heroes[hero.index].baseatk + growthValMod.atk;
		base.spd = data.heroes[hero.index].basespd + growthValMod.spd;
		base.def = data.heroes[hero.index].basedef + growthValMod.def;
		base.res = data.heroes[hero.index].baseres + growthValMod.res;
		
		bst = base.hp + data.growths[hero.rarity-1][data.heroes[hero.index].hpgrowth + growthValMod.hp] + base.atk + data.growths[hero.rarity-1][data.heroes[hero.index].atkgrowth + growthValMod.atk] + base.spd + data.growths[hero.rarity-1][data.heroes[hero.index].spdgrowth + growthValMod.spd] + base.def + data.growths[hero.rarity-1][data.heroes[hero.index].defgrowth + growthValMod.def] + base.res + data.growths[hero.rarity-1][data.heroes[hero.index].resgrowth + growthValMod.res];
		//if unit is at least +1 merge, add additional stats to remove bane
		if(hero.merge > 0){
			//when unit has neutral IV, add 3
			if(hero.bane == "none" && hero.boon == "none"){
				bst += 3;
			}
			//check for -4 or -3 on bane, then reverse it
			else if(hero.bane != "none"){
				var gText = hero.bane + "growth";
				var sDiff = base[hero.bane] + data.growths[hero.rarity-1][data.heroes[hero.index][gText] + growthValMod[hero.bane]];
				sDiff = (base[hero.bane] + data.growths[hero.rarity-1][data.heroes[hero.index][gText]]) - sDiff + 1;
				bst += sDiff;
			}
		}
	}
	return bst;
}

function resetHero(hero,blockInit){
	hero.rarity = 5;
	hero.merge = 0;
	hero.boon = "none";
	hero.bane = "none";
	hero.ascended = "none";
	hero.summoner = "none";
	hero.ice = 0;
	hero.abonus = false;
	hero.aides = false;
	hero.transform = false;
	hero.resplendent = false;
	hero.style = 0;
	hero.tstyle = 0;
	hero.prfVal = 0;
	hero.defenseTile = false;
	hero.dragonflower = 0;
	hero.emblem = "none";
	hero.emerge = 0;
	hero.reinforcement = 0;
	hero.blessing = ["none","none","none","none"];
	hero.vein = 0;
	if(!hero.challenger){
		hero.blessing = ["none","none","none","none","none","none"];
	}
	hero.damage = 0;
	hero.precharge = 0;
	hero.arcane = 0;
	hero.buffs = {"atk":0,"spd":0,"def":0,"res":0};
	hero.debuffs = {"atk":0,"spd":0,"def":0,"res":0};
	hero.spur = {"atk":0,"spd":0,"def":0,"res":0};
	hero.toggle = {"weapon":0, "a":0, "b":0, "c":0, "s":0, "sd":0, "special":0};
	hero.talent = {"atk":0,"spd":0,"def":0,"res":0};
	hero.bonus = {"divineFang":false,"bDoubler":false,"nullArmor":false,"nullDragon":false,"nullFlying":false,"nullPanic":false,"autoD":false,"stopD":false,"dominance":false,"despacito":false,"vantage":false,"dodge":false,"nfus":false,"caff":false,"fStar":false,"dStar":false,"dull":false,"gStrat":false,"enGarde":false,"breathB":false,"treachery":false,"penDoubler":false,"starlight":false,"nPenalty":false,"resoB":false,"resoS":false,"triAtk":false,"bexblade":false,"spectrum":false,"extra":0,"incited":false,"fSight":false,"rotten":false,"essence":false,"nectar":0,"paranoia":false,"anathema":false,"fWitness":false,"dosage":false,"empathy":0,"divinely":0,"preempt":false,"pfollow":false,"sdiff":false,"dHex":false,"fEmblem":false};
	hero.support = {"infantryRush":false,"infantryFlash":false,"infantryBreath":false,"hexblade":false,"nullFU":false,"nullOFU":false,"nullGuard":false,"nullPenalty":false,"everliving":false,"achimenes":false,"freikugel":false,"revive":false,"dream":false,"caduceus":0,"doi":0,"dof":0,"hg":0,"ignore":false,"mboost":0,"lullAtk":false,"fellProtect":0,"fellSuccess":0,"nullUGuard":false,"dfu":0,"sGuard":false,"lullDef":false,"hippity":0,"crux":0,"persp":0,"nullPenAtk":false,"nullPenSpd":false,"bol":false,"rdw":0,"cnlove":0,"nlove":0,"lullSpd":false,"diva":0,"lullRes":false,"trueDmg":0,"trueFirstDR":0,"sunper":0,"flutter":0,"nullPenDef":false,"nullPenRes":false,"nullCD":false,"rsd":0,"tPulse":0,"hini":0,"nullFGuard":false,"brAtk":false,"baura":0,"devotion":false,"petal":false};
	hero.ephase = {"panic":false,"exposure":false,"sabotage":false,"discord":false,"hush":false,"spoils":false,"fStart":false,"lit":false,"fatal":false,"nullArise":false,"feud":false,"ploy":false,"schism":false,"tGrip":false,"cdguard":false,"frozen":false,"trilemma":false,"reverse":false,"heal":0};
	hero.penalty = {"lit":false,"trilemma":false,"panic":false,"cdguard":false,"fatal":false,"fStart":false,"exposure":false,"feud":false,"sabotage":false,"discord":false,"ploy":false,"extra":0,"chip":0,"schism":false,"nullArise":false,"tGrip":false,"hush":false,"deceit":false,"spoils":false,"frozen":false};
	hero.buddy = {"rank":"N","adjacent":0,"two":0,"three":0,"rorc":0,"erorc":0,"spaces":0,"buffs": {"atk":0,"spd":0,"def":0,"res":0}, "debuffs": {"atk":0,"spd":0,"def":0,"res":0},"hpCondition":false,"bonusCondition":false,"penaltyCondition":false};
	
	if(hero.index >= 0){
		setSkills(hero);
		setStats(hero);
	}
	if(hero.challenger){
		updateChallengerUI();
	}
	else{
		updateEnemyUI();
	}
	calculate();
}

function addHero(index){
	if(!index){
		index = -1;
	}

	var newChallengerId = challenger.length;

	challenger.push({
		"index":index,"hp":0,"atk":0,"spd":0,"def":0,"res":0,"weapon":-1,"special":-1,"a":-1,"b":-1,"c":-1,"s":-1,"x":-1,"sd":-1,"refined":-1,
		"buffs": {"atk":0,"spd":0,"def":0,"res":0}, "debuffs": {"atk":0,"spd":0,"def":0,"res":0}, "spur": {"atk":0,"spd":0,"def":0,"res":0},
		"boon": "none", "bane": "none", "ascended": "none", "merge":0, "rarity": 5, "precharge":0, "damage": 0, "ice": 0, "summoner": "none", "blessing": ["none","none","none","none"], "challenger":true, "toggle": {"weapon":0, "a":0, "b":0, "c":0, "s":0, "sd":0, "special":0}, "talent": {"atk":0,"spd":0,"def":0,"res":0}, "abonus":false, "aides":false, "transform":false, "resplendent":false, "dragonflower":0, "emblem":"none", "emerge":0, "reinforcement":0, "vein":0, "arcane":0, "prfVal":0, "style":0, "tstyle":false, "defenseTile":false, "bonus": {"divineFang":false,"bDoubler":false,"nullArmor":false,"nullDragon":false,"nullFlying":false,"nullPanic":false,"autoD":false,"stopD":false,"dominance":false,"despacito":false,"vantage":false,"dodge":false,"nfus":false,"caff":false,"fStar":false,"dStar":false,"dull":false,"gStrat":false,"enGarde":false,"breathB":false,"treachery":false,"penDoubler":false,"starlight":false,"nPenalty":false,"resoB":false,"resoS":false,"triAtk":false,"bexblade":false,"spectrum":false,"extra":0,"incited":false,"fSight":false,"rotten":false,"essence":false,"nectar":0,"paranoia":false,"anathema":false,"fWitness":false,"dosage":false,"empathy":0,"divinely":0,"preempt":false,"pfollow":false,"sdiff":false,"dHex":false,"fEmblem":false}, "support": {"infantryRush":false,"infantryFlash":false,"infantryBreath":false,"hexblade":false,"nullFU":false,"nullOFU":false,"nullGuard":false,"nullPenalty":false,"everliving":false,"achimenes":false,"freikugel":false,"revive":false,"dream":false,"caduceus":0,"doi":0,"dof":0,"hg":0,"ignore":false,"mboost":0,"lullAtk":false,"fellProtect":0,"fellSuccess":0,"nullUGuard":false,"dfu":0,"sGuard":false,"lullDef":false,"hippity":0,"crux":0,"persp":0,"nullPenAtk":false,"nullPenSpd":false,"bol":false,"rdw":0,"cnlove":0,"nlove":0,"lullSpd":false,"diva":0,"lullRes":false,"trueDmg":0,"trueFirstDR":0,"sunper":0,"flutter":0,"nullPenDef":false,"nullPenRes":false,"nullCD":false,"rsd":0,"tPulse":0,"hini":0,"nullFGuard":false,"brAtk":false,"baura":0,"devotion":false,"petal":false}, "ephase": {"panic":false,"exposure":false,"sabotage":false,"discord":false,"hush":false,"spoils":false,"fStart":false,"lit":false,"fatal":false,"nullArise":false,"feud":false,"ploy":false,"schism":false,"tGrip":false,"cdguard":false,"frozen":false,"trilemma":false,"reverse":false,"heal":0}, "penalty": {"lit":false,"trilemma":false,"panic":false,"cdguard":false,"fatal":false,"fStart":false,"exposure":false,"feud":false,"sabotage":false,"discord":false,"ploy":false,"extra":0,"chip":0,"schism":false,"nullArise":false,"tGrip":false,"hush":false,"deceit":false,"spoils":false,"frozen":false}, "buddy": {"rank":"N","adjacent":0,"two":0,"three":0,"rorc":0,"erorc":0,"spaces":0,"buffs": {"atk":0,"spd":0,"def":0,"res":0}, "debuffs": {"atk":0,"spd":0,"def":0,"res":0},"hpCondition":false,"bonusCondition":false,"penaltyCondition":false}
	});
	options.challengerSelected = newChallengerId;
	updateChallengerUI();
	updateChallengerList();
	calculate();
}

function cloneHero(){
	if(challenger.length > 0){
		var copyHero = challenger[options.challengerSelected];
		var cloneHero = {
			"index":copyHero.index,"hp":copyHero.hp,"atk":copyHero.atk,"spd":copyHero.spd,"def":copyHero.def,"res":copyHero.res,"weapon":copyHero.weapon,"special":copyHero.special,"a":copyHero.a,"b":copyHero.b,"c":copyHero.c,"s":copyHero.s,"x":copyHero.x,"sd":copyHero.sd,"refined":copyHero.refined,
			"buffs": {"atk":copyHero.buffs.atk,"spd":copyHero.buffs.spd,"def":copyHero.buffs.def,"res":copyHero.buffs.res}, "debuffs": {"atk":copyHero.debuffs.atk,"spd":copyHero.debuffs.spd,"def":copyHero.debuffs.def,"res":copyHero.debuffs.res}, "spur": {"atk":copyHero.spur.atk,"spd":copyHero.spur.spd,"def":copyHero.spur.def,"res":copyHero.spur.res},
			"boon": copyHero.boon, "bane": copyHero.bane, "ascended": copyHero.ascended, "merge":copyHero.merge, "rarity": copyHero.rarity, "precharge":copyHero.precharge, "damage": copyHero.damage, "ice": copyHero.ice, "summoner": copyHero.summoner, "blessing": copyHero.blessing, "challenger":true, "toggle": copyHero.toggle, "talent": copyHero.talent, "abonus": copyHero.abonus, "aides": copyHero.aides, "transform": copyHero.transform, "resplendent": copyHero.resplendent, "dragonflower": copyHero.dragonflower, "emblem": copyHero.emblem, "emerge": copyHero.emerge, "reinforcement":copyHero.reinforcement, "vein": copyHero.vein, "arcane": copyHero.arcane, "prfVal": copyHero.prfVal, "style": copyHero.style, "tstyle": copyHero.tstyle, "defenseTile": copyHero.defenseTile, "bonus": copyHero.bonus, "support": copyHero.support, "ephase": copyHero.ephase, "penalty": copyHero.penalty, "buddy": copyHero.buddy
		};
		challenger.push(cloneHero);
		initHero(cloneHero,true);
		updateChallengerUI();
		updateChallengerList();
	}
}

function selectHero(heroId){
	if(heroId < challenger.length){
		options.challengerSelected = heroId;
		updateChallengerList();
		updateChallengerUI();
		calculate();
	}
}

function deleteHero(event,heroId){
	challenger.splice(heroId,1);
	if(options.challengerSelected >= challenger.length){
		options.challengerSelected -= 1;
	}
	updateChallengerUI();
	updateChallengerList();
	calculate();
	event.stopPropagation();
}

function removeAllHeroes(){
	challenger = [];
	options.challengerSelected = -1;
	updateChallengerList();
	updateChallengerUI();
	calculate();
}

function resetStats(){
	$("#cl_enemy_hp").val("");
	$("#cl_enemy_atk").val("");
	$("#cl_enemy_spd").val("");
	$("#cl_enemy_def").val("");
	$("#cl_enemy_res").val("");	
}

function addClEnemy(index){
	if(!index){
		index = -1;
	}

	var newCustomEnemyId = enemies.cl.list.length;

	enemies.cl.list.push({
		"index":index,"hp":0,"atk":0,"spd":0,"def":0,"res":0,"weapon":-1,"special":-1,"a":-1,"b":-1,"c":-1,"s":-1,"x":-1,"sd":-1,"refined":-1,
		"buffs": {"atk":0,"spd":0,"def":0,"res":0}, "debuffs": {"atk":0,"spd":0,"def":0,"res":0}, "spur": {"atk":0,"spd":0,"def":0,"res":0},
		"boon": "none", "bane": "none", "ascended": "none", "merge":0, "rarity": 5, "precharge":0, "damage": 0, "ice": 0, "summoner": "none", "blessing": ["none","none","none","none","none","none"], "generic": {"hp":0,"atk":0,"spd":0,"def":0,"res":0}, "toggle": {"weapon":0, "a":0, "b":0, "c":0, "s":0, "sd":0, "special":0}, "talent": {"atk":0,"spd":0,"def":0,"res":0}, "abonus":false, "aides":false, "transform":false, "resplendent":false, "dragonflower":0, "emblem":"none", "emerge":0, "reinforcement":0, "vein":0, "arcane":0, "prfVal":0, "style":0, "tstyle":false, "defenseTile":false, "bonus": {"divineFang":false,"bDoubler":false,"nullArmor":false,"nullDragon":false,"nullFlying":false,"nullPanic":false,"autoD":false,"stopD":false,"dominance":false,"despacito":false,"vantage":false,"dodge":false,"nfus":false,"caff":false,"fStar":false,"dStar":false,"dull":false,"gStrat":false,"enGarde":false,"breathB":false,"treachery":false,"penDoubler":false,"starlight":false,"nPenalty":false,"resoB":false,"resoS":false,"triAtk":false,"bexblade":false,"spectrum":false,"extra":0,"incited":false,"fSight":false,"rotten":false,"essence":false,"nectar":0,"paranoia":false,"anathema":false,"fWitness":false,"dosage":false,"empathy":0,"divinely":0,"preempt":false,"pfollow":false,"sdiff":false,"dHex":false,"fEmblem":false}, "support": {"infantryRush":false,"infantryFlash":false,"infantryBreath":false,"hexblade":false,"nullFU":false,"nullOFU":false,"nullGuard":false,"nullPenalty":false,"everliving":false,"achimenes":false,"freikugel":false,"revive":false,"dream":false,"caduceus":0,"doi":0,"dof":0,"hg":0,"ignore":false,"mboost":0,"lullAtk":false,"fellProtect":0,"fellSuccess":0,"nullUGuard":false,"dfu":0,"sGuard":false,"lullDef":false,"hippity":0,"crux":0,"persp":0,"nullPenAtk":false,"nullPenSpd":false,"bol":false,"rdw":0,"cnlove":0,"nlove":0,"lullSpd":false,"diva":0,"lullRes":false,"trueDmg":0,"trueFirstDR":0,"sunper":0,"flutter":0,"nullPenDef":false,"nullPenRes":false,"nullCD":false,"rsd":0,"tPulse":0,"hini":0,"nullFGuard":false,"brAtk":false,"baura":0,"devotion":false,"petal":false}, "ephase": {"panic":false,"exposure":false,"sabotage":false,"discord":false,"hush":false,"spoils":false,"fStart":false,"lit":false,"fatal":false,"nullArise":false,"feud":false,"ploy":false,"schism":false,"tGrip":false,"cdguard":false,"frozen":false,"trilemma":false,"reverse":false,"heal":0}, "penalty": {"lit":false,"trilemma":false,"panic":false,"cdguard":false,"fatal":false,"fStart":false,"exposure":false,"feud":false,"sabotage":false,"discord":false,"ploy":false,"extra":0,"chip":0,"schism":false,"nullArise":false,"tGrip":false,"hush":false,"deceit":false,"spoils":false,"frozen":false}, "buddy": {"rank":"N","adjacent":0,"two":0,"three":0,"rorc":0,"erorc":0,"spaces":0,"buffs": {"atk":0,"spd":0,"def":0,"res":0}, "debuffs": {"atk":0,"spd":0,"def":0,"res":0},"hpCondition":false,"bonusCondition":false,"penaltyCondition":false}
	});

	options.customEnemySelected = newCustomEnemyId;
	updateEnemyUI();
	updateClList();
	resetStats();
}

function cloneClEnemy(){
	if(enemies.cl.list.length > 0){
		var copyEnemy = enemies.cl.list[options.customEnemySelected];
		var cloneEnemy = {
			"index":copyEnemy.index,"hp":copyEnemy.hp,"atk":copyEnemy.atk,"spd":copyEnemy.spd,"def":copyEnemy.def,"res":copyEnemy.res,"weapon":copyEnemy.weapon,"special":copyEnemy.special,"a":copyEnemy.a,"b":copyEnemy.b,"c":copyEnemy.c,"s":copyEnemy.s,"x":copyEnemy.x,"sd":copyEnemy.sd,"refined":copyEnemy.refined,
			"buffs": {"atk":copyEnemy.buffs.atk,"spd":copyEnemy.buffs.spd,"def":copyEnemy.buffs.def,"res":copyEnemy.buffs.res}, "debuffs": {"atk":copyEnemy.debuffs.atk,"spd":copyEnemy.debuffs.spd,"def":copyEnemy.debuffs.def,"res":copyEnemy.debuffs.res}, "spur": {"atk":copyEnemy.spur.atk,"spd":copyEnemy.spur.spd,"def":copyEnemy.spur.def,"res":copyEnemy.spur.res},
			"boon": copyEnemy.boon, "bane": copyEnemy.bane, "ascended": copyEnemy.ascended, "merge":copyEnemy.merge, "rarity": copyEnemy.rarity, "precharge":copyEnemy.precharge, "damage": copyEnemy.damage, "ice": copyEnemy.ice, "summoner": copyEnemy.summoner, "blessing": copyEnemy.blessing, "generic": {"hp":copyEnemy.generic.hp,"atk":copyEnemy.generic.atk,"spd":copyEnemy.generic.spd,"def":copyEnemy.generic.def,"res":copyEnemy.generic.res}, "toggle": copyEnemy.toggle, "talent": copyEnemy.talent, "abonus": copyEnemy.abonus, "aides": copyEnemy.aides, "transform": copyEnemy.transform, "resplendent": copyEnemy.resplendent, "dragonflower": copyEnemy.dragonflower, "emblem": copyEnemy.emblem, "emerge": copyEnemy.emerge, "reinforcement": copyEnemy.reinforcement, "vein": copyEnemy.vein, "arcane": copyEnemy.arcane, "prfVal": copyEnemy.prfVal, "style": copyEnemy.style, "tstyle": copyEnemy.tstyle, "defenseTile": copyEnemy.defenseTile, "bonus": copyEnemy.bonus, "support": copyEnemy.support, "ephase": copyEnemy.ephase, "penalty": copyEnemy.penalty, "buddy": copyEnemy.buddy
		};
		enemies.cl.list.push(cloneEnemy);
		initHero(cloneEnemy,true);
		updateEnemyUI();
		updateClList();
	}
}

function selectClEnemy(clEnemyId){
	//this gets called when deleteClEnemy is called because the delete button is inside the select button
	if(clEnemyId < enemies.cl.list.length){
		options.customEnemySelected = clEnemyId;
		updateClList();
		updateEnemyUI();
	}
}

function deleteClEnemy(event,clEnemyId){
	//Don't fuck with renaming ids, just move the text around and hide the highest id
	enemies.cl.list.splice(clEnemyId,1);
	if(options.customEnemySelected >= enemies.cl.list.length){
		options.customEnemySelected -= 1;
	}
	updateEnemyUI();
	updateClList();
	if(options.customEnemySelected >= 0){
		refreshStatsUI("cl_enemy", enemies.cl.list[options.customEnemySelected]);
	}
	else{
		var resethero = {"hp":0,"atk":0,"spd":0,"def":0,"res":0};
		refreshStatsUI("cl_enemy", resethero);
	}
	calculate();
	event.stopPropagation();
}

function removeAllClEnemies(){
	enemies.cl.list = [];
	options.customEnemySelected = -1;
	updateClList();
	updateEnemyUI();
	calculate();
	var resethero = {"hp":0,"atk":0,"spd":0,"def":0,"res":0};
	refreshStatsUI("cl_enemy", resethero);
}

//////////////////////////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////////////////////////

//UI Functions (mostly)

//////////////////////////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////////////////////////

function changeSkillPic(hero,slot){
	var htmlPrefix = getHtmlPrefix(hero);
	if(data.skills[hero[slot]]){
		var skillname = data.skills[hero[slot]].name;
		if(slot == "sd"){
			skillname = data.captainSkills[hero[slot]] + "_SD";
		}
		skillname = skillname.replace(/\s/g,"_");
		$("#" + htmlPrefix + slot + "_picture").attr("src","skills/" + skillname + ".png");
		$("#" + htmlPrefix + slot + "_picture").on("error", function() { $("#" + htmlPrefix + slot + "_picture").attr("src","skills/errorskill.png"); });
	}
	else{
		$("#" + htmlPrefix + slot + "_picture").attr("src","skills/noskill.png");
	}
}

function setSkillOptions(hero){
	//set html for character skill select based on valid skills

	var htmlPrefix = "challenger_";
	var maxSkills = {"weapon":-1,"special":-1,"a":-1,"b":-1,"c":-1,"s":-1,"x":-1};
	if(typeof hero.index != "undefined" && hero.index != -1){
		maxSkills = data.heroMaxSkills[hero.rarity-1][hero.index];
	}

	if(!hero.challenger){
		htmlPrefix = "cl_enemy_";
	}

	data.skillSlots.forEach(function(slot){
		var slotFriendlyText = slot;
		if(slot.length==1){
			//rename passives for display
			slotFriendlyText = slot.toUpperCase() + " passive";
		}
		var slotHTML = "<option value=-1>No " + slotFriendlyText + "</option>";
		var validSkills = hero["valid" + capitalize(slot) + "Skills"];
		if(validSkills){
			for(var i = 0; i < validSkills.length; i++){
				if(((!options.showOnlyMaxSkills || data.skillsThatArePrereq.indexOf(data.skills[validSkills[i]].skill_id)==-1) && (!options.hideUnaffectingSkills || data.skills[validSkills[i]].affectsduel)) || validSkills[i] == maxSkills[slot] || validSkills[i] == hero[slot]){
					slotHTML += "<option value=" + validSkills[i] + ">" + data.skills[validSkills[i]].name + "</option>";
				}
			}
		}
		$("#" + htmlPrefix + slot).html(slotHTML);
	});
	//Set Captain Skills
	var captHTML = "<option value=-1>No Captain Skill</option>";
	var sortedCaptain = [];
	for(var i = 0; i < data.captainSkills.length; i++){
		sortedCaptain.push({"index":i, "name":data.captainSkills[i], "optionText":"<option value=" + i + ">" + data.captainSkills[i] + "</option>"});
	}
	sortedCaptain.sort((a,b) => (a.name.toLowerCase() > b.name.toLowerCase()) ? 1 : ((b.name.toLowerCase() > a.name.toLowerCase()) ? -1 : 0));
	for(var i = 0; i < sortedCaptain.length; i++){
		captHTML += sortedCaptain[i].optionText;
	}
	$("#" + htmlPrefix + "sd").html(captHTML);
}

function updateFullUI(){
	//Refreshes everything about the UI - try to use more specific functions if possible
	updateChallengerUI();
	updateEnemyUI();
}

function updateChallengerUI(){
	if(options.challengerSelected == -1){
		updateHeroUI(-1, "challenger");
	}
	else{
		updateHeroUI(challenger[options.challengerSelected], "challenger");
	}
	updateChallengerList();
}

function updateEnemyUI(){
	if(options.customEnemyList >= 1){
		updateHeroUI(enemies.cl.list[options.customEnemySelected], "custom");
		updateClList();
	}
}

function updateHeroUI(hero, utype){
	//Shared elements between challenger and custom enemy

	if(!hero || hero == -1){
		//Make a dummy hero
		hero = {
			"index":-1,"hp":0,"atk":0,"spd":0,"def":0,"res":0,"weapon":-1,"special":-1,"a":-1,"b":-1,"c":-1,"s":-1,"x":-1,"sd":-1,"refined":-1,
			"buffs": {"atk":0,"spd":0,"def":0,"res":0}, "debuffs": {"atk":0,"spd":0,"def":0,"res":0}, "spur": {"atk":0,"spd":0,"def":0,"res":0},
			"boon": "none", "bane": "none", "ascended": "none", "merge":0, "rarity": 5, "precharge":0, "damage": 0, "ice": 0, "toggle": {"weapon":0,"a":0,"b":0,"c":0,"s":0,"sd":0,"special":0}, "talent": {"atk":0,"spd":0,"def":0,"res":0}, "abonus":false, "aides":false, "transform":false, "dragonflower":0, "emblem":"none", "emerge":0, "reinforcement":0, "vein":0, "arcane":0, "prfVal":0, "style":0, "tstyle":false, "defenseTile":false, "bonus": {"divineFang":false,"bDoubler":false,"nullArmor":false,"nullDragon":false,"nullFlying":false,"nullPanic":false,"autoD":false,"stopD":false,"dominance":false,"despacito":false,"vantage":false,"dodge":false,"nfus":false,"caff":false,"fStar":false,"dStar":false,"dull":false,"gStrat":false,"enGarde":false,"breathB":false,"treachery":false,"penDoubler":false,"starlight":false,"nPenalty":false,"resoB":false,"resoS":false,"triAtk":false,"bexblade":false,"spectrum":false,"extra":0,"incited":false,"fSight":false,"rotten":false,"essence":false,"nectar":0,"paranoia":false,"anathema":false,"fWitness":false,"dosage":false,"empathy":0,"divinely":0,"preempt":false,"pfollow":false,"sdiff":false,"dHex":false,"fEmblem":false}, "support": {"infantryRush":false,"infantryFlash":false,"infantryBreath":false,"hexblade":false,"nullFU":false,"nullOFU":false,"nullGuard":false,"nullPenalty":false,"everliving":false,"achimenes":false,"freikugel":false,"revive":false,"dream":false,"caduceus":0,"doi":0,"dof":0,"hg":0,"ignore":false,"mboost":0,"lullAtk":false,"fellProtect":0,"fellSuccess":0,"nullUGuard":false,"dfu":0,"sGuard":false,"lullDef":false,"hippity":0,"crux":0,"persp":0,"nullPenAtk":false,"nullPenSpd":false,"bol":false,"rdw":0,"cnlove":0,"nlove":0,"lullSpd":false,"diva":0,"lullRes":false,"trueDmg":0,"trueFirstDR":0,"sunper":0,"flutter":0,"nullPenDef":false,"nullPenRes":false,"nullCD":false,"rsd":0,"tPulse":0,"hini":0,"nullFGuard":false,"brAtk":false,"baura":0,"devotion":false,"petal":false}, "ephase": {"panic":false,"exposure":false,"sabotage":false,"discord":false,"hush":false,"spoils":false,"fStart":false,"lit":false,"fatal":false,"nullArise":false,"feud":false,"ploy":false,"schism":false,"tGrip":false,"cdguard":false,"frozen":false,"trilemma":false,"reverse":false,"heal":0}, "penalty": {"lit":false,"trilemma":false,"panic":false,"cdguard":false,"fatal":false,"fStart":false,"exposure":false,"feud":false,"sabotage":false,"discord":false,"ploy":false,"extra":0,"chip":0,"schism":false,"nullArise":false,"tGrip":false,"hush":false,"deceit":false,"spoils":false,"frozen":false}, "buddy": {"rank":"N","adjacent":0,"two":0,"three":0,"rorc":0,"erorc":0,"spaces":0,"buffs": {"atk":0,"spd":0,"def":0,"res":0}, "debuffs": {"atk":0,"spd":0,"def":0,"res":0},"hpCondition":false,"bonusCondition":false,"penaltyCondition":false}
		};
		if(utype == "challenger"){
			hero.summoner = "none";
			hero.challenger = true;
			hero.blessing = ["none", "none", "none", "none"];
		}
		else if(utype == "custom"){
			hero.generic = {"hp":0,"atk":0,"spd":0,"def":0,"res":0};
			hero.summoner = "none";
			hero.blessing = ["none", "none", "none", "none", "none", "none"];
		}
	}
	var bst = getBST(hero);
	var htmlPrefix = getHtmlPrefix(hero);
	
	if(utype == "challenger"){
		$("#challenger_summoner").val(hero.summoner);
		$("#challenger_blessing_1").val(hero.blessing[0]);
		$("#challenger_blessing_2").val(hero.blessing[1]);
		$("#challenger_blessing_3").val(hero.blessing[2]);
		$("#challenger_blessing_4").val(hero.blessing[3]);
	}
	else if(utype == "custom"){
		$("#cl_enemy_summoner").val(hero.summoner);
		$("#cl_enemy_blessing_1").val(hero.blessing[0]);
		$("#cl_enemy_blessing_2").val(hero.blessing[1]);
		$("#cl_enemy_blessing_3").val(hero.blessing[2]);
		$("#cl_enemy_blessing_4").val(hero.blessing[3]);
		$("#cl_enemy_blessing_5").val(hero.blessing[4]);
		$("#cl_enemy_blessing_6").val(hero.blessing[5]);
	}

	//Global stuff
	$("#" + htmlPrefix + "damage").val(hero.damage);
	$("#" + htmlPrefix + "precharge").val(hero.precharge);
	$("#" + htmlPrefix + "merge").val(hero.merge);
	$("#" + htmlPrefix + "rarity").val(hero.rarity);

	setSkillOptions(hero);
	$("#" + htmlPrefix + "weapon").val(hero.weapon);
	$("#" + htmlPrefix + "special").val(hero.special);
	$("#" + htmlPrefix + "a").val(hero.a);
	$("#" + htmlPrefix + "b").val(hero.b);
	$("#" + htmlPrefix + "c").val(hero.c);
	$("#" + htmlPrefix + "s").val(hero.s);
	$("#" + htmlPrefix + "x").val(hero.x);
	$("#" + htmlPrefix + "sd").val(hero.sd);
	
	$("#" + htmlPrefix + "gtAtk").val(hero.talent.atk);
	$("#" + htmlPrefix + "gtSpd").val(hero.talent.spd);
	$("#" + htmlPrefix + "gtDef").val(hero.talent.def);
	$("#" + htmlPrefix + "gtRes").val(hero.talent.res);
	
	//Enable Fallen Star bonus if it's LClaude/SClaude/BChrom
	if(hero.index != -1 && (data.heroes[hero.index].hero_id == 664 || data.heroes[hero.index].hero_id == 863 || data.heroes[hero.index].hero_id == 887)){
		$("#" + htmlPrefix + "fallen_star").show();
		if(hero.bonus.fStar == true){
			$("#" + htmlPrefix + "fstar").prop("checked", true);
			if(data.heroes[hero.index].hero_id == 887 && hero.bonus.dStar == false){
				$("#" + htmlPrefix + "dstar").prop("checked", false);
			}
		}
	}
	else{
		$("#" + htmlPrefix + "fallen_star").hide();
		$("#" + htmlPrefix + "fstar").prop("checked", false);
	}
	//Enable Deep Star bonus if it's Claude/BChrom
	if(hero.index != -1 && (data.heroes[hero.index].hero_id == 664 || data.heroes[hero.index].hero_id == 887 || data.heroes[hero.index].hero_id == 1037 || data.heroes[hero.index].hero_id == 1250)){
		$("#" + htmlPrefix + "deep_star").show();
		if(hero.bonus.dStar == true){
			$("#" + htmlPrefix + "dstar").prop("checked", true);
			if(data.heroes[hero.index].hero_id == 887 && hero.bonus.fStar == false){
				$("#" + htmlPrefix + "fstar").prop("checked", false);
			}
		}
	}
	else{
		$("#" + htmlPrefix + "deep_star").hide();
		$("#" + htmlPrefix + "dstar").prop("checked", false);
	}
	//count total amount of bonus/support/penalty and change text
	var bonusAdd = 0;
	if(hero.bonus.nectar > 0){
		bonusAdd++;
	}
	if(hero.bonus.empathy > 0){
		bonusAdd++;
	}
	if(hero.bonus.divinely > 0){
		bonusAdd++;
	}
	$("#" + htmlPrefix + "bcounter").html(hero.bonus.extra + $("." + htmlPrefix + "bonus:checked").length + bonusAdd);
	$("#" + htmlPrefix + "pcounter").html(hero.penalty.extra + $("." + htmlPrefix + "penalty:checked").length);
	
	//change to included/notincluded depending if there's a value in the object
	var shortP = htmlPrefix.slice(0, 2);
	for(var [key, value] of Object.entries(hero.bonus)){
		$("#" + htmlPrefix + key).prop("checked", value);
	}
	$("#" + htmlPrefix + "bExtra").val(hero.bonus.extra);
	$("#" + htmlPrefix + "nectar").val(hero.bonus.nectar);
	$("#" + htmlPrefix + "empathy").val(hero.bonus.empathy);
	$("#" + htmlPrefix + "divinely").val(hero.bonus.divinely);
	if($("." + htmlPrefix + "bonus:checked").length > 0 || $("#" + htmlPrefix + "divinely").val() > 0 || $("#" + htmlPrefix + "empathy").val() > 0 || $("#" + htmlPrefix + "gtAtk").val() > 0 || $("#" + htmlPrefix + "gtSpd").val() > 0 || $("#" + htmlPrefix + "gtDef").val() > 0 || $("#" + htmlPrefix + "gtRes").val() > 0 || $("#" + htmlPrefix + "nectar").val() > 0 || $("#" + htmlPrefix + "bExtra").val() > 0){
		$("#" + shortP + "_bonus").removeClass("notincluded");
		$("#" + shortP + "_bonus").addClass(shortP + "included");
	}
	else{
		$("#" + shortP + "_bonus").removeClass(shortP + "included");
		$("#" + shortP + "_bonus").addClass("notincluded");
	}	
	for(var [key, value] of Object.entries(hero.support)){
		$("#" + htmlPrefix + key).prop("checked", value);
	}
	$("#" + htmlPrefix + "hippity").val(hero.support.hippity);
	$("#" + htmlPrefix + "crux").val(hero.support.crux);
	$("#" + htmlPrefix + "dfu").val(hero.support.dfu);
	$("#" + htmlPrefix + "persp").val(hero.support.persp);
	$("#" + htmlPrefix + "rdw").val(hero.support.rdw);
	$("#" + htmlPrefix + "rsd").val(hero.support.rsd);
	$("#" + htmlPrefix + "tPulse").val(hero.support.tPulse);
	$("#" + htmlPrefix + "hini").val(hero.support.hini);
	$("#" + htmlPrefix + "cnlove").val(hero.support.cnlove);
	$("#" + htmlPrefix + "nlove").val(hero.support.nlove);
	$("#" + htmlPrefix + "diva").val(hero.support.diva);
	$("#" + htmlPrefix + "trueDmg").val(hero.support.trueDmg);
	$("#" + htmlPrefix + "trueFirstDR").val(hero.support.trueFirstDR);
	$("#" + htmlPrefix + "sunper").val(hero.support.sunper);
	$("#" + htmlPrefix + "flutter").val(hero.support.flutter);
	$("#" + htmlPrefix + "mboost").val(hero.support.mboost);
	$("#" + htmlPrefix + "baura").val(hero.support.baura);
	$("#" + htmlPrefix + "caduceus").val(hero.support.caduceus);
	$("#" + htmlPrefix + "doi").val(hero.support.doi);
	$("#" + htmlPrefix + "dof").val(hero.support.dof);
	$("#" + htmlPrefix + "hg").val(hero.support.hg);
	$("#" + htmlPrefix + "fellProtect").val(hero.support.fellProtect);
	$("#" + htmlPrefix + "fellSuccess").val(hero.support.fellSuccess);
	$("#" + htmlPrefix + "defenseTile").prop("checked", hero.defenseTile);
	if($("." + htmlPrefix + "support:checked").length > 0 || $("#" + htmlPrefix + "aura").val() > 0 || $("#" + htmlPrefix + "hini").val() > 0 || $("#" + htmlPrefix + "tPulse").val() > 0 || $("#" + htmlPrefix + "rsd").val() > 0 || $("#" + htmlPrefix + "flutter").val() > 0 || $("#" + htmlPrefix + "sunper").val() > 0 || $("#" + htmlPrefix + "trueDmg").val() > 0 || $("#" + htmlPrefix + "trueFirstDR").val() > 0 || $("#" + htmlPrefix + "diva").val() > 0 || $("#" + htmlPrefix + "cnlove").val() > 0 || $("#" + htmlPrefix + "nlove").val() > 0 || $("#" + htmlPrefix + "rdw").val() > 0 || $("#" + htmlPrefix + "persp").val() > 0 || $("#" + htmlPrefix + "crux").val() > 0 || $("#" + htmlPrefix + "dfu").val() > 0 || $("#" + htmlPrefix + "hippity").val() > 0 || $("#" + htmlPrefix + "mboost").val() > 0 || $("#" + htmlPrefix + "caduceus").val() > 0 || $("#" + htmlPrefix + "doi").val() > 0 || $("#" + htmlPrefix + "dof").val() > 0 || $("#" + htmlPrefix + "hg").val() > 0 || $("#" + htmlPrefix + "fellProtect").val() > 0 || $("#" + htmlPrefix + "fellSuccess").val() > 0 || $("#" + htmlPrefix + "defenseTile").prop("checked")){
		$("#" + shortP + "_support").removeClass("notincluded");
		$("#" + shortP + "_support").addClass(shortP + "included");
	}
	else{
		$("#" + shortP + "_support").removeClass(shortP + "included");
		$("#" + shortP + "_support").addClass("notincluded");
	}
	for(var [key, value] of Object.entries(hero.ephase)){
		$("#" + htmlPrefix + key).prop("checked", value);
	}
	$("#" + htmlPrefix + "ep_heal").val(hero.ephase.heal);
	if($("." + htmlPrefix + "ephase:checked").length > 0 || $("#" + htmlPrefix + "ep_heal").val() > 0){
		$("#" + shortP + "_ephase").removeClass("notincluded");
		$("#" + shortP + "_ephase").addClass(shortP + "included");
	}
	else{
		$("#" + shortP + "_ephase").removeClass(shortP + "included");
		$("#" + shortP + "_ephase").addClass("notincluded");
	}
	for(var [key, value] of Object.entries(hero.penalty)){
		$("#" + htmlPrefix + key).prop("checked", value);
	}
	$("#" + htmlPrefix + "pExtra").val(hero.penalty.extra);
	$("#" + htmlPrefix + "chip").val(hero.penalty.chip);
	if($("." + htmlPrefix + "penalty:checked").length > 0 || $("#" + htmlPrefix + "pExtra").val() > 0 || $("#" + htmlPrefix + "chip").val() > 0){
		$("#" + shortP + "_penalty").removeClass("notincluded");
		$("#" + shortP + "_penalty").addClass(shortP + "included");
	}
	else{
		$("#" + shortP + "_penalty").removeClass(shortP + "included");
		$("#" + shortP + "_penalty").addClass("notincluded");
	}
	$("#" + htmlPrefix + "rank").val(hero.buddy.rank);
	$("#" + htmlPrefix + "adjacent").val(hero.buddy.adjacent);
	$("#" + htmlPrefix + "two").val(hero.buddy.two);
	$("#" + htmlPrefix + "three").val(hero.buddy.three);
	$("#" + htmlPrefix + "rorc").val(hero.buddy.rorc);
	$("#" + htmlPrefix + "erorc").val(hero.buddy.erorc);
	$("#" + htmlPrefix + "spaces").val(hero.buddy.spaces);
	$("#" + htmlPrefix + "bbatk").val(hero.buddy.buffs.atk);
	$("#" + htmlPrefix + "bbspd").val(hero.buddy.buffs.spd);
	$("#" + htmlPrefix + "bbdef").val(hero.buddy.buffs.def);
	$("#" + htmlPrefix + "bbres").val(hero.buddy.buffs.res);
	$("#" + htmlPrefix + "bdatk").val(hero.buddy.debuffs.atk);
	$("#" + htmlPrefix + "bdspd").val(hero.buddy.debuffs.spd);
	$("#" + htmlPrefix + "bddef").val(hero.buddy.debuffs.def);
	$("#" + htmlPrefix + "bdres").val(hero.buddy.debuffs.res);
	$("#" + htmlPrefix + "hpcondition").prop("checked", hero.buddy.hpCondition);
	$("#" + htmlPrefix + "bonuscondition").prop("checked", hero.buddy.bonusCondition);
	$("#" + htmlPrefix + "penaltycondition").prop("checked", hero.buddy.penaltyCondition);
	if($("." + htmlPrefix + "ally:checked").length > 0 || $("#" + htmlPrefix + "erorc").val() > 0 || $("#" + htmlPrefix + "rank").val() != "N" || $("#" + htmlPrefix + "spaces").val() > 0 || $("#" + htmlPrefix + "rorc").val() > 0 || $("#" + htmlPrefix + "adjacent").val() > 0 || $("#" + htmlPrefix + "two").val() > 0 || $("#" + htmlPrefix + "three").val() > 0 || $("#" + htmlPrefix + "bbatk").val() > 0 || $("#" + htmlPrefix + "bbspd").val() > 0 || $("#" + htmlPrefix + "bbdef").val() > 0 || $("#" + htmlPrefix + "bbres").val() > 0 || $("#" + htmlPrefix + "bdatk").val() < 0 || $("#" + htmlPrefix + "bdspd").val() < 0 || $("#" + htmlPrefix + "bddef").val() < 0 || $("#" + htmlPrefix + "bdres").val() < 0){
		$("#" + shortP + "_ally").removeClass("notincluded");
		$("#" + shortP + "_ally").addClass(shortP + "included");
	}
	else{
		$("#" + shortP + "_ally").removeClass(shortP + "included");
		$("#" + shortP + "_ally").addClass("notincluded");
	}
	changeSkillPic(hero,"a");
	changeSkillPic(hero,"b");
	changeSkillPic(hero,"c");
	changeSkillPic(hero,"s");
	changeSkillPic(hero,"x");
	changeSkillPic(hero,"sd");
	
	var refine = getValidRefine(hero.weapon);
	if(refine.length > 0){
		if(htmlPrefix == "challenger_"){
			$("#refined_hero_row").show();
			$("#challenger_refined").html(refine.join(" "));
			if(hero.refined > 0){
				$("#challenger_refined").val(hero.refined);
			}
		}
		else if(htmlPrefix == "cl_enemy_"){
			$("#refined_cl_row").show();
			$("#cl_enemy_refined").html(refine.join(" "));
			if(hero.refined > 0){
				$("#cl_enemy_refined").val(hero.refined);
			}
		}
	}
	else{
		if(htmlPrefix == "challenger_"){
			$("#refined_hero_row").hide();
			$("#challenger_refined").html("<option>No Refinement</option>");
		}
		else if(htmlPrefix == "cl_enemy_"){
			$("#refined_cl_row").hide();
			$("#cl_enemy_refined").html("<option>No Refinement</option>");
		}
	}
	
	var wToggle = getValidToggle(hero.weapon, hero.refined, hero.index);
	if(wToggle.length > 0){
		if(htmlPrefix == "challenger_"){
			$("#toggle_hero_weapon").show();
			$("#challenger_wtoggle").html(wToggle.join(" "));
			if(hero.toggle.weapon > 0){
				$("#challenger_wtoggle").val(hero.toggle.weapon);
			}
		}
		else if(htmlPrefix == "cl_enemy_"){
			$("#toggle_cl_weapon").show();
			$("#cl_enemy_wtoggle").html(wToggle.join(" "));
			if(hero.toggle.weapon > 0){
				$("#cl_enemy_wtoggle").val(hero.toggle.weapon);
			}
		}
	}
	else{
		if(htmlPrefix == "challenger_"){
			$("#toggle_hero_weapon").hide();
			$("#challenger_wtoggle").html("<option>Disabled</option>");
		}
		else if(htmlPrefix == "cl_enemy_"){
			$("#toggle_cl_weapon").hide();
			$("#cl_enemy_wtoggle").html("<option>Disabled</option>");
		}
	}
	var aToggle = getValidToggle(hero.a, -1, hero.index);
	if(aToggle.length > 0){
		if(htmlPrefix == "challenger_"){
			$("#toggle_hero_a").show();
			$("#challenger_atoggle").html(aToggle.join(" "));
			if(hero.toggle.a > 0){
				$("#challenger_atoggle").val(hero.toggle.a);
			}
		}
		else if(htmlPrefix == "cl_enemy_"){
			$("#toggle_cl_a").show();
			$("#cl_enemy_atoggle").html(aToggle.join(" "));
			if(hero.toggle.a > 0){
				$("#cl_enemy_atoggle").val(hero.toggle.a);
			}
		}
	}
	else{
		if(htmlPrefix == "challenger_"){
			$("#toggle_hero_a").hide();
			$("#challenger_atoggle").html("<option>Disabled</option>");
		}
		else if(htmlPrefix == "cl_enemy_"){
			$("#toggle_cl_a").hide();
			$("#cl_enemy_atoggle").html("<option>Disabled</option>");
		}
	}
	var bToggle = getValidToggle(hero.b, -1, hero.index);
	if(bToggle.length > 0){
		if(htmlPrefix == "challenger_"){
			$("#toggle_hero_b").show();
			$("#challenger_btoggle").html(bToggle.join(" "));
			if(hero.toggle.b > 0){
				$("#challenger_btoggle").val(hero.toggle.b);
			}
		}
		else if(htmlPrefix == "cl_enemy_"){
			$("#toggle_cl_b").show();
			$("#cl_enemy_btoggle").html(bToggle.join(" "));
			if(hero.toggle.b > 0){
				$("#cl_enemy_btoggle").val(hero.toggle.b);
			}
		}
	}
	else{
		if(htmlPrefix == "challenger_"){
			$("#toggle_hero_b").hide();
			$("#challenger_btoggle").html("<option>Disabled</option>");
		}
		else if(htmlPrefix == "cl_enemy_"){
			$("#toggle_cl_b").hide();
			$("#cl_enemy_btoggle").html("<option>Disabled</option>");
		}
	}
	var cToggle = getValidToggle(hero.c, -1, hero.index);
	if(cToggle.length > 0){
		if(htmlPrefix == "challenger_"){
			$("#toggle_hero_c").show();
			$("#challenger_ctoggle").html(cToggle.join(" "));
			if(hero.toggle.c > 0){
				$("#challenger_ctoggle").val(hero.toggle.c);
			}
		}
		else if(htmlPrefix == "cl_enemy_"){
			$("#toggle_cl_c").show();
			$("#cl_enemy_ctoggle").html(cToggle.join(" "));
			if(hero.toggle.c > 0){
				$("#cl_enemy_ctoggle").val(hero.toggle.c);
			}
		}
	}
	else{
		if(htmlPrefix == "challenger_"){
			$("#toggle_hero_c").hide();
			$("#challenger_ctoggle").html("<option>Disabled</option>");
		}
		else if(htmlPrefix == "cl_enemy_"){
			$("#toggle_cl_c").hide();
			$("#cl_enemy_ctoggle").html("<option>Disabled</option>");
		}
	}
	var sToggle = getValidToggle(hero.s, -1, hero.index);
	if(sToggle.length > 0){
		if(htmlPrefix == "challenger_"){
			$("#toggle_hero_s").show();
			$("#challenger_stoggle").html(sToggle.join(" "));
			if(hero.toggle.s > 0){
				$("#challenger_stoggle").val(hero.toggle.s);
			}
		}
		else if(htmlPrefix == "cl_enemy_"){
			$("#toggle_cl_s").show();
			$("#cl_enemy_stoggle").html(sToggle.join(" "));
			if(hero.toggle.s > 0){
				$("#cl_enemy_stoggle").val(hero.toggle.s);
			}
		}
	}
	else{
		if(htmlPrefix == "challenger_"){
			$("#toggle_hero_s").hide();
			$("#challenger_stoggle").html("<option>Disabled</option>");
		}
		else if(htmlPrefix == "cl_enemy_"){
			$("#toggle_cl_s").hide();
			$("#cl_enemy_stoggle").html("<option>Disabled</option>");
		}
	}
	var xToggle = getValidToggle(hero.x, -1, hero.index);
	if(xToggle.length > 0){
		if(htmlPrefix == "challenger_"){
			$("#toggle_hero_x").show();
			$("#challenger_xtoggle").html(xToggle.join(" "));
			if(hero.toggle.x > 0){
				$("#challenger_xtoggle").val(hero.toggle.x);
			}
		}
		else if(htmlPrefix == "cl_enemy_"){
			$("#toggle_cl_x").show();
			$("#cl_enemy_xtoggle").html(xToggle.join(" "));
			if(hero.toggle.x > 0){
				$("#cl_enemy_xtoggle").val(hero.toggle.x);
			}
		}
	}
	else{
		if(htmlPrefix == "challenger_"){
			$("#toggle_hero_x").hide();
			$("#challenger_xtoggle").html("<option>Disabled</option>");
		}
		else if(htmlPrefix == "cl_enemy_"){
			$("#toggle_cl_x").hide();
			$("#cl_enemy_xtoggle").html("<option>Disabled</option>");
		}
	}
	var sdToggle = getValidSDToggle(hero.sd);
	if(sdToggle.length > 0){
		if(htmlPrefix == "challenger_"){
			$("#toggle_hero_sd").show();
			$("#challenger_sdtoggle").html(sdToggle.join(" "));
			if(hero.toggle.sd > 0){
				$("#challenger_sdtoggle").val(hero.toggle.sd);
			}
		}
		else if(htmlPrefix == "cl_enemy_"){
			$("#toggle_cl_sd").show();
			$("#cl_enemy_sdtoggle").html(sdToggle.join(" "));
			if(hero.toggle.sd > 0){
				$("#cl_enemy_sdtoggle").val(hero.toggle.sd);
			}
		}
	}
	else{
		if(htmlPrefix == "challenger_"){
			$("#toggle_hero_sd").hide();
			$("#challenger_sdtoggle").html("<option>Disabled</option>");
		}
		else if(htmlPrefix == "cl_enemy_"){
			$("#toggle_cl_sd").hide();
			$("#cl_enemy_sdtoggle").html("<option>Disabled</option>");
		}
	}
	var spToggle = getValidToggle(hero.special, -1, hero.index);
	if(spToggle.length > 0){
		if(htmlPrefix == "challenger_"){
			$("#toggle_hero_special").show();
			$("#challenger_specialtoggle").html(spToggle.join(" "));
			if(hero.toggle.special > 0){
				$("#challenger_specialtoggle").val(hero.toggle.special);
			}
		}
		else if(htmlPrefix == "cl_enemy_"){
			$("#toggle_cl_special").show();
			$("#cl_enemy_specialtoggle").html(spToggle.join(" "));
			if(hero.toggle.special > 0){
				$("#cl_enemy_specialtoggle").val(hero.toggle.special);
			}
		}
	}
	else{
		if(htmlPrefix == "challenger_"){
			$("#toggle_hero_special").hide();
			$("#challenger_specialtoggle").html("<option>Disabled</option>");
		}
		else if(htmlPrefix == "cl_enemy_"){
			$("#toggle_cl_special").hide();
			$("#cl_enemy_specialtoggle").html("<option>Disabled</option>");
		}
	}
	//Set maximum Dragonflower values
	if(hero.index != -1){
		if(data.heroes[hero.index].hero_id < 370 && data.heroes[hero.index].movetype == "infantry"){
			$("#" + htmlPrefix + "_dragonflower").prop("max", 35);
		}
		else if(data.heroes[hero.index].hero_id < 586){
			$("#" + htmlPrefix + "_dragonflower").prop("max", 30);
			if($("#" + htmlPrefix + "_dragonflower").val() > 30){
				$("#" + htmlPrefix + "_dragonflower").val(30);
			}
		}
		else if(data.heroes[hero.index].hero_id < 740){
			$("#" + htmlPrefix + "_dragonflower").prop("max", 25);
			if($("#" + htmlPrefix + "_dragonflower").val() > 25){
				$("#" + htmlPrefix + "_dragonflower").val(25);
			}
		}
		else if(data.heroes[hero.index].hero_id < 884){
			$("#" + htmlPrefix + "_dragonflower").prop("max", 20);
			if($("#" + htmlPrefix + "_dragonflower").val() > 20){
				$("#" + htmlPrefix + "_dragonflower").val(20);
			}
		}
		else if(data.heroes[hero.index].hero_id < 1031){
			$("#" + htmlPrefix + "_dragonflower").prop("max", 15);
			if($("#" + htmlPrefix + "_dragonflower").val() > 15){
				$("#" + htmlPrefix + "_dragonflower").val(15);
			}
		}
		else if(data.heroes[hero.index].hero_id < 1176){
			$("#" + htmlPrefix + "_dragonflower").prop("max", 10);
			if($("#" + htmlPrefix + "_dragonflower").val() > 10){
				$("#" + htmlPrefix + "_dragonflower").val(10);
			}
		}
		else{
			$("#" + htmlPrefix + "_dragonflower").prop("max", 5);
			if($("#" + htmlPrefix + "_dragonflower").val() > 5){
				$("#" + htmlPrefix + "_dragonflower").val(5);
			}
		}
	}
	$("#" + htmlPrefix + "dragonflower").val(hero.dragonflower);
	//reconstruct Emblem options
	$("#" + htmlPrefix + "emblem").find("option:disabled").prop("disabled", false);
	//disable self-Emblem values (Can't engage themselves)
	if(hero.index != -1 && data.heroes[hero.index].rating == 19){
		var emName = data.heroes[hero.index].name.split(" ");
		$("#" + htmlPrefix + "emblem option:contains(\"" + emName[0] + "\")").prop("disabled", true);
	}
	$("#" + htmlPrefix + "emblem").val(hero.emblem);
	$("#" + htmlPrefix + "emerge").val(hero.emerge);
	$("#" + htmlPrefix + "reinforcement").val(hero.reinforcement);
	$("#" + htmlPrefix + "vein").val(hero.vein);
	//Transform UI changes
	if(hero.index != -1 && data.heroes[hero.index].weapontype == "beast"){
		$("#" + shortP + "_trans").show();
		$("#" + htmlPrefix + "transform").prop("checked", hero.transform);
	}
	else{
		$("#" + shortP + "_trans").hide();
		$("#" + htmlPrefix + "transform").prop("checked", false);
	}
	if(hero.index != -1 && (data.heroes[hero.index].rating == 20 || data.heroes[hero.index].rating == 30 || data.heroes[hero.index].rating == 40 || data.heroes[hero.index].rating == 50)){
		$("#" + shortP + "_resp").show();
		$("#" + htmlPrefix + "resplendent").prop("checked", hero.resplendent);
	}
	else{
		$("#" + shortP + "_resp").hide();
		$("#" + htmlPrefix + "resplendent").prop("checked", false);
	}
	//Style
	if(hero.index != -1 && hero.style > 0){
		$("#" + shortP + "_tstyle").show();
		$("#" + htmlPrefix + "tstyle").prop("checked", hero.tstyle);
	}
	else{
		$("#" + shortP + "_tstyle").hide();
		$("#" + htmlPrefix + "tstyle").prop("checked", false);
	}
	//Unique skills that require additional value input
	//No conflicts yet, but in the future may need to expand
	//Human Virtue 2
	if(hero.c != -1 && data.skills[hero.c].skill_id == 3161){
		$("#" + shortP + "_prf_value").show();
		$("#" + shortP + "_pv_text").html("1st Hit DR%");
		$("#" + htmlPrefix + "prf_value").attr({"max":40});
		$("#" + htmlPrefix + "prf_value").val(hero.prfVal);
	}
	//Chaos Manifest
	else if(hero.weapon != -1 && data.skills[hero.weapon].skill_id == 1555 && hero.refined > 0){
		$("#" + shortP + "_prf_value").show();
		$("#" + shortP + "_pv_text").html("Total Penalties");
		$("#" + htmlPrefix + "prf_value").attr({"max":96});
		$("#" + htmlPrefix + "prf_value").val(hero.prfVal);
	}
	//Nurturing Breath
	else if(hero.weapon != -1 && data.skills[hero.weapon].skill_id == 2191 && hero.refined > 0){
		$("#" + shortP + "_prf_value").show();
		$("#" + shortP + "_pv_text").html("# of Allies");
		$("#" + htmlPrefix + "prf_value").attr({"max":3});
		$("#" + htmlPrefix + "prf_value").val(hero.prfVal);
	}
	//Fiery War Sword
	else if(hero.weapon != -1 && data.skills[hero.weapon].skill_id == 3540){
		$("#" + shortP + "_prf_value").show();
		$("#" + shortP + "_pv_text").html("# of [Bonus]");
		$("#" + htmlPrefix + "prf_value").attr({"max":4});
		$("#" + htmlPrefix + "prf_value").val(hero.prfVal);
	}
	//Refined Thorn Lance
	else if(hero.weapon != -1 && data.skills[hero.weapon].skill_id == 2041 && hero.refined == 5){
		$("#" + shortP + "_prf_value").show();
		$("#" + shortP + "_pv_text").html("Total Bonuses");
		$("#" + htmlPrefix + "prf_value").attr({"max":48});
		$("#" + htmlPrefix + "prf_value").val(hero.prfVal);
	}
	//Refined Randgridr
	else if(hero.weapon != -1 && data.skills[hero.weapon].skill_id == 2079 && hero.refined == 5){
		$("#" + shortP + "_prf_value").show();
		$("#" + shortP + "_pv_text").html("Total B/P");
		$("#" + htmlPrefix + "prf_value").attr({"max":20});
		$("#" + htmlPrefix + "prf_value").val(hero.prfVal);
	}
	//United Bouquet
	else if(hero.weapon != -1 && data.skills[hero.weapon].skill_id == 4116){
		$("#" + shortP + "_prf_value").show();
		$("#" + shortP + "_pv_text").html("# of Spaces");
		$("#" + htmlPrefix + "prf_value").attr({"max":4});
		$("#" + htmlPrefix + "prf_value").val(hero.prfVal);
	}
	
	//New Cavalry Beast Effect
	else if(hero.weapon != -1 && (data.skills[hero.weapon].skill_id > 3666 || (data.skills[hero.weapon].skill_id == 2418 && hero.refined > 0)) && hero.index != -1 && data.heroes[hero.index].weapontype == "beast" && data.heroes[hero.index].movetype == "cavalry" && hero.transform == true){
		$("#" + shortP + "_prf_value").show();
		$("#" + shortP + "_pv_text").html("# of Spaces");
		$("#" + htmlPrefix + "prf_value").attr({"max":3});
		$("#" + htmlPrefix + "prf_value").val(hero.prfVal);
	}
	else{
		$("#" + shortP + "_prf_value").hide();
		$("#" + shortP + "_pv_text").html("Prf Skill");
		$("#" + htmlPrefix + "prf_value").attr({"max":99});
		hero.prfVal = 0;
		$("#" + htmlPrefix + "prf_value").val(hero.prfVal);
	}
	if(hero.buffs){
		$("#" + htmlPrefix + "atk_buff").val(hero.buffs.atk);
		$("#" + htmlPrefix + "spd_buff").val(hero.buffs.spd);
		$("#" + htmlPrefix + "def_buff").val(hero.buffs.def);
		$("#" + htmlPrefix + "res_buff").val(hero.buffs.res);
		$("#" + htmlPrefix + "atk_debuff").val(hero.debuffs.atk);
		$("#" + htmlPrefix + "spd_debuff").val(hero.debuffs.spd);
		$("#" + htmlPrefix + "def_debuff").val(hero.debuffs.def);
		$("#" + htmlPrefix + "res_debuff").val(hero.debuffs.res);
		$("#" + htmlPrefix + "atk_spur").val(hero.spur.atk);
		$("#" + htmlPrefix + "spd_spur").val(hero.spur.spd);
		$("#" + htmlPrefix + "def_spur").val(hero.spur.def);
		$("#" + htmlPrefix + "res_spur").val(hero.spur.res);
	}
	
	if(hero.abonus == true){
		$("#" + htmlPrefix + "abonus").prop("checked", true);
	}
	else{
		$("#" + htmlPrefix + "abonus").prop("checked", false);
	}
	if(hero.aides == true){
		$("#" + htmlPrefix + "aides").prop("checked", true);
	}
	else{
		$("#" + htmlPrefix + "aides").prop("checked", false);
	}
	$("#" + htmlPrefix + "boon").val(hero.boon);
	$("#" + htmlPrefix + "bane").val(hero.bane);
	$("#" + htmlPrefix + "ascended").val(hero.ascended);
	//add reset

	if(typeof hero.index != "undefined" && hero.index != -1){ //cl/challenger-specific stuff
		$("#" + htmlPrefix + "name").val(hero.index);
		if(hero.resplendent == true && (data.heroes[hero.index].rating == 20 || data.heroes[hero.index].rating == 30 || data.heroes[hero.index].rating == 40 || data.heroes[hero.index].rating == 50)){
			$("#" + htmlPrefix + "picture").attr("src","heroes/r." + data.heroes[hero.index].name + ".png");
		}
		else{
			$("#" + htmlPrefix + "picture").attr("src","heroes/" + data.heroes[hero.index].name + ".png");
		}
		$("#" + htmlPrefix + "picture").on("error", function() { $("#" + htmlPrefix + "picture").attr("src","heroes/nohero.png"); });
		$("#" + htmlPrefix + "bst").html("BST: " + bst);
		
		//if it's generic unit, set stats to 1 and allow variability
		if(htmlPrefix == "cl_enemy_"){
			if(data.heroes[hero.index].name.indexOf("generic") != -1){
				$("#" + htmlPrefix + "hp").prop("readonly", false);
				$("#" + htmlPrefix + "atk").prop("readonly", false);
				$("#" + htmlPrefix + "spd").prop("readonly", false);
				$("#" + htmlPrefix + "def").prop("readonly", false);
				$("#" + htmlPrefix + "res").prop("readonly", false);
			}
			else{
				$("#" + htmlPrefix + "hp").prop("readonly", true);
				$("#" + htmlPrefix + "atk").prop("readonly", true);
				$("#" + htmlPrefix + "spd").prop("readonly", true);
				$("#" + htmlPrefix + "def").prop("readonly", true);
				$("#" + htmlPrefix + "res").prop("readonly", true);
			}
			
			$("#" + htmlPrefix + "hp").val(hero.hp);
			$("#" + htmlPrefix + "atk").val(hero.atk);
			$("#" + htmlPrefix + "spd").val(hero.spd);
			$("#" + htmlPrefix + "def").val(hero.def);
			$("#" + htmlPrefix + "res").val(hero.res);
		}
		else
		{
			$("#" + htmlPrefix + "hp").html(hero.hp);
			$("#" + htmlPrefix + "currenthp").html(Math.max(hero.hp - hero.damage,0));
			$("#" + htmlPrefix + "atk").html(hero.atk);
			$("#" + htmlPrefix + "spd").html(hero.spd);
			$("#" + htmlPrefix + "def").html(hero.def);
			$("#" + htmlPrefix + "res").html(hero.res);
		}
		if(data.heroes[hero.index].weapontype == "dragon"){
			$("#" + htmlPrefix + "weapon_icon").attr("src","weapons/" + data.heroes[hero.index].color + "dragon.png");
		}
		else if(data.heroes[hero.index].weapontype == "bow"){
			$("#" + htmlPrefix + "weapon_icon").attr("src","weapons/" + data.heroes[hero.index].color + "bow.png");
		}
		else if(data.heroes[hero.index].weapontype == "dagger"){
			$("#" + htmlPrefix + "weapon_icon").attr("src","weapons/" + data.heroes[hero.index].color + "dagger.png");
		}
		else if(data.heroes[hero.index].weapontype == "beast"){
			$("#" + htmlPrefix + "weapon_icon").attr("src","weapons/" + data.heroes[hero.index].color + "beast.png");
		}
		else{
			$("#" + htmlPrefix + "weapon_icon").attr("src","weapons/" + data.heroes[hero.index].weapontype + ".png");
		}

		if(hero.special != -1){
			$("#" + htmlPrefix + "specialcharge").html(getCurrentCD(hero.weapon, hero.special, hero.b, hero.s, hero.precharge, hero.refined, hero.emblem));
		}
		else{
			$("#" + htmlPrefix + "specialcharge").html("-");
		}
	}
	else{
		//Custom enemy unselected
		$("#" + htmlPrefix + "name").val(hero.index);
		$("#" + htmlPrefix + "picture").attr("src","heroes/nohero.png");
		$("#" + htmlPrefix + "bst").html("BST:");
		$("#" + htmlPrefix + "hp").html("-");
		$("#" + htmlPrefix + "currenthp").html("-");
		$("#" + htmlPrefix + "atk").html("-");
		$("#" + htmlPrefix + "spd").html("-");
		$("#" + htmlPrefix + "def").html("-");
		$("#" + htmlPrefix + "res").html("-");
		$("#" + htmlPrefix + "weapon_icon").attr("src","weapons/noweapon.png");
		$("#" + htmlPrefix + "specialcharge").html("-");
	}
}

function getCurrentCD(weapon, special, bSkill, sSkill, precharge, refined, emblem){
	if(special != -1){
		var specialCharge = data.skills[special].charge;
		if(weapon != -1){
			var weaponName = data.skills[weapon].name;
			if(data.killerWeapon.indexOf(weaponName) != -1 || (weaponName.indexOf("Excalibur") != -1 && weaponName.indexOf("Dark") == -1 && weaponName.indexOf("Giga") == -1 && refined > 0) || ((weaponName.indexOf("Light Brand") != -1 || weaponName.indexOf("Dark Spikes T") != -1 || weaponName.indexOf("Deep-Blue Bow") != -1 || weaponName.indexOf("Ifingr") != -1 || weaponName.indexOf("Sokkvabekkr") != -1 || weaponName.indexOf("Nightmare Horn") != -1 || weaponName.indexOf("Mirage Longbow") != -1 || weaponName.indexOf("Aurora Breath") != -1 || weaponName.indexOf("Starpoint Lance") != -1 || weaponName.indexOf("Moonless Breath") != -1 || weaponName.indexOf("Indignant Bow") != -1 || weaponName.indexOf("New Dawn") != -1 || weaponName.indexOf("Wing-Lifted Spear") != -1) && refined == 5) || ((weaponName.indexOf("Ayra's Blade") != -1 || weaponName.indexOf("Phantasm Tome") != -1) && refined > 0) || ((weaponName.indexOf("Alondite") != -1 || weaponName.indexOf("Ragnell") != -1) && refined == 5 && weaponName.indexOf("Ragnell-Alondite") == -1 && weaponName.indexOf("Chaos Ragnell") == -1)){
				//Check if it's a healer special that has 1 CD
				if(specialCharge > 1){
					specialCharge -= 1;
				}
			}
			else if(data.murderWeapon.indexOf(weaponName) != -1){
				if(specialCharge > 2){
					specialCharge -= 2;
				}
				else if(specialCharge == 2){
					specialCharge -= 1;
				}
			}
			else if(weaponName.indexOf("Raudrblade") != -1 || weaponName.indexOf("Lightning Breath") != -1 || weaponName.indexOf("Blarblade") != -1 || weaponName.indexOf("Gronnblade") != -1 || weaponName.indexOf("Purifying Breath") != -1){
				specialCharge += 1;
			}
		}
		if(bSkill != -1){
			var bName = data.skills[bSkill].name;
			if(bName == "Lunar Brace"){
				specialCharge += 1;
			}
		}
		if(emblem == "Marth" && specialCharge > 1){
			specialCharge -= 1;
		}
		specialCharge -= precharge;
		specialCharge = Math.max(0,specialCharge);
		return specialCharge;
	}
	else{
		return "-";
	}
}

function showResultsTooltip(e,resultDiv){
	var resultId = resultDiv.id.substring(7);
	showingTooltip = true;
	$("#frame_tooltip").html(fightResults[resultId].fightText).show();
}

function hideResultsTooltip(){
	showingTooltip = false;
	$("#frame_tooltip").hide();
}

function addTurn(turnName){
	danceCount = 0;
	if(options.roundInitiators.length < 4){
		$("#turn_text_" + options.roundInitiators.length).html(turnName);
		$("#turn_" + options.roundInitiators.length).show();
		options.roundInitiators.push(turnName);
	}
	calculate();
}

function deleteTurn(initTurn){
	danceCount = 0;
	//keep ids the same, shift around text
	$("#turn_" + (options.roundInitiators.length - 1)).hide();
	options.roundInitiators.splice(initTurn,1);
	for(var i = 0; i < options.roundInitiators.length; i++){
		$("#turn_text_" + i).html(options.roundInitiators[i]);
	}
	calculate();
}

function qBuff(type){
	var buff = {"atk":0, "spd":0, "def":0, "res":0};
	
	if(type == "fourfour"){
		buff.atk = 4;
		buff.spd = 4;
	}
	else if(type == "tier_list"){
		buff.atk = 6;
		buff.spd = 6;
		buff.def = 3;
		buff.res = 3;
	}
	else if(type == "hone"){
		buff.atk = 6;
		buff.spd = 6;
	}
	else if(type == "full"){
		buff.atk = 6;
		buff.spd = 6;
		buff.def = 6;
		buff.res = 6;
	}
	$("#mass_atk_buff").val(buff.atk);
	$("#mass_spd_buff").val(buff.spd);
	$("#mass_def_buff").val(buff.def);
	$("#mass_res_buff").val(buff.res);
	changeDataVar("mass.buffs.atk",buff.atk);
	changeDataVar("mass.buffs.spd",buff.spd);
	changeDataVar("mass.buffs.def",buff.def);
	changeDataVar("mass.buffs.res",buff.res);
	calcuWait(300);
}

function resetMass(){
	$("#mass_atk_buff").val(0);
	$("#mass_spd_buff").val(0);
	$("#mass_def_buff").val(0);
	$("#mass_res_buff").val(0);
	$("#mass_atk_debuff").val(0);
	$("#mass_spd_debuff").val(0);
	$("#mass_def_debuff").val(0);
	$("#mass_res_debuff").val(0);
	$("#mass_atk_spur").val(0);
	$("#mass_spd_spur").val(0);
	$("#mass_def_spur").val(0);
	$("#mass_res_spur").val(0);
	$("#mass_hp").prop("selectedIndex",0);
	$("#mass_challenger_precharge").val(0);
	$("#mass_challenger_merge").val(0);
	$("#mass_blessing_0").prop("selectedIndex",0);
	$("#mass_blessing_1").prop("selectedIndex",0);
	$("#mass_blessing_2").prop("selectedIndex",0);
	$("#mass_blessing_3").prop("selectedIndex",0);
	$("#mass_blessing_4").prop("selectedIndex",0);
	$("#mass_blessing_5").prop("selectedIndex",0);
	changeDataVar("mass.buffs.atk",0);
	changeDataVar("mass.buffs.spd",0);
	changeDataVar("mass.buffs.def",0);
	changeDataVar("mass.buffs.res",0);
	changeDataVar("mass.debuffs.atk",0);
	changeDataVar("mass.debuffs.spd",0);
	changeDataVar("mass.debuffs.def",0);
	changeDataVar("mass.debuffs.res",0);
	changeDataVar("mass.spur.atk",0);
	changeDataVar("mass.spur.spd",0);
	changeDataVar("mass.spur.def",0);
	changeDataVar("mass.spur.res",0);
	changeDataVar("mass.hp",100);
	changeDataVar("mass.precharge",0);
	changeDataVar("mass.merge",0);
	changeDataVar("mass.blessing.0","none");
	changeDataVar("mass.blessing.1","none");
	changeDataVar("mass.blessing.2","none");
	changeDataVar("mass.blessing.3","none");
	changeDataVar("mass.blessing.4","none");
	changeDataVar("mass.blessing.5","none");
	calcuWait(300);
}

function showImportDialog(side,type){
	//side = challenger or enemies, type = import or export
	var label = "";
	if(type=="import"){
		label = "Import ";
		$("#export_collapse_label").hide();
		$("#importinput").val("");
		setTimeout(function(){
			$("#importinput")[0].focus();
		}, 10); //Because focus will be immediately lost from click
		$("#button_import").html("Import into calculator").off("click").on("click",function(){importText(side);});
	}
	else{
		label = "Export ";
		$("#button_import").html("Copy to clipboard").off("click").on("click",function(){copyExportText();});
		$("#export_collapse_label").show().off("click").on("click",function(){$("#importinput").val(getExportText(side));});
		$("#importinput").val(getExportText(side));
	}

	if(side=="challenger"){
		$("#frame_import").removeClass("enemiesimport").addClass("challengerimport");
		label += "challenger";
	}
	else if(side=="enemies"){
		$("#frame_import").removeClass("enemiesimport").addClass("enemiesimport");
		label += "enemies";
	}

	$("#import_title").html(label);

	$("#screen_fade").show();
	$("#frame_import").show();
}

function hideImportDialog(){
	$("#screen_fade").hide();
	$("#frame_import").hide();
}

function importText(side,clist){
	var impText = "";
	impText = $("#importinput").val();
	try {impText = window.atob(impText);}
	catch(err) {
		alert("Your units could not be imported!  Please make sure you copy and paste the Export text properly.");
		return;
	}
	impText = impText.replace(/hero/g,"index");
	impText = impText.replace(/@/g,"true");
	impText = impText.replace(/#/g,"false");
	//remove any legacy "ally" values
	impText = impText.replace(",\"ally\":\"none\"","");
	var importSplit = impText.split(";");
	var sideCheck = importSplit.splice(0,1);
	var importList = [];
	if(sideCheck == "unitchart"){
		var iText = JSON.stringify(importSplit);
		iText = iText.replace(/"/g, "").replace("[", "").replace("]", "");
		importList = iText.split(",").map(Number);
	}
	else{
		importSplit.pop();
		importSplit = importSplit.filter(function(e){return e}); 
		for(var i = 0; i < importSplit.length; i++){
			try {
				importList[i] = JSON.parse(importSplit[i]);
				//add default values for legacy imports
				if(Object.hasOwn(importList[i], "buddy") == false){
					importList[i].buddy = {"rank":"N","adjacent":0,"two":0,"three":0,"rorc":0,"erorc":0,"spaces":0,"buffs": {"atk":0,"spd":0,"def":0,"res":0}, "debuffs": {"atk":0,"spd":0,"def":0,"res":0},"hpCondition":false,"bonusCondition":false,"penaltyCondition":false};
				}
				if(Object.hasOwn(importList[i], "vein") == false){
					importList[i].vein = 0;
				}
				if(Object.hasOwn(importList[i].bonus, "spectrum") == false){
					importList[i].bonus.spectrum = false;
				}
				if(Object.hasOwn(importList[i].penalty, "discord") == false){
					importList[i].penalty.discord = false;
				}
				if(Object.hasOwn(importList[i].bonus, "extra") == false){
					importList[i].bonus.extra = 0;
				}
				if(Object.hasOwn(importList[i].penalty, "extra") == false){
					importList[i].penalty.extra = 0;
				}
				if(Object.hasOwn(importList[i].support, "mboost") == false){
					importList[i].support.mboost = 0;
				}
				if(Object.hasOwn(importList[i].bonus, "dStar") == false){
					importList[i].bonus.dStar = false;
				}
				if(Object.hasOwn(importList[i].penalty, "ploy") == false){
					importList[i].penalty.ploy = false;
				}
				if(Object.hasOwn(importList[i].bonus, "bexblade") == false){
					importList[i].bonus.bexblade = false;
				}
				if(Object.hasOwn(importList[i].buddy, "bonusCondition") == false){
					importList[i].buddy.bonusCondition = false;
				}
				if(Object.hasOwn(importList[i].buddy, "penaltyCondition") == false){
					importList[i].buddy.penaltyCondition = false;
				}
				if(Object.hasOwn(importList[i].support, "lullAtk") == false){
					importList[i].support.lullAtk = false;
				}
				if(Object.hasOwn(importList[i], "x") == false){
					importList[i].x = -1;
				}
				if(Object.hasOwn(importList[i].penalty, "chip") == false){
					importList[i].penalty.chip = 0;
				}
				if(Object.hasOwn(importList[i].support, "fellProtect") == false){
					importList[i].support.fellProtect = 0;
				}
				if(Object.hasOwn(importList[i].penalty, "schism") == false){
					importList[i].penalty.schism = false;
				}
				if(Object.hasOwn(importList[i].penalty, "nullArise") == false){
					importList[i].penalty.nullArise = false;
				}
				if(Object.hasOwn(importList[i].bonus, "incited") == false){
					importList[i].bonus.incited = false;
				}
				if(importList[i].bonus.incited != true){
					importList[i].bonus.incited = false;
				}
				if(Object.hasOwn(importList[i].bonus, "fSight") == false){
					importList[i].bonus.fSight = false;
				}
				if(Object.hasOwn(importList[i].bonus, "rotten") == false){
					importList[i].bonus.rotten = false;
				}
				if(Object.hasOwn(importList[i].penalty, "tGrip") == false){
					importList[i].penalty.tGrip = false;
				}
				if(Object.hasOwn(importList[i].support, "dfu") == false){
					importList[i].support.dfu = 0;
				}
				if(importList[i].support.dfu == false){
					importList[i].support.dfu = 0;
				}
				if(Object.hasOwn(importList[i].support, "sGuard") == false){
					importList[i].support.sGuard = false;
				}
				if(Object.hasOwn(importList[i].support, "lullDef") == false){
					importList[i].support.lullDef = false;
				}
				if(Object.hasOwn(importList[i].support, "hippity") == false){
					importList[i].support.hippity = 0;
				}
				if(Object.hasOwn(importList[i].support, "crux") == false){
					importList[i].support.crux = 0;
				}
				if(Object.hasOwn(importList[i].penalty, "hush") == false){
					importList[i].penalty.hush = false;
				}
				if(Object.hasOwn(importList[i].support, "persp") == false){
					importList[i].support.persp = 0;
				}
				if(Object.hasOwn(importList[i].penalty, "deceit") == false){
					importList[i].penalty.deceit = false;
				}
				if(Object.hasOwn(importList[i].support, "nullPenAtk") == false){
					importList[i].support.nullPenAtk = false;
				}
				if(Object.hasOwn(importList[i].support, "nullPenSpd") == false){
					importList[i].support.nullPenSpd = false;
				}
				if(Object.hasOwn(importList[i].support, "fellSuccess") == false){
					importList[i].support.fellSuccess = 0;
				}
				if(Object.hasOwn(importList[i].bonus, "essence") == false){
					importList[i].bonus.essence = false;
				}
				if(Object.hasOwn(importList[i].penalty, "spoils") == false){
					importList[i].penalty.spoils = false;
				}
				if(Object.hasOwn(importList[i].support, "bol") == false){
					importList[i].support.bol = false;
				}
				if(Object.hasOwn(importList[i].support, "rdw") == false){
					importList[i].support.rdw = 0;
				}
				if(Object.hasOwn(importList[i].support, "cnlove") == false){
					importList[i].support.cnlove = 0;
				}
				if(Object.hasOwn(importList[i].support, "nlove") == false){
					importList[i].support.nlove = 0;
				}
				if(Object.hasOwn(importList[i].penalty, "frozen") == false){
					importList[i].penalty.frozen = false;
				}
				if(typeof importList[i].ephase == "undefined"){
					importList[i].ephase = {"panic":false,"exposure":false,"sabotage":false,"discord":false,"hush":false,"spoils":false,"fStart":false,"lit":false,"fatal":false,"nullArise":false,"feud":false,"ploy":false,"schism":false,"tGrip":false,"cdguard":false,"frozen":false,"trilemma":false,"reverse":false,"heal":0};
				}
				if(Object.hasOwn(importList[i].support, "lullSpd") == false){
					importList[i].support.lullSpd = false;
				}
				if(Object.hasOwn(importList[i].support, "diva") == false){
					importList[i].support.diva = 0;
				}
				if(Object.hasOwn(importList[i].bonus, "nectar") == false){
					importList[i].bonus.nectar = 0;
				}
				if(Object.hasOwn(importList[i].support, "lullRes") == false){
					importList[i].support.lullRes = false;
				}
				if(Object.hasOwn(importList[i].support, "trueDmg") == false){
					importList[i].support.trueDmg = 0;
				}
				if(Object.hasOwn(importList[i].support, "trueFirstDR") == false){
					importList[i].support.trueFirstDR = 0;
				}
				if(Object.hasOwn(importList[i].support, "sunper") == false){
					importList[i].support.sunper = 0;
				}
				if(Object.hasOwn(importList[i].support, "flutter") == false){
					importList[i].support.flutter = 0;
				}
				if(Object.hasOwn(importList[i].buddy, "rorc") == false){
					importList[i].buddy.rorc = 0;
				}
				if(Object.hasOwn(importList[i].bonus, "paranoia") == false){
					importList[i].bonus.paranoia = false;
				}
				if(Object.hasOwn(importList[i], "talent") == false){
					importList[i].talent = {"atk":0,"spd":0,"def":0,"res":0};
				}
				if(Object.hasOwn(importList[i].support, "nullPenDef") == false){
					importList[i].support.nullPenDef = false;
				}
				if(Object.hasOwn(importList[i].support, "nullPenRes") == false){
					importList[i].support.nullPenRes = false;
				}
				if(Object.hasOwn(importList[i].support, "nullCD") == false){
					importList[i].support.nullCD = false;
				}
				if(Object.hasOwn(importList[i].support, "rsd") == false){
					importList[i].support.rsd = 0;
				}
				if(Object.hasOwn(importList[i].buddy, "spaces") == false){
					importList[i].buddy.spaces = 0;
				}
				if(Object.hasOwn(importList[i].support, "tPulse") == false){
					importList[i].support.tPulse = 0;
				}
				if(Object.hasOwn(importList[i].buddy, "erorc") == false){
					importList[i].buddy.erorc = 0;
				}
				if(Object.hasOwn(importList[i].support, "hini") == false){
					importList[i].support.hini = 0;
				}
				if(Object.hasOwn(importList[i].bonus, "anathema") == false){
					importList[i].bonus.anathema = false;
				}
				if(Object.hasOwn(importList[i].bonus, "fWitness") == false){
					importList[i].bonus.fWitness = false;
				}
				if(Object.hasOwn(importList[i].bonus, "dosage") == false){
					importList[i].bonus.dosage = false;
				}
				if(Object.hasOwn(importList[i].support, "nullFGuard") == false){
					importList[i].support.nullFGuard = false;
				}
				if(Object.hasOwn(importList[i].bonus, "empathy") == false){
					importList[i].bonus.empathy = 0;
				}
				if(Object.hasOwn(importList[i].bonus, "divinely") == false){
					importList[i].bonus.divinely = 0;
				}
				if(Object.hasOwn(importList[i].bonus, "preempt") == false){
					importList[i].bonus.preempt = false;
				}
				if(Object.hasOwn(importList[i].bonus, "pfollow") == false){
					importList[i].bonus.pfollow = false;
				}
				if(Object.hasOwn(importList[i].bonus, "sdiff") == false){
					importList[i].bonus.sdiff = false;
				}
				if(Object.hasOwn(importList[i].support, "brAtk") == false){
					importList[i].support.brAtk = false;
				}
				if(Object.hasOwn(importList[i].support, "baura") == false){
					importList[i].support.baura = 0;
				}
				if(Object.hasOwn(importList[i].bonus, "dHex") == false){
					importList[i].bonus.dHex = false;
				}
				if(Object.hasOwn(importList[i].bonus, "nullArmor") == false){
					importList[i].bonus.nullArmor = false;
				}
				if(Object.hasOwn(importList[i].bonus, "nullDragon") == false){
					importList[i].bonus.nullDragon = false;
				}
				if(Object.hasOwn(importList[i].bonus, "fEmblem") == false){
					importList[i].bonus.fEmblem = false;
				}
			}
			catch(err) {
				alert("Your units could not be imported!  Please make sure you copy and paste the Export text properly.");
				return;
			}
		}
	}
	if(importList.length > 0 && (side == sideCheck || sideCheck == "unitchart")){
		if(side=="challenger"){
			var starter = challenger.length;
			var counter = importList.length + challenger.length;
			for(var i = starter; i < counter; i++){
				try {
					if(sideCheck == "unitchart"){
						//Figure out where the hero is (HID has gap...)
						var hidd = importList[i - starter] - 1;
						if(hidd > 110){
							hidd--;
						}
						if(hidd > 122){
							hidd--;
						}
						if(hidd > 158){
							hidd--;
						}
						addHero(hidd);
						initHero(challenger[i]);
					}
					else{
						challenger[i] = importList[i - starter];
						initHero(challenger[i],true);
					}
				}
				catch(err) {
					alert("There was an error adding a unit.  Please make sure you copy and paste the Export text properly.");
					return;
				}
			}
			updateChallengerList();
			updateChallengerUI();
		}
		else if(side=="enemies"){
			var starter = enemies.cl.list.length;
			var counter = importList.length + enemies.cl.list.length;
			for(var i = starter; i < counter; i++){
				try {
					if(sideCheck == "unitchart"){
						//Figure out where the hero is (HID has gap...)
						var hidd = importList[i - starter] - 1;
						if(hidd > 110){
							hidd--;
						}
						if(hidd > 122){
							hidd--;
						}
						if(hidd > 158){
							hidd--;
						}
						addClEnemy(hidd);
						initHero(enemies.cl.list[i]);
					}
					else{
						enemies.cl.list[i] = importList[i - starter];
						initHero(enemies.cl.list[i],true);
					}
				}
				catch(err) {
					alert("There was an error adding a unit.  Please make sure you copy and paste the Export text properly.");
					return;
				}
			}
			updateClList();
			updateEnemyUI();
		}
	}
	validateNumberInputs();
	hideImportDialog();
	calculate();
}

function getExportText(side){
	var delimiter = ";";
	if($("#export_collapse").is(":checked")){
		delimiter = ";;";
	}
	var exportText = "";
	if(side=="challenger"){
		if(challenger.length){
			exportText = "challenger" + delimiter;
			for(var i = 0; i < challenger.length; i++){
				exportText += getHeroExportText(challenger[i]) + delimiter;
			}
		}
	}
	else if(options.customEnemyList >= 1){
		if(enemies.cl.list.length){
			exportText = "enemies" + delimiter;
			for(var i = 0; i < enemies.cl.list.length; i++){
				exportText += getHeroExportText(enemies.cl.list[i]) + delimiter;
			}
		}
	}
	//Helper function for single heroes
	function getHeroExportText(hero){
		var heroExportText = "";
		if(hero.index != -1){
			var tempHero = JSON.parse(JSON.stringify(hero));
			//remove variables that are calculated and don't need to be passed on
			delete tempHero.hp; delete tempHero.atk; delete tempHero.spd; delete tempHero.def; delete tempHero.res;
			delete tempHero.validASkills;
			delete tempHero.validBSkills;
			delete tempHero.validCSkills;
			delete tempHero.validSSkills;
			delete tempHero.validXSkills;
			delete tempHero.validSpecialSkills;
			delete tempHero.validWeaponSkills;
			delete tempHero.naturalSkills;
			delete tempHero.listindex;
			delete tempHero.lastFightResult;
			tempHero = JSON.stringify(tempHero);
			//change some values to a shorter text for ease of use
			tempHero = tempHero.replace(/false/g,"#");
			tempHero = tempHero.replace(/true/g,"@");
			tempHero = tempHero.replace("index","hero");
			heroExportText += tempHero;
		}
		return heroExportText;
	}
	if(!exportText){
		exportText = "There is nothing to export!";
	}
	else{
		exportText = window.btoa(exportText);
	}
	//for potential text download option
	//var blob = new Blob([exportText], {type: "text/plain;charset=utf-8"});
	//saveAs(blob, "mass_duel_sim.txt");
	return exportText;
}

function copyExportText(){
	$("#importinput")[0].select();
	var successful = document.execCommand('copy');
	if(!successful){
		$("#button_import").html("Ctrl+C to finish the job");
	}
}

function updateChallengerList(){
	var lastHero = challenger.length - 1;
	//Set selected hero if there are enemies but none is selected
	if(lastHero != -1 && options.challengerSelected == -1){
		options.challengerSelected = lastHero;
	}
	var lastElement = -1;
	var heroElements = $(".hl_hero");
	$(".hlSelected").removeClass("hlSelected");
	//Show/hide existing elements based on number currently in list
	for(var element = 0; element < heroElements.length; element++){
		var hlIndex = parseInt($(heroElements[element]).attr("data-hlindex"));
		if(hlIndex > lastElement){
			lastElement = hlIndex;
		}
		if(hlIndex <= lastHero){
			//Update the text of the items in the list
			var heroIndex = challenger[hlIndex].index;
			var heroName = "New Challenger";
			if(heroIndex >= 0){
				heroName = changeGenericName(data.heroes[heroIndex].name);
			}
			$("#hl_hero" + hlIndex + "_name").html(heroName);
			if(hlIndex == options.challengerSelected){
				$("#hl_hero" + hlIndex).addClass("hlSelected");
			}
			$(heroElements[element]).show();
		}
		else{
			$(heroElements[element]).hide();
		}
	}

	//Create new elements if needed
	for(var hlIndex = lastElement + 1; hlIndex <= lastHero; hlIndex++){
		//Update the text of the items in the list
		var heroIndex = challenger[hlIndex].index;
		var heroName = "New Challenger";
		if(heroIndex >= 0){
			heroName = changeGenericName(data.heroes[heroIndex].name);
		}

		//Need to create a new element - the list is not pre-populated with hidden elements
		var hlHeroHTML = "<div class=\"hl_hero button\" id=\"hl_hero" + hlIndex + "\" data-hlindex=\"" + hlIndex + "\" onclick=\"selectHero(" + hlIndex + ")\"><span id=\"hl_hero" + hlIndex + "_name\">" + heroName;
		hlHeroHTML += "</span><div class=\"hl_delete_hero button\" id=\"hl_hero" + hlIndex + "_delete\" onclick=\"deleteHero(event," + hlIndex + ");\" onmouseover=\"undoHeroStyle(this)\" onmouseout=\"redoHeroStyle(this)\">x</div></div>";
		$("#hero_herolist_list").append(hlHeroHTML);
	}
}

function undoHeroStyle(element){
	$(element).parent().addClass("hl_destyled");
}

function redoHeroStyle(element){
	$(element).parent().removeClass("hl_destyled");
}

//changedNumber: Whether the number of enemies has changed - must do more intensive updating if this is the case
function updateClList(){
	var lastEnemy = enemies.cl.list.length - 1;
	//Set selected enemy if there are enemies but none is selected
	if(lastEnemy != -1 && options.customEnemySelected == -1){
		options.customEnemySelected = lastEnemy;
	}
	var lastElement = -1;
	var enemyElements = $(".cl_enemy");
	$(".clSelected").removeClass("clSelected");
	//Show/hide existing elements based on number currently in list
	for(var element = 0; element < enemyElements.length; element++){
		var clIndex = parseInt($(enemyElements[element]).attr("data-clindex"));
		if(clIndex > lastElement){
			lastElement = clIndex;
		}
		if(clIndex <= lastEnemy){
			//Update the text of the items in the list
			var enemyIndex = enemies.cl.list[clIndex].index;
			var enemyName = "New Enemy";
			if(enemyIndex >= 0){
				enemyName = changeGenericName(data.heroes[enemyIndex].name);
			}
			$("#cl_enemy" + clIndex + "_name").html(enemyName);
			if(clIndex == options.customEnemySelected){
				$("#cl_enemy" + clIndex).addClass("clSelected");
			}
			$(enemyElements[element]).show();
		}
		else{
			$(enemyElements[element]).hide();
		}
	}

	//Create new elements if needed
	for(var clIndex = lastElement + 1; clIndex <= lastEnemy; clIndex++){
		//Update the text of the items in the list
		var enemyIndex = enemies.cl.list[clIndex].index;
		var enemyName = "New Enemy";
		if(enemyIndex >= 0){
			enemyName = changeGenericName(data.heroes[enemyIndex].name);
		}

		//Need to create a new element - the list is not pre-populated with hidden elements
		var clEnemyHTML = "<div class=\"cl_enemy button\" id=\"cl_enemy" + clIndex + "\" data-clindex=\"" + clIndex + "\" onclick=\"selectClEnemy(" + clIndex + ")\"><span id=\"cl_enemy" + clIndex + "_name\">" + enemyName;
		clEnemyHTML += "</span><div class=\"cl_delete_enemy button\" id=\"cl_enemy" + clIndex + "_delete\" onclick=\"deleteClEnemy(event," + clIndex + ");\" onmouseover=\"undoClStyle(this)\" onmouseout=\"redoClStyle(this)\">x</div></div>";
		$("#cl_enemylist_list").append(clEnemyHTML);
	}
}

function undoClStyle(element){
	$(element).parent().addClass("cl_destyled");
}

function redoClStyle(element){
	$(element).parent().removeClass("cl_destyled");
}

function validateNumberInputs(){
	//For import function
	$("input[type=number]").toArray().forEach(function(element){
		var min = $(element).attr("min");
		var max = $(element).attr("max");
		if(typeof min != "undefined" && typeof max != "undefined"){
			var newVal = verifyNumberInput(element,min,max);
			var dataVar = $(element).attr("data-var");
			changeDataVar(dataVar, newVal);
			$(element).val(newVal);
		}
	});
}

//////////////////////////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////////////////////////

//Functions that get shit done

//////////////////////////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////////////////////////

function fight(enemyIndex,resultIndex){
	//passed resultIndex for tooltip
	//returns object with: rounds, fightText, enemy, challenger,outcome, fightHTML, and passFilters

	var fightText = "";
	
	var ahChallenger = new activeHero(challenger[options.challengerSelected]);
	var ahEnemy;

	var enemyList = [];
	if(options.customEnemyList>=1){
		enemyList = enemies.cl.list;
		
		//apply mass charge
		if(options.enemyMass == true){
			enemyList[enemyIndex].precharge = mass.precharge;
		}
	}

	ahEnemy = new activeHero(enemyList[enemyIndex]);
	var pngName = ahEnemy.name;
	ahEnemy.name = changeGenericName(ahEnemy.name);
	
	var trueTurn = options.startTurn;
	var cTick = 0;
	//reset danceCount so values don't pass to next fight (global var)
	danceCount = 0;

	for(var i = 0; i < options.roundInitiators.length; i++){
		if(options.roundInitiators[i] != "Dance"){
			if(options.roundInitiators[i]=="Challenger initiates"){
				cTick++;
			}
			if(cTick == 2){
				trueTurn++;
				cTick = 1;
				ahChallenger.onceTurn = false;
				ahEnemy.onceTurn = false;
			}
			fightText += "<div class=\"fight_round\"><span class=\"bold\">Round " + trueTurn;
			//For the moment, system will allow maximum 3 dances during a phase
			var j = i+1;
			for(var k = 0; k < 3; k++){
				if(options.roundInitiators[j]=="Dance"){
					danceCount++;
					j++;
				}
			}
			if(options.roundInitiators[i]=="Challenger initiates"){
				if(i != 0){//turns after initial setting of Vein
					if(ahEnemy.vein == 2 || ahEnemy.vein == 3 || ahEnemy.vein == 4 || ahEnemy.vein == 5){
						ahEnemy.vein = 0;
					}
					if(ahChallenger.vein == 1){
						ahChallenger.vein = 0;
					}
				}
				fightText += " (Player Phase): ";
				fightText += ahChallenger.name + " initiates</span><br>";
				fightText += ahChallenger.attack(ahEnemy,trueTurn,false,0,0);
			}
			else if(options.roundInitiators[i]=="Enemy initiates"){
				if(i > 1 || (i > 0 && options.roundInitiators[0]=="Enemy initiates")){//turns after initial setting of Vein
					if(ahEnemy.vein == 1){
						ahEnemy.vein = 0;
					}
					if(ahChallenger.vein == 2 || ahChallenger.vein == 3 || ahChallenger.vein == 4 || ahChallenger.vein == 5){
						ahChallenger.vein = 0;
					}
				}
				fightText += " (Enemy Phase): ";
				fightText += ahEnemy.name + " initiates</span><br>";
				fightText += ahEnemy.attack(ahChallenger,trueTurn,false,0,0);
			}
			if(ahEnemy.hp <= 0 || ahChallenger.hp <= 0){
				break;
			}
			else{
				if(options.roundInitiators[i]=="Enemy initiates"){
					trueTurn++;
					cTick = 0;
					ahChallenger.onceTurn = false;
					ahEnemy.onceTurn = false;
				}
			}
			fightText += "</div>";
		}
	}

	var outcome = "";
	var resultText = "";
	if(ahChallenger.hp<=0){
		outcome = "loss";
		resultText += "<span class=\"red\">loss</span>, " + trueTurn;
	}
	else if(ahEnemy.hp<=0){
		outcome = "win";
		resultText += "<span class=\"blue\">win</span>, " + trueTurn;
	}
	else{
		outcome = "inconclusive";
		resultText += "inconclusive";
	}

	if(outcome != "inconclusive"){
		if(trueTurn==1){
			resultText += " round";
		}
		else{
			resultText += " rounds";
		}
	}

	if(outcome == "win" || outcome == "loss"){
		if(ahEnemy.overkill){
			resultText += ", <span class=\"purple\">" + ahEnemy.overkill + "</span> overkill";
		}
		else if(ahChallenger.overkill){
			resultText += ", <span class=\"purple\">" + ahChallenger.overkill + "</span> overkill";
		}
	}

	var weaponName = "None";
	var specialName = "None";
	var aName = "noskill";
	var bName = "noskill";
	var cName = "noskill";
	var sName = "noskill";
	if(ahEnemy.weaponIndex != -1){
		weaponName = data.skills[ahEnemy.weaponIndex].name;
	}
	if(ahEnemy.specialIndex != -1){
		specialName = data.skills[ahEnemy.specialIndex].name;
	}
	if(ahEnemy.aIndex != -1){
		aName = data.skills[ahEnemy.aIndex].name.replace(/\s/g,"_");
	}
	if(ahEnemy.bIndex != -1){
		bName = data.skills[ahEnemy.bIndex].name.replace(/\s/g,"_");
	}
	if(ahEnemy.cIndex != -1){
		cName = data.skills[ahEnemy.cIndex].name.replace(/\s/g,"_");
	}
	if(ahEnemy.sIndex != -1){
		sName = data.skills[ahEnemy.sIndex].name.replace(/\s/g,"_");
	}

	var weaponTypeName = ahEnemy.weaponType;
	if(weaponTypeName == "dragon"){
		weaponTypeName = ahEnemy.color + "dragon";
	}
	else if(weaponTypeName == "bow"){
		weaponTypeName = ahEnemy.color + "bow";
	}
	else if(weaponTypeName == "dagger"){
		weaponTypeName = ahEnemy.color + "dagger";
	}
	else if(weaponTypeName == "beast"){
		weaponTypeName = ahEnemy.color + "beast";
	}

	if(typeof enemyList[enemyIndex].lastFightResult == "undefined"){
		enemyList[enemyIndex].lastFightResult = "";
	}

	var passFilters = ["all"];
	passFilters.push(outcome);
	//push sortable stats here
	passFilters.push(ahEnemy.range);
	passFilters.push(ahEnemy.color);
	passFilters.push(ahEnemy.attackType);
	passFilters.push(ahEnemy.moveType);
	passFilters.push(ahEnemy.weaponType);
	
	if(outcome == "win"){
		passFilters.push(1);
		if(ahEnemy.overkill){
			passFilters.push(ahEnemy.overkill);
		}
		else{
			passFilters.push(0);
		}
	}
	else if(outcome == "loss"){
		passFilters.push(3);
		if(ahChallenger.overkill){
			passFilters.push(ahChallenger.overkill);
		}
		else{
			passFilters.push(0);
		}
	}
	else{
		passFilters.push(2);
		passFilters.push(null);
	}
	
	if(outcome == "inconclusive" || outcome == "loss"){
		passFilters.push("loss_inconclusive");
	}

	if(enemyList[enemyIndex].lastFightResult){
		var prevResult = "";
		if(enemyList[enemyIndex].lastFightResult.indexOf("win") > -1){
			prevResult = "win";
		}
		else if(enemyList[enemyIndex].lastFightResult.indexOf("loss") > -1){
			prevResult = "loss";
		}
		else if(enemyList[enemyIndex].lastFightResult.indexOf("inconclusive") > -1){
			prevResult = "inconclusive";
		}

		if(outcome != prevResult){
			passFilters.push("changeVictor");
		}

		var prevRoundsMatch = enemyList[enemyIndex].lastFightResult.match(/([1-4]) trueTurn?/);
		var prevRounds = 0;
		if(prevRoundsMatch){
			prevRounds = prevRoundsMatch[1];
		}

		if(trueTurn != prevRounds && outcome == prevResult && outcome != "inconclusive"){
			//changeRounds means rounds changed but not result
			passFilters.push("changeRounds");
		}

		var prevHealthMatch = enemyList[enemyIndex].lastFightResult.match(/([0-9]+)<\/span> &ndash; <span class="red">([0-9]+)/);
		var prevOverkillMatch = enemyList[enemyIndex].lastFightResult.match(/([0-9]+)<\/span> overkill/);
		var prevChallengerEndHealth;
		var prevEnemyEndHealth;
		var prevOverkill;

		var currentChallengerEndHealth = ahChallenger.hp;
		var currentEnemyEndHealth = ahEnemy.hp;
		if(ahEnemy.overkill){
			currentEnemyEndHealth -= ahEnemy.overkill;
		}
		else if(ahChallenger.overkill){
			currentChallengerEndHealth -= ahChallenger.overkill;
		}

		if(prevHealthMatch){
			prevChallengerEndHealth = parseInt(prevHealthMatch[1]);
			prevEnemyEndHealth = parseInt(prevHealthMatch[2]);
		}

		if(prevOverkillMatch){
			prevOverkill = parseInt(prevOverkillMatch[1]);

			if(prevChallengerEndHealth == 0){
				prevChallengerEndHealth -= prevOverkill;
			}
			else if(prevEnemyEndHealth == 0){
				prevEnemyEndHealth -= prevOverkill;
			}
			
		}

		if(trueTurn == prevRounds && outcome == prevResult && (currentChallengerEndHealth != prevChallengerEndHealth || currentEnemyEndHealth != prevEnemyEndHealth)){
			passFilters.push("changeDamage");
		}
	}
	//Show buffs/debuffs, HP reductions
	//Also change colour of numbers/stat to indicate which have been boosted and which have been lowered
	var totalEnemyHp = ahEnemy.maxHp-ahEnemy.damage;
	var totalEnemyAtk = ahEnemy.atk+ahEnemy.buffs.atk+ahEnemy.debuffs.atk;
	var totalEnemySpd = ahEnemy.spd+ahEnemy.buffs.spd+ahEnemy.debuffs.spd;
	var totalEnemyDef = ahEnemy.def+ahEnemy.buffs.def+ahEnemy.debuffs.def;
	var totalEnemyRes = ahEnemy.res+ahEnemy.buffs.res+ahEnemy.debuffs.res;
	var hpColour = "HP:";
	var atkColour = "Atk:";
	var spdColour = "Spd:";
	var defColour = "Def:";
	var resColour = "Res:";
	var mergeValue = "";
	var currentCD = getCurrentCD(ahEnemy.weaponIndex,ahEnemy.specialIndex,ahEnemy.bIndex,ahEnemy.sIndex,ahEnemy.precharge,ahEnemy.refined,ahEnemy.emblem);
	
	if(totalEnemyHp < ahEnemy.maxHp){
		totalEnemyHp = "<span style=\"color:#fe4f6d\">"+totalEnemyHp.toString()+"</span>";
	}
	if(totalEnemyAtk > ahEnemy.atk){
		totalEnemyAtk = "<span style=\"color:#56e8ff\">"+totalEnemyAtk.toString()+" (+"+(ahEnemy.buffs.atk+ahEnemy.debuffs.atk)+")</span>";
	}
	else if(totalEnemyAtk < ahEnemy.atk){
		totalEnemyAtk = "<span style=\"color:#fe4f6d\">"+totalEnemyAtk.toString()+" ("+(ahEnemy.buffs.atk+ahEnemy.debuffs.atk)+")</span>";
	}
	if(totalEnemySpd > ahEnemy.spd){
		totalEnemySpd = "<span style=\"color:#56e8ff\">"+totalEnemySpd.toString()+" (+"+(ahEnemy.buffs.spd+ahEnemy.debuffs.spd)+")</span>";
	}
	else if(totalEnemySpd < ahEnemy.spd){
		totalEnemySpd = "<span style=\"color:#fe4f6d\">"+totalEnemySpd.toString()+" ("+(ahEnemy.buffs.spd+ahEnemy.debuffs.spd)+")</span>";
	}
	if(totalEnemyDef > ahEnemy.def){
		totalEnemyDef = "<span style=\"color:#56e8ff\">"+totalEnemyDef.toString()+" (+"+(ahEnemy.buffs.def+ahEnemy.debuffs.def)+")</span>";
	}
	else if(totalEnemyDef < ahEnemy.def){
		totalEnemyDef = "<span style=\"color:#fe4f6d\">"+totalEnemyDef.toString()+" ("+(ahEnemy.buffs.def+ahEnemy.debuffs.def)+")</span>";
	}
	if(totalEnemyRes > ahEnemy.res){
		totalEnemyRes = "<span style=\"color:#56e8ff\">"+totalEnemyRes.toString()+" (+"+(ahEnemy.buffs.res+ahEnemy.debuffs.res)+")</span>";
	}
	else if(totalEnemyRes < ahEnemy.res){
		totalEnemyRes = "<span style=\"color:#fe4f6d\">"+totalEnemyRes.toString()+" ("+(ahEnemy.buffs.res+ahEnemy.debuffs.res)+")</span>";
	}
	
	if((ahEnemy.boon == "hp" || ahEnemy.ascended == "hp") && ahEnemy.bane != "hp"){
		hpColour = "<span style=\"color:#7ff646\">HP</span>:";
	}
	else if((ahEnemy.boon != "hp" && ahEnemy.ascended != "hp") && ahEnemy.bane == "hp" && ahEnemy.merge == 0){
		hpColour = "<span style=\"color:#ff7d66\">HP</span>:";
	}
	if((ahEnemy.boon == "atk" || ahEnemy.ascended == "atk") && ahEnemy.bane != "atk"){
		atkColour = "<span style=\"color:#7ff646\">Atk</span>:";
	}
	else if((ahEnemy.boon != "atk" && ahEnemy.ascended != "atk") && ahEnemy.bane == "atk" && ahEnemy.merge == 0){
		atkColour = "<span style=\"color:#ff7d66\">Atk</span>:";
	}
	if((ahEnemy.boon == "spd" || ahEnemy.ascended == "spd") && ahEnemy.bane != "spd"){
		spdColour = "<span style=\"color:#7ff646\">Spd</span>:";
	}
	else if((ahEnemy.boon != "spd" && ahEnemy.ascended != "spd") && ahEnemy.bane == "spd" && ahEnemy.merge == 0){
		spdColour = "<span style=\"color:#ff7d66\">Spd</span>:";
	}
	if((ahEnemy.boon == "def" || ahEnemy.ascended == "def") && ahEnemy.bane != "def"){
		defColour = "<span style=\"color:#7ff646\">Def</span>:";
	}
	else if((ahEnemy.boon != "def" && ahEnemy.ascended != "def") && ahEnemy.bane == "def" && ahEnemy.merge == 0){
		defColour = "<span style=\"color:#ff7d66\">Def</span>:";
	}
	if((ahEnemy.boon == "res" || ahEnemy.ascended == "res") && ahEnemy.bane != "res"){
		resColour = "<span style=\"color:#7ff646\">Res</span>:";
	}
	else if((ahEnemy.boon != "res" && ahEnemy.ascended != "res") && ahEnemy.bane == "res" && ahEnemy.merge == 0){
		resColour = "<span style=\"color:#ff7d66\">Res</span>:";
	}
	if(ahEnemy.merge > 0){
		mergeValue = "(+" + ahEnemy.merge + ") ";
	}
	
	var ref_number = "";
	if(ahEnemy.rValue > 0){
		ref_number = "_" + ahEnemy.rValue;
	}
		
	fightHTML = ["<div class=\"results_entry\" id=\"result_" + resultIndex + "\" onmouseover=\"showResultsTooltip(event,this);\" onmouseout=\"hideResultsTooltip();\">",
		"<div class=\"results_hpbox\">",
			"<div class=\"results_hplabel\">HP</div>",
			"<div class=\"results_hpnums\">",
				"<span class=\"results_challengerhp\">" + ahChallenger.hp + "</span> &ndash; <span class=\"results_enemyhp\">" + ahEnemy.hp + "</span>",
			"</div>",
		"</div>",
		"<div class=\"frame_enemypicture\"><img class=\"results_enemypicture\" src=\"heroes/" + pngName + ".png\" onerror=\"scrubImage('.','heroes','results_enemypicture')\"/></div>",
		"<div class=\"results_topline\">",
			"<img class=\"weaponIconSmall\" src=\"weapons/" + weaponTypeName + ".png\"/><span class=\"results_enemyname\">" + mergeValue + ahEnemy.name + "</span> (<span class=\"results_outcome\">" + resultText + "</span>)",
			"<div class=\"results_previousresult\">" + enemyList[enemyIndex].lastFightResult + "</div>",
		"</div>",
		"<div class=\"results_bottomline\">",
			"<span class=\"results_stat\">"+hpColour+" " + totalEnemyHp + "</span><span class=\"results_stat\">"+atkColour+" " + totalEnemyAtk + "</span><span class=\"results_stat\">"+spdColour+" " + totalEnemySpd + "</span><span class=\"results_stat\">"+defColour+" " + totalEnemyDef + "</span><span class=\"results_stat\">"+resColour+" " + totalEnemyRes + "</span><span class=\"results_stat\">CD: " + currentCD + "</span><div class=\"results_skills\"><span class=\"results_stat\"><img class=\"skill_picture\" src=\"skills/weapon" + ref_number + ".png\"/>" + weaponName + "</span><span class=\"results_stat\"><img class=\"skill_picture\" src=\"skills/special.png\"/>" + specialName + "</span><span class=\"results_stat\"><img id=\"a_pic\" class=\"skill_picture\" src=\"skills/" + aName + ".png\" onerror=\"scrubImage('#','skills','a_pic')\"/><img id=\"b_pic\" class=\"skill_picture\" src=\"skills/" + bName + ".png\" onerror=\"scrubImage('#','skills','b_pic')\"/><img id=\"c_pic\" class=\"skill_picture\" src=\"skills/" + cName + ".png\" onerror=\"scrubImage('#','skills','c_pic')\"/><img id=\"s_pic\" class=\"skill_picture\" src=\"skills/" + sName + ".png\" onerror=\"scrubImage('#','skills','s_pic')\"/></span></div>",
		"</div>",
	"</div>",""].join("\n");
	
	enemyList[enemyIndex].lastFightResult = "Previous result: " + resultText + ", <span class=\"blue\">" + ahChallenger.hp + "</span> &ndash; <span class=\"red\">" + ahEnemy.hp + "</span>";

	return {
		"rounds":trueTurn,
		"fightText":fightText,
		"enemy":ahEnemy,
		"challenger":ahChallenger,
		"outcome":outcome,
		"fightHTML":fightHTML,
		"passFilters":passFilters
	};
}

function scrubImage(type, directory, idname){
	if(directory == "heroes"){
		$(type + idname).attr("src", directory + "/nohero.png");
	}
	if(directory == "skills"){
		$(type + idname).attr("src", directory + "/errorskill.png");
	}
}

function calcuWait(ms){//har har har
	//Waits to calculate on inputs like numbers that may be clicked a lot in a short time
	calcuwaitTime = ms;
	if(!calcuwaiting){
		calcuwaiting = true;
		calcuwaitTimer();
	}
}

function calcuwaitTimer(){
	if(calcuwaitTime <= 0){
		calcuwaiting = false;
		calculate();
	}
	else{
		calcuwaitTime -= 50;
		setTimeout(calcuwaitTimer,50);
	}
}

function calculate(manual){
	//console.log("calculated");
	//manual = true if button was clicked
	//calculates results and also adds them to page
	if(options.autoCalculate || manual == "go"){
		if(challenger.length > 0 && challenger[options.challengerSelected].index != -1 && options.challengerSelected != -1 && options.roundInitiators.length > 0 && enemies.cl.list.length > 0){
			var wins = 0;
			var losses = 0;
			var inconclusive = 0;

			fightResults = [];
			resultHTML = [];

			var enemyList = [];
			var mustConfirm = false;
			if(options.customEnemyList >= 1){
				for(var i = 0; i < enemies.cl.list.length; i++){
					var chosen = true;
					if(enemies.cl.list[i].index == -1){
						chosen = false;
					}
					else if(options.result.melee == false && data.meleeWeapons.indexOf(data.heroes[enemies.cl.list[i].index].weapontype) != -1){
						chosen = false;
					}
					else if(options.result.ranged == false && data.rangedWeapons.indexOf(data.heroes[enemies.cl.list[i].index].weapontype) != -1){
						chosen = false;
					}
					else if(options.result.red == false && data.heroes[enemies.cl.list[i].index].color == "red"){
						chosen = false;
					}
					else if(options.result.blue == false && data.heroes[enemies.cl.list[i].index].color == "blue"){
						chosen = false;
					}
					else if(options.result.green == false && data.heroes[enemies.cl.list[i].index].color == "green"){
						chosen = false;
					}
					else if(options.result.gray == false && data.heroes[enemies.cl.list[i].index].color == "gray"){
						chosen = false;
					}
					else if(options.result.physical == false && data.physicalWeapons.indexOf(data.heroes[enemies.cl.list[i].index].weapontype) != -1){
						chosen = false;
					}
					else if(options.result.magical == false && data.magicalWeapons.indexOf(data.heroes[enemies.cl.list[i].index].weapontype) != -1){
						chosen = false;
					}
					else if(options.result.infantry == false && data.heroes[enemies.cl.list[i].index].movetype == "infantry"){
						chosen = false;
					}
					else if(options.result.cavalry == false && data.heroes[enemies.cl.list[i].index].movetype == "cavalry"){
						chosen = false;
					}
					else if(options.result.flying == false && data.heroes[enemies.cl.list[i].index].movetype == "flying"){
						chosen = false;
					}
					else if(options.result.armored == false && data.heroes[enemies.cl.list[i].index].movetype == "armored"){
						chosen = false;
					}
					if(chosen == true){
						//if option is checked, append listindex value to cl.list
						enemies.cl.list[i].listindex = i;
						enemyList.push(enemies.cl.list[i]);
					}
				}
			}
			
			for(var i = 0;i<enemyList.length;i++){
				
				//apply mass merge setting for CL
				if(options.customEnemyList >= 1 && options.enemyMass == true && enemyList[i].index != -1){
					if(mass.hp == "100"){
						enemyList[i].damage = 0;
					}
					else if(mass.hp == "75"){
						enemyList[i].damage = Math.ceil(enemyList[i].hp*0.25);
					}
					else if(mass.hp == "50"){
						enemyList[i].damage = Math.ceil(enemyList[i].hp*0.5);
					}
					else if(mass.hp == "25"){
						enemyList[i].damage = Math.ceil(enemyList[i].hp*0.75);
					}
					//filterBuff(enemyList[i],mass.buffs);
					enemyList[i].buffs = mass.buffs;
					enemyList[i].debuffs = mass.debuffs;
					enemyList[i].spur = mass.spur;
					enemyList[i].merge = mass.merge;
					//set bane to none if merge is greater than 0
					enemyList[i].blessing = mass.blessing;
					setStats(enemyList[i]);
				}
				if(enemyList[i].index >= 0 && !mustConfirm || enemyList[i].included){
					//if it's custom list, take listindex rather than a numerical count like full list
					if(options.customEnemyList >= 1){
						fightResults.push(fight(enemyList[i].listindex,fightResults.length));
					}
					else{
						fightResults.push(fight(i,fightResults.length));
					}
				}
			}

			for(var i = 0; i < fightResults.length;i++){

				if(fightResults[i].outcome=="loss"){
					losses++;
				}
				else if(fightResults[i].outcome=="win"){
					wins++;
				}
				else{
					inconclusive++;
				}

				resultHTML.push({sortWeight:getComparisonWeight(fightResults[i]), html:fightResults[i].fightHTML, passFilters:fightResults[i].passFilters});
			}

			resultHTML.sort(function(a,b){
				//sort fights from best wins to worst losses
				//first by win, then by rounds, then by hp
				if(a.sortWeight == b.sortWeight){
					return 0;
				}
				else{
					return (a.sortWeight < b.sortWeight)*2-1;
				}
			});
			outputResults();

			var total = wins + losses + inconclusive;
			$("#results_graph_wins").animate({"width":wins/total*1036+"px"},200);
			$("#results_graph_losses").animate({"width":losses/total*1036+"px"},200);
			$("#win_pct").html(wins);
			$("#lose_pct").html(losses);
			$("#inconclusive_pct").html(inconclusive);
		}
		else{
			$("#results_graph_wins").animate({"width":"0px"},200);
			$("#results_graph_losses").animate({"width":"0px"},200);
			$("#win_pct").html("-");
			$("#lose_pct").html("-");
			$("#inconclusive_pct").html("-");
			$("#results_list").html("");
		}
	}
}

function getComparisonWeight(fightResult){
	var weight = 0;
	if(fightResult.enemy.hp <= 0){
		weight += 100;
	}
	else{
		weight += (1 - (fightResult.enemy.hp / fightResult.enemy.maxHp)) * 40;
	}
	if(fightResult.challenger.hp <= 0){
		weight -= 100;
	}
	else{
		weight -= (1 - (fightResult.challenger.hp / challenger.hp)) * 40;
	}
	weight /= fightResult.rounds;
	//console.log(fightResult.challenger.hp + " - " + fightResult.enemy.hp + ", " + fightResult.rounds + "rnd: " + weight);
	return weight;
}

function outputResults(){
	//function separate from calculation so user can re-sort without recalculating
	//Hide results that aren't different if view is set to changed only
	var outputHTML = "";
	if(options.sortType > 0){
		var viewSort = function(stype){
			return function(a,b){
				if(stype == 2){//Overkill Asc
					return a["passFilters"][7] - b["passFilters"][7] || a["passFilters"][8] - b["passFilters"][8];
				}
				else if(stype == 3){//Overkill Desc
					return a["passFilters"][7] - b["passFilters"][7] || b["passFilters"][8] - a["passFilters"][8];
				}
				else if(stype == 4){//Overdeath Asc
					return b["passFilters"][7] - a["passFilters"][7] || a["passFilters"][8] - b["passFilters"][8];
				}
				else if(stype == 5){//Overdeath Desc
					return b["passFilters"][7] - a["passFilters"][7] || b["passFilters"][8] - a["passFilters"][8];
				}
				else if(stype == 6){//weapon
					return a["passFilters"][6] < b["passFilters"][6] ? -1 : 1;
				}
			};
		};
		resultHTML.sort(viewSort(options.sortType));
	}
	else{
		resultHTML.sort(filterWeight);
	}
	for(var i = 0; i < resultHTML.length; i++){
		if(filterResult(i)){
			outputHTML += resultHTML[i].html;
		}
	}
	$("#results_list").html(outputHTML);
}

function filterWeight(a,b){
	var aVal = a.sortWeight;
	var bVal = b.sortWeight;
	return ((aVal > bVal) ? -1 : ((aVal < bVal) ? 1 : 0));
}

//Helper function for filtering
//Will return true if include or false if not
function filterResult(i){
	return resultHTML[i].passFilters.indexOf(options.viewFilter) > -1;
}

function exportCalc(){
	//Exports all results to csv - doesn't take filters into account
	//If people complain, I will make it take the filters into account

	if(fightResults.length>0){
		var csvString = "data:text/csv;charset=utf-8,";
		var i = options.challengerSelected;;

		//Column headers
		//Should take out buffs and stuff that aren't used to minimize columns?
		csvString += "Challenger,cColor,cMovetype,cWeapontype,cRarity,cMerge,cBoon,cBane,cAscended,cMaxHP,cStartHP,cAtk,cSpd,cDef,cRes,cWeapon,cSpecial,cPrecharge,cA,cB,cC,cS,cX,cSD,cBuffAtk,cBuffSpd,cBuffDef,cBuffRes,cDebuffAtk,cDebuffSpd,cDebuffDef,cDebuffRes,cSpurAtk,cSpurSpd,cSpurDef,cSpurRes,";
		csvString += "Enemy,eColor,eMovetype,eWeapontype,eRarity,eMerge,eBoon,eBane,eAscended,eMaxHP,eStartHP,eAtk,eSpd,eDef,eRes,eWeapon,eSpecial,ePrecharge,eA,eB,eC,eS,eX,eSD,eBuffAtk,eBuffSpd,eBuffDef,eBuffRes,eDebuffAtk,eDebuffSpd,eDebuffDef,eDebuffRes,eSpurAtk,eSpurSpd,eSpurDef,eSpurRes,";
		csvString += "DefenseTile,FirstTurnThreaten,StartTurn,UseGaleforce,Initiator1,Initiator2,Initiator3,Initiator4,Outcome,cEndHP,eEndHP,Rounds,Overkill,BattleLog\n";

		fightResults.forEach(function(result){
			csvString += data.heroes[challenger[i].index].name + ",";
			csvString += data.heroes[challenger[i].index].color + ",";
			csvString += data.heroes[challenger[i].index].movetype + ",";
			csvString += data.heroes[challenger[i].index].weapontype + ",";
			csvString += challenger[i].rarity + ",";
			csvString += challenger[i].merge + ",";
			csvString += challenger[i].boon + ",";
			csvString += challenger[i].bane + ",";
			csvString += challenger[i].ascended + ",";
			csvString += challenger[i].hp + ",";
			csvString += Math.max(challenger[i].hp - challenger[i].damage,1) + ",";
			csvString += challenger[i].atk + ",";
			csvString += challenger[i].spd + ",";
			csvString += challenger[i].def + ",";
			csvString += challenger[i].res + ",";
			if(challenger[i].weapon != -1){
				csvString += data.skills[challenger[i].weapon].name + ",";
			}
			else{
				csvString += ",";
			}
			if(challenger[i].special != -1){
				csvString += data.skills[challenger[i].special].name + ",";
			}
			else{
				csvString += ",";
			}
			csvString += challenger[i].precharge + ",";
			if(challenger[i].a != -1){
				csvString += data.skills[challenger[i].a].name + ",";
			}
			else{
				csvString += ",";
			}
			if(challenger[i].b != -1){
				csvString += data.skills[challenger[i].b].name + ",";
			}
			else{
				csvString += ",";
			}
			if(challenger[i].c != -1){
				csvString += data.skills[challenger[i].c].name + ",";
			}
			else{
				csvString += ",";
			}
			if(challenger[i].s != -1){
				csvString += data.skills[challenger[i].s].name + ",";
			}
			else{
				csvString += ",";
			}
			if(challenger[i].x != -1){
				csvString += data.skills[challenger[i].x].name + ",";
			}
			else{
				csvString += ",";
			}
			if(challenger[i].sd != -1){
				csvString += data.skills[challenger[i].sd].name + ",";
			}
			else{
				csvString += ",";
			}
			csvString += challenger[i].buffs.atk + ",";
			csvString += challenger[i].buffs.spd + ",";
			csvString += challenger[i].buffs.def + ",";
			csvString += challenger[i].buffs.res + ",";
			csvString += challenger[i].debuffs.atk + ",";
			csvString += challenger[i].debuffs.spd + ",";
			csvString += challenger[i].debuffs.def + ",";
			csvString += challenger[i].debuffs.res + ",";
			csvString += challenger[i].spur.atk + ",";
			csvString += challenger[i].spur.spd + ",";
			csvString += challenger[i].spur.def + ",";
			csvString += challenger[i].spur.res + ",";

			var enemy = result.enemy;
			csvString += enemy.name + ",";
			csvString += enemy.color + ",";
			csvString += enemy.moveType + ",";
			csvString += enemy.weaponType + ",";
			csvString += enemy.rarity + ",";
			csvString += enemy.merge + ",";
			csvString += enemy.boon + ",";
			csvString += enemy.bane + ",";
			csvString += enemy.ascended + ",";
			csvString += enemy.maxHp + ",";
			csvString += Math.max(enemy.maxHp - enemy.damage,1) + ",";
			csvString += enemy.atk + ",";
			csvString += enemy.spd + ",";
			csvString += enemy.def + ",";
			csvString += enemy.res + ",";
			if(enemy.weaponIndex != -1){
				csvString += data.skills[enemy.weaponIndex].name + ",";
			}
			else{
				csvString += ",";
			}
			if(enemy.specialIndex != -1){
				csvString += data.skills[enemy.specialIndex].name + ",";
			}
			else{
				csvString += ",";
			}
			if(enemy.aIndex != -1){
				csvString += data.skills[enemy.aIndex].name + ",";
			}
			else{
				csvString += ",";
			}
			if(enemy.bIndex != -1){
				csvString += data.skills[enemy.bIndex].name + ",";
			}
			else{
				csvString += ",";
			}
			if(enemy.cIndex != -1){
				csvString += data.skills[enemy.cIndex].name + ",";
			}
			else{
				csvString += ",";
			}
			if(enemy.sIndex != -1){
				csvString += data.skills[enemy.sIndex].name + ",";
			}
			else{
				csvString += ",";
			}
			if(enemy.xIndex != -1){
				csvString += data.skills[enemy.xIndex].name + ",";
			}
			else{
				csvString += ",";
			}
			if(enemy.sdIndex != -1){
				csvString += data.captainSkills[enemy.sdIndex] + ",";
			}
			else{
				csvString += ",";
			}
			csvString += enemy.buffs.atk + ",";
			csvString += enemy.buffs.spd + ",";
			csvString += enemy.buffs.def + ",";
			csvString += enemy.buffs.res + ",";
			csvString += enemy.debuffs.atk + ",";
			csvString += enemy.debuffs.spd + ",";
			csvString += enemy.debuffs.def + ",";
			csvString += enemy.debuffs.res + ",";
			csvString += enemy.spur.atk + ",";
			csvString += enemy.spur.spd + ",";
			csvString += enemy.spur.def + ",";
			csvString += enemy.spur.res + ",";

			csvString += options.threatenRule + ",";
			csvString += options.startTurn + ",";
			csvString += options.prfVal + ",";
			csvString += options.style + ",";
			csvString += options.tstyle + ",";
			csvString += options.useGaleforce + ",";
			for(var rnd = 0; rnd < 4;rnd++){
				if(!!options.roundInitiators[rnd]){
					csvString += options.roundInitiators[rnd].substring(0,options.roundInitiators[rnd].length-10) + ",";
				}
				else{
					csvString += ",";
				}
			}
			var outcome = "Inconclusive";
			var overkill = 0;
			if(result.challenger.hp==0){
				outcome = "Loss";
				overkill = result.challenger.overkill;
			}
			else if(result.enemy.hp==0){
				outcome = "Win";
				overkill = result.enemy.overkill;
			}
			csvString += outcome + ",";
			csvString += result.challenger.hp + ",";
			csvString += result.enemy.hp + ",";
			csvString += result.rounds + ",";
			csvString += overkill + ",";
			var deTaggedLog = result.fightText.replace(/<br\/?>/g, "; ");
			deTaggedLog = deTaggedLog.replace(/<\/?[^>]+(>|$)/g, "");
			csvString += "\"" + deTaggedLog + "\"";

			csvString += "\n";
		});

		var encodedUri = encodeURI(csvString);
		var fakeLink = document.createElement("a");
		fakeLink.setAttribute("href", encodedUri);
		var date = new Date();
		fakeLink.setAttribute("download", "feh_simulator_" + (date.getYear()+1900) + "-" + (date.getMonth()+1) + "-" + date.getDate() + "_" + data.heroes[challenger[i].index].name + ".csv");
		document.body.appendChild(fakeLink);
		fakeLink.click();
	}
	else{
		alert("No results!");
	}
}

//////////////////////////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////////////////////////

//activeHero

//////////////////////////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////////////////////////

//activeHero is a class for simulating a unit in a battle
//This is where most of the calculations happen
//heroIndex is the index of the hero represented
//challenger is true if challenger, false if enemy
function activeHero(hero){

	this.combatBuffs = {"atk":0,"spd":0,"def":0,"res":0};
	this.combatDebuffs = {"atk":0,"spd":0,"def":0,"res":0};
	this.combatSpur = {"atk":0,"spd":0,"def":0,"res":0};

	this.skillNames = [];

	this.challenger = !!hero.challenger; //Will be undefined if not challenger
	this.heroIndex = hero.index;
	
	this.rarity = hero.rarity;
	this.merge = hero.merge;

	this.weaponIndex = hero.weapon;
	this.specialIndex = hero.special;
	this.aIndex = hero.a;
	this.bIndex = hero.b;
	this.cIndex = hero.c;
	this.sIndex = hero.s;
	this.xIndex = hero.x;
	this.sdIndex = hero.sd;
	this.rValue = hero.refined;
	this.toggle = hero.toggle;

	this.boon = hero.boon;
	this.bane = hero.bane;
	this.ascended = hero.ascended;
	this.damage = hero.damage;

	this.buffs = Object.assign({}, hero.buffs);
	this.debuffs = Object.assign({}, hero.debuffs);
	this.spur = Object.assign({}, hero.spur);
	this.talent = Object.assign({}, hero.talent);

	this.bonus = Object.assign({}, hero.bonus);
	this.support = Object.assign({}, hero.support);
	this.ephase = Object.assign({}, hero.ephase);
	this.penalty = Object.assign({}, hero.penalty);
	this.buddy = Object.assign({}, hero.buddy);
	
	this.maxHp = hero.hp;
	this.atk = hero.atk;
	this.spd = hero.spd;
	this.def = hero.def;
	this.res = hero.res;

	if(this.heroIndex != -1){
		this.name = data.heroes[this.heroIndex].name;
		this.moveType = data.heroes[this.heroIndex].movetype;
		this.weaponType = data.heroes[this.heroIndex].weapontype;
		this.color = data.heroes[this.heroIndex].color;
	}

	this.hp = Math.max(this.maxHp - hero.damage,1);
	this.precharge = hero.precharge;
	this.sTrigger = 0;
	
	//for defense tile
	this.dTile = 0;
	if(hero.defenseTile == true){
		this.dTile = 0.3;
	}

	//Make a list of skill names for easy reference
	if(this.weaponIndex != -1){
		this.skillNames.push(data.skills[this.weaponIndex].name);
	}
	if(this.specialIndex != -1){
		this.skillNames.push(data.skills[this.specialIndex].name);
	}
	if(this.aIndex != -1){
		this.skillNames.push(data.skills[this.aIndex].name);
	}
	if(this.bIndex != -1){
		this.skillNames.push(data.skills[this.bIndex].name);
	}
	if(this.cIndex != -1){
		this.skillNames.push(data.skills[this.cIndex].name);
	}
	if(this.sIndex != -1){
		this.skillNames.push(data.skills[this.sIndex].name);
	}
	if(this.xIndex != -1){
		this.skillNames.push(data.skills[this.xIndex].name);
	}

	//Categorize weapon
	if(data.rangedWeapons.indexOf(this.weaponType)!=-1){
		this.range = "ranged";
	}
	else{
		this.range = "melee";
	}
	if(data.physicalWeapons.indexOf(this.weaponType)!=-1){
		this.attackType = "physical";
	}
	else{
		this.attackType = "magical";
	}

	this.charge = 0;
	this.ice = 0;
	this.beacon = [0,0];
	this.arise = false;
	this.onceTurn = false;
	this.initiator = false;
	this.didAttack = false;
	this.anyCounter = false;
	this.transform = hero.transform;
	this.resplendent = hero.resplendent;
	this.style = hero.style;
	this.tstyle = hero.tstyle;
	this.dragonflower = hero.dragonflower;
	this.emblem = hero.emblem;
	this.emerge = hero.emerge;
	this.reinforcement = hero.reinforcement;
	this.vein = hero.vein;
	this.strikes = 0;
	if(hero.prfVal > -1 && hero.prfVal < 97){//change limit when new skills come out that can surpass 96
		this.prfVal = hero.prfVal;
		if(hero.c != -1 && data.skills[hero.c].skill_id == 3161 && hero.prfVal > 40){
			this.prfVal = 40;
		}
		else if(hero.weapon != -1 && (data.skills[hero.weapon].skill_id == 3540 || data.skills[hero.weapon].skill_id == 4116) && hero.prfVal > 4){
			this.prfVal = 4;
		}
		else if(hero.weapon != -1 && (data.skills[hero.weapon].skill_id == 2191 && hero.refined > 0) && hero.prfVal > 3){
			this.prfVal = 3;
		}
		else if(hero.weapon != -1 && data.skills[hero.weapon].skill_id == 2041 && hero.refined == 5 && hero.prfVal > 48){
			this.prfVal = 48;
		}
		else if(hero.weapon != -1 && ((data.skills[hero.weapon].skill_id == 2079 && hero.refined == 5) || data.skills[hero.weapon].skill_id == 3753) && hero.prfVal > 20){
			this.prfVal = 20;
		}
		else if(hero.weapon != -1 && (data.skills[hero.weapon].skill_id > 3666 || (data.skills[hero.weapon].skill_id == 2418 && hero.refined > 0)) && data.heroes[hero.index].weapontype == "beast" && data.heroes[hero.index].movetype == "cavalry" && hero.transform == true && hero.prfVal > 3){
			this.prfVal = 3;
		}
	}
	
	this.has = function(skill){
		//finds if hero has a skill that includes the string given
		//returns 1 if found, or a number 1-3 if level of skill is found
		//For exact matches, see "hasExactly"
		var index = -1;

		for(var i = 0; i < this.skillNames.length; i++){
			if(this.skillNames[i].indexOf(skill) != -1){
				index = i;
			}
		}

		if(index != -1){
			if($.isNumeric(this.skillNames[index].charAt(this.skillNames[index].length-1))){
				return parseInt(this.skillNames[index].charAt(this.skillNames[index].length-1));
			}
			else{
				return 1;
			}
		}
		else{
			return 0;
		}
	};
	
	this.hasSlot = function(skill,slot){
		//finds if hero has a skill that includes the string given in given slot
		//slot = weapon, special, a, b, c, s
		//returns 1 if found, or a number 1-3 if level of skill is found
		var index = -1;
		
		if(slot == "weapon"){
			index = this.weaponIndex;
		}
		else if(slot == "special"){
			index = this.specialIndex;
		}
		else if(slot == "a"){
			index = this.aIndex;
		}
		else if(slot == "b"){
			index = this.bIndex;
		}
		else if(slot == "c"){
			index = this.cIndex;
		}
		else if(slot == "s"){
			index = this.sIndex;
		}
		if(index != -1){
			if(data.skills[index].name.indexOf(skill) != -1){
				if($.isNumeric(data.skills[index].name.charAt(data.skills[index].name.length-1))){
					return parseInt(data.skills[index].name.charAt(data.skills[index].name.length-1));
				}
				else{
					return 1;
				}
			}
			else{
				return 0;
			}
		}
		else{
			return 0;
		}
	};
	
	this.hasGreatest = function(skill){
		//finds if hero has a skill that includes the string given, determines which is the greatest value in all slots and returns highest skill value (0) and index of this.skillNames (1)
		//returns 1,1 if found, returns 0,0 if not found
		//otherwise, returns highest value and index value of skillNames

		var index = [];
		var result = [];

		for(var i = 0; i < this.skillNames.length; i++){
			if(this.skillNames[i].indexOf(skill) != -1){
				index.push(i);
			}
		}
		//When there's only one skill slot matching
		if(index.length == 1){
			if($.isNumeric(this.skillNames[index[0]].charAt(this.skillNames[index[0]].length-1))){
				result.push(parseInt(this.skillNames[index[0]].charAt(this.skillNames[index[0]].length-1)));
			}
			else{
				result.push(1);
			}
			result.push(index[0]);
		}
		//When there's an a/b/c & s
		else if(index.length == 2){
			var notS = this.skillNames[index[0]].charAt(this.skillNames[index[0]].length-1);
			var yesS = this.skillNames[index[1]].charAt(this.skillNames[index[1]].length-1);
			//Check to see if skill has a level value (ie. 1-3)
			if ($.isNumeric(notS) && $.isNumeric(yesS)){
				if(notS >= yesS){
					result.push(parseInt(notS));
					result.push(index[0]);
				}
				else{
					result.push(parseInt(yesS));
					result.push(index[1]);
				}
			}
			else{
				result.push(1);
				result.push(index[0]);
			}
		}
		else{
			result.push(0);
			result.push(0);
		}
		return result;
	};

	this.hasExactly = function(skill){
		//finds if hero has a skill with an exact name
		//returns true if found
		for(var i = 0; i < this.skillNames.length; i++){
			if(this.skillNames[i] == skill){
				return true;
			}
		}

		return false;
	};
	
	this.hasCaptain = function(skill){
		//finds if hero has a captain skill with an exact name
		//returns true if found
		if(data.captainSkills[this.sdIndex] == skill){
			return true;
		}
		return false;
	};
	
	this.isFeuded = function(enemy){
		var enHP = enemy.hp;
		if(enemy.combatStartHp){
			enHP = enemy.combatStartHp;
		}
		var thHP = this.hp;
		if(this.combatStartHp){
			thHP = this.combatStartHp;
		}
		//Returns true if hero is feuded
		if(this.hasExactly("Queensblade") || enemy.hasExactly("Queensblade") || this.penalty.feud || (enemy.hasCaptain("Secret Maneuver") && enemy.toggle.sd == 0) || enemy.hasExactly("Impenetrable Dark") || enemy.hasExactly("Impenetrable Void") || (enemy.hasExactly("Swift Mulagir") && enemy.rValue > 0 && enemy.toggle.weapon == 1) || (enemy.has("Red Feud") && this.color == "red") || (enemy.has("C Feud") && this.color == "gray") || (enemy.has("Green Feud") && this.color == "green") || (enemy.has("Blue Feud") && this.color == "blue") || (enemy.hasExactly("Holy Yewfelle") && enemy.rValue > 0 && (!this.initiator || thHP / this.maxHp >= 0.75)) || this.hasExactly("Breezy Spear") || enemy.hasExactly("Breezy Spear") || ((enemy.hasExactly("Divine Yewfelle") || (enemy.hasExactly("Bow of Frelia") && enemy.rValue == 5)) && (!this.initiator || enemy.buddy.adjacent > 0 || enemy.buddy.two > 0)) || (enemy.hasExactly("Tailwind Shuriken") && enemy.rValue > 0 && enHP / enemy.maxHp >= 0.25) || enemy.hasExactly("Preempt Screech")){
			return true;
		}
		return false;
	};
	
	this.checkNegate = function(enemy,turn){
		//Function to check if enemy has debuff negation
		//Returns array (0 atk, 1 spd, 2 def, 3 res) with true or false values to indicate whether it negates or not
		var nStats = [false,false,false,false];
		var fCheck = enemy.isFeuded(this);
			
		if(enemy.hasExactly("Randgridr") && (this.combatStartHp / this.maxHp == 1 || (enemy.rValue > 0 && this.combatStartHp / this.maxHp >= 0.75))){
			nStats = [true,true,true,true];
		}
		else if((enemy.hasExactly("Demonic Breath") || enemy.hasExactly("Fimbulvetr")) && (enemy.toggle.weapon == 1 || enemy.combatStartHp / enemy.maxHp < 1)){
			nStats = [true,true,true,true];
		}
		else if(enemy.hasExactly("Fimbulvetr") && enemy.rValue > 0 && (this.combatStartHp / this.maxHp >= 0.75 || enemy.toggle.weapon > 3)){
			nStats = [true,true,true,true];
		}
		else if(enemy.hasExactly("Balmung") && (this.initiator || this.combatStartHp / this.maxHp == 1 || (enemy.rValue > 0 && this.combatStartHp / this.maxHp >= 0.75))){
			nStats = [true,true,true,true];
		}
		else if(enemy.hasExactly("Eagle's Egg") && (enemy.toggle.weapon == 1 || enemy.toggle.weapon == 4 || enemy.toggle.weapon == 5 || enemy.toggle.weapon == 7 || (enemy.rValue > 0 && !this.initiator))){
			nStats = [true,true,true,true];
		}
		else if(enemy.hasExactly("Dew Dragonstone") && enemy.toggle.weapon == 1){
			nStats = [true,true,true,true];
		}
		else if((enemy.has("Gilt Fork") || enemy.has("Carrot Cudgel") || enemy.has("Pale Breath") || enemy.has("Steadfast Axe") || enemy.has("Steadfast Lance") || enemy.has("Steadfast Sword")) && enemy.toggle.weapon == 1){
			nStats[0] = true;
			nStats[2] = true;
		}
		else if(enemy.hasExactly("Zephyr Breath") && (enemy.toggle.weapon == 1 || checkAllBuffs(enemy, this, turn))){
			nStats = [true,true,true,true];
		}
		else if((enemy.hasExactly("Stalwart Sword") && enemy.rValue == 5 && enemy.toggle.weapon == 1) || (enemy.hasExactly("Delivering Antler") && (!this.initiator || enemy.buddy.adjacent > 0 || enemy.buddy.two > 0))){
			nStats[0] = true;
			nStats[2] = true;
		}
		else if(enemy.hasExactly("Purifying Breath") && enemy.rValue == 5 && enemy.combatStartHp / enemy.maxHp >= 0.5){
			nStats = [true,true,true,true];
		}
		else if((enemy.hasExactly("Blade of Shadow") || enemy.hasExactly("Spear of Shadow")) && (this.initiator || (this.combatStartHp / this.maxHp == 1 || (enemy.rValue > 0 && this.combatStartHp / this.maxHp >= 0.75)))){
			nStats = [true,true,true,true];
		}
		else if(enemy.hasExactly("Bright Naginata") && enemy.toggle.weapon == 1 && enemy.rValue == 5){
			nStats = [true,true,true,true];
		}
		else if((enemy.hasExactly("Setsuna's Yumi") && enemy.rValue == 5 && enemy.toggle.weapon == 1) || ((enemy.hasExactly("Lyngheidr") || enemy.hasExactly("Hades O")) && enemy.rValue > 0 && (!this.initiator || enemy.buddy.adjacent > 0 || enemy.buddy.two > 0)) || (enemy.hasExactly("Thunderbrand") && enemy.rValue == 5 && (!this.initiator || enemy.buddy.adjacent > 0 || enemy.buddy.two > 0))){
			nStats[0] = true;
			nStats[1] = true;
		}
		else if(enemy.hasExactly("Maltet") && this.initiator && enemy.combatStartHp / enemy.maxHp >= 0.25 && enemy.rValue > 0){
			nStats = [true,true,true,true];
		}
		else if(enemy.hasExactly("Indignant Bow") && (this.initiator || this.combatStartHp / this.maxHp == 1)){
			nStats[0] = true;
			if(enemy.rValue > 0 && (this.initiator || this.combatStartHp / this.maxHp >= 0.75)){
				nStats[1] = true;
				nStats[3] = true;
			}
		}
		else if(enemy.hasExactly("Forseti") && this.combatStartHp / this.maxHp >= 0.75 && enemy.rValue == 5){
			nStats[0] = true;
			nStats[1] = true;
		}
		else if((enemy.has("Springy Bow") || enemy.has("Springy Lance") || enemy.has("Springy Axe") || enemy.has("Up-Front Blade") || enemy.has("Up-Front Lance") || enemy.has("Up-Front Axe")) && this.combatStartHp / this.maxHp >= 0.75){
			nStats[0] = true;
			nStats[1] = true;
		}
		else if((((enemy.hasExactly("Leiptr") || enemy.hasExactly("Apotheosis Spear")) && enemy.rValue == 5) || (enemy.hasExactly("Snow's Grace") && enemy.rValue > 0) || enemy.hasExactly("Rampart Bow") || enemy.hasExactly("Arcane Darkbow") || enemy.hasExactly("Aptitude Arrows") || enemy.hasExactly("Emblem Ragnell") || enemy.hasExactly("Exalt's Tactics")) && enemy.combatStartHp / enemy.maxHp >= 0.25){
			nStats = [true,true,true,true];
		}
		else if(enemy.hasExactly("Holy Yewfelle") && (this.combatStartHp / this.maxHp >= 0.75 || enemy.initiator)){
			nStats[0] = true;
			nStats[1] = true;
		}
		else if((enemy.hasExactly("Tome of Grado") && (this.combatStartHp / this.maxHp == 1 || this.initiator)) || (enemy.hasExactly("Pupil's Tome") && (!this.initiator || this.range == "ranged")) || (enemy.hasExactly("New Dawn") && enemy.rValue == 5 && enemy.combatStartHp / enemy.maxHp >= 0.25) || (enemy.hasExactly("Prior's Tome") && enemy.buddy.adjacent + enemy.buddy.two + enemy.buddy.three > 0)){
			nStats[0] = true;
			nStats[3] = true;
		}
		else if(enemy.hasExactly("Savage Breath") && enemy.rValue > 0 && enemy.toggle.weapon > -1 && enemy.toggle.weapon < 2){
			nStats = [true,true,true,true];
		}
		else if(enemy.hasExactly("Arcane Eclipse") && enemy.combatStartHp / enemy.maxHp >= 0.25){
			nStats[0] = true;
		}
		else if(enemy.hasExactly("Asura Blades")){
			nStats = [true,true,true,true];
		}
		else if(enemy.hasExactly("Ethereal Breath") && enemy.rValue == 5 && (this.combatStartHp / this.maxHp >= 0.75 || this.initiator)){
			nStats[2] = true;
			nStats[3] = true;
		}
		else if((enemy.hasExactly("Mirage Feather") || enemy.hasExactly("Mirage Longbow") || enemy.hasExactly("Professorial Text") || enemy.hasExactly("Ebon Bolverk") || enemy.hasExactly("Dark Monograph")) && enemy.rValue == 5 && enemy.combatStartHp / enemy.maxHp >= 0.25){
			nStats[0] = true;
			nStats[1] = true;
			if(enemy.hasExactly("Dark Monograph")){
				nStats[3] = true;
			}
		}
		else if((enemy.hasExactly("Earthly Gae Bolg") || enemy.hasExactly("Wyvern Lance")) && enemy.rValue == 5 && (this.combatStartHp / this.maxHp >= 0.75 || this.initiator)){
			nStats[0] = true;
			nStats[2] = true;
		}
		else if((enemy.hasExactly("Mercenary Lance") || enemy.hasExactly("Ice-Crystal Spear") || ((enemy.hasExactly("Staff of the Saint") || enemy.hasExactly("Taciturn Axe")) && enemy.rValue == 5)) && (this.initiator || this.combatStartHp / this.maxHp >= 0.75)){
			nStats = [true,true,true,true];
		}
		else if(enemy.hasExactly("Resolved Fang") && enemy.rValue > 0 && (this.combatStartHp / this.maxHp >= 0.75 || this.initiator)){
			nStats[0] = true;
			nStats[2] = true;
		}
		else if(enemy.hasExactly("Craver's Tome") && enemy.rValue == 5 && enemy.combatStartHp / enemy.maxHp >= 0.25){
			nStats[3] = true;
		}
		else if(enemy.hasExactly("Odr of Creation") && (!this.initiator || enemy.buddy.adjacent > 0 || enemy.buddy.two > 0)){
			nStats = [true,true,true,true];
		}
		
		if(enemy.hasExactly("Atk Spd Bond 4") && enemy.toggle.a == 1){
			nStats[0] = true;
			nStats[1] = true;
		}
		else if(enemy.hasExactly("Atk Def Bond 4") && enemy.toggle.a == 1){
			nStats[0] = true;
			nStats[2] = true;
		}
		else if(enemy.hasExactly("Atk Res Bond 4") && enemy.toggle.a == 1){
			nStats[0] = true;
			nStats[3] = true;
		}
		else if(enemy.hasExactly("Spd Def Bond 4") && enemy.toggle.a == 1){
			nStats[1] = true;
			nStats[2] = true;
		}
		else if(enemy.hasExactly("Spd Res Bond 4") && enemy.toggle.a == 1){
			nStats[1] = true;
			nStats[3] = true;
		}
		else if(enemy.hasExactly("Def Res Bond 4") && enemy.toggle.a == 1){
			nStats[2] = true;
			nStats[3] = true;
		}
		else if(enemy.hasExactly("Atk Spd Clash 4") && enemy.buddy.spaces > 1){
			nStats[0] = true;
			nStats[1] = true;
		}
		else if(enemy.hasExactly("Atk Def Clash 4") && enemy.buddy.spaces > 1){
			nStats[0] = true;
			nStats[2] = true;
		}
		else if(enemy.hasExactly("Spd Def Clash 4") && enemy.buddy.spaces > 1){
			nStats[1] = true;
			nStats[2] = true;
		}
		else if(enemy.hasExactly("Knightly Devotion") && (!this.initiator || enemy.toggle.a == 1)){
			nStats = [true,true,true,true];
		}
		else if(enemy.hasExactly("Gift of Guidance") && enemy.combatStartHp / enemy.maxHp >= 0.25){
			nStats = [true,true,true,true];
		}
		if(enemy.hasExactly("Slick Fighter 4") && (this.initiator || enemy.combatStartHp / enemy.maxHp >= 0.25)){
			nStats = [true,true,true,true];
		}
		else if(enemy.has("Slick Fighter") && this.initiator){
			if(enemy.combatStartHp / enemy.maxHp >= 1 - 0.25 * enemy.has("Slick Fighter")){
				nStats = [true,true,true,true];
			}
		}
		else if(enemy.has("Flow Force") && !this.initiator){
			if((enemy.hasExactly("Flow Force 1") && enemy.combatStartHp / enemy.maxHp >= 1) || (enemy.hasExactly("Flow Force 2") && enemy.combatStartHp / enemy.maxHp >= 0.5) || enemy.hasExactly("Flow Force 3")){
				nStats[0] = true;
				nStats[1] = true;
			}
		}
		else if(enemy.hasExactly("Light and Dark 2")){
			nStats = [true,true,true,true];
		}
		else if(enemy.hasExactly("Speedtaker 4")){
			nStats[1] = true;
		}
		else if(enemy.hasExactly("Assault Force") && (!this.initiator || enemy.buddy.adjacent > 0 || enemy.buddy.two > 0)){
			nStats = [true,true,true,true];
		}
		if(enemy.hasExactly("Barricade") && enemy.buddy.adjacent + enemy.buddy.two + enemy.buddy.three > 0){
			nStats[2] = true;
			nStats[3] = true;
		}
		else if((enemy.hasExactly("Lookout Force") || enemy.hasExactly("Quiet Strength")) && (!this.initiator || enemy.buddy.adjacent > 0 || enemy.buddy.two > 0)){
			nStats[0] = true;
			nStats[1] = true;
		}
		if(enemy.hasCaptain("Effulgence") && (enemy.toggle.sd == 0 || fCheck == false)){
			nStats = [true,true,true,true];
		}
		if(enemy.support.nullPenalty == true || enemy.bonus.nPenalty == true){
			nStats = [true,true,true,true];
		}
		if(enemy.support.nullPenAtk == true){
			nStats[0] = true;
		}
		if(enemy.support.nullPenSpd == true){
			nStats[1] = true;
		}
		if(enemy.support.nullPenDef == true){
			nStats[2] = true;
		}
		if(enemy.support.nullPenRes == true){
			nStats[3] = true;
		}
		
		return nStats;
	}
	
	this.combineBonPen = function(enemy,turn,tStat,eStat){
		//Function to return value of either buff/debuff of all stats combined from this and enemy
		//Will check for negations for both buff and debuff
		//This should only be called after combat(De)Buffs are done
		var bSum = 0;
		var allStats = getEffStats(this, enemy, turn);
		if(tStat == "buff"){
			if(allStats[14][0] == false){
				bSum += Math.max(this.buffs.atk,this.combatBuffs.atk);
			}
			if(allStats[14][1] == false){
				bSum += Math.max(this.buffs.spd,this.combatBuffs.spd);
			}
			if(allStats[14][2] == false){
				bSum += Math.max(this.buffs.def,this.combatBuffs.def);
			}
			if(allStats[14][3] == false){
				bSum += Math.max(this.buffs.res,this.combatBuffs.res);
			}
		}
		else if(tStat == "debuff"){
			var dNeg = enemy.checkNegate(this,turn);
			if(dNeg[0] == false){
				bSum -= Math.min(this.combatDebuffs.atk,this.debuffs.atk);
			}
			if(dNeg[1] == false){
				bSum -= Math.min(this.combatDebuffs.spd,this.debuffs.spd);
			}
			if(dNeg[2] == false){
				bSum -= Math.min(this.combatDebuffs.def,this.debuffs.def);
			}
			if(dNeg[3] == false){
				bSum -= Math.min(this.combatDebuffs.res,this.debuffs.res);
			}
		}
		if(eStat == "debuff"){
			var dNeg = this.checkNegate(enemy,turn);
			if(dNeg[0] == false){
				bSum -= Math.min(enemy.combatDebuffs.atk,enemy.debuffs.atk);
			}
			if(dNeg[1] == false){
				bSum -= Math.min(enemy.combatDebuffs.spd,enemy.debuffs.spd);
			}
			if(dNeg[2] == false){
				bSum -= Math.min(enemy.combatDebuffs.def,enemy.debuffs.def);
			}
			if(dNeg[3] == false){
				bSum -= Math.min(enemy.combatDebuffs.res,enemy.debuffs.res);
			}
		}
		else if(eStat == "buff"){
			if(allStats[15][0] == false){
				bSum += Math.max(enemy.buffs.atk,enemy.combatBuffs.atk);
			}
			if(allStats[15][1] == false){
				bSum += Math.max(enemy.buffs.spd,enemy.combatBuffs.spd);
			}
			if(allStats[15][2] == false){
				bSum += Math.max(enemy.buffs.def,enemy.combatBuffs.def);
			}
			if(allStats[15][3] == false){
				bSum += Math.max(enemy.buffs.res,enemy.combatBuffs.res);
			}
		}
		return bSum;
	}

	this.checkBonPen = function(type,enemy,turn){
		//Function that returns value to determine if [Bonus],bonus,[Penalty],penalty are active on unit
		//type determines what to check (0 = [Bonus], 1 = [Bonus]+bonus, 2 = [Penalty], 3 = [Penalty]+penalty
		var cbpChecker = false;
		if(type == 0 && Object.values(this.bonus).reduce((a, item) => a + (item === true ? 1 : 0), 0) + this.bonus.extra > 0){
			cbpChecker = true;
		}
		if(type == 1 && (Object.values(this.bonus).reduce((a, item) => a + (item === true ? 1 : 0), 0) + this.bonus.extra > 0 || checkAllBuffs(this, enemy, turn))){
			cbpChecker = true;
		}
		if(type == 2 && Object.values(this.penalty).reduce((a, item) => a + (item === true ? 1 : 0), 0) + this.penalty.extra > 0){
			cbpChecker = true;
		}
		if(type == 3 && (Object.values(this.penalty).reduce((a, item) => a + (item === true ? 1 : 0), 0) + this.penalty.extra > 0 || Object.values(this.debuffs).reduce((a, item) => a + (item != 0 ? 1 : 0), 0) + Object.values(this.combatDebuffs).reduce((a, item) => a + (item != 0 ? 1 : 0), 0) > 0)){
			cbpChecker = true;
		}
		return cbpChecker;
	}
	
	this.initSkillCharge = function(){
		var sCharge = 0;
		if(this.weaponIndex != -1){
			if(data.killerWeapon.indexOf(data.skills[this.weaponIndex].name) != -1 || ((this.hasExactly("Excalibur") || this.hasExactly("Ayra's Blade") || this.hasExactly("Phantasm Tome")) && this.rValue > 0) || ((this.hasExactly("Light Brand") || this.hasExactly("Alondite") || this.hasExactly("Ragnell") || this.hasExactly("Dark Spikes T") || this.hasExactly("Deep-Blue Bow") || this.hasExactly("Ifingr") || this.hasExactly("Sokkvabekkr") || this.hasExactly("Nightmare Horn") || this.hasExactly("Mirage Longbow") || this.hasExactly("Aurora Breath") || this.hasExactly("Starpoint Lance") || this.hasExactly("Moonless Breath") || this.hasExactly("Indignant Bow") || this.hasExactly("New Dawn") || this.hasExactly("Wing-Lifted Spear")) && this.rValue == 5)){
				//check for 1 CD healer specials
				if(this.specialIndex != -1 && data.skills[this.specialIndex].charge > 1){
					sCharge += 1;
				}
			}
			else if(data.murderWeapon.indexOf(data.skills[this.weaponIndex].name) != -1){
				if(this.specialIndex != -1 && data.skills[this.specialIndex].charge > 2){
					sCharge += 2;
				}
				else if(this.specialIndex != -1 && data.skills[this.specialIndex].charge == 2){
					sCharge += 1;
				}
			}
			//Lunar Brace can potentially stack with a weapon.  Keep an eye on this in the future and make separate instance if needed (or if another -1 on not a weapons lot shows up)
			if(this.has("Raudrblade") || this.has("Lightning Breath") || this.has("Blarblade") || this.has("Gronnblade") || this.hasExactly("Lunar Brace") || this.hasExactly("Purifying Breath")){
				sCharge = -1;
			}
			if(this.emblem == "Marth" && this.specialIndex != -1 && data.skills[this.specialIndex].charge - sCharge > 1){
				sCharge += 1;
			}
		}
		return sCharge;
	};

	this.resetCharge = function(){
		//resets charge based on weapon
		this.charge = 0;
		this.charge += this.initSkillCharge();
	};
	
	//set initial charge
	this.resetCharge();
	this.charge += this.precharge;

	this.chill = function(enemy, turn){
		var chillText = "";
		var chillDebuffs = {"atk":0,"spd":0,"def":0,"res":0};
		var skillNames = [];
		var allStats = getEffStats(this, enemy, turn);
		var enDef = allStats[22];
		var enRes = allStats[23];
		var pCheck = false;
		if(options.threatenRule=="Summ. Duels"){
			enRes = enemy.res;
		}
		//weapons
		if(this.hasExactly("Wind's Brand") && (this.rValue == 5 && this.toggle.weapon > 9 && this.toggle.weapon < 15)){
			chillDebuffs.atk = Math.min(chillDebuffs.atk, -7);
			skillNames.push(data.skills[this.weaponIndex].name);
		}
		else if(this.hasExactly("Forblaze") && this.toggle.weapon == 1){
			chillDebuffs.res = Math.min(chillDebuffs.res, -7);
			skillNames.push(data.skills[this.weaponIndex].name);
		}
		else if(this.hasExactly("Huginn's Egg") && this.rValue < 0 && this.toggle.weapon == 1 && this.hp/this.maxHp >= .5){
			chillDebuffs.atk = Math.min(chillDebuffs.atk, -5);
			chillDebuffs.def = Math.min(chillDebuffs.def, -5);
			skillNames.push(data.skills[this.weaponIndex].name);
		}
		else if(this.hasExactly("Huginn's Egg") && this.rValue > 0){
			var mTog = this.toggle.weapon;
			if(mTog > 9){
				mTog = mTog - 10;
			}
			if(mTog == 1 || mTog == 3){
				chillDebuffs.atk = Math.min(chillDebuffs.atk, -7);
			}
			if(mTog > 1){
				chillDebuffs.spd = Math.min(chillDebuffs.spd, -7);
			}
			skillNames.push(data.skills[this.weaponIndex].name);
		}
		else if(this.hasExactly("Muninn's Egg") && this.rValue < 0 && this.toggle.weapon == 1 && this.hp/this.maxHp >= .5){
			chillDebuffs.atk = Math.min(chillDebuffs.atk, -5);
			chillDebuffs.res = Math.min(chillDebuffs.res, -5);
			skillNames.push(data.skills[this.weaponIndex].name);
		}
		else if(this.hasExactly("Muninn's Egg") && this.rValue > 0){
			var mTog = this.toggle.weapon;
			if(mTog > 9){
				mTog = mTog - 10;
			}
			if(mTog == 1 || mTog == 3){
				chillDebuffs.atk = Math.min(chillDebuffs.atk, -7);
			}
			if(mTog > 1){
				chillDebuffs.res = Math.min(chillDebuffs.res, -7);
			}
			skillNames.push(data.skills[this.weaponIndex].name);
		}
		else if(this.hasExactly("Hikami") && this.toggle.weapon == 1 && this.rValue < 0){
			chillDebuffs.atk = Math.min(chillDebuffs.atk, -4);
			chillDebuffs.spd = Math.min(chillDebuffs.spd, -4);
			chillDebuffs.def = Math.min(chillDebuffs.def, -4);
			chillDebuffs.res = Math.min(chillDebuffs.res, -4);
			skillNames.push(data.skills[this.weaponIndex].name);
		}
		else if(this.hasExactly("Hikami") && (this.toggle.weapon == 1 || this.toggle.weapon == 3) && this.rValue > 0){
			chillDebuffs.atk = Math.min(chillDebuffs.atk, -6);
			chillDebuffs.spd = Math.min(chillDebuffs.spd, -6);
			chillDebuffs.def = Math.min(chillDebuffs.def, -6);
			chillDebuffs.res = Math.min(chillDebuffs.res, -6);
			skillNames.push(data.skills[this.weaponIndex].name);
		}
		else if(this.has("Kabura Ya") && this.toggle.weapon == 1){
			chillDebuffs.spd = Math.min(chillDebuffs.spd, -7);
			skillNames.push(data.skills[this.weaponIndex].name);
		}
		else if(this.has("Geishun") && this.toggle.weapon == 1){
			chillDebuffs.atk = Math.min(chillDebuffs.atk, -7);
			skillNames.push(data.skills[this.weaponIndex].name);
		}
		else if((this.has("Wagasa") || (this.hasExactly("Argent Bow") && this.rValue == 5)) && this.toggle.weapon == 1){
			chillDebuffs.def = Math.min(chillDebuffs.def, -7);
			skillNames.push(data.skills[this.weaponIndex].name);
		}
		else if(this.has("Kumade") && this.toggle.weapon == 1){
			var cVal = -3;
			if(this.hasExactly("Kumade+")){
				cVal = -5;
			}
			chillDebuffs.atk = Math.min(chillDebuffs.atk, cVal);
			chillDebuffs.spd = Math.min(chillDebuffs.spd, cVal);
			skillNames.push(data.skills[this.weaponIndex].name);
		}
		else if(this.hasExactly("Frost Breath") && this.toggle.weapon == 1){
			chillDebuffs.atk = Math.min(chillDebuffs.atk, -4);
			chillDebuffs.spd = Math.min(chillDebuffs.spd, -4);
			chillDebuffs.def = Math.min(chillDebuffs.def, -4);
			chillDebuffs.res = Math.min(chillDebuffs.res, -4);
			skillNames.push(data.skills[this.weaponIndex].name);
		}
		else if(this.hasExactly("Grima's Truth") && this.rValue > 0 && this.toggle.weapon == 1){
			chillDebuffs.atk = Math.min(chillDebuffs.atk, -5);
			chillDebuffs.spd = Math.min(chillDebuffs.spd, -5);
			chillDebuffs.res = Math.min(chillDebuffs.res, -5);
			skillNames.push(data.skills[this.weaponIndex].name);
		}
		else if(this.hasExactly("Sanngridr") && this.rValue == 5 && this.toggle.weapon == 1){
			chillDebuffs.def = Math.min(chillDebuffs.def, -7);
			chillDebuffs.res = Math.min(chillDebuffs.res, -7);
			skillNames.push(data.skills[this.weaponIndex].name);
		}
		else if(this.hasExactly("Fensalir") && this.rValue < 0 && this.toggle.weapon == 1){
			chillDebuffs.atk = Math.min(chillDebuffs.atk,-4);
			skillNames.push(data.skills[this.weaponIndex].name);
		}
		else if(this.hasExactly("Eckesachs") && this.toggle.weapon == 1){
			if(this.rValue > 0 && enemy.weaponType != "dragon"){
				chillDebuffs.def = Math.min(chillDebuffs.def,-6);
				skillNames.push(data.skills[this.weaponIndex].name);
			}
			else if(this.rValue < 0){
				chillDebuffs.def = Math.min(chillDebuffs.def,-4);
				skillNames.push(data.skills[this.weaponIndex].name);
			}
		}
		else if((this.hasExactly("Gloom Breath") || this.hasExactly("Elena's Staff")) && this.toggle.weapon == 1){
			chillDebuffs.atk = Math.min(chillDebuffs.atk,-7);
			chillDebuffs.spd = Math.min(chillDebuffs.spd,-7);
			skillNames.push(data.skills[this.weaponIndex].name);
		}
		else if((this.hasExactly("Valflame") || this.hasExactly("Wargod's Tome")) && this.toggle.weapon == 1){
			if(this.res + this.getPhantom("Res") > enRes + enemy.getPhantom("Res") && this.rValue < 0){
				chillDebuffs.atk = Math.min(chillDebuffs.atk,-4);
				chillDebuffs.res = Math.min(chillDebuffs.res,-4);
				skillNames.push(data.skills[this.weaponIndex].name);
			}
			else if(this.rValue > 0){
				chillDebuffs.atk = Math.min(chillDebuffs.atk,-5);
				chillDebuffs.res = Math.min(chillDebuffs.res,-5);
				skillNames.push(data.skills[this.weaponIndex].name);
			}
		}
		else if(this.hasExactly("Reese's Tome") && this.rValue == 5 && this.toggle.weapon > 9 && this.res + this.getPhantom("Res") > enRes + enemy.getPhantom("Res") && this.rValue < 0){
			chillDebuffs.spd = Math.min(chillDebuffs.spd,-4);
			chillDebuffs.res = Math.min(chillDebuffs.res,-4);
			skillNames.push(data.skills[this.weaponIndex].name);
		}
		else if(this.hasExactly("Weirding Tome")){
			if(this.res + this.getPhantom("Res") > enRes + enemy.getPhantom("Res") && this.rValue < 0 && this.toggle.weapon == 1){
				chillDebuffs.spd = Math.min(chillDebuffs.spd,-5);
				skillNames.push(data.skills[this.weaponIndex].name);
			}
			else if(this.res + this.getPhantom("Res") >= enRes + enemy.getPhantom("Res") + 3 && this.rValue > 0 && (this.toggle.weapon == 1 || this.toggle.weapon == 3)){
				chillDebuffs.spd = Math.min(chillDebuffs.spd,-5);
				chillDebuffs.res = Math.min(chillDebuffs.res,-5);
				skillNames.push(data.skills[this.weaponIndex].name);
			}
		}
		else if(this.res + this.getPhantom("Res") >= enRes + enemy.getPhantom("Res") + 3 && (this.has("Fortune Bow") || this.hasExactly("Temari") || this.hasExactly("Temari+") || this.hasExactly("Veteran Lance")) && this.toggle.weapon == 1){
			if(this.has("Fortune Bow")){
				chillDebuffs.def = Math.min(chillDebuffs.def, -5);
				chillDebuffs.res = Math.min(chillDebuffs.res, -5);
				skillNames.push(data.skills[this.weaponIndex].name);
			}
			else if(this.has("Temari")){
				chillDebuffs.atk = Math.min(chillDebuffs.atk,-5);
				chillDebuffs.spd = Math.min(chillDebuffs.spd,-5);
				skillNames.push(data.skills[this.weaponIndex].name);
			}
			else if(this.hasExactly("Veteran Lance") && this.rValue == 5){
				chillDebuffs.atk = Math.min(chillDebuffs.atk,-7);
				skillNames.push(data.skills[this.weaponIndex].name);
			}
		}
		else if(this.hasExactly("Inveterate Axe") && this.hp / this.maxHp >= 0.5 && (this.toggle.weapon == 1 || this.toggle.weapon == 3)){
			chillDebuffs.atk = Math.min(chillDebuffs.atk, -5);
			chillDebuffs.def = Math.min(chillDebuffs.def, -5);
			skillNames.push(data.skills[this.weaponIndex].name);
		}
		else if(this.hasExactly("Ebon-Pirate Claw") && this.toggle.weapon == 1 && this.res + this.getPhantom("Res") > enRes + enemy.getPhantom("Res")){
			chillDebuffs.def = Math.min(chillDebuffs.def, -7);
			chillDebuffs.res = Math.min(chillDebuffs.res, -7);
			skillNames.push(data.skills[this.weaponIndex].name);
		}
		else if(this.hasExactly("Loptous") && this.rValue == 5 && this.toggle.weapon == 1 && this.res + this.getPhantom("Res") > enRes + enemy.getPhantom("Res")){
			chillDebuffs.atk = Math.min(chillDebuffs.atk, -5);
			chillDebuffs.res = Math.min(chillDebuffs.res, -5);
			skillNames.push(data.skills[this.weaponIndex].name);
		}
		else if(this.hasExactly("Argent Aura") && this.toggle.weapon == 1){
			chillDebuffs.atk = Math.min(chillDebuffs.atk, -5);
			chillDebuffs.spd = Math.min(chillDebuffs.spd, -5);
			chillDebuffs.def = Math.min(chillDebuffs.def, -5);
			chillDebuffs.res = Math.min(chillDebuffs.res, -5);
			skillNames.push(data.skills[this.weaponIndex].name);
		}
		else if(this.hasExactly("Fiery Bolganone") && (this.toggle.weapon == 1 || this.toggle.weapon == 3)){
			chillDebuffs.atk = Math.min(chillDebuffs.atk, -6);
			chillDebuffs.res = Math.min(chillDebuffs.res, -6);
			skillNames.push(data.skills[this.weaponIndex].name);
		}
		else if(this.hasExactly("Elena's Staff") && this.rValue == 5 && this.toggle.weapon == 1){
			enemy.penalty.panic = true;
			pCheck = true;
			chillText += this.name + " activates Elena's Staff, inflicting panic on " + enemy.name + ".<br>";
		}
		else if(this.hasExactly("Aversa's Night") && (this.toggle.weapon == 1 || this.toggle.weapon == 3) && this.hp >= enemy.hp + 3){
			enemy.penalty.panic = true;
			pCheck = true;
			var aVal = -3;
			if(this.rValue > 0){
				aVal = -4;
			}
			chillDebuffs.atk = Math.min(chillDebuffs.atk, aVal);
			chillDebuffs.spd = Math.min(chillDebuffs.spd, aVal);
			chillDebuffs.def = Math.min(chillDebuffs.def, aVal);
			chillDebuffs.res = Math.min(chillDebuffs.res, aVal);
			skillNames.push(data.skills[this.weaponIndex].name);
		}
		else if(this.hasExactly("Iago's Tome")){
			if(this.hp >= enemy.hp + 3 || (this.rValue > 0 && this.hp > enemy.hp)){
				var remainder = turn % 2;
				var itVal = -4;
				if(this.rValue > 0){
					itVal = -6;
				}
				//Odd turns
				if(remainder == 1 && enemy.buddy.adjacent == 0){
					enemy.penalty.cdguard = true;
					chillDebuffs.atk = Math.min(chillDebuffs.atk, itVal);
					chillDebuffs.spd = Math.min(chillDebuffs.spd, itVal);
					skillNames.push(data.skills[this.weaponIndex].name);
				}
				//Even turns
				else if(remainder == 0 && enemy.buddy.adjacent > 0){
					enemy.penalty.panic = true;
					pCheck = true;
					chillDebuffs.def = Math.min(chillDebuffs.def, itVal);
					chillDebuffs.res = Math.min(chillDebuffs.res, itVal);
					skillNames.push(data.skills[this.weaponIndex].name);
				}
			}
		}
		else if(this.hasExactly("Banshee TH") && (this.toggle.weapon == 1 || this.toggle.weapon == 3) && (turn == 3 || turn == 4)){
			enemy.penalty.cdguard = true;
			enemy.penalty.lit = true;
			var btVal = -6;
			if(this.rValue > 0){
				btVal = -7;
			}
			chillDebuffs.atk = Math.min(chillDebuffs.atk, btVal);
			chillDebuffs.spd = Math.min(chillDebuffs.spd, btVal);
			chillDebuffs.def = Math.min(chillDebuffs.def, btVal);
			chillDebuffs.res = Math.min(chillDebuffs.res, btVal);
			skillNames.push(data.skills[this.weaponIndex].name);
		}
		else if(this.hasExactly("Dignified Bow") && this.toggle.weapon == 1 && this.hp > enemy.hp){
			enemy.penalty.panic = true;
			pCheck = true;
			skillNames.push(data.skills[this.weaponIndex].name);
		}
		else if(this.hasExactly("Staff of Rausten") && this.toggle.weapon == 1){
			enemy.penalty.lit = true;
			chillDebuffs.res = Math.min(chillDebuffs.res, -6);
			skillNames.push(data.skills[this.weaponIndex].name);
		}
		else if(this.hasExactly("Wolf Berg") && this.rValue == 5 && (this.toggle.weapon == 1 || this.toggle.weapon == 3)){
			enemy.penalty.lit = true;
			chillDebuffs.atk = Math.min(chillDebuffs.atk, -7);
			chillDebuffs.def = Math.min(chillDebuffs.def, -7);
			skillNames.push(data.skills[this.weaponIndex].name);
		}
		else if(this.hasExactly("Thokk") && this.rValue > 0){
			if((this.toggle.weapon == 1 || this.toggle.weapon == 3) && this.hp > enemy.hp){
				if(enemy.range == "melee"){
					chillDebuffs.atk = Math.min(chillDebuffs.atk, -7);
				}
				else if(enemy.range == "ranged"){
					chillDebuffs.res = Math.min(chillDebuffs.res, -7);
				}
				skillNames.push(data.skills[this.weaponIndex].name);
			}
			if(this.rValue == 5 && this.toggle.weapon > 1){
				enemy.penalty.cdguard = true;
				skillNames.push(data.skills[this.weaponIndex].name);
			}
		}
		else if(this.hasExactly("Book of Dreams") && this.rValue > 0 && this.toggle.weapon > 1){
			chillDebuffs.atk = Math.min(chillDebuffs.atk, -5);
			chillDebuffs.spd = Math.min(chillDebuffs.spd, -5);
			chillDebuffs.res = Math.min(chillDebuffs.res, -5);
			skillNames.push(data.skills[this.weaponIndex].name);
		}
		else if(this.hasExactly("Bright-Shell Egg") && this.toggle.weapon > 1){
			chillDebuffs.spd = Math.min(chillDebuffs.spd, -6);
			chillDebuffs.res = Math.min(chillDebuffs.res, -6);
			skillNames.push(data.skills[this.weaponIndex].name);
		}
		else if(this.hasExactly("Wild Tiger Fang") && this.toggle.weapon == 1){
			chillDebuffs.atk = Math.min(chillDebuffs.atk, -6);
			chillDebuffs.spd = Math.min(chillDebuffs.spd, -6);
			chillDebuffs.def = Math.min(chillDebuffs.def, -6);
			chillDebuffs.res = Math.min(chillDebuffs.res, -6);
			skillNames.push(data.skills[this.weaponIndex].name);
		}
		else if(this.hasExactly("Breaker Lance") && this.toggle.weapon == 1){
			chillDebuffs.atk = Math.min(chillDebuffs.atk, -6);
			chillDebuffs.def = Math.min(chillDebuffs.def, -6);
			enemy.penalty.panic = true;
			pCheck = true;
			skillNames.push(data.skills[this.weaponIndex].name);
		}
		else if(this.hasExactly("Rite of Souls") && (this.toggle.weapon == 1 || this.toggle.weapon == 3)){
			enemy.penalty.cdguard = true;
			skillNames.push(data.skills[this.weaponIndex].name);
		}
		else if(this.hasExactly("Cunning Bow") && this.rValue == 5 && this.toggle.weapon > 1){
			chillDebuffs.def = Math.min(chillDebuffs.def, -7);
			skillNames.push(data.skills[this.weaponIndex].name);
		}
		else if(this.hasExactly("Master's Tactics") && this.hp/this.maxHp >= 0.25){
			chillDebuffs.atk = Math.min(chillDebuffs.atk, -3);
			chillDebuffs.spd = Math.min(chillDebuffs.spd, -3);
			chillDebuffs.def = Math.min(chillDebuffs.def, -3);
			chillDebuffs.res = Math.min(chillDebuffs.res, -3);
			skillNames.push(data.skills[this.weaponIndex].name);
		}
		else if(this.hasExactly("Total War Tome")){
			chillDebuffs.atk = Math.min(chillDebuffs.atk, -5);
			chillDebuffs.spd = Math.min(chillDebuffs.spd, -5);
			chillDebuffs.def = Math.min(chillDebuffs.def, -5);
			chillDebuffs.res = Math.min(chillDebuffs.res, -5);
			enemy.penalty.sabotage = true;
			skillNames.push(data.skills[this.weaponIndex].name);
		}
		else if(this.hasExactly("Asclepius") && this.toggle.weapon == 1){
			chillDebuffs.atk = Math.min(chillDebuffs.atk, -6);
			chillDebuffs.res = Math.min(chillDebuffs.res, -6);
			enemy.penalty.lit = true;
			skillNames.push(data.skills[this.weaponIndex].name);
		}
		else if(this.has("Seaside Parasol") && this.toggle.weapon > 9){
			enemy.penalty.cdguard = true;
			skillNames.push(data.skills[this.weaponIndex].name);
		}
		else if(this.hasExactly("Partnership Bow") && this.toggle.weapon > 9){
			enemy.penalty.panic = true;
			pCheck = true;
			enemy.penalty.discord = true;
			skillNames.push(data.skills[this.weaponIndex].name);
		}
		else if(this.hasExactly("Packleader Tome") && this.hp/this.maxHp >= 0.25 && this.toggle.weapon == 1){
			chillDebuffs.spd = Math.min(chillDebuffs.spd, -6);
			chillDebuffs.res = Math.min(chillDebuffs.res, -6);
			enemy.penalty.panic = true;
			pCheck = true;
			skillNames.push(data.skills[this.weaponIndex].name);
		}
		else if(this.hasExactly("Eagle's Egg") && this.rValue == 5 && (this.toggle.weapon == 2 || this.toggle.weapon == 4 || this.toggle.weapon == 6 || this.toggle.weapon == 7)){
			chillDebuffs.def = Math.min(chillDebuffs.def, -6);
			chillDebuffs.res = Math.min(chillDebuffs.res, -6);
			enemy.penalty.exposure = true;
			skillNames.push(data.skills[this.weaponIndex].name);
		}
		else if(this.hasExactly("Baked Treats") && this.toggle.weapon == 1){
			chillDebuffs.spd = Math.min(chillDebuffs.spd, -6);
			chillDebuffs.res = Math.min(chillDebuffs.res, -6);
			enemy.penalty.sabotage = true;
			skillNames.push(data.skills[this.weaponIndex].name);
		}
		else if(this.hasExactly("Flame Battleaxe") && this.rValue == 5 && this.toggle.weapon == 1){
			chillDebuffs.atk = Math.min(chillDebuffs.atk, -7);
			enemy.penalty.sabotage = true;
			skillNames.push(data.skills[this.weaponIndex].name);
		}
		else if(this.hasExactly("Arcane Thrima") && this.hp/this.maxHp >= 0.25 && this.toggle.weapon == 1){
			chillDebuffs.atk = Math.min(chillDebuffs.atk, -6);
			chillDebuffs.def = Math.min(chillDebuffs.def, -6);
			skillNames.push(data.skills[this.weaponIndex].name);
		}
		else if(this.hasExactly("Grimleal Text") && this.toggle.weapon == 1 && this.res + this.getPhantom("Res") > enRes + enemy.getPhantom("Res")){
			chillDebuffs.def = Math.min(chillDebuffs.def, -6);
			chillDebuffs.res = Math.min(chillDebuffs.res, -6);
			enemy.penalty.panic = true;
			pCheck = true;
			enemy.penalty.discord = true;
			skillNames.push(data.skills[this.weaponIndex].name);
		}
		else if(this.hasExactly("Mirage Rod") && this.rValue == 5 && this.toggle.weapon == 1){
			chillDebuffs.atk = Math.min(chillDebuffs.atk, -6);
			chillDebuffs.res = Math.min(chillDebuffs.res, -6);
			enemy.penalty.sabotage = true;
			skillNames.push(data.skills[this.weaponIndex].name);
		}
		else if(this.hasExactly("Constant Dagger") && this.rValue == 5){
			chillDebuffs.spd = Math.min(chillDebuffs.spd, -6);
			chillDebuffs.def = Math.min(chillDebuffs.def, -6);
			enemy.penalty.discord = true;
			skillNames.push(data.skills[this.weaponIndex].name);
		}
		else if(this.hasExactly("Levin Dagger") && this.rValue > 0){
			chillDebuffs.spd = Math.min(chillDebuffs.spd, -7);
			chillDebuffs.res = Math.min(chillDebuffs.res, -7);
			enemy.penalty.cdguard = true;
			skillNames.push(data.skills[this.weaponIndex].name);
		}
		else if((this.hasExactly("Sunlight") || this.hasExactly("Sunlight+"))){
			enemy.penalty.cdguard = true;
			skillNames.push(data.skills[this.weaponIndex].name);
		}
		else if(this.hasExactly("Blood Tome") && this.rValue == 5){
			chillDebuffs.atk = Math.min(chillDebuffs.atk, -7);
			chillDebuffs.res = Math.min(chillDebuffs.res, -7);
			enemy.penalty.trilemma = true;
			skillNames.push(data.skills[this.weaponIndex].name);
		}
		else if(this.hasExactly("Dead-Wolf Blade") && this.hp/this.maxHp >= 0.25){
			chillDebuffs.spd = Math.min(chillDebuffs.spd, -7);
			chillDebuffs.def = Math.min(chillDebuffs.def, -7);
			skillNames.push(data.skills[this.weaponIndex].name);
		}
		else if(this.hasExactly("Exotic Fruit Juice") && this.rValue == 5){
			chillDebuffs.spd = Math.min(chillDebuffs.spd, -7);
			chillDebuffs.res = Math.min(chillDebuffs.res, -7);
			enemy.penalty.lit = true;
			skillNames.push(data.skills[this.weaponIndex].name);
		}
		else if(this.hasExactly("Tiger-Eye Axe") && this.hp/this.maxHp >= 0.25){
			chillDebuffs.atk = Math.min(chillDebuffs.atk, -7);
			chillDebuffs.def = Math.min(chillDebuffs.def, -7);
			enemy.penalty.discord = true;
			skillNames.push(data.skills[this.weaponIndex].name);
		}
		else if(this.hasExactly("Failnaught") && this.rValue > 0 && this.hp/this.maxHp >= 0.25){
			chillDebuffs.spd = Math.min(chillDebuffs.spd, -7);
			chillDebuffs.def = Math.min(chillDebuffs.def, -7);
			enemy.penalty.cdguard = true;
			enemy.penalty.sabotage = true;
			skillNames.push(data.skills[this.weaponIndex].name);
		}
		else if(this.hasExactly("Grim Brokkr") && this.rValue == 5 && this.hp/this.maxHp >= 0.25){
			chillDebuffs.atk = Math.min(chillDebuffs.atk, -7);
			chillDebuffs.res = Math.min(chillDebuffs.res, -7);
			enemy.penalty.sabotage = true;
			enemy.penalty.schism = true;
			skillNames.push(data.skills[this.weaponIndex].name);
		}
		else if(this.hasExactly("Gate-Anchor Axe") && this.rValue == 5 && this.hp/this.maxHp >= 0.25){
			chillDebuffs.atk = Math.min(chillDebuffs.atk, -7);
			chillDebuffs.def = Math.min(chillDebuffs.def, -7);
			enemy.penalty.feud = true;
			skillNames.push(data.skills[this.weaponIndex].name);
		}
		else if(this.hasExactly("Quieting Claw") && this.hp/this.maxHp >= 0.25){
			chillDebuffs.spd = Math.min(chillDebuffs.spd, -7);
			chillDebuffs.def = Math.min(chillDebuffs.def, -7);
			enemy.penalty.exposure = true;
			enemy.penalty.nullArise = true;
			skillNames.push(data.skills[this.weaponIndex].name);
		}
		else if(this.hasExactly("Survivalist Bow") && this.rValue == 5 && this.hp/this.maxHp >= 0.25){
			chillDebuffs.spd = Math.min(chillDebuffs.spd, -7);
			chillDebuffs.def = Math.min(chillDebuffs.def, -7);
			enemy.penalty.sabotage = true;
			skillNames.push(data.skills[this.weaponIndex].name);
		}
		else if(this.hasExactly("Sky-Pirate Claw") && this.rValue == 5 && this.hp/this.maxHp >= 0.25){
			chillDebuffs.spd = Math.min(chillDebuffs.spd, -7);
			chillDebuffs.def = Math.min(chillDebuffs.def, -7);
			enemy.penalty.exposure = true;
			enemy.penalty.frozen = true;
			skillNames.push(data.skills[this.weaponIndex].name);
		}
		else if(this.hasExactly("Enticing Dose") && this.toggle.weapon == 1){
			chillDebuffs.atk = Math.min(chillDebuffs.atk, -7);
			chillDebuffs.def = Math.min(chillDebuffs.def, -7);
			enemy.penalty.sabotage = true;
			skillNames.push(data.skills[this.weaponIndex].name);
		}
		else if(this.hasExactly("Quieting Branch") && this.hp/this.maxHp >= 0.25){
			chillDebuffs.def = Math.min(chillDebuffs.def, -7);
			chillDebuffs.res = Math.min(chillDebuffs.res, -7);
			enemy.penalty.panic = true;
			enemy.penalty.sabotage = true;
			skillNames.push(data.skills[this.weaponIndex].name);
		}
		else if(this.hasExactly("Tome of Storms") && this.rValue == 5 && this.hp/this.maxHp >= 0.25){
			chillDebuffs.spd = Math.min(chillDebuffs.spd, -7);
			chillDebuffs.res = Math.min(chillDebuffs.res, -7);
			enemy.penalty.exposure = true;
			skillNames.push(data.skills[this.weaponIndex].name);
		}
		else if(this.hasExactly("Rampart Bow") && this.hp/this.maxHp >= 0.25){
			chillDebuffs.spd = Math.min(chillDebuffs.spd, -7);
			chillDebuffs.def = Math.min(chillDebuffs.def, -7);
			enemy.penalty.exposure = true;
			enemy.penalty.fatal = true;
			skillNames.push(data.skills[this.weaponIndex].name);
		}
		else if(this.hasExactly("Dark Monograph") && this.rValue == 5 && this.hp/this.maxHp >= 0.25){
			chillDebuffs.atk = Math.min(chillDebuffs.atk, -7);
			chillDebuffs.res = Math.min(chillDebuffs.res, -7);
			enemy.penalty.panic = true;
			enemy.penalty.fatal = true;
			skillNames.push(data.skills[this.weaponIndex].name);
		}
		else if(this.hasExactly("Grafcalibur") && this.rValue == 5 && this.hp/this.maxHp >= 0.25){
			chillDebuffs.spd = Math.min(chillDebuffs.spd, -7);
			chillDebuffs.res = Math.min(chillDebuffs.res, -7);
			enemy.penalty.sabotage = true;
			skillNames.push(data.skills[this.weaponIndex].name);
		}
		else if(this.has("Devoted Cup")){
			chillDebuffs.spd = Math.min(chillDebuffs.spd, -7);
			chillDebuffs.res = Math.min(chillDebuffs.res, -7);
			enemy.penalty.discord = true;
			skillNames.push(data.skills[this.weaponIndex].name);
		}
		else if(this.hasExactly("Hidden Blade") && this.hp/this.maxHp >= 0.25){
			chillDebuffs.spd = Math.min(chillDebuffs.spd, -7);
			chillDebuffs.def = Math.min(chillDebuffs.def, -7);
			enemy.penalty.sabotage = true;
			enemy.penalty.discord = true;
			skillNames.push(data.skills[this.weaponIndex].name);
		}
		else if(this.hasExactly("Nova")){
			chillDebuffs.atk = Math.min(chillDebuffs.atk, -7);
			chillDebuffs.res = Math.min(chillDebuffs.res, -7);
			enemy.penalty.sabotage = true;
			skillNames.push(data.skills[this.weaponIndex].name);
		}
		else if(this.hasExactly("Bereft Lance") && this.rValue == 5 && this.hp/this.maxHp >= 0.25){
			chillDebuffs.atk = Math.min(chillDebuffs.atk, -7);
			chillDebuffs.def = Math.min(chillDebuffs.def, -7);
			enemy.penalty.exposure = true;
			skillNames.push(data.skills[this.weaponIndex].name);
		}
		else if(this.hasExactly("Proud Spear") && this.rValue == 5 && this.hp/this.maxHp >= 0.25){
			chillDebuffs.atk = Math.min(chillDebuffs.atk, -7);
			chillDebuffs.def = Math.min(chillDebuffs.def, -7);
			enemy.penalty.discord = true;
			skillNames.push(data.skills[this.weaponIndex].name);
		}
		else if(this.hasExactly("Ancient Trickery") && this.hp/this.maxHp >= 0.25){
			chillDebuffs.spd = Math.min(chillDebuffs.spd, -7);
			chillDebuffs.res = Math.min(chillDebuffs.res, -7);
			enemy.penalty.sabotage = true;
			skillNames.push(data.skills[this.weaponIndex].name);
		}
		
		//b skills
		if(this.hasExactly("Chilling Seal") && this.toggle.b == 1 && this.hp/this.maxHp >= .5){
			chillDebuffs.atk = Math.min(chillDebuffs.atk, -6);
			chillDebuffs.spd = Math.min(chillDebuffs.spd, -6);
			skillNames.push(data.skills[this.bIndex].name);
		}
		else if(this.hasExactly("Freezing Seal") && this.toggle.b == 1 && this.hp/this.maxHp >= .5){
			chillDebuffs.atk = Math.min(chillDebuffs.atk, -6);
			chillDebuffs.spd = Math.min(chillDebuffs.spd, -6);
			skillNames.push(data.skills[this.bIndex].name);
		}
		else if(this.hasExactly("Chilling Seal 2") && this.toggle.b == 1){
			chillDebuffs.atk = Math.min(chillDebuffs.atk, -7);
			chillDebuffs.spd = Math.min(chillDebuffs.spd, -7);
			chillDebuffs.def = Math.min(chillDebuffs.def, -7);
			chillDebuffs.res = Math.min(chillDebuffs.res, -7);
			skillNames.push(data.skills[this.bIndex].name);
		}
		else if(this.hasExactly("Freezing Seal 2") && this.toggle.b == 1){
			chillDebuffs.atk = Math.min(chillDebuffs.atk, -7);
			chillDebuffs.def = Math.min(chillDebuffs.def, -7);
			enemy.penalty.cdguard = true;
			skillNames.push(data.skills[this.bIndex].name);
		}
		else if(this.hasExactly("Sabotage AR 3") && this.res + this.getPhantom("Res") > enRes + enemy.getPhantom("Res") && this.toggle.b == 1){
			chillDebuffs.atk = Math.min(chillDebuffs.atk, -6);
			chillDebuffs.res = Math.min(chillDebuffs.res, -6);
			skillNames.push(data.skills[this.bIndex].name);
		}
		else if(this.hasExactly("Sabotage SR 3") && this.res + this.getPhantom("Res") > enRes + enemy.getPhantom("Res") && this.toggle.b == 1){
			chillDebuffs.spd = Math.min(chillDebuffs.spd, -6);
			chillDebuffs.res = Math.min(chillDebuffs.res, -6);
			skillNames.push(data.skills[this.bIndex].name);
		}
		else if(this.hasExactly("Sabotage AD 3") && this.res + this.getPhantom("Res") > enRes + enemy.getPhantom("Res") && this.toggle.b == 1){
			chillDebuffs.atk = Math.min(chillDebuffs.atk, -6);
			chillDebuffs.def = Math.min(chillDebuffs.def, -6);
			skillNames.push(data.skills[this.bIndex].name);
		}
		else if(this.res + this.getPhantom("Res") >= enRes + enemy.getPhantom("Res") + 3 && (this.has("Sabotage") || this.hasExactly("Yune's Whispers")) && this.toggle.b == 1){
			if(this.has("Sabotage Atk") && this.toggle.b == 1){
				chillDebuffs.atk = Math.min(chillDebuffs.atk, -this.has("Sabotage Atk")*2-1);
				skillNames.push(data.skills[this.bIndex].name);			
			}
			else if(this.has("Sabotage Spd") && this.toggle.b == 1){
				chillDebuffs.spd = Math.min(chillDebuffs.spd, -this.has("Sabotage Spd")*2-1);
				skillNames.push(data.skills[this.bIndex].name);			
			}
			else if(this.has("Sabotage Def") && this.toggle.b == 1){
				chillDebuffs.def = Math.min(chillDebuffs.def, -this.has("Sabotage Def")*2-1);
				skillNames.push(data.skills[this.bIndex].name);			
			}
			else if(this.has("Sabotage Res") && this.toggle.b == 1){
				chillDebuffs.res = Math.min(chillDebuffs.res, -this.has("Sabotage Res")*2-1);
				skillNames.push(data.skills[this.bIndex].name);			
			}
			else if(this.hasExactly("Yune's Whispers") && this.toggle.b == 1){
				chillDebuffs.atk = Math.min(chillDebuffs.atk, -6);
				chillDebuffs.spd = Math.min(chillDebuffs.spd, -6);
				skillNames.push(data.skills[this.bIndex].name);
			}
		}
		else if(this.hasExactly("Killing Intent+") && this.toggle.b == 1){
			enemy.penalty.exposure = true;
			skillNames.push(data.skills[this.bIndex].name);
		}
		else if(this.has("Sudden Panic") && this.toggle.b == 1){
			if(this.hp > enemy.hp + 6 - this.has("Sudden Panic")*2){
				enemy.penalty.panic = true;
				pCheck = true;
				skillNames.push(data.skills[this.bIndex].name);
			}
		}
		else if(this.hasExactly("Ruler of Nihility") && this.toggle.b == 1){
			chillDebuffs.atk = Math.min(chillDebuffs.atk, -7);
			chillDebuffs.def = Math.min(chillDebuffs.def, -7);
			enemy.penalty.discord = true;
			enemy.penalty.lit = true;
			skillNames.push(data.skills[this.bIndex].name);
		}
		else if(this.hasExactly("Spoil Rotten") && this.hp/this.maxHp >= 0.25){
			chillDebuffs.spd = Math.min(chillDebuffs.spd, -7);
			chillDebuffs.res = Math.min(chillDebuffs.res, -7);
			enemy.penalty.sabotage = true;
			skillNames.push(data.skills[this.bIndex].name);
		}
		else if(this.hasExactly("Dazzling Discord") && this.res + this.getPhantom("Res") > enRes + enemy.getPhantom("Res")){
			enemy.penalty.discord = true;
			skillNames.push(data.skills[this.bIndex].name);
		}
		else if(this.hasExactly("Ice Prince's Seal") && this.hp/this.maxHp >= 0.25 && this.toggle.b == 1){
			chillDebuffs.spd = Math.min(chillDebuffs.spd, -7);
			chillDebuffs.def = Math.min(chillDebuffs.def, -7);
			enemy.penalty.frozen = true;
			enemy.penalty.cdguard = true;
			skillNames.push(data.skills[this.bIndex].name);
		}
		else if(this.hasExactly("According to Plan") && this.hp/this.maxHp >= 0.25 && this.toggle.b == 1){
			enemy.penalty.hush = true;
			enemy.penalty.panic = true;
			pCheck = true;
			skillNames.push(data.skills[this.bIndex].name);
		}
		else if(this.hasExactly("Brutal Ferocity") && this.toggle.b == 1 && this.maxHp > enemy.hp){
			chillDebuffs.atk = Math.min(chillDebuffs.atk, -7);
			chillDebuffs.def = Math.min(chillDebuffs.def, -7);
			skillNames.push(data.skills[this.bIndex].name);
		}
		else if(this.hasExactly("Dark Perfume") && this.toggle.b == 1){
			enemy.penalty.lit = true;
			skillNames.push(data.skills[this.bIndex].name);
		}
		else if(this.hasExactly("Pure Storm") && (this.toggle.b == 1 || this.toggle.b == 3)){
			chillDebuffs.atk = Math.min(chillDebuffs.atk, -7);
			chillDebuffs.def = Math.min(chillDebuffs.def, -7);
			enemy.penalty.exposure = true;
			enemy.penalty.sabotage = true;
			skillNames.push(data.skills[this.bIndex].name);
		}
		else if(this.hasExactly("Mounting Fear") && this.res + this.getPhantom("Res") > enRes + enemy.getPhantom("Res") && this.toggle.b == 1){
			enemy.penalty.panic = true;
			pCheck = true;
			enemy.penalty.exposure = true;
			enemy.penalty.fatal = true;
			skillNames.push(data.skills[this.bIndex].name);
		}
		//c skills
		if(this.has("Threat Atk Spd") && this.toggle.c == 1){
			chillDebuffs.atk = Math.min(chillDebuffs.atk,-this.has("Threat Atk Spd")-2);
			chillDebuffs.spd = Math.min(chillDebuffs.spd,-this.has("Threat Atk Spd")-2);
			skillNames.push(data.skills[this.cIndex].name);
		}
		else if(this.hasExactly("Atk Res Menace") && this.toggle.c == 1){
			chillDebuffs.atk = Math.min(chillDebuffs.atk, -6);
			chillDebuffs.res = Math.min(chillDebuffs.res, -6);
			skillNames.push(data.skills[this.cIndex].name);
		}
		else if(this.hasExactly("Atk Def Menace") && this.toggle.c == 1){
			chillDebuffs.atk = Math.min(chillDebuffs.atk, -6);
			chillDebuffs.def = Math.min(chillDebuffs.def, -6);
			skillNames.push(data.skills[this.cIndex].name);
		}
		else if(this.hasExactly("Def Res Menace") && this.toggle.c == 1){
			chillDebuffs.def = Math.min(chillDebuffs.def, -6);
			chillDebuffs.res = Math.min(chillDebuffs.res, -6);
			skillNames.push(data.skills[this.cIndex].name);
		}
		else if(this.hasExactly("Atk Spd Menace") && this.toggle.c == 1){
			chillDebuffs.atk = Math.min(chillDebuffs.atk, -6);
			chillDebuffs.spd = Math.min(chillDebuffs.spd, -6);
			skillNames.push(data.skills[this.cIndex].name);
		}
		else if(this.hasExactly("Spd Res Menace") && this.toggle.c == 1){
			chillDebuffs.spd = Math.min(chillDebuffs.spd, -6);
			chillDebuffs.res = Math.min(chillDebuffs.res, -6);
			skillNames.push(data.skills[this.cIndex].name);
		}
		else if(this.hasExactly("Spd Def Menace") && this.toggle.c == 1){
			chillDebuffs.spd = Math.min(chillDebuffs.spd, -6);
			chillDebuffs.def = Math.min(chillDebuffs.def, -6);
			skillNames.push(data.skills[this.cIndex].name);
		}
		else if(this.hasExactly("Surtr's Menace") && this.toggle.c == 1){
			chillDebuffs.atk = Math.min(threatDebuffs.atk,-4);
			chillDebuffs.spd = Math.min(threatDebuffs.spd,-4);
			chillDebuffs.def = Math.min(threatDebuffs.def,-4);
			chillDebuffs.res = Math.min(threatDebuffs.res,-4);
			skillNames.push(data.skills[this.cIndex].name);
		}
		else if(this.hasExactly("Surtr's Portent") && this.toggle.c == 1){
			chillDebuffs.atk = Math.min(chillDebuffs.atk, -5);
			chillDebuffs.spd = Math.min(chillDebuffs.spd, -5);
			chillDebuffs.def = Math.min(chillDebuffs.def, -5);
			chillDebuffs.res = Math.min(chillDebuffs.res, -5);
			skillNames.push(data.skills[this.cIndex].name);
		}
		else if(this.hasExactly("Chaos Named") && this.res + this.getPhantom("Res") >= enRes + enemy.getPhantom("Res") + 3 && this.toggle.c == 1){
			var enStat = {"atk":0, "spd":0, "def":0, "res":0};
			enStat.atk = enemy.atk + enemy.buffs.atk + enemy.debuffs.atk - 15;
			enStat.spd = enemy.spd + enemy.buffs.spd + enemy.debuffs.spd;
			enStat.def = enemy.def + enemy.buffs.def + enemy.debuffs.def;
			enStat.res = enemy.res + enemy.buffs.res + enemy.debuffs.res;
			var enMax;
			for (var i in enStat) {
				if (!enMax || (enStat[i] > enStat[enMax])) {
					enMax = i;
				}
			}
			chillDebuffs[enMax] = Math.min(chillDebuffs[enMax],-5);
			skillNames.push(data.skills[this.cIndex].name);
		}
		else if(this.hasExactly("Chaos Named+") && this.toggle.c == 1){
			enemy.penalty.panic = true;
			pCheck = true;
			skillNames.push(data.skills[this.cIndex].name);
		}
		else if(this.hasExactly("Mila's Turnwheel 2") && this.toggle.c == 1 && this.def >= enDef){
			enemy.penalty.cdguard = true;
			skillNames.push(data.skills[this.cIndex].name);
		}
		else if((this.hasExactly("Glittering Anima") || this.hasExactly("Twinkling Anima")) && this.hp/this.maxHp >= 0.25){
			chillDebuffs.spd = Math.min(chillDebuffs.spd, -6);
			chillDebuffs.res = Math.min(chillDebuffs.res, -6);
			if(this.hasExactly("Twinkling Anima")){
				chillDebuffs.spd = Math.min(chillDebuffs.spd, -7);
				chillDebuffs.res = Math.min(chillDebuffs.res, -7);
			}
			enemy.penalty.panic = true;
			pCheck = true;
			enemy.penalty.discord = true;
			skillNames.push(data.skills[this.cIndex].name);
		}
		else if(this.hasExactly("Beast Threaten") && this.toggle.c == 1){
			chillDebuffs.def = Math.min(chillDebuffs.def, -7);
			enemy.penalty.panic = true;
			pCheck = true;
			skillNames.push(data.skills[this.cIndex].name);
		}
		//dual slot skills
		if(this.has("Threaten Atk")){
			if(this.hasSlot("Threaten Atk","c") && this.toggle.c == 1){
				chillDebuffs.atk = Math.min(chillDebuffs.atk,-this.hasSlot("Threaten Atk","c") -2);
				skillNames.push(data.skills[this.cIndex].name);
			}
			if(this.hasSlot("Threaten Atk","s") && this.toggle.s == 1){
				chillDebuffs.atk = Math.min(chillDebuffs.atk,-this.hasSlot("Threaten Atk","s") -2);
				skillNames.push(data.skills[this.sIndex].name);
			}
		}
		if(this.has("Threaten Spd")){
			if(this.hasSlot("Threaten Spd","c") && this.toggle.c == 1){
				chillDebuffs.spd = Math.min(chillDebuffs.spd,-this.hasSlot("Threaten Spd","c") -2);
				skillNames.push(data.skills[this.cIndex].name);
			}
			if(this.hasSlot("Threaten Spd","s") && this.toggle.s == 1){
				chillDebuffs.spd = Math.min(chillDebuffs.spd,-this.hasSlot("Threaten Spd","s") -2);
				skillNames.push(data.skills[this.sIndex].name);
			}
		}
		if(this.has("Threaten Def")){
			if(this.hasSlot("Threaten Def","c") && this.toggle.c == 1){
				chillDebuffs.def = Math.min(chillDebuffs.def,-this.hasSlot("Threaten Def","c") -2);
				skillNames.push(data.skills[this.cIndex].name);
			}
			if(this.hasSlot("Threaten Def","s") && this.toggle.s == 1){
				chillDebuffs.def = Math.min(chillDebuffs.def,-this.hasSlot("Threaten Def","s") -2);
				skillNames.push(data.skills[this.sIndex].name);
			}
		}
		if(this.has("Threaten Res")){
			if(this.hasSlot("Threaten Res","c") && this.toggle.c == 1){
				chillDebuffs.res = Math.min(chillDebuffs.res,-this.hasSlot("Threaten Res","c") -2);
				skillNames.push(data.skills[this.cIndex].name);
			}
			if(this.hasSlot("Threaten Res","s") && this.toggle.s == 1){
				chillDebuffs.res = Math.min(chillDebuffs.res,-this.hasSlot("Threaten Res","s") -2);
				skillNames.push(data.skills[this.sIndex].name);
			}
		}
		if(this.has("Threat Spd Res")){
			if(this.hasSlot("Threat Spd Res","c") && this.toggle.c == 1){
				chillDebuffs.spd = Math.min(chillDebuffs.spd,-this.hasSlot("Threat Spd Res","c")-2);
				chillDebuffs.res = Math.min(chillDebuffs.res,-this.hasSlot("Threat Spd Res","c")-2);
				skillNames.push(data.skills[this.cIndex].name);
			}
			if(this.hasSlot("Threat Spd Res","s") && this.toggle.s == 1){
				chillDebuffs.spd = Math.min(chillDebuffs.spd,-this.hasSlot("Threat Spd Res","s")-2);
				chillDebuffs.res = Math.min(chillDebuffs.res,-this.hasSlot("Threat Spd Res","s")-2);
				skillNames.push(data.skills[this.sIndex].name);
			}
		}
		if(this.has("Threat Atk Res")){
			if(this.hasSlot("Threat Atk Res","c") && this.toggle.c == 1){
				chillDebuffs.atk = Math.min(chillDebuffs.atk,-this.hasSlot("Threat Atk Res","c")-2);
				chillDebuffs.res = Math.min(chillDebuffs.res,-this.hasSlot("Threat Atk Res","c")-2);
				skillNames.push(data.skills[this.cIndex].name);
			}
			if(this.hasSlot("Threat Atk Res","s") && this.toggle.s == 1){
				chillDebuffs.atk = Math.min(chillDebuffs.atk,-this.hasSlot("Threat Atk Res","s")-2);
				chillDebuffs.res = Math.min(chillDebuffs.res,-this.hasSlot("Threat Atk Res","s")-2);
				skillNames.push(data.skills[this.sIndex].name);
			}
		}
		if(this.has("Threat Spd Def")){
			if(this.hasSlot("Threat Spd Def","c") && this.toggle.c == 1){
				chillDebuffs.spd = Math.min(chillDebuffs.spd,-this.hasSlot("Threat Spd Def","c")-2);
				chillDebuffs.def = Math.min(chillDebuffs.def,-this.hasSlot("Threat Spd Def","c")-2);
				skillNames.push(data.skills[this.cIndex].name);
			}
			if(this.hasSlot("Threat Spd Def","s") && this.toggle.s == 1){
				chillDebuffs.spd = Math.min(chillDebuffs.spd,-this.hasSlot("Threat Spd Def","s")-2);
				chillDebuffs.def = Math.min(chillDebuffs.def,-this.hasSlot("Threat Spd Def","s")-2);
				skillNames.push(data.skills[this.sIndex].name);
			}
		}
		if(this.has("Threat Atk Def")){
			if(this.hasSlot("Threat Atk Def","c") && this.toggle.c == 1){
				chillDebuffs.atk = Math.min(chillDebuffs.atk,-this.hasSlot("Threat Atk Def","c")-2);
				chillDebuffs.def = Math.min(chillDebuffs.def,-this.hasSlot("Threat Atk Def","c")-2);
				skillNames.push(data.skills[this.cIndex].name);
			}
			if(this.hasSlot("Threat Atk Def","s") && this.toggle.s == 1){
				chillDebuffs.atk = Math.min(chillDebuffs.atk,-this.hasSlot("Threat Atk Def","s")-2);
				chillDebuffs.def = Math.min(chillDebuffs.def,-this.hasSlot("Threat Atk Def","s")-2);
				skillNames.push(data.skills[this.sIndex].name);
			}
		}
		if(this.has("Threat Def Res")){
			if(this.hasSlot("Threat Def Res","c") && this.toggle.c == 1){
				chillDebuffs.def = Math.min(chillDebuffs.def,-this.hasSlot("Threat Def Res","c")-2);
				chillDebuffs.res = Math.min(chillDebuffs.res,-this.hasSlot("Threat Def Res","c")-2);
				skillNames.push(data.skills[this.cIndex].name);
			}
			if(this.hasSlot("Threat Def Res","s") && this.toggle.s == 1){
				chillDebuffs.def = Math.min(chillDebuffs.def,-this.hasSlot("Threat Def Res","s")-2);
				chillDebuffs.res = Math.min(chillDebuffs.res,-this.hasSlot("Threat Def Res","s")-2);
				skillNames.push(data.skills[this.sIndex].name);
			}
		}
		if(this.has("Chill Atk Res")){
			if(this.hasSlot("Chill Atk Res","b") && this.toggle.b == 1){
				var chdrVar = (this.hasSlot("Chill Atk Res","b") * -2) - 1;
				if(this.hasExactly("Chill Atk Res 3")){
					chdrVar++;
				}
				chillDebuffs.atk = Math.min(chillDebuffs.atk,chdrVar);
				chillDebuffs.res = Math.min(chillDebuffs.res,chdrVar);
				skillNames.push(data.skills[this.bIndex].name);
			}
			if(this.hasSlot("Chill Atk Res","s") && this.toggle.s == 1){
				chillDebuffs.atk = Math.min(chillDebuffs.atk,(this.hasSlot("Chill Atk Res","s") * -2) - 1);
				chillDebuffs.res = Math.min(chillDebuffs.res,(this.hasSlot("Chill Atk Res","s") * -2) - 1);
				skillNames.push(data.skills[this.sIndex].name);
			}
		}
		if(this.has("Chill Atk Spd") && this.toggle.b == 1){
			chillDebuffs.atk = Math.min(chillDebuffs.atk,(this.hasSlot("Chill Atk Spd","b") * -2) - 1);
			chillDebuffs.spd = Math.min(chillDebuffs.spd,(this.hasSlot("Chill Atk Spd","b") * -2) - 1);
			skillNames.push(data.skills[this.bIndex].name);
		}
		if(this.has("Chill Spd Def")){
			if(this.hasSlot("Chill Spd Def","b") && this.toggle.b == 1){
				var chdrVar = (this.hasSlot("Chill Spd Def","b") * -2) - 1;
				if(this.hasExactly("Chill Spd Def 3")){
					chdrVar++;
				}
				chillDebuffs.spd = Math.min(chillDebuffs.spd,chdrVar);
				chillDebuffs.def = Math.min(chillDebuffs.def,chdrVar);
				skillNames.push(data.skills[this.bIndex].name);
			}
			if(this.hasSlot("Chill Spd Def","s") && this.toggle.s == 1){
				chillDebuffs.spd = Math.min(chillDebuffs.spd,(this.hasSlot("Chill Spd Def","s") * -2) - 1);
				chillDebuffs.def = Math.min(chillDebuffs.def,(this.hasSlot("Chill Spd Def","s") * -2) - 1);
				skillNames.push(data.skills[this.sIndex].name);
			}
		}
		if(this.has("Chill Spd Res")){
			if(this.hasSlot("Chill Spd Res","b") && this.toggle.b == 1){
				var chdrVar = (this.hasSlot("Chill Spd Res","b") * -2) - 1;
				if(this.hasExactly("Chill Spd Res 3")){
					chdrVar++;
				}
				chillDebuffs.spd = Math.min(chillDebuffs.spd,chdrVar);
				chillDebuffs.res = Math.min(chillDebuffs.res,chdrVar);
				skillNames.push(data.skills[this.bIndex].name);
			}
			if(this.hasSlot("Chill Spd Res","s") && this.toggle.s == 1){
				chillDebuffs.spd = Math.min(chillDebuffs.spd,(this.hasSlot("Chill Spd Res","s") * -2) - 1);
				chillDebuffs.res = Math.min(chillDebuffs.res,(this.hasSlot("Chill Spd Res","s") * -2) - 1);
				skillNames.push(data.skills[this.sIndex].name);
			}
		}
		if(this.has("Chill Atk Def")){
			if(this.hasSlot("Chill Atk Def","b") && this.toggle.b == 1){
				chillDebuffs.atk = Math.min(chillDebuffs.atk,(this.hasSlot("Chill Atk Def","b") * -2) - 1);
				chillDebuffs.def = Math.min(chillDebuffs.def,(this.hasSlot("Chill Atk Def","b") * -2) - 1);
				skillNames.push(data.skills[this.bIndex].name);
			}
			if(this.hasSlot("Chill Atk Def","s") && this.toggle.s == 1){
				chillDebuffs.atk = Math.min(chillDebuffs.atk,(this.hasSlot("Chill Atk Def","s") * -2) - 1);
				chillDebuffs.def = Math.min(chillDebuffs.def,(this.hasSlot("Chill Atk Def","s") * -2) - 1);
				skillNames.push(data.skills[this.sIndex].name);
			}
		}
		if(this.has("Chill Def Res")){
			if(this.hasSlot("Chill Def Res","b") && this.toggle.b == 1){
				var chdrVar = (this.hasSlot("Chill Def Res","b") * -2) - 1;
				if(this.hasExactly("Chill Def Res 3")){
					chdrVar++;
				}
				chillDebuffs.def = Math.min(chillDebuffs.def,chdrVar);
				chillDebuffs.res = Math.min(chillDebuffs.res,chdrVar);
				skillNames.push(data.skills[this.bIndex].name);
			}
			if(this.hasSlot("Chill Def Res","s") && this.toggle.s == 1){
				chillDebuffs.def = Math.min(chillDebuffs.def,(this.hasSlot("Chill Def Res","s") * -2) - 1);
				chillDebuffs.res = Math.min(chillDebuffs.res,(this.hasSlot("Chill Def Res","s") * -2) - 1);
				skillNames.push(data.skills[this.sIndex].name);
			}
		}
		if(this.has("Chill Spd") && !this.has("Chill Spd Def") && !this.has("Chill Spd Res")){
			if(this.hasSlot("Chill Spd","b") && this.toggle.b == 1){
				chillDebuffs.spd = Math.min(chillDebuffs.spd,(this.hasSlot("Chill Spd","b") * -2) - 1);
				skillNames.push(data.skills[this.bIndex].name);
			}
			if(this.hasSlot("Chill Spd","s") && this.toggle.s == 1){
				chillDebuffs.spd = Math.min(chillDebuffs.spd,(this.hasSlot("Chill Spd","s") * -2) - 1);
				skillNames.push(data.skills[this.sIndex].name);
			}
		}
		if(this.has("Chill Def") && !this.has("Chill Def Res")){
			if(this.hasSlot("Chill Def","b") && this.toggle.b == 1){
				chillDebuffs.def = Math.min(chillDebuffs.def,(this.hasSlot("Chill Def","b") * -2) - 1);
				skillNames.push(data.skills[this.bIndex].name);
			}
			if(this.hasSlot("Chill Def","s") && this.toggle.s == 1){
				chillDebuffs.def = Math.min(chillDebuffs.def,(this.hasSlot("Chill Def","s") * -2) - 1);
				skillNames.push(data.skills[this.sIndex].name);
			}
		}
		if(this.has("Chill Res")){
			if(this.hasSlot("Chill Res","b") && this.toggle.b == 1){
				chillDebuffs.res = Math.min(chillDebuffs.res,(this.hasSlot("Chill Res","b") * -2) - 1);
				skillNames.push(data.skills[this.bIndex].name);
			}
			if(this.hasSlot("Chill Res","s") && this.toggle.s == 1){
				chillDebuffs.res = Math.min(chillDebuffs.res,(this.hasSlot("Chill Res","s") * -2) - 1);
				skillNames.push(data.skills[this.sIndex].name);
			}
		}
		if(this.has("Chill Atk") && !this.has("Chill Atk Res") && !this.has("Chill Atk Spd") && !this.has("Chill Atk Def")){
			if(this.hasSlot("Chill Atk","b") && this.toggle.b == 1){
				chillDebuffs.atk = Math.min(chillDebuffs.atk,(this.hasSlot("Chill Atk","b") * -2) - 1);
				skillNames.push(data.skills[this.bIndex].name);
			}
			if(this.hasSlot("Chill Atk","s") && this.toggle.s == 1){
				chillDebuffs.atk = Math.min(chillDebuffs.atk,(this.hasSlot("Chill Atk","s") * -2) - 1);
				skillNames.push(data.skills[this.sIndex].name);
			}
		}
		if(this.res + this.getPhantom("Res") > enRes + enemy.getPhantom("Res") && (this.has("Atk Ploy") || this.has("Spd Ploy") || this.has("Def Ploy") || this.has("Res Ploy"))){
			if(this.has("Atk Ploy")){
				if(this.hasSlot("Atk Ploy","c") && this.toggle.c == 1){
					chillDebuffs.atk = Math.min(chillDebuffs.atk,-this.hasSlot("Atk Ploy","c")-2);
					skillNames.push(data.skills[this.cIndex].name);
				}
				if(this.hasSlot("Atk Ploy","s") && this.toggle.s == 1){
					chillDebuffs.atk = Math.min(chillDebuffs.atk,-this.hasSlot("Atk Ploy","s")-2);
					skillNames.push(data.skills[this.sIndex].name);
				}
			}
			if(this.has("Spd Ploy") && !this.hasExactly("Atk Spd Ploy 3")){
				if(this.hasSlot("Spd Ploy","c") && this.toggle.c == 1){
					chillDebuffs.spd = Math.min(chillDebuffs.spd,-this.hasSlot("Spd Ploy","c")-2);
					skillNames.push(data.skills[this.cIndex].name);
				}
				if(this.hasSlot("Spd Ploy","s") && this.toggle.s == 1){
					chillDebuffs.spd = Math.min(chillDebuffs.spd,-this.hasSlot("Spd Ploy","s")-2);
					skillNames.push(data.skills[this.sIndex].name);
				}
			}
			if(this.has("Def Ploy")){
				if(this.hasSlot("Def Ploy","c") && this.toggle.c == 1){
					chillDebuffs.def = Math.min(chillDebuffs.def,-this.hasSlot("Def Ploy","c")-2);
					skillNames.push(data.skills[this.cIndex].name);
				}
				if(this.hasSlot("Def Ploy","s") && this.toggle.s == 1){
					chillDebuffs.def = Math.min(chillDebuffs.def,-this.hasSlot("Def Ploy","s")-2);
					skillNames.push(data.skills[this.sIndex].name);
				}
			}
			if(this.has("Res Ploy") && !this.hasExactly("Def Res Ploy 3") && !this.hasExactly("Atk Res Ploy 3") && !this.hasExactly("Spd Res Ploy 3")){
				if(this.hasSlot("Res Ploy","c") && this.toggle.c == 1){
					chillDebuffs.res = Math.min(chillDebuffs.res,-this.hasSlot("Res Ploy","c")-2);
					skillNames.push(data.skills[this.cIndex].name);
				}
				if(this.hasSlot("Res Ploy","s") && this.toggle.s == 1){
					chillDebuffs.res = Math.min(chillDebuffs.res,-this.hasSlot("Res Ploy","s")-2);
					skillNames.push(data.skills[this.sIndex].name);
				}
			}
		}
		if(this.has("Panic Ploy") || (this.hasExactly("Cherche's Axe") && this.rValue == 5 && this.toggle.weapon == 1)){
			var pValue = 0;
			if(this.hasSlot("Panic Ploy","c") && this.toggle.c == 1){
				pValue = this.hasSlot("Panic Ploy","c");
			}
			if(this.hasSlot("Panic Ploy","s") && this.toggle.s == 1){
				pValue = Math.max(pValue,this.hasSlot("Panic Ploy","s"));
			}
			var pEff = 6 - pValue * 2;
			var caCheck = false;
			if(this.hasExactly("Cherche's Axe") && this.rValue == 5 && this.toggle.weapon == 1){
				pEff = 0;
				caCheck = true;
			}
			if(this.hp > enemy.hp + pEff){
				enemy.penalty.panic = true;
				pCheck = true;
				if(caCheck){
					chillText += this.name + " activates Cherche's Axe, inflicting panic on " + enemy.name + ".<br>";
				}
				else{
					chillText += this.name + " activates Panic Ploy " + pValue + ", inflicting panic on " + enemy.name + ".<br>";
				}
			}
		}
		if(options.threatenRule=="Summ. Duels" && this.hasCaptain("Dauntless") && this.toggle.sd > 0 && turn > 1 && turn < 6){
			enemy.penalty.cdguard = true;
			skillNames.push(data.captainSkills[this.sdIndex]);
		}
		else if(options.threatenRule=="Summ. Duels" && this.hasCaptain("Mass Confusion") && this.toggle.sd > 0 && turn > 1 && turn < 6){
			chillDebuffs.atk = Math.min(chillDebuffs.atk, -7);
			chillDebuffs.def = Math.min(chillDebuffs.def, -7);
			chillDebuffs.res = Math.min(chillDebuffs.res, -7);
			skillNames.push(data.captainSkills[this.sdIndex]);
		}
		
		//Neutralize Function (ie. Crystalline Water)
		var cdNull = {"atk":false,"spd":false,"def":false,"res":false};
		if(enemy.hasExactly("Arcane Giant Axe")){
			cdNull.atk = true;
			cdNull.def = true;
			if(pCheck == true){
				enemy.penalty.panic = false;
			}
			chillText += enemy.name + " has neutralized [Panic] and penalties to atk & def with Arcane Giant Axe.<br>";
		}
		if(enemy.hasExactly("Crystalline Water")){
			cdNull.atk = true;
			cdNull.res = true;
			if(pCheck == true){
				enemy.penalty.panic = false;
			}
			chillText += enemy.name + " has neutralized [Panic] and penalties to atk & res with Crystalline Water.<br>";
		}
		else if(enemy.hasExactly("Verge of Death")){
			cdNull.atk = true;
			cdNull.spd = true;
			if(pCheck == true){
				enemy.penalty.panic = false;
			}
			chillText += enemy.name + " has neutralized [Panic] and penalties to atk & spd with Verge of Death.<br>";
		}
		else if(enemy.hasExactly("Stronghold")){
			cdNull.def = true;
			cdNull.res = true;
			if(pCheck == true){
				enemy.penalty.panic = false;
			}
			chillText += enemy.name + " has neutralized [Panic] and penalties to def & res with Stronghold.<br>";
		}
		
		if(skillNames.length > 0){
			var statChanges = [];
			for(var stat in chillDebuffs){
				if(chillDebuffs[stat] < Math.min(enemy.debuffs[stat], enemy.combatDebuffs[stat]) && cdNull[stat] == false){
					enemy.combatDebuffs[stat] = chillDebuffs[stat];
					statChanges.push(stat + " " + chillDebuffs[stat]);
				}
			}

			if(statChanges.length > 0){
				chillText += this.name + " has turn-start debuffing skills: " + skillNames.join(", ") + ". Effect on " + enemy.name + ": " + statChanges.join(", ") + "<br>";
			}
		}

		return chillText;
	};
	
	//Activated debuffs (by movement assist or Rally)
	this.feint = function(enemy,turn){
		var feintText = "";
		var skillName = "";
		var debuffVal = 0;
		var allStats = getEffStats(this, enemy, turn);
		//Feint skills
		if(this.has("Spd Feint")){
			if(this.hasSlot("Spd Feint","b") && -this.hasSlot("Spd Feint","b")*2-1 < enemy.combatDebuffs.spd && this.toggle.b == 1){
				enemy.combatDebuffs.spd = -this.hasSlot("Spd Feint","b")*2-1;
				debuffVal = enemy.combatDebuffs.spd;
				skillName = data.skills[this.bIndex].name;
				feintText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": " + debuffVal + " spd<br>";
			}
			if(this.hasSlot("Spd Feint","s") && -this.hasSlot("Spd Feint","s")*2-1 < enemy.combatDebuffs.spd && this.toggle.s == 1){
				enemy.combatDebuffs.spd = -this.hasSlot("Spd Feint","s")*2-1;
				debuffVal = enemy.combatDebuffs.spd;
				skillName = data.skills[this.sIndex].name;
				feintText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": " + debuffVal + " spd<br>";
			}
		}
		if(this.has("Def Feint")){
			if(this.hasSlot("Def Feint","b") && -this.hasSlot("Def Feint","b")*2-1 < enemy.combatDebuffs.def && this.toggle.b == 1){
				enemy.combatDebuffs.def = -this.hasSlot("Def Feint","b")*2-1;
				debuffVal = enemy.combatDebuffs.def;
				skillName = data.skills[this.bIndex].name;
				feintText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": " + debuffVal + " def<br>";
			}
			if(this.hasSlot("Def Feint","s") && -this.hasSlot("Def Feint","s")*2-1 < enemy.combatDebuffs.def && this.toggle.s == 1){
				enemy.combatDebuffs.def = -this.hasSlot("Def Feint","s")*2-1;
				debuffVal = enemy.combatDebuffs.def;
				skillName = data.skills[this.sIndex].name;
				feintText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": " + debuffVal + " def<br>";
			}
		}
		if(this.has("Atk Feint")){
			if(this.hasSlot("Atk Feint","b") && -this.hasSlot("Atk Feint","b")*2-1 < enemy.combatDebuffs.atk && this.toggle.b == 1){
				enemy.combatDebuffs.atk = -this.hasSlot("Atk Feint","b")*2-1;
				debuffVal = enemy.combatDebuffs.atk;
				skillName = data.skills[this.bIndex].name;
				feintText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": " + debuffVal + " atk<br>";
			}
			if(this.hasSlot("Atk Feint","s") && -this.hasSlot("Atk Feint","s")*2-1 < enemy.combatDebuffs.atk && this.toggle.s == 1){
				enemy.combatDebuffs.atk = -this.hasSlot("Atk Feint","s")*2-1;
				debuffVal = enemy.combatDebuffs.atk;
				skillName = data.skills[this.sIndex].name;
				feintText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": " + debuffVal + " atk<br>";
			}
		}
		if(this.has("Res Feint")){
			if(this.hasSlot("Res Feint","b") && -this.hasSlot("Res Feint","b")*2-1 < enemy.combatDebuffs.res && this.toggle.b == 1){
				enemy.combatDebuffs.res = -this.hasSlot("Res Feint","b")*2-1;
				debuffVal = enemy.combatDebuffs.res;
				skillName = data.skills[this.bIndex].name;
				feintText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": " + debuffVal + " res<br>";
			}
			if(this.hasSlot("Res Feint","s") && -this.hasSlot("Res Feint","s")*2-1 < enemy.combatDebuffs.res && this.toggle.s == 1){
				enemy.combatDebuffs.res = -this.hasSlot("Res Feint","s")*2-1;
				debuffVal = enemy.combatDebuffs.res;
				skillName = data.skills[this.sIndex].name;
				feintText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": " + debuffVal + " res<br>";
			}
		}
		if((this.hasExactly("Spd Def Detect") || this.hasExactly("Atk Res Detect")) && this.toggle.b == 1){
			enemy.penalty.exposure = true;
			skillName = data.skills[this.bIndex].name;
			feintText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": Exposure effect<br>";
		}
		//Ruse skills
		if(this.has("Def Res Ruse") && this.toggle.b == 1){
			debuffVal = -this.has("Def Res Ruse")*2+1;
			if(debuffVal < enemy.combatDebuffs.def){
				enemy.combatDebuffs.def = debuffVal;
			}
			if(debuffVal < enemy.combatDebuffs.res){
				enemy.combatDebuffs.res = debuffVal;
			}
			enemy.penalty.cdguard = true;
			skillName = data.skills[this.bIndex].name;
			feintText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": " + debuffVal + " def & res, Guard effect<br>";
		}
		if(this.has("Atk Spd Ruse") && this.toggle.b == 1){
			debuffVal = -this.has("Atk Spd Ruse")*2+1;
			var sdrText = "";
			if(this.hasExactly("Atk Spd Ruse 4")){
				debuffVal++;
				enemy.penalty.discord = true;
				enemy.penalty.schism = true;
				sdrText = "/Discord/Schism";
			}
			if(debuffVal < enemy.combatDebuffs.atk){
				enemy.combatDebuffs.atk = debuffVal;
			}
			if(debuffVal < enemy.combatDebuffs.spd){
				enemy.combatDebuffs.spd = debuffVal;
			}
			enemy.penalty.cdguard = true;
			skillName = data.skills[this.bIndex].name;
			feintText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": " + debuffVal + " atk & spd, Guard" + sdrText + " effect<br>";
		}
		if(this.has("Spd Res Ruse") && this.toggle.b == 1){
			debuffVal = -this.has("Spd Res Ruse")*2+1;
			if(debuffVal < enemy.combatDebuffs.spd){
				enemy.combatDebuffs.spd = debuffVal;
			}
			if(debuffVal < enemy.combatDebuffs.res){
				enemy.combatDebuffs.res = debuffVal;
			}
			enemy.penalty.cdguard = true;
			skillName = data.skills[this.bIndex].name;
			feintText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": " + debuffVal + " spd & res, Guard effect<br>";
		}
		if(this.has("Spd Def Ruse") && this.toggle.b == 1){
			debuffVal = -this.has("Spd Def Ruse")*2+1;
			var sdrText = "";
			if(this.hasExactly("Spd Def Ruse 4")){
				debuffVal++;
				enemy.penalty.discord = true;
				enemy.penalty.schism = true;
				sdrText = "/Discord/Schism";
			}
			if(debuffVal < enemy.combatDebuffs.spd){
				enemy.combatDebuffs.spd = debuffVal;
			}
			if(debuffVal < enemy.combatDebuffs.def){
				enemy.combatDebuffs.def = debuffVal;
			}
			enemy.penalty.cdguard = true;
			skillName = data.skills[this.bIndex].name;
			feintText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": " + debuffVal + " spd a& def, Guard" + sdrText + " effect<br>";
		}
		if(this.has("Atk Def Ruse") && this.toggle.b == 1){
			debuffVal = -this.has("Atk Def Ruse")*2+1;
			if(debuffVal < enemy.combatDebuffs.atk){
				enemy.combatDebuffs.atk = debuffVal;
			}
			if(debuffVal < enemy.combatDebuffs.def){
				enemy.combatDebuffs.def = debuffVal;
			}
			enemy.penalty.cdguard = true;
			skillName = data.skills[this.bIndex].name;
			feintText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": " + debuffVal + " atk & def, Guard effect<br>";
		}
		if(this.has("Atk Res Ruse") && this.toggle.b == 1){
			debuffVal = -this.has("Atk Res Ruse")*2+1;
			if(debuffVal < enemy.combatDebuffs.atk){
				enemy.combatDebuffs.atk = debuffVal;
			}
			if(debuffVal < enemy.combatDebuffs.res){
				enemy.combatDebuffs.res = debuffVal;
			}
			enemy.penalty.cdguard = true;
			skillName = data.skills[this.bIndex].name;
			feintText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": " + debuffVal + " atk & res, Guard effect<br>";
		}
		//Snag skills
		if(this.has("Spd Res Snag") && this.toggle.b == 1){
			debuffVal = this.has("Spd Res Snag") * -2;
			if(debuffVal < enemy.combatDebuffs.spd){
				enemy.combatDebuffs.spd = debuffVal;
			}
			if(debuffVal < enemy.combatDebuffs.res){
				enemy.combatDebuffs.res = debuffVal;
			}
			skillName = data.skills[this.bIndex].name;
			feintText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": " + debuffVal + " spd & res<br>";
		}
		if(this.has("Spd Def Snag") && this.toggle.b == 1){
			debuffVal = this.has("Spd Def Snag") * -2;
			var s4Text = "";
			if(this.hasExactly("Spd Def Snag 4")){
				debuffVal++;
				enemy.penalty.sabotage = true;
				s4Text = " and [Sabotage]";
			}
			if(debuffVal < enemy.combatDebuffs.spd){
				enemy.combatDebuffs.spd = debuffVal;
			}
			if(debuffVal < enemy.combatDebuffs.def){
				enemy.combatDebuffs.def = debuffVal;
			}
			skillName = data.skills[this.bIndex].name;
			feintText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": " + debuffVal + " spd & def" + s4Text + "<br>";
		}
		if(this.has("Atk Def Snag") && this.toggle.b == 1){
			debuffVal = this.has("Atk Def Snag") * -2;
			var s4Text = "";
			if(this.hasExactly("Atk Def Snag 4")){
				debuffVal++;
				enemy.penalty.sabotage = true;
				s4Text = " and [Sabotage]";
			}
			if(debuffVal < enemy.combatDebuffs.atk){
				enemy.combatDebuffs.atk = debuffVal;
			}
			if(debuffVal < enemy.combatDebuffs.def){
				enemy.combatDebuffs.def = debuffVal;
			}
			skillName = data.skills[this.bIndex].name;
			feintText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": " + debuffVal + " atk & def" + s4Text + "<br>";
		}
		if(this.hasSlot("Atk Spd Snag","b") && this.toggle.b == 1){
			debuffVal = this.hasSlot("Atk Spd Snag","b") * -2;
			if(debuffVal < enemy.combatDebuffs.atk){
				enemy.combatDebuffs.atk = debuffVal;
			}
			if(debuffVal < enemy.combatDebuffs.spd){
				enemy.combatDebuffs.spd = debuffVal;
			}
			skillName = data.skills[this.bIndex].name;
			feintText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": " + debuffVal + " atk & spd<br>";
		}
		if(this.hasSlot("Def Res Snag","b") && this.toggle.b == 1){
			debuffVal = this.hasSlot("Def Res Snag","b") * -2;
			if(debuffVal < enemy.combatDebuffs.def){
				enemy.combatDebuffs.def = debuffVal;
			}
			if(debuffVal < enemy.combatDebuffs.res){
				enemy.combatDebuffs.res = debuffVal;
			}
			skillName = data.skills[this.bIndex].name;
			feintText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": " + debuffVal + " def & res<br>";
		}
		if(this.has("Atk Res Snag") && this.toggle.b == 1){
			debuffVal = this.has("Atk Res Snag") * -2;
			if(debuffVal < enemy.combatDebuffs.atk){
				enemy.combatDebuffs.atk = debuffVal;
			}
			if(debuffVal < enemy.combatDebuffs.res){
				enemy.combatDebuffs.res = debuffVal;
			}
			skillName = data.skills[this.bIndex].name;
			feintText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": " + debuffVal + " atk & res<br>";
		}
		if(this.hasSlot("Def Res Snag","s") && this.toggle.s == 1){
			debuffVal = this.hasSlot("Def Res Snag","s") * -2;
			if(debuffVal < enemy.combatDebuffs.def){
				enemy.combatDebuffs.def = debuffVal;
			}
			if(debuffVal < enemy.combatDebuffs.res){
				enemy.combatDebuffs.res = debuffVal;
			}
			skillName = data.skills[this.sIndex].name;
			feintText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": " + debuffVal + " def & res<br>";
		}
		if(this.hasSlot("Atk Spd Snag","s") && this.toggle.s == 1){
			debuffVal = this.hasSlot("Atk Spd Snag","s") * -2;
			if(debuffVal < enemy.combatDebuffs.atk){
				enemy.combatDebuffs.atk = debuffVal;
			}
			if(debuffVal < enemy.combatDebuffs.spd){
				enemy.combatDebuffs.spd = debuffVal;
			}
			skillName = data.skills[this.sIndex].name;
			feintText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": " + debuffVal + " atk & spd<br>";
		}
		//Sabertooth Fang
		if(this.hasExactly("Sabertooth Fang") && (this.toggle.weapon == 1 || this.toggle.weapon == 3)){
			var tCheck = 0;
			debuffVal = -4;
			var pulseText = "";
			if(this.rValue > 0){
				debuffVal = -5;
			}
			if(debuffVal < enemy.combatDebuffs.atk){
				enemy.combatDebuffs.atk = debuffVal;
				tCheck++;
			}
			if(debuffVal < enemy.combatDebuffs.spd){
				enemy.combatDebuffs.spd = debuffVal;
				tCheck++;
			}
			if(debuffVal < enemy.combatDebuffs.def){
				enemy.combatDebuffs.def = debuffVal;
				tCheck++;
			}
			if(debuffVal < enemy.combatDebuffs.res){
				enemy.combatDebuffs.res = debuffVal;
				tCheck++;
			}
			if(this.rValue == 5 && enemy.charge > 0){
				enemy.charge -= 1;
				pulseText = " and CD -1";
				tCheck++;
			}
			if(tCheck > 0){
				skillName = data.skills[this.weaponIndex].name;
				feintText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": " + debuffVal + " to all stats" + pulseText + "<br>";
			}
		}
		else if(this.hasExactly("Retainer's Report") && this.rValue == 5 && this.toggle.weapon > 1){
			debuffVal = -7;
			if(debuffVal < enemy.combatDebuffs.atk){
				enemy.combatDebuffs.atk = debuffVal;
			}
			if(debuffVal < enemy.combatDebuffs.def){
				enemy.combatDebuffs.def = debuffVal;
			}
			if(debuffVal < enemy.combatDebuffs.res){
				enemy.combatDebuffs.res = debuffVal;
			}
			enemy.penalty.cdguard = true;
			enemy.penalty.exposure = true;
			skillName = data.skills[this.weaponIndex].name;
			feintText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": " + debuffVal + " to atk/def/res and inflicts [Guard] and [Exposure].<br>";
		}
		else if(this.hasExactly("Heidr") && (this.toggle.weapon == 1 || this.toggle.weapon == 3)){
			debuffVal = -4;
			if(debuffVal < enemy.combatDebuffs.atk){
				enemy.combatDebuffs.atk = debuffVal;
			}
			if(debuffVal < enemy.combatDebuffs.spd){
				enemy.combatDebuffs.spd = debuffVal;
			}
			if(debuffVal < enemy.combatDebuffs.def){
				enemy.combatDebuffs.def = debuffVal;
			}
			if(debuffVal < enemy.combatDebuffs.res){
				enemy.combatDebuffs.res = debuffVal;
			}
			enemy.penalty.cdguard = true;
			skillName = data.skills[this.weaponIndex].name;
			feintText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": " + debuffVal + " to all stats and inflicts [Guard].<br>";
		}
		else if(this.hasExactly("Spy's Shuriken") && this.toggle.weapon == 2){
			enemy.penalty.exposure = true;
			feintText += this.name + " has activated Spy's Shuriken. Effect on " + enemy.name + ": [Exposure].<br>";
		}
		else if(this.hasExactly("Tome of Dusk") && this.toggle.weapon == 1 && allStats[19] + this.getPhantom("Res") + 5 > allStats[23] + enemy.getPhantom("Res")){
			enemy.combatDebuffs.atk = Math.min(enemy.combatDebuffs.atk, -7);
			enemy.combatDebuffs.res = Math.min(enemy.combatDebuffs.res, -7);
			enemy.penalty.sabotage = true;
			feintText += this.name + " has activated Tome of Dusk. Effect on " + enemy.name + ": -7 atk & res and [Sabotage].<br>";
		}
		
		return feintText;
	};

	this.renew = function(turn){
		var renewText = "";
		var renewalTurn = 0;
		//weapons
		if(this.hasExactly("Falchion")){
			//if refined, Renewal 3
			if(this.rValue > 0){
				renewalTurn = 2;
			}
			else{
				renewalTurn = 3;
			}
			if(turn % renewalTurn == 1){
				var renewalHp = 10;
				if(this.hp + renewalHp > this.maxHp){
					renewalHp = this.maxHp - this.hp;
				}
				this.hp += renewalHp;
				renewText += "Falchion: " + this.name + " heals " + renewalHp + "HP.<br>";
			}
		}
		else if(this.hasExactly("Breath Of Fog")){
			renewalTurn = 3;
			if(turn % renewalTurn == 1){
				var renewalHp = 10;
				if(this.hp + renewalHp > this.maxHp){
					renewalHp = this.maxHp - this.hp;
				}
				this.hp += renewalHp;
				renewText += "Breath Of Fog: " + this.name + " heals " + renewalHp + "HP.<br>";
			}
		}
		else if(this.has("Ovoid Staff")){
			var renewalHp = 7;
			if(this.hp + renewalHp > this.maxHp){
				renewalHp = this.maxHp - this.hp;
			}
			this.hp += renewalHp;
			renewText += "Ovoid Staff: " + this.name + " heals " + renewalHp + "HP.<br>";
		}
		else if(this.hasExactly("Muninn's Egg") && this.rValue == 5){
			var renewalHp = 7;
			if(this.hp + renewalHp > this.maxHp){
				renewalHp = this.maxHp - this.hp;
			}
			this.hp += renewalHp;
			renewText += "Muninn's Egg: " + this.name + " heals " + renewalHp + "HP.<br>";
		}
		else if((this.has("Luminous Grace") || this.has("Drifting Grace")) && this.hp/this.maxHp >= 0.25){
			var renewalHp = 10;
			if(this.hp + renewalHp > this.maxHp){
				renewalHp = this.maxHp - this.hp;
			}
			this.hp += renewalHp;
			renewText += data.skills[this.weaponIndex].name + ": " + this.name + " heals " + renewalHp + "HP.<br>";
		}
		else if(this.hasExactly("Joyous Tome") && this.toggle.weapon > 0){
			var renewalHp = 7;
			if(this.hp + renewalHp > this.maxHp){
				renewalHp = this.maxHp - this.hp;
			}
			this.hp += renewalHp;
			renewText += "Joyour Tome: " + this.name + " heals " + renewalHp + "HP.<br>";
		}
		else if(this.hasExactly("Repair")){
			var renewalHp = 20;
			if(this.hp + renewalHp > this.maxHp){
				renewalHp = this.maxHp - this.hp;
			}
			this.hp += renewalHp;
			renewText += "Repair: " + this.name + " heals " + renewalHp + "HP.<br>";
		}
		else if(this.hasExactly("Lucky Bow") && this.rValue == 5 && this.toggle.weapon == 1){
			var renewalHp = 10;
			if(this.hp + renewalHp > this.maxHp){
				renewalHp = this.maxHp - this.hp;
			}
			this.hp += renewalHp;
			renewText += "Lucky Bow: " + this.name + " heals " + renewalHp + "HP.<br>";
		}
		else if(this.hasExactly("Hippity-Hop Axe") && (this.toggle.weapon == 1 || this.toggle.weapon == 3)){
			var renewalHp = 7;
			if(this.hp + renewalHp > this.maxHp){
				renewalHp = this.maxHp - this.hp;
			}
			this.hp += renewalHp;
			renewText += "Hippity-Hop Axe: " + this.name + " heals " + renewalHp + "HP.<br>";
		}
		//b skills
		if(this.hasSlot("Renewal","b")){
			renewalTurn = 5 - this.hasSlot("Renewal","b");
			if(turn % renewalTurn == 1){
				var renewalHp = 10;
				if(this.hp + renewalHp > this.maxHp){
					renewalHp = this.maxHp - this.hp;
				}
				this.hp += renewalHp;
				renewText += "Renewal: " + this.name + " heals " + renewalHp + "HP.<br>";
			}
		}
		else if(this.has("Recover Ring")){
			var renewalHp = 10;
			if(this.hp + renewalHp > this.maxHp){
				renewalHp = this.maxHp - this.hp;
			}
			this.hp += renewalHp;
			renewText += "Recover Ring: " + this.name + " heals " + renewalHp + "HP.<br>";
		}
		else if(this.hasExactly("S Drink") && turn == 1){
			this.hp = this.maxHp;
			renewText += "S Drink: " + this.name + " heals 99 HP.<br>";
		}
		else if(this.hasExactly("True Dragon Wall") && this.toggle.b > 1){
			var renewalHp = 7;
			if(this.hp + renewalHp > this.maxHp){
				renewalHp = this.maxHp - this.hp;
			}
			this.hp += renewalHp;
			renewText += "True Dragon Wall: " + this.name + " heals " + renewalHp + "HP.<br>";
		}
		else if(this.hasExactly("Pure Dragon Wall") && (this.toggle.b > 1 || this.buddy.adjacent + this.buddy.two > 0)){
			var renewalHp = 10;
			if(this.hp + renewalHp > this.maxHp){
				renewalHp = this.maxHp - this.hp;
			}
			this.hp += renewalHp;
			renewText += "Pure Dragon Wall: " + this.name + " heals " + renewalHp + "HP.<br>";
		}
		//s skills
		if(this.hasSlot("Renewal","s")){
			renewalTurn = 5 - this.hasSlot("Renewal","s");
			if(turn % renewalTurn == 1){
				var renewalHp = 10;
				if(this.hp + renewalHp > this.maxHp){
					renewalHp = this.maxHp - this.hp;
				}
				this.hp += renewalHp;
				renewText += "Renewal: " + this.name + " heals " + renewalHp + "HP.<br>";
			}
		}

		return renewText;
	};
	
	this.renewEP = function(turn){
		var renewText = "";
		//var renewalTurn = 0;
		var renewalHp = 0;
		//weapons
		if(this.hasExactly("Silver of Dawn")){
			renewalHp += 10;
			renewText += "Silver of Dawn";
		}
		else if(this.hasExactly("Scroll of Teas")){
			renewalHp += 10;
			renewText += "Scroll of Teas";
		}
		//ephase
		if(this.ephase.heal > 0){
			renewalHp += this.ephase.heal;
			if(renewText != ""){
				renewText += ", ";
			}
			renewText += "EP Heal Support";
		}
		if(renewalHp > 0){
			renewText = this.name + " heals " + renewalHp + " HP from " + renewText + "<br>";
			if(this.hp + renewalHp > this.maxHp){
				renewalHp = this.maxHp - this.hp;
			}
			this.hp += renewalHp;
		}
		return renewText;
	};
	
	//function to check for turn start self buffs
	this.selfBuff = function(turn){
		var buffText = "";
		var skillName = "";
		//Defiant type skills
		if(this.hp/this.maxHp <= 0.5 && (this.has("Defiant") || (this.hasExactly("Folkvangr") && this.rValue < 0))){
			var defiantVal = [0,0,0,0];
			if(this.has("Defiant Atk")){
				if(this.hasSlot("Defiant Atk","a")){
					defiantVal[0] = this.hasSlot("Defiant Atk","a") * 2 + 1;
					skillName = data.skills[this.aIndex].name;
				}
				if(this.hasSlot("Defiant Atk","s") && this.hasSlot("Defiant Atk","s") * 2 + 1 > defiantVal[0]){
					defiantVal[0] = this.hasSlot("Defiant Atk","s") * 2 + 1;
					skillName = data.skills[this.sIndex].name;
				}
			}
			if(this.has("Defiant Spd")){
				if(this.hasSlot("Defiant Spd","a")){
					defiantVal[1] = this.hasSlot("Defiant Spd","a") * 2 + 1;
					skillName = data.skills[this.aIndex].name;
				}
				if(this.hasSlot("Defiant Spd","s") && this.hasSlot("Defiant Spd","s") * 2 + 1 > defiantVal[1]){
					defiantVal[1] = this.hasSlot("Defiant Spd","s") * 2 + 1;
					skillName = data.skills[this.sIndex].name;
				}
			}
			if(this.has("Defiant Def")){
				if(this.hasSlot("Defiant Def","a")){
					defiantVal[2] = this.hasSlot("Defiant Def","a") * 2 + 1;
					skillName = data.skills[this.aIndex].name;
				}
				if(this.hasSlot("Defiant Def","s") && this.hasSlot("Defiant Def","s") * 2 + 1 > defiantVal[2]){
					defiantVal[2] = this.hasSlot("Defiant Def","s") * 2 + 1;
					skillName = data.skills[this.sIndex].name;
				}
			}
			if(this.has("Defiant Res")){
				defiantVal[3] = this.has("Defiant Res") * 2 + 1;
				skillName = data.skills[this.aIndex].name;
			}
			if(this.hasExactly("Folkvangr") && this.rValue < 0){
				if(defiantVal[0] < 5){
					defiantVal[0] = 5;
					skillName = data.skills[this.weaponIndex].name;
				}
			}
			if(defiantVal[0] > this.combatBuffs.atk){
				this.combatBuffs.atk = defiantVal[0];
				buffText += this.name + " activates " + skillName + " for +" + defiantVal[0] + " atk.<br>";
			}
			if(defiantVal[1] > this.combatBuffs.spd){
				this.combatBuffs.spd = defiantVal[1];
				buffText += this.name + " activates " + skillName + " for +" + defiantVal[1] + " spd.<br>";
			}
			if(defiantVal[2] > this.combatBuffs.def){
				this.combatBuffs.def = defiantVal[2];
				buffText += this.name + " activates " + skillName + " for +" + defiantVal[2] + " def.<br>";
			}
			if(defiantVal[3] > this.combatBuffs.res){
				this.combatBuffs.res = defiantVal[3];
				buffText += this.name + " activates " + skillName + " for +" + defiantVal[3] + " res.<br>";
			}
		}
		if(this.weaponIndex != -1 && data.selfBuffSkills.indexOf(data.skills[this.weaponIndex].name) != -1){
			skillName = data.skills[this.weaponIndex].name;
			var remainder = turn % 2;
			if(this.has("Fresh Bouquet") && this.toggle.weapon == 1){
				this.combatBuffs.spd = Math.max(4,this.combatBuffs.spd);
				buffText += this.name + " activates " + skillName + " and gains +4 spd.<br>";
			}
			else if(this.has("Ardent Service") && this.toggle.weapon == 1){
				this.combatBuffs.atk = Math.max(4,this.combatBuffs.atk);
				buffText += this.name + " activates " + skillName + " and gains +4 atk.<br>";
			}
			else if(this.hasExactly("Odin's Grimoire") && this.rValue == 5 && this.toggle.weapon == 1){
				var buffVal = 6;
				this.combatBuffs.atk = Math.max(buffVal,this.combatBuffs.atk);
				this.combatBuffs.spd = Math.max(buffVal,this.combatBuffs.spd);
				buffText += this.name + " activates " + skillName + " and gains +" + buffVal + " atk and spd.<br>";
			}
			else if(this.has("Trident") && this.toggle.weapon == 1){
				this.combatBuffs.atk = Math.max(6,this.combatBuffs.atk);
				buffText += this.name + " activates " + skillName + " and gains +6 atk.<br>";
			}
			else if(this.has("Shellpoint Lance") && this.toggle.weapon == 1){
				this.combatBuffs.def = Math.max(6,this.combatBuffs.def);
				buffText += this.name + " activates " + skillName + " and gains +6 def.<br>";
			}
			else if(this.hasExactly("Byleistr") && this.rValue < 0 && remainder == 1){
				this.combatBuffs.atk = Math.max(4,this.combatBuffs.atk);
				this.combatBuffs.spd = Math.max(4,this.combatBuffs.spd);
				this.combatBuffs.def = Math.max(4,this.combatBuffs.def);
				this.combatBuffs.res = Math.max(4,this.combatBuffs.res);
				buffText += this.name + " activates " + skillName + " on turn " + turn + " and gains +4 to all stats.<br>";
			}
			else if(this.hasExactly("Byleistr") && this.rValue > 0 && (remainder == 1 || this.toggle.weapon == 1 || this.toggle.weapon == 3)){
				this.combatBuffs.atk = Math.max(5,this.combatBuffs.atk);
				this.combatBuffs.spd = Math.max(5,this.combatBuffs.spd);
				this.combatBuffs.def = Math.max(5,this.combatBuffs.def);
				this.combatBuffs.res = Math.max(5,this.combatBuffs.res);
				buffText += this.name + " activates " + skillName + " and gains +5 to all stats.<br>";
			}
			else if(this.hasExactly("Iris's Tome") && this.rValue == 5 && remainder == 0){
				this.combatBuffs.atk = Math.max(6,this.combatBuffs.atk);
				buffText += this.name + " activates Iris's Tome and gains +6 atk.<br>";
			}
			else if(this.hasExactly("Book of Orchids") && this.rValue == 5 && this.toggle.weapon == 1){
				this.combatBuffs.atk = Math.max(6,this.combatBuffs.atk);
				this.combatBuffs.spd = Math.max(6,this.combatBuffs.spd);
				buffText += this.name + " activates Book of Orchids and gains +6 atk and spd.<br>";
			}
			else if(this.hasExactly("Mercurius")){
				var mVal = 0;
				if(this.rValue < 0 && this.hp / this.maxHp >= 0.5){
					mVal = 4;
				}
				else if(this.rValue > 0 && this.hp / this.maxHp >= 0.25){
					mVal = 6;
				}
				if(mVal > 0){
					this.combatBuffs.atk = Math.max(mVal,this.combatBuffs.atk);
					this.combatBuffs.spd = Math.max(mVal,this.combatBuffs.spd);
					this.combatBuffs.def = Math.max(mVal,this.combatBuffs.def);
					this.combatBuffs.res = Math.max(mVal,this.combatBuffs.res);
					buffText += this.name + " activates " + skillName + " and gains +" + mVal + " to all stats.<br>";
				}
			}
			else if(this.hasExactly("Eternal Breath") && (this.toggle.weapon == 1 || this.toggle.weapon == 3)){
				this.combatBuffs.atk = Math.max(5,this.combatBuffs.atk);
				this.combatBuffs.spd = Math.max(5,this.combatBuffs.spd);
				this.combatBuffs.def = Math.max(5,this.combatBuffs.def);
				this.combatBuffs.res = Math.max(5,this.combatBuffs.res);
				buffText += this.name + " activates " + skillName + " and gains +5 to all stats.<br>";
			}
			else if(this.hasExactly("Grima's Truth") && this.rValue > 0 && this.toggle.weapon == 1){
				this.combatBuffs.atk = Math.max(5,this.combatBuffs.atk);
				this.combatBuffs.spd = Math.max(5,this.combatBuffs.spd);
				this.combatBuffs.res = Math.max(5,this.combatBuffs.res);
				buffText += this.name + " activates " + skillName + " and gains +5 to atk/spd/res.<br>";
			}
			else if(this.hasExactly("Masking Axe") && this.rValue == 5 && this.toggle.weapon == 1){
				this.combatBuffs.atk = Math.max(6,this.combatBuffs.atk);
				this.combatBuffs.def = Math.max(6,this.combatBuffs.def);
				buffText += this.name + " activates " + skillName + " and gains +6 to atk and def.<br>";
			}
			else if(this.hasExactly("Punishment Staff") && this.rValue == 5 && this.toggle.weapon == 1){
				this.combatBuffs.atk = Math.max(6,this.combatBuffs.atk);
				this.bonus.caff = true;
				buffText += this.name + " activates " + skillName + " and gains +6 to atk and Cancel Affinity Bonus.<br>";
			}
			else if(this.hasExactly("Laevatein") && this.rValue == 5 && (this.toggle.weapon == 2 || this.toggle.weapon == 3)){
				this.combatBuffs.atk = Math.max(6,this.combatBuffs.atk);
				this.combatBuffs.def = Math.max(6,this.combatBuffs.def);
				buffText += this.name + " activates " + skillName + " and gains +6 to atk and def.<br>";
			}
			else if(this.hasExactly("Wolf Berg") && this.rValue > 0 && (this.toggle.weapon == 1 || this.toggle.weapon == 3)){
				this.combatBuffs.atk = Math.max(6,this.combatBuffs.atk);
				this.combatBuffs.spd = Math.max(6,this.combatBuffs.spd);
				this.combatBuffs.def = Math.max(6,this.combatBuffs.def);
				this.combatBuffs.res = Math.max(6,this.combatBuffs.res);
				buffText += this.name + " activates " + skillName + " and gains +6 to all stats.<br>";
			}
			else if(this.hasExactly("Tome of Reason") && (this.toggle.weapon == 1 || this.toggle.weapon == 3)){
				this.combatBuffs.def = Math.max(6,this.combatBuffs.def);
				this.combatBuffs.res = Math.max(6,this.combatBuffs.res);
				buffText += this.name + " activates " + skillName + " and gains +6 to def and res.<br>";
			}
			else if(this.hasExactly("Azure Lance") && this.rValue == 5 && this.toggle.weapon > 1){
				this.combatBuffs.atk = Math.max(6,this.combatBuffs.atk);
				this.combatBuffs.spd = Math.max(6,this.combatBuffs.spd);
				buffText += this.name + " activates " + skillName + " and gains +6 to atk and spd.<br>";
			}
			else if(this.hasExactly("Vedrfolnir's Egg") && this.rValue == 5 && this.toggle.weapon == 1){
				this.combatBuffs.atk = Math.max(6,this.combatBuffs.atk);
				this.combatBuffs.spd = Math.max(6,this.combatBuffs.spd);
				buffText += this.name + " activates " + skillName + " and gains +6 to atk and spd.<br>";
			}
			else if(this.hasExactly("Sharp War Sword") && this.toggle.weapon == 1){
				this.bonus.dodge = true;
				this.bonus.nfus = true;
				buffText += this.name + " activates " + skillName + " and gains NFU > Spd and Dodge Bonus.<br>";
			}
			else if(this.hasExactly("Fiery Bolganone") && (this.toggle.weapon == 1 || this.toggle.weapon == 3)){
				this.bonus.dominance = true;
				buffText += this.name + " activates " + skillName + " and gains Dominance Bonus.<br>";
			}
			else if(this.hasExactly("Shadow Breath")){
				this.combatBuffs.atk = Math.max(6,this.combatBuffs.atk);
				this.combatBuffs.res = Math.max(6,this.combatBuffs.res);
				this.bonus.enGarde = true;
				buffText += this.name + " activates " + skillName + " and gains En Garde Bonus and +6 to atk & res.<br>";
			}
			else if(this.hasExactly("Silent Power") && this.toggle.weapon == 1){
				this.bonus.nfus = true;
				buffText += this.name + " activates " + skillName + " and gains NFU > Spd Bonus.<br>";
			}
			else if(this.hasExactly("Icy Maltet") && this.dragonflower > 9){
				this.combatBuffs.atk = Math.max(6,this.combatBuffs.atk);
				this.combatBuffs.def = Math.max(6,this.combatBuffs.def);
				buffText += this.name + " activates " + skillName + " and gains +6 to atk and def.<br>";
			}
			else if(this.hasExactly("Wolfpup Fang") && this.rValue == 5 && this.toggle.weapon > 1){
				this.combatBuffs.atk = Math.max(6,this.combatBuffs.atk);
				this.combatBuffs.spd = Math.max(6,this.combatBuffs.spd);
				this.bonus.dull = true;
				buffText += this.name + " activates " + skillName + " and gains +6 to atk & spd and gains Lull All Bonus.<br>";
			}
			else if(this.hasExactly("Ebon Bolverk") && this.toggle.weapon == 1){
				var ebText = "";
				this.bonus.nfus = true;
				this.bonus.breathB = true;
				if(this.rValue > 0){
					this.combatBuffs.atk = Math.max(6,this.combatBuffs.atk);
					this.combatBuffs.spd = Math.max(6,this.combatBuffs.spd);
					ebText = " gains +6 to atk & spd";
				}
				buffText += this.name + " activates " + skillName + " and" + ebText + " gains NFU > Spd Bonus and CD +1 per Attack Bonus.<br>";
			}
			else if(this.hasExactly("Inner Wellspring") && this.toggle.weapon == 1){
				this.bonus.nfus = true;
				buffText += this.name + " activates " + skillName + " and gains NFU > Spd Bonus.<br>";
			}
			else if(this.hasExactly("Wind Genesis") && this.hp / this.maxHp >= 0.25){
				this.combatBuffs.atk = Math.max(6,this.combatBuffs.atk);
				this.combatBuffs.spd = Math.max(6,this.combatBuffs.spd);
				this.bonus.despacito = true;
				buffText += this.name + " activates " + skillName + " and gains +6 to atk & spd and gains Desperation Bonus.<br>";
			}
			else if(this.hasExactly("Ardent Durandal") && this.rValue > 0){
				this.bonus.bDoubler = true;
				buffText += this.name + " activates " + skillName + " and gains Bonus Doubler Bonus.<br>";
			}
			else if((this.hasExactly("Coyote's Lance") || this.hasExactly("Crimean Scepter")) && (this.toggle.weapon == 1 || this.toggle.weapon == 3)){
				this.combatBuffs.atk = Math.max(6,this.combatBuffs.atk);
				this.combatBuffs.spd = Math.max(6,this.combatBuffs.spd);
				this.bonus.autoD = true;
				buffText += this.name + " activates " + skillName + " and gains +6 atk & spd and Auto Follow-Up Bonus.<br>";
			}
			else if(this.hasExactly("Oracle's Breath") && this.rValue == 5 && this.toggle.weapon > 1){
				this.combatBuffs.def = Math.max(6,this.combatBuffs.def);
				this.combatBuffs.res = Math.max(6,this.combatBuffs.res);
				this.bonus.breathB = true;
				buffText += this.name + " activates " + skillName + " and gains +6 def & res and CD +1 per Atk Bonus.<br>";
			}
			else if(this.hasExactly("Seidr") && this.toggle.weapon == 1){
				this.bonus.stopD = true;
				buffText += this.name + " activates " + skillName + " and gains Deny Follow-Up Bonus.<br>";
			}
			else if(this.hasExactly("Cunning Bow") && this.rValue == 5 && this.toggle.weapon > 1){
				this.combatBuffs.atk = Math.max(6,this.combatBuffs.atk);
				buffText += this.name + " activates " + skillName + " and gains 6 atk.<br>";
			}
			else if(this.hasExactly("Crow's Crystal") && this.hp / this.maxHp >= 0.25){
				this.bonus.despacito = true;
				this.bonus.dominance = true;
				buffText += this.name + " activates " + skillName + " and gains Desperation and Dominance Bonus.<br>";
			}
			else if(this.hasExactly("Guide's Hourglass") && this.toggle.weapon == 1){
				this.bonus.dodge = true;
				buffText += this.name + " activates " + skillName + " and gains Dodge Bonus.<br>";
			}
			else if(this.hasExactly("Celestial Globe") && this.toggle.weapon == 1){
				this.bonus.nfus = true;
				buffText += this.name + " activates " + skillName + " and gains NFU > Spd Bonus.<br>";
			}
			else if(this.has("Magical Lantern") && this.toggle.weapon == 1){
				this.bonus.breathB = true;
				buffText += this.name + " activates " + skillName + " and gains CD +1 per Atk Bonus.<br>";
			}
			else if(this.hasExactly("Brilliant Starlight") && this.hp / this.maxHp >= 0.25){
				this.combatBuffs.def = Math.max(6,this.combatBuffs.def);
				this.combatBuffs.res = Math.max(6,this.combatBuffs.res);
				this.bonus.starlight = true;
				buffText += this.name + " activates " + skillName + " and gains +6 def & res and 80% AOE DR Bonus.<br>";
			}
			else if(this.hasExactly("Master's Tactics") && this.hp / this.maxHp >= 0.25){
				this.combatDebuffs.atk = Math.min(-4, this.combatDebuffs.atk);
				this.combatDebuffs.spd = Math.min(-4, this.combatDebuffs.spd);
				this.combatDebuffs.def = Math.min(-4, this.combatDebuffs.def);
				this.combatDebuffs.res = Math.min(-4, this.combatDebuffs.res);
				buffText += this.name + " activates " + skillName + " and gains Grand Strategy Bonus and applies -4 to all stats.<br>";
			}
			else if(this.hasExactly("Saintly Seraphim") && this.rValue == 5 && this.toggle.weapon > 0){
				this.bonus.breathB = true;
				buffText += this.name + " activates " + skillName + " and gains CD +1 per Atk Bonus.<br>";
			}
			else if(this.hasExactly("Mystic War Staff") && (this.toggle.weapon == 1 || this.toggle.weapon == 3)){
				this.combatBuffs.def = Math.max(6,this.combatBuffs.def);
				this.combatBuffs.res = Math.max(6,this.combatBuffs.res);
				this.bonus.stopD = true;
				buffText += this.name + " activates " + skillName + " and gains +6 def & res and Deny Follow-Up Bonus.<br>";
			}
			else if(this.hasExactly("Ilian Merc Lance") && (this.toggle.weapon == 1 || this.toggle.weapon == 3)){
				this.bonus.dodge = true;
				this.bonus.dull = true;
				buffText += this.name + " activates " + skillName + " and gains Dodge and Lull All Bonus.<br>";
			}
			else if(this.hasExactly("Desert-Tiger Axe")){
				this.combatBuffs.atk = Math.max(6,this.combatBuffs.atk);
				this.combatBuffs.spd = Math.max(6,this.combatBuffs.spd);
				this.bonus.nPenalty = true;
				this.bonus.nullPanic = true;
				buffText += this.name + " activates " + skillName + " and gains +6 atk & spd, Null Penalty Bonus, and Null Panic Bonus.<br>";
			}
			else if(this.hasExactly("Tome of Luxuries") && this.hp / this.maxHp >= 0.25){
				this.bonus.autoD = true;
				buffText += this.name + " activates " + skillName + " and gains Auto Follow-Up Bonus.<br>";
			}
			else if(this.hasExactly("Winds of Silesse") && this.rValue == 5 && this.hp / this.maxHp >= 0.25){
				this.combatBuffs.atk = Math.max(6,this.combatBuffs.atk);
				this.combatBuffs.spd = Math.max(6,this.combatBuffs.spd);
				this.bonus.despacito = true;
				this.bonus.breathB = true;
				buffText += this.name + " activates " + skillName + " and gains +6 atk & spd, Desperation, and CD +1 per Atk Bonus.<br>";
			}
			else if((this.hasExactly("Playful Pinwheel") || this.has("Whitewind Bow") || this.has("Lucrative Bow") || this.has("Gainful Dagger")) && this.hp / this.maxHp >= 0.25){
				this.bonus.nullPanic = true;
				this.bonus.nfus = true;
				buffText += this.name + " activates " + skillName + " and gains NFU > Spd & Null Panic Bonus.<br>";
			}
			else if(this.has("Wind Tribe Club") && this.hp / this.maxHp >= 0.25){
				this.bonus.nullPanic = true;
				this.bonus.autoD = true;
				buffText += this.name + " activates " + skillName + " and gains Auto Follow-Up & Null Panic Bonus.<br>";
			}
			else if(this.hasExactly("Heired Forseti") && this.hp / this.maxHp >= 0.25){
				this.combatBuffs.atk = Math.max(6,this.combatBuffs.atk);
				this.combatBuffs.spd = Math.max(6,this.combatBuffs.spd);
				buffText += this.name + " activates " + skillName + " and gains +6 to atk & spd.<br>";
			}
			else if((this.hasExactly("Heired Gungnir") || this.has("Tropical Conch")) && this.hp / this.maxHp >= 0.25){
				this.combatBuffs.atk = Math.max(6,this.combatBuffs.atk);
				this.combatBuffs.def = Math.max(6,this.combatBuffs.def);
				buffText += this.name + " activates " + skillName + " and gains +6 to atk & def.<br>";
			}
			else if((this.has("Pumpkin Stem") || this.has("Doubler Bow")) && (this.buddy.adjacent > 0 || this.buddy.two > 0) && (this.toggle.weapon == 1 || this.toggle.weapon == 3)){
				this.combatBuffs.atk = Math.max(6,this.combatBuffs.atk);
				this.combatBuffs.res = Math.max(6,this.combatBuffs.res);
				buffText += this.name + " activates " + skillName + " and gains +6 to atk & res.<br>";
			}
			else if(this.hasExactly("Payday Pouch") && (this.buddy.adjacent > 0 || this.buddy.two > 0) && (this.toggle.weapon == 1 || this.toggle.weapon == 3)){
				this.bonus.nfus = true;
				var ppText = "";
				if(this.buddy.adjacent > 1 || this.buddy.two > 1){
					this.bonus.bexblade = true;
					ppText = " & Hexblade";
				}
				buffText += this.name + " activates " + skillName + " and gains NFU > Spd" + ppText + " Bonus.<br>";
			}
			else if((this.has("Farmer's Tool") || this.has("Doubler Sword") || this.has("Doubler Lance")) && (this.buddy.adjacent > 0 || this.buddy.two > 0) && (this.toggle.weapon == 1 || this.toggle.weapon == 3)){
				this.combatBuffs.atk = Math.max(6,this.combatBuffs.atk);
				this.combatBuffs.def = Math.max(6,this.combatBuffs.def);
				buffText += this.name + " activates " + skillName + " and gains +6 to atk & def.<br>";
			}
			else if(this.hasExactly("Worldly Lance") && (this.buddy.adjacent > 0 || this.buddy.two > 0) && (this.toggle.weapon == 1 || this.toggle.weapon == 3)){
				this.bonus.dull = true;
				this.combatBuffs.def = Math.max(6,this.combatBuffs.def);
				this.combatBuffs.res = Math.max(6,this.combatBuffs.res);
				buffText += this.name + " activates " + skillName + " and gains +6 to def & res and Lull All Bonus.<br>";
			}
			else if(this.hasExactly("Obscurite") && (this.buddy.adjacent > 0 || this.buddy.two > 0) && (this.toggle.weapon == 1 || this.toggle.weapon == 3)){
				this.bonus.resoB = true;
				this.bonus.resoS = true;
				this.combatBuffs.atk = Math.max(6,this.combatBuffs.atk);
				this.combatBuffs.res = Math.max(6,this.combatBuffs.res);
				buffText += this.name + " activates " + skillName + " and gains +6 to atk & res and Resonance: Blades & Shields Bonus.<br>";
			}
			else if(this.hasExactly("Spy's Shuriken") && this.toggle.weapon > 0){
				this.bonus.nfus = true;
				buffText += this.name + " activates " + skillName + " and gains NFU > Spd Bonus.<br>";
			}
			else if(this.hasExactly("Guarding Lance") && this.toggle.weapon == 1){
				this.combatBuffs.atk = Math.max(6,this.combatBuffs.atk);
				this.combatBuffs.spd = Math.max(6,this.combatBuffs.spd);
				this.combatBuffs.def = Math.max(6,this.combatBuffs.def);
				this.bonus.bDoubler = true;
				this.bonus.penDoubler = true;
				buffText += this.name + " activates " + skillName + " and gains +6 to atk/spd/def and gains Bonus Doubler & Penalty Doubler Bonus.<br>";
			}
			else if(this.hasExactly("Gondul") && this.toggle.weapon == 1 && (this.buddy.adjacent > 0 || this.buddy.two > 0)){
				this.combatBuffs.atk = Math.max(6,this.combatBuffs.atk);
				this.combatBuffs.spd = Math.max(6,this.combatBuffs.spd);
				buffText += this.name + " activates " + skillName + " and gains +6 to atk & spd.<br>";
			}
			else if(this.hasExactly("Corsair Cleaver") && this.toggle.weapon == 1 && (this.buddy.adjacent > 0 || this.buddy.two > 0 || this.buddy.three > 0)){
				this.combatBuffs.atk = Math.max(6,this.combatBuffs.atk);
				this.combatBuffs.def = Math.max(6,this.combatBuffs.def);
				buffText += this.name + " activates " + skillName + " and gains +6 to atk & def.<br>";
			}
			else if(this.hasExactly("Iago's Tome") && this.rValue == 5){
				var remainder = turn % 2;
				if(remainder == 1){
					this.bonus.dull = true;
					this.bonus.stopD = true;
					this.combatBuffs.def = Math.max(6,this.combatBuffs.def);
					this.combatBuffs.res = Math.max(6,this.combatBuffs.res);
					buffText += this.name + " activates " + skillName + " and gains +6 to def & res and Deny Follow-Up & Lull All Bonus.<br>";
				}
				else{
					this.bonus.autoD = true;
					this.bonus.bexblade = true;
					this.combatBuffs.atk = Math.max(6,this.combatBuffs.atk);
					this.combatBuffs.spd = Math.max(6,this.combatBuffs.spd);
					buffText += this.name + " activates " + skillName + " and gains +6 to atk & spd and Auto Follow-Up & Hexblade Bonus.<br>";
				}
			}
			else if(this.hasExactly("Blue Yule Axe") && this.hp / this.maxHp >= 0.25){
				this.combatBuffs.atk = Math.max(6,this.combatBuffs.atk);
				this.combatBuffs.spd = Math.max(6,this.combatBuffs.spd);
				this.bonus.nfus = true;
				buffText += this.name + " activates " + skillName + " and gains +6 to atk & spd and NFU > Spd Bonus.<br>";
			}
			else if(this.hasExactly("Goddess Temari") && this.hp / this.maxHp >= 0.25){
				this.combatBuffs.atk = Math.max(6,this.combatBuffs.atk);
				this.combatBuffs.res = Math.max(6,this.combatBuffs.res);
				this.bonus.stopD = true;
				buffText += this.name + " activates " + skillName + " and gains +6 to atk & res and Deny Follow-Up Bonus.<br>";
			}
			else if(this.hasExactly("Dragoon Axe") && this.rValue == 5 && this.toggle.weapon == 1){
				this.combatBuffs.atk = Math.max(6,this.combatBuffs.atk);
				this.combatBuffs.spd = Math.max(6,this.combatBuffs.spd);
				this.bonus.breathB = true;
				buffText += this.name + " activates " + skillName + " and gains +6 atk & spd and CD +1 per Atk Bonus.<br>";
			}
			else if(this.hasExactly("Blade Royale") && this.toggle.weapon == 1){
				this.combatBuffs.atk = Math.max(6,this.combatBuffs.atk);
				this.combatBuffs.spd = Math.max(6,this.combatBuffs.spd);
				this.bonus.nPenalty = true;
				buffText += this.name + " activates " + skillName + " and gains +6 atk & spd and Null Penalty Bonus.<br>";
			}
			else if(this.hasExactly("Blade of Sands") && this.toggle.weapon == 1){
				this.combatBuffs.spd = Math.max(6,this.combatBuffs.spd);
				this.combatBuffs.res = Math.max(6,this.combatBuffs.res);
				this.bonus.bDoubler = true;
				this.bonus.nullPanic = true;
				buffText += this.name + " activates " + skillName + " and gains +6 spd & res and Bonus Doubler & Null Panic Bonus.<br>";
			}
			else if(this.has("Nabata Beacon") && this.toggle.weapon == 1){
				this.bonus.despacito = true;
				buffText += this.name + " activates " + skillName + " and gains Desperation Bonus.<br>";
			}
			else if(this.has("Nabata Lance") && this.toggle.weapon == 1){
				this.bonus.bexblade = true;
				buffText += this.name + " activates " + skillName + " and gains Hexblade Bonus.<br>";
			}
			else if(this.hasExactly("Penitent Lance") && this.hp / this.maxHp >= 0.25){
				this.bonus.bexblade = true;
				this.bonus.nullPanic = true;
				buffText += this.name + " activates " + skillName + " and gains Hexblade & Null Panic Bonus.<br>";
			}
			else if(this.hasExactly("Brutal Breath") && this.rValue == 5 && this.toggle.weapon == 1){
				this.combatBuffs.atk = Math.max(6,this.combatBuffs.atk);
				this.combatBuffs.spd = Math.max(6,this.combatBuffs.spd);
				this.bonus.dodge = true;
				this.bonus.dull = true;
				buffText += this.name + " activates " + skillName + " and gains +6 to atk & spd and Dodge & Lull All Bonus.<br>";
			}
			else if(this.hasExactly("Sky-Hopper Egg") && this.hp / this.maxHp >= 0.25){
				this.combatBuffs.atk = Math.max(6,this.combatBuffs.atk);
				this.combatBuffs.spd = Math.max(6,this.combatBuffs.spd);
				this.bonus.fSight = true;
				buffText += this.name + " activates " + skillName + " and gains +6 to atk & spd and 1T 40% DR Bonus.<br>";
			}
			else if(this.hasExactly("Pure-Wing Spear") && this.toggle.weapon == 1){
				this.combatBuffs.atk = Math.max(6,this.combatBuffs.atk);
				this.combatBuffs.spd = Math.max(6,this.combatBuffs.spd);
				buffText += this.name + " activates " + skillName + " and gains +6 to atk & spd.<br>";
			}
			else if(this.hasExactly("Lightburst Tome") && this.hp / this.maxHp >= 0.25){
				this.combatBuffs.atk = Math.max(6,this.combatBuffs.atk);
				this.combatBuffs.spd = Math.max(6,this.combatBuffs.spd);
				this.combatBuffs.def = Math.max(6,this.combatBuffs.def);
				buffText += this.name + " activates " + skillName + " and gains +6 to atk/spd/def.<br>";
			}
			else if(this.hasExactly("Astral Breath") && this.rValue > 0 && this.toggle.weapon > 9){
				this.combatBuffs.spd = Math.max(6,this.combatBuffs.spd);
				this.combatBuffs.def = Math.max(6,this.combatBuffs.def);
				this.combatBuffs.res = Math.max(6,this.combatBuffs.res);
				this.bonus.dodge = true;
				buffText += this.name + " activates " + skillName + " and gains +6 to spd/def/res and Dodge Bonus.<br>";
			}
			else if(this.hasExactly("Daniel-Made Bow") && this.rValue == 5 && this.toggle.weapon == 1){
				this.combatBuffs.atk = Math.max(6,this.combatBuffs.atk);
				this.combatBuffs.spd = Math.max(6,this.combatBuffs.spd);
				this.bonus.bexblade = true;
				this.bonus.breathB = true;
				buffText += this.name + " activates " + skillName + " and gains +6 atk & spd and CD +1 per Atk & Hexblade Bonus.<br>";
			}
			else if(this.hasExactly("Heavy War Axe") && this.toggle.weapon == 1){
				this.combatBuffs.atk = Math.max(6,this.combatBuffs.atk);
				this.combatBuffs.def = Math.max(6,this.combatBuffs.def);
				this.bonus.bDoubler = true;
				this.bonus.stopD = true;
				buffText += this.name + " activates " + skillName + " and gains +6 atk & def and Bonus Doubler & Deny Follow-Up Bonus.<br>";
			}
			else if(this.hasExactly("Forager Naginata") && this.toggle.weapon == 1){
				this.combatBuffs.def = Math.max(6,this.combatBuffs.def);
				this.combatBuffs.res = Math.max(6,this.combatBuffs.res);
				this.bonus.breathB = true;
				buffText += this.name + " activates " + skillName + " and gains +6 def & res and CD +1 per Atk Bonus.<br>";
			}
			else if((this.has("Raudrlantern") || this.has("Gronnlantern")) && this.toggle.weapon == 1){
				this.bonus.breathB = true;
				buffText += this.name + " activates " + skillName + " and gains CD +1 per Atk Bonus.<br>";
			}
			else if(this.hasExactly("Tri-Path Splitter") && this.toggle.weapon == 1){
				this.combatBuffs.atk = Math.max(6,this.combatBuffs.atk);
				this.combatBuffs.spd = Math.max(6,this.combatBuffs.spd);
				this.bonus.nfus = true;
				this.bonus.nullPanic = true;
				buffText += this.name + " activates " + skillName + " and gains +6 atk & spd and NFU > Spd & Null Panic Bonus.<br>";
			}
			else if(this.hasExactly("Blood Tome") && this.rValue == 5){
				this.bonus.caff = true;
				buffText += this.name + " activates " + skillName + " and gains Cancel Affinity Bonus.<br>";
			}
			else if(this.hasExactly("Dead-Crow Tome") && this.hp / this.maxHp >= 0.25){
				this.combatBuffs.atk = Math.max(6,this.combatBuffs.atk);
				this.combatBuffs.spd = Math.max(6,this.combatBuffs.spd);
				this.bonus.despacito = true;
				buffText += this.name + " activates " + skillName + " and gains +6 to atk & spd and Desperation Bonus.<br>";
			}
			else if(this.hasExactly("Ereshkigal") && this.hp / this.maxHp >= 0.25){
				this.combatBuffs.atk = Math.max(6,this.combatBuffs.atk);
				this.bonus.essence = true;
				buffText += this.name + " activates " + skillName + " and gains +6 to atk and Essence Drain Bonus.<br>";
			}
			else if(this.hasExactly("Dead-Wolf Blade") && this.hp / this.maxHp >= 0.25){
				this.bonus.penDoubler = true;
				buffText += this.name + " activates " + skillName + " and gains Penalty Doubler Bonus.<br>";
			}
			else if((this.hasExactly("United Bouquet") || this.has("Sea Tambourine")) && this.hp / this.maxHp >= 0.25){
				this.combatBuffs.atk = Math.max(6,this.combatBuffs.atk);
				this.combatBuffs.spd = Math.max(6,this.combatBuffs.spd);
				buffText += this.name + " activates " + skillName + " and gains +6 to atk & spd.<br>";
			}
			else if(this.hasExactly("Apotheosis Spear") && this.rValue > 0 && this.toggle.weapon == 1){
				this.bonus.dodge = true;
				buffText += this.name + " activates " + skillName + " and gains Dodge Bonus.<br>";
			}
			else if(this.hasExactly("Exotic Fruit Juice") && this.rValue == 5){
				this.combatBuffs.atk = Math.max(6,this.combatBuffs.atk);
				this.combatBuffs.spd = Math.max(6,this.combatBuffs.spd);
				this.bonus.bexblade = true;
				buffText += this.name + " activates " + skillName + " and gains +6 to atk & spd and Hexblade Bonus.<br>";
			}
			else if(this.hasExactly("Starpoint Lance") && this.rValue == 5 && this.toggle.weapon > 1){
				this.combatBuffs.atk = Math.max(6,this.combatBuffs.atk);
				this.combatBuffs.spd = Math.max(6,this.combatBuffs.spd);
				this.bonus.breathB = true;
				buffText += this.name + " activates " + skillName + " and gains +6 to atk & spd and CD +1 per Atk Bonus.<br>";
			}
			else if(this.hasExactly("Plegian War Axe") && this.toggle.weapon == 1){
				this.combatBuffs.def = Math.max(6,this.combatBuffs.def);
				this.combatBuffs.res = Math.max(6,this.combatBuffs.res);
				this.bonus.stopD = true;
				buffText += this.name + " activates " + skillName + " and gains +6 to def & res and Deny Follow-Up Bonus.<br>";
			}
			else if(this.hasExactly("Lance of Grado") && this.toggle.weapon == 1){
				this.combatBuffs.def = Math.max(6,this.combatBuffs.def);
				this.combatBuffs.res = Math.max(6,this.combatBuffs.res);
				this.bonus.breathB = true;
				this.bonus.dull = true;
				buffText += this.name + " activates " + skillName + " and gains +6 to def & res and CD +1 per Atk & Lull All Bonus.<br>";
			}
			else if(this.hasExactly("Nidavellir Ballista")){
				this.bonus.bexblade = true;
				buffText += this.name + " activates " + skillName + " and gains Hexblade Bonus.<br>";
			}
			else if(this.hasExactly("Sisterly Axe") && this.toggle.weapon > 9){
				this.combatBuffs.atk = Math.max(6,this.combatBuffs.atk);
				this.combatBuffs.spd = Math.max(6,this.combatBuffs.spd);
				this.bonus.dodge = true;
				buffText += this.name + " activates " + skillName + " and gains +6 to atk & spd and Dodge Bonus.<br>";
			}
			else if((this.hasExactly("Quieting Antler") || this.hasExactly("Delivering Antler")) && this.toggle.weapon == 1){
				this.combatBuffs.atk = Math.max(6,this.combatBuffs.atk);
				this.combatBuffs.def = Math.max(6,this.combatBuffs.def);
				this.bonus.bDoubler = true;
				buffText += this.name + " activates " + skillName + " and gains +6 to atk & def and Bonus Doubler Bonus.<br>";
			}
			else if(this.hasExactly("Summertime Axe") && this.hp / this.maxHp >= 0.25){
				this.combatBuffs.spd = Math.max(6,this.combatBuffs.spd);
				this.combatBuffs.def = Math.max(6,this.combatBuffs.def);
				this.combatBuffs.res = Math.max(6,this.combatBuffs.res);
				this.bonus.nullFlying = true;
				this.bonus.rotten = true;
				buffText += this.name + " activates " + skillName + " and gains +6 to spd/def/res and Null Flying & Reduce DR% by 50% Bonus.<br>";
			}
			else if((this.has("Juicy Bucketful") || this.has("Stall-Game Bow") || this.has("Raudrcrab")) && this.hp / this.maxHp >= 0.25){
				this.combatBuffs.atk = Math.max(6,this.combatBuffs.atk);
				this.bonus.autoD = true;
				buffText += this.name + " activates " + skillName + " and gains +6 to atk and Auto Follow-Up Bonus.<br>";
			}
			else if(this.hasExactly("Majestic Glitnir") && this.toggle.weapon == 1){
				this.combatBuffs.def = Math.max(6,this.combatBuffs.def);
				this.combatBuffs.res = Math.max(6,this.combatBuffs.res);
				buffText += this.name + " activates " + skillName + " and gains +6 to def & res.<br>";
			}
			else if(this.hasExactly("Geirdriful") && this.rValue == 5 && this.toggle.weapon == 1){
				this.bonus.rotten = true;
				this.bonus.dull= true;
				buffText += this.name + " activates " + skillName + " and gains Reduce DR% by 50% & Lull All Bonus.<br>";
			}
			else if(this.hasExactly("Suave Blade") && this.toggle.weapon == 1){
				this.bonus.rotten = true;
				this.bonus.bDoubler = true;
				buffText += this.name + " activates " + skillName + " and gains Reduce DR% by 50% & Bonus Doubler Bonus.<br>";
			}
			else if(this.hasExactly("Praise-Piner Axe") && this.hp / this.maxHp >= 0.25){
				this.combatBuffs.def = Math.max(6,this.combatBuffs.def);
				this.combatBuffs.res = Math.max(6,this.combatBuffs.res);
				this.bonus.dull = true;
				buffText += this.name + " activates " + skillName + " and gains +6 to def & res and Lull All Bonus.<br>";
			}
			else if(this.hasExactly("Caduceus Staff") && this.rValue == 5 && this.toggle.weapon == 1){
				this.combatBuffs.atk = Math.max(6,this.combatBuffs.atk);
				this.combatBuffs.res = Math.max(6,this.combatBuffs.res);
				this.bonus.breathB = true;
				buffText += this.name + " activates " + skillName + " and gains +6 atk & res and CD +1 per Atk Bonus.<br>";
			}
			else if((this.hasExactly("Vedrfolnir's Edge") || (this.hasExactly("Talregan Axe") && this.rValue == 5)) && this.toggle.weapon == 1){
				this.combatBuffs.atk = Math.max(6,this.combatBuffs.atk);
				this.combatBuffs.spd = Math.max(6,this.combatBuffs.spd);
				this.bonus.nfus = true;
				buffText += this.name + " activates " + skillName + " and gains +6 to atk & spd and NFU > Spd Bonus.<br>";
			}
			else if(this.hasExactly("Aureola") && this.rValue == 5 && this.toggle.weapon == 1){
				this.combatBuffs.spd = Math.max(6,this.combatBuffs.spd);
				this.combatBuffs.res = Math.max(6,this.combatBuffs.res);
				this.bonus.nPenalty = true;
				buffText += this.name + " activates " + skillName + " and gains +6 spd & res and Null Penalty Bonus.<br>";
			}
			else if(this.hasExactly("Auto-Lofnheidr") && this.rValue == 5 && this.hp / this.maxHp >= 0.25){
				this.bonus.incited = true;
				buffText += this.name + " activates " + skillName + " and gains Incited Bonus.<br>";
			}
			else if(this.hasExactly("Scroll of Curses") && this.hp / this.maxHp >= 0.25){
				this.combatBuffs.atk = Math.max(6,this.combatBuffs.atk);
				this.combatBuffs.spd = Math.max(6,this.combatBuffs.spd);
				this.bonus.anathema = true;
				this.bonus.breathB = true;
				buffText += this.name + " activates " + skillName + " and gains +6 to atk & spd and Anathema & CD +1 per Atk Bonus.<br>";
			}
			else if(this.hasExactly("Arcane Truthfire") && this.hp / this.maxHp >= 0.25){
				this.combatBuffs.atk = Math.max(6,this.combatBuffs.atk);
				buffText += this.name + " activates " + skillName + " and gains +6 to atk.<br>";
			}
			else if(this.hasExactly("Thunderbrand") && this.rValue > 0 && this.hp / this.maxHp >= 0.25){
				this.combatBuffs.atk = Math.max(6,this.combatBuffs.atk);
				this.combatBuffs.spd = Math.max(6,this.combatBuffs.spd);
				this.bonus.treachery = true;
				buffText += this.name + " activates " + skillName + " and gains +6 to atk & spd and Treachery Bonus.<br>";
			}
			else if(this.hasExactly("Spear") && this.hp / this.maxHp >= 0.25){
				this.combatBuffs.atk = Math.max(6,this.combatBuffs.atk);
				this.combatBuffs.def = Math.max(6,this.combatBuffs.def);
				this.bonus.nullFlying = true;
				this.bonus.dull = true;
				buffText += this.name + " activates " + skillName + " and gains +6 to atk & def, Null Flying, and Lull All Bonus.<br>";
			}
			else if(this.hasExactly("Red-Fist Blades") && this.hp / this.maxHp >= 0.25){
				this.combatBuffs.atk = Math.max(6,this.combatBuffs.atk);
				this.combatBuffs.spd = Math.max(6,this.combatBuffs.spd);
				this.bonus.incited = true;
				this.bonus.breathB = true;
				buffText += this.name + " activates " + skillName + " and gains +6 to atk & spd, Incited, and CD +1 per Atk Bonus.<br>";
			}
			else if(this.hasExactly("Lady's Bow") && this.toggle.weapon == 1){
				this.combatBuffs.atk = Math.max(6,this.combatBuffs.atk);
				this.combatBuffs.spd = Math.max(6,this.combatBuffs.spd);
				this.bonus.preempt = true;
				this.bonus.despacito = true;
				buffText += this.name + " activates " + skillName + " and gains +6 to atk & spd, Desperation and Preempt Pulse Bonus.<br>";
			}
			else if(this.hasExactly("Fimbulvetr Morn") && this.rValue == 5 && this.hp / this.maxHp >= 0.25){
				this.combatBuffs.atk = Math.max(6,this.combatBuffs.atk);
				this.combatBuffs.res = Math.max(6,this.combatBuffs.res);
				this.bonus.bDoubler = true;
				this.bonus.essence = true;
				buffText += this.name + " activates " + skillName + " and gains +6 to atk & res, Essence Drain, and Bonus Doubler Bonus.<br>";
			}
			else if(this.hasExactly("Divine Yewfelle") && this.toggle.weapon == 1){
				this.combatBuffs.atk = Math.max(6,this.combatBuffs.atk);
				this.combatBuffs.spd = Math.max(6,this.combatBuffs.spd);
				this.bonus.incited = true;
				buffText += this.name + " activates " + skillName + " and gains +6 to atk & spd and Incited Bonus.<br>";
			}
			else if(this.hasExactly("Sword of Isaach") && this.hp / this.maxHp >= 0.25){
				this.combatBuffs.atk = Math.max(6,this.combatBuffs.atk);
				this.combatBuffs.spd = Math.max(6,this.combatBuffs.spd);
				this.bonus.pfollow = true;
				this.bonus.dull = true;
				buffText += this.name + " activates " + skillName + " and gains +6 to atk & spd, Potent Follow, and Lull All Bonus.<br>";
			}
			else if(this.hasExactly("Aerial Longsword") && this.toggle.weapon == 1){
				this.combatBuffs.atk = Math.max(6,this.combatBuffs.atk);
				this.combatBuffs.spd = Math.max(6,this.combatBuffs.spd);
				this.bonus.nfus = true;
				this.bonus.nPenalty = true;
				buffText += this.name + " activates " + skillName + " and gains +6 atk & spd and NFU > Spd & Null Penalty Bonus.<br>";
			}
			else if(this.hasExactly("Frostfire Breath") && this.rValue == 5 && this.toggle.weapon == 1){
				this.combatBuffs.def = Math.max(6,this.combatBuffs.def);
				this.combatBuffs.res = Math.max(6,this.combatBuffs.res);
				this.bonus.bDoubler = true;
				this.bonus.nullPanic = true;
				buffText += this.name + " activates " + skillName + " and gains +6 def & res and Bonus Doubler & Null Panic Bonus.<br>";
			}
			else if(this.hasExactly("Lion's Heart") && this.toggle.weapon == 1){
				this.bonus.breathB = true;
				this.bonus.nPenalty = true;
				buffText += this.name + " activates " + skillName + " and gains CD +1 per Atk & Null Penalty Bonus.<br>";
			}
			else if(this.hasExactly("Deer's Heart") && this.toggle.weapon == 1){
				this.bonus.nfus = true;
				this.bonus.preempt = true;
				buffText += this.name + " activates " + skillName + " and gains NFU > Spd & Preempt Pulse Bonus.<br>";
			}
			else if(this.hasExactly("Salvage") && this.toggle.weapon == 1){
				this.combatBuffs.atk = Math.max(6,this.combatBuffs.atk);
				this.combatBuffs.spd = Math.max(6,this.combatBuffs.spd);
				buffText += this.name + " activates " + skillName + " and gains +6 atk & spd.<br>";
			}
			else if(this.hasExactly("Staff of the Saint") && this.rValue > 0){
				this.combatBuffs.def = Math.max(6,this.combatBuffs.def);
				this.combatBuffs.res = Math.max(6,this.combatBuffs.res);
				this.bonus.bDoubler = true;
				buffText += this.name + " activates " + skillName + " and gains +6 def & res and Bonus Doubler Bonus.<br>";
			}
			else if(this.hasExactly("Sparking Tome") && this.rValue == 5 && this.toggle.weapon == 1){
				this.combatBuffs.atk = Math.max(6,this.combatBuffs.atk);
				this.combatBuffs.spd = Math.max(6,this.combatBuffs.spd);
				this.bonus.rotten = true;
				buffText += this.name + " activates " + skillName + " and gains +6 atk & spd and Reduce DR% by 50% Bonus.<br>";
			}
			else if(this.hasExactly("Twin Star Axe") && this.rValue == 5 && this.toggle.weapon == 1){
				this.combatBuffs.atk = Math.max(6,this.combatBuffs.atk);
				this.combatBuffs.def = Math.max(6,this.combatBuffs.def);
				this.bonus.dull = true;
				this.bonus.nullPanic = true;
				buffText += this.name + " activates " + skillName + " and gains +6 atk & def and Lull All & Null Panic Bonus.<br>";
			}
			else if(this.hasExactly("Kia Staff") && this.rValue > 0 && this.toggle.weapon == 1){
				this.combatBuffs.atk = Math.max(6,this.combatBuffs.atk);
				this.combatBuffs.spd = Math.max(6,this.combatBuffs.spd);
				this.bonus.bexblade = true;
				buffText += this.name + " activates " + skillName + " and gains +6 atk & spd and Hexblade Bonus.<br>";
			}
			else if(this.hasExactly("Arcane Medusa") && this.hp / this.maxHp >= 0.25){
				this.bonus.anathema = true;
				buffText += this.name + " activates " + skillName + " and gains Anathema Bonus.<br>";
			}
			else if(this.has("Hexblade Sword") && this.toggle.weapon == 1){
				this.bonus.bexblade = true;
				buffText += this.name + " activates " + skillName + " and gains Hexblade Bonus.<br>";
			}
			else if(this.hasExactly("True-Bond Bow") && this.toggle.weapon == 1){
				this.talent.atk += 2;
				this.talent.atk = Math.min(this.talent.atk, 10);
				this.talent.spd += 2;
				var sMax = 10;
				if(this.hasExactly("Speedtaker 3")){
					sMax = 15;
				}
				else if(this.hasExactly("Speedtaker 4")){
					sMax = 20;
				}
				this.talent.spd = Math.min(this.talent.spd, sMax);
				buffText += this.name + " activates " + skillName + " and gains +2 atk & spd [Great Talent].<br>";
			}
			else if(this.hasExactly("Azure Twin Edge") && this.toggle.weapon == 1){
				this.bonus.breathB = true;
				buffText += this.name + " activates " + skillName + " and gains CD +1 per Atk Bonus.<br>";
			}
			else if(this.hasExactly("Tome of Fury") && this.rValue == 5 && this.toggle.weapon == 1){
				this.combatBuffs.atk = Math.max(6,this.combatBuffs.atk);
				this.combatBuffs.res = Math.max(6,this.combatBuffs.res);
				this.bonus.dull = true;
				this.bonus.bexblade = true;
				buffText += this.name + " activates " + skillName + " and gains +6 atk & res and Lull All & Hexblade Bonus.<br>";
			}
			else if(this.hasExactly("Baton of Dusk") && this.hp / this.maxHp >= 0.25){
				this.combatBuffs.atk = Math.max(6,this.combatBuffs.atk);
				this.combatBuffs.spd = Math.max(6,this.combatBuffs.spd);
				this.bonus.treachery = true;
				this.bonus.breathB = true;
				buffText += this.name + " activates " + skillName + " and gains +6 to atk & spd, Treachery, and CD +1 per Atk Bonus.<br>";
			}
			else if(this.hasExactly("Ancient Voice") && this.toggle.weapon == 1){
				this.combatBuffs.spd = Math.max(6,this.combatBuffs.spd);
				this.combatBuffs.def = Math.max(6,this.combatBuffs.def);
				this.bonus.nPenalty = true;
				buffText += this.name + " activates " + skillName + " and gains +6 spd & def and Null Penalty Bonus.<br>";
			}
		}
		//Add Shining Emblem to selfbuffskills if another one shows up and change condition
		if(this.specialIndex != -1 && this.hasExactly("Shining Emblem") && (this.buddy.adjacent > 0 || this.buddy.two > 0)){
			skillName = data.skills[this.specialIndex].name;
			this.combatBuffs.atk = Math.max(6,this.combatBuffs.atk);
			this.combatBuffs.spd = Math.max(6,this.combatBuffs.spd);
			this.combatBuffs.def = Math.max(6,this.combatBuffs.def);
			this.combatBuffs.res = Math.max(6,this.combatBuffs.res);
			buffText += this.name + " activates " + skillName + " and gains +6 to all stats.<br>";
		}
		if(this.specialIndex != -1 && this.hasExactly("Holy-Knight 2")){
			this.bonus.fSight = true;
			skillName = data.skills[this.specialIndex].name;
			buffText += this.name + " activates " + skillName + " and gains 1T 40% DR Bonus.<br>";
		}
		if(this.specialIndex != -1 && this.hasExactly("Makings of a King")){
			this.talent.atk += 2;
			this.talent.atk = Math.min(this.talent.atk, 20);
			this.talent.def += 2;
			this.talent.def = Math.min(this.talent.def, 20);
			this.talent.res += 2;
			this.talent.res = Math.min(this.talent.res, 20);
			skillName = data.skills[this.specialIndex].name;
			buffText += this.name + " activates " + skillName + " and gains +2 atk/def/res [Great Talent].<br>";
		}
		if(this.specialIndex != -1 && this.hasExactly("The Fire Emblem") && this.toggle.special > 9){
			skillName = data.skills[this.specialIndex].name;
			this.combatBuffs.atk = Math.max(7,this.combatBuffs.atk);
			this.combatBuffs.spd = Math.max(7,this.combatBuffs.spd);
			this.combatBuffs.def = Math.max(7,this.combatBuffs.def);
			this.combatBuffs.res = Math.max(7,this.combatBuffs.res);
			this.bonus.fEmblem = true;
			this.bonus.nullPanic = true;
			buffText += this.name + " activates " + skillName + " and gains +7 to all stats, Fire Emblem, and Null Panic Bonus.<br>";
		}
		
		if(this.aIndex != -1 && data.selfBuffSkills.indexOf(data.skills[this.aIndex].name) != -1){
			skillName = data.skills[this.aIndex].name;
			if((this.hasExactly("Atk Spd Hexblade") || this.hasExactly("Spd Res Hexblade"))  && this.toggle.a == 1){
				this.bonus.bexblade = true;
				buffText += this.name + " activates " + skillName + " and gains Hexblade Bonus.<br>";
			}
		}
		if(this.bIndex != -1 && data.selfBuffSkills.indexOf(data.skills[this.bIndex].name) != -1){
			skillName = data.skills[this.bIndex].name;
			if(this.has("Def Res Link") && this.toggle.b == 1){
				var buffVal = this.has("Def Res Link")*2;
				buffVal = Math.min(buffVal,6);
				this.combatBuffs.def = Math.max(buffVal,this.combatBuffs.def);
				this.combatBuffs.res = Math.max(buffVal,this.combatBuffs.res);
				buffText += this.name + " activates " + skillName + " and gains +" + buffVal + " def & res.<br>";
			}
			else if(this.has("Atk Def Link") && this.toggle.b == 1){
				var buffVal = this.has("Atk Def Link")*2;
				buffVal = Math.min(buffVal,6);
				this.combatBuffs.atk = Math.max(buffVal,this.combatBuffs.atk);
				this.combatBuffs.def = Math.max(buffVal,this.combatBuffs.def);
				buffText += this.name + " activates " + skillName + " and gains +" + buffVal + " atk & def.<br>";
			}
			else if(this.has("Spd Res Link") && this.toggle.b == 1){
				var buffVal = this.has("Spd Res Link")*2;
				buffVal = Math.min(buffVal,6);
				this.combatBuffs.spd = Math.max(buffVal,this.combatBuffs.spd);
				this.combatBuffs.res = Math.max(buffVal,this.combatBuffs.res);
				buffText += this.name + " activates " + skillName + " and gains +" + buffVal + " spd & res.<br>";
			}
			else if(this.has("Atk Spd Link") && (this.toggle.b == 1 || this.toggle.b == 3)){
				var buffVal = this.has("Atk Spd Link")*2;
				buffVal = Math.min(buffVal,6);
				this.combatBuffs.atk = Math.max(buffVal,this.combatBuffs.atk);
				this.combatBuffs.spd = Math.max(buffVal,this.combatBuffs.spd);
				buffText += this.name + " activates " + skillName + " and gains +" + buffVal + " atk & spd.<br>";
			}
			else if(this.has("Atk Res Link") && this.toggle.b == 1){
				var buffVal = this.has("Atk Res Link")*2;
				buffVal = Math.min(buffVal,6);
				this.combatBuffs.atk = Math.max(buffVal,this.combatBuffs.atk);
				this.combatBuffs.res = Math.max(buffVal,this.combatBuffs.res);
				buffText += this.name + " activates " + skillName + " and gains +" + buffVal + " atk & res.<br>";
			}
			else if(this.has("Spd Def Link") && (this.toggle.b == 1 || this.toggle.b == 3)){
				var buffVal = this.has("Spd Def Link")*2;
				buffVal = Math.min(buffVal,6);
				this.combatBuffs.spd = Math.max(buffVal,this.combatBuffs.spd);
				this.combatBuffs.def = Math.max(buffVal,this.combatBuffs.def);
				buffText += this.name + " activates " + skillName + " and gains +" + buffVal + " spd & def.<br>";
			}
			else if(this.hasExactly("Spoil Rotten") && this.hp / this.maxHp >= 0.25){
				this.bonus.rotten = true;
				buffText += this.name + " activates " + skillName + " and gains Reduce DR% by 50% Bonus.<br>";
			}
			else if(this.hasExactly("According to Plan") && this.hp / this.maxHp >= 0.25){
				this.combatBuffs.atk = Math.max(6,this.combatBuffs.atk);
				this.combatBuffs.spd = Math.max(6,this.combatBuffs.spd);
				buffText += this.name + " activates " + skillName + " and gains +6 to atk & spd.<br>";
			}
			else if(this.has("Speedtaker")){
				this.talent.spd += 1;
				var sMax = this.has("Speedtaker") * 5;
				this.talent.spd = Math.min(this.talent.spd, sMax);
				buffText += this.name + " activates " + skillName + " and gains +1 spd [Great Talent].<br>";
			}
			else if(this.hasExactly("Tut-Tut") && this.hp / this.maxHp >= 0.25){
				this.combatBuffs.atk = Math.max(6,this.combatBuffs.atk);
				this.combatBuffs.spd = Math.max(6,this.combatBuffs.spd);
				this.bonus.rotten = true;
				buffText += this.name + " activates " + skillName + " and gains +6 to atk & spd and Reduce DR% by 50% Bonus.<br>";
			}
		}
		if(this.cIndex != -1){
			skillName = data.skills[this.cIndex].name;
			var remainder = turn % 2;
			var stat = "";
			if(data.selfBuffSkills.indexOf(skillName) != -1){
				if(this.hasExactly("With Everyone") && this.toggle.c == 1){
					var buffVal = 5;
					this.combatBuffs.def = Math.max(buffVal,this.combatBuffs.def);
					this.combatBuffs.res = Math.max(buffVal,this.combatBuffs.res);
					buffText += this.name + " activates " + skillName + " and gains +" + buffVal + " def and res.<br>";
				}
				else if(this.hasExactly("With Everyone 2") && this.toggle.c == 1){
					var buffVal = 6;
					this.combatBuffs.def = Math.max(buffVal,this.combatBuffs.def);
					this.combatBuffs.res = Math.max(buffVal,this.combatBuffs.res);
					buffText += this.name + " activates " + skillName + " and gains +" + buffVal + " def and res.<br>";
				}
				else if(this.hasExactly("Joint Hone Spd") && this.toggle.c == 1){
					this.combatBuffs.spd = Math.max(5,this.combatBuffs.spd);
					buffText += this.name + " activates " + skillName + " and gains +5 spd.<br>";
				}
				else if(this.hasExactly("Joint Hone Atk") && this.toggle.c == 1){
					this.combatBuffs.atk = Math.max(5,this.combatBuffs.atk);
					buffText += this.name + " activates " + skillName + " and gains +5 atk.<br>";
				}
				else if(this.hasExactly("Joint Hone Def") && this.toggle.c == 1){
					this.combatBuffs.def = Math.max(5,this.combatBuffs.def);
					buffText += this.name + " activates " + skillName + " and gains +5 def.<br>";
				}
				else if(this.hasExactly("Joint Hone Res") && this.toggle.c == 1){
					this.combatBuffs.res = Math.max(5,this.combatBuffs.res);
					buffText += this.name + " activates " + skillName + " and gains +5 res.<br>";
				}
				else if((this.hasExactly("Human Virtue") && this.toggle.c == 1) || (this.hasExactly("Faith in Humanity") && (this.toggle.c == 1 || this.toggle.c == 3)) || (this.hasExactly("Human Virtue 2") && this.toggle.c == 1)){
					var buffVal = 6;
					this.combatBuffs.atk = Math.max(buffVal,this.combatBuffs.atk);
					this.combatBuffs.spd = Math.max(buffVal,this.combatBuffs.spd);
					buffText += this.name + " activates " + skillName + " and gains +" + buffVal + " atk and spd.<br>";
				}
				else if(this.hasExactly("Solitary Dream") && this.toggle.c == 1){
					var buffVal = 4;
					this.combatBuffs.atk = Math.max(buffVal,this.combatBuffs.atk);
					this.combatBuffs.spd = Math.max(buffVal,this.combatBuffs.spd);
					this.combatBuffs.def = Math.max(buffVal,this.combatBuffs.def);
					this.combatBuffs.res = Math.max(buffVal,this.combatBuffs.res);
					buffText += this.name + " activates " + skillName + " and gains +" + buffVal + " to all stats and can move 1 extra space.<br>";
				}
				else if(this.hasSlot("Rouse Atk Def","c") && this.toggle.c == 1){
					var panicText = "";
					var buffVal = this.hasSlot("Rouse Atk Def","c") * 2;
					if(this.hasExactly("Rouse Atk Def 4")){
						buffVal = 6;
						this.bonus.nullPanic = true;
						panicText = " and Null Panic";
					}
					this.combatBuffs.atk = Math.max(buffVal,this.combatBuffs.atk);
					this.combatBuffs.def = Math.max(buffVal,this.combatBuffs.def);
					buffText += this.name + " activates " + skillName + " and gains +" + buffVal + " atk & def" + panicText + ".<br>";
				}
				else if(this.hasSlot("Rouse Def Res","c") && this.toggle.c == 1){
					var buffVal = this.hasSlot("Rouse Def Res","c") * 2;
					this.combatBuffs.def = Math.max(buffVal,this.combatBuffs.def);
					this.combatBuffs.res = Math.max(buffVal,this.combatBuffs.res);
					buffText += this.name + " activates " + skillName + " and gains +" + buffVal + " def and res.<br>";
				}
				else if(this.has("Rouse Spd Res") && this.toggle.c == 1){
					var buffVal = this.has("Rouse Spd Res") * 2;
					this.combatBuffs.spd = Math.max(buffVal,this.combatBuffs.spd);
					this.combatBuffs.res = Math.max(buffVal,this.combatBuffs.res);
					buffText += this.name + " activates " + skillName + " and gains +" + buffVal + " spd and res.<br>";
				}
				else if(this.hasSlot("Rouse Spd Def","c") && this.toggle.c == 1){
					var panicText = "";
					var buffVal = this.hasSlot("Rouse Spd Def","c") * 2;
					if(this.hasExactly("Rouse Spd Def 4")){
						buffVal = 6;
						this.bonus.nullPanic = true;
						panicText = " and Null Panic";
					}
					this.combatBuffs.spd = Math.max(buffVal,this.combatBuffs.spd);
					this.combatBuffs.def = Math.max(buffVal,this.combatBuffs.def);
					buffText += this.name + " activates " + skillName + " and gains +" + buffVal + " spd & def" + panicText + ".<br>";
				}
				else if(this.has("Rouse Atk Res") && this.toggle.c == 1){
					var panicText = "";
					var buffVal = this.has("Rouse Atk Res") * 2;
					if(this.hasExactly("Rouse Atk Res 4")){
						buffVal = 6;
						this.bonus.nullPanic = true;
						panicText = " and Null Panic";
					}
					this.combatBuffs.atk = Math.max(buffVal,this.combatBuffs.atk);
					this.combatBuffs.res = Math.max(buffVal,this.combatBuffs.res);
					buffText += this.name + " activates " + skillName + " and gains +" + buffVal + " atk & res" + panicText + ".<br>";
				}
				else if(this.hasSlot("Rouse Atk Spd","c") && this.toggle.c == 1){
					var panicText = "";
					var buffVal = this.hasSlot("Rouse Atk Spd","c") * 2;
					if(this.hasExactly("Rouse Atk Spd 4")){
						buffVal = 6;
						this.bonus.nullPanic = true;
						panicText = " and Null Panic";
					}
					this.combatBuffs.atk = Math.max(buffVal,this.combatBuffs.atk);
					this.combatBuffs.spd = Math.max(buffVal,this.combatBuffs.spd);
					buffText += this.name + " activates " + skillName + " and gains +" + buffVal + " atk & spd" + panicText + ".<br>";
				}
				else if(this.hasSlot("Atk Res Oath","c") && this.toggle.c == 1){
					var buffVal = this.hasSlot("Atk Res Oath","c") + 2;
					this.combatBuffs.atk = Math.max(buffVal,this.combatBuffs.atk);
					this.combatBuffs.res = Math.max(buffVal,this.combatBuffs.res);
					buffText += this.name + " activates " + skillName + " and gains +" + buffVal + " atk & res.<br>";
				}
				else if(this.hasSlot("Atk Def Oath","c") && this.toggle.c == 1){
					var buffVal = this.hasSlot("Atk Def Oath","c") + 2;
					this.combatBuffs.atk = Math.max(buffVal,this.combatBuffs.atk);
					this.combatBuffs.def = Math.max(buffVal,this.combatBuffs.def);
					buffText += this.name + " activates " + skillName + " and gains +" + buffVal + " atk & def.<br>";
				}
				else if(this.hasSlot("Atk Spd Oath","c") && this.toggle.c == 1){
					var buffVal = this.hasSlot("Atk Spd Oath","c") + 2;
					this.combatBuffs.atk = Math.max(buffVal,this.combatBuffs.atk);
					this.combatBuffs.spd = Math.max(buffVal,this.combatBuffs.spd);
					buffText += this.name + " activates " + skillName + " and gains +" + buffVal + " atk & spd.<br>";
				}
				else if(this.hasSlot("Def Res Oath","c") && this.toggle.c == 1){
					var buffVal = this.hasSlot("Def Res Oath","c") + 2;
					this.combatBuffs.def = Math.max(buffVal,this.combatBuffs.def);
					this.combatBuffs.res = Math.max(buffVal,this.combatBuffs.res);
					buffText += this.name + " activates " + skillName + " and gains +" + buffVal + " def & res.<br>";
				}
				else if(this.has("Spd Def Oath") && this.toggle.c == 1){
					var buffVal = this.has("Spd Def Oath") + 2;
					this.combatBuffs.spd = Math.max(buffVal,this.combatBuffs.spd);
					this.combatBuffs.def = Math.max(buffVal,this.combatBuffs.def);
					buffText += this.name + " activates " + skillName + " and gains +" + buffVal + " spd & def.<br>";
				}
				else if(this.hasSlot("Spd Res Oath","c") && this.toggle.c == 1){
					var buffVal = this.has("Spd Res Oath") + 2;
					this.combatBuffs.spd = Math.max(buffVal,this.combatBuffs.spd);
					this.combatBuffs.res = Math.max(buffVal,this.combatBuffs.res);
					buffText += this.name + " activates " + skillName + " and gains +" + buffVal + " spd & res.<br>";
				}
				else if(this.hasExactly("Threat Atk Spd 3") && this.toggle.c == 1){
					this.combatBuffs.atk = Math.max(5,this.combatBuffs.atk);
					this.combatBuffs.spd = Math.max(5,this.combatBuffs.spd);
					buffText += this.name + " activates " + skillName + " and gains +5 atk and spd.<br>";
				}
				else if(this.hasExactly("Threat Atk Res 3") && this.toggle.c == 1){
					this.combatBuffs.atk = Math.max(5,this.combatBuffs.atk);
					this.combatBuffs.res = Math.max(5,this.combatBuffs.res);
					buffText += this.name + " activates " + skillName + " and gains +5 atk and res.<br>";
				}
				else if(this.hasExactly("Threat Atk Def 3") && this.toggle.c == 1){
					this.combatBuffs.atk = Math.max(5,this.combatBuffs.atk);
					this.combatBuffs.def = Math.max(5,this.combatBuffs.def);
					buffText += this.name + " activates " + skillName + " and gains +5 atk and def.<br>";
				}
				else if(this.hasExactly("Threat Spd Def 3") && this.toggle.c == 1){
					this.combatBuffs.spd = Math.max(5,this.combatBuffs.spd);
					this.combatBuffs.def = Math.max(5,this.combatBuffs.def);
					buffText += this.name + " activates " + skillName + " and gains +5 spd and def.<br>";
				}
				else if(this.hasExactly("Atk Res Menace") && this.toggle.c == 1){
					this.combatBuffs.atk = Math.max(6,this.combatBuffs.atk);
					this.combatBuffs.res = Math.max(6,this.combatBuffs.res);
					buffText += this.name + " activates " + skillName + " and gains +6 atk and res.<br>";
				}
				else if(this.hasExactly("Atk Def Menace") && this.toggle.c == 1){
					this.combatBuffs.atk = Math.max(6,this.combatBuffs.atk);
					this.combatBuffs.def = Math.max(6,this.combatBuffs.def);
					buffText += this.name + " activates " + skillName + " and gains +6 atk and def.<br>";
				}
				else if(this.hasExactly("Def Res Menace") && this.toggle.c == 1){
					this.combatBuffs.def = Math.max(6,this.combatBuffs.def);
					this.combatBuffs.res = Math.max(6,this.combatBuffs.res);
					buffText += this.name + " activates " + skillName + " and gains +6 def and res.<br>";
				}
				else if(this.hasExactly("Atk Spd Menace") && this.toggle.c == 1){
					this.combatBuffs.atk = Math.max(6,this.combatBuffs.atk);
					this.combatBuffs.spd = Math.max(6,this.combatBuffs.spd);
					buffText += this.name + " activates " + skillName + " and gains +6 atk and spd.<br>";
				}
				else if(this.hasExactly("Spd Res Menace") && this.toggle.c == 1){
					this.combatBuffs.spd = Math.max(6,this.combatBuffs.spd);
					this.combatBuffs.res = Math.max(6,this.combatBuffs.res);
					buffText += this.name + " activates " + skillName + " and gains +6 spd and res.<br>";
				}
				else if(this.hasExactly("Spd Def Menace") && this.toggle.c == 1){
					this.combatBuffs.spd = Math.max(6,this.combatBuffs.spd);
					this.combatBuffs.def = Math.max(6,this.combatBuffs.def);
					buffText += this.name + " activates " + skillName + " and gains +6 spd and def.<br>";
				}
				else if(this.hasExactly("Surtr's Menace") && this.toggle.c == 1){
					this.combatBuffs.atk = Math.max(4,this.combatBuffs.atk);
					this.combatBuffs.spd = Math.max(4,this.combatBuffs.spd);
					this.combatBuffs.def = Math.max(4,this.combatBuffs.def);
					this.combatBuffs.res = Math.max(4,this.combatBuffs.res);
					buffText += this.name + " activates " + skillName + " and gains +4 to all stats.<br>";
				}
				else if(this.hasExactly("Order's Restraint") && this.toggle.c == 1){
					this.combatBuffs.atk = Math.max(6,this.combatBuffs.atk);
					this.combatBuffs.res = Math.max(6,this.combatBuffs.res);
					this.bonus.nullPanic = true;
					buffText += this.name + " activates " + skillName + " and gains +6 atk & res and Null Panic Bonus.<br>";
				}
				else if(this.hasExactly("Order's Restraint+") && this.toggle.c == 1){
					this.combatBuffs.atk = Math.max(6,this.combatBuffs.atk);
					this.combatBuffs.res = Math.max(6,this.combatBuffs.res);
					this.bonus.nullPanic = true;
					this.bonus.nfus = true;
					this.bonus.rotten = true;
					buffText += this.name + " activates " + skillName + " and gains +6 atk & res and Null Panic, NFU > Spd, & Reduce DR% by 50% Bonus.<br>";
				}
				else if(this.hasExactly("Surtr's Portent") && this.toggle.c == 1){
					this.combatBuffs.atk = Math.max(5,this.combatBuffs.atk);
					this.combatBuffs.spd = Math.max(5,this.combatBuffs.spd);
					this.combatBuffs.def = Math.max(5,this.combatBuffs.def);
					this.combatBuffs.res = Math.max(5,this.combatBuffs.res);
					buffText += this.name + " activates " + skillName + " and gains +5 to all stats.<br>";
				}
				else if(this.hasExactly("Ostia's Pulse 2") && this.toggle.c == 1){
					this.combatBuffs.def = Math.max(6,this.combatBuffs.def);
					this.combatBuffs.res = Math.max(6,this.combatBuffs.res);
					buffText += this.name + " activates " + skillName + " and gains +6 to def and res.<br>";
				}
				else if(this.has("Goddess Bearer") && this.toggle.c == 1){
					this.combatBuffs.atk = Math.max(7,this.combatBuffs.atk);
					this.combatBuffs.spd = Math.max(7,this.combatBuffs.spd);
					this.bonus.nfus = true;
					buffText += this.name + " activates " + skillName + " and gains +7 atk & spd and NFU > Spd Bonus.<br>";
				}
				else if(this.hasExactly("Darkling Guardian") && this.toggle.c == 1){
					this.combatBuffs.def = Math.max(6,this.combatBuffs.def);
					this.combatBuffs.res = Math.max(6,this.combatBuffs.res);
					this.bonus.stopD = true;
					buffText += this.name + " activates " + skillName + " and gains +6 to def & res and Deny Follow-Up Bonus.<br>";
				}
				else if(this.hasExactly("Divine Fang+") && this.toggle.c == 1){
					this.combatBuffs.atk = Math.max(6,this.combatBuffs.atk);
					this.combatBuffs.spd = Math.max(6,this.combatBuffs.spd);
					this.bonus.autoD = true;
					buffText += this.name + " activates " + skillName + " and gains +6 atk & spd and Auto Follow-Up Bonus.<br>";
				}
				else if(this.hasExactly("Heir to Light") && this.toggle.c == 1){
					this.combatBuffs.atk = Math.max(6,this.combatBuffs.atk);
					this.combatBuffs.spd = Math.max(6,this.combatBuffs.spd);
					this.bonus.nfus = true;
					buffText += this.name + " activates " + skillName + " and gains +6 atk & spd and NFU > Spd Bonus and can move 1 extra space.<br>";
				}
				else if((this.hasExactly("Vision of Arcadia 2") || this.hasExactly("Inborn Idealism")) && this.toggle.c == 1){
					this.combatBuffs.atk = Math.max(6,this.combatBuffs.atk);
					this.combatBuffs.spd = Math.max(6,this.combatBuffs.spd);
					this.combatBuffs.def = Math.max(6,this.combatBuffs.def);
					this.bonus.nullPanic = true;
					if(this.hasExactly("Inborn Idealism")){
						this.bonus.bDoubler = true;
						buffText += this.name + " activates " + skillName + " and gains +6 atk/spd/def, Null Panic Bonus, and Bonus Doubler Bonus.<br>";
					}
					else{
						buffText += this.name + " activates " + skillName + " and gains +6 atk/spd/def and Null Panic Bonus.<br>";
					}
				}
				else if((this.hasExactly("Severance") || this.hasExactly("Absolute Closure") ) && this.toggle.c == 1){
					this.bonus.dodge = true;
					buffText += this.name + " activates " + skillName + " and gains Dodge Bonus.<br>";
				}
				else if(this.hasExactly("Mila's Turnwheel 2")){
					this.bonus.stopD = true;
					buffText += this.name + " activates " + skillName + " and gains Deny Follow-Up Bonus.<br>";
				}
				else if(this.hasExactly("Alarm Atk Spd") && (this.toggle.c == 1 || this.toggle.c == 3)){
					this.combatBuffs.atk = Math.max(6,this.combatBuffs.atk);
					this.combatBuffs.spd = Math.max(6,this.combatBuffs.spd);
					buffText += this.name + " activates " + skillName + " and gains +6 atk & spd.<br>";
				}
				else if(this.hasExactly("Alarm Spd Def") && (this.toggle.c == 1 || this.toggle.c == 3)){
					this.combatBuffs.spd = Math.max(6,this.combatBuffs.spd);
					this.combatBuffs.def = Math.max(6,this.combatBuffs.def);
					buffText += this.name + " activates " + skillName + " and gains +6 spd & def.<br>";
				}
				else if(this.hasExactly("Alarm Atk Def") && (this.toggle.c == 1 || this.toggle.c == 3)){
					this.combatBuffs.atk = Math.max(6,this.combatBuffs.atk);
					this.combatBuffs.def = Math.max(6,this.combatBuffs.def);
					buffText += this.name + " activates " + skillName + " and gains +6 atk & def.<br>";
				}
				else if(this.hasExactly("Alarm Def Res") && (this.toggle.c == 1 || this.toggle.c == 3)){
					this.combatBuffs.def = Math.max(6,this.combatBuffs.def);
					this.combatBuffs.res = Math.max(6,this.combatBuffs.res);
					buffText += this.name + " activates " + skillName + " and gains +6 def & res.<br>";
				}
				else if(this.hasExactly("Rallying Cry") && (this.toggle.c == 1 || this.toggle.c == 3)){
					this.bonus.breathB = true;
					buffText += this.name + " activates " + skillName + " and gains CD +1 per Atk Bonus.<br>";
				}
				else if(this.hasExactly("Dream Deliverer") && (this.toggle.c == 1 || this.toggle.c == 3)){
					this.combatBuffs.def = Math.max(6,this.combatBuffs.def);
					this.combatBuffs.res = Math.max(6,this.combatBuffs.res);
					this.bonus.resoS = true;
					buffText += this.name + " activates " + skillName + " and gains +6 to def & res and Resonance: Shields Bonus.<br>";
				}
				else if(this.hasExactly("Tip the Scales!") && (this.toggle.c == 1 || this.toggle.c == 3) && (this.buddy.adjacent > 0 || this.buddy.two > 0)){
					this.bonus.spectrum = true;
					buffText += this.name + " activates " + skillName + " and gains Rally Spectrum Bonus.<br>";
				}
				else if(this.hasExactly("Atk Spd Pledge") && this.toggle.c == 1){
					this.combatBuffs.atk = Math.max(6,this.combatBuffs.atk);
					this.combatBuffs.spd = Math.max(6,this.combatBuffs.spd);
					this.bonus.breathB = true;
					buffText += this.name + " activates " + skillName + " and gains +6 atk & spd and CD +1 per Atk Bonus.<br>";
				}
				else if(this.hasExactly("Heart of Crimea") && (this.buddy.adjacent > 0 || this.buddy.two > 0)){
					this.bonus.nfus = true;
					buffText += this.name + " activates " + skillName + " and gains NFU > Spd Bonus.<br>";
				}
				else if((this.hasExactly("Incite Atk Spd") && this.toggle.c == 1) || (this.hasExactly("AS Incite Hone") && this.toggle.c > 9)){
					this.bonus.incited = true;
					this.combatBuffs.atk = Math.max(6,this.combatBuffs.atk);
					this.combatBuffs.spd = Math.max(6,this.combatBuffs.spd);
					buffText += this.name + " activates " + skillName + " and gains +6 atk & spd and Incited Bonus.<br>";
				}
				else if(this.hasExactly("Incite Atk Res") && this.toggle.c == 1 || (this.hasExactly("AR Incite Hone") && this.toggle.c > 9)){
					this.bonus.incited = true;
					this.combatBuffs.atk = Math.max(6,this.combatBuffs.atk);
					this.combatBuffs.res = Math.max(6,this.combatBuffs.res);
					buffText += this.name + " activates " + skillName + " and gains +6 atk & res and Incited Bonus.<br>";
				}
				else if(this.hasExactly("Incite Spd Def") && this.toggle.c == 1){
					this.bonus.incited = true;
					this.combatBuffs.spd = Math.max(6,this.combatBuffs.spd);
					this.combatBuffs.def = Math.max(6,this.combatBuffs.def);
					buffText += this.name + " activates " + skillName + " and gains +6 spd & def and Incited Bonus.<br>";
				}
				else if(this.hasExactly("Inf Null Follow 4") && this.toggle.c == 1){
					this.bonus.nfus = true;
					buffText += this.name + " activates " + skillName + " and gains NFU > Spd Bonus.<br>";
				}
				else if(this.hasExactly("Pulse Up Blades")){
					var pubVal = Math.min(turn*2,6);
					this.combatBuffs.atk = Math.max(pubVal,this.combatBuffs.atk);
					this.combatBuffs.spd = Math.max(pubVal,this.combatBuffs.spd);
					buffText += this.name + " activates " + skillName + " and gains +" + pubVal + " atk & spd.<br>";
				}
				else if(this.hasExactly("Darkling Dragon") && (this.toggle.c == 1 || this.toggle.c == 3)){
					this.combatBuffs.def = Math.max(6,this.combatBuffs.def);
					this.combatBuffs.res = Math.max(6,this.combatBuffs.res);
					buffText += this.name + " activates " + skillName + " and gains +6 def & res.<br>";
				}
				else if((this.hasExactly("Glittering Anima") || this.hasExactly("Twinkling Anima")) && this.hp / this.maxHp >= 0.25){
					this.combatBuffs.atk = Math.max(6,this.combatBuffs.atk);
					this.combatBuffs.spd = Math.max(6,this.combatBuffs.spd);
					this.bonus.nPenalty = true;
					buffText += this.name + " activates " + skillName + " and gains +6 atk & spd and Null Penalty Bonus.<br>";
				}
				else if(this.hasExactly("Def Res Pledge") && this.toggle.c == 1){
					this.combatBuffs.def = Math.max(6,this.combatBuffs.def);
					this.combatBuffs.res = Math.max(6,this.combatBuffs.res);
					this.bonus.breathB = true;
					buffText += this.name + " activates " + skillName + " and gains +6 def & res and CD +1 per Atk Bonus.<br>";
				}
				else if(this.hasExactly("Beast Threaten") && this.toggle.c == 1){
					this.combatBuffs.atk = Math.max(6,this.combatBuffs.atk);
					buffText += this.name + " activates " + skillName + " and gains +6 atk.<br>";
				}
				else if(this.hasExactly("Odd Def Wave 4")){
					this.combatBuffs.def = Math.max(6,this.combatBuffs.def);
					buffText += this.name + " activates " + skillName + " and gains +6 def.<br>";
				}
				else if(this.hasExactly("Odd Spd Wave 4")){
					this.combatBuffs.spd = Math.max(6,this.combatBuffs.spd);
					buffText += this.name + " activates " + skillName + " and gains +6 spd.<br>";
				}
				else if(this.hasExactly("Even Res Wave D")){
					this.combatBuffs.res = Math.max(6,this.combatBuffs.res);
					buffText += this.name + " activates " + skillName + " and gains +6 res.<br>";
				}
				else if(this.hasExactly("Even Atk Wave N")){
					this.combatBuffs.atk = Math.max(6,this.combatBuffs.atk);
					buffText += this.name + " activates " + skillName + " and gains +6 atk.<br>";
				}
				else if(this.hasExactly("Paranoia")){
					this.bonus.nfus = true;
					this.bonus.paranoia = true;
					buffText += this.name + " activates " + skillName + " and gains NFU > Spd & Paranoia Bonus.<br>";
				}
				else if(this.hasExactly("Air Orders 4") && this.toggle.c == 1){
					this.combatBuffs.atk = Math.max(6,this.combatBuffs.atk);
					this.combatBuffs.spd = Math.max(6,this.combatBuffs.spd);
					buffText += this.name + " activates " + skillName + " and gains +6 atk & spd.<br>";
				}
				else if(this.hasExactly("Assault Rush") && (this.hp / this.maxHp == 1 || this.buddy.erorc > 0)){
					this.combatBuffs.atk = Math.max(6,this.combatBuffs.atk);
					buffText += this.name + " activates " + skillName + " and gains +6 atk.<br>";
				}
			}
			else if((skillName.indexOf("Odd") != -1 && skillName.indexOf("Wave") != -1 && remainder == 1) || (skillName.indexOf("Even") != -1 && skillName.indexOf("Wave") != -1 && remainder == 0)){
				var buffVal = skillName.slice(-1) * 2;
				if(skillName.indexOf("Atk") != -1){
					this.combatBuffs.atk = Math.max(buffVal,this.combatBuffs.atk);
					stat = "atk";
				}
				else if(skillName.indexOf("Spd") != -1){
					this.combatBuffs.spd = Math.max(buffVal,this.combatBuffs.spd);
					stat = "spd";
				}
				else if(skillName.indexOf("Def") != -1){
					this.combatBuffs.def = Math.max(buffVal,this.combatBuffs.def);
					stat = "def";
				}
				else if(skillName.indexOf("Res") != -1){
					this.combatBuffs.res = Math.max(buffVal,this.combatBuffs.res);
					stat = "res";
				}
				buffText += this.name + " activates " + skillName + " on turn " + turn + " and gains +" + buffVal + " " + stat + ".<br>";
			}
		}
		if(this.sIndex != -1){
			skillName = data.skills[this.sIndex].name;
			var remainder = turn % 2;
			var stat = "";
			if(data.selfBuffSkills.indexOf(skillName) != -1){
				if(this.hasSlot("Atk Res Oath","s") && this.toggle.s == 1){
					var buffVal = this.hasSlot("Atk Res Oath","s") + 2;
					this.combatBuffs.atk = Math.max(buffVal,this.combatBuffs.atk);
					this.combatBuffs.res = Math.max(buffVal,this.combatBuffs.res);
					buffText += this.name + " activates " + skillName + " and gains +" + buffVal + " atk & res.<br>";
				}
				else if(this.hasSlot("Spd Res Oath","s") && this.toggle.s == 1){
					var buffVal = this.hasSlot("Spd Res Oath","s") + 2;
					this.combatBuffs.spd = Math.max(buffVal,this.combatBuffs.spd);
					this.combatBuffs.res = Math.max(buffVal,this.combatBuffs.res);
					buffText += this.name + " activates " + skillName + " and gains +" + buffVal + " spd & res.<br>";
				}
				else if(this.hasSlot("Atk Spd Oath","s") && this.toggle.s == 1){
					var buffVal = this.hasSlot("Atk Spd Oath","s") + 2;
					this.combatBuffs.atk = Math.max(buffVal,this.combatBuffs.atk);
					this.combatBuffs.spd = Math.max(buffVal,this.combatBuffs.spd);
					buffText += this.name + " activates " + skillName + " and gains +" + buffVal + " atk & spd.<br>";
				}
				else if(this.hasSlot("Spd Def Oath","s") && this.toggle.s == 1){
					var buffVal = this.hasSlot("Spd Def Oath","s") + 2;
					this.combatBuffs.spd = Math.max(buffVal,this.combatBuffs.spd);
					this.combatBuffs.def = Math.max(buffVal,this.combatBuffs.def);
					buffText += this.name + " activates " + skillName + " and gains +" + buffVal + " spd & def.<br>";
				}
				else if(this.hasSlot("Atk Def Oath","s") && this.toggle.s == 1){
					var buffVal = this.hasSlot("Atk Def Oath","s") + 2;
					this.combatBuffs.atk = Math.max(buffVal,this.combatBuffs.atk);
					this.combatBuffs.def = Math.max(buffVal,this.combatBuffs.def);
					buffText += this.name + " activates " + skillName + " and gains +" + buffVal + " atk & def.<br>";
				}
				else if(this.hasSlot("Def Res Oath","s") && this.toggle.s == 1){
					var buffVal = this.hasSlot("Def Res Oath","s") + 2;
					this.combatBuffs.def = Math.max(buffVal,this.combatBuffs.def);
					this.combatBuffs.res = Math.max(buffVal,this.combatBuffs.res);
					buffText += this.name + " activates " + skillName + " and gains +" + buffVal + " def & res.<br>";
				}
				else if(this.hasSlot("Rouse Atk Def","s") && this.toggle.s == 1){
					var buffVal = this.hasSlot("Rouse Atk Def","s") * 2;
					this.combatBuffs.atk = Math.max(buffVal,this.combatBuffs.atk);
					this.combatBuffs.def = Math.max(buffVal,this.combatBuffs.def);
					buffText += this.name + " activates " + skillName + " and gains +" + buffVal + " atk & def.<br>";
				}
				else if(this.hasSlot("Rouse Spd Def","s") && this.toggle.s == 1){
					var buffVal = this.hasSlot("Rouse Spd Def","s") * 2;
					this.combatBuffs.spd = Math.max(buffVal,this.combatBuffs.spd);
					this.combatBuffs.def = Math.max(buffVal,this.combatBuffs.def);
					buffText += this.name + " activates " + skillName + " and gains +" + buffVal + " spd & def.<br>";
				}
				else if(this.hasSlot("Rouse Def Res","s") && this.toggle.s == 1){
					var buffVal = this.hasSlot("Rouse Def Res","s") * 2;
					this.combatBuffs.def = Math.max(buffVal,this.combatBuffs.def);
					this.combatBuffs.res = Math.max(buffVal,this.combatBuffs.res);
					buffText += this.name + " activates " + skillName + " and gains +" + buffVal + " def & res.<br>";
				}
				else if(this.hasSlot("Rouse Atk Spd","s") && this.toggle.s == 1){
					var buffVal = this.hasSlot("Rouse Atk Spd","s") * 2;
					this.combatBuffs.atk = Math.max(buffVal,this.combatBuffs.atk);
					this.combatBuffs.spd = Math.max(buffVal,this.combatBuffs.spd);
					buffText += this.name + " activates " + skillName + " and gains +" + buffVal + " atk & spd.<br>";
				}
			}
			else if((skillName.indexOf("Odd") != -1 && remainder == 1) || (skillName.indexOf("Even") != -1 && remainder == 0)){
				var buffVal = skillName.slice(-1) * 2;
				if(skillName.indexOf("Atk") != -1){
					this.combatBuffs.atk = Math.max(buffVal,this.combatBuffs.atk);
					stat = "atk";
				}
				else if(skillName.indexOf("Spd") != -1){
					this.combatBuffs.spd = Math.max(buffVal,this.combatBuffs.spd);
					stat = "spd";
				}
				else if(skillName.indexOf("Def") != -1){
					this.combatBuffs.def = Math.max(buffVal,this.combatBuffs.def);
					stat = "def";
				}
				else if(skillName.indexOf("Res") != -1){
					this.combatBuffs.res = Math.max(buffVal,this.combatBuffs.res);
					stat = "res";
				}
				buffText += this.name + " activates " + skillName + " on turn " + turn + " and gains +" + buffVal + " " + stat + ".<br>";
			}
		}
		if(this.xIndex != -1 && data.selfBuffSkills.indexOf(data.skills[this.xIndex].name) != -1){
			skillName = data.skills[this.xIndex].name;
			if(this.hasExactly("Atk Oath Echo") && this.toggle.x == 1){
				this.combatBuffs.atk = Math.max(6,this.combatBuffs.atk);
				buffText += this.name + " activates " + skillName + " and gains +6 atk.<br>";
			}
		}
		if(options.threatenRule=="Summ. Duels"){
			if(this.hasCaptain("Dauntless") && (this.toggle.sd == 0 || this.toggle.sd == 2) && turn > 1 && turn < 6){
				this.bonus.breathB = true;
				buffText += this.name + " is affected by Dauntless and gains CD +1 per Atk Bonus.<br>";
			}
			else if(this.hasCaptain("Rallying Cry") && turn > 1 && turn < 6){
				this.combatBuffs.atk = Math.max(6,this.combatBuffs.atk);
				this.combatBuffs.spd = Math.max(6,this.combatBuffs.spd);
				this.combatBuffs.def = Math.max(6,this.combatBuffs.def);
				this.combatBuffs.res = Math.max(6,this.combatBuffs.res);
				buffText += this.name + " is affected by Rallying Cry and gains +6 to all stats.<br>";
			}
			else if(this.hasCaptain("Flyting Talent") && turn > 1 && turn < 6){
				this.bonus.spectrum = true;
				buffText += this.name + " is affected by Flyting Talent and gains Rally Spectrum Bonus.<br>";
			}
		}
		return buffText;
	};
	
	this.combined = function(enemy,turn){
		var comboText = "";
		var combDebuffs = {"atk":0,"spd":0,"def":0,"res":0};
		var skillNames = [];
		var pCheck = false;
		var allStats = getEffStats(this, enemy, turn);
		var enDef = enemy.def;
		var enRes = enemy.res;
		var thDef = this.def;
		var thRes = this.res;
		if(this.initiator){
			enDef = allStats[22];
			enRes = allStats[23];
		}
		else{
			thDef = allStats[18];
			thRes = allStats[19];
		}
		if(options.threatenRule=="Summ. Duels"){
			enDef = enemy.def;
			enRes = enemy.res;
			thDef = this.def;
			thRes = this.res;
		}
		//weapons
		if(this.hasExactly("Blade of Favors") && (this.toggle.weapon == 1 || this.toggle.weapon == 3)){
			this.combatBuffs.atk = Math.max(6,this.combatBuffs.atk);
			this.combatBuffs.spd = Math.max(6,this.combatBuffs.spd);
			this.combatBuffs.def = Math.max(6,this.combatBuffs.def);
			combDebuffs.atk = Math.min(combDebuffs.atk, -6);
			combDebuffs.spd = Math.min(combDebuffs.spd, -6);
			combDebuffs.def = Math.min(combDebuffs.def, -6);
			skillNames.push(data.skills[this.weaponIndex].name);
			comboText += this.name + " has activated Blade of Favors and gains +6 atk/spd/def.<br>";
		}
		else if(this.hasExactly("Duskbloom Bow") && (this.toggle.weapon == 1 || this.toggle.weapon == 3) && thRes + this.getPhantom("Res") > enRes + enemy.getPhantom("Res")){
			combDebuffs.def = Math.min(combDebuffs.def, -7);
			combDebuffs.res = Math.min(combDebuffs.res, -7);
			skillNames.push(data.skills[this.weaponIndex].name);
			comboText += this.name + " has activated Duskbloom Bow and inflicts -7 def & res on " + enemy.name + ".<br>";
		}
		else if(this.hasExactly("Inspirited Spear") && this.toggle.weapon == 1){
			if(this.initiator){
				this.combatBuffs.spd = Math.max(6,this.combatBuffs.spd);
				this.combatBuffs.def = Math.max(6,this.combatBuffs.def);
				comboText += this.name + " has activated Inspirited Spear and gains +6 spd & def.<br>";
			}
			else{
				enemy.penalty.cdguard = true;
				comboText += this.name + " has activated Inspirited Spear and inflicts Guard status on " + enemy.name + ".<br>";
			}
		}
		else if(this.has("Carrot Bow") && this.toggle.weapon == 1 && thRes + this.getPhantom("Res") + 5 > enRes + enemy.getPhantom("Res")){
			combDebuffs.atk = Math.min(combDebuffs.atk, -7);
			combDebuffs.def = Math.min(combDebuffs.def, -7);
			skillNames.push(data.skills[this.weaponIndex].name);
			enemy.penalty.discord = true;
			comboText += this.name + " has activated " + data.skills[this.weaponIndex].name + " and inflicts Discord status to " + enemy.name + ".<br>";
		}
		else if(this.hasExactly("Dark Scripture") && this.rValue > 0 && this.toggle.weapon == 1 && thRes + this.getPhantom("Res") + 5 > enRes + enemy.getPhantom("Res")){
			combDebuffs.atk = Math.min(combDebuffs.atk, -7);
			combDebuffs.res = Math.min(combDebuffs.res, -7);
			skillNames.push(data.skills[this.weaponIndex].name);
			enemy.penalty.sabotage = true;
			enemy.penalty.nullArise = true;
			enemy.penalty.fatal = true;
			comboText += this.name + " has activated Dark Scripture and inflicts [Sabotage], [Null Miracle], and [Deep Wounds] to " + enemy.name + ".<br>";
		}
		else if(this.hasExactly("Wild Wind Sword")){
			this.combatDebuffs.spd = Math.min(-7,this.combatDebuffs.spd);
			this.combatDebuffs.def = Math.min(-7,this.combatDebuffs.def);
			skillNames.push(data.skills[this.weaponIndex].name);
			comboText += this.name + " has activated Wild Wind Sword and self-inflicts -7 spd & def.<br>";
		}
		else if(this.hasExactly("Nectar Horn") && this.toggle.weapon == 1 && thRes + this.getPhantom("Res") + 5 > enRes + enemy.getPhantom("Res")){
			combDebuffs.atk = Math.min(combDebuffs.atk, -7);
			combDebuffs.def = Math.min(combDebuffs.def, -7);
			skillNames.push(data.skills[this.weaponIndex].name);
			enemy.penalty.discord = true;
			enemy.penalty.fatal = true;
			enemy.penalty.nullArise = true;
			comboText += this.name + " has activated Nectar Horn and inflicts [Discord], [Deep Wounds], and [Null Arise] to " + enemy.name + ".<br>";
		}
		else if(this.hasExactly("Light of Etruria")){
			this.combatBuffs.spd = Math.max(6,this.combatBuffs.spd);
			this.combatBuffs.res = Math.max(6,this.combatBuffs.res);
			this.bonus.bexblade = true;
			var leText = "";
			if(this.toggle.weapon == 1 && thRes + this.getPhantom("Res") + 5 > enRes + enemy.getPhantom("Res")){
				combDebuffs.atk = Math.min(combDebuffs.atk, -7);
				combDebuffs.spd = Math.min(combDebuffs.spd, -7);
				enemy.penalty.cdguard = true;
				enemy.penalty.exposure = true;
				leText = "and inflicts -7 atk & spd, [Guard], and [Exposure] to " + enemy.name;
			}
			skillNames.push(data.skills[this.weaponIndex].name);
			comboText += this.name + " has activated Light of Etruria and gains +6 spd & res and [Hexblade] " + leText + ".<br>";
		}
		else if(this.hasExactly("Banshee TH") && this.rValue == 5 && this.toggle.weapon > 1 && thRes + this.getPhantom("Res") > enRes + enemy.getPhantom("Res")){
			combDebuffs.atk = Math.min(combDebuffs.atk, -7);
			combDebuffs.res = Math.min(combDebuffs.res, -7);
			skillNames.push(data.skills[this.weaponIndex].name);
			enemy.penalty.sabotage = true;
			comboText += this.name + " has activated " + data.skills[this.weaponIndex].name + " and inflicts Sabotage status to " + enemy.name + ".<br>";
		}
		else if(this.hasExactly("Fellowship Blade") && this.toggle.weapon == 1){
			this.combatBuffs.def = Math.max(6,this.combatBuffs.def);
			this.combatBuffs.res = Math.max(6,this.combatBuffs.res);
			this.bonus.nullPanic = true;
			comboText += this.name + " has activated Fellowship Blade and gains +6 def & res, [Bulwark], and [Null Panic].<br>";
		}
		else if(this.hasExactly("New Year Talon") && this.toggle.weapon == 1){
			combDebuffs.spd = Math.min(combDebuffs.spd, -7);
			combDebuffs.def = Math.min(combDebuffs.def, -7);
			enemy.penalty.exposure = true;
			enemy.penalty.sabotage = true;
			skillNames.push(data.skills[this.weaponIndex].name);
			comboText += this.name + " has activated New Year Talon and inflicts [Exposure] and [Sabotage] to " + enemy.name + ".<br>";
		}
		else if(this.hasExactly("New Year Fang") && this.toggle.weapon == 1){
			this.combatBuffs.def = Math.max(6,this.combatBuffs.def);
			this.combatBuffs.res = Math.max(6,this.combatBuffs.res);
			this.bonus.bexblade = true;
			this.bonus.rotten = true;
			comboText += this.name + " has activated New Year Fang and gains +6 def & res, [Hexblade], and [Reduce DR% by 50%].<br>";
		}
		else if(this.hasExactly("Swirling Lance") && this.toggle.weapon == 1){
			this.combatBuffs.spd = Math.max(6,this.combatBuffs.spd);
			this.combatBuffs.def = Math.max(6,this.combatBuffs.def);
			this.bonus.sdiff = true;
			this.bonus.nullPanic = true;
			comboText += this.name + " has activated Swirling Lance and gains +6 spd & def, [Spd Difference], and [Null Panic].<br>";
		}
		else if((this.hasExactly("Swirling Scimitar") || this.has("Jehanna Dagger") || this.has("Jehanna Lance")) && this.toggle.weapon == 1){
			this.combatBuffs.atk = Math.max(6,this.combatBuffs.atk);
			this.combatBuffs.spd = Math.max(6,this.combatBuffs.spd);
			this.bonus.dodge = true;
			this.bonus.nPenalty = true;
			comboText += this.name + " has activated " + data.skills[this.weaponIndex].name + " and gains +6 atk & spd, [Dodge], and [Null Penalty].<br>";
		}
		else if(this.hasExactly("Wing-Lifted Spear") && this.rValue == 5 && this.toggle.weapon == 1){
			this.combatBuffs.atk = Math.max(6,this.combatBuffs.atk);
			this.combatBuffs.spd = Math.max(6,this.combatBuffs.spd);
			this.bonus.nPenalty = true;
			this.bonus.breathB = true;
			comboText += this.name + " has activated Wing-Lifted Spear and gains +6 atk & spd, [Null Penalty], and [CD +1 per Atk].<br>";
		}
		else if(this.hasExactly("Gentle Fell Egg") && this.toggle.weapon == 1){
			this.bonus.starlight = true;
			this.bonus.resoB = true;
			this.bonus.resoS = true;
			comboText += this.name + " has activated Gentle Fell Egg and gains [80% AOE DR], [Resonance Blades], and [Resonance Shields].<br>";
		}
		else if(this.hasExactly("Silesse Frost") && this.rValue == 5 && this.toggle.weapon > 1){
			this.combatBuffs.atk = Math.max(6,this.combatBuffs.atk);
			this.combatBuffs.spd = Math.max(6,this.combatBuffs.spd);
			this.bonus.breathB = true;
			this.bonus.dodge = true;
			comboText += this.name + " has activated Silesse Frost and gains +6 atk & spd, [CD +1 per Atk], and [Dodge].<br>";
		}
		else if(this.hasExactly("Axe of Dusk") && this.toggle.weapon == 1){
			combDebuffs.spd = Math.min(combDebuffs.spd, -7);
			combDebuffs.def = Math.min(combDebuffs.def, -7);
			enemy.penalty.discord = true;
			enemy.penalty.fatal = true;
			skillNames.push(data.skills[this.weaponIndex].name);
			comboText += this.name + " has activated Axe of Dusk and inflicts [Discord] and [Deep Wounds] to " + enemy.name + ".<br>";
		}
		else if(this.hasExactly("Duskstone") && this.hp / this.maxHp >= 0.25){
			this.bonus.dHex = true;
			comboText += this.name + " has activated Duskstone and gains [Draconic Hex].<br>";
		}
		else if(this.hasExactly("Ancient Majesty") && this.hp / this.maxHp >= 0.25){
			combDebuffs.atk = Math.min(combDebuffs.atk, -7);
			combDebuffs.res = Math.min(combDebuffs.res, -7);
			enemy.penalty.frozen = true;
			enemy.penalty.cdguard = true;
			skillNames.push(data.skills[this.weaponIndex].name);
			comboText += this.name + " has activated Ancient Majesty and inflicts [Frozen] and [Guard] to " + enemy.name + ".<br>";
		}
		else if(this.hasExactly("Fundament") && this.hp / this.maxHp >= 0.25){
			this.combatBuffs.atk = Math.max(6,this.combatBuffs.atk);
			this.combatBuffs.res = Math.max(6,this.combatBuffs.res);
			this.bonus.starlight = true;
			this.bonus.dull = true;
			comboText += this.name + " has activated Fundament and gains +6 atk & res, [80% AOE DR], and [Lull All].<br>";
		}
		else if(this.hasExactly("Ancient Betrayal") && this.hp / this.maxHp >= 0.25){
			this.combatBuffs.atk = Math.max(6,this.combatBuffs.atk);
			this.combatBuffs.res = Math.max(6,this.combatBuffs.res);
			this.bonus.enGarde = true;
			this.bonus.dull = true;
			comboText += this.name + " has activated Ancient Betrayal and gains +6 atk & res, [En Garde], and [Lull All].<br>";
		}
		
		if(this.hasExactly("Divine Toxin")){
			this.bonus.dosage = true;
			comboText += this.name + " has activated Divine Toxin and gains [Dosage].<br>";
		}
		
		if(this.hasExactly("Spd Res Discord") && this.toggle.b > 9){
			combDebuffs.spd = Math.min(combDebuffs.spd, -6);
			combDebuffs.res = Math.min(combDebuffs.res, -6);
			skillNames.push(data.skills[this.bIndex].name);
			enemy.penalty.discord = true;
			comboText += this.name + " has activated Spd Res Discord and inflicts [Discord] to " + enemy.name + ".<br>";
		}
		else if(this.hasExactly("Atk Res Discord") && this.toggle.b > 9){
			combDebuffs.atk = Math.min(combDebuffs.atk, -6);
			combDebuffs.res = Math.min(combDebuffs.res, -6);
			skillNames.push(data.skills[this.bIndex].name);
			enemy.penalty.discord = true;
			comboText += this.name + " has activated Atk Res Discord and inflicts [Discord] to " + enemy.name + ".<br>";
		}
		else if(this.hasExactly("Def Res Discord") && this.toggle.b > 9){
			combDebuffs.def = Math.min(combDebuffs.def, -6);
			combDebuffs.res = Math.min(combDebuffs.res, -6);
			skillNames.push(data.skills[this.bIndex].name);
			enemy.penalty.discord = true;
			comboText += this.name + " has activated Def Res Discord and inflicts [Discord] to " + enemy.name + ".<br>";
		}
		else if(this.hasExactly("Yggdrasill's Alter") && this.toggle.b > 9){
			combDebuffs.atk = Math.min(combDebuffs.atk, -7);
			combDebuffs.def = Math.min(combDebuffs.def, -7);
			enemy.penalty.discord = true;
			skillNames.push(data.skills[this.bIndex].name);
			comboText += this.name + " has activated Yggdrasill's Alter and inflicts [Discord] to " + enemy.name + ".<br>";
		}
		else if(this.hasExactly("Font of Wisdom") && this.toggle.b == 1){
			combDebuffs.atk = Math.min(combDebuffs.atk, -7);
			combDebuffs.spd = Math.min(combDebuffs.spd, -7);
			combDebuffs.res = Math.min(combDebuffs.res, -7);
			skillNames.push(data.skills[this.bIndex].name);
		}
		else if(this.hasExactly("I Remember...") && this.toggle.b == 1){
			combDebuffs.spd = Math.min(combDebuffs.spd, -7);
			combDebuffs.def = Math.min(combDebuffs.def, -7);
			enemy.penalty.panic = true;
			enemy.penalty.sabotage = true;
			skillNames.push(data.skills[this.bIndex].name);
			comboText += this.name + " has activated I Remember... and inflicts [Panic] & [Sabotage] to " + enemy.name + ".<br>";
		}
		else if(this.hasExactly("Atk Res Havoc") && this.toggle.b == 1 && thRes + this.getPhantom("Res") > enRes + enemy.getPhantom("Res")){
			combDebuffs.atk = Math.min(combDebuffs.atk, -7);
			combDebuffs.res = Math.min(combDebuffs.res, -7);
			skillNames.push(data.skills[this.bIndex].name);
			enemy.penalty.sabotage = true;
			enemy.penalty.schism = true;
			comboText += this.name + " has activated Atk Res Havoc and inflicts [Sabotage] and [Schism] to " + enemy.name + ".<br>";
		}
		
		if(this.hasExactly("Def Res Ploy 3") && this.toggle.c == 1 && thRes + this.getPhantom("Res") + 5 > enRes + enemy.getPhantom("Res")){
			combDebuffs.def = Math.min(combDebuffs.def, -7);
			combDebuffs.res = Math.min(combDebuffs.res, -7);
			skillNames.push(data.skills[this.cIndex].name);
			enemy.penalty.exposure = true;
			enemy.penalty.ploy = true;
			comboText += this.name + " has activated Def Res Ploy 3 and inflicts [Ploy], and [Exposure] to " + enemy.name + ".<br>";
		}
		else if(this.hasExactly("Atk Res Ploy 3") && this.toggle.c == 1 && thRes + this.getPhantom("Res") + 5 > enRes + enemy.getPhantom("Res")){
			combDebuffs.atk = Math.min(combDebuffs.atk, -7);
			combDebuffs.res = Math.min(combDebuffs.res, -7);
			skillNames.push(data.skills[this.cIndex].name);
			enemy.penalty.exposure = true;
			enemy.penalty.ploy = true;
			comboText += this.name + " has activated Atk Res Ploy 3 and inflicts [Ploy], and [Exposure] to " + enemy.name + ".<br>";
		}
		else if(this.hasExactly("Atk Spd Ploy 3") && this.toggle.c == 1 && thRes + this.getPhantom("Res") + 5 > enRes + enemy.getPhantom("Res")){
			combDebuffs.atk = Math.min(combDebuffs.atk, -7);
			combDebuffs.spd = Math.min(combDebuffs.spd, -7);
			skillNames.push(data.skills[this.cIndex].name);
			enemy.penalty.exposure = true;
			enemy.penalty.ploy = true;
			comboText += this.name + " has activated Atk Spd Ploy 3 and inflicts [Ploy], and [Exposure] to " + enemy.name + ".<br>";
		}
		else if(this.hasExactly("Spd Res Ploy 3") && this.toggle.c == 1 && thRes + this.getPhantom("Res") + 5 > enRes + enemy.getPhantom("Res")){
			combDebuffs.spd = Math.min(combDebuffs.spd, -7);
			combDebuffs.res = Math.min(combDebuffs.res, -7);
			skillNames.push(data.skills[this.cIndex].name);
			enemy.penalty.exposure = true;
			enemy.penalty.ploy = true;
			comboText += this.name + " has activated Spd Res Ploy 3 and inflicts [Ploy], and [Exposure] to " + enemy.name + ".<br>";
		}
		else if(this.hasExactly("Pulse Up Ploy") && this.toggle.c == 1 && thRes + this.getPhantom("Res") + 5 > enRes + enemy.getPhantom("Res")){
			skillNames.push(data.skills[this.cIndex].name);
			enemy.penalty.exposure = true;
			enemy.penalty.ploy = true;
			comboText += this.name + " has activated Pulse Up Ploy and inflicts [Ploy], and [Exposure] to " + enemy.name + ".<br>";
		}
		else if(this.hasExactly("Divine Deceit") && this.toggle.c == 1 && thRes + this.getPhantom("Res") + 5 > enRes + enemy.getPhantom("Res")){
			enemy.penalty.exposure = true;
			enemy.penalty.ploy = true;
			comboText += this.name + " has activated Divine Deceit and inflicts [Ploy] and [Exposure] to " + enemy.name + ".<br>";
		}
		else if((this.hasExactly("Divine Nectar") || this.hasExactly("Nectar's Magic")) && this.toggle.c > 0){
			this.bonus.nectar = this.toggle.c;
			comboText += this.name + " has activated " + data.skills[this.cIndex].name + " and gains [Divine Nectar] Bonus.<br>";
		}
		else if(this.hasExactly("Connected World") && this.toggle.c == 1){
			this.combatBuffs.atk = Math.max(6,this.combatBuffs.atk);
			this.combatBuffs.def = Math.max(6,this.combatBuffs.def);
			this.bonus.resoB = true;
			this.bonus.resoS = true;
			this.bonus.rotten = true;
			comboText += this.name + " has activated Connected World and gains +6 atk & def and [Resonance: Blades], [Resonance: Shields], & [Reduce DR% by 50%] Bonus.<br>";
		}
		else if(this.hasExactly("Divine God Fang") && this.toggle.c == 1){
			this.bonus.divineFang = true;
			this.bonus.nullDragon = true;
			comboText += this.name + " has activated Divine God Fang and gains [Divine Fang] and [Null Dragon Eff] Bonus.<br>";
		}
		
		//Neutralize Function (ie. Crystalline Water)
		var cdNull = {"atk":false,"spd":false,"def":false,"res":false};
		if(enemy.hasExactly("Arcane Giant Axe")){
			cdNull.atk = true;
			cdNull.def = true;
			if(pCheck == true){
				enemy.penalty.panic = false;
			}
			comboText += enemy.name + " has neutralized [Panic] and penalties to atk & def with Arcane Giant Axe.<br>";
		}
		if(enemy.hasExactly("Crystalline Water")){
			cdNull.atk = true;
			cdNull.res = true;
			if(pCheck == true){
				enemy.penalty.panic = false;
			}
			comboText += enemy.name + " has neutralized [Panic] and penalties to atk & res with Crystalline Water.<br>";
		}
		else if(enemy.hasExactly("Verge of Death")){
			cdNull.atk = true;
			cdNull.spd = true;
			if(pCheck == true){
				enemy.penalty.panic = false;
			}
			comboText += enemy.name + " has neutralized [Panic] and penalties to atk & spd with Verge of Death.<br>";
		}
		else if(enemy.hasExactly("Stronghold")){
			cdNull.def = true;
			cdNull.res = true;
			if(pCheck == true){
				enemy.penalty.panic = false;
			}
			comboText += enemy.name + " has neutralized [Panic] and penalties to def & res with Stronghold.<br>";
		}
		
		if(skillNames.length > 0){
			var statChanges = [];
			for(var stat in combDebuffs){
				if(combDebuffs[stat] < Math.min(enemy.debuffs[stat], enemy.combatDebuffs[stat]) && cdNull[stat] == false){
					enemy.combatDebuffs[stat] = combDebuffs[stat];
					statChanges.push(stat + " " + combDebuffs[stat]);
				}
			}
			if(statChanges.length > 0){
				comboText += this.name + " has turn-start debuffing skills: " + skillNames.join(", ") + ". Effect on " + enemy.name + ": " + statChanges.join(", ") + "<br>";
			}
		}
		
		return comboText;
	};
	
	this.getPhantom = function(stat){
		var pStat = "Phantom " + stat;
		var phValue = 0;
		if(this.has(pStat) == 1){
			phValue = 5;
		}
		else if(this.has(pStat) == 2){
			phValue = 8;
		}
		else if(this.has(pStat) == 3){
			phValue = 10;
		}
		if(stat == "Spd" && (this.hasExactly("Sharp War Sword") || (this.hasExactly("Guardian Fang") && this.rValue == 5))){
			phValue += 10;
		}
		if(stat == "Spd" && ((this.hasExactly("Bun-Bun Baton") && this.rValue == 5) || (this.hasExactly("Areadbhar") && this.rValue > 0) || this.hasExactly("Sisterly Axe") || this.hasExactly("Swirling Scimitar") || this.has("Jehanna Dagger") || this.has("Jehanna Lance"))){
			phValue += 7;
		}
		if(stat == "Spd" && (this.hasExactly("Close Call 4") || this.hasExactly("Repel 4") || this.hasExactly("Spurn 4") || this.hasExactly("Beast Sense 4") || this.hasExactly("Binding Necklace+") || this.hasExactly("Buffer 4") || this.hasExactly("Believe in Love") || this.hasExactly("Moon-Twin Wing+") || this.hasExactly("Lone Wolf"))){
			phValue += 7;
		}
		if(stat == "Res" && (this.hasExactly("High Dragon Wall") || this.hasExactly("Pure Dragon Wall"))){
			phValue += 5;
		}
		if(stat == "Res" && this.hasExactly("Dragon Fang Fire")){
			phValue += 5;
		}
		return phValue;
	};
	
	//function to reduce cd from wrath
	this.wrath = function(){				
		var wrathText = "";
		if(this.specialIndex != -1 && data.defensiveSpecials.indexOf(data.skills[this.specialIndex].name) == -1 && data.gaeSpecials.indexOf(data.skills[this.specialIndex].name) == -1){
			if((this.hasExactly("Berserk Armads") || this.hasExactly("Tome Of Thoron") || (this.hasExactly("Devil Axe") && this.rValue == 5)) && this.hp/this.maxHp <= .75){
				this.charge++;
				wrathText += this.name + " has special charge reduced by 1 from " + data.skills[this.weaponIndex].name + "<br>";
			}
			if(this.hasExactly("Wrath 1") || this.hasExactly("Wrath 2") || this.hasExactly("Wrath 3")){
				if(this.hp/this.maxHp <= .25 * this.has("Wrath")){
					this.charge++;
					wrathText += this.name + " has special charge reduced by 1 from " + data.skills[this.bIndex].name + ".<br>";
				}
			}
		}
		return wrathText;
	};
	
	this.splash = function(enemy,turn){
		var splashText = "";
		if(this.hasExactly("Sinmara") && this.toggle.weapon == 1){
			enemy.hp = Math.max(enemy.hp-20,1);
			splashText += this.name + " activates Sinmara.  " + enemy.name + " takes 20 damage.<br>";
		}
		if((this.hasExactly("Upheaval") || this.hasExactly("Woeful Upheaval")) && turn == 1){
			enemy.hp = Math.max(enemy.hp-7,1);
			splashText += this.name + " activates " + data.skills[this.cIndex].name + ".  " + enemy.name + " takes 7 damage.<br>";
		}
		if(this.hasExactly("Upheaval+") && turn == 1){
			enemy.hp = Math.max(enemy.hp-10,1);
			splashText += this.name + " activates Upheaval+.  " + enemy.name + " takes 10 damage.<br>";
		}
		if(this.hasExactly("Hrist") && this.hp / this.maxHp >= 1 && this.toggle.weapon == 1){
			this.hp = Math.max(this.hp-1,1);
			splashText += this.name + " activates Hrist.  " + this.name + " takes 1 damage.<br>";
		}
		if(this.hasExactly("Dark Spikes T") && this.rValue == 5){
			this.hp = Math.max(this.hp-1,1);
			splashText += this.name + " activates Dark Spikes T.  " + this.name + " takes 1 damage.<br>";
		}
		if(this.hasExactly("Bow of Repose") && this.hp / this.maxHp >= 1 && this.toggle.weapon > 9){
			this.hp = Math.max(this.hp-1,1);
			splashText += this.name + " activates Bow of Repose.  " + this.name + " takes 1 damage.<br>";
		}
		if(this.hasExactly("Persecution Bow") && this.rValue == 5 && this.toggle.weapon == 1){
			this.hp = Math.max(this.hp-1,1);
			splashText += this.name + " activates Persecution Bow.  " + this.name + " takes 1 damage.<br>";
		}
		if(this.hasExactly("Mastermind")){
			this.hp = Math.max(this.hp-1,1);
			splashText += this.name + " activates Mastermind.  " + this.name + " takes 1 damage.<br>";
		}
		if(this.hasExactly("Beyond Witchery")){
			if(turn == 1){
				this.hp = Math.max(this.hp-2,1);
				splashText += this.name + " activates Beyond Witchery.  " + this.name + " takes 2 damage.<br>";
			}
			else{
				this.hp = Math.max(this.hp-1,1);
				splashText += this.name + " activates Beyond Witchery.  " + this.name + " takes 1 damage.<br>";
			}
		}
		if(this.hasExactly("Paranoia") || this.hasExactly("Divine Talon")){
			this.hp = Math.max(this.hp-1,1);
			splashText += this.name + " activates " + data.skills[this.cIndex].name + ".  " + this.name + " takes 1 damage.<br>";
		}
		return splashText;
	};
	
	this.pulse = function(enemy,turn){
		var timeText = "";
		var timeTurn = 0;
		var stackCharge = 0;
		var allStats = getEffStats(this, enemy, turn);
		
		//check pre-pulse CD state for rewinds
		if(enemy.hasExactly("Inspirited Spear") && enemy.toggle.weapon == 1 && this.specialIndex != -1 && data.defensiveSpecials.indexOf(data.skills[this.specialIndex].name) == -1 && data.gaeSpecials.indexOf(data.skills[this.specialIndex].name) == -1 && data.skills[this.specialIndex].charge - this.charge <= 1 && data.skills[this.specialIndex].charge - this.initSkillCharge() > 1 && allStats[22] > this.def){
			stackCharge--;
			timeText += data.skills[enemy.weaponIndex].name + " increases CD by 1.<br>";
		}

		//Calculate recurring CD reductions that charge at max charge first
		if((this.hasExactly("Shamshir") || (this.hasExactly("Saintly Seraphim") && this.toggle.weapon > 0) || this.hasExactly("Larcei's Edge") || this.hasExactly("Summer Strikers")) && this.rValue == 5 && this.charge - this.initSkillCharge() == 0 && this.precharge < 1){
			stackCharge++;
			timeText += data.skills[this.weaponIndex].name + " reduces CD by 1.<br>";
		}
		else if((this.hasExactly("Tome of Reglay") || this.hasExactly("Demonic Tome") || ((this.hasExactly("Inner Wellspring") || this.hasExactly("Majestic Glitnir")) && this.toggle.weapon == 1) || this.hasExactly("Breath of Flame") || (this.hasExactly("Gusty War Bow") && (this.toggle.weapon == 1 || this.toggle.weapon == 3)) || ((this.hasExactly("Vassal-Saint Steel") || this.hasExactly("Heired Forseti") || this.hasExactly("Hoshido's Breath") || this.hasExactly("Duskstone")) && this.hp / this.maxHp >= 0.25) || (this.hasExactly("Studied Forblaze") && this.rValue > 0) || this.hasExactly("Arcane Tempest") || this.hasExactly("Berserker Axe") || this.hasExactly("Hungry Cat Fang") || this.hasExactly("Opposing Stones") || this.hasExactly("Icy Ravager")) && this.charge - this.initSkillCharge() == 0 && this.precharge < 1){
			stackCharge++;
			timeText += data.skills[this.weaponIndex].name + " reduces CD by 1.<br>";
		}
		else if(((this.hasExactly("Lone-Wolf Blade") || this.hasExactly("Closing Florets")) && this.hp / this.maxHp >= 0.25) || (this.hasExactly("True-Bond Bow") && this.toggle.weapon == 1)){
			if(this.charge - this.initSkillCharge() == 0 && this.precharge < 1){
				stackCharge += 2;
				timeText += data.skills[this.weaponIndex].name + " reduces CD by 2.<br>";
			}
			else if(this.charge - this.initSkillCharge() == 1 && this.precharge < 2){
				stackCharge++;
				timeText += data.skills[this.weaponIndex].name + " reduces CD by 1.<br>";
			}
		}
		if((this.hasSlot("Time's Pulse","c") || (this.has("Ostia's Pulse 2") && this.toggle.c == 1) || this.hasExactly("Infantry Pulse 4") || this.hasExactly("Time Pulse Edge") || this.hasExactly("Time Pulse Helm")) && this.charge - this.initSkillCharge() == 0 && this.precharge < 1){
			timeTurn = Math.max(4 - this.hasSlot("Time's Pulse","c"), 1);
			if(this.hasSlot("Time's Pulse","c") > 2 || turn % timeTurn == 1 || (this.has("Ostia's Pulse 2") && this.toggle.c == 1) || this.hasExactly("Infantry Pulse 4") || this.hasExactly("Time Pulse Edge") || this.hasExactly("Time Pulse Helm")){
				stackCharge++;
				timeText += data.skills[this.cIndex].name + " reduces CD by 1.<br>";
			}
		}
		else if((this.hasExactly("Opened Domain") || this.hasExactly("Beast Threaten") || this.hasExactly("Connected World")) && this.toggle.c == 1 && this.charge - this.initSkillCharge() == 0 && this.precharge < 1){
			stackCharge++;
			timeText += data.skills[this.cIndex].name + " reduces CD by 1.<br>";
		}
		else if(this.hasExactly("Fanged Ties") && this.toggle.c == 1 && (this.buddy.adjacent > 0 || this.buddy.two > 0)){
			if(this.charge - this.initSkillCharge() == 0 && this.precharge < 1){
				stackCharge += 2;
				timeText += "Fanged Ties reduces CD by 2.<br>";
			}
			else if(this.charge - this.initSkillCharge() == 1 && this.precharge < 2){
				stackCharge++;
				timeText += "Fanged Ties reduces CD by 1.<br>";
			}
		}
		if(this.hasSlot("Time's Pulse","s") && this.charge - this.initSkillCharge() == 0 && this.precharge < 1){
			timeTurn = Math.max(4 - this.hasSlot("Time's Pulse","s"), 1);
			if(this.hasSlot("Time's Pulse","s") > 2 || turn % timeTurn == 1){
				stackCharge++;
				timeText += data.skills[this.sIndex].name + " reduces CD by 1.<br>";
			}
		}
		if((this.hasExactly("Chivalric Aura") || this.hasExactly("Supreme Astra") || this.hasExactly("Sublime Heaven 2") || this.hasExactly("Warp Ragnarok")) && this.charge - this.initSkillCharge() == 0 && this.precharge < 1){
			stackCharge++;
			timeText += data.skills[this.specialIndex].name + " reduces CD by 1.<br>";
		}
		if(this.hasExactly("Time Pulse Echo") && this.charge - this.initSkillCharge() == 0 && this.precharge < 1){
			stackCharge++;
			timeText += "Time Pulse Echo reduces CD by 1.<br>";
			
		}
		if(this.support.tPulse > 0 && this.charge - this.initSkillCharge() == 0 && this.precharge < 1){
			stackCharge += this.support.tPulse;
			timeText += "Time's Pulse Support reduces CD by " + this.support.tPulse + ".<br>";
		}
		//Calculate Turn x reductions
		if(turn == 1){
			if(this.hasExactly("Missiletainn") || (this.hasExactly("Studied Forblaze") && this.rValue < 0) || this.hasExactly("Ascending Blade") || this.hasExactly("True-Love Roses") || this.hasExactly("Arcane Eclipse") || this.hasExactly("Desert-Tiger Axe")){
				this.charge++;
				timeText += data.skills[this.weaponIndex].name + " reduces CD by 1.<br>";
			}
			if(((this.hasExactly("Scarlet Sword") || this.hasExactly("Dark Excalibur")) && this.rValue == 5) || this.has("It's Curtains...") || this.has("Ouch Pouch") || this.has("Quick Dagger") || this.hasExactly("Wolfpup Fang") || this.hasExactly("Radiant Aether 2") || this.hasExactly("Dryblade Lance") || this.hasExactly("Magic Rabbits") || (this.hasExactly("Sokkvabekkr") && this.rValue == 5) || this.hasExactly("Tome of Luxuries") || this.hasExactly("Sandglass Bow")){
				this.charge += 2;
				var cdrName = data.skills[this.weaponIndex].name;
				if(this.hasExactly("Radiant Aether 2")){
					cdrName = data.skills[this.specialIndex].name;
				}
				timeText += cdrName + " reduces CD by 2.<br>";
			}
			if(this.hasExactly("S Drink")){
				this.charge++;
				timeText += "S Drink reduces CD by 1.<br>";
			}
			//Set Shield Pulse charge
			if(this.has("Shield Pulse") || this.has("Hardy Fighter") || this.hasExactly("Moonlight Stone") || this.hasExactly("Buffer 4") || (this.hasExactly("Primordial Breath") && this.rValue == 5)){
				if(data.defensiveSpecials.indexOf(data.skills[this.specialIndex].name) != -1){
					if(this.has("Shield Pulse") == 3 || this.has("Hardy Fighter") == 3 || this.hasExactly("Moonlight Stone") || this.hasExactly("Buffer 4") || (this.hasExactly("Primordial Breath") && this.rValue == 5)){
						this.charge += 2;
						var chText = "";
						if(this.hasExactly("Moonlight Stone") || (this.hasExactly("Primordial Breath") && this.rValue == 5)){
							chText = data.skills[this.weaponIndex].name;
						}
						else{
							chText = data.skills[this.bIndex].name;
						}
						timeText += chText + " reduces CD by 2.<br>";
					}
					else
					{
						this.charge += 1;
						timeText += data.skills[this.bIndex].name + " reduces CD by 1.<br>";
					}
				}
			}
			if(this.has("Quickened Pulse")){
				this.charge++;
				timeText += "Quickened Pulse reduces CD by 1.<br>";
			}
			if(this.has("Seidr Shell") || this.hasExactly("Brutal Shell")){
				this.charge += 3;
				timeText += data.skills[this.specialIndex].name + " reduces CD by 3.<br>";
			}
			if(this.has("Life Unending")){
				this.charge += 5;
				timeText += data.skills[this.specialIndex].name + " reduces CD by 5.<br>";
			}
			if(this.hasExactly("Njorun's Zeal 2")){
				this.charge++;
				timeText += "Njorun's Zeal 2 reduces CD by 1.<br>";
			}
		}
		else if(turn == 4){
			if(this.hasExactly("Nidavellir Lots")){
				this.charge += 3;
				timeText += "Nidavellir Lots reduces CD by 3.<br>";
			}
			if(this.hasExactly("Seidr Shell+")){
				this.charge += 3;
				timeText += data.skills[this.specialIndex].name + " reduces CD by 3.<br>";
			}
		}
		if(turn < 4 && this.hasExactly("Ancient Codex") && this.rValue == 5){
			this.charge++;
			timeText += "Ancient Codex reduces CD by 1.<br>";
		}
		if((turn < 4 || this.hp / this.maxHp < 1) && this.hasExactly("Thunderer Tome")){
			this.charge++;
			timeText += "Thunderer Tome reduces CD by 1.<br>";
		}
		if(turn < 5){
			if(this.hasExactly("Nidavellir Ballista")){
				this.charge += 3;
				timeText += "Nidavellir Ballista reduces CD by 3.<br>";
			}
			if(this.hasExactly("Brutal Shell+")){
				this.charge += 3;
				timeText += "Brutal Shell+ reduces CD by 3.<br>";
			}
		}
		if(this.hasExactly("Divine Whimsy") && this.toggle.weapon == 1){
			this.charge++;
			timeText += "Divine Whimsy reduces CD by 1.<br>";
		}
		if(this.hasExactly("Sisterly War Axe") && turn % 2 == 1){
			this.charge += 2;
			timeText += "Sisterly War Axe reduces CD by 2.<br>";
		}
		if(this.hasExactly("Persecution Bow") && this.rValue == 5 && this.toggle.weapon == 1){
			this.charge++;
			timeText += "Persecution Bow reduces CD by 1.<br>";
		}
		if(this.hasExactly("Bride's Fang") && this.rValue > 0){
			this.charge++;
			timeText += "Bride's Fang reduces CD by 1.<br>";
		}
		if(this.hasExactly("Supreme Thokk") && this.hp / this.maxHp >= 0.25){
			this.charge++;
			timeText += "Supreme Thokk reduces CD by 1.<br>";
		}
		if(this.hasExactly("Dead-Crow Tome") && this.hp / this.maxHp >= 0.25){
			var dcVal = 1;
			if(this.hp / this.maxHp >= 1){
				dcVal++;
			}
			this.charge += dcVal;
			timeText += "Dead-Crow Tome reduces CD by " + dcVal + ".<br>";
		}
		if(this.hasExactly("Stone of Delights")){
			this.charge++;
			timeText += "Stone of Delights reduces CD by 1.<br>";
		}
		if(this.hasExactly("Full Rabbit Fang") && (this.toggle.weapon == 1 || this.toggle.weapon == 3)){
			this.charge++;
			timeText += "Full Rabbit Fang reduces CD by 1.<br>";
		}
		if(this.hasExactly("Bow of Frelia") && this.rValue == 5){
			this.charge++;
			timeText += "Bow of Frelia reduces CD by 1.<br>";
		}
		
		if(this.hasExactly("Beyond Witchery")){
			if(turn == 1){
				this.charge += 2;
				timeText += "Beyond Witchery reduces CD by 2.<br>";
			}
			else{
				this.charge++;
				timeText += "Beyond Witchery reduces CD by 1.<br>";
			}
			
		}
		if(this.hasExactly("Gift of Guidance") && this.hp / this.maxHp >= 0.25){
			this.charge += 2;
			timeText += "Gift of Guidance reduces CD by 2.<br>";
		}
		
		if(this.hasExactly("Dark Perfume")){
			this.charge++;
			timeText += "Dark Perfume reduces CD by 1.<br>";
		}
		
		if(this.hasExactly("Pulse Up Blades") || this.hasExactly("Pulse Up Ploy")){
			this.charge++;
			timeText += data.skills[this.cIndex].name + " reduces CD by 1.<br>";
		}
		
		if(this.hasCaptain("Secret Maneuver") && this.toggle.sd >= 0 && turn > 1 && turn < 6){
			this.charge++;
			timeText += "Secret Maneuver reduces CD by 1.<br>";
		}
			
		this.charge = this.charge + stackCharge;
		
		//EP Pulse
		if((enemy.hasExactly("Icy Ravager") || (enemy.hasExactly("Duskstone") && enemy.hp / enemy.maxHp >= 0.25)) && enemy.charge - enemy.initSkillCharge() == 0 && enemy.precharge < 1){
			enemy.charge++;
			timeText += data.skills[enemy.weaponIndex].name + " reduces CD by 1.<br>";
		}
		if(enemy.hasExactly("Connected World") && enemy.toggle.c == 1 && enemy.charge - enemy.initSkillCharge() == 0 && enemy.precharge < 1){
			enemy.charge++;
			timeText += data.skills[enemy.cIndex].name + " reduces CD by 1.<br>";
		}
		if(enemy.support.tPulse > 0 && enemy.charge - enemy.initSkillCharge() == 0 && enemy.precharge < 1){
			enemy.charge += enemy.support.tPulse;
			timeText += "Time's Pulse Support reduces CD by " + enemy.support.tPulse + ".<br>";
		}
		
		return timeText;
	};
	
	//Return effective damage modifier
	this.effMod = function(enemy, currTurn){
		var allStats = getEffStats(this, enemy, currTurn);
		var effVal = 1;
		if(!enemy.hasExactly("Svalinn Shield") && !enemy.bonus.fEmblem && !enemy.bonus.nullArmor && !(enemy.hasExactly("Maltet") && enemy.rValue > 0) && !enemy.hasExactly("Dew Dragonstone") && !enemy.hasExactly("Dragonhide") && !enemy.hasExactly("Opposing Stones") && enemy.moveType == "armored" && (this.has("Hammer") || this.has("Armorslayer") || this.has("Heavy Spear") || this.has("Slaying Hammer") || this.has("Armorsmasher") || this.has("Slaying Spear") || this.hasExactly("Thani") || this.hasExactly("Wing Sword") || this.hasExactly("Warrior Princess") || this.hasExactly("Rhomphaia") || this.hasExactly("Dauntless Lance") || this.has("Sky Maiougi") || this.hasExactly("Dawn Suzu") || this.hasExactly("Axe of Virility") || this.hasExactly("Florina's Lance") || this.hasExactly("Whitewing Spear") || this.hasExactly("Oboro's Spear") || this.hasExactly("Demonic Breath") || this.has("Pegasus Carrot") || this.hasExactly("Hana's Katana") || this.hasExactly("Deep-Blue Bow") || this.hasExactly("Selena's Blade") || this.hasExactly("Light of Dawn") || this.hasExactly("Rapier") || this.hasExactly("Brilliant Rapier") || this.hasExactly("Frederick's Axe") || this.hasExactly("Conjurer Curios") || this.has("Reginleif") || this.hasExactly("Lordly Lance") || this.hasExactly("Mirage Feather") || this.hasExactly("Randgridr") || this.hasExactly("Jubilant Blade") || this.hasExactly("Bun-Bun Baton") || this.hasExactly("Zephyr Breath") || this.hasExactly("Feather Sword") || this.hasExactly("Joyful Vows") || this.hasExactly("Dolphin-Dive Axe") || this.hasExactly("Mermaid Bow") || this.hasExactly("New Dawn") || this.hasExactly("War-God Mjolnir") || this.hasExactly("Sworn Lance") || this.hasExactly("Destiny's Bow") || this.has("Armorpin Dagger") || this.hasExactly("Dew Dragonstone") || this.hasExactly("Wing-Lifted Spear") || this.hasExactly("Moonlight Drop") || this.hasExactly("Geirdriful") || this.hasExactly("Fujin-Raijin Yumi") || this.hasExactly("Pure-Wing Spear") || this.hasExactly("Silver of Dawn"))){
			effVal = 1.5;
		}
		else if(!enemy.has("Iote's Shield") && !enemy.bonus.fEmblem && !enemy.has("Dragonskin") && !enemy.has("Ashera's Chosen") && !enemy.hasExactly("Dragoon Shield") && !enemy.hasExactly("Gurgurant") && !enemy.hasExactly("Hel's Reaper") && !enemy.hasExactly("Dragonscale") && !enemy.hasExactly("Bushido 2") && !enemy.hasExactly("Pastel Poleaxe") && !enemy.hasExactly("Tempest's Claw") && !enemy.hasExactly("Thracia Kinglance") && !enemy.hasExactly("Heired Gungnir") && !enemy.bonus.nullFlying && enemy.moveType == "flying" && (this.hasExactly("Excalibur") || this.weaponType=="bow" || this.hasExactly("Winds of Change") || this.hasExactly("Tome of Order") || this.hasExactly("Grafcalibur") || this.hasExactly("Tender Excalibur") || this.hasExactly("Praise-Piner Axe"))){
			effVal = 1.5;
		}
		else if(!enemy.has("Grani's Shield") && !enemy.bonus.fEmblem && enemy.moveType == "cavalry" && (this.has("Raudrwolf") || this.has("Blarwolf") || this.has("Gronnwolf") || this.has("Ridersbane") || this.has("Zanbato") || this.hasExactly("Thani") || this.hasExactly("Wing Sword") || this.hasExactly("Poleaxe") || this.hasExactly("Poleaxe+") || this.hasExactly("Rhomphaia") || this.has("Dusk Uchiwa") || this.hasExactly("Dawn Suzu") || this.has("Taguel Fang") || this.has("Bunny Fang") || this.hasExactly("Hermit's Tome") || this.hasExactly("Light of Dawn") || this.hasExactly("Rapier") || this.hasExactly("Brilliant Rapier") || this.has("Reginleif") || this.hasExactly("Mirage Feather") || this.hasExactly("Laid-Back Blade") || this.hasExactly("Blue-Crow Tome") || this.hasExactly("Joyful Vows") || this.has("Caltrop Dagger") || this.hasExactly("Dark Spikes T") || this.hasExactly("Obsessive Curse") || this.hasExactly("Masking Axe") || this.hasExactly("New Dawn") || this.hasExactly("Wing-Lifted Spear") || this.hasExactly("Moonlight Drop") || this.hasExactly("Keen Rabbit Fang") || this.hasExactly("Wary Rabbit Fang") || this.hasExactly("Hyperion Lance") || this.hasExactly("Pure-Wing Spear") || this.hasExactly("Thief's Honesty") || this.hasExactly("Silver of Dawn") || (this.hasExactly("Spear of Assal") && this.rValue > 0) || this.hasExactly("Full Rabbit Fang") || this.hasExactly("Fell Slaystone"))){
			effVal = 1.5;
		}
		else if((enemy.weaponType == "redtome" || enemy.weaponType == "bluetome" || enemy.weaponType == "greentome" || enemy.weaponType == "graytome") && (this.has("Kitty Paddle") || this.hasExactly("Aureola") || this.hasExactly("Radiant Aureola") || this.hasExactly("Blessed Aureola"))){
			effVal = 1.5;
		}
		else if(this.dragonEff(enemy) == true){
			effVal = 1.5;
			if(enemy.hasExactly("Dark Scripture")){
				effVal = 1;
			}
		}
		else if(enemy.weaponType == "beast" && (this.hasExactly("Saehrimnir") || this.hasExactly("Eldhrimnir") || this.hasExactly("Hunting Blade") || this.hasExactly("Ninis's Ice Lance") || this.hasExactly("Flame Lance") || this.hasExactly("Demonic Tome") || this.hasExactly("Blazing Polearms") || this.hasExactly("Gusty War Bow") || this.hasExactly("Breaker Bow"))){
			effVal = 1.5;
		}
		else if(enemy.moveType == "infantry" && !enemy.bonus.fEmblem && (this.has("Poison Dagger"))){
			effVal = 1.5;
		}
		else if((enemy.weaponType == "sword" || enemy.weaponType == "lance" || enemy.weaponType == "axe" || (enemy.weaponType == "bow" && enemy.color == "gray")) && (this.hasExactly("Feather Sword") || this.hasExactly("Dolphin-Dive Axe"))){
			effVal = 1.5;
		}
		else if(enemy.hasExactly("Tempest's Claw") && this.weaponType == "bluetome"){
			effVal = 1.5;
		}
		else if((this.hasExactly("Swift Slice") || this.hasExactly("Swift Ice")) && this.initiator && ((enemy.moveType == "infantry" && enemy.weaponType != "beast" && enemy.weaponType != "dragon" && this.getPhantom("Spd") + allStats[1] >= enemy.getPhantom("Spd") + allStats[5] + 20) || ((enemy.moveType != "infantry" || enemy.weaponType == "beast" || enemy.weaponType == "dragon") && this.getPhantom("Spd") + allStats[1] >= enemy.getPhantom("Spd") + allStats[5] + 5)) && !enemy.hasExactly("Breath of Blight") && !enemy.hasExactly("Sublime Surge") && !enemy.hasExactly("Snow's Grace") && !enemy.hasExactly("Eerie Scripture") && !enemy.hasExactly("Devoted Breath") && !enemy.bonus.nullDragon){
			effVal = 1.5;
		}
		return effVal;
	};
	
	//Dragon Effective checker
	this.dragonEff = function(enemy){
		if(((enemy.weaponType == "dragon" || enemy.hasExactly("Loptous") || enemy.hasExactly("Dark Scripture")) && !enemy.hasExactly("Breath of Blight") && !enemy.hasExactly("Sublime Surge") && !enemy.hasExactly("Snow's Grace") && !enemy.hasExactly("Eerie Scripture") && !enemy.hasExactly("Devoted Breath") && !enemy.bonus.nullDragon) && (this.has("Falchion") || this.has("Naga") || this.hasExactly("Breath Of Fog") || (this.hasExactly("Binding Blade") && this.rValue > 0) || this.hasExactly("Summer's Breath") || this.has("Cloud Maiougi") || this.hasExactly("Divine Mist") || this.has("Splashy Bucket") || this.hasExactly("Dragonbind") || this.hasExactly("Razing Breath") || this.hasExactly("Divine Breath") || this.hasExactly("Ninis's Ice Lance") || this.hasExactly("Dracofalchion") || (this.hasExactly("Geirskogul") && this.rValue > 0) || this.hasExactly("Ethereal Breath") || this.hasExactly("Ifingr") || this.has("Dragonslasher") || this.hasExactly("Frostfire Breath") || this.hasExactly("Demonic Tome") || this.hasExactly("Blazing Polearms") || this.hasExactly("Remote Breath") || this.hasExactly("Spirit Forest Writ") || this.hasExactly("Awoken Breath") || this.hasExactly("Twin Divinestone") || this.hasExactly("Hero-King Sword") || this.hasExactly("Opposing Stones") || this.hasExactly("Ancient Majesty") || this.hasExactly("Ancient Voice") || this.bonus.divineFang)){
			return true;
		}
		else{
			return false;
		}
	}

	//For buffs that act like spur and stack
	//Must be passed enemy for Earth Boost
	this.startCombatSpur = function(enemy,currTurn,galeused){
		var allStats = getEffStats(this, enemy, currTurn);
		var boostText = "";
		var parity = false;
		if(this.hasExactly("Queensblade") || enemy.hasExactly("Queensblade") || this.hasExactly("Breezy Spear") || enemy.hasExactly("Breezy Spear")){
			parity = true;
		}

		if(!this.initiator && enemy.range == "ranged"){
			var skillName = "";
			var buffVal = 0;
			var sBuffVal = 0;
			if(this.has("Distant Def")){
				if(this.aIndex != -1 && data.skills[this.aIndex].name.indexOf("Distant Def") != -1){
					buffVal += 2;
					if(data.skills[this.aIndex].name.indexOf("2") != -1){
						buffVal += 2;
					}
					else if(data.skills[this.aIndex].name.indexOf("3") != -1){
						buffVal += 4;
					}
					else if(data.skills[this.aIndex].name.indexOf("4") != -1){
						buffVal += 6;
					}
					skillName = data.skills[this.aIndex].name;
					boostText += this.name + " gets +" + buffVal + " def and res from being attacked from range with " + skillName + ".<br>";
				}
				if(this.sIndex != -1 && data.skills[this.sIndex].name.indexOf("Distant Def") != -1){
					sBuffVal += 2;
					if(data.skills[this.sIndex].name.indexOf("2") != -1){
						sBuffVal += 2;
					}
					else if(data.skills[this.sIndex].name.indexOf("3") != -1){
						sBuffVal += 4;
					}
					skillName = data.skills[this.sIndex].name;
					boostText += this.name + " gets +" + sBuffVal + " def and res from being attacked from range with " + skillName + ".<br>";
				}
				this.combatSpur.def += buffVal + sBuffVal;
				this.combatSpur.res += buffVal + sBuffVal;
			}
			if(this.has("Guard Bow")){
				buffVal = 6;
				skillName = data.skills[this.weaponIndex].name;
				this.combatSpur.def += buffVal;
				this.combatSpur.res += buffVal;
				boostText += this.name + " gets +" + buffVal + " def and res from being attacked with " + skillName + ".<br>";
			}
			else if(this.hasExactly("Eckesachs") && this.rValue == 5){
				buffVal = 6;
				skillName = data.skills[this.weaponIndex].name;
				this.combatSpur.def += buffVal;
				this.combatSpur.res += buffVal;
				boostText += this.name + " gets +" + buffVal + " def and res from being attacked with " + skillName + ".<br>";
			}
			else if(this.has("Blarserpent") || this.has("Gronnserpent") || this.has("Raudrserpent")){
				buffVal = 6;
				skillName = data.skills[this.weaponIndex].name;
				this.combatSpur.def += buffVal;
				this.combatSpur.res += buffVal;
				boostText += this.name + " gets +" + buffVal + " def and res from being attacked with " + skillName + ".<br>";
			}
			else if(this.hasExactly("Bow of Devotion")){
				buffVal = 4;
				skillName = data.skills[this.weaponIndex].name;
				this.combatSpur.atk += buffVal;
				this.combatSpur.spd += buffVal;
				this.combatSpur.def += buffVal;
				this.combatSpur.res += buffVal;
				boostText += this.name + " gets +" + buffVal + " to all stats from being attacked with " + skillName + ".<br>";
			}
			else if(this.hasExactly("Kriemhild") && this.toggle.weapon == 1){
				this.anyCounter = true;
			}
		}

		if(!this.initiator && enemy.range == "melee"){
			var skillName = "";
			var buffVal = 0;
			var sBuffVal = 0;
			if(this.has("Close Def")){
				if(this.aIndex != -1 && data.skills[this.aIndex].name.indexOf("Close Def") != -1){
					buffVal += 2;
					if(data.skills[this.aIndex].name.indexOf("2") != -1){
						buffVal += 2;
					}
					else if(data.skills[this.aIndex].name.indexOf("3") != -1){
						buffVal += 4;
					}
					else if(data.skills[this.aIndex].name.indexOf("4") != -1){
						buffVal += 6;
					}
					skillName = data.skills[this.aIndex].name;
					boostText += this.name + " gets +" + buffVal + " def and res from being attacked from melee with " + skillName + ".<br>";
				}
				if(this.sIndex != -1 && data.skills[this.sIndex].name.indexOf("Close Def") != -1){
					sBuffVal += 2;
					if(data.skills[this.sIndex].name.indexOf("2") != -1){
						sBuffVal += 2;
					}
					else if(data.skills[this.sIndex].name.indexOf("3") != -1){
						sBuffVal += 4;
					}
					skillName = data.skills[this.sIndex].name;
					boostText += this.name + " gets +" + sBuffVal + " def and res from being attacked from melee with " + skillName + ".<br>";
				}
				this.combatSpur.def += buffVal + sBuffVal;
				this.combatSpur.res += buffVal + sBuffVal;
			}
			if(this.hasExactly("Vidofnir")){
				buffVal = 7;
				skillName = data.skills[this.weaponIndex].name;
				if(this.rValue > 0){
					this.combatSpur.def += buffVal;
					this.combatSpur.res += buffVal;
					boostText += this.name + " gets +" + buffVal + " def and res from being attacked from melee with " + skillName + ".<br>";
				}
				else if(enemy.weaponType != "dragon"){
					this.combatSpur.def += buffVal;
					boostText += this.name + " gets +" + buffVal + " def from being attacked from melee with " + skillName + ".<br>";
				}
			}
			else if(this.hasExactly("Florina's Lance") && this.rValue == 5){
				skillName = data.skills[this.weaponIndex].name;
				this.combatSpur.atk += 4;
				this.combatSpur.spd += 4;
				this.combatSpur.def += 4;
				this.combatSpur.res += 4;
				boostText += this.name + " gets +4 to all stats while defending with " + data.skills[this.weaponIndex].name + ".<br>";
			}
			else if(this.hasExactly("Oboro's Spear") && this.rValue == 5){
				skillName = data.skills[this.weaponIndex].name;
				this.combatSpur.def += 6;
				this.combatSpur.res += 6;
				boostText += this.name + " gets +6 to def and res while defending with " + data.skills[this.weaponIndex].name + ".<br>";
			}
		}

		if(this.combatStartHp / this.maxHp >= 1){
			if(this.hasExactly("Seashell") || this.hasExactly("Seashell+") || this.has("Refreshing Bolt") || this.has("Deft Harpoon") || this.has("Melon Crusher")){
				this.combatSpur.atk += 2;
				this.combatSpur.spd += 2;
				this.combatSpur.def += 2;
				this.combatSpur.res += 2;
				boostText += this.name + " gets +2 in all stats from being at full health with " + data.skills[this.weaponIndex].name + ".<br>";
			}
			if(this.has("Atk Spd Push")){
				if(this.hasSlot("Atk Spd Push","a") && !this.hasExactly("Atk Spd Push 4")){
					var buffVal = this.hasSlot("Atk Spd Push","a") + 2;
					this.combatSpur.atk += buffVal;
					this.combatSpur.spd += buffVal;
					boostText += this.name + " gets +" + buffVal + " atk and spd from being at full health with " + data.skills[this.aIndex].name + ".<br>";
				}
				if(this.hasSlot("Atk Spd Push","s")){
					var buffVal = this.hasSlot("Atk Spd Push","s") + 2;
					this.combatSpur.atk += buffVal;
					this.combatSpur.spd += buffVal;
					boostText += this.name + " gets +" + buffVal + " atk and spd from being at full health with " + data.skills[this.sIndex].name + ".<br>";
				}
			}
			if(this.has("Atk Def Push")){
				if(this.hasSlot("Atk Def Push","a") && !this.hasExactly("Atk Def Push 4")){
					var buffVal = this.hasSlot("Atk Def Push","a") + 2;
					this.combatSpur.atk += buffVal;
					this.combatSpur.def += buffVal;
					boostText += this.name + " gets +" + buffVal + " atk and def from being at full health with " + data.skills[this.aIndex].name + ".<br>";
				}
				if(this.hasSlot("Atk Def Push","s")){
					var buffVal = this.hasSlot("Atk Def Push","s") + 2;
					this.combatSpur.atk += buffVal;
					this.combatSpur.def += buffVal;
					boostText += this.name + " gets +" + buffVal + " atk and def from being at full health with " + data.skills[this.sIndex].name + ".<br>";
				}
			}
			if(this.has("Atk Res Push")){
				if(this.hasSlot("Atk Res Push","a") && !this.hasExactly("Atk Res Push 4")){
					var buffVal = this.hasSlot("Atk Res Push","a") + 2;
					this.combatSpur.atk += buffVal;
					this.combatSpur.res += buffVal;
					boostText += this.name + " gets +" + buffVal + " atk and res from being at full health with " + data.skills[this.aIndex].name + ".<br>";
				}
				if(this.hasSlot("Atk Res Push","s")){
					var buffVal = this.hasSlot("Atk Res Push","s") + 2;
					this.combatSpur.atk += buffVal;
					this.combatSpur.res += buffVal;
					boostText += this.name + " gets +" + buffVal + " atk and res from being at full health with " + data.skills[this.sIndex].name + ".<br>";
				}
			}
		}
		if(this.combatStartHp / this.maxHp >= 0.5){
			var skillName = "";
			//Lyfjaberg
			if(this.hasExactly("Lyfjaberg") && this.rValue < 0){
				skillName = data.skills[this.weaponIndex].name;
				this.combatSpur.atk += 4;
				this.combatSpur.spd += 4;
				boostText += this.name + " gets +4 atk and spd from being >= 50% HP with " + skillName + ".<br>";
			}
			//Laid-Back Blade
			else if(this.hasExactly("Laid-Back Blade")){
				skillName = data.skills[this.weaponIndex].name;
				this.combatSpur.atk += 3;
				this.combatSpur.spd += 3;
				this.combatSpur.def += 3;
				this.combatSpur.res += 3;
				boostText += this.name + " gets +3 to all stats from being >= 50% HP with " + skillName + ".<br>";
			}
			//Refined Weighted Lance
			else if(this.hasExactly("Weighted Lance") && this.rValue == 5){
				skillName = data.skills[this.weaponIndex].name;
				this.combatSpur.def += 4;
				this.combatSpur.res += 4;
				boostText += this.name + " gets +4 def and res from being >= 50% HP with " + skillName + ".<br>";
			}
			//Refined Bow of Beauty
			else if(this.hasExactly("Bow of Beauty") && this.rValue == 5){
				skillName = data.skills[this.weaponIndex].name;
				this.combatSpur.atk += 4;
				this.combatSpur.spd += 4;
				this.combatSpur.def += 4;
				boostText += this.name + " gets +4 atk/spd/def from being >= 50% HP with " + skillName + ".<br>";
			}
			//Genealogy Dancer Weapons
			else if(this.has("Courtly Mask")){
				skillName = data.skills[this.weaponIndex].name;
				this.combatSpur.atk += 5;
				this.combatSpur.res += 5;
				boostText += this.name + " gets +5 atk and res from being >= 50% HP with " + skillName + ".<br>";
			}
			//Refined Divine Tyrfing is in this group
			else if(this.has("Courtly Bow") || this.has("Courtly Candle") || this.has("Stout Lance") || this.has("Stout Axe") || (this.hasExactly("Divine Tyrfing") && this.rValue > 0)){
				skillName = data.skills[this.weaponIndex].name;
				this.combatSpur.atk += 5;
				this.combatSpur.def += 5;
				boostText += this.name + " gets +5 atk and def from being >= 50% HP with " + skillName + ".<br>";
			}
			//Effie's Lance
			else if(this.hasExactly("Effie's Lance")){
				skillName = data.skills[this.weaponIndex].name;
				this.combatSpur.atk += 6;
				boostText += this.name + " gets +6 atk from being >= 50% HP with " + skillName + ".<br>";
			}
			//Boost skills
			if(this.hasExactly("Fireflood Boost 3")){
				this.combatSpur.atk += 7;
				this.combatSpur.res += 7;
				boostText += this.name + " gets +7 atk & res from HP >= 50% with Fireflood Boost 3.<br>";
			}
			if(this.hasExactly("Earthfire Boost 3")){
				this.combatSpur.atk += 7;
				this.combatSpur.def += 7;
				boostText += this.name + " gets +7 atk & def from HP >= 50% with Earthfire Boost 3.<br>";
			}
			if(this.hasExactly("Earthwind Boost 3")){
				this.combatSpur.spd += 7;
				this.combatSpur.def += 7;
				boostText += this.name + " gets +7 spd & def from HP >= 50% with Earthwind Boost 3.<br>";
			}
			if(this.hasExactly("Firestorm Boost 3")){
				this.combatSpur.atk += 7;
				this.combatSpur.spd += 7;
				boostText += this.name + " gets +7 atk & spd from HP >= 50% with Firestorm Boost 3.<br>";
			}
			if(this.hasExactly("Deluge Boost 3")){
				this.combatSpur.spd += 7;
				this.combatSpur.res += 7;
				boostText += this.name + " gets +7 spd & res from HP >= 50% with Deluge Boost 3.<br>";
			}
		}
		
		if(this.combatStartHp / this.maxHp >= 0.25){
			if(this.hasExactly("Atk Spd Push 4")){
				this.combatSpur.atk += 7;
				this.combatSpur.spd += 7;
				boostText += this.name + " gets +7 atk and spd from being >= 25% HP with " + data.skills[this.aIndex].name + ".<br>";
			}
			else if(this.hasExactly("Atk Res Push 4")){
				this.combatSpur.atk += 7;
				this.combatSpur.res += 7;
				boostText += this.name + " gets +7 atk and res from being >= 25% HP with " + data.skills[this.aIndex].name + ".<br>";
			}
			else if(this.hasExactly("Atk Def Push 4")){
				this.combatSpur.atk += 7;
				this.combatSpur.def += 7;
				boostText += this.name + " gets +7 atk and def from being >= 25% HP with " + data.skills[this.aIndex].name + ".<br>";
			}
			else if(this.hasExactly("Distant Pressure")){
				this.combatSpur.spd += 5;
				boostText += this.name + " gets +5 spd from being >= 25% HP with " + data.skills[this.aIndex].name + ".<br>";
			}
			else if(this.hasExactly("Close Salvo") || this.hasExactly("Distant Storm")){
				this.combatSpur.atk += 5;
				boostText += this.name + " gets +5 atk from being >= 25% HP with " + data.skills[this.aIndex].name + ".<br>";
			}
		}

		if(enemy.combatStartHp / enemy.maxHp >= 1){
			if(this.hasExactly("Regal Blade")){
				var stat = 2;
				if(this.rValue > 0){
					stat++;
				}
				this.combatSpur.atk += stat;
				this.combatSpur.spd += stat;
				boostText += this.name + " gets +" + stat + " atk and spd from " + enemy.name + " being at full health with Regal Blade.<br>";
			}
			else if(this.hasExactly("Gleipnir")){
				var buffVal = 3;
				if(this.rValue > 0){
					buffVal = 4;
				}
				this.combatSpur.atk += buffVal;
				this.combatSpur.spd += buffVal;
				boostText += this.name + " gets +" + buffVal + " atk and spd from " + enemy.name + " being at full health with Gleipnir.<br>";
				if(this.rValue == 5){
					enemy.combatSpur.atk -= 4;
					enemy.combatSpur.spd -= 4;
					enemy.combatSpur.def -= 4;
					enemy.combatSpur.res -= 4;
					if(this.penalty.panic && !this.bonus.nullPanic){
						this.combatBuffs = {"atk":0,"spd":0,"def":0,"res":0};
						this.buffs = {"atk":0,"spd":0,"def":0,"res":0};
					}
					this.combatDebuffs = {"atk":0,"spd":0,"def":0,"res":0};
					this.debuffs = {"atk":0,"spd":0,"def":0,"res":0};
					boostText += this.name + " inflicts -4 to all stats to " + enemy.name + " and neutralizes penalties with " + data.skills[this.weaponIndex].name + ".<br>";
				}
			}
			else if(this.has("Flashing Carrot") || this.has("Beguiling Bow")){
				this.combatSpur.atk += 2;
				this.combatSpur.spd += 2;
				this.combatSpur.def += 2;
				this.combatSpur.res += 2;
				boostText += this.name + " gets +2 to all stats from " + enemy.name + " being at full health with " + data.skills[this.weaponIndex].name + ".<br>";
			}
		}
		
		if(enemy.combatStartHp / enemy.maxHp >= 0.5){
			//Refined Divine Tyrfing
			if(this.hasExactly("Divine Tyrfing") && this.rValue == 5){
				skillName = data.skills[this.weaponIndex].name;
				this.combatSpur.atk += 5;
				this.combatSpur.def += 5;
				boostText += this.name + " gets +5 atk and def from enemy >= 50% HP with " + skillName + ".<br>";
			}
		}
		
		if(this.maxHp > enemy.combatStartHp){
			if((this.hasExactly("Dignified Bow") || this.hasExactly("Jubilant Blade")) && this.rValue == 5){
				this.combatSpur.atk += 4;
				this.combatSpur.spd += 4;
				this.combatSpur.def += 4;
				this.combatSpur.res += 4;
				boostText += this.name + " gets +4 to all stats from having more Max HP than " + enemy.name + "'s HP with " + data.skills[this.weaponIndex].name + ".<br>";
			}
		}

		if(this.combatStartHp >= enemy.combatStartHp + 3){
			var skillName = "";

			var buffVal = 0;
			if(this.has("Earth Boost")){
				if(this.hasSlot("Earth Boost","a")){
					buffVal = this.hasSlot("Earth Boost","a") * 2;
					skillName = data.skills[this.aIndex].name;
					this.combatSpur.def += buffVal;
					boostText += this.name + " gets +" + buffVal + " def from having >=3 more hp than " + enemy.name + " with " + skillName + ".<br>";
				}
				if(this.hasSlot("Earth Boost","s")){
					buffVal = this.hasSlot("Earth Boost","s") * 2;
					skillName = data.skills[this.sIndex].name;
					this.combatSpur.def += buffVal;
					boostText += this.name + " gets +" + buffVal + " def from having >=3 more hp than " + enemy.name + " with " + skillName + ".<br>";
				}
			}
			if(this.has("Wind Boost")){
				if(this.hasSlot("Wind Boost","a")){
					buffVal = this.hasSlot("Wind Boost","a") * 2;
					skillName = data.skills[this.aIndex].name;
					this.combatSpur.spd += buffVal;
					boostText += this.name + " gets +" + buffVal + " spd from having >=3 more hp than " + enemy.name + " with " + skillName + ".<br>";
				}
				if(this.hasSlot("Wind Boost","s")){
					buffVal = this.hasSlot("Wind Boost","s") * 2;
					skillName = data.skills[this.sIndex].name;
					this.combatSpur.spd += buffVal;
					boostText += this.name + " gets +" + buffVal + " spd from having >=3 more hp than " + enemy.name + " with " + skillName + ".<br>";
				}
			}
			if(this.has("Fire Boost")){
				if(this.hasSlot("Fire Boost","a")){
					buffVal = this.hasSlot("Fire Boost","a") * 2;
					skillName = data.skills[this.aIndex].name;
					this.combatSpur.atk += buffVal;
					boostText += this.name + " gets +" + buffVal + " atk from having >=3 more hp than " + enemy.name + " with " + skillName + ".<br>";
				}
				if(this.hasSlot("Fire Boost","s")){
					buffVal = this.hasSlot("Fire Boost","s") * 2;
					skillName = data.skills[this.sIndex].name;
					this.combatSpur.atk += buffVal;
					boostText += this.name + " gets +" + buffVal + " atk from having >=3 more hp than " + enemy.name + " with " + skillName + ".<br>";
				}
			}
			if(this.has("Water Boost")){
				if(this.hasSlot("Water Boost","a")){
					buffVal = this.hasSlot("Water Boost","a") * 2;
					skillName = data.skills[this.aIndex].name;
					this.combatSpur.res += buffVal;
					boostText += this.name + " gets +" + buffVal + " res from having >=3 more hp than " + enemy.name + " with " + skillName + ".<br>";
				}
				if(this.hasSlot("Water Boost","s")){
					buffVal = this.hasSlot("Water Boost","s") * 2;
					skillName = data.skills[this.sIndex].name;
					this.combatSpur.res += buffVal;
					boostText += this.name + " gets +" + buffVal + " res from having >=3 more hp than " + enemy.name + " with " + skillName + ".<br>";
				}
			}
		}
		if(this.hasExactly("Primordial Boost") && (!this.initiator || this.combatStartHp / this.maxHp >= 0.5)){
			this.combatSpur.spd += 9;
			this.combatSpur.def += 9;
			this.combatSpur.res += 9;
			boostText += this.name + " gets +9 spd/def/res from enemy initiating or HP >= 50% with Primordial Boost.<br>";
		}
		//Bond skills
		if(this.has("Atk Res Bond")){
			var skillName = "";
			var buffVal = 0;
			if(this.hasSlot("Atk Res Bond","a") && this.toggle.a == 1){
				buffVal = this.hasSlot("Atk Res Bond","a") + 2;
				if(this.hasExactly("Atk Res Bond 4")){
					buffVal = 7;
					if(this.penalty.panic){
						this.combatBuffs.atk = 0;
						this.combatBuffs.res = 0;
						this.buffs.atk = 0;
						this.buffs.res = 0;
					}
					this.combatDebuffs.atk = 0;
					this.combatDebuffs.res = 0;
					this.debuffs.atk = 0;
					this.debuffs.res = 0;
					boostText += this.name + " has neutralized penalties to atk and res.<br>";
				}
				skillName = data.skills[this.aIndex].name;
				this.combatSpur.atk += buffVal;
				this.combatSpur.res += buffVal;
				boostText += this.name + " gets +" + buffVal + " atk and res from being adjacent to an ally with " + skillName + ".<br>";
			}
			if(this.hasSlot("Atk Res Bond","s") && this.toggle.s == 1){
				buffVal = this.hasSlot("Atk Res Bond","s") + 2;
				skillName = data.skills[this.sIndex].name;
				this.combatSpur.atk += buffVal;
				this.combatSpur.res += buffVal;
				boostText += this.name + " gets +" + buffVal + " atk and res from being adjacent to an ally with " + skillName + ".<br>";
			}
		}
		if(this.has("Atk Def Bond")){
			var skillName = "";
			var buffVal = 0;
			if(this.hasSlot("Atk Def Bond","a") && this.toggle.a == 1){
				buffVal = this.hasSlot("Atk Def Bond","a") + 2;
				if(this.hasExactly("Atk Def Bond 4")){
					buffVal = 7;
					if(this.penalty.panic){
						this.combatBuffs.atk = 0;
						this.combatBuffs.def = 0;
						this.buffs.atk = 0;
						this.buffs.def = 0;
					}
					this.combatDebuffs.atk = 0;
					this.combatDebuffs.def = 0;
					this.debuffs.atk = 0;
					this.debuffs.def = 0;
					boostText += this.name + " has neutralized penalties to atk and def.<br>";
				}
				skillName = data.skills[this.aIndex].name;
				this.combatSpur.atk += buffVal;
				this.combatSpur.def += buffVal;
				boostText += this.name + " gets +" + buffVal + " atk and def from being adjacent to an ally with " + skillName + ".<br>";
			}
			if(this.hasSlot("Atk Def Bond","s") && this.toggle.s == 1){
				buffVal = this.hasSlot("Atk Def Bond","s") + 2;
				skillName = data.skills[this.sIndex].name;
				this.combatSpur.atk += buffVal;
				this.combatSpur.def += buffVal;
				boostText += this.name + " gets +" + buffVal + " atk and def from being adjacent to an ally with " + skillName + ".<br>";
			}
		}
		if(this.has("Spd Def Bond")){
			var skillName = "";
			var buffVal = 0;
			if(this.hasSlot("Spd Def Bond","a") && this.toggle.a == 1){
				buffVal = this.hasSlot("Spd Def Bond","a") + 2;
				if(this.hasExactly("Spd Def Bond 4")){
					buffVal = 7;
					if(this.penalty.panic){
						this.combatBuffs.spd = 0;
						this.combatBuffs.def = 0;
						this.buffs.spd = 0;
						this.buffs.def = 0;
					}
					this.combatDebuffs.spd = 0;
					this.combatDebuffs.def = 0;
					this.debuffs.spd = 0;
					this.debuffs.def = 0;
					boostText += this.name + " has neutralized penalties to spd and def.<br>";
				}
				skillName = data.skills[this.aIndex].name;
				this.combatSpur.spd += buffVal;
				this.combatSpur.def += buffVal;
				boostText += this.name + " gets +" + buffVal + " spd and def from being adjacent to an ally with " + skillName + ".<br>";
			}
			if(this.hasSlot("Spd Def Bond","s") && this.toggle.s == 1){
				buffVal = this.hasSlot("Spd Def Bond","s") + 2;
				skillName = data.skills[this.sIndex].name;
				this.combatSpur.spd += buffVal;
				this.combatSpur.def += buffVal;
				boostText += this.name + " gets +" + buffVal + " spd and def from being adjacent to an ally with " + skillName + ".<br>";
			}
		}
		if(this.has("Atk Spd Bond")){
			var skillName = "";
			var buffVal = 0;
			if(this.hasSlot("Atk Spd Bond","a") && this.toggle.a == 1){
				buffVal = this.hasSlot("Atk Spd Bond","a") + 2;
				if(this.hasExactly("Atk Spd Bond 4")){
					buffVal = 7;
					if(this.penalty.panic){
						this.combatBuffs.atk = 0;
						this.combatBuffs.spd = 0;
						this.buffs.atk = 0;
						this.buffs.spd = 0;
					}
					this.combatDebuffs.atk = 0;
					this.combatDebuffs.spd = 0;
					this.debuffs.atk = 0;
					this.debuffs.spd = 0;
					boostText += this.name + " has neutralized penalties to atk and spd.<br>";
				}
				skillName = data.skills[this.aIndex].name;
				this.combatSpur.atk += buffVal;
				this.combatSpur.spd += buffVal;
				boostText += this.name + " gets +" + buffVal + " atk and spd from being adjacent to an ally with " + skillName + ".<br>";
			}
			if(this.hasSlot("Atk Spd Bond","s") && this.toggle.s == 1){
				buffVal = this.hasSlot("Atk Spd Bond","s") + 2;
				skillName = data.skills[this.sIndex].name;
				this.combatSpur.atk += buffVal;
				this.combatSpur.spd += buffVal;
				boostText += this.name + " gets +" + buffVal + " atk and spd from being adjacent to an ally with " + skillName + ".<br>";
			}
		}
		if(this.has("Spd Res Bond")){
			var skillName = "";
			var buffVal = 0;
			if(this.hasSlot("Spd Res Bond","a") && this.toggle.a == 1){
				buffVal = this.hasSlot("Spd Res Bond","a") + 2;
				if(this.hasExactly("Spd Res Bond 4")){
					buffVal = 7;
					if(this.penalty.panic){
						this.combatBuffs.spd = 0;
						this.combatBuffs.res = 0;
						this.buffs.spd = 0;
						this.buffs.res = 0;
					}
					this.combatDebuffs.spd = 0;
					this.combatDebuffs.res = 0;
					this.debuffs.spd = 0;
					this.debuffs.res = 0;
					boostText += this.name + " has neutralized penalties to spd and res.<br>";
				}
				skillName = data.skills[this.aIndex].name;
				this.combatSpur.spd += buffVal;
				this.combatSpur.res += buffVal;
				boostText += this.name + " gets +" + buffVal + " spd and res from being adjacent to an ally with " + skillName + ".<br>";
			}
			if(this.hasSlot("Spd Res Bond","s") && this.toggle.s == 1){
				buffVal = this.hasSlot("Spd Res Bond","s") + 2;
				skillName = data.skills[this.sIndex].name;
				this.combatSpur.spd += buffVal;
				this.combatSpur.res += buffVal;
				boostText += this.name + " gets +" + buffVal + " spd and res from being adjacent to an ally with " + skillName + ".<br>";
			}
		}
		if(this.has("Def Res Bond")){
			var skillName = "";
			var buffVal = 0;
			if(this.hasSlot("Def Res Bond","a") && this.toggle.a == 1){
				buffVal = this.hasSlot("Def Res Bond","a") + 2;
				if(this.hasExactly("Def Res Bond 4")){
					buffVal = 7;
					if(this.penalty.panic){
						this.combatBuffs.def = 0;
						this.combatBuffs.res = 0;
						this.buffs.def = 0;
						this.buffs.res = 0;
					}
					this.combatDebuffs.def = 0;
					this.combatDebuffs.res = 0;
					this.debuffs.def = 0;
					this.debuffs.res = 0;
					boostText += this.name + " has neutralized penalties to def and res.<br>";
				}
				skillName = data.skills[this.aIndex].name;
				this.combatSpur.def += buffVal;
				this.combatSpur.res += buffVal;
				boostText += this.name + " gets +" + buffVal + " def and res from being adjacent to an ally with " + skillName + ".<br>";
			}
			if(this.hasSlot("Def Res Bond","s") && this.toggle.s == 1){
				buffVal = this.hasSlot("Def Res Bond","s") + 2;
				skillName = data.skills[this.sIndex].name;
				this.combatSpur.def += buffVal;
				this.combatSpur.res += buffVal;
				boostText += this.name + " gets +" + buffVal + " def and res from being adjacent to an ally with " + skillName + ".<br>";
			}
		}
		//Clash skills
		if((this.hasSlot("Atk Spd Clash","a") || this.hasExactly("Atk Spd Excel")) && this.buddy.spaces > 0){
			var buffVal = this.hasSlot("Atk Spd Clash","a") * 2 - 1 + Math.min(this.buddy.spaces, this.hasSlot("Atk Spd Clash","a"));
			if(this.hasExactly("Atk Spd Clash 4")){
				buffVal--;
			}
			else if(this.hasExactly("Atk Spd Excel")){
				buffVal = 6 + Math.min(this.buddy.spaces, 4);
			}
			this.combatSpur.atk += buffVal;
			this.combatSpur.spd += buffVal;
			boostText += this.name + " gets +" + buffVal + " atk & spd from unit or enemy initiating after moving " + this.buddy.spaces + " space(s) with " + data.skills[this.aIndex].name + ".<br>";
			if(this.buddy.spaces > 1 && this.hasExactly("Atk Spd Clash 4")){
				if(this.penalty.panic){
					this.combatBuffs.atk = 0;
					this.combatBuffs.spd = 0;
					this.buffs.atk = 0;
					this.buffs.spd = 0;
				}
				this.combatDebuffs.atk = 0;
				this.combatDebuffs.spd = 0;
				this.debuffs.atk = 0;
				this.debuffs.spd = 0;
				boostText += this.name + " has neutralized penalties to atk and spd.<br>";
			}
		}
		if((this.hasSlot("Atk Def Clash","a") || this.hasExactly("Atk Def Excel")) && this.buddy.spaces > 0){
			var buffVal = this.hasSlot("Atk Def Clash","a") * 2 - 1 + Math.min(this.buddy.spaces, this.hasSlot("Atk Def Clash","a"));
			if(this.hasExactly("Atk Def Clash 4")){
				buffVal--;
			}
			else if(this.hasExactly("Atk Def Excel")){
				buffVal = 6 + Math.min(this.buddy.spaces, 4);
			}
			this.combatSpur.atk += buffVal;
			this.combatSpur.def += buffVal;
			boostText += this.name + " gets +" + buffVal + " atk & def from unit or enemy initiating after moving " + this.buddy.spaces + " space(s) with " + data.skills[this.aIndex].name + ".<br>";
			if(this.buddy.spaces > 1 && this.hasExactly("Atk Def Clash 4")){
				if(this.penalty.panic){
					this.combatBuffs.atk = 0;
					this.combatBuffs.def = 0;
					this.buffs.atk = 0;
					this.buffs.def = 0;
				}
				this.combatDebuffs.atk = 0;
				this.combatDebuffs.def = 0;
				this.debuffs.atk = 0;
				this.debuffs.def = 0;
				boostText += this.name + " has neutralized penalties to atk and def.<br>";
			}
		}
		if(this.hasSlot("Spd Def Clash","a") && this.buddy.spaces > 0){
			var buffVal = this.hasSlot("Spd Def Clash","a") * 2 - 1 + Math.min(this.buddy.spaces, this.hasSlot("Spd Def Clash","a"));
			if(this.hasExactly("Spd Def Clash 4")){
				buffVal--;
			}
			this.combatSpur.spd += buffVal;
			this.combatSpur.def += buffVal;
			boostText += this.name + " gets +" + buffVal + " spd & def from unit or enemy initiating after moving " + this.buddy.spaces + " space(s) with " + data.skills[this.aIndex].name + ".<br>";
			if(this.buddy.spaces > 1 && this.hasExactly("Spd Def Clash 4")){
				if(this.penalty.panic){
					this.combatBuffs.spd = 0;
					this.combatBuffs.def = 0;
					this.buffs.spd = 0;
					this.buffs.def = 0;
				}
				this.combatDebuffs.spd = 0;
				this.combatDebuffs.def = 0;
				this.debuffs.spd = 0;
				this.debuffs.def = 0;
				boostText += this.name + " has neutralized penalties to spd and def.<br>";
			}
		}
		if(this.hasSlot("Atk Def Clash","s") && this.buddy.spaces > 0){
			var buffVal = this.hasSlot("Atk Def Clash","s") * 2 - 1 + Math.min(this.buddy.spaces, this.hasSlot("Atk Def Clash","s"));
			this.combatSpur.atk += buffVal;
			this.combatSpur.def += buffVal;
			boostText += this.name + " gets +" + buffVal + " atk & def from unit or enemy initiating after moving " + this.buddy.spaces + " space(s) with " + data.skills[this.sIndex].name + ".<br>";
		}
		if(this.hasSlot("Atk Spd Clash","s") && this.buddy.spaces > 0){
			var buffVal = this.hasSlot("Atk Spd Clash","s") * 2 - 1 + Math.min(this.buddy.spaces, this.hasSlot("Atk Spd Clash","s"));
			this.combatSpur.atk += buffVal;
			this.combatSpur.spd += buffVal;
			boostText += this.name + " gets +" + buffVal + " atk & spd from unit or enemy initiating after moving " + this.buddy.spaces + " space(s) with " + data.skills[this.sIndex].name + ".<br>";
		}
		//Finish skills
		if(this.has("Atk Res Finish") && this.buddy.adjacent + this.buddy.two + this.buddy.three > 0){
			if(this.hasSlot("Atk Res Finish","a")){
				var buffVal = this.hasSlot("Atk Res Finish","a") * 2;
				if(this.hasExactly("Atk Res Finish 4")){
					buffVal--;
				}
				this.combatSpur.atk += buffVal;
				this.combatSpur.res += buffVal;
				boostText += this.name + " gets +" + buffVal + " atk & res from being within 3 spaces of an ally with " + data.skills[this.aIndex].name + ".<br>";
			}
			if(this.hasSlot("Atk Res Finish","s")){
				var buffVal = this.hasSlot("Atk Res Finish","s") * 2;
				this.combatSpur.atk += buffVal;
				this.combatSpur.res += buffVal;
				boostText += this.name + " gets +" + buffVal + " atk & res from being within 3 spaces of an ally with " + data.skills[this.sIndex].name + ".<br>";
			}
		}
		if(this.has("Atk Spd Finish") && this.buddy.adjacent + this.buddy.two + this.buddy.three > 0){
			if(this.hasSlot("Atk Spd Finish","a")){
				var buffVal = this.hasSlot("Atk Spd Finish","a") * 2;
				if(this.hasExactly("Atk Spd Finish 4")){
					buffVal--;
				}
				this.combatSpur.atk += buffVal;
				this.combatSpur.spd += buffVal;
				boostText += this.name + " gets +" + buffVal + " atk & spd from being within 3 spaces of an ally with " + data.skills[this.aIndex].name + ".<br>";
			}
			if(this.hasSlot("Atk Spd Finish","s")){
				var buffVal = this.hasSlot("Atk Spd Finish","s") * 2;
				this.combatSpur.atk += buffVal;
				this.combatSpur.spd += buffVal;
				boostText += this.name + " gets +" + buffVal + " atk & spd from being within 3 spaces of an ally with " + data.skills[this.sIndex].name + ".<br>";
			}
		}
		if(this.has("Spd Res Finish") && this.buddy.adjacent + this.buddy.two + this.buddy.three > 0){
			if(this.hasSlot("Spd Res Finish","a")){
				var buffVal = this.hasSlot("Spd Res Finish","a") * 2;
				if(this.hasExactly("Spd Res Finish 4")){
					buffVal--;
				}
				this.combatSpur.spd += buffVal;
				this.combatSpur.res += buffVal;
				boostText += this.name + " gets +" + buffVal + " spd & res from being within 3 spaces of an ally with " + data.skills[this.aIndex].name + ".<br>";
			}
			if(this.hasSlot("Spd Res Finish","s")){
				var buffVal = this.hasSlot("Spd Res Finish","s") * 2;
				this.combatSpur.spd += buffVal;
				this.combatSpur.res += buffVal;
				boostText += this.name + " gets +" + buffVal + " spd & res from being within 3 spaces of an ally with " + data.skills[this.sIndex].name + ".<br>";
			}
		}
		if(this.has("Def Res Finish") && this.buddy.adjacent + this.buddy.two + this.buddy.three > 0){
			var buffVal = this.has("Def Res Finish") * 2;
			if(this.hasExactly("Def Res Finish 4")){
				buffVal--;
			}
			this.combatSpur.def += buffVal;
			this.combatSpur.res += buffVal;
			boostText += this.name + " gets +" + buffVal + " def & res from being within 3 spaces of an ally with " + data.skills[this.aIndex].name + ".<br>";
		}
		if(this.has("Atk Def Finish") && this.buddy.adjacent + this.buddy.two + this.buddy.three > 0){
			if(this.hasSlot("Atk Def Finish","a")){
				var buffVal = this.hasSlot("Atk Def Finish","a") * 2;
				if(this.hasExactly("Atk Def Finish 4")){
					buffVal--;
				}
				this.combatSpur.atk += buffVal;
				this.combatSpur.def += buffVal;
				boostText += this.name + " gets +" + buffVal + " atk & def from being within 3 spaces of an ally with " + data.skills[this.aIndex].name + ".<br>";
			}
			if(this.hasSlot("Atk Def Finish","s")){
				var buffVal = this.hasSlot("Atk Def Finish","s") * 2;
				this.combatSpur.atk += buffVal;
				this.combatSpur.def += buffVal;
				boostText += this.name + " gets +" + buffVal + " atk & def from being within 3 spaces of an ally with " + data.skills[this.sIndex].name + ".<br>";
			}
		}
		if(this.has("Spd Def Finish") && this.buddy.adjacent + this.buddy.two + this.buddy.three > 0){
			if(this.hasSlot("Spd Def Finish","a")){
				var buffVal = this.hasSlot("Spd Def Finish","a") * 2;
				if(this.hasExactly("Spd Def Finish 4")){
					buffVal--;
				}
				this.combatSpur.spd += buffVal;
				this.combatSpur.def += buffVal;
				boostText += this.name + " gets +" + buffVal + " spd & def from being within 3 spaces of an ally with " + data.skills[this.aIndex].name + ".<br>";
			}
			if(this.hasSlot("Spd Def Finish","s")){
				var buffVal = this.hasSlot("Spd Def Finish","s") * 2;
				this.combatSpur.spd += buffVal;
				this.combatSpur.def += buffVal;
				boostText += this.name + " gets +" + buffVal + " spd & def from being within 3 spaces of an ally with " + data.skills[this.sIndex].name + ".<br>";
			}
		}
		//Scowl skills
		if(this.hasSlot("Scowl","a") && (!this.initiator || enemy.combatStartHp / enemy.maxHp >= 0.75)){
			if(this.has("Atk Res Scowl")){
				buffVal = this.has("Atk Res Scowl") * 2;
				if(this.hasExactly("Atk Res Scowl 4")){
					buffVal--;
				}
				skillName = data.skills[this.aIndex].name;
				this.combatSpur.atk += buffVal;
				this.combatSpur.res += buffVal;
				boostText += this.name + " gets +" + buffVal + " atk & res from not initiating or Enemy HP >= 75% with " + skillName + ".<br>";
			}
			if(this.has("Atk Spd Scowl")){
				buffVal = this.has("Atk Spd Scowl") * 2;
				if(this.hasExactly("Atk Spd Scowl 4")){
					buffVal--;
				}
				skillName = data.skills[this.aIndex].name;
				this.combatSpur.atk += buffVal;
				this.combatSpur.spd += buffVal;
				boostText += this.name + " gets +" + buffVal + " atk & spd from not initiating or Enemy HP >= 75% with " + skillName + ".<br>";
			}
			if(this.has("Def Res Scowl")){
				buffVal = this.has("Def Res Scowl") * 2;
				if(this.hasExactly("Def Res Scowl 4")){
					buffVal--;
				}
				skillName = data.skills[this.aIndex].name;
				this.combatSpur.def += buffVal;
				this.combatSpur.res += buffVal;
				boostText += this.name + " gets +" + buffVal + " def & res from not initiating or Enemy HP >= 75% with " + skillName + ".<br>";
			}
			if(this.has("Spd Res Scowl")){
				buffVal = this.has("Spd Res Scowl") * 2;
				if(this.hasExactly("Spd Res Scowl 4")){
					buffVal--;
				}
				skillName = data.skills[this.aIndex].name;
				this.combatSpur.spd += buffVal;
				this.combatSpur.res += buffVal;
				boostText += this.name + " gets +" + buffVal + " spd & res from not initiating or Enemy HP >= 75% with " + skillName + ".<br>";
			}
			if(this.has("Atk Def Scowl")){
				buffVal = this.has("Atk Def Scowl") * 2;
				if(this.hasExactly("Atk Def Scowl 4")){
					buffVal--;
				}
				skillName = data.skills[this.aIndex].name;
				this.combatSpur.atk += buffVal;
				this.combatSpur.def += buffVal;
				boostText += this.name + " gets +" + buffVal + " atk & def from not initiating or Enemy HP >= 75% with " + skillName + ".<br>";
			}
		}
		//Solo skills
		if(this.has("Atk Res Solo")){
			var skillName = "";
			var buffVal = 0;
			if(this.hasSlot("Atk Res Solo","a") && this.toggle.a == 1){
				buffVal = this.hasSlot("Atk Res Solo","a") * 2;
				if(this.hasExactly("Atk Res Solo 4")){
					buffVal--;
				}
				skillName = data.skills[this.aIndex].name;
				this.combatSpur.atk += buffVal;
				this.combatSpur.res += buffVal;
				boostText += this.name + " gets +" + buffVal + " atk and res from not being adjacent to an ally with " + skillName + ".<br>";
			}
			if(this.hasSlot("Atk Res Solo","s") && this.toggle.s == 1){
				buffVal = this.hasSlot("Atk Res Solo","s") * 2;
				skillName = data.skills[this.sIndex].name;
				this.combatSpur.atk += buffVal;
				this.combatSpur.res += buffVal;
				boostText += this.name + " gets +" + buffVal + " atk and res from not being adjacent to an ally with " + skillName + ".<br>";
			}
		}
		if(this.has("Atk Spd Solo")){
			var skillName = "";
			var buffVal = 0;
			if(this.hasSlot("Atk Spd Solo","a") && this.toggle.a == 1){
				buffVal = this.hasSlot("Atk Spd Solo","a") * 2;
				if(this.hasExactly("Atk Spd Solo 4")){
					buffVal--;
				}
				skillName = data.skills[this.aIndex].name;
				this.combatSpur.atk += buffVal;
				this.combatSpur.spd += buffVal;
				boostText += this.name + " gets +" + buffVal + " atk and spd from not being adjacent to an ally with " + skillName + ".<br>";
			}
			if(this.hasSlot("Atk Spd Solo","s") && this.toggle.s == 1){
				buffVal = this.hasSlot("Atk Spd Solo","s") * 2;
				skillName = data.skills[this.sIndex].name;
				this.combatSpur.atk += buffVal;
				this.combatSpur.spd += buffVal;
				boostText += this.name + " gets +" + buffVal + " atk and spd from not being adjacent to an ally with " + skillName + ".<br>";
			}
		}
		if(this.has("Atk Def Solo")){
			var skillName = "";
			var buffVal = 0;
			if(this.hasSlot("Atk Def Solo","a") && this.toggle.a == 1){
				buffVal = this.hasSlot("Atk Def Solo","a") * 2;
				if(this.hasExactly("Atk Def Solo 4")){
					buffVal--;
				}
				skillName = data.skills[this.aIndex].name;
				this.combatSpur.atk += buffVal;
				this.combatSpur.def += buffVal;
				boostText += this.name + " gets +" + buffVal + " atk and def from not being adjacent to an ally with " + skillName + ".<br>";
			}
			if(this.hasSlot("Atk Def Solo","s") && this.toggle.s == 1){
				buffVal = this.hasSlot("Atk Def Solo","s") * 2;
				skillName = data.skills[this.sIndex].name;
				this.combatSpur.atk += buffVal;
				this.combatSpur.def += buffVal;
				boostText += this.name + " gets +" + buffVal + " atk and def from not being adjacent to an ally with " + skillName + ".<br>";
			}
		}
		if(this.has("Def Res Solo")){
			var skillName = "";
			var buffVal = 0;
			if(this.hasSlot("Def Res Solo","a") && this.toggle.a == 1){
				buffVal = this.hasSlot("Def Res Solo","a") * 2;
				if(this.hasExactly("Def Res Solo 4")){
					buffVal--;
				}
				skillName = data.skills[this.aIndex].name;
				this.combatSpur.def += buffVal;
				this.combatSpur.res += buffVal;
				boostText += this.name + " gets +" + buffVal + " def and res from not being adjacent to an ally with " + skillName + ".<br>";
			}
			if(this.hasSlot("Def Res Solo","s") && this.toggle.s == 1){
				buffVal = this.hasSlot("Def Res Solo","s") * 2;
				skillName = data.skills[this.sIndex].name;
				this.combatSpur.def += buffVal;
				this.combatSpur.res += buffVal;
				boostText += this.name + " gets +" + buffVal + " def and res from not being adjacent to an ally with " + skillName + ".<br>";
			}
		}
		if(this.has("Spd Def Solo")){
			var skillName = "";
			var buffVal = 0;
			if(this.hasSlot("Spd Def Solo","a") && this.toggle.a == 1){
				buffVal = this.hasSlot("Spd Def Solo","a") * 2;
				if(this.hasExactly("Spd Def Solo 4")){
					buffVal--;
				}
				skillName = data.skills[this.aIndex].name;
				this.combatSpur.spd += buffVal;
				this.combatSpur.def += buffVal;
				boostText += this.name + " gets +" + buffVal + " spd and def from not being adjacent to an ally with " + skillName + ".<br>";
			}
			if(this.hasSlot("Spd Def Solo","s") && this.toggle.s == 1){
				buffVal = this.hasSlot("Spd Def Solo","s") * 2;
				skillName = data.skills[this.sIndex].name;
				this.combatSpur.spd += buffVal;
				this.combatSpur.def += buffVal;
				boostText += this.name + " gets +" + buffVal + " spd and def from not being adjacent to an ally with " + skillName + ".<br>";
			}
		}
		if(this.has("Spd Res Solo")){
			var skillName = "";
			var buffVal = 0;
			if(this.hasSlot("Spd Res Solo","a") && this.toggle.a == 1){
				buffVal = this.hasSlot("Spd Res Solo","a") * 2;
				if(this.hasExactly("Spd Res Solo 4")){
					buffVal--;
				}
				skillName = data.skills[this.aIndex].name;
				this.combatSpur.spd += buffVal;
				this.combatSpur.res += buffVal;
				boostText += this.name + " gets +" + buffVal + " spd and res from not being adjacent to an ally with " + skillName + ".<br>";
			}
			if(this.hasSlot("Spd Res Solo","s") && this.toggle.s == 1){
				buffVal = this.hasSlot("Spd Res Solo","s") * 2;
				skillName = data.skills[this.sIndex].name;
				this.combatSpur.spd += buffVal;
				this.combatSpur.res += buffVal;
				boostText += this.name + " gets +" + buffVal + " spd and res from not being adjacent to an ally with " + skillName + ".<br>";
			}
		}
		if(this.hasExactly("Distant AS Solo") && this.buddy.adjacent == 0){
			this.combatSpur.atk += 5;
			this.combatSpur.spd += 5;
			boostText += this.name + " gets +5 atk and spd from not being adjacent to an ally with Distant AS Solo.<br>";
		}
		if(this.hasExactly("Distant DR Solo") && this.buddy.adjacent == 0){
			this.combatSpur.def += 5;
			this.combatSpur.res += 5;
			boostText += this.name + " gets +5 def and res from not being adjacent to an ally with Distant DR Solo.<br>";
		}
		if(this.has("Blue Skies") && (this.initiator || this.buddy.adjacent > 0 || this.buddy.two > 0)){
			var bsVal = this.has("Blue Skies") * 2;
			this.combatSpur.atk += bsVal;
			this.combatSpur.spd += bsVal;
			boostText += this.name + " gets +" + bsVal + " to atk & spd from initiating or being within 2 spaces of an ally with " + data.skills[this.aIndex].name + ".<br>";
		}
		if(this.hasExactly("Trample") && (this.initiator || enemy.combatStartHp / enemy.maxHp >= 0.75)){
			var trVal = 7;
			if(this.toggle.a == 1 || enemy.moveType == "infantry" || enemy.moveType == "armored"){
				trVal += 3;
			}
			this.combatSpur.atk += trVal;
			this.combatSpur.spd += trVal;
			boostText += this.name + " gets +" + trVal + " to atk & spd from initiating or enemy HP >= 75% with Trample.<br>";
		}
		
		//Tyrfing
		if(this.hasExactly("Tyrfing") && this.hp / this.maxHp <= 0.5 && this.rValue < 0){
			this.combatSpur.def += 4;
			boostText += this.name + " gets +4 def from Tyrfing.<br>";
		}
		//Lucina and Chrom Falchion Refined
		if(this.hasExactly("Falchion") && this.rValue == 5 && (this.name == "Lucina" || this.name == "Chrom" || this.name == "Marth (Masked)") && this.toggle.weapon == 1){
			var buffVal = 4;
			this.combatSpur.atk += buffVal;
			this.combatSpur.spd += buffVal;
			this.combatSpur.def += buffVal;
			this.combatSpur.res += buffVal;
			boostText += this.name + " gets +" + buffVal + " in all stats from being adjacent to an ally with Falchion.<br>";
		}
		//Hinoka's Spear
		if(this.has("Hinoka's Spear") && this.toggle.weapon == 1){
			var buffVal = 4;
			this.combatSpur.atk += buffVal;
			this.combatSpur.spd += buffVal;
			boostText += this.name + " gets +" + buffVal + " atk and spd from being adjacent to an infantry/flying ally with Hinoka's Spear.<br>";
		}
		//Cymbeline Special Refined
		if(this.has("Cymbeline") && this.rValue == 5 && this.toggle.weapon == 1){
			this.combatSpur.atk += 5;
			this.combatSpur.res += 5;
			boostText += this.name + " gets +5 atk and res from being within 2 spaces of a flying ally with Cymbeline.<br>";
		}
		//Regal Blade Refine
		if(this.has("Regal Blade") && this.rValue == 5 && this.toggle.weapon == 1){
			var buffVal = 3;
			this.combatSpur.atk += buffVal;
			this.combatSpur.spd += buffVal;
			this.combatSpur.def += buffVal;
			this.combatSpur.res += buffVal;
			boostText += this.name + " gets +" + buffVal + " in all stats from being within 2 spaces adjacent to an infantry magic ally with Regal Blade.<br>";
		}
		//Swift Mulagir
		if(this.hasExactly("Swift Mulagir") && this.toggle.weapon == 1){
			var buffVal = 5;
			this.combatSpur.atk += buffVal;
			this.combatSpur.spd += buffVal;
			if(this.rValue < 0){
				boostText += this.name + " gets +" + buffVal + " atk and spd from having more allies within 2 spaces than enemies with Swift Mulagir.<br>";
			}
			else{
				boostText += this.name + " gets +" + buffVal + " atk and spd from being within 3 spaces of an ally with Swift Mulagir.<br>";
			}
		}
		//Camilla's Axe
		if(this.has("Camilla's Axe") && this.toggle.weapon == 1){
			var buffVal = 4;
			this.combatSpur.atk += buffVal;
			this.combatSpur.spd += buffVal;
			boostText += this.name + " gets +" + buffVal + " atk and spd from being within 2 spaces of cavalry or flying ally with Camilla's Axe.<br>";
		}
		//Parthia Special Refine
		if(this.hasExactly("Parthia") && this.rValue == 5 && enemy.range == "ranged"){
			this.combatSpur.atk += 6;
			boostText += this.name + " gets +6 atk from Parthia.<br>";
		}
		//Aura Special Refined
		if(this.hasExactly("Aura") && this.rValue == 5 && this.toggle.weapon == 1){
			this.combatSpur.atk += 5;
			this.combatSpur.spd += 5;
			boostText += this.name + " gets +5 atk and spd from being within 2 spaces of a magic/staff ally with Aura.<br>";
		}
		//Breath Of Fog Special Refined
		if(this.hasExactly("Breath Of Fog") && this.rValue == 5 && this.toggle.weapon == 1){
			this.combatSpur.atk += 5;
			this.combatSpur.def += 5;
			boostText += this.name + " gets +5 atk and def from being within 2 spaces of a sword/dragon ally with Breath Of Fog.<br>";
		}
		//Excalibur Special Refined
		if(this.hasExactly("Excalibur") && this.rValue == 5 && this.toggle.weapon == 1){
			this.combatSpur.atk += 5;
			this.combatSpur.spd += 5;
			boostText += this.name + " gets +5 atk and spd from being within 2 spaces of a magic/staff ally with Excalibur.<br>";
		}
		//Wolf Berg
		if(this.hasExactly("Wolf Berg") && this.toggle.weapon > 0){
			if(this.rValue < 0 || (this.rValue > 0 && (this.toggle.weapon > 1 || this.initiator))){
				var buffVal = 4;
				this.combatSpur.atk += buffVal;
				this.combatSpur.spd += buffVal;
				this.combatSpur.def += buffVal;
				this.combatSpur.res += buffVal;
				var wbText = this.name + " gets +" + buffVal + " in all stats from ";
				if(this.rValue < 0){
					wbText += "having enemies >= allies within 2 spaces with Wolf Berg.<br>";
				}
				else{
					wbText += "initiating or not being adjacent to an ally with Wolf Berg.<br>";
				}
				boostText += wbText;
			}
		}
		//Fensalir Special Refined
		if(this.hasExactly("Fensalir") && this.rValue == 5 && this.toggle.weapon == 1){
			this.combatSpur.spd += 5;
			this.combatSpur.def += 5;
			boostText += this.name + " gets +5 spd and def from being adjacent to an ally with Fensalir.<br>";
		}
		//Vidofnir Special Refined
		if(this.hasExactly("Vidofnir") && this.rValue == 5 && this.toggle.weapon == 1){
			this.combatSpur.atk += 4;
			this.combatSpur.spd += 4;
			boostText += this.name + " gets +4 atk and spd from being within 2 spaces of an infantry/armored ally with Vidofnir.<br>";
		}
		//Sagittae
		if(this.hasExactly("Sagittae") && ((this.rValue < 0 && allStats[20] >= allStats[16] + 5) || (this.rValue > 0 && allStats[20] > allStats[16]))){
			var buffVal = 5;
			this.combatSpur.atk += buffVal;
			this.combatSpur.spd += buffVal;
			this.combatSpur.def += buffVal;
			this.combatSpur.res += buffVal;
			if(this.rValue > 0){
				boostText += this.name + " gets +" + buffVal + " in all stats from having less atk than enemy with Sagittae.<br>";
			}
			else{
				boostText += this.name + " gets +" + buffVal + " in all stats from having 5 less or equal atk than the enemy with Sagittae.<br>";
			}
		}
		//Storm Sieglinde
		if(this.hasExactly("Storm Sieglinde") && this.rValue < 0 && this.toggle.weapon == 1){
			var buffVal = 3;
			this.combatSpur.def += buffVal;
			this.combatSpur.res += buffVal;
			boostText += this.name + " gets +" + buffVal + " def and res from having >= enemies within 2 spaces than allies with Storm Sieglinde.<br>";
		}
		//Golden Dagger
		if(this.specialIndex != -1 && data.skills[this.specialIndex].charge <= this.charge && this.hasExactly("Golden Dagger") && this.rValue == 5){
			var buffVal = 3;
			this.combatSpur.atk += buffVal;
			this.combatSpur.spd += buffVal;
			this.combatSpur.def += buffVal;
			this.combatSpur.res += buffVal;
			this.anyCounter = true;
			boostText += this.name + " gets +" + buffVal + " in all stats from having Special ready and gains Distant Counter with Golden Dagger.<br>";
		}
		//Draconic Rage
		if(this.hasExactly("Draconic Rage") && this.rValue < 0 && this.toggle.weapon == 1){
			var buffVal = 5;
			this.combatSpur.atk += buffVal;
			this.combatSpur.spd += buffVal;
			boostText += this.name + " gets +" + buffVal + " atk and spd from having allies >= enemies within 2 spaces with Draconic Rage.<br>";
		}
		//Sylgr
		if(this.hasExactly("Sylgr")){
			if(this.rValue < 0 && allStats[17] + this.getPhantom("Spd") > allStats[21] + enemy.getPhantom("Spd")){
				this.combatSpur.atk += 4;
				this.combatSpur.spd += 4;
				boostText += this.name + " gets +4 atk and spd from having more spd than enemy with Sylgr.<br>";
			}
			if(this.rValue > 0 && (allStats[17] + this.getPhantom("Spd") > allStats[21] + enemy.getPhantom("Spd") || enemy.combatStartHp / enemy.maxHp >= 0.75)){
				this.combatSpur.atk += 5;
				this.combatSpur.spd += 5;
				boostText += this.name + " gets +5 atk and spd from having more spd than enemy or enemy HP >= 75% with Sylgr.<br>";
			}
			if(this.rValue == 5){
				var sdAtk = 0;
				var sdSpd = 0;
				var sdDef = 0;
				var sdRes = 0;
				
				if(!this.penalty.panic){
					if(allStats[14][0] == false){
						sdAtk = Math.max(this.combatBuffs.atk, this.buffs.atk);
					}
					if(allStats[14][1] == false){
						sdSpd = Math.max(this.combatBuffs.spd, this.buffs.spd);
					}
					if(allStats[14][2] == false){
						sdDef = Math.max(this.combatBuffs.def, this.buffs.def);
					}
					if(allStats[14][3] == false){
						sdRes = Math.max(this.combatBuffs.res, this.buffs.res);
					}
				}
				var eNegate = this.checkNegate(enemy, currTurn);
				if(eNegate[0] == false){
					sdAtk = Math.max(sdAtk,-enemy.combatDebuffs.atk,-enemy.debuffs.atk);
				}
				if(eNegate[1] == false){
					sdSpd = Math.max(sdSpd,-enemy.combatDebuffs.spd,-enemy.debuffs.spd);
				}
				if(eNegate[2] == false){
					sdDef = Math.max(sdDef,-enemy.combatDebuffs.def,-enemy.debuffs.def);
				}
				if(eNegate[3] == false){
					sdRes = Math.max(sdRes,-enemy.combatDebuffs.res,-enemy.debuffs.res);
				}
				
				enemy.combatSpur.atk -= sdAtk;
				enemy.combatSpur.spd -= sdSpd;
				enemy.combatSpur.def -= sdDef;
				enemy.combatSpur.res -= sdRes;
				boostText += this.name + " inflicts -" + sdAtk + " atk/-" + sdSpd + " spd/-" + sdDef + " def/-" + sdRes + " res on " + enemy.name + " with Sylgr.<br>";
				if(this.combatStartHp/this.maxHp >= 0.25){
					this.combatSpur.atk += 4;
					this.combatSpur.spd += 4;
					boostText += this.name + " gets +4 atk and spd from HP >= 25% with Sylgr.<br>";
				}
			}
		}
		//Gladiator's Blade
		if(this.hasExactly("Gladiator's Blade") && this.rValue == 5 && this.toggle.weapon == 1){
			this.combatSpur.atk += 4;
			this.combatSpur.spd += 4;
			boostText += this.name + " gets +4 atk and spd from being within 2 spaces of a flying/infantry ally with Gladiator's Blade.<br>";
		}
		//Whitewing weapons
		if(this.has("Whitewing") && this.rValue == 5 && this.toggle.weapon == 1){
			this.combatSpur.atk += 3;
			this.combatSpur.spd += 3;
			this.combatSpur.def += 3;
			this.combatSpur.res += 3;
			boostText += this.name + " gets +3 to all stats from having >= 2 flying allies within 2 spaces with " + data.skills[this.weaponIndex].name + ".<br>";
		}
		//Festive Siegmund
		if(this.has("Festive Siegmund")){
			if((this.rValue < 0 && this.toggle.weapon == 1) || (this.rValue > 0 && (enemy.combatStartHp / enemy.maxHp >= 0.75 || this.toggle.weapon == 1))){
				var buffVal = 4;
				this.combatSpur.atk += buffVal;
				this.combatSpur.spd += buffVal;
				this.combatSpur.def += buffVal;
				this.combatSpur.res += buffVal;
				if(this.rValue < 0){
					boostText += this.name + " gets +" + buffVal + " in all stats from not being adjacent to any ally with Festive Siegmund.<br>";
				}
				else if(this.rValue > 0){
					boostText += this.name + " gets +" + buffVal + " in all stats from enemy HP >= 75% or not being adjacent to any ally with Festive Siegmund.<br>";
				}
			}
			if(this.rValue == 5 && this.combatStartHp / this.maxHp >= 0.25){
				enemy.combatSpur.atk -= 5;
				enemy.combatSpur.def -= 5;
				boostText += this.name + " has activated Festive Siegmund. Effect on " + enemy.name + ": -5 to atk and def.<br>";
			}
		}
		//Divine Naga
		if(this.hasExactly("Divine Naga") && this.rValue == 5 && allStats[19] + this.getPhantom("Res") >= allStats[23] + enemy.getPhantom("Res") + 3){
			this.combatSpur.atk += 3;
			this.combatSpur.spd += 3;
			this.combatSpur.def += 3;
			this.combatSpur.res += 3;
			boostText += this.name + " gets +3 to all stats from having >= 3 res than " + enemy.name + " with " + data.skills[this.weaponIndex].name + ".<br>";
		}
		//Refined Tyrfing
		if(this.hasExactly("Tyrfing") && this.rValue == 5 && this.toggle.weapon == 1){
			this.combatSpur.atk += 5;
			this.combatSpur.def += 5;
			boostText += this.name + " gets +5 atk and def from being adjacent to an ally with Tyrfing.<br>";
		}
		//2019 Valentine's weapons
		if((this.has("Faithful Axe") || this.has("Blarblooms") || this.has("Gronnblooms") || this.has("Heart's Blade") || this.has("Loyal Wreath")) && this.toggle.weapon == 1){
			this.combatSpur.atk += 3;
			this.combatSpur.spd += 3;
			this.combatSpur.def += 3;
			this.combatSpur.res += 3;
			boostText += this.name + " gets +3 to all stats from being adjacent to an ally with " + data.skills[this.weaponIndex].name + ".<br>";
		}
		//Grado Poleax
		if(this.hasExactly("Grado Poleax") && this.rValue == 5 && this.toggle.weapon == 1){
			this.combatSpur.spd += 5;
			this.combatSpur.def += 5;
			boostText += this.name + " gets +5 spd and def from being buffed with Grado Poleax.<br>";
		}
		if(this.hasExactly("Foxkit Fang") || this.hasExactly("Foxkit Fang 2")){
			if(this.rValue < 0 && enemy.range == "melee" && allStats[19] + this.getPhantom("Res") > allStats[23] + enemy.getPhantom("Res")){
				var diffVal = Math.floor((allStats[19] + this.getPhantom("Res") - allStats[23] - enemy.getPhantom("Res")) / 2);
				diffVal = Math.max(0, diffVal);
				diffVal = Math.min(8, diffVal);
				this.combatSpur.atk += diffVal;
				this.combatSpur.spd += diffVal;
				this.combatSpur.def += diffVal;
				this.combatSpur.res += diffVal;
				boostText += this.name + " gets +" + diffVal + " to all stats from Res > enemy Res and enemy being melee with Foxkit Fang.<br>";
			}
			if(this.rValue > 0 && allStats[19] + this.getPhantom("Res") > allStats[23] + enemy.getPhantom("Res")){
				var diffVal = Math.floor((allStats[19] + this.getPhantom("Res") - allStats[23] - enemy.getPhantom("Res")) * 0.8);
				diffVal = Math.max(0, diffVal);
				diffVal = Math.min(8, diffVal) + 4;
				this.combatSpur.atk += diffVal;
				this.combatSpur.spd += diffVal;
				this.combatSpur.def += diffVal;
				this.combatSpur.res += diffVal;
				boostText += this.name + " gets +" + diffVal + " to all stats from Res > enemy Res with Foxkit Fang.<br>";
			}
			if(this.rValue == 5 && (this.initiator || this.toggle.weapon == 1)){
				this.combatSpur.atk += 4;
				this.combatSpur.spd += 4;
				this.combatSpur.def += 4;
				this.combatSpur.res += 4;
				boostText += this.name + " gets +4 to all stats from initiating or being within 2 spaces of an ally with Foxkit Fang.<br>";
			}
		}
		if(this.has("Taguel Fang")){
			if(this.toggle.weapon == 1){
				var buffVal = 3;
				if(this.rValue > 0){
					buffVal = 4;
				}
				this.combatSpur.atk += buffVal;
				this.combatSpur.spd += buffVal;
				this.combatSpur.def += buffVal;
				this.combatSpur.res += buffVal;
				boostText += this.name + " gets +" + buffVal + " to all stats by being adjacent to beast/dragon ally or alone with Taguel Fang.<br>";
				if(this.rValue > 0 && enemy.weaponType != "dragon" && enemy.weaponType != "beast"){
					this.combatSpur.atk += 4;
					this.combatSpur.spd += 4;
					this.combatSpur.def += 4;
					this.combatSpur.res += 4;
					boostText += this.name + " gets +4 to all stats by enemy being a human with Taguel Fang.<br>";
				}
			}
			if(this.rValue == 5 && this.combatStartHp / this.maxHp >= 0.25){
				this.combatSpur.atk += 4;
				this.combatSpur.spd += 4;
				this.combatSpur.def += 4;
				this.combatSpur.res += 4;
				boostText += this.name + " gets +4 to all stats from HP >= 25% with Taguel Fang.<br>";
			}
		}
		if(this.hasExactly("Fimbulvetr")){
			if(this.toggle.weapon == 1 || this.combatStartHp / this.maxHp < 1 || (this.rValue > 0 && (enemy.combatStartHp / enemy.maxHp >= 0.75 || this.toggle.weapon > 3))){
				this.combatSpur.atk += 4;
				this.combatSpur.spd += 4;
				this.combatSpur.def += 4;
				this.combatSpur.res += 4;
				if(this.penalty.panic){
					this.combatBuffs = {"atk":0,"spd":0,"def":0,"res":0};
					this.buffs = {"atk":0,"spd":0,"def":0,"res":0};
				}
				this.combatDebuffs = {"atk":0,"spd":0,"def":0,"res":0};
				this.debuffs = {"atk":0,"spd":0,"def":0,"res":0};
				boostText += this.name + " gets +4 to all stats and neutralizes penalties with Fimbulvetr.<br>";
			}
			if(this.rValue == 5 && this.toggle.weapon > 1){
				this.combatSpur.atk += 4;
				this.combatSpur.spd += 4;
				this.combatSpur.def += 4;
				this.combatSpur.res += 4;
				var fVal = 2;
				if(enemy.specialIndex != -1){
					fVal = 10 - ((data.skills[enemy.specialIndex].charge - enemy.initSkillCharge()) * 2);
					fVal = Math.max(fVal,2);
				}
				enemy.combatSpur.atk -= fVal;
				enemy.combatSpur.res -= fVal;
				boostText += this.name + " gets +4 to all stats and inflicts -" + fVal + " atk & res to " + enemy.name + " from being within 3 spaces of an ally with Fimbulvetr.<br>";
			}
		}
		if(this.hasExactly("Demonic Breath")){
			if((this.rValue > 0 && !this.initiator) || this.toggle.weapon == 1 || this.combatStartHp / this.maxHp < 1){
				this.combatSpur.atk += 4;
				this.combatSpur.spd += 4;
				this.combatSpur.def += 4;
				this.combatSpur.res += 4;
				if(this.penalty.panic){
					this.combatBuffs = {"atk":0,"spd":0,"def":0,"res":0};
					this.buffs = {"atk":0,"spd":0,"def":0,"res":0};
				}
				this.combatDebuffs = {"atk":0,"spd":0,"def":0,"res":0};
				this.debuffs = {"atk":0,"spd":0,"def":0,"res":0};
				boostText += this.name + " gets +4 to all stats and neutralizes penalties with " + data.skills[this.weaponIndex].name + ".<br>";
			}
			if(this.rValue == 5 && (!this.initiator || enemy.combatStartHp / enemy.maxHp >= 0.75)){
				this.combatSpur.atk += 5;
				enemy.combatSpur.atk -= 5;
				boostText += this.name + " gets +5 atk and inflicts -5 atk to " + enemy.name + " from enemy initiating or enemy HP >= 75% with Demonic Breath.<br>";
			}
		}
		if(this.hasExactly("Dark Aura") && this.rValue == 5 && this.toggle.weapon == 1){
			this.combatSpur.atk += 5;
			this.combatSpur.spd += 5;
			boostText += this.name + " gets +5 atk and spd from being within 2 spaces of a melee ally with Dark Aura.<br>";
		}
		if(this.hasExactly("Chaos Manifest")){
			if(this.rValue < 0 && this.toggle.weapon == 1){
				this.combatSpur.atk += 6;
				boostText += this.name + " gets +6 atk from enemy being debuffed with Chaos Manifest.<br>";
			}
			else if(this.rValue > 0 && (enemy.combatStartHp / enemy.maxHp >= 0.75 || this.toggle.weapon == 1 || this.toggle.weapon == 3)){
				this.combatSpur.atk += 6;
				this.combatSpur.res += 5;
				boostText += this.name + " gets +6 atk and +5 res from enemy HP >= 75% or enemy affected by [Penalty] with Chaos Manifest.<br>";
			}
			if(this.rValue == 5 && (this.initiator || this.toggle.weapon > 1)){
				this.combatSpur.atk += 5;
				this.combatSpur.res += 5;
				boostText += this.name + " gets +5 to atk and res from initiating or being within 2 spaces of an ally with Chaos Manifest.<br>";
			}
		}
		if(this.has("Brazen Cat Fang")){
			if(this.toggle.weapon == 1 || (this.rValue > 0 && this.initiator)){
				this.combatSpur.atk += 6;
				this.combatSpur.spd += 6;
				var bAText = "";
				if(this.rValue > 0 && this.initiator){
					bAText = " or initiating";
				}
				boostText += this.name + " gets +6 atk and spd from not being adjacent to an ally" + bAText +" with Brazen Cat Fang.<br>";
			}
			if(this.rValue == 5 && this.combatStartHp / this.maxHp >= 0.25){
				this.combatSpur.atk += 4;
				this.combatSpur.spd += 4;
				this.combatSpur.def += 4;
				this.combatSpur.res += 4;
				boostText += this.name + " gets +4 to all stats from HP >= 25% with Brazen Cat Fang.<br>";
			}
		}
		if(this.hasExactly("Death")){
			var buffVal = 4;
			if(this.rValue > 0){
				buffVal++;
				var deVal = 1;
				if(this.specialIndex != -1){
					deVal = deVal + data.skills[this.specialIndex].charge - this.initSkillCharge();
					deVal = Math.max(deVal,1);
				}
				enemy.combatSpur.spd -= deVal;
				enemy.combatSpur.res -= deVal;
				boostText += this.name + " inflicts -" + deVal + " spd and res to " + enemy.name + " with Death.  ";
			}
			this.combatSpur.atk += buffVal;
			this.combatSpur.spd += buffVal;
			this.combatSpur.def += buffVal;
			this.combatSpur.res += buffVal;
			boostText += this.name + " gets +" + buffVal + " to all stats with Death.<br>";
			if(this.rValue == 5 && enemy.combatStartHp / enemy.maxHp >= 0.75){
				this.combatSpur.atk += 4;
				this.combatSpur.spd += 4;
				this.combatSpur.def += 4;
				this.combatSpur.res += 4;
				boostText += this.name + " gets +4 to all stats from enemy HP >= 75% with Death.<br>";
			}
		}
		//Loyal Greatlance
		if(this.hasExactly("Loyal Greatlance") && this.rValue == 5 && this.toggle.weapon == 1){
			this.combatSpur.atk += 3;
			this.combatSpur.spd += 3;
			boostText += this.name + " gets +3 atk and spd from being within 2 spaces of an infantry or cavalry ally with Loyal Greatlance.<br>";
		}
		//Kagero's Dart
		if(this.hasExactly("Kagero's Dart") && allStats[16] > allStats[20]){
			this.combatSpur.atk += 4;
			this.combatSpur.spd += 4;
			boostText += this.name + " gets +4 to atk and spd from having more atk than " + enemy.name + " with " + data.skills[this.weaponIndex].name + ".<br>";
		}
		//Summer Returns weapons
		if((this.has("Tropical Treats") || this.has("Buoyboard") || this.has("Sandfort Spade") || this.has("Shoreline Rake")) && this.toggle.weapon == 1){
			this.combatSpur.atk += 4;
			this.combatSpur.def += 4;
			boostText += this.name + " gets +4 atk and def from being buffed with " + data.skills[this.weaponIndex].name + ".<br>";
		}
		//Rowdy Sword
		if(this.hasExactly("Rowdy Sword") && this.rValue == 5 && this.toggle.weapon == 1){
			this.combatSpur.atk += 6;
			this.combatSpur.def += 6;
			boostText += this.name + " gets +6 atk and def from enemy not being buffed with Rowdy Sword.<br>";
		}
		//Summer Refreshes weapons
		if((this.has("Scallop Blade") || this.has("Big-Catch Bow") || this.has("Petal Parasol")) && this.toggle.weapon == 1){
			this.combatSpur.atk += 5;
			this.combatSpur.spd += 5;
			boostText += this.name + " gets +5 atk and spd from " + enemy.name + " being debuffed with " + data.skills[this.weaponIndex].name + ".<br>";
		}
		//Selena's Blade
		if(this.hasExactly("Selena's Blade") && allStats[20] >= allStats[16] + 3){
			var buffVal = 3;
			this.combatSpur.atk += buffVal;
			this.combatSpur.spd += buffVal;
			this.combatSpur.def += buffVal;
			this.combatSpur.res += buffVal;
			boostText += this.name + " gets +" + buffVal + " in all stats from having 3 less or equal atk than the enemy with Selena's Blade.<br>";
		}
		if(this.hasExactly("Freikugel")){
			if(this.toggle.weapon == 1){
				this.combatSpur.atk += 6;
				this.combatSpur.spd += 6;
				boostText += this.name + " gets +6 atk and spd for not being within 2 spaces of allies with Def > Hilda's Def with Freikugel.<br>";
			}
			if(this.rValue == 5 && this.combatStartHp / this.maxHp >= 0.25){
				this.combatSpur.atk += 5;
				this.combatSpur.spd += 5;
				boostText += this.name + " gets +5 to atk and spd from HP >= 25% with Freikugel.<br>";
			}
		}
		//Dracofalchion
		if(this.hasExactly("Dracofalchion") && ((this.rValue < 0 && this.toggle.weapon == 1) || (this.rValue > 0 && (this.initiator || this.toggle.weapon == 1)))){
			this.combatSpur.atk += 5;
			this.combatSpur.spd += 5;
			this.combatSpur.def += 5;
			this.combatSpur.res += 5;
			if(this.rValue < 0){
				boostText += this.name + " gets +5 to all stats from having # of enemies >= # of allies within 2 spaces with Dracofalchion.<br>";
			}
			else{
				boostText += this.name + " gets +5 to all stats from initiating or not being adjacent to an ally with Dracofalchion.<br>";
			}
		}
		if(this.hasExactly("Virtuous Naga")){
			if(allStats[16] > allStats[20] || (this.rValue > 0 && enemy.combatStartHp / enemy.maxHp >= 0.75)){
				this.combatSpur.atk += 6;
				this.combatSpur.res += 6;
				var rText = "";
				if(this.rValue > 0){
					rText = " or Enemy HP >= 75%";
				}
				boostText += this.name + " gets +6 to atk and res from having more atk than " + enemy.name + rText + " with Virtuous Naga.<br>";
			}
			if(this.rValue == 5 && this.toggle.weapon == 1){
				this.combatSpur.atk += 4;
				this.combatSpur.spd += 4;
				this.combatSpur.def += 4;
				this.combatSpur.res += 4;
				boostText += this.name + " gets +4 to all stats from being within 3 spaces of an ally with Virtuous Naga.<br>";
			}
		}
		//Mulagir refined
		if(this.hasExactly("Mulagir") && this.rValue == 5 && allStats[17] + this.getPhantom("Spd") > allStats[21] + enemy.getPhantom("Spd")){
			this.combatSpur.atk += 4;
			this.combatSpur.spd += 4;
			this.combatSpur.def += 4;
			this.combatSpur.res += 4;
			boostText += this.name + " gets +4 to all stats from having more spd than enemy with Mulagir.<br>";
		}
		//Weirding Tome Refined
		if(this.hasExactly("Weirding Tome") && this.rValue == 5 && (this.toggle.weapon == 2 || this.toggle.weapon == 3)){
			this.combatSpur.atk += 4;
			this.combatSpur.spd += 4;
			this.combatSpur.def += 4;
			this.combatSpur.res += 4;
			boostText += this.name + " gets +4 to all stats from " + enemy.name + " being debuffed with " + data.skills[this.weaponIndex].name + ".<br>";
		}
		if(this.hasExactly("Conjurer Curios")){
			if((currTurn % 2 == 1 || enemy.combatStartHp / enemy.maxHp < 1)){
				this.combatSpur.atk += 4;
				this.combatSpur.spd += 4;
				this.combatSpur.def += 4;
				this.combatSpur.res += 4;
				boostText += this.name + " gets +4 to all stats from being odd-numbered turn or enemy HP < 100% with Conjurer Curios.<br>";
			}
			if(this.rValue == 5 && this.combatStartHp / this.maxHp >= 0.25){
				this.combatSpur.atk += 4;
				this.combatSpur.spd += 4;
				this.combatSpur.def += 4;
				this.combatSpur.res += 4;
				var shVal = Math.floor(allStats[16] * 0.1);
				enemy.combatSpur.atk -= shVal;
				enemy.combatSpur.def -= shVal;
				boostText += this.name + " gets +4 to all stats and inflicts -" + shVal + " atk/def to " + enemy.name + " from HP >= 25% with Conjurer Curios.<br>";
			}
		}
		//Golden Naginata
		if(this.hasExactly("Golden Naginata") && allStats[20] >= allStats[16] + 3){
			var buffVal = 3;
			this.combatSpur.atk += buffVal;
			this.combatSpur.spd += buffVal;
			this.combatSpur.def += buffVal;
			this.combatSpur.res += buffVal;
			boostText += this.name + " gets +" + buffVal + " in all stats from having 3 less or equal atk than the enemy with Golden Naginata.<br>";
		}
		//Sun Dragonstone
		if(this.hasExactly("Sun Dragonstone") && (!this.initiator || !checkAllBuffs(enemy, this, currTurn))){
			var buffVal = 4;
			this.combatSpur.atk += buffVal;
			this.combatSpur.spd += buffVal;
			this.combatSpur.def += buffVal;
			this.combatSpur.res += buffVal;
			boostText += this.name + " gets +" + buffVal + " in all stats from enemy initiating or bonus stats not active on enemy with Sun Dragonstone.<br>";
		}
		if(this.hasExactly("Ashera's Chosen") && this.toggle.a == 1){
			this.combatSpur.atk += 6;
			this.combatSpur.def += 6;
			boostText += this.name + " gets +6 atk and def from not being adjacent to an ally/being adjacent to only beast or dragon ally with Ashera's Chosen.<br>";
		}
		//Knightly and Lordly Lance refined
		if((this.hasExactly("Knightly Lance") || this.hasExactly("Lordly Lance")) && this.rValue == 5 && this.toggle.weapon == 1){
			var buffVal = 3;
			this.combatSpur.atk += buffVal;
			this.combatSpur.spd += buffVal;
			this.combatSpur.def += buffVal;
			this.combatSpur.res += buffVal;
			boostText += this.name + " gets +3 to all stats from being within 2 spaces of support partner with " + data.skills[this.weaponIndex].name + ".<br>";
		}
		//Arthur's Axe
		if(this.hasExactly("Arthur's Axe") && checkAllBuffs(this, enemy, currTurn)){
			var buffVal = 3;
			this.combatSpur.atk += buffVal;
			this.combatSpur.spd += buffVal;
			this.combatSpur.def += buffVal;
			this.combatSpur.res += buffVal;
			boostText += this.name + " gets +" + buffVal + " in all stats from having bonus stats active with Arthur's Axe.<br>";
		}
		if(this.hasExactly("Arthur's Axe") && this.rValue == 5 && (this.toggle.weapon == 1 || this.combatStartHp / this.maxHp < 1)){
			var buffVal = 5;
			this.combatSpur.atk += buffVal;
			this.combatSpur.spd += buffVal;
			this.combatSpur.def += buffVal;
			this.combatSpur.res += buffVal;
			boostText += this.name + " gets +" + buffVal + " in all stats from being affected with a Penalty or <100% HP with Arthur's Axe.<br>";
		}
		if(this.hasExactly("Mareeta's Sword")){
			if(this.toggle.weapon == 1 || (this.rValue > 0 && this.initiator)){
				var mText = "not being adjacent to an ally";
				if(this.rValue > 0){
					mText = "initiating or # of allies adjacent <= 1";
				}
				this.combatSpur.atk += 4;
				this.combatSpur.spd += 4;
				this.combatSpur.def += 4;
				this.combatSpur.res += 4;
				boostText += this.name + " gets +4 to all stats from " + mText + " with Mareeta's Sword.<br>";
			}
			if(this.rValue == 5 && this.combatStartHp / this.maxHp >= 0.25){
				this.combatSpur.atk += 4;
				this.combatSpur.spd += 4;
				this.combatSpur.def += 4;
				this.combatSpur.res += 4;
				boostText += this.name + " gets +4 to all stats from HP >= 25% with Mareeta's Sword.<br>";
			}
		}
		if(this.hasExactly("Imbued Koma")){
			if(this.specialIndex != -1 && data.skills[this.specialIndex].charge <= this.charge){
				this.combatSpur.atk += 5;
				this.combatSpur.spd += 5;
				this.combatSpur.def += 5;
				this.combatSpur.res += 5;
				boostText += this.name + " gets +5 in all stats from having Special ready with Imbued Koma.<br>";
			}
			if(this.rValue == 5 && this.toggle.weapon == 1){
				this.combatSpur.atk += 4;
				this.combatSpur.spd += 4;
				this.combatSpur.def += 4;
				this.combatSpur.res += 4;
				boostText += this.name + " gets +4 in all stats from being within 3 spaces of an ally with Imbued Koma.<br>";
			}
		}
		if(this.specialIndex != -1 && data.skills[this.specialIndex].charge <= this.charge && this.hasExactly("Imbued Koma")){
			var buffVal = 5;
			
		}
		if(this.hasExactly("Balmung")){
			if(!this.initiator || enemy.combatStartHp / enemy.maxHp == 1 || (this.rValue > 0 && enemy.combatStartHp / enemy.maxHp >= 0.75)){
				var bText = "HP = 100%";
				if(this.rValue > 0){
					bText = "HP >= 75%";
				}
				this.combatSpur.atk += 5;
				this.combatSpur.spd += 5;
				this.combatSpur.def += 5;
				this.combatSpur.res += 5;
				if(this.penalty.panic){
					this.combatBuffs = {"atk":0,"spd":0,"def":0,"res":0};
					this.buffs = {"atk":0,"spd":0,"def":0,"res":0};
				}
				this.combatDebuffs = {"atk":0,"spd":0,"def":0,"res":0};
				this.debuffs = {"atk":0,"spd":0,"def":0,"res":0};
				boostText += this.name + " gets +5 to all stats and neutralizes penalties from enemy initiating or enemy " + bText + " with Balmung.<br>";
			}
			if(this.rValue == 5 && this.combatStartHp / this.maxHp >= 0.25){
				var bVal = Math.floor(allStats[17] * 0.15) + 4;
				this.combatSpur.atk += bVal;
				this.combatSpur.spd += bVal;
				this.combatSpur.def += bVal;
				this.combatSpur.res += bVal;
				boostText += this.name + " gets +" + bVal + " to all stats from HP >= 25% with Balmung.<br>";
			}
		}
		if(this.hasExactly("Winds of Silesse")){
			if(this.toggle.weapon == 1 || (this.rValue > 0 && this.initiator)){
				this.combatSpur.atk += 6;
				this.combatSpur.spd += 6;
				var wText = "from not being adjacent to an ally";
				if(this.rValue > 0){
					var wsVal = Math.floor(allStats[17] * 0.2);
					enemy.combatSpur.spd -= wsVal;
					enemy.combatSpur.def -= wsVal;
					wText = "and inflicts -" + wsVal + " spd & res to " + enemy.name + " from initiating or # of allies adjacent <= 1";
				}
				boostText += this.name + " gets +6 to atk & spd " + wText + " with Winds of Silesse.<br>";
			}
			if(this.rValue == 5 && this.combatStartHp / this.maxHp >= 0.25){
				this.combatSpur.atk += 5;
				this.combatSpur.spd += 5;
				boostText += this.name + " gets +5 to atk & spd from HP >= 25% with Winds of Silesse.<br>";
			}
		}
		if(this.hasExactly("Larcei's Edge")){
			if(allStats[17] + this.getPhantom("Spd") > allStats[21] + enemy.getPhantom("Spd") || enemy.combatStartHp / enemy.maxHp == 1 || (this.rValue > 0 && enemy.combatStartHp / enemy.maxHp >= 0.75)){
				var leText = "enemy HP = 100%";
				if(this.rValue > 0){
					leText = "enemy HP >= 75%";
				}
				this.combatSpur.atk += 4;
				this.combatSpur.spd += 4;
				this.combatSpur.def += 4;
				this.combatSpur.res += 4;
				boostText += this.name + " gets +4 to all stats from having more spd than enemy or " + leText + " with Larcei's Edge.<br>";
			}
			if(this.rValue == 5 && this.combatStartHp / this.maxHp >= 0.25){
				this.combatSpur.atk += 4;
				this.combatSpur.spd += 4;
				this.combatSpur.def += 4;
				this.combatSpur.res += 4;
				boostText += this.name + " gets +4 to all stats from HP >= 25% with Larcei's Edge.<br>";
			}
		}
		//Cordelia's Lance - Refined
		if(this.hasExactly("Cordelia's Lance") && this.combatStartHp / this.maxHp >= 0.7 && this.rValue == 5){
			this.combatSpur.atk += 4;
			this.combatSpur.spd += 4;
			boostText += this.name + " gets +4 to atk and spd from having HP >= 70% with Cordelia's Lance.<br>";
		}
		//Rebecca's Bow - Refined
		if(this.hasExactly("Rebecca's Bow") && checkAllBuffs(this, enemy, currTurn) && this.rValue == 5){
			var buffVal = 4;
			this.combatSpur.atk += buffVal;
			this.combatSpur.spd += buffVal;
			this.combatSpur.def += buffVal;
			this.combatSpur.res += buffVal;
			boostText += this.name + " gets +" + buffVal + " in all stats from having bonus stats active with Rebecca's Bow.<br>";
		}
		//Light Brand - Refined
		if(this.hasExactly("Light Brand") && enemy.combatStartHp / enemy.maxHp >= 1 && this.rValue == 5){
			this.combatSpur.spd += 4;
			this.combatSpur.def += 4;
			boostText += this.name + " gets +4 to spd and def from enemy HP = 100% with Light Brand.<br>";
		}
		if(this.hasExactly("Mirage Axe")){
			if(this.buddy.adjacent > 0 || this.buddy.two > 0 || (this.rValue > 0 && this.buddy.three > 0)){
				var maText = " from being within 2 spaces of an ally with Mirage Axe.<br>";
				this.combatSpur.def += 6;
				this.combatSpur.res += 6;
				if(this.rValue > 0){
					this.combatSpur.atk += 4;
					this.combatSpur.spd += 4;
					maText = " and +4 to atk & spd from being within 3 spaces of an ally with Mirage Axe.<br>";
					if(!this.initiator){
						var maVal = (4 - this.toggle.weapon) * 3;
						enemy.combatSpur.atk -= maVal;
						enemy.combatSpur.def -= maVal;
						maText = " and +4 to atk & spd and inflicts -" + maVal + " atk & def to " + enemy.name + " from being within 3 spaces of an ally with Mirage Axe.<br>";
					}
				}
				boostText += this.name + " gets +6 to def & res" + maText;
			}
			if(this.rValue == 5 && this.combatStartHp / this.maxHp >= 0.25){
				this.combatSpur.atk += 4;
				this.combatSpur.spd += 4;
				this.combatSpur.def += 4;
				this.combatSpur.res += 4;
				boostText += this.name + " gets +4 to all stats from HP >= 25% with Mirage Axe.<br>";
			}
		}
		if(this.hasExactly("Sokkvabekkr")){
			if(this.toggle.weapon == 1){
				var buffVal = 4;
				var aSpace = "3";
				if(this.rValue > 0){
					var buffVal = 6;
					aSpace = "4";
				}
				this.combatSpur.atk += buffVal;
				this.combatSpur.spd += buffVal;
				this.combatSpur.def += buffVal;
				this.combatSpur.res += buffVal;
				boostText += this.name + " gets +" + buffVal + " in all stats from having an ally within " + aSpace + " spaces with Sokkvabekkr.<br>";
			}
			if(this.rValue == 5 && this.combatStartHp / this.maxHp >= 0.25){
				this.combatSpur.atk += 4;
				this.combatSpur.spd += 4;
				this.combatSpur.def += 4;
				this.combatSpur.res += 4;
				boostText += this.name + " gets +4 to all stats from HP >= 25% with Sokkvabekkr.<br>";
			}
		}
		//Laslow's Blade
		if(this.hasExactly("Laslow's Blade") && this.rValue == 5 && this.toggle.weapon == 1){
			this.combatSpur.atk += 3;
			this.combatSpur.def += 3;
			boostText += this.name + " gets +3 to atk and def from being within 3 spaces of 2 or more allies who each have >= 10 buffs with Laslow's Blade.<br>";
		}
		//Devil Axe
		if(this.hasExactly("Devil Axe")){
			var buffVal = 4;
			this.combatSpur.atk += buffVal;
			this.combatSpur.spd += buffVal;
			this.combatSpur.def += buffVal;
			this.combatSpur.res += buffVal;
			boostText += this.name + " gets +" + buffVal + " in all stats with Devil Axe.<br>";
		}
		//Jakob's Tray
		if(this.hasExactly("Jakob's Tray") && this.rValue == 5 && this.toggle.weapon == 1){
			var buffVal = 4;
			this.combatSpur.atk += buffVal;
			this.combatSpur.spd += buffVal;
			this.combatSpur.def += buffVal;
			this.combatSpur.res += buffVal;
			boostText += this.name + " gets +" + buffVal + " in all stats from being within 3 spaces of an ally who has HP < 100% with Jakob's Tray.<br>";
		}
		//Father's Tactics
		if(this.hasExactly("Father's Tactics") && allStats[19] + this.getPhantom("Res") > allStats[23] + enemy.getPhantom("Res")){
			var buffVal = 4;
			this.combatSpur.atk += buffVal;
			this.combatSpur.spd += buffVal;
			this.combatSpur.def += buffVal;
			this.combatSpur.res += buffVal;
			boostText += this.name + " gets +4 to all stats from having more res than " + enemy.name + " with " + data.skills[this.weaponIndex].name + ".<br>";
		}
		if(this.hasExactly("Father's Tactics") && this.rValue == 5 && this.toggle.weapon == 1){
			this.combatSpur.atk += 3;
			this.combatSpur.spd += 3;
			boostText += this.name + " gets +3 to atk and spd from being within 2 spaces of an ally with Father's Tactics.<br>";
		}
		if(this.hasExactly("Scepter of Love")){
			if(this.rValue < 0 && (checkAllBuffs(this, enemy, currTurn) || this.combatStartHp / this.maxHp >= 0.7)){
				this.combatSpur.atk += Math.floor(allStats[22] / 4);
				enemy.combatSpur.atk -= Math.floor(allStats[23] / 4);
				boostText += this.name + " gets +" + Math.floor(allStats[22] / 4) + " atk and inflicts -" + Math.floor(allStats[23] / 4) + " atk on " + enemy.name + " from having a bonus active or HP >= 70% with Scepter of Love.<br>";
			}
			else if(this.rValue > 0 && (checkAllBuffs(this, enemy, currTurn) || this.toggle.weapon == 1 || this.toggle.weapon == 3 || this.combatStartHp / this.maxHp >= 0.25)){
				this.combatSpur.atk += 4;
				this.combatSpur.spd += 4;
				this.combatSpur.def += 4;
				this.combatSpur.res += 4;
				var bVal = Math.floor(allStats[22] * 0.25);
				var pVal = Math.floor(allStats[23] * 0.25);
				this.combatSpur.atk += bVal;
				this.combatSpur.spd += bVal;
				enemy.combatSpur.atk -= pVal;
				enemy.combatSpur.def -= pVal;
				boostText += this.name + " gets +4 to all stats and an additional +" + bVal + " to atk & spd and inflicts -" + pVal + " atk & def on " + enemy.name + " from having a [Bonus] active or HP >= 25% with Scepter of Love.<br>";
			}
			if(this.rValue == 5 && (this.initiator || this.toggle.weapon > 1)){
				this.combatSpur.atk += 4;
				this.combatSpur.spd += 4;
				this.combatSpur.def += 4;
				this.combatSpur.res += 4;
				boostText += this.name + " gets +4 to all stats from initiating or being within 2 spaces of an ally with Scepter of Love.<br>";
			}
		}
		if(this.hasExactly("Persecution Bow")){
			if(this.combatStartHp / this.maxHp < 1 || Object.values(this.penalty).reduce((a, item) => a + (item === true ? 1 : 0), 0) + this.penalty.extra > 0){
				this.combatSpur.atk += 5;
				this.combatSpur.spd += 5;
				boostText += this.name + " gets +5 atk & spd from HP < 100% or having a [Penalty] active with Persecution Bow.<br>";
			}
			if(this.rValue == 5 && (this.initiator || enemy.combatStartHp / enemy.maxHp >= 0.75)){
				var pbVal = (this.maxHp - this.combatStartHp) * 2 + 5;
				pbVal = Math.min(pbVal,15);
				this.combatSpur.atk += pbVal;
				this.combatSpur.spd += pbVal;
				boostText += this.name + " gets +" + pbVal + " atk & spd from initiating or enemy HP >= 75% with Persecution Bow.<br>";
			}
		}
		//Laid-Back Blade - Refined
		if(this.hasExactly("Laid-Back Blade") && this.rValue == 5 && this.toggle.weapon == 1){
			var buffVal = 5;
			this.combatSpur.atk += buffVal;
			this.combatSpur.spd += buffVal;
			this.combatSpur.def += buffVal;
			this.combatSpur.res += buffVal;
			boostText += this.name + " gets +" + buffVal + " in all stats from having >= foes than allies within 2 spaces with Laid-Back Blade.<br>";
		}
		//Veteran Lance
		if(this.hasExactly("Veteran Lance") && (!this.initiator || enemy.combatStartHp / enemy.maxHp >= 0.7)){
			this.combatSpur.atk += 5;
			this.combatSpur.res += 5;
			boostText += this.name + " gets +5 atk and res from enemy initiating or enemy HP >= 70% with Veteran Lance.<br>";
		}
		if(this.hasExactly("Eagle's Egg")){
			if(this.toggle.weapon == 1 || this.toggle.weapon == 4 || this.toggle.weapon == 5 || this.toggle.weapon == 7 || (this.rValue > 0 && this.initiator)){
				var buffVal = 5;
				var eText = "";
				if(this.rValue > 0){
					eText = " initiating or";
				}
				this.combatSpur.atk += buffVal;
				this.combatSpur.spd += buffVal;
				this.combatSpur.def += buffVal;
				this.combatSpur.res += buffVal;
				if(this.penalty.panic){
					this.combatBuffs = {"atk":0,"spd":0,"def":0,"res":0};
					this.buffs = {"atk":0,"spd":0,"def":0,"res":0};
				}
				this.combatDebuffs = {"atk":0,"spd":0,"def":0,"res":0};
				this.debuffs = {"atk":0,"spd":0,"def":0,"res":0};
				boostText += this.name + " gets +5 to all stats and neutralizes penalties from" + eText + " being within 2 spaces of an ally with Eagle's Egg.<br>";
			}
			if(this.rValue == 5 && this.combatStartHp / this.maxHp >= 0.25){
				this.combatSpur.atk += 4;
				this.combatSpur.spd += 4;
				this.combatSpur.def += 4;
				this.combatSpur.res += 4;
				boostText += this.name + " gets +4 to all stats from HP >= 25% with Eagle's Egg.<br>";
			}
		}
		//Gilt Fork & Carrot Cudgel & Pale Breath
		if((this.has("Gilt Fork") || this.has("Carrot Cudgel") || this.has("Pale Breath") || this.has("Steadfast Axe") || this.has("Steadfast Lance") || this.has("Steadfast Sword")) && this.toggle.weapon == 1){
			this.combatSpur.atk += 5;
			this.combatSpur.def += 5;
			if(this.penalty.panic){
				this.combatBuffs.atk = 0;
				this.combatBuffs.def = 0;
				this.buffs.atk = 0;
				this.buffs.def = 0;
			}
			this.combatDebuffs.atk = 0;
			this.combatDebuffs.def = 0;
			this.debuffs.atk = 0;
			this.debuffs.def = 0;
			boostText += this.name + " gets +5 to atk & def and neutralizes penalties to atk & def from being within 2 spaces of an ally with " + data.skills[this.weaponIndex].name + ".<br>";
		}
		//Zephyr Breath
		if(this.hasExactly("Zephyr Breath")){
			if(this.toggle.weapon == 1 || checkAllBuffs(this, enemy, currTurn)){
				var zText = "";
				enemy.combatSpur.atk -= 6;
				if(this.rValue > 0){
					zText = " & -4 spd/def/res";
					enemy.combatSpur.spd -= 4;
					enemy.combatSpur.def -= 4;
					enemy.combatSpur.res -= 4;
				}
				if(this.penalty.panic){
					this.combatBuffs = {"atk":0,"spd":0,"def":0,"res":0};
					this.buffs = {"atk":0,"spd":0,"def":0,"res":0};
				}
				this.combatDebuffs = {"atk":0,"spd":0,"def":0,"res":0};
				this.debuffs = {"atk":0,"spd":0,"def":0,"res":0};
				boostText += this.name + " neutralizes penalties and inflicts -6 atk" + zText + " to " + enemy.name + " with Zephyr Breath.<br>";
			}
			if(this.rValue == 5 && (!this.initiator || enemy.combatStartHp / enemy.maxHp >= 0.75)){
				enemy.combatSpur.atk -= 4;
				enemy.combatSpur.spd -= 4;
				enemy.combatSpur.def -= 4;
				enemy.combatSpur.res -= 4;
				boostText += this.name + " inflicts -4 to all stats to " + enemy.name + " from enemy initiating or enemy HP >= 75% with Zephyr Breath.<br>";
			}
		}
		if(this.hasExactly("Void Tome")){
			if(allStats[20] >= 50 || this.toggle.weapon == 1 || this.toggle.weapon == 3){
				var buffVal = 5;
				this.combatSpur.atk += buffVal;
				this.combatSpur.def += buffVal;
				this.combatSpur.res += buffVal;
				boostText += this.name + " gets +5 to atk/def/res from enemy having >= 50 atk or Penalty active on enemy with Void Tome.<br>";
			}
			if(this.rValue == 5 && enemy.combatStartHp / enemy.maxHp >= 0.5){
				this.combatSpur.atk += 4;
				this.combatSpur.spd += 4;
				this.combatSpur.def += 4;
				this.combatSpur.res += 4;
				boostText += this.name + " gets +4 to all stats from enemy HP >= 50% with Void Tome.<br>";
			}
		}
		if(this.has("Spendthrift Bow")){
			this.combatSpur.atk += 7;
			enemy.combatSpur.atk -= 7;
			boostText += this.name + " gets +7 to atk and inflicts -7 atk to " + enemy.name + " with " + data.skills[this.weaponIndex].name + ".<br>";
		}
		if(this.hasExactly("Astral Breath")){
			if(this.buddy.adjacent + this.buddy.two + this.buddy.three > 0 && (this.buddy.rank != "N" || this.rValue > 0)){
				this.combatSpur.atk += 5;
				this.combatSpur.spd += 5;
				this.combatSpur.def += 5;
				this.combatSpur.res += 5;
				var abText = "support partner";
				if(this.rValue > 0){
					abText = "an ally";
				}
				boostText += this.name + " gets +5 to all stats from being within 3 spaces of " + abText + " with Astral Breath.<br>";
			}
			if(this.rValue == 5 && this.combatStartHp / this.maxHp >= 0.25){
				var abVal = this.toggle.weapon % 10 + 4;
				this.combatSpur.atk += abVal;
				this.combatSpur.spd += abVal;
				this.combatSpur.def += abVal;
				this.combatSpur.res += abVal;
				boostText += this.name + " gets +" + abVal + " to all stats from HP >= 25% with Astral Breath.<br>";
			}
		}
		//Refined Inveterate Axe
		if(this.hasExactly("Inveterate Axe") && this.rValue == 5 && (this.toggle.weapon == 2 || this.toggle.weapon == 3)){
			this.combatSpur.atk += 4;
			this.combatSpur.def += 4;
			boostText += this.name + " gets +4 to atk and def from being within 2 spaces of an infantry/cavalry ally with Inveterate Axe.<br>";
		}
		if(this.hasExactly("Winds of Change")){
			if(this.combatStartHp / this.maxHp >= 0.5 || checkAllBuffs(this, enemy, currTurn) || (this.rValue > 0 && Object.values(this.bonus).reduce((a, item) => a + (item === true ? 1 : 0), 0) + this.bonus.extra > 0)){
				this.combatSpur.atk += 5;
				this.combatSpur.spd += 5;
				boostText += this.name + " gets +5 to atk & spd from having a buff active or >= 50% HP with Winds of Change.<br>";
			}
			if(this.rValue == 5 && (this.initiator || this.buddy.adjacent > 0 || this.buddy.two > 0)){
				this.combatSpur.atk += 5;
				this.combatSpur.spd += 5;
				boostText += this.name + " gets +5 to atk & spd from initiating or having an ally within 2 spaces with Winds of Change.<br>";
			}
		}
		//Refined Dark Greatsword
		if(this.hasExactly("Dark Greatsword") && this.rValue == 5 && this.toggle.weapon == 1){
			this.combatSpur.atk += 5;
			this.combatSpur.spd += 5;
			boostText += this.name + " gets +5 to atk and spd from not being adjacent to an ally with Dark Greatsword.<br>";
		}
		//Refined Runeaxe
		if(this.hasExactly("Runeaxe") && this.rValue == 5 && this.toggle.weapon == 1){
			var buffVal = 4;
			this.combatSpur.atk += buffVal;
			this.combatSpur.spd += buffVal;
			this.combatSpur.def += buffVal;
			this.combatSpur.res += buffVal;
			boostText += this.name + " gets +" + buffVal + " in all stats from penalty active on " + enemy.name + " with Runeaxe.<br>";
		}
		//Pledged Blade and Huge Fan
		if((this.has("Pledged Blade") || this.has("Huge Fan")) && this.toggle.weapon == 1){
			this.combatSpur.atk += 4;
			this.combatSpur.def += 4;
			boostText += this.name + " gets +4 to atk and def from having a Bonus active with " + data.skills[this.weaponIndex].name + ".<br>";
		}
		if(this.hasExactly("Joyful Vows")){
			if(this.checkBonPen(1,enemy,currTurn) || (this.rValue > 0 && enemy.checkBonPen(3,this,currTurn))){
				this.combatSpur.atk += 6;
				this.combatSpur.res += 6;
				var jvText = " from having [Bonus] active";
				if(this.rValue > 0){
					var yVal = 0;
					var eNegate = this.checkNegate(enemy, currTurn);
					if(eNegate[0] == false){
						var aVal = Math.min(enemy.combatDebuffs.atk,enemy.debuffs.atk);
						if(enemy.penalty.panic){
							aVal -= Math.max(enemy.combatBuffs.atk,enemy.buffs.atk);
						}
						yVal += aVal;
					}
					if(eNegate[1] == false){
						var sVal = Math.min(enemy.combatDebuffs.spd,enemy.debuffs.spd);
						if(enemy.penalty.panic){
							sVal -= Math.max(enemy.combatBuffs.spd,enemy.buffs.spd);
						}
						yVal += sVal;
					}
					if(eNegate[2] == false){
						var dVal = Math.min(enemy.combatDebuffs.def,enemy.debuffs.def);
						if(enemy.penalty.panic){
							dVal -= Math.max(enemy.combatBuffs.def,enemy.buffs.def);
						}
						yVal += dVal;
					}
					if(eNegate[3] == false){
						var rVal = Math.min(enemy.combatDebuffs.res,enemy.debuffs.res);
						if(enemy.penalty.panic){
							rVal -= Math.max(enemy.combatBuffs.res,enemy.buffs.res);
						}
						yVal += rVal;
					}
					yVal = -Math.min(yVal,enemy.buddy.debuffs.atk + enemy.buddy.debuffs.spd + enemy.buddy.debuffs.def + enemy.buddy.debuffs.res);
					this.combatSpur.atk += yVal;
					jvText = " and an additional +" + yVal + " atk from having [Bonus] active or [Penalty] being active on " + enemy.name;
				}
				boostText += this.name + " gets +6 to atk & res" + jvText + " with Joyful Vows.<br>";
			}
			if(this.rValue == 5 && (this.initiator || this.buddy.adjacent > 0 || this.buddy.two > 0)){
				this.combatSpur.atk += 5;
				this.combatSpur.res += 5;
				boostText += this.name + " gets +5 to atk & res from initiating or being within 2 spaces of an ally with Joyful Vows.<br>";
			}
		}
		if(this.hasExactly("Stalwart Sword") && this.rValue == 5 && this.toggle.weapon == 1){
			this.combatSpur.atk += 5;
			this.combatSpur.def += 5;
			if(this.penalty.panic){
				this.combatBuffs.atk = 0;
				this.combatBuffs.def = 0;
				this.buffs.atk = 0;
				this.buffs.def = 0;
			}
			this.combatDebuffs.atk = 0;
			this.combatDebuffs.def = 0;
			this.debuffs.atk = 0;
			this.debuffs.def = 0;
			boostText += this.name + " gets +5 to atk & def and neutralizes penalties to atk & def from being within 2 spaces of an ally with " + data.skills[this.weaponIndex].name + ".<br>";
		}
		//Sniper's Bow
		if(this.hasExactly("Sniper's Bow") && this.rValue == 5 && this.combatStartHp / this.maxHp >= 0.5){
			this.combatSpur.atk += 4;
			this.combatSpur.spd += 4;
			skillName = data.skills[this.weaponIndex].name;
			boostText += this.name + " gets +4 to atk and spd from HP >= 50% with " + skillName + ".<br>";
		}
		//Refined Great Flame
		if(this.hasExactly("Great Flame") && this.rValue == 5 && this.combatStartHp / this.maxHp >= 0.25 && this.toggle.weapon == 1){
			var buffVal = 5;
			this.combatSpur.atk += buffVal;
			this.combatSpur.spd += buffVal;
			this.combatSpur.def += buffVal;
			this.combatSpur.res += buffVal;
			skillName = data.skills[this.weaponIndex].name;
			boostText += this.name + " gets +5 to all stats from HP >= 25% and being within 2 spaces of an ally with " + skillName + ".<br>";
		}
		if(this.hasExactly("Apotheosis Spear")){
			if(enemy.combatStartHp / enemy.maxHp >= 0.75 || (this.rValue > 0 && this.initiator)){
				var asText = " from enemy HP >= 75%";
				this.combatSpur.atk += 5;
				this.combatSpur.spd += 5;
				if(this.rValue > 0){
					this.combatSpur.def += 4;
					this.combatSpur.res += 4;
					asText = " and +4 to def & res from initiating or enemy HP >= 75%";
				}
				boostText += this.name + " gets +5 to atk & spd" + asText + " with Apotheosis Spear.<br>";
			}
			if(this.rValue == 5 && this.combatStartHp / this.maxHp >= 0.25){
				var asVal = Math.min((Object.values(this.bonus).reduce((a, item) => a + (item === true ? 1 : 0), 0) + this.bonus.extra) * 2 + 4, 12);
				this.combatSpur.atk += asVal;
				this.combatSpur.spd += asVal;
				this.combatSpur.def += asVal;
				this.combatSpur.res += asVal;
				if(this.penalty.panic){
					this.combatBuffs = {"atk":0,"spd":0,"def":0,"res":0};
					this.buffs = {"atk":0,"spd":0,"def":0,"res":0};
				}
				this.combatDebuffs = {"atk":0,"spd":0,"def":0,"res":0};
				this.debuffs = {"atk":0,"spd":0,"def":0,"res":0};
				boostText += this.name + " gets +" + asVal + " to all stats and neutralizes penalties from HP >= 25% with Apotheosis Spear.<br>";
			}
		}
		if(this.hasExactly("Levin Dagger")){
			if(enemy.checkBonPen(3,this,currTurn) || (this.rValue > 0 && this.checkBonPen(1,enemy,currTurn))){
				this.combatSpur.atk += 4;
				this.combatSpur.spd += 4;
				this.combatSpur.def += 4;
				this.combatSpur.res += 4;
				var ldText = "";
				if(this.rValue > 0){
					ldText = " having [Bonus] active or";
				}
				boostText += this.name + " gets +4 to all stats from" + ldText +" [Penalty] being active on " + enemy.name + " with Levin Dagger.<br>";
			}
			if(this.rValue == 5 && this.combatStartHp / this.maxHp >= 0.25){
				this.combatSpur.atk += 4;
				this.combatSpur.spd += 4;
				this.combatSpur.def += 4;
				this.combatSpur.res += 4;
				var eNegate = this.checkNegate(enemy, currTurn);
				var dAtk = 0;
				var dSpd = 0;
				var dDef = 0;
				var dRes = 0;
				if(eNegate[0] == false){
					dAtk += Math.min(enemy.combatDebuffs.atk,enemy.debuffs.atk);
					if(enemy.penalty.panic){
						dAtk -= Math.max(enemy.combatBuffs.atk,enemy.buffs.atk);
					}
				}
				if(eNegate[1] == false){
					dSpd += Math.min(enemy.combatDebuffs.spd,enemy.debuffs.spd);
					if(enemy.penalty.panic){
						dSpd -= Math.max(enemy.combatBuffs.spd,enemy.buffs.spd);
					}
				}
				if(eNegate[2] == false){
					dDef += Math.min(enemy.combatDebuffs.def,enemy.debuffs.def);
					if(enemy.penalty.panic){
						dDef -= Math.max(enemy.combatBuffs.def,enemy.buffs.def);
					}
				}
				if(eNegate[3] == false){
					dRes += Math.min(enemy.combatDebuffs.res,enemy.debuffs.res);
					if(enemy.penalty.panic){
						dRes -= Math.max(enemy.combatBuffs.res,enemy.buffs.res);
					}
				}
				if(enemy.buddy.adjacent > 0 || enemy.buddy.two > 0){
					dAtk = Math.min(dAtk,enemy.buddy.debuffs.atk);
					dSpd = Math.min(dSpd,enemy.buddy.debuffs.spd);
					dDef = Math.min(dDef,enemy.buddy.debuffs.def);
					dRes = Math.min(dRes,enemy.buddy.debuffs.res);
				}
				enemy.combatSpur.atk += dAtk;
				enemy.combatSpur.spd += dSpd;
				enemy.combatSpur.def += dDef;
				enemy.combatSpur.res += dRes;
				boostText += this.name + " gets +4 to all stats and inflicts " + dAtk + " atk/" + dSpd + " spd/" + dDef + " def/" + dRes + " res on " + enemy.name + " from HP >= 25% with Levin Dagger..<br>";
			}
		}
		//Dark Royal Spear
		if(this.hasExactly("Dark Royal Spear") && (!this.initiator || enemy.combatStartHp / enemy.maxHp == 1)){
			this.combatSpur.atk += 5;
			this.combatSpur.def += 5;
			this.combatSpur.res += 5;
			boostText += this.name + " gets +5 atk/def/res from enemy initiating or enemy HP = 100% with Dark Royal Spear.<br>";
		}
		//Beloved Zofia
		if(this.hasExactly("Beloved Zofia") && (this.combatStartHp / this.maxHp == 1 || this.rValue > 0)){
			this.combatSpur.atk += 4;
			this.combatSpur.spd += 4;
			this.combatSpur.def += 4;
			this.combatSpur.res += 4;
			boostText += this.name + " gets +4 in all stats with Beloved Zofia.<br>";
		}
		//Beloved Zofia - Refined
		if(this.hasExactly("Beloved Zofia") && this.rValue == 5 && (enemy.combatStartHp / enemy.maxHp < 1 || this.combatStartHp / this.maxHp < 1)){
			this.combatSpur.atk += 4;
			this.combatSpur.spd += 4;
			this.combatSpur.def += 4;
			this.combatSpur.res += 4;
			boostText += this.name + " gets +4 in all stats from enemy HP < 100% or own HP < 100% with Beloved Zofia.<br>";
		}
		//Crimson Axe
		if(this.hasExactly("Crimson Axe") && this.rValue == 5 && (!this.initiator || enemy.combatStartHp / enemy.maxHp == 1)){
			this.combatSpur.atk += 5;
			this.combatSpur.def += 5;
			boostText += this.name + " gets +5 atk and def from enemy initiating or enemy HP = 100% with Crimson Axe.<br>";
		}
		if(this.hasExactly("Starpoint Lance")){
			if(this.toggle.weapon == 1 || this.rValue > 0){
				this.combatSpur.atk += 5;
				this.combatSpur.spd += 5;
				this.combatSpur.def += 5;
				this.combatSpur.res += 5;
				var slText = " from being in first combat";
				if(this.rValue > 0){
					slText = "";
				}
				boostText += this.name + " gets +5 in all stats" + slText + " with Starpoint Lance.<br>";
			}
			if(this.rValue == 5 && (this.initiator || this.buddy.adjacent > 0 || this.buddy.two > 0)){
				this.combatSpur.atk += 4;
				this.combatSpur.spd += 4;
				this.combatSpur.def += 4;
				this.combatSpur.res += 4;
				boostText += this.name + " gets +4 to all stats from initiating or being within 2 spaces of an ally with Starpoint Lance.<br>";
			}
		}
		//OM weapons
		if((this.has("Hidden Thorns") || this.has("Melon Float") || this.has("Conch Bouquet") || this.has("Blarrabbit") || this.has("Raudrrabbit") || this.has("Gronnrabbit")) && this.toggle.weapon == 1 && !galeused){
			this.combatSpur.atk += 5;
			this.combatSpur.res += 5;
			skillName = data.skills[this.weaponIndex].name;
			boostText += this.name + " gets +5 atk and res from being in first combat with " + skillName + ".<br>";
		}
		if(this.hasExactly("Sun's Percussors")){
			if(allStats[17] + this.getPhantom("Spd") > allStats[21] + enemy.getPhantom("Spd") || enemy.combatStartHp / enemy.maxHp == 1 || (this.rValue > 0 && (allStats[17] + this.getPhantom("Spd") >= allStats[21] + enemy.getPhantom("Spd") - 5 || enemy.combatStartHp / enemy.maxHp >= 0.75))){
				var spText = "from having more spd than enemy or enemy HP = 100%";
				this.combatSpur.atk += 5;
				this.combatSpur.spd += 5;
				if(this.rValue > 0){
					this.combatSpur.def += 4;
					this.combatSpur.res += 4;
					spText = "and +4 def & res from Spd >= enemy Spd -5 or enemy HP >= 75%";
				}
				boostText += this.name + " gets +5 atk & spd " + spText + " with Sun's Percussors.<br>";
			}
			if(this.rValue == 5 && (this.initiator || this.buddy.adjacent + this.buddy.two + this.buddy.three > 0)){
				var spVal = this.toggle.weapon * 2 + 4;
				this.combatSpur.atk += spVal;
				this.combatSpur.spd += spVal;
				this.combatSpur.def += spVal;
				this.combatSpur.res += spVal;
				boostText += this.name + " gets +" + spVal + " to all stats from initiating or being within 3 spaces of an ally with Sun's Percussors.<br>";
			}
		}
		if(this.hasExactly("Spear of Shadow") || this.hasExactly("Blade of Shadow")){
			if(!this.initiator || enemy.combatStartHp / enemy.maxHp == 1 || (this.rValue > 0 && enemy.combatStartHp / enemy.maxHp >= 0.75)){
				var ssText = "= 100%";
				if(this.rValue > 0){
					ssText = ">= 75%";
				}
				enemy.combatSpur.atk -= 5;
				enemy.combatSpur.spd -= 5;
				enemy.combatSpur.def -= 5;
				if(this.penalty.panic){
					this.combatBuffs = {"atk":0,"spd":0,"def":0,"res":0};
					this.buffs = {"atk":0,"spd":0,"def":0,"res":0};
				}
				this.combatDebuffs = {"atk":0,"spd":0,"def":0,"res":0};
				this.debuffs = {"atk":0,"spd":0,"def":0,"res":0};
				boostText += this.name + " neutralizes penalties and inflicts -5 atk/spd/def to " + enemy.name + " from enemy initiating or enemy HP " + ssText + " with " + data.skills[this.weaponIndex].name + ".<br>";
			}
			if(this.rValue == 5 && this.combatStartHp / this.maxHp >= 0.25){
				this.combatSpur.atk += 4;
				this.combatSpur.spd += 4;
				this.combatSpur.def += 4;
				this.combatSpur.res += 4;
				boostText += this.name + " gets +4 to all stats from HP >= 25% with " + data.skills[this.weaponIndex].name + ".<br>";
			}
		}
		//Refined Bright Naginata
		if(this.hasExactly("Bright Naginata") && this.toggle.weapon == 1 && this.rValue == 5){
			var buffVal = 5;
			skillName = data.skills[this.weaponIndex].name;
			this.combatSpur.atk += buffVal;
			this.combatSpur.def += buffVal;
			if(this.penalty.panic){
				this.combatBuffs = {"atk":0,"spd":0,"def":0,"res":0};
				this.buffs = {"atk":0,"spd":0,"def":0,"res":0};
			}
			this.combatDebuffs = {"atk":0,"spd":0,"def":0,"res":0};
			this.debuffs = {"atk":0,"spd":0,"def":0,"res":0};
			boostText += this.name + " neutralizes penalties and gets +5 atk and def from being within 2 spaces of an ally with " + skillName + ".<br>";
		}
		//Sneering Axe
		if(this.hasExactly("Sneering Axe")){
			var dAtk = Math.max(enemy.combatBuffs.atk,enemy.buffs.atk) * -2;
			var dSpd = Math.max(enemy.combatBuffs.spd,enemy.buffs.spd) * -2;
			var dDef = Math.max(enemy.combatBuffs.def,enemy.buffs.def) * -2;
			var dRes = Math.max(enemy.combatBuffs.res,enemy.buffs.res) * -2;
			if(enemy.penalty.panic){
				dAtk = 0;
				dSpd = 0;
				dDef = 0;
				dRes = 0;
			}
			enemy.combatSpur.atk += dAtk;
			enemy.combatSpur.spd += dSpd;
			enemy.combatSpur.def += dDef;
			enemy.combatSpur.res += dRes;
			boostText += this.name + " inflicts " + dAtk + "/" + dSpd + "/" + dDef + "/" + dRes + " in stats to " + enemy.name + " from enemy buffs with Sneering Axe.<br>";
			if(this.rValue == 5 && enemy.combatStartHp / enemy.maxHp >= 0.75){
				this.combatSpur.atk += 5;
				this.combatSpur.spd += 5;
				boostText += this.name + " gets +5 atk and spd from enemy HP >= 75% with Sneering Axe.<br>";
			}
		}
		//Setsuna's Yumi
		if(this.hasExactly("Setsuna's Yumi")){
			if(data.rangedWeapons.indexOf(enemy.weaponType) != -1){
				this.combatSpur.atk += 4;
				this.combatSpur.spd += 4;
				this.combatSpur.def += 4;
				this.combatSpur.res += 4;
				boostText += this.name + " gets +4 in all stats from enemy using a ranged weapon with Setsuna's Yumi.<br>";
			}
			if(this.rValue == 5 && this.toggle.weapon == 1){
				this.combatSpur.atk += 5;
				this.combatSpur.spd += 5;
				if(this.penalty.panic){
					this.combatBuffs.atk = 0;
					this.combatBuffs.spd = 0;
					this.buffs.atk = 0;
					this.buffs.spd = 0;
				}
				this.combatDebuffs.atk = 0;
				this.combatDebuffs.spd = 0;
				this.debuffs.atk = 0;
				this.debuffs.spd = 0;
				boostText += this.name + " gets +5 to atk & spd and neutralizes penalties to atk & spd from having a buff active with Setsuna's Yumi.<br>";
			}
		}
		if(this.hasExactly("Sky-Pirate Claw")){
			if(this.buddy.adjacent == 0 || (this.rValue > 0 && (this.transform == true || this.toggle.weapon == 1))){
				this.combatSpur.atk += 5;
				enemy.combatSpur.atk -= 5;
				var spText = "and inflicts -5 atk to " + enemy.name + " from not being adjacent to an ally";
				if(this.rValue > 0){
					this.combatSpur.spd += 5;
					spText = "& spd and inflicts -5 atk to " + enemy.name + " from # of adjacent human allies <= 1 or being transformed";
				}
				boostText += this.name + " gets +5 to atk " + spText + " with Sky-Pirate Claw.<br>";
			}
			if(this.rValue == 5 && this.combatStartHp / this.maxHp >= 0.25){
				this.combatSpur.atk += 5;
				this.combatSpur.spd += 5;
				this.combatSpur.def += 5;
				this.combatSpur.res += 5;
				boostText += this.name + " gets +5 to all stats from HP >= 25% with Sky-Pirate Claw.<br>";
			}
		}
		if(this.hasExactly("Gate-Anchor Axe")){
			if(this.buddy.adjacent == 0 || (this.rValue > 0 && (this.initiator || this.buddy.adjacent < 2))){
				var gaText = "not being adjacent to an ally";
				if(this.rValue > 0){
					gaText = "initiating or # of adjacent allies <= 1";
				}
				this.combatSpur.def += 5;
				this.combatSpur.res += 5;
				enemy.combatSpur.def -= 5;
				enemy.combatSpur.res -= 5;
				boostText += this.name + " gets +5 def/res and inflicts -5 def/res to " + enemy.name + " from " + gaText + " with Gate-Anchor Axe.<br>";
			}
			if(this.rValue == 5 && this.combatStartHp / this.maxHp >= 0.25){
				this.combatSpur.def += 5;
				this.combatSpur.res += 5;
				enemy.combatSpur.def -= 5;
				enemy.combatSpur.res -= 5;
				boostText += this.name + " gets +5 def/res and inflicts -5 def/res to " + enemy.name + " from HP >= 25% with Gate-Anchor Axe.<br>";
			}
		}
		if(this.hasExactly("Dark Spikes T")){
			if(enemy.combatStartHp / enemy.maxHp >= 0.75){
				this.combatSpur.atk += 6;
				this.combatSpur.spd += 6;
				boostText += this.name + " gets +6 atk and spd from enemy HP >= 75% with Dark Spikes T.<br>";
			}
			if(this.rValue == 5 && (this.initiator || this.toggle.weapon == 1)){
				this.combatSpur.atk += 6;
				this.combatSpur.spd += 6;
				boostText += this.name + " gets +6 atk and spd from initiating or being within 2 spaces of an ally with Dark Spikes T.<br>";
			}
		}
		if(this.hasExactly("Wind Parthia")){
			if(this.initiator || this.toggle.weapon == 1 || this.toggle.weapon == 3){
				this.combatSpur.atk += 5;
				this.combatSpur.spd += 5;
				this.combatSpur.def += 5;
				this.combatSpur.res += 5;
				boostText += this.name + " gets +5 to all stats from initiating or being within 2 spaces of an ally with Wind Parthia.<br>";
			}
			if(this.rValue == 5 && this.combatStartHp / this.maxHp >= 0.25){
				this.combatSpur.atk += 5;
				this.combatSpur.spd += 5;
				this.combatSpur.def += 5;
				this.combatSpur.res += 5;
				boostText += this.name + " gets +5 to all stats from HP >= 25% with Wind Parthia.<br>";
			}
		}
		if(this.hasExactly("Primordial Breath")){
			if(!this.initiator || enemy.combatStartHp / enemy.maxHp == 1 || (this.rValue > 0 && enemy.combatStartHp / enemy.maxHp >= 0.75)){
				this.combatSpur.atk += 5;
				this.combatSpur.spd += 5;
				this.combatSpur.def += 5;
				this.combatSpur.res += 5;
				var pbText = "= 100%";
				if(this.rValue > 0){
					pbText = ">= 75%";
				}
				boostText += this.name + " gets +5 in all stats from enemy initiating or enemy HP " + pbText + " with Primordial Breath.<br>";
			}
			if(this.rValue == 5 && this.combatStartHp / this.maxHp >= 0.25){
				this.combatSpur.atk += 4;
				this.combatSpur.spd += 4;
				this.combatSpur.def += 4;
				this.combatSpur.res += 4;
				boostText += this.name + " gets +4 to all stats from HP >= 25% with Primordial Breath.<br>";
			} 
		}
		//Refined Maltet
		if(this.hasExactly("Maltet") && !this.initiator && this.combatStartHp / this.maxHp >= 0.25 && this.rValue > 0){
			if(this.penalty.panic){
				this.combatBuffs = {"atk":0,"spd":0,"def":0,"res":0};
				this.buffs = {"atk":0,"spd":0,"def":0,"res":0};
			}
			this.combatDebuffs = {"atk":0,"spd":0,"def":0,"res":0};
			this.debuffs = {"atk":0,"spd":0,"def":0,"res":0};
			boostText += this.name + " neutralizes penalties from enemy initiating and HP >= 25% with Maltet.<br>";
		}
		if(this.hasExactly("Maltet") && (!this.initiator || enemy.combatStartHp / enemy.maxHp == 1) && this.rValue == 5){
			enemy.combatSpur.atk -= 6;
			enemy.combatSpur.def -= 6;
			boostText += this.name + " inflicts -6 atk/def to " + enemy.name + " from enemy initiating or enemy HP = 100% with Maltet.<br>";
		}
		//Refined Royal Sword
		if(this.hasExactly("Royal Sword") && this.rValue == 5 && this.combatStartHp / this.maxHp >= 0.25){
			this.combatSpur.atk += 5;
			this.combatSpur.spd += 5;
			this.combatSpur.def += 5;
			this.combatSpur.res += 5;
			boostText += this.name + " gets +5 in all stats from HP >= 25% with Royal Sword.<br>";
		}
		//Refined Garm
		if(this.hasExactly("Garm") && this.rValue == 5 && this.combatStartHp / this.maxHp >= 0.25){
			this.combatSpur.atk += 5;
			this.combatSpur.spd += 5;
			this.combatSpur.def += 5;
			this.combatSpur.res += 5;
			boostText += this.name + " gets +5 in all stats from HP >= 25% with Garm.<br>";
		}
		//Gilt Goblet
		if(this.hasExactly("Gilt Goblet") && (!this.initiator || enemy.combatStartHp / enemy.maxHp == 1)){
			this.combatSpur.atk += 6;
			this.combatSpur.res += 6;
			boostText += this.name + " gets +6 atk and res from enemy initiating or enemy HP = 100% with Gilt Goblet.<br>";
		}
		if(this.hasExactly("Double Bow")){
			if(this.buddy.adjacent == 0 || (this.rValue > 0 && this.buddy.adjacent < 2)){
				this.combatSpur.atk += 5;
				this.combatSpur.spd += 5;
				this.combatSpur.def += 5;
				this.combatSpur.res += 5;
				var dbText = "not being adjacent to an ally";
				if(this.rValue > 0){
					dbText = "# of adjacent allies <= 1";
				}
				boostText += this.name + " gets +5 to all stats from " + dbText + " with Double Bow.<br>";
			}
			if(this.rValue == 5 && this.combatStartHp / this.maxHp >= 0.25){
				this.combatSpur.atk += 4;
				this.combatSpur.spd += 4;
				this.combatSpur.def += 4;
				this.combatSpur.res += 4;
				var dbrVal = Math.max(8 - this.buddy.adjacent * 2, 0);
				enemy.combatSpur.atk -= dbrVal;
				enemy.combatSpur.spd -= dbrVal;
				enemy.combatSpur.def -= dbrVal;
				boostText += this.name + " gets +4 to all stats and inflicts -" + dbrVal + " atk/spd/def to " + enemy.name + " from HP >= 25% with Double Bow.<br>";
			}
		}
		//Spirited weapons
		if((this.has("Spirited Spear") || this.has("Spirited Axe") || this.has("Spirited Sword")) && (this.toggle.weapon == 1 || checkAllBuffs(this, enemy, currTurn))){
			this.combatSpur.atk += 4;
			this.combatSpur.def += 4;
			boostText += this.name + " gets +4 atk and def from having a bonus active with " + data.skills[this.weaponIndex].name + ".<br>";
		}
		if(this.hasExactly("Talregan Axe")){
			if(this.initiator || this.buddy.adjacent > 0 || this.buddy.two > 0){
				this.combatSpur.atk += 6;
				this.combatSpur.spd += 6;
				boostText += this.name + " gets +6 atk & spd from initiating or being within 2 spaces of an ally with Talregan Axe.<br>";
			}
			if(this.rValue == 5 && this.combatStartHp / this.maxHp >= 0.25){
				this.combatSpur.atk += 6;
				this.combatSpur.spd += 6;
				boostText += this.name + " gets +6 atk & spd from HP >= 25% with Talregan Axe.<br>";
			}
		}
		if(this.hasExactly("Frostfire Breath")){
			if(Object.values(this.bonus).reduce((a, item) => a + (item === true ? 1 : 0), 0) + this.bonus.extra > 0 || checkAllBuffs(this, enemy, currTurn)){
				var fbText = "";
				this.combatSpur.atk += 6;
				this.combatSpur.spd += 6;
				if(this.rValue > 0){
					this.combatSpur.def += 5;
					this.combatSpur.res += 5;
					fbText = " and +5 def & res";
				}
				boostText += this.name + " gets +6 atk & spd" + fbText + " from having a [Bonus] active with Frostfire Breath.<br>";
			}
			if(this.rValue == 5 && (this.initiator || this.buddy.adjacent > 0 || this.buddy.two > 0)){
				this.combatSpur.atk += 5;
				this.combatSpur.spd += 5;
				this.combatSpur.def += 5;
				this.combatSpur.res += 5;
				boostText += this.name + " gets +5 to all stats from initiating or being within 2 spaces of an ally with Frostfire Breath.<br>";
			}
		}
		if(this.hasExactly("Spear of Assal")){
			if(this.buddy.adjacent > 0 || this.buddy.two > 0 || (this.rValue > 0 && this.buddy.three > 0)){
				var saText = "atk & spd from being within 2";
				this.combatSpur.atk += 4;
				this.combatSpur.spd += 4;
				if(this.rValue > 0){
					this.combatSpur.def += 4;
					this.combatSpur.res += 4;
					saText = "all stats from being within 3";
				}
				boostText += this.name + " gets +4 to " + saText + " spaces of an ally with Spear of Assal.<br>";
			}
			if(this.rValue == 5 && this.buddy.adjacent + this.buddy.two + this.buddy.three > 0){
				this.combatSpur.atk += 4;
				this.combatSpur.spd += 4;
				this.combatSpur.def += 4;
				this.combatSpur.res += 4;
				boostText += this.name + " gets +4 to all stats from being within 3 spaces of an ally with Spear of Assal.<br>";
			}
		}
		if(this.hasExactly("Survivalist Bow")){
			if(this.buddy.adjacent == 0 || (this.rValue > 0 && (this.initiator || this.buddy.adjacent < 2))){
				this.combatSpur.atk += 6;
				this.combatSpur.spd += 6;
				var sbText = "not being adjacent to an ally";
				if(this.rValue > 0){
					sbText = "initiating or # of allies adjacent to unit <= 1";
				}
				boostText += this.name + " gets +6 atk & spd from " + sbText + " with Survivalist Bow.<br>";
			}
			if(this.rValue == 5 && this.combatStartHp / this.maxHp >= 0.25){
				this.combatSpur.atk += 6;
				this.combatSpur.spd += 6;
				if(this.penalty.panic){
					this.combatBuffs.atk = 0;
					this.combatBuffs.spd = 0;
					this.buffs.atk = 0;
					this.buffs.spd = 0;
				}
				this.combatDebuffs.atk = 0;
				this.combatDebuffs.spd = 0;
				this.debuffs.atk = 0;
				this.debuffs.spd = 0;
				boostText += this.name + " gets +6 to atk & spd and neutralizes penalties to atk & spd from HP >= 25% with Survivalist Bow.<br>";
			}
		}
		if(this.hasExactly("Dark Creator S")){
			if(this.toggle.weapon > 0 || this.rValue > 0){
				var dcVal = 0;
				var sMult = this.toggle.weapon % 10;
				if(this.rValue > 0){
					dcVal = sMult * 3 + 4;
					this.combatSpur.atk += dcVal;
					this.combatSpur.spd += dcVal;
					this.combatSpur.def += dcVal;
					this.combatSpur.res += dcVal;
					boostText += this.name + " gets +" + dcVal + " to all stats from having " + sMult + " allies with HP >= 75% with Dark Creator S.<br>";
				}
				else{
					dcVal = sMult * 2;
					this.combatSpur.atk += dcVal;
					this.combatSpur.def += dcVal;
					boostText += this.name + " gets +" + dcVal + " to atk & def from having " + sMult + " allies with HP >= 90% with Dark Creator S.<br>";
				}
			}
			if(this.rValue == 5 && this.combatStartHp / this.maxHp >= 0.25){
				this.combatSpur.atk += 4;
				this.combatSpur.spd += 4;
				this.combatSpur.def += 4;
				this.combatSpur.res += 4;
				boostText += this.name + " gets +4 to all stats from HP >= 25% with Dark Creator S.<br>";
			}
		}
		if(this.hasExactly("Areadbhar")){
			if(this.combatStartHp / this.maxHp >= 0.25){
				this.combatSpur.atk += 5;
				this.combatSpur.spd += 5;
				this.combatSpur.def += 5;
				this.combatSpur.res += 5;
				boostText += this.name + " gets +5 in all stats from HP >= 25% with Areadbhar.<br>";
			}
			if(this.rValue == 5 && (this.initiator || this.buddy.adjacent > 0 || this.buddy.two > 0)){
				this.combatSpur.atk += 4;
				this.combatSpur.spd += 4;
				this.combatSpur.def += 4;
				this.combatSpur.res += 4;
				boostText += this.name + " gets +4 in all stats from initiating or being within 2 spaces of an ally with Areadbhar.<br>";
			}
		}
		//Refined Thani
		if(this.hasExactly("Thani") && this.rValue == 5 && this.combatStartHp / this.maxHp >= 0.5){
			this.combatSpur.atk += 5;
			this.combatSpur.res += 5;
			boostText += this.name + " gets +5 atk and res from HP >= 50% with Thani.<br>";
		}
		//Refined Cursed Lance
		if(this.hasExactly("Cursed Lance") && this.rValue == 5 && (this.combatStartHp / this.maxHp < 1 || this.toggle.weapon == 1)){
			this.combatSpur.atk += 5;
			this.combatSpur.spd += 5;
			this.combatSpur.def += 5;
			boostText += this.name + " gets +5 atk/spd/def from HP < 100% or enemy having Penalty with Cursed Lance.<br>";
		}
		if(this.hasExactly("Tiger-Roar Axe")){
			if(this.initiator || this.buddy.adjacent > 0 || this.buddy.two > 0){
				this.combatSpur.atk += 5;
				this.combatSpur.spd += 5;
				this.combatSpur.def += 5;
				this.combatSpur.res += 5;
				boostText += this.name + " gets +5 in all stats from initiating or being within 2 spaces of an ally with Tiger-Roar Axe.<br>";
			}
			if(this.rValue == 5 && (!this.initiator || enemy.combatStartHp / enemy.maxHp >= 0.75)){
				var trVal = Math.min(this.buddy.erorc * 2 + 4, 10);
				this.combatSpur.atk += trVal;
				this.combatSpur.spd += trVal;
				this.combatSpur.def += trVal;
				this.combatSpur.res += trVal;
				boostText += this.name + " gets +" + trVal + " in all stats from enemy initiating or enemy HP >= 75% with Tiger-Roar Axe.<br>";
			}
		}
		if(this.hasExactly("Aureola")){
			if(this.initiator || this.buddy.adjacent > 0 || this.buddy.two > 0){
				var auText = "atk/spd/res";
				this.combatSpur.atk += 5;
				this.combatSpur.spd += 5;
				if(this.rValue > 0){
					this.combatSpur.def += 5;
					auText = "in all stats";
				}
				this.combatSpur.res += 5;
				boostText += this.name + " gets +5 " + auText + " from initiating or being within 2 spaces of an ally with Aureola.<br>";
			}
			if(this.rValue == 5 && (!this.initiator || enemy.combatStartHp / enemy.maxHp >= 0.75)){
				this.combatSpur.atk += 5;
				this.combatSpur.spd += 5;
				this.combatSpur.def += 5;
				this.combatSpur.res += 5;
				boostText += this.name + " gets +5 in all stats from enemy initiating or enemy HP >= 75% with Aureola.<br>";
			}
		}
		//Binding Necklace and Necklace+
		if((this.has("Binding Necklace") && this.toggle.b == 1) || (this.hasExactly("Binding Necklace+") && !this.initiator)){
			var sVal = 2;
			var cText = "not being adjacent to an ally";
			if(this.hasExactly("Binding Necklace+")){
				sVal = 3;
				cText = "enemy initiating or # of allies adjacent <= 1";
			}
			this.combatSpur.atk += sVal;
			this.combatSpur.spd += sVal;
			this.combatSpur.def += sVal;
			this.combatSpur.res += sVal;
			enemy.combatSpur.atk -= sVal;
			enemy.combatSpur.spd -= sVal;
			enemy.combatSpur.def -= sVal;
			enemy.combatSpur.res -= sVal;
			boostText += this.name + " gets +" + sVal + " to all stats and inflicts -" + sVal + " to all stats to " + enemy.name + " from " + cText + " with " + data.skills[this.bIndex].name + ".<br>";
			if(checkAllBuffs(enemy, this, currTurn) && allStats[9]){
				var extraStats = [0,0,0,0];
				var buffText = "";
				var debuffText = "";
				if(!allStats[15][0]){
					extraStats[0] = Math.max(enemy.buffs.atk,enemy.combatBuffs.atk);
					if(extraStats[0] > 0){
						this.combatSpur.atk += extraStats[0];
						enemy.combatSpur.atk -= extraStats[0];
						buffText += " +" + extraStats[0] + " atk";
						debuffText += " -" + extraStats[0] + " atk";
					}
				}
				if(!allStats[15][1]){
					extraStats[1] = Math.max(enemy.buffs.spd,enemy.combatBuffs.spd);
					if(extraStats[1] > 0){
						this.combatSpur.spd += extraStats[1];
						enemy.combatSpur.spd -= extraStats[1];
						buffText += " +" + extraStats[1] + " spd";
						debuffText += " -" + extraStats[1] + " spd";
					}
				}
				if(!allStats[15][2]){
					extraStats[2] = Math.max(enemy.buffs.def,enemy.combatBuffs.def);
					if(extraStats[2] > 0){
						this.combatSpur.def += extraStats[2];
						enemy.combatSpur.def -= extraStats[2];
						buffText += " +" + extraStats[2] + " def";
						debuffText += " -" + extraStats[2] + " def";
					}
				}
				if(!allStats[15][3]){
					extraStats[3] = Math.max(enemy.buffs.res,enemy.combatBuffs.res);
					if(extraStats[3] > 0){
						this.combatSpur.res += extraStats[3];
						enemy.combatSpur.res -= extraStats[3];
						buffText += " +" + extraStats[3] + " res";
						debuffText += " -" + extraStats[3] + " res";
					}
				}
				boostText += this.name + " gets" + buffText + " and inflicts" + debuffText + " to " + enemy.name + " from " + cText + " and enemy having buffs with " + data.skills[this.bIndex].name + ".<br>";
			}
		}
		if(this.hasExactly("Tome of Storms")){
			if(enemy.combatStartHp / enemy.maxHp >= 0.75 || (this.rValue > 0 && this.initiator)){
				var tsVal = 5;
				var tsText = "5 atk & spd from enemy HP >= 75%";
				if(this.rValue > 0){
					tsVal = Math.floor(allStats[17] * 0.15) + 6;
					tsText = tsVal + " atk & spd from initiating or enemy HP >= 75%";
				}
				this.combatSpur.atk += tsVal;
				this.combatSpur.spd += tsVal;
				boostText += this.name + " gets +" + tsText + " with Tome of Storms.<br>";
			}
			if(this.rValue == 5 && this.combatStartHp / this.maxHp >= 0.25){
				this.combatSpur.atk += 6;
				this.combatSpur.spd += 6;
				boostText += this.name + " gets +6 to atk & spd from HP >= 25% with Tome of Storms.<br>";
			}
		}
		//Tome of Favors
		if(this.hasExactly("Tome of Favors") && enemy.weaponType != "beast"){
			this.combatSpur.atk += 5;
			this.combatSpur.res += 5;
			boostText += this.name + " gets +5 atk and res from enemy not using beast damage with Tome of Favors.<br>";
		}
		if(this.hasExactly("Tome of Favors") && this.rValue == 5 && this.toggle.weapon == 1){
			this.combatSpur.atk += 5;
			this.combatSpur.res += 5;
			boostText += this.name + " gets +5 atk and res from being within 3 spaces of a Heron with Tome of Favors.<br>";
		}
		//Refined Purifying Breath
		if(this.hasExactly("Purifying Breath") && this.rValue == 5 && this.combatStartHp / this.maxHp >= 0.5){
			this.combatSpur.atk += 4;
			this.combatSpur.spd += 4;
			this.combatSpur.def += 4;
			this.combatSpur.res += 4;
			if(this.penalty.panic){
				this.combatBuffs = {"atk":0,"spd":0,"def":0,"res":0};
				this.buffs = {"atk":0,"spd":0,"def":0,"res":0};
			}
			this.combatDebuffs = {"atk":0,"spd":0,"def":0,"res":0};
			this.debuffs = {"atk":0,"spd":0,"def":0,"res":0};
			boostText += this.name + " gets +4 in all stats and neutralizes penalties from HP >= 50% with Purifying Breath.<br>";
		}
		//Hrist
		if(this.hasExactly("Hrist") && this.combatStartHp / this.maxHp < 1){
			this.combatSpur.atk += 6;
			this.combatSpur.spd += 6;
			boostText += this.name + " gets +6 atk and spd from HP < 100% with Hrist.<br>";
		}
		//Candy Cane & Reindeer Bow
		if((this.has("Candy Cane") || this.has("Reindeer Bow")) && this.toggle.weapon == 1){
			this.combatSpur.atk += 5;
			this.combatSpur.def += 5;
			boostText += this.name + " gets +5 atk and def from being within 2 spaces of an ally with " + data.skills[this.weaponIndex].name + ".<br>";
		}
		if(this.hasExactly("Studied Forblaze")){
			if(this.combatStartHp / this.maxHp >= 0.25){
				this.combatSpur.atk += 6;
				this.combatSpur.res += 6;
				boostText += this.name + " gets +6 atk and res from HP >= 25% with Studied Forblaze.<br>";
			}
			if(this.rValue == 5 && (this.initiator || this.buddy.adjacent > 0 || this.buddy.two > 0)){
				this.combatSpur.atk += 5;
				this.combatSpur.res += 5;
				boostText += this.name + " gets +5 atk and res from initiating or being within 2 spaces of an ally with Studied Forblaze.<br>";
			}
		}
		//Refreshed Fang
		if(this.hasExactly("Refreshed Fang") && enemy.combatStartHp / enemy.maxHp >= 0.75){
			this.combatSpur.spd += 5;
			enemy.combatSpur.spd -= 5;
			boostText += this.name + " gets +5 spd and inflicts -5 spd to " + enemy.name + " from enemy HP >= 75% with Refreshed Fang.<br>";
		}
		if(this.hasExactly("Resolved Fang")){
			if(enemy.combatStartHp / enemy.maxHp >= 0.75 || (this.rValue > 0 && !this.initiator)){
				var rfText = " gets +5 def and inflicts -5 def to " + enemy.name + " from enemy HP >= 75%";
				if(this.rValue > 0){
					this.combatSpur.spd += 5;
					this.combatSpur.res += 5;
					if(this.penalty.panic){
						this.combatBuffs.atk = 0;
						this.combatBuffs.def = 0;
						this.buffs.atk = 0;
						this.buffs.def = 0;
					}
					this.combatDebuffs.atk = 0;
					this.combatDebuffs.def = 0;
					this.debuffs.atk = 0;
					this.debuffs.def = 0;
					rfText = " gets +5 spd/def/res, inflicts -5 def to " + enemy.name + ", and neutralizes penalties to atk & def from enemy initiating or enemy HP >= 75%";
				}
				this.combatSpur.def += 5;
				enemy.combatSpur.def -= 5;
				boostText += this.name + rfText + " with Resolved Fang.<br>";
			}
			if(this.rValue == 5 && this.buddy.adjacent + this.buddy.two + this.buddy.three > 0){
				this.combatSpur.spd += 5;
				this.combatSpur.def += 5;
				this.combatSpur.res += 5;
				enemy.combatSpur.def -= 5;
				boostText += this.name + " gets +5 spd/def/res and inflicts -5 def to " + enemy.name + " from being within 3 spaces of an ally with Resolved Fang.<br>";
			}
		}
		if(this.hasExactly("Grafcalibur")){
			if(this.initiator || this.buddy.adjacent > 0 || this.buddy.two > 0){
				this.combatSpur.atk += 5;
				this.combatSpur.spd += 5;
				this.combatSpur.def += 5;
				this.combatSpur.res += 5;
				boostText += this.name + " gets +5 to all stats from initiating or being within 2 spaces of an ally with Grafcalibur.<br>";
			}
			if(this.rValue == 5 && this.combatStartHp / this.maxHp >= 0.25){
				var gcVal = Math.floor(allStats[17] * 0.1) + 5;
				this.combatSpur.atk += gcVal;
				this.combatSpur.spd += gcVal;
				this.combatSpur.def += gcVal;
				this.combatSpur.res += gcVal;
				boostText += this.name + " gets +" + gcVal + " to all stats from HP >= 25% with Grafcalibur.<br>";
			}
		}
		if(this.hasExactly("Indignant Bow")){
			if((enemy.initiator || enemy.combatStartHp / enemy.maxHp == 1) || (this.rValue > 0 && enemy.combatStartHp / enemy.maxHp >= 0.75)){
				this.combatSpur.atk += 6;
				if(this.rValue > 0){
					this.combatSpur.spd += 5;
					this.combatSpur.def += 6;
					this.combatSpur.res += 6;
					if(this.penalty.panic){
						this.combatBuffs.atk = 0;
						this.combatBuffs.spd = 0;
						this.combatBuffs.res = 0;
						this.buffs.atk = 0;
						this.buffs.spd = 0;
						this.buffs.res = 0;
					}
					this.combatDebuffs.atk = 0;
					this.combatDebuffs.spd = 0;
					this.combatDebuffs.res = 0;
					this.debuffs.atk = 0;
					this.debuffs.spd = 0;
					this.debuffs.res = 0;
					boostText += this.name + " gets +6 atk/def/res & +5 spd and neutralizes penalties on atk/spd/res from enemy initiating or enemy HP >= 75% with Indignant Bow.<br>";
				}
				else{
					enemy.combatSpur.atk -= 6;
					if(this.penalty.panic){
						this.combatBuffs.atk = 0;
						this.buffs.atk = 0;
					}
					this.combatDebuffs.atk = 0;
					this.debuffs.atk = 0;
					boostText += this.name + " gets +6 atk and inflicts -6 atk to " + enemy.name + " and neutralizes penalties on atk from enemy initiating or enemy HP = 100% with Indignant Bow.<br>";
				}
			}
			if(this.rValue == 5 && this.buddy.adjacent + this.buddy.two + this.buddy.three > 0){
				this.combatSpur.atk += 5;
				this.combatSpur.spd += 5;
				this.combatSpur.def += 5;
				this.combatSpur.res += 5;
				boostText += this.name + " gets +5 to all stats from being within 3 spaces of an ally with Indignant Bow.<br>";
			}
		}
		//Arden's Blade
		if(this.hasExactly("Arden's Blade") && this.rValue == 5 && this.combatStartHp / this.maxHp >= 0.5){
			this.combatSpur.atk += 4;
			this.combatSpur.def += 6;
			boostText += this.name + " gets +4 atk/+6 def from HP >= 50% with Arden's Blade.<br>";
		}
		//Springtime Staff
		if(this.hasExactly("Springtime Staff") && this.rValue == 5 && (this.initiator || this.toggle.weapon == 1)){
			this.combatSpur.atk += 5;
			this.combatSpur.res += 5;
			boostText += this.name + " gets +5 atk and res from initiating or being within 2 spaces of an ally with Springtime Staff.<br>";
		}
		//Warrior Princess
		if(this.hasExactly("Warrior Princess") && this.rValue > 0 && this.toggle.weapon == 1){
			this.combatSpur.atk += 4;
			this.combatSpur.spd += 4;
			boostText += this.name + " gets +4 atk and spd from being within 2 spaces of an ally with Warrior Princess.<br>";
		}
		//Forseti
		if(this.hasExactly("Forseti") && this.initiator && this.hp/this.maxHp >= .25 && this.rValue > 0){
			this.combatSpur.atk += 4;
			this.combatSpur.spd += 4;
			boostText += this.name + " gets +4 atk and spd from HP >= 25% and initiating with Forseti.<br>";
		}
		if(this.hasExactly("Forseti") && enemy.combatStartHp / enemy.maxHp >= 0.75 && this.rValue == 5){
			this.combatSpur.atk += 4;
			this.combatSpur.spd += 4;
			if(this.penalty.panic){
				this.combatBuffs.atk = 0;
				this.combatBuffs.spd = 0;
				this.buffs.atk = 0;
				this.buffs.spd = 0;
			}
			this.combatDebuffs.atk = 0;
			this.combatDebuffs.spd = 0;
			this.debuffs.atk = 0;
			this.debuffs.spd = 0;
			boostText += this.name + " gets +4 atk and spd and neutralizes penalties to atk/spd from enemy HP >= 75% with Forseti.<br>";
		}
		//Refined Meisterschwert
		if(this.hasExactly("Meisterschwert") && this.rValue == 5 && enemy.combatStartHp / enemy.maxHp >= 0.5){
			this.combatSpur.atk += 5;
			enemy.combatSpur.atk -= 5;
			boostText += this.name + " gets +5 atk and inflicts -5 atk to " + enemy.name + " from enemy HP >= 50% with Meisterschwert.<br>";
		}
		//Refined Audhulma
		if(this.hasExactly("Audhulma") && this.rValue == 5 && (enemy.initiator || enemy.combatStartHp / enemy.maxHp == 1)){
			this.combatSpur.atk += 4;
			this.combatSpur.spd += 4;
			this.combatSpur.def += 4;
			this.combatSpur.res += 4;
			boostText += this.name + " gets +4 in all stats from enemy initiating or enemy HP = 100% with Audhulma.<br>";
		}
		//Refined Giga Excalibur
		if(this.hasExactly("Giga Excalibur") && this.rValue == 5 && this.toggle.weapon == 1){
			this.combatSpur.atk += 4;
			this.combatSpur.spd += 4;
			boostText += this.name + " gets +4 atk and spd from being within 2 spaces of an ally with Giga Excalibur.<br>";
		}
		//Refined Spy-Song Bow
		if(this.hasExactly("Spy-Song Bow") && this.rValue == 5 && this.toggle.weapon == 1){
			this.combatSpur.atk += 6;
			this.combatSpur.spd += 6;
			this.combatSpur.def += 6;
			this.combatSpur.res += 6;
			boostText += this.name + " gets +6 in all stats from peeping on ally pair with Spy-Song Bow.<br>";
		}
		//Thjalfi
		if(this.hasExactly("Thjalfi") && this.toggle.weapon == 1){
			this.combatSpur.atk += 6;
			this.combatSpur.spd += 6;
			this.combatSpur.def += 6;
			this.combatSpur.res += 6;
			boostText += this.name + " gets +6 in all stats from being within 3 spaces of an ally with Thjalfi.<br>";
		}
		if(this.hasExactly("Silesse Frost")){
			if(enemy.combatStartHp / enemy.maxHp >= 0.5 || (this.rValue > 0 && this.initiator)){
				var sfText = "from enemy HP >= 50%";
				this.combatSpur.atk += 6;
				this.combatSpur.spd += 6;
				if(this.rValue > 0){
					this.combatSpur.def += 5;
					this.combatSpur.res += 5;
					sfText = "and +5 to def & res from initiating or enemy HP >= 50%";
				}
				boostText += this.name + " gets +6 to atk & spd " + sfText + " with Silesse Frost.<br>";
			}
			if(this.rValue == 5 && this.buddy.adjacent + this.buddy.two + this.buddy.three > 0){
				var sfVal = Math.floor(allStats[17] * 0.1) + 5;
				this.combatSpur.atk += sfVal;
				this.combatSpur.spd += sfVal;
				this.combatSpur.def += sfVal;
				this.combatSpur.res += sfVal;
				boostText += this.name + " gets +" + sfVal + " to all stats from being within 3 spaces of an ally with Silesse Frost.<br>";
			}
		}
		if(this.hasExactly("Failnaught")){
			if(this.combatStartHp / this.maxHp >= 0.25){
				this.combatSpur.atk += 5;
				this.combatSpur.spd += 5;
				this.combatSpur.def += 5;
				this.combatSpur.res += 5;
				boostText += this.name + " gets +5 in all stats from HP >= 25% with Failnaught.<br>";
			}
			if(this.rValue == 5){
				enemy.combatSpur.spd -= 5;
				enemy.combatSpur.def -= 5;
				boostText += this.name + " inflicts -5 spd & def to " + enemy.name + " with Failnaught.<br>";
				if(this.combatStartHp / this.maxHp >= 0.25){
					this.combatSpur.atk += 4;
					this.combatSpur.spd += 4;
					this.combatSpur.def += 4;
					this.combatSpur.res += 4;
					boostText += this.name + " gets +4 in all stats from HP >= 25% with Failnaught.<br>";
				}
			}
		}
		//Refined Ayra's Blade
		if(this.hasExactly("Ayra's Blade") && this.rValue == 5 && enemy.combatStartHp / enemy.maxHp >= 0.75){
			this.combatSpur.atk += 4;
			this.combatSpur.spd += 4;
			this.combatSpur.def += 4;
			this.combatSpur.res += 4;
			boostText += this.name + " gets +4 in all stats from enemy HP >= 75% with Ayra's Blade.<br>";
		}
		//Refined Grimoire
		if(this.hasExactly("Grimoire") && this.rValue > 0 && this.toggle.weapon == 1){
			this.combatSpur.atk += 4;
			this.combatSpur.spd += 4;
			boostText += this.name + " gets +4 atk and spd from being within 2 spaces of an ally with Grimoire.<br>";
		}
		//Mjolnir
		if(this.hasExactly("Mjolnir")){
			if(this.rValue < 0 && this.initiator){
				this.combatSpur.spd += 6;
				boostText += this.name + " gets +6 spd from initiating with Mjolnir.<br>";
			}
			else if(this.rValue > 0 && (this.initiator || this.toggle.weapon == 1)){
				this.combatSpur.spd += 6;
				boostText += this.name + " gets +6 spd from initiating or not being adjacent to an ally with Mjolnir.<br>";
				if(this.rValue == 5){
					this.combatSpur.atk += 5;
					this.combatSpur.spd += 5;
					boostText += this.name + " gets +5 atk and spd from initiating or not being adjacent to an ally with Mjolnir.<br>";
				}
			}
		}
		//Ivaldi
		if(this.hasExactly("Ivaldi")){
			if(this.rValue < 0 && enemy.combatStartHp / enemy.maxHp >= 1){
				this.combatSpur.atk += 3;
				this.combatSpur.spd += 3;
				boostText += this.name + " gets +3 atk and spd from enemy HP = 100% with Ivaldi.<br>";
			}
			else if(this.rValue > 0 && enemy.combatStartHp / enemy.maxHp >= 0.75){
				this.combatSpur.atk += 3;
				this.combatSpur.spd += 3;
				this.combatSpur.res += 3;
				boostText += this.name + " gets +3 atk/spd/res from enemy HP >= 75% with Ivaldi.<br>";
				if(this.rValue == 5){
					enemy.combatSpur.atk -= 5;
					enemy.combatSpur.res -= 5;
					boostText += this.name + " inflicts -5 atk and res on " + enemy.name + " from enemy HP >= 75% with Ivaldi.<br>";
				}
			}
		}
		if(this.hasExactly("Luin")){
			if(this.initiator || this.buddy.adjacent > 0 || this.buddy.two > 0){
				this.combatSpur.spd += 6;
				var luText = "";
				if(this.rValue > 0){
					this.combatSpur.atk += 6;
					luText = " atk &";
				}
				boostText += this.name + " gets +6" + luText + " spd from initiating or being within 2 spaces of an ally with Luin.<br>";
			}
			if(this.rValue == 5){
				var luText = " inflicts -5 spd & def to " + enemy.name;
				enemy.combatSpur.spd -= 5;
				enemy.combatSpur.def -= 5;
				if(this.combatStartHp / this.maxHp >= 0.25){
					this.combatSpur.atk += 6;
					this.combatSpur.spd += 6;
					luText = " gets +6 atk & spd and inflicts -5 spd & def to " + enemy.name + " from HP >= 25%";
				}
				boostText += this.name + luText + " with Luin.<br>";
			}
		}
		//Gullinkambi Egg
		if(this.hasExactly("Gullinkambi Egg") && enemy.combatStartHp / enemy.maxHp >= 0.75){
			this.combatSpur.atk += 6;
			this.combatSpur.spd += 6;
			boostText += this.name + " gets +6 atk and spd from enemy HP >= 75% with Gullinkambi Egg.<br>";
		}
		//Willful Rabbits weapons
		if((this.has("Springy Bow") || this.has("Springy Lance") || this.has("Springy Axe") || this.has("Up-Front Blade") || this.has("Up-Front Lance") || this.has("Up-Front Axe")) && enemy.combatStartHp / enemy.maxHp >= 0.75){
			var skillName = data.skills[this.weaponIndex].name;
			this.combatSpur.atk += 5;
			this.combatSpur.spd += 5;
			if(this.penalty.panic){
				this.combatBuffs.atk = 0;
				this.combatBuffs.spd = 0;
				this.buffs.atk = 0;
				this.buffs.spd = 0;
			}
			this.combatDebuffs.atk = 0;
			this.combatDebuffs.spd = 0;
			this.debuffs.atk = 0;
			this.debuffs.spd = 0;
			boostText += this.name + " gets +5 atk/spd and neutralizes penalties to atk/spd from enemy HP >= 75% with " + skillName + ".<br>";
		}
		//Lilac-Jade Breath
		if(this.hasExactly("Lilac-Jade Breath") && (!this.initiator || enemy.combatStartHp / enemy.maxHp >= 1)){
			this.combatSpur.atk += 5;
			this.combatSpur.spd += 5;
			this.combatSpur.def += 5;
			this.combatSpur.res += 5;
			boostText += this.name + " gets +5 to all stats from enemy initiating or enemy HP = 100% with Lilac-Jade Breath.<br>";
		}
		if(this.hasExactly("Skinfaxi")){
			if(this.combatStartHp / this.maxHp >= 0.25){
				this.combatSpur.atk += 5;
				this.combatSpur.spd += 5;
				this.combatSpur.def += 5;
				this.combatSpur.res += 5;
				boostText += this.name + " gets +5 to all stats from  HP >= 25% with Skinfaxi.<br>";
				var dAtk = Math.min(this.combatDebuffs.atk,this.debuffs.atk) * -2;
				var dSpd = Math.min(this.combatDebuffs.spd,this.debuffs.spd) * -2;
				var dDef = Math.min(this.combatDebuffs.def,this.debuffs.def) * -2;
				var dRes = Math.min(this.combatDebuffs.res,this.debuffs.res) * -2;
				if(this.penalty.panic){
					dAtk += Math.max(this.combatBuffs.atk,this.buffs.atk) * 2;
					dSpd += Math.max(this.combatBuffs.spd,this.buffs.spd) * 2;
					dDef += Math.max(this.combatBuffs.def,this.buffs.def) * 2;
					dRes += Math.max(this.combatBuffs.res,this.buffs.res) * 2;
				}
				this.combatSpur.atk += dAtk;
				this.combatSpur.spd += dSpd;
				this.combatSpur.def += dDef;
				this.combatSpur.res += dRes;
				boostText += this.name + " gets + " + dAtk + "/" + dSpd + "/" + dDef + "/" + dRes + " additional stats from having penalty active and HP >= 25% with Skinfaxi.<br>";
			}
			if(this.rValue == 5 && (this.initiator || this.buddy.adjacent > 0 || this.buddy.two > 0)){
				var dStats = [-4,-4,-4];
				if(!enemy.penalty.panic){
					dStats[0] += Math.max(enemy.combatBuffs.atk,enemy.buffs.atk) * -2;
					dStats[1] += Math.max(enemy.combatBuffs.spd,enemy.buffs.spd) * -2;
					dStats[2] += Math.max(enemy.combatBuffs.def,enemy.buffs.def) * -2;
				}
				enemy.combatSpur.atk += dStats[0];
				enemy.combatSpur.spd += dStats[1];
				enemy.combatSpur.def += dStats[2];
				boostText += this.name + " inflicts " +  dStats[0] + " atk/" +  dStats[1] + " spd/" +  dStats[2] + " def to " + enemy.name + " from initiating or being within 2 spaces of an ally with Skinfaxi.<br>";
			}
		}
		//Refined Grima's Truth/Blizzard
		if((this.hasExactly("Grima's Truth") || this.hasExactly("Blizzard")) && this.rValue == 5 && this.combatStartHp / this.maxHp >= 0.25){
			var eNegate = this.checkNegate(enemy, currTurn);
			var dAtk = -4;
			var dSpd = -4;
			var dDef = -4;
			var dRes = -4;
			
			if(eNegate[0] == false){
				dAtk += Math.min(enemy.combatDebuffs.atk,enemy.debuffs.atk);
				if(enemy.penalty.panic){
					dAtk -= Math.max(enemy.combatBuffs.atk,enemy.buffs.atk);
				}
			}
			if(eNegate[1] == false){
				dSpd += Math.min(enemy.combatDebuffs.spd,enemy.debuffs.spd);
				if(enemy.penalty.panic){
					dSpd -= Math.max(enemy.combatBuffs.spd,enemy.buffs.spd);
				}
			}
			if(eNegate[2] == false){
				dDef += Math.min(enemy.combatDebuffs.def,enemy.debuffs.def);
				if(enemy.penalty.panic){
					dDef -= Math.max(enemy.combatBuffs.def,enemy.buffs.def);
				}
			}
			if(eNegate[3] == false){
				dRes += Math.min(enemy.combatDebuffs.res,enemy.debuffs.res);
				if(enemy.penalty.panic){
					dRes -= Math.max(enemy.combatBuffs.res,enemy.buffs.res);
				}
			}
			
			enemy.combatSpur.atk += dAtk;
			enemy.combatSpur.spd += dSpd;
			enemy.combatSpur.def += dDef;
			enemy.combatSpur.res += dRes;
			boostText += this.name + " inflicts " + dAtk + " atk/" + dSpd + " spd/" + dDef + " def/" + dRes + " res on " + enemy.name + " from HP >= 25% with " + data.skills[this.weaponIndex].name + ".<br>";
		}
		//Refined Shamshir
		if(this.hasExactly("Shamshir") && this.rValue == 5 && (this.initiator || this.toggle.weapon == 1)){
			this.combatSpur.atk += 5;
			this.combatSpur.spd += 5;
			boostText += this.name + " gets +5 to atk and spd from initiating or being within 2 spaces of an ally with Shamshir.<br>";
		}
		//Flower Lance
		if(this.hasExactly("Flower Lance") && enemy.combatStartHp / enemy.maxHp >= 0.75){
			this.combatSpur.atk += 4;
			this.combatSpur.spd += 4;
			this.combatSpur.def += 4;
			this.combatSpur.res += 4;
			boostText += this.name + " gets +4 to all stats from enemy HP >= 75% with Flower Lance.<br>";
		}
		//Refined Flower Lance
		if(this.hasExactly("Flower Lance") && this.rValue == 5 && (this.initiator || this.toggle.weapon == 1)){
			this.combatSpur.atk += 5;
			this.combatSpur.spd += 5;
			boostText += this.name + " gets +5 to atk and spd from initiating or being within 2 spaces of an ally with Flower Lance.<br>";
		}
		//Hotshot Lance
		if(this.hasExactly("Hotshot Lance") && this.combatStartHp / this.maxHp >= 0.25){
			var buffVal = 4;
			if(this.dragonflower == 3){
				buffVal += 1;
			}
			else if(this.dragonflower == 4){
				buffVal += 2;
			}
			else if(this.dragonflower > 4){
				buffVal += 3;
			}
			this.combatSpur.atk += buffVal;
			this.combatSpur.spd += buffVal;
			this.combatSpur.def += buffVal;
			this.combatSpur.res += buffVal;
			boostText += this.name + " gets +" + buffVal + " to all stats from HP >= 25% with Hotshot Lance.<br>";
		}
		//Tome of Reglay
		if(this.hasExactly("Tome of Reglay") && enemy.combatStartHp / enemy.maxHp >= 0.75){
			this.combatSpur.atk += 6;
			this.combatSpur.spd += 6;
			boostText += this.name + " gets +6 to atk and spd from enemy HP >= 75% with Tome of Reglay.<br>";
		}
		//Lance of Frelia
		if(this.hasExactly("Lance of Frelia") && this.combatStartHp / this.maxHp >= 0.25){
			this.combatSpur.atk += 6;
			this.combatSpur.spd += 6;
			boostText += this.name + " gets +6 to atk and spd from HP >= 25% with Lance of Frelia.<br>";
			if(this.initiator){
				this.combatSpur.def += 10;
				this.combatSpur.res += 10;
				boostText += this.name + " gets +10 to def and res from HP >= 25% and initiating with Lance of Frelia.<br>";
			}
		}
		//Blade of Renais
		if(this.hasExactly("Blade of Renais") && (this.initiator || this.toggle.weapon > 1)){
			var buffVal = 5;
			this.combatSpur.atk += buffVal;
			this.combatSpur.spd += buffVal;
			this.combatSpur.def += buffVal;
			this.combatSpur.res += buffVal;
			boostText += this.name + " gets +" + buffVal + " to all stats from initiating or being within 2 spaces of an ally with Blade of Renais.<br>";			
		}
		if(this.hasExactly("Lioness Blade") && this.combatStartHp / this.maxHp >= 0.25){
			this.combatSpur.atk += 6;
			this.combatSpur.spd += 6;
			boostText += this.name + " gets +6 to atk & spd from HP >= 25% with " + data.skills[this.weaponIndex].name + ".<br>";
		}
		if(this.hasExactly("Bow of Frelia")){
			if(this.combatStartHp / this.maxHp >= 0.25){
				var bfText = "";
				this.combatSpur.atk += 6;
				this.combatSpur.spd += 6;
				if(this.rValue > 0){
					this.combatSpur.def += 5;
					this.combatSpur.res += 5;
					bfText = " and +5 to def & res";
				}
				boostText += this.name + " gets +6 to atk & spd" + bfText + " from HP >= 25% with Bow of Frelia.<br>";
			}
			if(this.rValue == 5 && (this.initiator || this.buddy.adjacent > 0 || this.buddy.two > 0)){
				this.combatSpur.atk += 5;
				this.combatSpur.spd += 5;
				this.combatSpur.def += 5;
				this.combatSpur.res += 5;
				boostText += this.name + " gets +5 to all stats from initiating or being within 2 spaces of an ally with Bow of Frelia.<br>";
			}
		}
		if(this.hasExactly("Hallowed Tyrfing")){
			if(enemy.combatStartHp / enemy.maxHp >= 0.75 || (this.rValue > 0 && this.initiator)){
				var htText = "";
				if(this.rValue > 0){
					htText = " or initiating";
				}
				this.combatSpur.atk += 5;
				this.combatSpur.spd += 5;
				this.combatSpur.def += 5;
				this.combatSpur.res += 5;
				boostText += this.name + " gets +5 to all stats from enemy HP >= 75%" + htText + " with Hallowed Tyrfing.<br>";
			}
			if(this.rValue == 5 && this.combatStartHp / this.maxHp >= 0.25){
				htVar = 4 + Math.min(this.buddy.spaces, 4);
				this.combatSpur.atk += htVar;
				this.combatSpur.spd += htVar;
				this.combatSpur.def += htVar;
				this.combatSpur.res += htVar;
				boostText += this.name + " gets +" + htVar + " to all stats from HP >= 25% with Hallowed Tyrfing.<br>";
			}
		}
		//Refined Alondite/Ragnell
		if((this.hasExactly("Alondite") || this.hasExactly("Ragnell")) && this.rValue == 5 && this.combatStartHp / this.maxHp >= 0.25){
			this.combatSpur.atk += 4;
			this.combatSpur.spd += 4;
			this.combatSpur.def += 4;
			this.combatSpur.res += 4;
			boostText += this.name + " gets +4 to all stats from HP >= 25% with " + data.skills[this.weaponIndex].name + ".<br>";
		}
		//Refined Raijinto
		if(this.hasExactly("Raijinto") && this.rValue == 5 && (this.initiator || this.toggle.weapon == 1)){
			this.combatSpur.atk += 4;
			this.combatSpur.spd += 4;
			this.combatSpur.def += 4;
			this.combatSpur.res += 4;
			boostText += this.name + " gets +4 to all stats from initiating or being within 2 spaces of an ally with Raijinto.<br>";
		}
		//Refined Gradivus
		if(this.hasExactly("Gradivus") && this.rValue == 5 && (!this.initiator || enemy.combatStartHp / enemy.maxHp >= 1)){
			this.combatSpur.atk += 4;
			this.combatSpur.spd += 4;
			this.combatSpur.def += 4;
			this.combatSpur.res += 4;
			boostText += this.name + " gets +4 to all stats from enemy initiating or enemy HP = 100% with Gradivus.<br>";
		}
		//Vengeful Lance
		if(this.hasExactly("Vengeful Lance") && this.toggle.weapon == 1){
			this.combatSpur.atk += 6;
			this.combatSpur.spd += 6;
			boostText += this.name + " gets +6 to atk and spd from not being adjacent to an ally with Vengeful Lance.<br>";
		}
		if(this.hasExactly("Bereft Lance")){
			if(this.rValue < 0 && this.buddy.adjacent + this.buddy.two < 3){
				var blVal = 6 - ((this.buddy.adjacent + this.buddy.two) * 2);
				this.combatSpur.atk += blVal;
				this.combatSpur.def += blVal;
				boostText += this.name + " gets +" + blVal + " to atk & def based on # of allies within 2 spaces with Bereft Lance.<br>";
			}
			else if(this.rValue > 0){
				var blVal = Math.max(10 - (this.buddy.adjacent * 2), 4);
				this.combatSpur.atk += blVal;
				this.combatSpur.spd += blVal;
				this.combatSpur.def += blVal;
				this.combatSpur.res += blVal;
				boostText += this.name + " gets +" + blVal + " to all stats based on # of adjacent allies with Bereft Lance.<br>";
			}
			if(this.rValue == 5 && this.combatStartHp / this.maxHp >= 0.25){
				this.combatSpur.atk += 5;
				this.combatSpur.spd += 5;
				this.combatSpur.def += 5;
				this.combatSpur.res += 5;
				boostText += this.name + " gets +5 to all stats from HP >= 25% with Bereft Lance.<br>";
			}
		}
		//Observant Staff
		if(this.has("Observant Staff") && this.toggle.weapon == 1){
			this.combatSpur.atk += 6;
			this.combatSpur.spd += 6;
			this.combatSpur.def += 6;
			this.combatSpur.res += 6;
			boostText += this.name + " gets +6 to all stats from being within 3 spaces of 2 allies in a support-partner pair with " + data.skills[this.weaponIndex].name + ".<br>";
		}
		//Rose-Quartz Bow and Wedding-Bell Axe
		if((this.hasExactly("Rose-Quartz Bow") || this.hasExactly("Wedding-Bell Axe")) && (this.initiator || this.toggle.weapon == 1)){
			this.combatSpur.atk += 6;
			this.combatSpur.spd += 6;
			boostText += this.name + " gets +6 atk and spd from initiating or being within 2 spaces of an ally with " + data.skills[this.weaponIndex].name + ".<br>";
		}
		//Love Bouquet
		if(this.has("Love Bouquet") && this.toggle.weapon == 1){
			this.combatSpur.atk += 4;
			this.combatSpur.res += 4;
			boostText += this.name + " gets +4 atk and res from being within 2 spaces of an ally with " + data.skills[this.weaponIndex].name + ".<br>";
		}
		//Love Candelabra
		if(this.has("Love Candelabra") && this.toggle.weapon == 1){
			this.combatSpur.atk += 4;
			this.combatSpur.def += 4;
			boostText += this.name + " gets +4 atk and def from being within 2 spaces of an ally with " + data.skills[this.weaponIndex].name + ".<br>";
		}
		if(this.hasExactly("Hrimfaxi")){
			if(this.combatStartHp / this.maxHp >= 0.25){
				this.combatSpur.atk += 5;
				this.combatSpur.spd += 5;
				this.combatSpur.def += 5;
				this.combatSpur.res += 5;
				boostText += this.name + " gets +5 to all stats from HP >= 25% with Hrimfaxi.<br>";
			}
			if(this.rValue == 5 && (!this.initiator || enemy.combatStartHp / enemy.maxHp >= 0.75)){
				var eNegate = this.checkNegate(enemy, currTurn);
				var dAtk = 0;
				var dSpd = 0;
				var dDef = 0;
				if(eNegate[0] == false){
					dAtk += Math.min(enemy.combatDebuffs.atk,enemy.debuffs.atk);
					if(enemy.penalty.panic){
						dAtk -= Math.max(enemy.combatBuffs.atk,enemy.buffs.atk);
					}
				}
				if(eNegate[1] == false){
					dSpd += Math.min(enemy.combatDebuffs.spd,enemy.debuffs.spd);
					if(enemy.penalty.panic){
						dSpd -= Math.max(enemy.combatBuffs.spd,enemy.buffs.spd);
					}
				}
				if(eNegate[2] == false){
					dDef += Math.min(enemy.combatDebuffs.def,enemy.debuffs.def);
					if(enemy.penalty.panic){
						dDef -= Math.max(enemy.combatBuffs.def,enemy.buffs.def);
					}
				}
				if(enemy.buddy.adjacent > 0 || enemy.buddy.two > 0){
					dAtk = Math.min(dAtk,enemy.buddy.debuffs.atk);
					dSpd = Math.min(dSpd,enemy.buddy.debuffs.spd);
					dDef = Math.min(dDef,enemy.buddy.debuffs.def);
				}
				dAtk -= 4;
				dSpd -= 4;
				dDef -= 4;
				enemy.combatSpur.atk += dAtk;
				enemy.combatSpur.spd += dSpd;
				enemy.combatSpur.def += dDef;
				boostText += this.name + " inflicts " + dAtk + " atk/" + dSpd + " spd/" + dDef + " def on " + enemy.name + " from enemy initiating or enemy HP >= 75% with Hrimfaxi.<br>";
			}
		}
		//Any Refined Vassal's Blade
		if(this.hasExactly("Vassal's Blade") && this.rValue > 0 && (this.initiator || this.toggle.weapon == 1)){
			this.combatSpur.spd += 5;
			boostText += this.name + " gets +5 spd from being within 2 spaces of an ally or initiating with Vassal's Blade.<br>";
		}
		//Refined Vassal's Blade
		if(this.hasExactly("Vassal's Blade") && this.rValue == 5 && enemy.combatStartHp / enemy.maxHp >= 0.75){
			this.combatSpur.atk += 5;
			this.combatSpur.spd += 5;
			boostText += this.name + " gets +5 to atk and spd from enemy HP >= 75% with Vassal's Blade.<br>";
		}
		//Any Refined Muninn's Egg
		if(this.hasExactly("Muninn's Egg") && this.rValue > 0 && enemy.combatStartHp / enemy.maxHp >= 0.75){
			this.combatSpur.atk += 4;
			this.combatSpur.spd += 4;
			this.combatSpur.res += 4;
			boostText += this.name + " gets +4 to atk/spd/res from enemy HP >= 75% with Muninn's Egg.<br>";
		}
		//Refined Muninn's Egg
		if(this.hasExactly("Muninn's Egg") && this.rValue == 5 && (this.initiator || this.toggle.weapon > 9)){
			this.combatSpur.atk += 4;
			this.combatSpur.spd += 4;
			this.combatSpur.res += 4;
			boostText += this.name + " gets +4 to atk/spd/res from being within 2 spaces of an ally or initiating with Muninn's Egg.<br>";
		}
		//Refined Peshkatz
		if(this.hasExactly("Peshkatz") && this.rValue == 5 && this.combatStartHp / this.maxHp >= 0.25){
			this.combatSpur.atk += 4;
			this.combatSpur.spd += 4;
			boostText += this.name + " gets +4 to atk and spd stats from  HP >= 25% with Peshkatz.<br>";
		}
		//Refined Skadi
		if(this.hasExactly("Skadi") && this.rValue == 5 && this.combatStartHp / this.maxHp >= 0.25){
			this.combatSpur.atk += 5;
			this.combatSpur.spd += 5;
			boostText += this.name + " gets +5 to atk and spd stats from  HP >= 25% with Skadi.<br>";
		}
		//Divine Sea Spear
		if(this.hasExactly("Divine Sea Spear") && (this.initiator || enemy.combatStartHp / enemy.maxHp >= 0.75)){
			this.combatSpur.atk += 3;
			this.combatSpur.spd += 3;
			this.combatSpur.def += 3;
			enemy.combatSpur.atk -= 3;
			enemy.combatSpur.spd -= 3;
			enemy.combatSpur.def -= 3;
			boostText += this.name + " gets +3 to atk/spd/def and inflicts -3 to atk/spd/def to " + enemy.name + " from initiating or enemy HP >= 75% with Divine Sea Spear.<br>";
			if(checkAllBuffs(enemy, this, currTurn) && allStats[9]){
				var extraStats = [0,0,0];
				var buffText = "";
				var debuffText = "";
				if(!allStats[15][0]){
					extraStats[0] = Math.max(enemy.buffs.atk,enemy.combatBuffs.atk);
					if(extraStats[0] > 0){
						this.combatSpur.atk += extraStats[0];
						enemy.combatSpur.atk -= extraStats[0];
						buffText += " +" + extraStats[0] + " atk";
						debuffText += " -" + extraStats[0] + " atk";
					}
				}
				if(!allStats[15][1]){
					extraStats[1] = Math.max(enemy.buffs.spd,enemy.combatBuffs.spd);
					if(extraStats[1] > 0){
						this.combatSpur.spd += extraStats[1];
						enemy.combatSpur.spd -= extraStats[1];
						buffText += " +" + extraStats[1] + " spd";
						debuffText += " -" + extraStats[1] + " spd";
					}
				}
				if(!allStats[15][2]){
					extraStats[2] = Math.max(enemy.buffs.def,enemy.combatBuffs.def);
					if(extraStats[2] > 0){
						this.combatSpur.def += extraStats[2];
						enemy.combatSpur.def -= extraStats[2];
						buffText += " +" + extraStats[2] + " def";
						debuffText += " -" + extraStats[2] + " def";
					}
				}
				if(buffText != ""){
					boostText += this.name + " gets" + buffText + " and inflicts" + debuffText + " to " + enemy.name + " from initiating or enemy HP >= 75% and enemy having buffs with Divine Sea Spear.<br>";
				}
			}
		}
		//Summer Vibrance Weapons
		if(this.has("Peachy Parfait") && enemy.combatStartHp / enemy.maxHp >= 0.75){
			this.combatSpur.res += 5;
			enemy.combatSpur.res -= 5;
			boostText += this.name + " gets +5 to res and inflicts -5 to res to " + enemy.name + " from enemy HP >= 75% with " + data.skills[this.weaponIndex].name + ".<br>";
			if(checkBuff(enemy, this, "res", currTurn) && allStats[9]){
				var extraStats = 0;
				if(!allStats[15][3]){
					extraStats = Math.max(enemy.buffs.res,enemy.combatBuffs.res);
					if(extraStats > 0){
						this.combatSpur.res += extraStats;
						enemy.combatSpur.res -= extraStats;
						boostText += this.name + " gets +" + extraStats + " res and inflicts -" + extraStats + " res to " + enemy.name + " from enemy HP >= 75% and enemy having res buff with " + data.skills[this.weaponIndex].name + ".<br>";
					}
				}
			}
		}
		if((this.has("Victorfish") || this.has("Sunflower Bow")) && enemy.combatStartHp / enemy.maxHp >= 0.75){
			this.combatSpur.def += 5;
			enemy.combatSpur.def -= 5;
			boostText += this.name + " gets +5 to def and inflicts -5 to def to " + enemy.name + " from enemy HP >= 75% with " + data.skills[this.weaponIndex].name + ".<br>";
			if(checkBuff(enemy, this, "def", currTurn) && allStats[9]){
				var extraStats = 0;
				if(!allStats[15][2]){
					extraStats = Math.max(enemy.buffs.def,enemy.combatBuffs.def);
					if(extraStats > 0){
						this.combatSpur.def += extraStats;
						enemy.combatSpur.def -= extraStats;
						boostText += this.name + " gets +" + extraStats + " def and inflicts -" + extraStats + " def to " + enemy.name + " from enemy HP >= 75% and enemy having def buff with " + data.skills[this.weaponIndex].name + ".<br>";
					}
				}
			}
		}
		//Sunshade Staff
		if(this.hasExactly("Sunshade Staff") && this.toggle.weapon == 1){
			this.combatSpur.atk += 6;
			this.combatSpur.spd += 6;
			boostText += this.name + " gets +6 to atk and spd from not being adjacent to an ally with Sunshade Staff.<br>";
		}
		if(this.hasExactly("Professorial Text")){
			if(this.initiator || this.toggle.weapon > 0){
				this.combatSpur.atk += 5;
				this.combatSpur.spd += 5;
				this.combatSpur.def += 5;
				this.combatSpur.res += 5;
				if(this.rValue > 0){
					boostText += this.name + " gets +5 to all stats from initiating or having an ally within 3 rows/columns with Professorial Text.<br>";
				}
				else{
					boostText += this.name + " gets +5 to all stats from initiating or being within 2 spaces of an ally with Professorial Text.<br>";
				}
			}
			if(this.rValue == 5 && this.combatStartHp / this.maxHp >= 0.25){
				var ptVal = this.toggle.weapon + 4;
				this.combatSpur.atk += ptVal;
				this.combatSpur.spd += ptVal;
				this.combatSpur.def += ptVal;
				this.combatSpur.res += ptVal;
				if(this.penalty.panic){
					this.combatBuffs.atk = 0;
					this.combatBuffs.spd = 0;
					this.buffs.atk = 0;
					this.buffs.spd = 0;
				}
				this.combatDebuffs.atk = 0;
				this.combatDebuffs.spd = 0;
				this.debuffs.atk = 0;
				this.debuffs.spd = 0;
				boostText += this.name + " gets +" + ptVal + " to all stats and neutralizes penalties to atk & spd from HP >= 25% with Professorial Text.<br>";
			}
		}
		//Refined Leiptr
		if(this.hasExactly("Leiptr") && this.rValue == 5 && this.combatStartHp / this.maxHp >= 0.25){
			this.combatSpur.atk += 4;
			this.combatSpur.spd += 4;
			this.combatSpur.def += 4;
			this.combatSpur.res += 4;
			if(this.penalty.panic){
				this.combatBuffs = {"atk":0,"spd":0,"def":0,"res":0};
				this.buffs = {"atk":0,"spd":0,"def":0,"res":0};
			}
			this.combatDebuffs = {"atk":0,"spd":0,"def":0,"res":0};
			this.debuffs = {"atk":0,"spd":0,"def":0,"res":0};
			boostText += this.name + " gets +4 to all stats and neutralizes penalties from HP >= 25% with Leiptr.<br>";
			if(!this.initiator){
				this.combatSpur.def += 4;
				this.combatSpur.res += 4;
				boostText += this.name + " gets +4 to def and res from enemy initiating with Leiptr.<br>";
			}
		}
		//Refined Expiration
		if(this.hasExactly("Expiration") && this.rValue == 5 && this.combatStartHp / this.maxHp >= 0.25){
			this.combatSpur.atk += 4;
			this.combatSpur.spd += 4;
			this.combatSpur.def += 4;
			this.combatSpur.res += 4;
			boostText += this.name + " gets +4 to all stats from HP >= 25% with Expiration.<br>";
		}
		//Any Refined Huginn's Egg
		if(this.hasExactly("Huginn's Egg") && this.rValue > 0 && enemy.combatStartHp / enemy.maxHp >= 0.75){
			this.combatSpur.atk += 5;
			this.combatSpur.spd += 5;
			boostText += this.name + " gets +5 to atk and spd from enemy HP >= 75% with Huginn's Egg.<br>";
		}
		//Refined Huginn's Egg
		if(this.hasExactly("Huginn's Egg") && this.rValue == 5 && (this.initiator || this.toggle.weapon > 9)){
			this.combatSpur.atk += 5;
			this.combatSpur.spd += 5;
			boostText += this.name + " gets +5 to atk and spd from being within 2 spaces of an ally or initiating with Huginn's Egg.<br>";
		}
		//Masking Axe
		if(this.hasExactly("Masking Axe") && (enemy.combatStartHp / enemy.maxHp >= 0.75 || !this.initiator)){
			this.combatSpur.atk += 5;
			this.combatSpur.def += 5;
			boostText += this.name + " gets +5 to atk and def from enemy initiating or enemy HP >= 75% with Masking Axe.<br>";
		}
		//Laws of Sacae 2
		if(this.hasExactly("Laws of Sacae 2") && (this.toggle.weapon == 1 || this.initiator)){
			this.combatSpur.atk += 6;
			this.combatSpur.spd += 6;
			this.combatSpur.def += 6;
			this.combatSpur.res += 6;
			boostText += this.name + " gets +6 to all stats from initiating or being within 2 spaces of an ally with Laws of Sacae 2.<br>";
		}
		//Dragonskin 2
		if(this.hasExactly("Dragonskin 2") && (enemy.combatStartHp / enemy.maxHp >= 0.75 || !this.initiator)){
			this.combatSpur.atk += 6;
			this.combatSpur.spd += 6;
			this.combatSpur.def += 6;
			this.combatSpur.res += 6;
			boostText += this.name + " gets +6 to all stats from enemy initiating or enemy HP >= 75% with Dragonskin 2.<br>";
		}
		//Brightmare Horn
		if(this.hasExactly("Brightmare Horn") && this.combatStartHp / this.maxHp >= 0.25){
			this.combatSpur.atk += 5;
			this.combatSpur.spd += 5;
			this.combatSpur.def += 5;
			this.combatSpur.res += 5;
			boostText += this.name + " gets +5 to all stats from HP >= 25% with Brightmare Horn.<br>";
		}
		if(this.hasExactly("Raydream Horn") && (this.initiator || this.toggle.weapon == 1)){
			this.combatSpur.atk += 6;
			enemy.combatSpur.spd -= 6;
			boostText += this.name + " gets +6 to atk and inflicts -6 atk to " + enemy.name + " from initiating or being within 2 spaces of an ally with Raydream Horn.<br>";
		}
		//Summer's Dream lances
		//fix this if another weapon gets Trident in their name
		if((this.has("Trident") || this.has("Shellpoint Lance")) && this.toggle.weapon == 1){
			this.combatSpur.atk += 5;
			this.combatSpur.def += 5;
			boostText += this.name + " gets +5 to atk and def from being within 3 spaces of an ally with " + data.skills[this.weaponIndex].name + ".<br>";
		}
		//Dolphin-Dive Axe
		if(this.hasExactly("Dolphin-Dive Axe") && (this.toggle.weapon == 1 || this.initiator)){
			this.combatSpur.atk += 5;
			this.combatSpur.spd += 5;
			this.combatSpur.def += 5;
			this.combatSpur.res += 5;
			boostText += this.name + " gets +5 to all stats from initiating or being within 2 spaces of an ally with Dolphin-Dive Axe.<br>";
		}
		//Fair-Fury Axe
		if(this.hasExactly("Fair-Fury Axe") && (this.initiator || this.toggle.weapon == 1)){
			this.combatSpur.atk += 6;
			this.combatSpur.spd += 6;
			boostText += this.name + " gets +6 to atk and spd from initiating or being within 2 spaces of an ally with Fair-Fury Axe.<br>";
		}
		//Ginnungagap
		if(this.hasExactly("Ginnungagap") && this.combatStartHp / this.maxHp >= 0.25){
			this.combatSpur.atk += 6;
			this.combatSpur.spd += 6;
			boostText += this.name + " gets +6 to atk and spd from HP >= 25% with Ginnungagap.<br>";
		}
		//Tiger Spirit
		if(this.hasExactly("Tiger Spirit") && this.combatStartHp / this.maxHp >= 0.25){
			this.combatSpur.atk += 6;
			this.combatSpur.res += 6;
			boostText += this.name + " gets +6 to atk and res from HP >= 25% with Tiger Spirit.<br>";
		}
		//Domain of Ice
		if(this.hasExactly("Domain of Ice") && this.toggle.c == 1){
			this.combatSpur.spd += 4;
			this.combatSpur.res += 4;
			boostText += this.name + " gets +4 to spd and res from being within 2 spaces of an ally with Domain of Ice.<br>";
		}
		//Domain of Ice (Outside Help)
		if(this.support.doi > 0){
			var dVal = this.support.doi * 4;
			this.combatSpur.spd += dVal;
			this.combatSpur.res += dVal;
			boostText += this.name + " gets +" + dVal + " to spd and res from being within 2 spaces of ally Nifl(s).<br>";
		}
		if(this.hasExactly("Holy Yewfelle")){
			if(this.initiator || enemy.combatStartHp / enemy.maxHp >= 0.75){
				this.combatSpur.atk += 6;
				this.combatSpur.spd += 6;
				if(this.penalty.panic){
					this.combatBuffs.atk = 0;
					this.combatBuffs.spd = 0;
					this.buffs.atk = 0;
					this.buffs.spd = 0;
				}
				this.combatDebuffs.atk = 0;
				this.combatDebuffs.spd = 0;
				this.debuffs.atk = 0;
				this.debuffs.spd = 0;
				boostText += this.name + " gets +6 to atk & spd and neutralizes penalties to atk & spd from initiating or enemy HP >= 75% with Holy Yewfelle.<br>";
			}
			if(this.rValue == 5 && this.combatStartHp / this.maxHp >= 0.25){
				var hyVal = 5 + Math.floor(allStats[17] * 0.15);
				this.combatSpur.atk += hyVal;
				this.combatSpur.spd += hyVal;
				boostText += this.name + " gets +" + hyVal + " to atk & spd from HP >= 25% with Holy Yewfelle.<br>";
			}
		}
		//Refined Dark Mysteltainn
		if(this.hasExactly("Dark Mystletainn") && this.rValue == 5 && (enemy.combatStartHp / enemy.maxHp >= 0.75 || !this.initiator)){
			this.combatSpur.atk += 5;
			this.combatSpur.def += 5;
			boostText += this.name + " gets +5 to atk and def from enemy initiating or enemy HP >= 75% with Dark Mystletainn.<br>";
		}
		//Refined Niu
		if(this.hasExactly("Niu") && this.rValue == 5 && this.combatStartHp / this.maxHp >= 0.25){
			this.combatSpur.atk += 4;
			this.combatSpur.spd += 4;
			this.combatSpur.def += 4;
			this.combatSpur.res += 4;
			boostText += this.name + " gets +4 to all stats from HP >= 25% with Niu.<br>";
		}
		//Nifl Frostflowers
		if(this.hasExactly("Nifl Frostflowers") && this.rValue > 0 && this.toggle.weapon > 0){
			this.combatSpur.atk += 5;
			this.combatSpur.res += 5;
			boostText += this.name + " gets +5 to atk and res from being within 3 spaces of an ally with Nifl Frostflowers.<br>";
		}
		if(this.hasExactly("Nifl Frostflowers") && this.rValue == 5 && enemy.combatStartHp / enemy.maxHp >= 0.5){
			this.combatSpur.atk += 5;
			this.combatSpur.res += 5;
			boostText += this.name + " gets +5 to atk and res from enemy HP >= 50% with Nifl Frostflowers.<br>";
		}
		//Punishment Staff
		if(this.hasExactly("Punishment Staff") && this.initiator){
			this.combatSpur.atk += 4;
			this.combatSpur.spd += 4;
			boostText += this.name + " gets +4 to atk and spd from initiating with Punishment Staff.<br>";
		}
		//Ebon-Pirate Claw
		if(this.hasExactly("Ebon-Pirate Claw") && enemy.combatStartHp / enemy.maxHp >= 0.75){
			this.combatSpur.atk += 5;
			this.combatSpur.spd += 5;
			this.combatSpur.res += 5;
			boostText += this.name + " gets +5 to atk/spd/res from enemy HP >= 75% with Ebon-Pirate Claw.<br>";
		}
		//Mermaid Bow
		if(this.hasExactly("Mermaid Bow") && this.combatStartHp / this.maxHp >= 0.25){
			this.combatSpur.atk += 6;
			this.combatSpur.spd += 6;
			boostText += this.name + " gets +6 to atk and spd from HP >= 25% with Mermaid Bow.<br>";
		}
		if(this.hasExactly("Genesis Falchion")){
			if(this.initiator || this.buddy.adjacent > 0 || this.buddy.two > 0){
				this.combatSpur.atk += 5;
				this.combatSpur.spd += 5;
				this.combatSpur.def += 5;
				this.combatSpur.res += 5;
				boostText += this.name + " gets +5 to all stats from initiating or being within 2 spaces of an ally with Genesis Falchion.<br>";
				if(this.toggle.weapon > 1){
					this.combatSpur.atk += 5;
					boostText += this.name + " gets +5 to atk from having >= 25 ally bonus totals with Genesis Falchion.<br>";
				}
			}
			if(this.rValue == 5 && this.combatStartHp / this.maxHp >= 0.25){
				var gfAtk = 0;
				var gfSpd = 0;
				var gfDef = 0;
				var gfRes = 0;
				if(!this.penalty.panic){
					gfAtk = Math.max(this.combatBuffs.atk,this.buffs.atk);
					gfSpd = Math.max(this.combatBuffs.spd,this.buffs.spd);
					gfDef = Math.max(this.combatBuffs.def,this.buffs.def);
					gfRes = Math.max(this.combatBuffs.res,this.buffs.res);
				}
				gfAtk = Math.max(gfAtk,this.buddy.buffs.atk) + 5;
				gfSpd = Math.max(gfSpd,this.buddy.buffs.spd) + 5;
				gfDef = Math.max(gfDef,this.buddy.buffs.def) + 5;
				gfRes = Math.max(gfRes,this.buddy.buffs.res) + 5;
				boostText += this.name + " gets +" + gfAtk + "/+" + gfSpd + "/+" + gfDef + "/+" + gfRes + " stats from HP >= 25% with Genesis Falchion.<br>";
			}
		}
		if(this.hasExactly("Binding Reginleif")){
			if(this.combatStartHp / this.maxHp >= 0.25){
				this.combatSpur.atk += 5;
				this.combatSpur.spd += 5;
				this.combatSpur.def += 5;
				this.combatSpur.res += 5;
				boostText += this.name + " gets +5 to all stats from HP >= 25% with Binding Reginleif.<br>";
			}
			if(this.rValue == 5 && (this.initiator || this.buddy.adjacent > 0 || this.buddy.two > 0)){
				this.combatSpur.atk += 5;
				this.combatSpur.spd += 5;
				this.combatSpur.def += 5;
				this.combatSpur.res += 5;
				var brVal = 5 + this.toggle.weapon;
				enemy.combatSpur.atk -= brVal;
				enemy.combatSpur.spd -= brVal;
				enemy.combatSpur.def -= brVal;
				boostText += this.name + " gets +5 to all stats and inflicts -" + brVal + " atk/spd/def on " + enemy.name + " from initiating or being within 2 spaces of an ally with Binding Reginleif.<br>";
			}
		}
		//Lion Weapons
		if((this.has("Raudrlion") || this.has("Blarlion") || this.has("Gronnlion")) && enemy.combatStartHp / enemy.maxHp >= 0.75){
			this.combatSpur.atk += 5;
			this.combatSpur.res += 5;
			boostText += this.name + " gets +5 to atk and res from enemy HP >= 75% with " + data.skills[this.weaponIndex].name + ".<br>";
		}
		if(this.hasExactly("New Dawn")){
			if(this.initiator || this.buddy.adjacent > 0 || this.buddy.two > 0){
				var ndVal = 0;
				var ndText = "";
				this.combatSpur.atk += 6;
				this.combatSpur.res += 6;
				if(this.rValue > 0){
					this.combatSpur.spd += 5;
					this.combatSpur.def += 5;
					ndVal = Math.floor(allStats[19] * 0.1);
					this.combatSpur.atk += ndVal;
					this.combatSpur.spd += ndVal;
					this.combatSpur.def += ndVal;
					this.combatSpur.res += ndVal;
					ndText = ", +5 to spd & def, and an additional +" + ndVal + " to all stats";
				}
				boostText += this.name + " gets +6 to atk & res" + ndText + " from initiating or being within 2 spaces of an ally with New Dawn.<br>";
			}
			if(this.rValue == 5 && this.combatStartHp / this.maxHp >= 0.25){
				this.combatSpur.atk += 5;
				this.combatSpur.spd += 5;
				this.combatSpur.def += 5;
				this.combatSpur.res += 5;
				if(this.penalty.panic){
					this.combatBuffs.atk = 0;
					this.combatBuffs.res = 0;
					this.buffs.atk = 0;
					this.buffs.res = 0;
				}
				this.combatDebuffs.atk = 0;
				this.combatDebuffs.res = 0;
				this.debuffs.atk = 0;
				this.debuffs.res = 0;
				boostText += this.name + " gets +5 to all stats and neutralizes penalties to atk & res from HP >= 25% with New Dawn.<br>";
			}
		}
		//Refined Dracofalchion
		if(this.hasExactly("Dracofalchion") && this.rValue == 5 && this.combatStartHp / this.maxHp >= 0.25){
			this.combatSpur.atk += 5;
			this.combatSpur.spd += 5;
			this.combatSpur.def += 5;
			this.combatSpur.res += 5;
			boostText += this.name + " gets +5 to all stats from HP >= 25% with Dracofalchion.<br>";
		}
		//Refined Ninis's Ice Lance
		if(this.hasExactly("Ninis's Ice Lance") && this.rValue > 0 && (this.initiator || this.toggle.weapon == 1)){
			this.combatSpur.atk += 5;
			this.combatSpur.spd += 5;
			this.combatSpur.def += 5;
			this.combatSpur.res += 5;
			boostText += this.name + " gets +5 to all stats from initiating or being within 2 spaces of an ally with Ninis's Ice Lance.<br>";
			if(this.rValue == 5){
				this.combatSpur.atk += 5;
				this.combatSpur.spd += 5;
				this.combatSpur.def += 5;
				this.combatSpur.res += 5;
				boostText += this.name + " gets +5 to all stats from initiating or being within 2 spaces of an ally with Ninis's Ice Lance.<br>";
			}
		}
		//Refined Flame Siegmund
		if(this.hasExactly("Flame Siegmund") && this.rValue > 0 && (this.initiator || this.toggle.weapon == 1)){
			this.combatSpur.atk += 4;
			this.combatSpur.def += 4;
			boostText += this.name + " gets +4 to atk and def from initiating or not being adjacent to an ally with Flame Siegmund.<br>";
		}
		//Dusk Dragonstone
		if(this.hasExactly("Dusk Dragonstone") && (enemy.combatStartHp / enemy.maxHp >= 0.75 || !this.initiator)){
			this.combatSpur.atk += 4;
			this.combatSpur.spd += 4;
			this.combatSpur.def += 4;
			this.combatSpur.res += 4;
			boostText += this.name + " gets +4 to all stats from enemy initiating or enemy HP >= 75% with Dusk Dragonstone.<br>";
		}
		//Refined
		if(this.hasExactly("Dusk Dragonstone") && this.rValue == 5 && this.toggle.weapon == 1){
			this.combatSpur.atk += 4;
			this.combatSpur.spd += 4;
			this.combatSpur.def += 4;
			this.combatSpur.res += 4;
			boostText += this.name + " gets +4 to all stats from being within 3 spaces of an ally with Dusk Dragonstone.<br>";
		}
		//Refined Light of Dawn
		if(this.hasExactly("Light of Dawn") && this.rValue > 0 && (enemy.combatStartHp / enemy.maxHp >= 0.75 || this.toggle.weapon == 1 || this.toggle.weapon == 3)){
			this.combatSpur.atk += 4;
			this.combatSpur.spd += 4;
			this.combatSpur.def += 4;
			this.combatSpur.res += 4;
			boostText += this.name + " gets +4 to all stats from enemy HP >= 75% or Penalty being active on enemy with Light of Dawn.<br>";
		}
		if(this.hasExactly("Light of Dawn") && this.rValue == 5 && (this.initiator || this.toggle.weapon == 2 || this.toggle.weapon == 3)){
			this.combatSpur.atk += 6;
			this.combatSpur.res += 6;
			boostText += this.name + " gets +6 to atk and res from initiating or being within 2 spaces of an ally with Light of Dawn.<br>";
		}
		//Refined Swift Mulagir
		if(this.hasExactly("Swift Mulagir") && this.rValue == 5 && (enemy.combatStartHp / enemy.maxHp >= 0.75 || this.initiator)){
			this.combatSpur.atk += 5;
			this.combatSpur.spd += 5;
			boostText += this.name + " gets +5 to atk and spd from initiating or enemy HP >= 75% with Swift Mulagir.<br>";
		}
		//Whirling Grace
		if(this.hasExactly("Whirling Grace") && this.combatStartHp / this.maxHp >= 0.25){
			this.combatSpur.atk += 5;
			this.combatSpur.spd += 5;
			this.combatSpur.def += 5;
			this.combatSpur.res += 5;
			boostText += this.name + " gets +5 to all stats from HP >= 25% with Whirling Grace.<br>";
		}
		//Grace weapons (and Bone Carver)
		if((this.has("Luminous Grace") || this.has("Drifting Grace") || this.has("Bone Carver")) && this.combatStartHp / this.maxHp >= 0.25){
			this.combatSpur.atk += 5;
			this.combatSpur.spd += 5;
			boostText += this.name + " gets +5 to atk and spd from HP >= 25% with " + data.skills[this.weaponIndex].name + ".<br>";
		}		
		//Bow of Twelve
		if(this.hasExactly("Bow of Twelve") && (this.initiator || (this.combatStartHp / this.maxHp >= 0.75 && enemy.range == "ranged" && enemy.attackType == "magical"))){
			this.combatSpur.atk += 5;
			this.combatSpur.spd += 5;
			this.combatSpur.def += 5;
			this.combatSpur.res += 5;
			boostText += this.name + " gets +5 to all stats from initiating or HP >= 75% and enemy using magic or staff with Bow of Twelve.<br>";
		}
		//Honorable Blade
		if(this.hasExactly("Honorable Blade") && enemy.combatStartHp / enemy.maxHp >= 0.5){
			this.combatSpur.atk += 6;
			this.combatSpur.spd += 6;
			boostText += this.name + " gets +6 to atk and spd from enemy HP >= 50% with Honorable Blade.<br>";
		}
		//Agnea's Arrow
		if(this.hasExactly("Agnea's Arrow") && (this.initiator || this.toggle.weapon == 1)){
			this.combatSpur.atk += 6;
			this.combatSpur.spd += 6;
			boostText += this.name + " gets +6 to atk and spd from initiating or being within 2 spaces of an ally with Agnea's Arrow.<br>";
			if(currTurn % 2 == 0){
				if(this.penalty.panic){
					this.combatBuffs.atk = 0;
					this.combatBuffs.spd = 0;
					this.buffs.atk = 0;
					this.buffs.spd = 0;
				}
				this.combatDebuffs.atk = 0;
				this.combatDebuffs.spd = 0;
				this.debuffs.atk = 0;
				this.debuffs.spd = 0;
				boostText += this.name + " neutralizes penalties to atk and spd from being an even-numbered turn.<br>";
			}
		}
		//Demonic Tome
		if(this.hasExactly("Demonic Tome") && this.combatStartHp / this.maxHp >= 0.25){
			this.combatSpur.atk += 6;
			this.combatSpur.res += 6;
			boostText += this.name + " gets +6 to atk and res from HP >= 25% with Demonic Tome.<br>";
		}
		//Flamelick Breath
		if(this.hasExactly("Flamelick Breath") && this.combatStartHp / this.maxHp >= 0.25){
			this.combatSpur.atk += 5;
			this.combatSpur.spd += 5;
			this.combatSpur.def += 5;
			this.combatSpur.res += 5;
			boostText += this.name + " gets +5 to all stats from HP >= 25% with Flamelick Breath.<br>";
		}
		//Domain of Flame
		if(this.hasExactly("Domain of Flame") && this.toggle.c == 1){
			this.combatSpur.atk += 4;
			this.combatSpur.def += 4;
			boostText += this.name + " gets +4 to atk and def from being within 2 spaces of an ally with Domain of Flame.<br>";
		}
		//Domain of Flame (Outside Help)
		if(this.support.dof > 0){
			var dVal = this.support.dof * 4;
			this.combatSpur.atk += dVal;
			this.combatSpur.def += dVal;
			boostText += this.name + " gets +" + dVal + " to atk and def from being within 2 spaces of ally Muspell(s).<br>";
		}
		if(this.hasExactly("Auto-Lofnheidr")){
			if(this.initiator || this.buddy.adjacent > 0 || this.buddy.two > 0){
				this.combatSpur.atk += 6;
				enemy.combatSpur.atk -= 6;
				boostText += this.name + " gets +6 to atk and inflicts -6 atk to " + enemy.name + " from initiating or being within 2 spaces of an ally with Auto-Lofnheidr.<br>";
			}
			if(this.rValue == 5 && this.combatStartHp / this.maxHp >= 0.25){
				this.combatSpur.atk += 5;
				this.combatSpur.def += 5;
				this.combatSpur.res += 5;
				var dAtk = Math.max(enemy.combatBuffs.atk,enemy.buffs.atk) * -2;
				var dDef = Math.max(enemy.combatBuffs.def,enemy.buffs.def) * -2;
				if(enemy.penalty.panic){
					dAtk = 0;
					dDef = 0;
				}
				enemy.combatSpur.atk += dAtk;
				enemy.combatSpur.def += dDef;
				boostText += this.name + " gets +5 to atk/def/res and inflicts " + dAtk + " atk & " + dDef + " def to " + enemy.name + " from HP >= 25% with Auto-Lofnheidr.<br>";
			}
		}
		//Refined Missiletain
		if(this.hasExactly("Missiletain") && enemy.combatStartHp / enemy.maxHp >= 0.5 && this.rValue > 0){
			this.combatSpur.atk += 5;
			this.combatSpur.spd += 5;
			boostText += this.name + " gets +5 to atk and spd from enemy HP >= 50% with Missiletain.<br>";
		}
		if(this.hasExactly("Missiletain") && this.toggle.weapon == 1){
			this.combatSpur.atk += 5;
			this.combatSpur.spd += 5;
			boostText += this.name + " gets +5 to atk and spd from being within 3 spaces of an ally with Missiletain.<br>";
		}
		//Refined Laevatein
		if(this.hasExactly("Laevatein") && this.rValue > 0 && (this.combatStartHp / this.maxHp >= 0.5 || (this.toggle.weapon == 1 || this.toggle.weapon == 3)|| checkAllBuffs(this, enemy, currTurn))){
			this.combatSpur.atk += 5;
			this.combatSpur.def += 5;
			boostText += this.name + " gets +5 to atk and def from HP >= 50% or having a Bonus active with Laevatein.<br>";
		}
		if(this.hasExactly("Laevatein") && this.rValue == 5 && enemy.combatStartHp / enemy.maxHp >= 0.75){
			this.combatSpur.atk += 5;
			this.combatSpur.def += 5;
			boostText += this.name + " gets +5 to atk and def from Enemy HP >= 75% with Laevatein.<br>";
		}
		//Moonstrike Breath
		if(this.hasExactly("Moonstrike Breath") && this.toggle.weapon == 1){
			this.combatSpur.atk += 6;
			enemy.combatSpur.atk -= 6;
			boostText += this.name + " gets +6 atk and inflicts -6 atk to " + enemy.name + " from being within 2 spaces of an ally with Moonstrike Breath.<br>";
		}
		//Witch Breath
		if(this.hasExactly("Witch Breath")){
			if(enemy.combatStartHp / enemy.maxHp >= 0.5){
				this.combatSpur.atk += 6;
				boostText += this.name + " gets +6 to atk from enemy HP >= 50% with Witch Breath.<br>";
			}
			if(this.combatStartHp / this.maxHp >= 0.5){
				enemy.combatSpur.atk -= 6;
				boostText += this.name + " inflicts -6 atk to " + enemy.name + " from HP >= 50% with Witch Breath.<br>";
			}
		}
		//Lantern Breath and Spider Plush
		if((this.has("Lantern Breath") || this.has("Spider Plush")) && (!this.initiator || enemy.combatStartHp / enemy.maxHp >= 0.75)){
			this.combatSpur.atk += 5;
			enemy.combatSpur.atk -= 5;
			boostText += this.name + " gets +5 atk and inflicts -5 atk to " + enemy.name + " from enemy initiating or enemy HP >= 75% with " + data.skills[this.weaponIndex].name + ".<br>";
		}
		//Eerie Scripture
		if(this.hasExactly("Eerie Scripture") && (!this.initiator || enemy.combatStartHp / enemy.maxHp >= 0.75)){
			this.combatSpur.atk += 5;
			this.combatSpur.spd += 5;
			this.combatSpur.def += 5;
			this.combatSpur.res += 5;
			boostText += this.name + " gets +5 to all stats from enemy initiating or enemy HP >= 75% with Eerie Scripture.<br>";
		}
		//Keen Coyote Bow
		if(this.hasExactly("Keen Coyote Bow") && this.combatStartHp / this.maxHp >= 0.25){
			this.combatSpur.atk += 6;
			this.combatSpur.spd += 6;
			boostText += this.name + " gets +6 to atk and spd from HP >= 25% with Keen Coyote Bow.<br>";
		}
		//Spendy Scimitar
		if(this.hasExactly("Spendy Scimitar") && (this.initiator || this.toggle.weapon == 1)){
			var buffVal = 4;
			if(this.dragonflower > 0){
				buffVal += 2;
			}
			this.combatSpur.atk += buffVal;
			this.combatSpur.spd += buffVal;
			this.combatSpur.def += buffVal;
			this.combatSpur.res += buffVal;
			boostText += this.name + " gets +" + buffVal + " to all stats from initiating or being within 2 spaces of an ally with Spendy Scimitar.<br>";
		}
		//Refined Exalted Falchion
		if(this.hasExactly("Exalted Falchion") && this.rValue > 0 && (this.combatStartHp / this.maxHp >= 0.5 || this.toggle.weapon == 1 || this.toggle.weapon == 3 || checkAllBuffs(this, enemy, currTurn))){
			this.combatSpur.atk += 4;
			this.combatSpur.spd += 4;
			this.combatSpur.def += 4;
			this.combatSpur.res += 4;
			boostText += this.name + " gets +4 to all stats from HP >= 50% or having a Bonus active with Exalted Falchion.<br>";
		}
		if(this.hasExactly("Exalted Falchion") && this.rValue == 5 && (this.initiator || this.toggle.weapon > 1)){
			var dAtk = (Math.min(this.combatDebuffs.atk,this.debuffs.atk) * -2) + 4;
			var dSpd = (Math.min(this.combatDebuffs.spd,this.debuffs.spd) * -2) + 4;
			var dDef = (Math.min(this.combatDebuffs.def,this.debuffs.def) * -2) + 4;
			var dRes = (Math.min(this.combatDebuffs.res,this.debuffs.res) * -2) + 4;
			if(this.penalty.panic){
				dAtk += Math.max(this.combatBuffs.atk,this.buffs.atk) * 2;
				dSpd += Math.max(this.combatBuffs.spd,this.buffs.spd) * 2;
				dDef += Math.max(this.combatBuffs.def,this.buffs.def) * 2;
				dRes += Math.max(this.combatBuffs.res,this.buffs.res) * 2;
			}
			this.combatSpur.atk += dAtk;
			this.combatSpur.spd += dSpd;
			this.combatSpur.def += dDef;
			this.combatSpur.res += dRes;
			boostText += this.name + " gets + " + dAtk + "/" + dSpd + "/" + dDef + "/" + dRes + " in stats from initiating or being within 2 spaces of an ally with Exalted Falchion.<br>";
		}
		//Refined Divine Mist
		if(this.hasExactly("Divine Mist") && this.rValue == 5 && this.combatStartHp / this.maxHp >= 0.25){
			this.combatSpur.atk += 4;
			this.combatSpur.spd += 4;
			this.combatSpur.def += 4;
			this.combatSpur.res += 4;
			var eAtk = Math.floor((Math.max(this.combatBuffs.def,this.buffs.def) + Math.max(this.combatBuffs.res,this.buffs.res)) * 0.75);
			var ePStr = "";
			if(!this.penalty.panic && eAtk > 0){
				enemy.combatSpur.atk -= eAtk;
				ePStr = " and inflicts -" + eAtk + " atk to " + enemy.name;
			}
			boostText += this.name + " gets +4 to all stats" + ePStr + " from HP >= 25% with Divine Mist.<br>";
		}
		//Refined Byleistr
		if(this.hasExactly("Byleistr") && this.rValue > 0 && (currTurn % 2 == 1 || enemy.combatStartHp / enemy.maxHp >= 0.75)){
			this.combatSpur.atk += 5;
			enemy.combatSpur.atk -= 5;
			boostText += this.name + " gets +5 atk and inflicts -5 atk to " + enemy.name + " from being odd-numbered turn or enemy HP >= 75% with Byleistr.<br>";
		}
		if(this.hasExactly("Byleistr") && this.rValue == 5 && (this.initiator || this.toggle.weapon > 1)){
			this.combatSpur.atk += 5;
			enemy.combatSpur.atk -= 5;
			boostText += this.name + " gets +5 atk and inflicts -5 atk to " + enemy.name + " from initiating or being within 2 spaces of an ally with Byleistr.<br>";
		}
		//Refined Fruit of Idunn
		if(this.hasExactly("Fruit of Idunn") && this.rValue > 0 && enemy.combatStartHp / enemy.maxHp >= 0.75){
			this.combatSpur.atk += 5;
			this.combatSpur.spd += 5;
			boostText += this.name + " gets +5 to atk and spd from enemy HP >= 75% with Fruit of Idunn.<br>";
		}
		if(this.hasExactly("Fruit of Idunn") && this.rValue == 5 && this.toggle.weapon == 1){
			this.combatSpur.atk += 4;
			this.combatSpur.spd += 4;
			boostText += this.name + " gets +4 to atk and spd from being within 2 spaces of an ally with Fruit of Idunn.<br>";
		}
		//Refined Sagittae
		if(this.hasExactly("Sagittae") && this.rValue == 5 && this.combatStartHp / this.maxHp >= 0.25){
			this.combatSpur.atk += 4;
			this.combatSpur.spd += 4;
			this.combatSpur.def += 4;
			this.combatSpur.res += 4;
			boostText += this.name + " gets +4 to all stats from HP >= 25% with Sagittae.<br>";
		}
		//Fanged Basilikos
		if(this.hasExactly("Fanged Basilikos") && this.combatStartHp / this.maxHp >= 0.25){
			this.combatSpur.atk += 5;
			this.combatSpur.spd += 5;
			boostText += this.name + " gets +5 to atk and spd from HP >= 25% with Fanged Basilikos.<br>";
		}
		//Kaze's Needle
		if(this.hasExactly("Kaze's Needle") && (this.initiator || this.toggle.weapon == 1)){
			this.combatSpur.atk += 4;
			this.combatSpur.spd += 4;
			this.combatSpur.res += 4;
			boostText += this.name + " gets +4 to atk/spd/res from initiating or being within 2 spaces of an ally with Kaze's Needle.<br>";
		}
		if(this.hasExactly("Kaze's Needle") && this.rValue == 5 && this.combatStartHp / this.maxHp >= 0.25){
			this.combatSpur.atk += 4;
			this.combatSpur.spd += 4;
			this.combatSpur.res += 4;
			boostText += this.name + " gets +4 to atk/spd/res from HP >= 25% with Kaze's Needle.<br>";
		}
		//Fireman's Hook
		if(this.hasExactly("Fireman's Hook") && (this.initiator || this.toggle.weapon == 1)){
			this.combatSpur.atk += 5;
			this.combatSpur.spd += 5;
			this.combatSpur.def += 5;
			this.combatSpur.res += 5;
			boostText += this.name + " gets +5 to all stats from initiating or not being adjacent to an ally with Fireman's Hook.<br>";
		}
		//Damiell Bow
		if(this.hasExactly("Damiell Bow") && this.combatStartHp / this.maxHp >= 0.25){
			this.combatSpur.atk += 6;
			this.combatSpur.spd += 6;
			boostText += this.name + " gets +6 to atk and spd from HP >= 25% with Damiell Bow.<br>";
		}
		//Flame of Muspell
		if(this.hasExactly("Flame of Muspell") && (this.toggle.weapon == 1 || checkAllBuffs(this, enemy, currTurn))){
			this.combatSpur.atk += 6;
			this.combatSpur.spd += 6;
			boostText += this.name + " gets +6 to atk and spd from having a Bonus active with Flame of Muspell.<br>";
		}
		if(this.hasExactly("War-God Mjolnir")){
			if(this.combatStartHp / this.maxHp >= 0.25){
				this.combatSpur.atk += 6;
				enemy.combatSpur.atk -= 6;
				boostText += this.name + " gets +6 to atk and inflicts -6 atk to " + enemy.name + " from HP >= 25% with War-God Mjolnir.<br>";
			}
			if(this.rValue == 5 && this.combatStartHp / this.maxHp >= 0.25){
				this.combatSpur.atk += 6;
				enemy.combatSpur.atk -= 6;
				boostText += this.name + " gets +6 to atk and inflicts -6 atk to " + enemy.name + " from HP >= 25% with War-God Mjolnir.<br>";
			}
		}
		//Refined Summer's Breath
		if(this.hasExactly("Summer's Breath") && this.rValue > 0 && (enemy.combatStartHp / enemy.maxHp >= 0.75 || !this.initiator)){
			this.combatSpur.atk += 4;
			this.combatSpur.spd += 4;
			this.combatSpur.def += 4;
			this.combatSpur.res += 4;
			boostText += this.name + " gets +4 to all stats from enemy initiating or enemy HP >= 75% with Summer's Breath.<br>";
		}
		if(this.hasExactly("Summer's Breath") && this.rValue == 5 && this.toggle.weapon == 1){
			this.combatSpur.atk += 4;
			this.combatSpur.spd += 4;
			this.combatSpur.def += 4;
			this.combatSpur.res += 4;
			boostText += this.name + " gets +4 to all stats from being within 3 spaces of an ally with Summer's Breath.<br>";
		}
		//Refined Wolf Queen Fang
		if(this.hasExactly("Wolf Queen Fang") && this.rValue > 0 && (enemy.combatStartHp / enemy.maxHp >= 0.75 || this.toggle.weapon == 1)){
			this.combatSpur.atk += 5;
			this.combatSpur.spd += 5;
			boostText += this.name + " gets +5 to atk and spd from enemy HP >= 75% or being within 3 spaces of an ally with Wolf Queen Fang.<br>";
			if(enemy.combatStartHp / enemy.maxHp >= 0.75 && this.toggle.weapon == 1){
				enemy.combatSpur.atk -= 5;
				enemy.combatSpur.def -= 5;
				boostText += this.name + " inflicts -5 atk and def to " + enemy.name + " from enemy HP >= 75% and being within 3 spaces of an ally with Wolf Queen Fang.<br>";
			}
		}
		if(this.hasExactly("Wolf Queen Fang") && this.rValue == 5 && this.combatStartHp / this.maxHp >= 0.25){
			this.combatSpur.atk += 4;
			this.combatSpur.spd += 4;
			this.combatSpur.def += 4;
			this.combatSpur.res += 4;
			boostText += this.name + " gets +4 to all stats from HP >= 25% with Wolf Queen Fang.<br>";
		}
		//Refined Thokk
		if(this.hasExactly("Thokk") && this.rValue == 5 && this.combatStartHp / this.maxHp >= 0.25){
			this.combatSpur.atk += 4;
			this.combatSpur.spd += 4;
			boostText += this.name + " gets +4 to atk and spd from HP >= 25% with Thokk.<br>";
		}
		if(this.hasExactly("Horn of Opening")){
			if(this.buddy.adjacent + this.buddy.two + this.buddy.three > 0){
				var hoText = "";
				this.combatSpur.atk += 6;
				if(this.rValue > 0){
					this.combatSpur.spd += 5;
					hoText = " & +5 to spd";
				}
				enemy.combatSpur.atk -= 6;
				boostText += this.name + " gets +6 to atk" + hoText + " and inflicts -6 atk to " + enemy.name + " from being within 3 spaces of an ally with Horn of Opening.<br>";
			}
			if(this.rValue == 5 && (enemy.combatStartHp / enemy.maxHp >= 0.75 || !this.initiator)){
				var hoVal = Math.min((this.buddy.adjacent + this.buddy.two + this.buddy.three) * 2 + 5, 11);
				this.combatSpur.atk += hoVal;
				this.combatSpur.spd += hoVal;
				this.combatSpur.def += hoVal;
				this.combatSpur.res += hoVal;
				boostText += this.name + " gets +" + hoVal + " to all stats from enemy initiating or enemy HP >= 75% with Horn of Opening.<br>";
			}
		}
		//Winter Dreamland weapons
		if(this.has("Snow Globe") && this.toggle.weapon == 1){
			var dAtk = 5 + Math.min(this.combatDebuffs.atk,this.debuffs.atk) * -2;
			var dRes = 5 + Math.min(this.combatDebuffs.res,this.debuffs.res) * -2;
			if(this.penalty.panic){
				dAtk += Math.max(this.combatBuffs.atk,this.buffs.atk) * 2;
				dRes += Math.max(this.combatBuffs.res,this.buffs.res) * 2;
			}
			this.combatSpur.atk += dAtk;
			this.combatSpur.res += dRes;
			boostText += this.name + " gets net +" + dAtk + " atk and +" + dRes + " res from having ally within 2 spaces with " + data.skills[this.weaponIndex].name + ".<br>";
		}
		if((this.has("Winter Rapier") || this.has("Tannenbow")) && this.toggle.weapon == 1){
			var dAtk = 5 + Math.min(this.combatDebuffs.atk,this.debuffs.atk) * -2;
			var dDef = 5 + Math.min(this.combatDebuffs.def,this.debuffs.def) * -2;
			if(this.penalty.panic){
				dAtk += Math.max(this.combatBuffs.atk,this.buffs.atk) * 2;
				dDef += Math.max(this.combatBuffs.def,this.buffs.def) * 2;
			}
			this.combatSpur.atk += dAtk;
			this.combatSpur.def += dDef;
			boostText += this.name + " gets net +" + dAtk + " atk and +" + dDef + " def from having ally within 2 spaces with " + data.skills[this.weaponIndex].name + ".<br>";
		}
		//Sweet Yule Log
		if(this.hasExactly("Sweet Yule Log") && this.combatStartHp / this.maxHp >= 0.25){
			this.combatSpur.atk += 6;
			this.combatSpur.spd += 6;
			boostText += this.name + " gets +6 to atk and spd from HP >= 25% with Sweet Yule Log.<br>";
		}
		if(this.hasExactly("Professorial Guide")){
			if(this.initiator || (this.rValue < 0 && this.buddy.adjacent + this.buddy.two > 0) || (this.rValue > 0 && this.buddy.rorc > 0)){
				var pgText = "being within 2 spaces of an ally";
				if(this.rValue > 0){
					pgText = "having an ally within 3 rows/columns";
				}
				this.combatSpur.atk += 5;
				this.combatSpur.spd += 5;
				this.combatSpur.def += 5;
				this.combatSpur.res += 5;
				boostText += this.name + " gets +5 to all stats from initiating or " + pgText + " with Professorial Guide.<br>";
			}
			if(this.rValue == 5 && this.combatStartHp / this.maxHp >= 0.25){
				var pgVal = Math.min(this.buddy.rorc * 2 + 5, 11);
				this.combatSpur.atk += pgVal;
				this.combatSpur.spd += pgVal;
				this.combatSpur.def += pgVal;
				this.combatSpur.res += pgVal;
				boostText += this.name + " gets +" + pgVal + " to all stats from HP >= 25% with Professorial Guide.<br>";
			}
		}
		//Nidavellir Lots
		if(this.hasExactly("Nidavellir Lots") && this.combatStartHp / this.maxHp >= 0.25){
			this.combatSpur.atk += 6;
			this.combatSpur.spd += 6;
			boostText += this.name + " gets +6 to atk and spd from HP >= 25% with Nidavellir Lots.<br>";
		}
		//Nidavellir Sprig
		if(this.hasExactly("Nidavellir Sprig") && (this.initiator || this.toggle.weapon == 1)){
			this.combatSpur.atk += 5;
			this.combatSpur.spd += 5;
			this.combatSpur.def += 5;
			this.combatSpur.res += 5;
			boostText += this.name + " gets +5 to all stats from initiating or not being adjacent to an ally with Nidavellir Sprig.<br>";
		}
		//Sparkling Fang
		if(this.hasExactly("Sparkling Fang") && enemy.combatStartHp / enemy.maxHp >= 0.75){
			this.combatSpur.atk += 6;
			this.combatSpur.spd += 6;
			boostText += this.name + " gets +6 to atk and spd from enemy HP >= 75% with Sparkling Fang.<br>";
		}
		//Polished Fang
		if(this.hasExactly("Polished Fang") && enemy.combatStartHp / enemy.maxHp >= 0.75){
			this.combatSpur.atk += 6;
			this.combatSpur.def += 6;
			boostText += this.name + " gets +6 to atk and def from enemy HP >= 75% with Polished Fang.<br>";
		}
		//Refined Storm Sieglinde
		if(this.hasExactly("Storm Sieglinde") && this.rValue > 0 && (this.initiator || this.toggle.weapon == 1)){
			this.combatSpur.atk += 4;
			this.combatSpur.spd += 4;
			this.combatSpur.def += 4;
			this.combatSpur.res += 4;
			boostText += this.name + " gets +4 to all stats from initiating or not being adjacent to an ally with Storm Sieglinde.<br>";
		}
		if(this.hasExactly("Storm Sieglinde") && this.rValue == 5 && this.combatStartHp / this.maxHp >= 0.25){
			this.combatSpur.atk += 4;
			this.combatSpur.spd += 4;
			this.combatSpur.def += 4;
			this.combatSpur.res += 4;
			boostText += this.name + " gets +4 to all stats from HP >= 25% with Storm Sieglinde.<br>";
		}
		//Refined Spirit Breath
		if(this.hasExactly("Spirit Breath") && this.rValue > 0 && (allStats[18] > allStats[22] || enemy.combatStartHp / enemy.maxHp >= 0.75)){
			this.combatSpur.atk += 5;
			enemy.combatSpur.atk -= 5;
			boostText += this.name + " gets +5 to atk and inflicts -5 atk to " + enemy.name + " from def > enemy def or enemy HP >= 75% with Spirit Breath.<br>";
		}
		if(this.hasExactly("Spirit Breath") && this.rValue == 5 && this.toggle.weapon == 1){
			this.combatSpur.atk += 5;
			enemy.combatSpur.atk -= 5;
			boostText += this.name + " gets +5 to atk and inflicts -5 atk to " + enemy.name + " from being within 3 spaces of an ally with Spirit Breath.<br>";
		}
		//Ancient Codex
		if(this.hasExactly("Ancient Codex") && this.toggle.weapon == 1){
			this.combatSpur.atk += 5;
			this.combatSpur.res += 5;
			boostText += this.name + " gets +5 to atk and res from being within 3 spaces of an ally with Ancient Codex.<br>";
		}
		if(this.hasExactly("Ancient Codex") && this.rValue == 5 && enemy.combatStartHp / enemy.maxHp >= 0.75){
			this.combatSpur.atk += 5;
			this.combatSpur.res += 5;
			boostText += this.name + " gets +5 to atk and res from enemy HP >= 75% with Ancient Codex.<br>";
		}
		//Sworn Lance
		if(this.hasExactly("Sworn Lance") && this.combatStartHp / this.maxHp >= 0.25){
			this.combatSpur.atk += 5;
			this.combatSpur.def += 5;
			boostText += this.name + " gets +5 to atk and def from HP >= 25% with Sworn Lance.<br>";
		}
		if(this.hasExactly("Sworn Lance") && this.rValue == 5 && this.toggle.weapon == 1){
			this.combatSpur.atk += 7;
			this.combatSpur.def += 7;
			boostText += this.name + " gets +7 to atk and def from being within 3 spaces of support partner or support partner HP <= 80% with Sworn Lance.<br>";
		}
		//Refined Thogn
		if(this.hasExactly("Thogn") && this.rValue > 0 && (this.initiator || this.toggle.weapon == 1 || this.toggle.weapon == 3)){
			this.combatSpur.atk += 4;
			this.combatSpur.spd += 4;
			this.combatSpur.def += 4;
			this.combatSpur.res += 4;
			boostText += this.name + " gets +4 to all stats from initiating or being within 2 spaces of an ally with Thogn.<br>";
		}
		if(this.hasExactly("Thogn") && this.rValue == 5 && this.toggle.weapon > 0){
			var eNegate = this.checkNegate(enemy, currTurn);
			var dAtk = -4;
			var dSpd = -4;
			var dDef = -4;
			if(eNegate[0] == false){
				dAtk += Math.min(enemy.combatDebuffs.atk,enemy.debuffs.atk);
				if(enemy.penalty.panic){
					dAtk -= Math.max(enemy.combatBuffs.atk,enemy.buffs.atk);
				}
			}
			if(eNegate[1] == false){
				dSpd += Math.min(enemy.combatDebuffs.spd,enemy.debuffs.spd);
				if(enemy.penalty.panic){
					dSpd -= Math.max(enemy.combatBuffs.spd,enemy.buffs.spd);
				}
			}
			if(eNegate[2] == false){
				dDef += Math.min(enemy.combatDebuffs.def,enemy.debuffs.def);
				if(enemy.penalty.panic){
					dDef -= Math.max(enemy.combatBuffs.def,enemy.buffs.def);
				}
			}
			enemy.combatSpur.atk += dAtk;
			enemy.combatSpur.spd += dSpd;
			enemy.combatSpur.def += dDef;
			boostText += this.name + " inflicts " + dAtk + " atk/" + dSpd + " spd/" + dDef + " def on " + enemy.name + " from being within 3 spaces of an ally with Thogn.<br>";
		}
		//Refined Draconic Rage
		if(this.hasExactly("Draconic Rage") && this.rValue > 0 && (this.initiator || this.toggle.weapon == 1)){
			this.combatSpur.atk += 4;
			this.combatSpur.spd += 4;
			this.combatSpur.def += 4;
			this.combatSpur.res += 4;
			boostText += this.name + " gets +4 to all stats from initiating or being within 2 spaces of an ally with Draconic Rage.<br>";
		}
		if(this.hasExactly("Draconic Rage") && this.rValue == 5 && this.combatStartHp / this.maxHp >= 0.25){
			this.combatSpur.atk += 4;
			this.combatSpur.spd += 4;
			this.combatSpur.def += 4;
			this.combatSpur.res += 4;
			boostText += this.name + " gets +4 to all stats from HP >= 25% with Draconic Rage.<br>";
		}
		//Rapid Crier Bow
		if(this.hasExactly("Rapid-Crier Bow") && this.toggle.weapon == 1){
			this.combatSpur.atk += 5;
			this.combatSpur.spd += 5;
			this.combatSpur.def += 5;
			this.combatSpur.res += 5;
			boostText += this.name + " gets +5 to all stats from being within 3 spaces of an ally with Rapid-Crier Bow.<br>";
		}
		//Argent Aura
		if(this.hasExactly("Argent Aura") && enemy.combatStartHp / enemy.maxHp >= 0.75){
			this.combatSpur.atk += 6;
			this.combatSpur.res += 6;
			boostText += this.name + " gets +6 to atk and res from enemy HP >= 75% with Argent Aura.<br>";
		}
		//Royal Hatari Fang
		if(this.hasExactly("Royal Hatari Fang") && (this.initiator || this.toggle.weapon == 1)){
			this.combatSpur.atk += 5;
			this.combatSpur.spd += 5;
			this.combatSpur.def += 5;
			this.combatSpur.res += 5;
			boostText += this.name + " gets +5 to all stats from initiating or being within 2 spaces of an ally with Royal Hatari Fang.<br>";
		}
		//Dryblade Lance/Dancing Flames
		if((this.hasExactly("Dryblade Lance") || this.hasExactly("Dancing Flames")) && this.combatStartHp / this.maxHp >= 0.25){
			this.combatSpur.atk += 6;
			this.combatSpur.spd += 6;
			boostText += this.name + " gets +6 to atk and spd from HP >= 25% with " + data.skills[this.weaponIndex].name + ".<br>";
		}
		//Gerbera Axe
		if(this.hasExactly("Gerbera Axe") && (enemy.combatStartHp / enemy.maxHp >= 0.75 || !this.initiator)){
			this.combatSpur.atk += 5;
			this.combatSpur.spd += 5;
			this.combatSpur.def += 5;
			this.combatSpur.res += 5;
			boostText += this.name + " gets +5 to all stats from enemy initiating or enemy HP >= 75% with Gerbera Axe.<br>";
		}
		//Piercing Tribute
		if(this.has("Piercing Tribute") && (enemy.combatStartHp / enemy.maxHp >= 0.75 || !this.initiator)){
			this.combatSpur.atk += 5;
			this.combatSpur.spd += 5;
			boostText += this.name + " gets +5 to atk and spd from enemy initiating or enemy HP >= 75% with " + data.skills[this.weaponIndex].name + ".<br>";
		}
		//Staff of Tribute
		if(this.has("Staff of Tribute") && this.toggle.weapon == 1){
			this.combatSpur.def += 6;
			this.combatSpur.res += 6;
			boostText += this.name + " gets +6 to def and res from being within 3 spaces of an ally with " + data.skills[this.weaponIndex].name + ".<br>";
		}
		//Destiny's Bow
		if(this.hasExactly("Destiny's Bow") && (this.initiator || this.toggle.weapon == 1)){
			this.combatSpur.atk += 5;
			this.combatSpur.spd += 5;
			this.combatSpur.def += 5;
			this.combatSpur.res += 5;
			boostText += this.name + " gets +5 to all stats from initiating or being within 2 spaces of an ally with Destiny's Bow.<br>";
		}
		//Refined Book of Dreams
		if(this.hasExactly("Book of Dreams") && this.rValue == 5 && this.combatStartHp / this.maxHp >= 0.25){
			this.combatSpur.atk += 5;
			this.combatSpur.spd += 5;
			boostText += this.name + " gets +5 to atk and spd from HP >= 25% with Book of Dreams.<br>";
		}
		//Tome of Reason
		if(this.hasExactly("Tome of Reason")){
			if(this.combatStartHp / this.maxHp >= 0.25){
				this.combatSpur.atk += 4;
				this.combatSpur.spd += 4;
				this.combatSpur.def += 4;
				this.combatSpur.res += 4;
				boostText += this.name + " gets +4 to all stats from HP >= 25% with Tome of Reason.<br>";
			}
			if(this.rValue == 5 && (this.initiator || this.toggle.weapon > 1)){
				this.combatSpur.atk += 4;
				this.combatSpur.spd += 4;
				this.combatSpur.def += 4;
				this.combatSpur.res += 4;
				boostText += this.name + " gets +4 to all stats from initiating or being within 2 spaces of an ally with Tome of Reason.<br>";
				if(!this.penalty.panic){
					var pVar = Math.floor((Math.max(this.combatBuffs.def,this.buffs.def) + Math.max(this.combatBuffs.res,this.buffs.res)) * 0.6);
					if(pVar > 0){
						enemy.combatSpur.atk -= pVar;
						enemy.combatSpur.res -= pVar;
						boostText += this.name + " has activated Tome of Reason. Effect on " + enemy.name + ": -" + pVar + " to atk and res.<br>";
					}
				}
			}
		}
		//Bow of Verdane
		if(this.hasExactly("Bow of Verdane")){
			if(this.initiator || this.toggle.weapon == 1){
				this.combatSpur.atk += 5;
				this.combatSpur.spd += 5;
				boostText += this.name + " gets +5 to atk and spd from initiating or not being adjacent to an ally with Bow of Verdane.<br>";
			}
			if(this.rValue == 5 && this.combatStartHp / this.maxHp >= 0.25){
				this.combatSpur.atk += 5;
				this.combatSpur.spd += 5;
				boostText += this.name + " gets +5 to atk and spd from HP >= 25% with Bow of Verdane.<br>";
			}
		}
		//Hurricane Dagger
		if(this.hasExactly("Hurricane Dagger")){
			if(enemy.combatStartHp / enemy.maxHp >= 0.75 || this.toggle.weapon == 1 || checkAllBuffs(enemy, this, currTurn)){
				this.combatSpur.atk += 5;
				this.combatSpur.spd += 5;
				boostText += this.name + " gets +5 to atk and spd from enemy HP >= 75% or having Bonus active on enemy with Hurricane Dagger.<br>";
			}
			if(this.rValue == 5 && this.combatStartHp / this.maxHp >= 0.25){
				this.combatSpur.atk += 5;
				this.combatSpur.spd += 5;
				boostText += this.name + " gets +5 to atk and spd from HP >= 25% with Hurricane Dagger.<br>";
			}
		}
		//Refined Lyfjaberg
		if(this.hasExactly("Lyfjaberg") && this.rValue > 0){
			if(this.combatStartHp / this.maxHp >= 0.25){
				this.combatSpur.atk += 4;
				this.combatSpur.spd += 4;
				this.combatSpur.def += 4;
				this.combatSpur.res += 4;
				boostText += this.name + " gets +4 to all stats from HP >= 25% with Lyfjaberg.<br>";
			}
			if(this.rValue == 5 && this.toggle.weapon == 1){
				var hStat = Math.floor(this.combatStartHp * 0.2);
				this.combatSpur.atk += 4 + hStat;
				this.combatSpur.spd += 4;
				this.combatSpur.def += 4;
				this.combatSpur.res += 4 + hStat;
				boostText += this.name + " gets +4 to all stats and an additional +" + hStat + " atk and res from being within 3 spaces of an ally with Lyfjaberg.<br>";
			}
		}
		//Sell-Spell Tome
		if(this.hasExactly("Sell-Spell Tome") && this.combatStartHp / this.maxHp >= 0.25){
			var buffVal = 4;
			if(this.dragonflower == 3){
				buffVal += 1;
			}
			else if(this.dragonflower == 4){
				buffVal += 2;
			}
			else if(this.dragonflower > 4){
				buffVal += 3;
			}
			this.combatSpur.atk += buffVal;
			this.combatSpur.spd += buffVal;
			this.combatSpur.def += buffVal;
			this.combatSpur.res += buffVal;
			boostText += this.name + " gets +" + buffVal + " to all stats from HP >= 25% with Sell-Spell Tome.<br>";
		}
		if(this.hasExactly("Wing-Lifted Spear")){
			if(this.initiator || this.buddy.adjacent > 0 || this.buddy.two > 0){
				this.combatSpur.atk += 5;
				this.combatSpur.spd += 5;
				this.combatSpur.def += 5;
				this.combatSpur.res += 5;
				boostText += this.name + " gets +5 to all stats from initiating or being within 2 spaces of an ally with Wing-Lifted Spear.<br>";
				if(checkAllBuffs(enemy, this, currTurn) && allStats[9]){
					var extraStats = [0,0,0,0];
					var buffText = "";
					var debuffText = "";
					if(!allStats[15][0]){
						extraStats[0] = Math.max(enemy.buffs.atk,enemy.combatBuffs.atk);
						if(extraStats[0] > 0){
							this.combatSpur.atk += extraStats[0];
							enemy.combatSpur.atk -= extraStats[0];
							buffText += " +" + extraStats[0] + " atk";
							debuffText += " -" + extraStats[0] + " atk";
						}
					}
					if(!allStats[15][1]){
						extraStats[1] = Math.max(enemy.buffs.spd,enemy.combatBuffs.spd);
						if(extraStats[1] > 0){
							this.combatSpur.spd += extraStats[1];
							enemy.combatSpur.spd -= extraStats[1];
							buffText += " +" + extraStats[1] + " spd";
							debuffText += " -" + extraStats[1] + " spd";
						}
					}
					if(!allStats[15][2]){
						extraStats[2] = Math.max(enemy.buffs.def,enemy.combatBuffs.def);
						if(extraStats[2] > 0){
							this.combatSpur.def += extraStats[2];
							enemy.combatSpur.def -= extraStats[2];
							buffText += " +" + extraStats[2] + " def";
							debuffText += " -" + extraStats[2] + " def";
						}
					}
					if(!allStats[15][3]){
						extraStats[3] = Math.max(enemy.buffs.res,enemy.combatBuffs.res);
						if(extraStats[3] > 0){
							this.combatSpur.res += extraStats[3];
							enemy.combatSpur.res -= extraStats[3];
							buffText += " +" + extraStats[3] + " res";
							debuffText += " -" + extraStats[3] + " res";
						}
					}
					boostText += this.name + " gets" + buffText + " and inflicts" + debuffText + " to " + enemy.name + " from initiating or being within 2 spaces of an ally with Wing-Lifted Spear.<br>";
				}
			}
			if(this.rValue == 5 && (this.initiator || this.buddy.adjacent > 0 || this.buddy.two > 0)){
				var wsVal = Math.min((this.buddy.adjacent + this.buddy.two + this.buddy.three) * 2 + 5, 11);
				this.combatSpur.atk += wsVal;
				this.combatSpur.spd += wsVal;
				this.combatSpur.def += wsVal;
				this.combatSpur.res += wsVal;
				boostText += this.name + " gets +" + wsVal + " to all stats from initiating or being within 2 spaces of an ally with Wing-Lifted Spear.<br>";
			}
		}
		//Pastel Poleaxe
		if(this.hasExactly("Pastel Poleaxe") && this.combatStartHp / this.maxHp >= 0.25){
			this.combatSpur.atk += 5;
			this.combatSpur.spd += 5;
			this.combatSpur.def += 5;
			this.combatSpur.res += 5;
			boostText += this.name + " gets +5 to all stats from HP >= 25% with Pastel Poleaxe.<br>";
		}
		//Carrot-Tip Weapons
		if((this.has("Carrot-Tip Bow") || this.has("Carrot-Tip Spear")) && (enemy.combatStartHp / enemy.maxHp >= 0.75 || this.toggle.weapon == 1)){
			this.combatSpur.atk += 5;
			this.combatSpur.def += 5;
			boostText += this.name + " gets +5 to atk and def from enemy HP >= 75% or Penalty being active on enemy with " + data.skills[this.weaponIndex].name + ".<br>";
		}
		//Magic Rabbits
		if(this.hasExactly("Magic Rabbits") && (this.initiator || this.toggle.weapon == 1)){
			this.combatSpur.atk += 4;
			this.combatSpur.spd += 6;
			var bText = "";
			if(this.specialIndex != -1){
				var eAtk = (data.skills[this.specialIndex].charge - this.initSkillCharge()) * 3;
				this.combatSpur.atk += eAtk;
				bText = " and an additional +" + eAtk;
			}
			boostText += this.name + " gets +4" + bText + " atk and +6 spd from initiating or being within 2 spaces of an ally with Magic Rabbits.<br>";
		}
		if(this.hasExactly("Azure Lance")){
			if(this.initiator || this.toggle.weapon == 1 || this.toggle.weapon == 3){
				this.combatSpur.atk += 5;
				this.combatSpur.spd += 5;
				boostText += this.name + " gets +5 to atk and spd from initiating or being within 2 spaces of an ally with Azure Lance.<br>";
			}
			if(this.rValue == 5 && enemy.combatStartHp / enemy.maxHp >= 0.75){
				this.combatSpur.atk += 5;
				this.combatSpur.spd += 5;
				boostText += this.name + " gets +5 to atk and spd from enemy HP >= 75% with Azure Lance.<br>";
			}
		}
		//Refined Prayer Wheel
		if(this.hasExactly("Prayer Wheel") && this.rValue == 5 && this.combatStartHp / this.maxHp >= 0.25){
			this.combatSpur.atk += 5;
			this.combatSpur.spd += 5;
			boostText += this.name + " gets +5 to atk and spd from HP >= 25% with Prayer Wheel.<br>";
		}
		//Refined Breath of Blight
		if(this.hasExactly("Breath of Blight") && this.rValue > 0){
			if(this.combatStartHp / this.maxHp >= 0.25){
				this.combatSpur.atk += 5;
				enemy.combatSpur.atk -= 5;
				boostText += this.name + " gets +5 to atk and inflicts -5 atk to " + enemy.name + " from HP >= 25% with Breath of Blight.<br>";
			}
			if(this.rValue == 5 && (enemy.combatStartHp / enemy.maxHp >= 0.75 || !this.initiator)){
				this.combatSpur.atk += 5;
				enemy.combatSpur.atk -= 5;
				boostText += this.name + " gets +5 to atk and inflicts -5 atk to " + enemy.name + " from enemy initiating or enemy HP >= 75% with Breath of Blight.<br>";
			}
		}
		//Quick Mulagir
		if(this.hasExactly("Quick Mulagir")){
			if(this.initiator || this.toggle.weapon == 1){
				this.combatSpur.atk += 5;
				this.combatSpur.spd += 5;
				boostText += this.name + " gets +5 to atk and spd from initiating or being within 2 spaces of an ally with Quick Mulagir.<br>";
			}
			if(this.rValue == 5 && this.combatStartHp / this.maxHp >= 0.25){
				this.combatSpur.atk += 5;
				this.combatSpur.spd += 5;
				boostText += this.name + " gets +5 to atk and spd from HP >= 25% with Quick Mulagir.<br>";
			}
		}
		//Allied weapon
		if((this.has("Allied Lance") || this.has("Allied Sword") || this.has("Allied Axe")) && this.toggle.weapon == 1){
			this.combatSpur.atk += 4;
			this.combatSpur.def += 4;
			boostText += this.name + " gets +4 to atk and def from being within 2 spaces of an ally with " + data.skills[this.weaponIndex].name + ".<br>";
		}
		//Ascending Blade
		if(this.hasExactly("Ascending Blade") && this.combatStartHp / this.maxHp >= 0.25){
			this.combatSpur.atk += 5;
			this.combatSpur.spd += 5;
			this.combatSpur.def += 5;
			this.combatSpur.res += 5;
			boostText += this.name + " gets +5 to all stats from HP >= 25% with Ascending Blade.<br>";
		}
		//Lands Sword
		if(this.hasExactly("Lands Sword") && this.combatStartHp / this.maxHp >= 0.25){
			this.combatSpur.atk += 6;
			this.combatSpur.spd += 6;
			boostText += this.name + " gets +6 to atk and spd from HP >= 25% with Lands Sword.<br>";
		}
		//Refined Hawk King Claw
		if(this.hasExactly("Hawk King Claw") && this.rValue > 0){
			if(this.transform == true || enemy.combatStartHp / enemy.maxHp >= 0.75){
				this.combatSpur.atk += 5;
				this.combatSpur.def += 5;
				boostText += this.name + " gets +5 to atk and def from enemy HP >= 75% or being transformed with Hawk King Claw.<br>";
			}
			if(this.rValue == 5 && this.combatStartHp / this.maxHp >= 0.25){
				this.combatSpur.atk += 5;
				this.combatSpur.def += 5;
				boostText += this.name + " gets +5 to atk and def from HP >= 25% with Hawk King Claw.<br>";
			}
		}
		//Vedrfolnir's Egg
		if(this.hasExactly("Vedrfolnir's Egg")){
			if(this.rValue < 0 && this.combatStartHp / this.maxHp >= 0.75){
				this.combatSpur.atk += 4;
				this.combatSpur.spd += 4;
				this.combatSpur.def += 4;
				this.combatSpur.res += 4;
				boostText += this.name + " gets +4 to all stats from HP >= 75% with Vedrfolnir's Egg.<br>";
			}
			if(this.rValue > 0 && this.combatStartHp / this.maxHp >= 0.25){
				this.combatSpur.atk += 4;
				this.combatSpur.spd += 4;
				this.combatSpur.def += 4;
				this.combatSpur.res += 4;
				boostText += this.name + " gets +4 to all stats from HP >= 25% with Vedrfolnir's Egg.<br>";
			}
			if(this.rValue == 5 && this.toggle.weapon > 0){
				this.combatSpur.atk += 5;
				this.combatSpur.spd += 5;
				boostText += this.name + " gets +5 to atk and spd from being within 3 spaces of an ally with Vedrfolnir's Egg.<br>";
			}
		}
		//Sharp War Sword
		if(this.hasExactly("Sharp War Sword") && (this.initiator || this.toggle.weapon == 1)){
			this.combatSpur.atk += 5;
			this.combatSpur.spd += 5;
			this.combatSpur.def += 5;
			this.combatSpur.res += 5;
			boostText += this.name + " gets +5 to all stats from initiating or being within 2 spaces of an ally with Sharp War Sword.<br>";
		}
		//Adroit War Tome
		if(this.hasExactly("Adroit War Tome") && this.combatStartHp / this.maxHp >= 0.25){
			this.combatSpur.atk += 6;
			this.combatSpur.res += 6;
			boostText += this.name + " gets +6 to atk and res from HP >= 25% with Adroit War Tome.<br>";
		}
		if(this.hasExactly("Sturdy War Sword") && this.combatStartHp / this.maxHp >= 0.25){
			this.combatSpur.atk += 5;
			this.combatSpur.spd += 5;
			this.combatSpur.def += 5;
			this.combatSpur.res += 5;
			boostText += this.name + " gets +5 to all stats from HP >= 25% with Sturdy War Sword.<br>";
		}
		if(this.hasExactly("Large War Axe")){
			if(currTurn % 2 == 1){//odd turns
				this.combatSpur.atk += 10;
				this.combatSpur.spd += 10;
				if(this.penalty.panic){
					this.combatBuffs.atk = 0;
					this.combatBuffs.spd = 0;
					this.buffs.atk = 0;
					this.buffs.spd = 0;
				}
				this.combatDebuffs.atk = 0;
				this.combatDebuffs.spd = 0;
				this.debuffs.atk = 0;
				this.debuffs.spd = 0;
				boostText += this.name + " gets +10 to atk and spd and neutralizes penalties to atk and spd from being an odd-numbered turn.<br>";
			}
			else{
				this.combatSpur.atk += 5;
				this.combatSpur.spd += 5;
				boostText += this.name + " gets +5 to atk and spd from being an even-numbered turn.<br>";
			}
		}
		if(this.hasExactly("Thunderer Tome") && (this.combatStartHp / this.maxHp < 1 || currTurn < 4)){
			this.combatSpur.atk += 6;
			this.combatSpur.spd += 6;
			boostText += this.name + " gets +6 to atk and spd from turn being 1-3 or HP < 100% with Thunderer Tome.<br>";
		}
		if(this.hasExactly("Thunder's Mjolnir") && this.combatStartHp / this.maxHp >= 0.25){
			this.combatSpur.atk += 6;
			this.combatSpur.spd += 6;
			boostText += this.name + " gets +6 to atk and spd from HP >= 25% with Thunder's Mjolnir.<br>";
		}
		if(this.hasExactly("Fiery Bolganone") && (this.initiator || this.toggle.weapon == 2 || this.toggle.weapon == 3)){
			this.combatSpur.atk += 6;
			this.combatSpur.res += 6;
			boostText += this.name + " gets +6 to atk and res from initiating or not being adjacent to an ally with Fiery Bolganone.<br>";
		}
		if(this.hasExactly("Silent Power") && this.combatStartHp / this.maxHp >= 0.25){
			this.combatSpur.atk += 5;
			this.combatSpur.spd += 5;
			this.combatSpur.def += 5;
			this.combatSpur.res += 5;
			boostText += this.name + " gets +5 to all stats from HP >= 25% with Silent Power.<br>";
		}
		if(this.hasExactly("Enveloping Breath") && this.combatStartHp / this.maxHp >= 0.25){
			this.combatSpur.spd += 6;
			this.combatSpur.res += 6;
			boostText += this.name + " gets +6 to spd and res from HP >= 25% with Enveloping Breath.<br>";
		}
		if(this.hasExactly("Ruinous Frost") && (!this.initiator || enemy.combatStartHp / enemy.maxHp >= 0.75)){
			this.combatSpur.atk += 6;
			enemy.combatSpur.atk -= 6;
			boostText += this.name + " gets +6 to atk and inflicts -6 atk to " + enemy.name + " from enemy initiating or enemy HP >= 75% with Ruinous Frost.<br>";
		}
		if(this.hasExactly("Wild Tiger Fang") && enemy.combatStartHp / enemy.maxHp >= 0.75){
			this.combatSpur.atk += 6;
			this.combatSpur.spd += 6;
			boostText += this.name + " gets +6 to atk and spd from enemy HP >= 75% with Wild Tiger Fang.<br>";
		}
		if(this.hasExactly("Imhullu") && this.rValue > 0){
			if(this.initiator || this.toggle.weapon == 1){
				this.combatSpur.atk += 5;
				this.combatSpur.spd += 5;
				boostText += this.name + " gets +5 to atk and spd from initiating or not being adjacent to an ally with Imhullu.<br>";
			}
			if(this.rValue == 5 && this.combatStartHp / this.maxHp >= 0.25){
				this.combatSpur.atk += 5;
				this.combatSpur.spd += 5;
				boostText += this.name + " gets +5 to atk and spd from HP >= 25% with Imhullu.<br>";
			}
		}
		if(this.hasExactly("Icy Maltet")){
			if(!this.initiator || enemy.combatStartHp / enemy.maxHp >= 0.75){
				var buffVal = 4;
				if(this.dragonflower > 0){
					buffVal = 5;
				}
				this.combatSpur.atk += buffVal;
				this.combatSpur.spd += buffVal;
				this.combatSpur.def += buffVal;
				this.combatSpur.res += buffVal;
				boostText += this.name + " gets +" + buffVal + " to all stats from enemy initiating or enemy HP >= 75% with Icy Maltet.<br>";
			}
			if(this.rValue == 5 && this.toggle.weapon == 1){
				this.combatSpur.atk += 4;
				this.combatSpur.spd += 4;
				this.combatSpur.def += 4;
				this.combatSpur.res += 4;
				boostText += this.name + " gets +4 to all stats from being within 3 spaces of an ally with Icy Maltet.<br>";
			}
		}
		if(this.hasExactly("Eldhrimnir")){
			if(allStats[19] + this.getPhantom("Res") > allStats[23] + enemy.getPhantom("Res")){
				var diffVal = 0;
				if(this.rValue < 0){
					diffVal = Math.floor((allStats[19] - allStats[23]) / 2);
				}
				else{
					diffVal = Math.floor((allStats[19] - allStats[23]) * 0.8);
				}
				diffVal = Math.min(8, diffVal);
				enemy.combatSpur.atk -= diffVal;
				enemy.combatSpur.spd -= diffVal;
				var dPlus = "";
				if(this.rValue > 0){
					enemy.combatSpur.def -= diffVal;
					dPlus = " and def";
				}
				boostText += this.name + " has activated Eldhrimnir. Effect on " + enemy.name + ": -" + diffVal + " to atk and spd" + dPlus + ".<br>";
			}
			if(this.rValue > 0 && this.combatStartHp / this.maxHp >= 0.25){
				this.combatSpur.atk += 4;
				this.combatSpur.spd += 4;
				this.combatSpur.def += 4;
				this.combatSpur.res += 4;
				boostText += this.name + " gets +4 to all stats from HP >= 25% with Eldhrimnir.<br>";
			}
			if(this.rValue == 5 && (!this.initiator || enemy.combatStartHp / enemy.maxHp >= 0.75)){
				this.combatSpur.atk += 4;
				this.combatSpur.spd += 4;
				this.combatSpur.def += 4;
				this.combatSpur.res += 4;
				boostText += this.name + " gets +4 to all stats from enemy initiating or enemy HP >= 75% with Eldhrimnir.<br>";
			}
		}
		if(this.has("Kitsune Fang") && this.rValue > 0){
			if(this.toggle.weapon > 0){
				this.combatSpur.atk += 5;
				this.combatSpur.spd += 5;
				boostText += this.name + " gets +5 to atk and spd from being within 3 spaces of an ally with Kitsune Fang.<br>";
			}
			if(this.rValue == 5){
				if(this.toggle.weapon > 0){
					this.combatSpur.atk += 5;
					this.combatSpur.spd += 5;
					boostText += this.name + " gets +5 to atk and spd from being within 3 spaces of an ally with Kitsune Fang.<br>";
				}
				if(this.toggle.weapon == 2){
					this.combatSpur.def += 2;
					this.combatSpur.res += 2;
					boostText += this.name + " gets +2 to def and res from being within 2 spaces of an ally with Kitsune Fang.<br>";
				}
			}
		}
		if(this.hasExactly("True-Love Roses") && (this.initiator || this.toggle.weapon == 1)){
			this.combatSpur.atk += 6;
			this.combatSpur.res += 6;
			boostText += this.name + " gets +6 to atk and res from initiating or being within 2 spaces of an ally with True-Love Roses.<br>";
		}
		//+5 all stats when HP >= 25%
		if((this.hasExactly("Dragon Bouquet") || this.hasExactly("Everliving Breath")) && this.combatStartHp / this.maxHp >= 0.25){
			this.combatSpur.atk += 5;
			this.combatSpur.spd += 5;
			this.combatSpur.def += 5;
			this.combatSpur.res += 5;
			boostText += this.name + " gets +5 to all stats from HP >= 25% with " + data.skills[this.weaponIndex].name + ".<br>";
		}
		if(this.has("Bridal Orchid") && this.combatStartHp / this.maxHp >= 0.25){
			this.combatSpur.atk += 5;
			this.combatSpur.res += 5;
			boostText += this.name + " gets +5 to atk and res from HP >= 25% with " + data.skills[this.weaponIndex].name + ".<br>";
		}
		if(this.has("Bridal Sunflower") && this.combatStartHp / this.maxHp >= 0.25){
			this.combatSpur.atk += 5;
			this.combatSpur.def += 5;
			boostText += this.name + " gets +5 to atk and def from HP >= 25% with " + data.skills[this.weaponIndex].name + ".<br>";
		}
		if(this.hasExactly("Blazing Polearms") && (this.initiator || this.toggle.weapon == 1)){
			this.combatSpur.atk += 5;
			this.combatSpur.spd += 5;
			this.combatSpur.def += 5;
			this.combatSpur.res += 5;
			boostText += this.name + " gets +5 to all stats from initiating or or being within 2 spaces of an ally with Blazing Polearms.<br>";
			
			var tStats = 0;
			if(!allStats[14][0]){
				tStats += Math.max(this.combatBuffs.atk,this.buffs.atk);
			}
			if(!allStats[14][1]){
				tStats += Math.max(this.combatBuffs.spd,this.buffs.spd);
			}
			if(!allStats[14][2]){
				tStats += Math.max(this.combatBuffs.def,this.buffs.def);
			}
			if(!allStats[14][3]){
				tStats += Math.max(this.combatBuffs.res,this.buffs.res);
			}
			tStats = Math.floor(tStats * 0.5);
			tStats = Math.min(tStats, 6);
			enemy.combatSpur.atk -= tStats;
			enemy.combatSpur.spd -= tStats;
			enemy.combatSpur.def -= tStats;
			enemy.combatSpur.res -= tStats;
			boostText += this.name + " has activated Blazing Polearms. Effect on " + enemy.name + ": -" + tStats + " to all stats.<br>";
		}
		if(this.hasExactly("Faith in Humanity") && this.toggle.c > 1){
			this.support.nullGuard = true;
			boostText += this.name + " activates Tempo from having 2 or more human allies active with >= 10 total bonuses with Faith in Humanity.<br>";
		}
		if(this.hasExactly("Saehrimnir")){
			if(allStats[19] + this.getPhantom("Res") > allStats[23] + enemy.getPhantom("Res")){
				var diffVal = 0;
				if(this.rValue < 0){
					diffVal = Math.floor((allStats[19] - allStats[23]) / 2);
				}
				else{
					diffVal = Math.floor((allStats[19] - allStats[23]) * 0.8);
				}
				diffVal = Math.min(8, diffVal);
				enemy.combatSpur.atk -= diffVal;
				enemy.combatSpur.def -= diffVal;
				var sPlus = "";
				if(this.rValue > 0){
					enemy.combatSpur.spd -= diffVal;
					sPlus = " and spd";
				}
				boostText += this.name + " has activated Saehrimnir. Effect on " + enemy.name + ": -" + diffVal + " to atk" + sPlus + " and def.<br>";
			}
			if(this.rValue > 0 && this.combatStartHp / this.maxHp >= 0.25){
				this.combatSpur.atk += 4;
				this.combatSpur.spd += 4;
				this.combatSpur.def += 4;
				this.combatSpur.res += 4;
				boostText += this.name + " gets +4 to all stats from HP >= 25% with Saehrimnir.<br>";
			}
			if(this.rValue == 5 && this.toggle.weapon == 1){
				this.combatSpur.atk += 4;
				this.combatSpur.spd += 4;
				this.combatSpur.def += 4;
				this.combatSpur.res += 4;
				boostText += this.name + " gets +4 to all stats from being within 3 spaces of an ally with Saehrimnir.<br>";
			}
		}
		if(this.hasExactly("Raven King Beak")){
			if(this.rValue > 0 && (this.initiator || enemy.combatStartHp / enemy.maxHp >= 0.75)){
				this.combatSpur.atk += 5;
				this.combatSpur.spd += 5;
				boostText += this.name + " gets +5 to atk and spd from initiating or enemy HP >= 75% with Raven King Beak.<br>";
			}
			if(this.rValue == 5 && (this.transform == true || enemy.combatStartHp / enemy.maxHp >= 0.75)){
				this.combatSpur.atk += 5;
				this.combatSpur.spd += 5;
				boostText += this.name + " gets +5 to atk and spd from being transformed or enemy HP >= 75% with Raven King Beak.<br>";
			}
		}
		if(this.has("Covert Cat Fang")){
			if(this.rValue < 0 && this.toggle.weapon == 1){
				this.combatSpur.atk += 3;
				this.combatSpur.def += 3;
				boostText += this.name + " gets +3 to atk and def from being within 2 spaces of an ally with Covert Cat Fang.<br>";
			}
			if(this.rValue > 0 && (this.initiator || this.toggle.weapon > 0)){
				this.combatSpur.atk += 4;
				this.combatSpur.spd += 4;
				this.combatSpur.def += 4;
				this.combatSpur.res += 4;
				boostText += this.name + " gets +4 to all stats from initiating or being within 3 spaces of an ally with Covert Cat Fang.<br>";
			}
			if(this.rValue == 5 && this.combatStartHp / this.maxHp >= 0.25){
				this.combatSpur.atk += 4;
				this.combatSpur.spd += 4;
				this.combatSpur.def += 4;
				this.combatSpur.res += 4;
				boostText += this.name + " gets +4 to all stats from HP >= 25% with Covert Cat Fang.<br>";
			}
		}
		if(this.hasExactly("Wolfpup Fang") && this.rValue > 0){
			if(this.initiator || this.toggle.weapon == 1 || this.toggle.weapon == 3){
				this.combatSpur.atk += 5;
				this.combatSpur.spd += 5;
				boostText += this.name + " gets +5 to atk and spd from initiating or being within 2 spaces of an ally with Wolfpup Fang.<br>";
			}
			if(this.rValue == 5 && (this.transform == true || enemy.combatStartHp / enemy.maxHp >= 0.75)){
				this.combatSpur.atk += 5;
				this.combatSpur.spd += 5;
				boostText += this.name + " gets +5 to atk and spd from being transformed or enemy HP >= 75% with Wolfpup Fang.<br>";
			}
		}
		if(this.hasExactly("New-Height Bow") && this.toggle.weapon == 1){
			this.combatSpur.atk += 6;
			this.combatSpur.spd += 6;
			boostText += this.name + " gets +6 to atk and spd from being within 3 spaces of an ally with New-Height Bow.<br>";
		}
		if(this.hasExactly("Jolly Jade Lance") && (this.initiator || this.toggle.weapon == 1)){
			this.combatSpur.atk += 6;
			this.combatSpur.spd += 6;
			boostText += this.name + " gets +6 to atk and spd from initiating or being within 2 spaces of an ally with Jolly Jade Lance.<br>";
		}
		if(this.hasExactly("Kormt") && this.combatStartHp / this.maxHp >= 0.25){
			this.combatSpur.atk += 6;
			enemy.combatSpur.atk -= 6;
			boostText += this.name + " gets +6 atk and inflicts -6 atk to " + enemy.name + " from HP >= 25% with Kormt.<br>";
			if(this.toggle.weapon > 0){
				var dVal = this.toggle.weapon * 3;
				enemy.combatSpur.atk -= dVal;
				enemy.combatSpur.spd -= dVal;
				enemy.combatSpur.def -= dVal;
				enemy.combatSpur.res -= dVal;
				boostText += this.name + " inflicts -" + dVal + " to all stats to " + enemy.name + " from HP >= 25% and having applied " + this.toggle.weapon + " condition(s) with Kormt.<br>";
			}
		}
		if(this.hasExactly("Unyielding Oar") && this.combatStartHp / this.maxHp >= 0.25){
			this.combatSpur.atk += 5;
			this.combatSpur.spd += 5;
			this.combatSpur.def += 5;
			this.combatSpur.res += 5;
			boostText += this.name + " gets +5 to all stats from HP >= 25% with Unyielding Oar.<br>";
		}
		if(this.hasExactly("Moonlight Drop") && (this.initiator || this.toggle.weapon == 1)){
			this.combatSpur.atk += 6;
			this.combatSpur.res += 6;
			boostText += this.name + " gets +6 to atk and res from initiating or or being within 2 spaces of an ally with Moonlight Drop.<br>";
		}
		if(this.hasExactly("Frozen Delight") && (this.initiator || this.toggle.weapon == 1)){
			this.combatSpur.atk += 6;
			this.combatSpur.spd += 6;
			boostText += this.name + " gets +6 to atk and spd from initiating or or being within 2 spaces of an ally with Frozen Delight.<br>";
		}
		if(this.hasExactly("Regal Sunshade") && this.combatStartHp / this.maxHp >= 0.25){
			this.combatSpur.atk += 6;
			enemy.combatSpur.atk -= 6;
			boostText += this.name + " gets +6 atk and inflicts -6 atk to " + enemy.name + " from HP >= 25% with Regal Sunshade.<br>";
		}
		if((this.has("Whitecap Bow") || this.has("Miasma Dagger")) && this.combatStartHp / this.maxHp >= 0.25){
			this.combatSpur.atk += 5;
			this.combatSpur.spd += 5;
			boostText += this.name + " gets +5 to atk and spd from HP >= 25% with " + data.skills[this.weaponIndex].name + ".<br>";
		}
		if(this.hasExactly("Ebon Bolverk")){
			if(this.initiator || this.buddy.adjacent > 0 || this.buddy.two > 0){
				this.combatSpur.atk += 5;
				this.combatSpur.spd += 5;
				this.combatSpur.def += 5;
				this.combatSpur.res += 5;
				boostText += this.name + " gets +5 to all stats from initiating or or being within 2 spaces of an ally with Ebon Bolverk.<br>";
			}
			if(this.rValue == 5 && this.combatStartHp / this.maxHp >= 0.25){
				var ebVal = Math.min(this.buddy.erorc * 2 + 5, 11);
				this.combatSpur.atk += ebVal;
				this.combatSpur.spd += ebVal;
				this.combatSpur.def += ebVal;
				this.combatSpur.res += ebVal;
				if(this.penalty.panic){
					this.combatBuffs.atk = 0;
					this.combatBuffs.spd = 0;
					this.buffs.atk = 0;
					this.buffs.spd = 0;
				}
				this.combatDebuffs.atk = 0;
				this.combatDebuffs.spd = 0;
				this.debuffs.atk = 0;
				this.debuffs.spd = 0;
				boostText += this.name + " gets +" + ebVal + " to all stats and neutralizes penalties to atk & spd from HP >= 25% with Ebon Bolverk.<br>";
			}
		}
		if(this.hasExactly("Dragonbind") && this.rValue == 5 && this.combatStartHp / this.maxHp >= 0.25){
			this.combatSpur.atk += 4;
			this.combatSpur.spd += 4;
			this.combatSpur.def += 4;
			this.combatSpur.res += 4;
			boostText += this.name + " gets +4 to all stats from HP >= 25% with Dragonbind.<br>";
		}
		if(this.hasExactly("Shadow Sword") && this.rValue > 0){
			if(this.combatStartHp / this.maxHp >= 0.25){
				this.combatSpur.atk += 5;
				this.combatSpur.spd += 5;
				boostText += this.name + " gets +5 to atk and spd from HP >= 25% with Shadow Sword.<br>";
			}
			if(this.rValue == 5 && enemy.combatStartHp / enemy.maxHp >= 0.75){
				this.combatSpur.atk += 5;
				this.combatSpur.spd += 5;
				var esText = "Def";
				if(allStats[21] > allStats[22]){
					esText = "Spd";
					enemy.combatSpur.spd -= 8;
				}
				else{
					enemy.combatSpur.def -= 8;
				}
				boostText += this.name + " gets +5 to atk and spd and inflicts -8 " + esText + " to " + enemy.name + " from Enemy HP >= 75% with Shadow Sword.<br>";
			}
		}
		if(this.hasExactly("Heartbeat Lance")){
			if(this.combatStartHp / this.maxHp >= 0.25){
				enemy.combatSpur.atk -= 5;
				enemy.combatSpur.def -= 5;
				boostText += this.name + " has activated Heartbeat Lance. Effect on " + enemy.name + ": -5 to atk and def.<br>";
			}
			if(this.rValue == 5 && (!this.initiator || enemy.combatStartHp / enemy.maxHp >= 0.75)){
				var hCount = 0;
				if(this.maxHp > enemy.maxHp){
					hCount++;
				}
				if(allStats[16] > allStats[20]){
					hCount++;
				}
				if(allStats[17] > allStats[21]){
					hCount++;
				}
				if(allStats[18] > allStats[22]){
					hCount++;
				}
				if(allStats[19] > allStats[23]){
					hCount++;
				}
				var redVal = (hCount * 5 + 10) / 100;
				redVal = Math.floor(redVal * allStats[20]) + 5;
				enemy.combatSpur.atk -= redVal;
				enemy.combatSpur.def -= 5;
				boostText += this.name + " has activated Heartbeat Lance. Effect on " + enemy.name + ": -" + redVal + " to atk and -5 to def.<br>";
			}
		}
		if(this.hasExactly("Sabertooth Fang") && this.rValue > 0){
			if(enemy.combatStartHp / enemy.maxHp >= 0.75){
				this.combatSpur.atk += 5;
				this.combatSpur.def += 5;
				boostText += this.name + " gets +5 to atk and def from Enemy HP >= 75% with Sabertooth Fang.<br>";
			}
			if(this.rValue == 5 && this.toggle.weapon > 1){
				this.combatSpur.atk += 5;
				this.combatSpur.def += 5;
				boostText += this.name + " gets +5 to atk and def from being within 3 spaces of an ally with Sabertooth Fang.<br>";
			}
		}
		if(this.hasExactly("Gjallarbru") && this.rValue == 5 && this.toggle.weapon == 1){
			this.combatSpur.atk += 4;
			this.combatSpur.spd += 4;
			boostText += this.name + " gets +4 to atk and spd from being within 3 spaces of an ally with Gjallarbru.<br>";
		}
		if((this.hasExactly("Caring Conch") || this.hasExactly("Tri-Edge Lance")) && (this.initiator || this.buddy.adjacent > 0 || this.buddy.two > 0)){
			this.combatSpur.atk += 5;
			this.combatSpur.spd += 5;
			this.combatSpur.def += 5;
			this.combatSpur.res += 5;
			boostText += this.name + " gets +5 to all stats from initiating or or being within 2 spaces of an ally with " + data.skills[this.weaponIndex].name + ".<br>";
		}
		if(this.hasExactly("Chilled Breath") && (this.initiator || this.toggle.weapon == 1)){
			this.combatSpur.atk += 6;
			this.combatSpur.spd += 6;
			boostText += this.name + " gets +6 to atk and spd from initiating or or being within 2 spaces of an ally with Chilled Breath.<br>";
		}
		if((this.has("Coral Saber") || this.has("Seahorse Axe") || this.has("Pursual Lance") || this.has("Pursual Axe")) && (this.initiator || this.toggle.weapon == 1)){
			this.combatSpur.atk += 5;
			this.combatSpur.def += 5;
			boostText += this.name + " gets +5 to atk and def from initiating or or being within 2 spaces of an ally with " + data.skills[this.weaponIndex].name + ".<br>";
		}
		if(this.hasExactly("Divine Whimsy") && this.combatStartHp / this.maxHp >= 0.25){
			this.combatSpur.atk += 6;
			enemy.combatSpur.atk -= 6;
			boostText += this.name + " gets +6 atk and inflicts -6 atk to " + enemy.name + " from HP >= 25% with Divine Whimsy.<br>";
		}
		if(this.hasExactly("Mila's Testament") && (this.initiator || this.toggle.weapon == 1)){
			this.combatSpur.atk += 6;
			this.combatSpur.spd += 6;
			boostText += this.name + " gets +6 to atk and spd from initiating or being within 2 spaces of an ally with Mila's Testament.<br>";
		}
		if(this.hasExactly("Everliving Domain") && this.toggle.c == 1){
			this.combatSpur.def += 4;
			this.combatSpur.res += 4;
			boostText += this.name + " gets +4 to def and res from being within 2 spaces of an ally with Everliving Domain.<br>";
		}
		//Everliving Domain (Outside Help)
		if(this.support.everliving == true){
			this.combatSpur.def += 4;
			this.combatSpur.res += 4;
			boostText += this.name + " gets +4 to def and res from being within 2 spaces of ally Ymir.<br>";
		}
		if(this.support.revive == true){
			this.combatSpur.atk += 4;
			this.combatSpur.spd += 4;
			this.combatSpur.def += 4;
			this.combatSpur.res += 4;
			boostText += this.name + " gets +4 to all stats from being within 2 spaces of ally Maria (Fell).<br>";
		}
		if(this.hasExactly("Illuminating Horn") && (this.initiator || this.toggle.weapon == 1)){
			this.combatSpur.atk += 5;
			this.combatSpur.spd += 5;
			this.combatSpur.def += 5;
			this.combatSpur.res += 5;
			boostText += this.name + " gets +5 to all stats from initiating or being within 2 spaces of an ally with Illuminating Horn.<br>";
		}
		if(this.hasExactly("Wanderer Blade")){
			if(enemy.combatStartHp / enemy.maxHp >= 0.75){
				this.combatSpur.atk += 5;
				this.combatSpur.spd += 5;
				boostText += this.name + " gets +5 to atk and spd from enemy HP >= 75% with Wanderer Blade.<br>";
			}
			if(this.rValue == 5 && this.combatStartHp / this.maxHp >= 0.25){
				this.combatSpur.atk += 5;
				this.combatSpur.spd += 5;
				boostText += this.name + " gets +5 to atk and spd from HP >= 25% with Wanderer Blade.<br>";
			}
		}
		if(this.hasExactly("Divine Breath") && this.rValue == 5 && this.toggle.weapon > 0){
			this.combatSpur.atk += 4;
			this.combatSpur.spd += 4;
			this.combatSpur.def += 4;
			this.combatSpur.res += 4;
			boostText += this.name + " gets +4 to all stats from being within 3 spaces of an ally with Divine Breath.<br>";
		}
		if(this.hasExactly("Worldsea Wave") && this.rValue > 0){
			if(this.combatStartHp / this.maxHp >= 0.25){
				this.combatSpur.atk += 5;
				this.combatSpur.spd += 5;
				boostText += this.name + " gets +5 to atk and spd from HP >= 25% with Worldsea Wave.<br>";
			}
			if(this.rValue == 5 && (this.initiator || this.toggle.weapon == 1)){
				this.combatSpur.atk += 5;
				this.combatSpur.spd += 5;
				boostText += this.name + " gets +5 to atk and spd from initiating or being within 2 spaces of an ally with Worldsea Wave.<br>";
			}
		}
		if(this.hasExactly("Lion King Fang")){
			if(!this.initiator || (this.rValue > 0 && enemy.combatStartHp / enemy.maxHp >= 0.75)){
				this.combatSpur.atk += 4;
				this.combatSpur.spd += 4;
				this.combatSpur.def += 4;
				this.combatSpur.res += 4;
				var eText = "";
				if(this.rValue > 0){
					eText = " or Enemy HP >= 75%";
				}
				boostText += this.name + " gets +4 to all stats from enemy initiating" + eText + " with Lion King Fang.<br>";
			}
			if(this.rValue == 5 && this.combatStartHp / this.maxHp >= 0.25){
				enemy.combatSpur.atk -= 5;
				enemy.combatSpur.def -= 5;
				boostText += this.name + " inflicts -5 atk and def to " + enemy.name + " from HP >= 25%";
				if(this.transform == true){
					var eaVal = Math.floor(allStats[20] * 0.25) - 8;
					eaVal = Math.min(eaVal,10);
					eaVal = Math.max(eaVal,0);
					this.combatSpur.atk += eaVal;
					this.combatSpur.def += eaVal;
					this.combatSpur.res += eaVal;
					boostText += " and gets +" + eaVal + " to atk/def/res from transforming";
				}
				boostText += " with Lion King Fang.<br>";
			}
		}
		if(this.hasExactly("Luna Arc") && this.rValue > 0){
			if(this.initiator || this.toggle.weapon == 1){
				this.combatSpur.atk += 5;
				this.combatSpur.spd += 5;
				boostText += this.name + " gets +5 to atk and spd from from initiating or being within 2 spaces of an ally with Luna Arc.<br>";
			}
			if(this.rValue == 5 && this.combatStartHp / this.maxHp >= 0.25){
				this.combatSpur.atk += 5;
				this.combatSpur.spd += 5;
				boostText += this.name + " gets +5 to atk and spd from HP >= 25% with Luna Arc.<br>";
			}
		}
		if(this.hasExactly("Lofty Leaflet") && enemy.combatStartHp / enemy.maxHp >= 0.5){
			this.combatSpur.atk += 6;
			this.combatSpur.spd += 6;
			boostText += this.name + " gets +6 to atk and spd from enemy HP >= 50% with Lofty Leaflet.<br>";
			if(checkAllBuffs(enemy, this, currTurn) && allStats[9]){
				var extraStats = [0,0,0,0];
				var buffText = "";
				var debuffText = "";
				if(!allStats[15][0]){
					extraStats[0] = Math.max(enemy.buffs.atk,enemy.combatBuffs.atk);
					if(extraStats[0] > 0){
						this.combatSpur.atk += extraStats[0];
						enemy.combatSpur.atk -= extraStats[0];
						buffText += " +" + extraStats[0] + " atk";
						debuffText += " -" + extraStats[0] + " atk";
					}
				}
				if(!allStats[15][1]){
					extraStats[1] = Math.max(enemy.buffs.spd,enemy.combatBuffs.spd);
					if(extraStats[1] > 0){
						this.combatSpur.spd += extraStats[1];
						enemy.combatSpur.spd -= extraStats[1];
						buffText += " +" + extraStats[1] + " spd";
						debuffText += " -" + extraStats[1] + " spd";
					}
				}
				if(!allStats[15][2]){
					extraStats[2] = Math.max(enemy.buffs.def,enemy.combatBuffs.def);
					if(extraStats[2] > 0){
						this.combatSpur.def += extraStats[2];
						enemy.combatSpur.def -= extraStats[2];
						buffText += " +" + extraStats[2] + " def";
						debuffText += " -" + extraStats[2] + " def";
					}
				}
				if(!allStats[15][3]){
					extraStats[3] = Math.max(enemy.buffs.res,enemy.combatBuffs.res);
					if(extraStats[3] > 0){
						this.combatSpur.res += extraStats[3];
						enemy.combatSpur.res -= extraStats[3];
						buffText += " +" + extraStats[3] + " res";
						debuffText += " -" + extraStats[3] + " res";
					}
				}
				boostText += this.name + " gets" + buffText + " and inflicts" + debuffText + " to " + enemy.name + " from enemy HP >= 50% and enemy having buffs with Lofty Leaflet.<br>";
			}
		}
		if(this.hasExactly("Soothing Scent") && this.combatStartHp / this.maxHp >= 0.25){
			this.combatSpur.atk += 6;
			this.combatSpur.spd += 6;
			boostText += this.name + " gets +6 to atk and spd from HP >= 25% with Soothing Scent.<br>";
		}
		if((this.has("Florid Knife") || this.has("Florid Cane")) && enemy.combatStartHp / enemy.maxHp >= 0.75){
			this.combatSpur.atk += 5;
			this.combatSpur.spd += 5;
			boostText += this.name + " gets +5 to atk and spd from enemy HP >= 75% with " + data.skills[this.weaponIndex].name + ".<br>";
		}
		if(this.hasExactly("Shadowy Quill") && (this.initiator || this.toggle.weapon == 1)){
			this.combatSpur.atk += 6;
			this.combatSpur.spd += 6;
			boostText += this.name + " gets +6 to atk and spd from initiating or being within 2 spaces of an ally with Shadowy Quill.<br>";
		}
		if(this.hasExactly("Inner Wellspring")){
			if(this.initiator || this.buddy.adjacent > 0 || this.buddy.two > 0){
				this.combatSpur.atk += 5;
				this.combatSpur.spd += 5;
				this.combatSpur.def += 5;
				this.combatSpur.res += 5;
				boostText += this.name + " gets +5 to all stats from initiating or being within 2 spaces of an ally with Inner Wellspring.<br>";
			}
			if(this.rValue == 5 && this.combatStartHp / this.maxHp >= 0.25){
				var iwVal = Math.floor(allStats[17] * 0.1) + 5;
				this.combatSpur.atk += iwVal;
				this.combatSpur.spd += iwVal;
				this.combatSpur.def += iwVal;
				this.combatSpur.res += iwVal;
				boostText += this.name + " gets +" + iwVal + " to all stats from HP >= 25% with Inner Wellspring.<br>";
			}
		}
		if(this.hasExactly("Holytide Tyrfing")){
			if(this.buddy.spaces > 0){
				this.combatSpur.atk += 5;
				this.combatSpur.spd += 5;
				this.combatSpur.def += 5;
				this.combatSpur.res += 5;
				boostText += this.name + " gets +5 to all stats from unit or enemy initiating combat after moving to a different space with Holytide Tyrfing.<br>";
			}
			if(this.rValue == 5 && this.combatStartHp / this.maxHp >= 0.25){
				var htVal = Math.min(this.buddy.erorc * 2 + 5, 11);
				this.combatSpur.atk += htVal;
				this.combatSpur.spd += htVal;
				this.combatSpur.def += htVal;
				this.combatSpur.res += htVal;
				boostText += this.name + " gets +" + htVal + " to all stats from HP >= 25% with Holytide Tyrfing.<br>";
			}
		}
		if(this.hasExactly("Remote Breath")){
			if(this.buddy.adjacent + this.buddy.two + this.buddy.three > 0){
				this.combatSpur.atk += 5;
				this.combatSpur.spd += 5;
				this.combatSpur.def += 5;
				this.combatSpur.res += 5;
				boostText += this.name + " gets +5 to all stats from being within 3 spaces of an ally with Remote Breath.<br>";
			}
			if(this.rValue == 5 && this.combatStartHp / this.maxHp >= 0.25){
				var rbVal = Math.floor(allStats[19] * 0.1) + 5;
				this.combatSpur.atk += rbVal;
				this.combatSpur.spd += rbVal;
				this.combatSpur.def += rbVal;
				this.combatSpur.res += rbVal;
				boostText += this.name + " gets +" + rbVal + " to all stats from HP >= 25% with Remote Breath.<br>";
			}
		}
		if(this.hasExactly("Geirdriful")){
			if(this.initiator || this.buddy.adjacent > 0 || this.buddy.two > 0){
				var geVal = (Object.values(this.bonus).reduce((a, item) => a + (item === true ? 1 : 0), 0) + this.bonus.extra + Object.values(this.penalty).reduce((a, item) => a + (item === true ? 1 : 0), 0) + this.penalty.extra) * 2 + 5;
				this.combatSpur.atk += geVal;
				this.combatSpur.spd += geVal;
				this.combatSpur.def += geVal;
				this.combatSpur.res += geVal;
				boostText += this.name + " gets +" + geVal + " to all stats from initiating or being within 2 spaces of an ally with Geirdriful.<br>";
			}
			if(this.rValue == 5 && this.combatStartHp / this.maxHp >= 0.25){
				this.combatSpur.atk += 5;
				this.combatSpur.spd += 5;
				this.combatSpur.def += 5;
				this.combatSpur.res += 5;
				boostText += this.name + " gets +5 to all stats from HP >= 25% with Geirdriful.<br>";
			}
		}
		if(this.hasExactly("Moon Gradivus") && this.rValue == 5 && this.toggle.weapon == 1){
			this.combatSpur.spd += 5;
			this.combatSpur.def += 5;
			this.combatSpur.res += 5;
			enemy.combatSpur.def -= 5;
			boostText += this.name + " gets +5 to spd/def/res and inflicts -5 def to " + enemy.name + " from being within 3 spaces of an ally with Moon Gradivus.<br>";
		}
		if(this.hasExactly("Sublime Surge") && this.rValue == 5 && this.combatStartHp / this.maxHp >= 0.25){
			this.combatSpur.atk += 4;
			this.combatSpur.spd += 4;
			this.combatSpur.def += 4;
			this.combatSpur.res += 4;
			boostText += this.name + " gets +4 to all stats from HP >= 25% with Sublime Surge.<br>";
		}
		if(this.hasExactly("Tempest's Claw") && this.rValue == 5 && (this.initiator || this.toggle.weapon == 1)){
			this.combatSpur.atk += 5;
			this.combatSpur.def += 5;
			boostText += this.name + " gets +5 to atk and def from initiating or being within 2 spaces of an ally with Tempest's Claw.<br>";
		}
		if(this.hasExactly("Firelight Lance") && this.combatStartHp / this.maxHp >= 0.25){
			this.combatSpur.atk += 5;
			this.combatSpur.spd += 5;
			this.combatSpur.def += 5;
			this.combatSpur.res += 5;
			boostText += this.name + " gets +5 to all stats from HP >= 25% with Firelight Lance.<br>";
		}
		if(this.hasExactly("Verdict of Sacae") && this.toggle.a > 0){
			var buffVal = this.toggle.a * 4 + 4;
			this.combatSpur.atk += buffVal;
			this.combatSpur.spd += buffVal;
			this.combatSpur.def += buffVal;
			this.combatSpur.res += buffVal;
			boostText += this.name + " gets +" + buffVal + " to all stats from being within 4 spaces of an ally with Verdict of Sacae.<br>";
		}
		if(this.hasExactly("Breath of Flame") && (this.initiator || this.toggle.weapon == 1)){
			this.combatSpur.atk += 6;
			enemy.combatSpur.atk -= 6;
			boostText += this.name + " gets +6 atk and inflicts -6 atk to " + enemy.name + " from initiating or being within 2 spaces of an ally with Breath of Flame.<br>";
		}
		if((this.has("Flame Gunbai") || this.hasExactly("Fiery Fang")) && this.combatStartHp / this.maxHp >= 0.25){
			var uVal = 5;
			if(this.hasExactly("Fiery Fang")){
				uVal++;
			}
			this.combatSpur.atk += uVal;
			this.combatSpur.def += uVal;
			var adVal = Math.floor(allStats[18] * 0.2);
			enemy.combatSpur.atk -= adVal;
			enemy.combatSpur.def -= adVal;
			boostText += this.name + " gets +" + uVal + " atk/def and inflicts -" + adVal + " atk/def to " + enemy.name + " from HP >= 25% with " + data.skills[this.weaponIndex].name + ".<br>";
		}
		if(this.hasExactly("Kindling Taiko") && this.combatStartHp / this.maxHp >= 0.25){
			this.combatSpur.atk += 6;
			this.combatSpur.spd += 6;
			boostText += this.name + " gets +6 to atk and spd from HP >= 25% with Kindling Taiko.<br>";
			if(this.initiator && enemy.color != "red"){
				var uVal = Math.floor(allStats[16] * 0.2);
				this.combatSpur.atk += uVal;
				var eVal = Math.floor(allStats[20] * 0.2);
				enemy.combatSpur.atk -= eVal;
				boostText += this.name + " gets an additional +" + uVal + " to atk and inflicts -" + eVal + " atk to " + enemy.name + " from initiating and enemy not being red with Kindling Taiko.<br>";
			}
		}
		if(this.hasExactly("Wind Genesis") && this.combatStartHp / this.maxHp >= 0.25){
			this.combatSpur.atk += 6;
			this.combatSpur.spd += 6;
			var deVal = 3;
			if(enemy.specialIndex != -1){
				deVal = 11 - ((data.skills[enemy.specialIndex].charge - enemy.initSkillCharge()) * 2);
				deVal = Math.max(deVal,3);
			}
			enemy.combatSpur.spd -= deVal;
			enemy.combatSpur.res -= deVal;
			boostText += this.name + " gets +6 to atk and spd and inflicts -" + deVal + " to spd and res on " + enemy.name + " from HP >= 25% with Wind Genesis.<br>";
		}
		if(this.hasExactly("Fuming Freikugel") && this.toggle.weapon == 1){
			this.combatSpur.atk += 6;
			this.combatSpur.spd += 6;
			boostText += this.name + " gets +6 atk and spd from not being within 2 spaces of allies with Def > " + this.name + "'s Def or not being adjacent to an ally with Fuming Freikugel.<br>";
		}
		if(this.hasExactly("Crimson War-Axe") && enemy.combatStartHp / enemy.maxHp >= 0.75){
			this.combatSpur.atk += 6;
			this.combatSpur.spd += 6;
			boostText += this.name + " gets +6 to atk and spd from enemy HP >= 75% with Crimson War-Axe.<br>";
		}
		if(this.hasExactly("Warrior's Sword") && this.combatStartHp / this.maxHp >= 0.25){
			this.combatSpur.atk += 5;
			this.combatSpur.spd += 5;
			this.combatSpur.def += 5;
			this.combatSpur.res += 5;
			boostText += this.name + " gets +5 to all stats from HP >= 25% with Warrior's Sword.<br>";
		}
		if(this.hasExactly("Faithful Breath") && this.combatStartHp / this.maxHp >= 0.4){
			this.combatSpur.atk += 6;
			this.combatSpur.spd += 6;
			boostText += this.name + " gets +6 to atk and spd from HP >= 40% with Faithful Breath.<br>";
		}
		if(this.hasExactly("Deep-Blue Bow")){
			if((this.rValue < 0 && enemy.combatStartHp / enemy.maxHp >= 1 && this.initiator) || (this.rValue > 0 && (this.initiator || enemy.combatStartHp / enemy.maxHp >= 0.75))){
				this.combatSpur.atk += 4;
				this.combatSpur.spd += 4;
				this.combatSpur.def += 4;
				this.combatSpur.res += 4;
				var bAText = "initiating and enemy HP = 100%";
				if(this.rValue > 0){
					bAText = "initiating or enemy HP >= 75%";
				}
				boostText += this.name + " gets +4 to all stats from " + bAText + " with Deep-Blue Bow.<br>";
			}
			if(this.rValue == 5 && this.combatStartHp / this.maxHp >= 0.25){
				this.combatSpur.atk += 4;
				this.combatSpur.spd += 4;
				this.combatSpur.def += 4;
				this.combatSpur.res += 4;
				boostText += this.name + " gets +4 to all stats from HP >= 25% with Deep-Blue Bow.<br>";
			}
		}
		if(this.has("Bunny Fang") && this.rValue > 0){
			if(this.toggle.weapon == 1 || this.combatStartHp / this.maxHp <= 0.9){
				this.combatSpur.atk += 5;
				this.combatSpur.spd += 5;
				boostText += this.name + " gets +5 to atk and spd from not being adjacent to an ally or HP <= 90% with Bunny Fang.<br>";
			}
			if(this.rValue == 5 && enemy.combatStartHp / enemy.maxHp >= 0.5){
				this.combatSpur.atk += 5;
				this.combatSpur.spd += 5;
				boostText += this.name + " gets +5 to atk and spd from enemy HP >= 50% with Bunny Fang.<br>";
			}
		}
		if(this.hasExactly("Razing Breath") && this.rValue == 5 && this.combatStartHp / this.maxHp >= 0.25){
			this.combatSpur.atk += 4;
			this.combatSpur.spd += 4;
			this.combatSpur.def += 4;
			this.combatSpur.res += 4;
			boostText += this.name + " gets +4 to all stats from HP >= 25% with Razing Breath.<br>";
		}
		if(this.hasExactly("Moonlight Stone") && (!this.initiator || enemy.combatStartHp / enemy.maxHp >= 0.75)){
			this.combatSpur.atk += 5;
			this.combatSpur.spd += 5;
			this.combatSpur.def += 5;
			this.combatSpur.res += 5;
			boostText += this.name + " gets +5 to all stats from enemy initiating or enemy HP >= 75% with Moonlight Stone.<br>";
		}
		if(this.hasExactly("Starlight Stone") && (!this.initiator || enemy.combatStartHp / enemy.maxHp >= 0.75)){
			this.combatSpur.atk += 6;
			enemy.combatSpur.atk -= 6;
			boostText += this.name + " gets +6 to atk and inflicts -6 atk to " + enemy.name + " from enemy initiating or enemy HP >= 75% with Starlight Stone.<br>";
		}
		if(this.hasExactly("Ghostly Lanterns") && this.combatStartHp / this.maxHp >= 0.25){
			this.combatSpur.atk += 6;
			enemy.combatSpur.atk -= 6;
			boostText += this.name + " gets +6 to atk and inflicts -6 atk to " + enemy.name + " from HP >= 25% with Ghostly Lanterns.<br>";
		}
		if(this.has("Surprise Breath") && this.combatStartHp / this.maxHp >= 0.25){
			this.combatSpur.atk += 5;
			this.combatSpur.res += 5;
			var arVal = Math.floor(allStats[19] * 0.2);
			enemy.combatSpur.atk -= arVal;
			enemy.combatSpur.res -= arVal;
			boostText += this.name + " gets +5 atk/res and inflicts -" + arVal + " atk/res to " + enemy.name + " from HP >= 25% with " + data.skills[this.weaponIndex].name + ".<br>";
		}
		if((this.hasExactly("Arcane Grima") || this.hasExactly("Arcane Downfall")) && this.combatStartHp / this.maxHp >= 0.25){
			this.combatSpur.atk += 5;
			this.combatSpur.spd += 5;
			this.combatSpur.def += 5;
			this.combatSpur.res += 5;
			boostText += this.name + " gets +5 to all stats from HP >= 25% with " + data.skills[this.weaponIndex].name + ".<br>";
		}
		if(this.hasExactly("Everliving Ymir") && (this.initiator || enemy.range == "ranged")){
			this.combatSpur.atk += 5;
			this.combatSpur.spd += 5;
			this.combatSpur.def += 5;
			this.combatSpur.res += 5;
			boostText += this.name + " gets +5 to all stats from initiating or enemy range = 2 with Everliving Ymir.<br>";
		}
		if((this.has("Defier's Lance") || this.has("Defier's Axe") || this.has("Defier's Bow") || this.has("Defier's Sword")) && enemy.combatStartHp / enemy.maxHp >= 0.75){
			this.combatSpur.def += 5;
			enemy.combatSpur.def -= 5;
			boostText += this.name + " gets +5 to def and inflicts -5 def to " + enemy.name + " from enemy HP >= 75% with " + data.skills[this.weaponIndex].name + ".<br>";
			if(checkBuff(enemy, this, "def", currTurn) && allStats[9]){
				var extraStats = 0;
				var buffText = "";
				var debuffText = "";
				if(!allStats[15][2]){
					extraStats = Math.max(enemy.buffs.def,enemy.combatBuffs.def);
					if(extraStats > 0){
						this.combatSpur.def += extraStats;
						enemy.combatSpur.def -= extraStats;
						buffText += " +" + extraStats + " def";
						debuffText += " -" + extraStats + " def";
					}
				}
				boostText += this.name + " gets" + buffText + " and inflicts" + debuffText + " to " + enemy.name + " from enemy HP >= 75% and enemy having def Bonus with " + data.skills[this.weaponIndex].name + ".<br>";
			}
		}
		if(this.hasExactly("Rite of Souls") && (this.initiator || this.toggle.weapon > 1)){
			this.combatSpur.atk += 5;
			this.combatSpur.spd += 5;
			this.combatSpur.def += 5;
			this.combatSpur.res += 5;
			boostText += this.name + " gets +5 to all stats from initiating or being within 2 spaces of an ally with Rite of Souls.<br>";
		}
		if(this.hasExactly("Ardent Durandal") && this.rValue > 0){
			if(this.combatStartHp / this.maxHp >= 0.25){
				this.combatSpur.atk += 4;
				this.combatSpur.spd += 4;
				this.combatSpur.def += 4;
				this.combatSpur.res += 4;
				boostText += this.name + " gets +4 to all stats from HP >= 25% with Ardent Durandal.<br>";
			}
			if(this.rValue == 5 && (this.initiator || this.toggle.weapon == 1)){
				this.combatSpur.atk += 4;
				this.combatSpur.spd += 4;
				this.combatSpur.def += 4;
				this.combatSpur.res += 4;
				boostText += this.name + " gets +4 to all stats from initiating or being within 2 spaces of an ally with Ardent Durandal.<br>";
			}
		}
		if(this.hasExactly("Hunting Blade") && this.rValue > 0){
			if(this.toggle.weapon == 1){
				this.combatSpur.atk += 4;
				this.combatSpur.spd += 4;
				this.combatSpur.def += 4;
				this.combatSpur.res += 4;
				boostText += this.name + " gets +4 to all stats from being within 3 spaces of an ally with Hunting Blade.<br>";
			}
			if(this.rValue == 5 && this.combatStartHp / this.maxHp >= 0.25){
				this.combatSpur.atk += 4;
				this.combatSpur.spd += 4;
				this.combatSpur.def += 4;
				this.combatSpur.res += 4;
				boostText += this.name + " gets +4 to all stats from HP >= 25% with Hunting Blade.<br>";
			}
		}
		if(this.hasExactly("Snide Bow")){
			if(this.combatStartHp / this.maxHp >= 0.25){
				this.combatSpur.atk += 5;
				this.combatSpur.spd += 5;
				boostText += this.name + " gets +5 to atk and spd from HP >= 25% with Snide Bow.<br>";
			}
			if(this.rValue == 5 && (this.initiator || this.toggle.weapon == 1)){
				var dSpd = -5;
				var dDef = -5;
				if(!enemy.penalty.panic){
					dSpd += Math.max(enemy.combatBuffs.spd,enemy.buffs.spd) * -2;
					dDef += Math.max(enemy.combatBuffs.def,enemy.buffs.def) * -2;
				}
				enemy.combatSpur.spd += dSpd;
				enemy.combatSpur.def += dDef;
				boostText += this.name + " has activated Snide Bow. Effect on " + enemy.name + ": " + dSpd + " to spd and " + dDef + " to def.<br>";
			}
		}
		if(this.hasExactly("Coyote's Lance") && (this.initiator || this.toggle.weapon > 1)){
			this.combatSpur.atk += 6;
			this.combatSpur.spd += 6;
			boostText += this.name + " gets +6 to atk and spd from initiating or being within 2 spaces of an ally with Coyote's Lance.<br>";
		}
		if(this.hasExactly("Awoken Breath") && this.buddy.adjacent + this.buddy.two + this.buddy.three > 0){
			this.combatSpur.atk += 5;
			this.combatSpur.spd += 5;
			this.combatSpur.def += 5;
			this.combatSpur.res += 5;
			boostText += this.name + " gets +5 to all stats from being within 3 spaces of an ally with Awoken Breath.<br>";
		}
		if(this.hasExactly("All Together!") && this.toggle.c > 0){
			this.combatSpur.atk += 4;
			this.combatSpur.spd += 4;
			this.combatSpur.def += 4;
			this.combatSpur.res += 4;
			boostText += this.name + " gets +4 to all stats from being within 2 spaces of an ally with All Together!.<br>";
		}
		if(this.hasExactly("Enclosing Dark") && (this.initiator || this.toggle.weapon > 9)){
			this.combatSpur.atk += 6;
			this.combatSpur.spd += 6;
			boostText += this.name + " gets +6 to atk and spd from initiating or not being adjacent to an ally with Enclosing Dark.<br>";
			if(this.toggle.weapon == 1 || this.toggle.weapon == 11){
				enemy.combatSpur.spd -= 4;
				enemy.combatSpur.res -= 4;
				boostText += this.name + " inflicts -4 spd and res to " + enemy.name + " from enemies within 2 spaces of target = 1 with Enclosing Dark.<br>";
			}
			else if(this.toggle.weapon == 2 || this.toggle.weapon == 12){
				enemy.combatSpur.spd -= 8;
				enemy.combatSpur.res -= 8;
				boostText += this.name + " inflicts -8 spd and res to " + enemy.name + " from enemies within 2 spaces of target >= 2 with Enclosing Dark.<br>";
			}
		}
		if(this.hasExactly("Enclosing Claw") && this.combatStartHp / this.maxHp >= 0.25){
			this.combatSpur.atk += 5;
			this.combatSpur.spd += 5;
			this.combatSpur.def += 5;
			this.combatSpur.res += 5;
			var debuffText = "";
			if(this.buddy.erorc > 0){
				var fVar = Math.min(this.buddy.erorc * 3, 9);
				enemy.combatSpur.atk -= fVar;
				enemy.combatSpur.spd -= fVar;
				enemy.combatSpur.def -= fVar;
				debuffText = " and inflicts -" + fVar + " atk/spd/def to " + enemy.name;
			}
			boostText += this.name + " gets +5 to all stats" + debuffText + " from HP >= 25% with Enclosing Claw.<br>";
		}
		if(this.hasExactly("Oracle's Breath") && this.rValue > 0){
			if(this.toggle.weapon == 1 || this.toggle.weapon == 3 || this.combatStartHp / this.maxHp >= 0.5){
				this.combatSpur.atk += 4;
				this.combatSpur.spd += 4;
				this.combatSpur.def += 4;
				this.combatSpur.res += 4;
				boostText += this.name + " gets +4 to all stats from HP >= 50% or [Bonus] active with Oracle's Breath.<br>";
			}
			if(this.rValue == 5 && (this.initiator || this.toggle.weapon > 1)){
				this.combatSpur.atk += 4;
				this.combatSpur.spd += 4;
				this.combatSpur.def += 4;
				this.combatSpur.res += 4;
				boostText += this.name + " gets +4 to all stats from initiating or being within 2 spaces of an ally with Oracle's Breath.<br>";
			}
		}
		if(this.hasExactly("Retainer's Report")){
			if(enemy.combatStartHp / enemy.maxHp >= 0.75 || this.toggle.weapon == 1 || this.toggle.weapon == 3){
				this.combatSpur.atk += 4;
				this.combatSpur.spd += 4;
				this.combatSpur.def += 4;
				this.combatSpur.res += 4;
				boostText += this.name + " gets +4 to all stats from enemy HP >= 75% or [Penalty] active on enemy with Retainer's Report.<br>";
			}
			if(this.rValue == 5 && this.combatStartHp / this.maxHp >= 0.25){
				this.combatSpur.atk += 4;
				this.combatSpur.spd += 4;
				this.combatSpur.def += 4;
				this.combatSpur.res += 4;
				boostText += this.name + " gets +4 to all stats from HP >= 25% with Retainer's Report.<br>";
			}
		}
		if(this.hasExactly("Reginleif") && this.rValue > 0){
			if(allStats[16] > allStats[20] || this.toggle.weapon == 1){
				this.combatSpur.atk += 4;
				this.combatSpur.spd += 4;
				this.combatSpur.def += 4;
				this.combatSpur.res += 4;
				boostText += this.name + " gets +4 to all stats from atk > enemy atk or [Bonus] active with Reginleif.<br>";
			}
			if(this.rValue == 5 && this.combatStartHp / this.maxHp >= 0.25){
				this.combatSpur.atk += 4;
				this.combatSpur.spd += 4;
				this.combatSpur.def += 4;
				this.combatSpur.res += 4;
				boostText += this.name + " gets +4 to all stats from HP >= 25% with Reginleif.<br>";
			}
		}
		if(this.hasExactly("Tanngrisnir")){
			if(checkAllBuffs(this, enemy, currTurn) || this.toggle.weapon == 1 || (this.rValue > 0 && (this.combatStartHp / this.maxHp >= 0.5 || this.toggle.weapon == 3))){
				var buffVal = 3;
				var rText = "having bonus stats or extra movement active";
				if(this.rValue > 0){
					buffVal = 4;
					rText = "HP >= 50% or [Bonus] active";
				}
				this.combatSpur.atk += buffVal;
				this.combatSpur.spd += buffVal;
				this.combatSpur.def += buffVal;
				this.combatSpur.res += buffVal;
				boostText += this.name + " gets +" + buffVal + " to all stats from " + rText + " with Tanngrisnir.<br>";
			}
			if(this.rValue == 5 && this.toggle.weapon > 1){
				this.combatSpur.atk += 4;
				this.combatSpur.spd += 4;
				this.combatSpur.def += 4;
				this.combatSpur.res += 4;
				boostText += this.name + " gets +4 to all stats from being within 3 spaces of an ally with Tanngrisnir.<br>";
			}
		}
		if(this.hasExactly("Athame")){
			if(enemy.combatStartHp / enemy.maxHp < 1 || (this.rValue > 0 && this.initiator)){
				var aText = "";
				if(this.rValue > 0){
					aText = " or initiating";
				}
				this.combatSpur.atk += 5;
				this.combatSpur.spd += 5;
				boostText += this.name + " gets +5 atk and spd from enemy HP < 100%" + aText + " with Athame.<br>";
			}
			if(this.rValue == 5 && (this.initiator || this.toggle.weapon == 1)){
				this.combatSpur.atk += 5;
				this.combatSpur.spd += 5;
				boostText += this.name + " gets +5 to atk & spd from initiating or not being adjacent to an ally with Athame.<br>";
			}
		}
		if(this.hasExactly("Arcane Eclipse") && this.combatStartHp / this.maxHp >= 0.25){
			this.combatSpur.atk += 5;
			this.combatSpur.spd += 5;
			this.combatSpur.def += 5;
			this.combatSpur.res += 5;
			boostText += this.name + " gets +5 to all stats from HP >= 25% with Arcane Eclipse.<br>";
			if(this.penalty.panic){
				this.combatBuffs.atk = 0;
				this.buffs.atk = 0;
			}
			this.combatDebuffs.atk = 0;
			this.debuffs.atk = 0;
			boostText += this.name + " has neutralized penalties to atk.<br>";
		}
		if(this.hasExactly("Prodigy Polearm") && this.combatStartHp / this.maxHp >= 0.25){
			this.combatSpur.atk += 5;
			this.combatSpur.spd += 5;
			this.combatSpur.def += 5;
			this.combatSpur.res += 5;
			
			var pShred = 0;
			if(this.maxHp - 6 < enemy.maxHp){
				pShred++;
			}
			for(var i = 16; i < 20; i++){
				if(allStats[i] - 6 < allStats[i+4]){
					pShred++;
				}
			}
			pShred = (pShred * 5 + 10) * 0.01;
			pShred = Math.floor(allStats[17] * pShred);
			enemy.combatSpur.atk -= pShred;
			enemy.combatSpur.def -= pShred;
			boostText += this.name + " gets +5 to all stats and inflicts -" + pShred + " atk and def to " + enemy.name + " from HP >= 25% with Prodigy Polearm.<br>";
		}
		if(this.hasExactly("Seidr") && (this.initiator || this.toggle.weapon == 1)){
			this.combatSpur.atk += 5;
			this.combatSpur.spd += 5;
			this.combatSpur.def += 5;
			this.combatSpur.res += 5;
			boostText += this.name + " gets +5 to all stats from initiating or being within 2 spaces of an ally with Seidr.<br>";
		}
		if(this.hasExactly("Aurgelmir") && (this.initiator || this.toggle.weapon == 1)){
			this.combatSpur.atk += 6;
			this.combatSpur.spd += 6;
			boostText += this.name + " gets +6 atk & spd from initiating or not being adjacent to an ally with Aurgelmir.<br>";
		}
		if(this.hasExactly("Solemn Axe") && this.combatStartHp / this.maxHp >= 0.25){
			this.combatSpur.atk += 5;
			this.combatSpur.spd += 5;
			this.combatSpur.def += 5;
			this.combatSpur.res += 5;
			boostText += this.name + " gets +5 to all stats from HP >= 25% with Solemn Axe.<br>";
		}
		if(this.hasExactly("Sevenfold Gifts") && this.combatStartHp / this.maxHp >= 0.25){
			this.combatSpur.atk += 6;
			this.combatSpur.spd += 6;
			boostText += this.name + " gets +6 atk & spd from HP >= 25% with Sevenfold Gifts.<br>";
		}
		if(this.hasExactly("Inseverable Spear") && (this.initiator || this.toggle.weapon == 1)){
			this.combatSpur.atk += 6;
			this.combatSpur.spd += 6;
			boostText += this.name + " gets +6 atk & spd from initiating or being within 2 spaces of an ally with Inseverable Spear.<br>";
		}
		if(this.hasExactly("Asura Blades")){
			if(this.penalty.panic){
				this.combatBuffs = {"atk":0,"spd":0,"def":0,"res":0};
				this.buffs = {"atk":0,"spd":0,"def":0,"res":0};
			}
			this.combatDebuffs = {"atk":0,"spd":0,"def":0,"res":0};
			this.debuffs = {"atk":0,"spd":0,"def":0,"res":0};
			boostText += this.name + " neutralizes penalties with Asura Blades.<br>";
		}
		if((this.hasExactly("Swift Slice") || this.hasExactly("Swift Ice")) && (this.initiator || this.buddy.adjacent > 0 || this.buddy.two > 0)){
			this.combatSpur.atk += 8;
			this.combatSpur.spd += 8;
			this.combatSpur.def += 8;
			this.combatSpur.res += 8;
			boostText += this.name + " gets +8 to all stats from initiating or being within 2 spaces of an ally with " + data.skills[this.aIndex].name + ".<br>";
		}
		if(this.hasExactly("Heralding Horn") && (!this.initiator || enemy.combatStartHp / enemy.maxHp >= 0.75)){
			this.combatSpur.atk += 6;
			enemy.combatSpur.atk -= 6;
			boostText += this.name + " gets +6 to atk and inflicts -6 atk to " + enemy.name + " from enemy initiating or enemy HP >= 75% with Heralding Horn.<br>";
		}
		if(this.hasExactly("Fang of Finality") && (this.initiator || this.toggle.weapon > 9)){
			this.combatSpur.atk += 6;
			this.combatSpur.spd += 6;
			boostText += this.name + " gets +6 atk & spd from initiating or not being adjacent to an ally with Fang of Finality.<br>";
		}
		if((this.hasExactly("Keen Rabbit Fang") || this.hasExactly("Wary Rabbit Fang")) && (this.initiator || this.toggle.weapon == 1)){
			this.combatSpur.atk += 6;
			this.combatSpur.spd += 6;
			var debuffText = "";
			if(this.hasExactly("Wary Rabbit Fang")){
				var wVar = Math.floor(allStats[17] * 0.2);
				enemy.combatSpur.atk -= wVar;
				enemy.combatSpur.def -= wVar;
				debuffText = " and inflicts -" + wVar + " atk & def to " + enemy.name;
			}
			boostText += this.name + " gets +6 atk & spd" + debuffText + " from initiating or not being adjacent to an ally with " + data.skills[this.weaponIndex].name + ".<br>";
		}
		if(this.hasExactly("Duality Vessel") && this.toggle.weapon == 1){
			this.combatSpur.atk += 5;
			this.combatSpur.spd += 5;
			this.combatSpur.def += 5;
			this.combatSpur.res += 5;
			boostText += this.name + " gets +5 to all stats from being within 3 spaces of an ally with Duality Vessel.<br>";
		}
		if(this.hasExactly("Ragnell-Alondite") && (!this.initiator || enemy.combatStartHp / enemy.maxHp >= 0.75) && this.rValue == 5){
			this.combatSpur.atk += 5;
			this.combatSpur.res += 5;
			boostText += this.name + " gets +5 to atk & res from enemy initiating or enemy HP >= 75% with Ragnell-Alondite.<br>";
		}
		if(this.hasExactly("Ashera's Chosen+") && (this.toggle.a == 1 || enemy.combatStartHp / enemy.maxHp >= 0.75)){
			this.combatSpur.atk += 9;
			this.combatSpur.def += 9;
			this.combatSpur.res += 9;
			boostText += this.name + " gets +9 atk/def/res from not being adjacent to an ally/being adjacent to only beast or dragon ally/enemy HP >= 75% with Ashera's Chosen+.<br>";
		}
		if(this.hasExactly("Sable Lance")){
			if(this.toggle.weapon > 9 || (this.rValue > 0 && this.initiator)){
				this.combatSpur.atk += 4;
				this.combatSpur.spd += 4;
				this.combatSpur.def += 4;
				this.combatSpur.res += 4;
				var slText = "";
				if(this.rValue > 0){
					slText = " initiating or";
				}
				boostText += this.name + " gets +4 in all stats from" + slText + " not being adjacent to an ally with Sable Lance.<br>";
			}
			if(this.rValue == 5 && this.combatStartHp / this.maxHp >= 0.25){
				var slVar = this.toggle.weapon;
				if(slVar > 9){
					slVar = slVar - 10;
				}
				slVar = (slVar * 2) + 4;
				this.combatSpur.atk += slVar;
				this.combatSpur.spd += slVar;
				this.combatSpur.def += slVar;
				this.combatSpur.res += slVar;
				boostText += this.name + " gets +" + slVar + " to all stats from HP >= 25% with Sable Lance.<br>";
			}
		}
		if(this.hasExactly("Scythe of Sariel")){
			if(this.toggle.weapon == 1 || checkAllBuffs(enemy, this, currTurn) || (this.rValue > 0 && enemy.combatStartHp / enemy.maxHp >= 0.75)){
				this.combatSpur.atk += 4;
				this.combatSpur.spd += 4;
				this.combatSpur.def += 4;
				this.combatSpur.res += 4;
				var ssText = "";
				if(this.rValue > 0){
					ssText = " or enemy HP >= 75%";
				}
				boostText += this.name + " gets +4 to all stats from enemy [Bonus] active" + ssText + " with Scythe of Sariel.<br>";
			}
			if(this.rValue == 5 && this.combatStartHp / this.maxHp >= 0.25){
				this.combatSpur.atk += 4;
				this.combatSpur.spd += 4;
				this.combatSpur.def += 4;
				this.combatSpur.res += 4;
				boostText += this.name + " gets +4 to all stats from HP >= 25% with Scythe of Sariel.<br>";
			}
		}
		if(this.hasExactly("Snow's Grace")){
			if(this.combatStartHp / this.maxHp >= 0.5 || (this.rValue > 0 && this.combatStartHp / this.maxHp >= 0.25)){
				this.combatSpur.atk += 5;
				this.combatSpur.spd += 5;
				this.combatSpur.def += 5;
				this.combatSpur.res += 5;
				var sgText = " from HP >= 50%";
				if(this.rValue > 0 && this.combatStartHp / this.maxHp >= 0.25){
					if(this.penalty.panic){
						this.combatBuffs = {"atk":0,"spd":0,"def":0,"res":0};
						this.buffs = {"atk":0,"spd":0,"def":0,"res":0};
					}
					this.combatDebuffs = {"atk":0,"spd":0,"def":0,"res":0};
					this.debuffs = {"atk":0,"spd":0,"def":0,"res":0};
					sgText = " and neutralizes penalties from HP >= 25%";
				}
				boostText += this.name + " gets +5 to all stats" + sgText + " with Snow's Grace.<br>";
			}
			if(this.rValue == 5 && (!this.initiator || enemy.combatStartHp / enemy.maxHp >= 0.75)){
				this.combatSpur.atk += 4;
				this.combatSpur.spd += 4;
				this.combatSpur.def += 4;
				this.combatSpur.res += 4;
				boostText += this.name + " gets +4 to all stats from enemy initiating or enemy HP >= 75% with Snow's Grace.<br>";
			}
		}
		if(this.hasExactly("Meisterbogen") && this.rValue == 5 && (this.initiator || this.toggle.weapon == 1)){
			this.combatSpur.atk += 4;
			this.combatSpur.spd += 4;
			this.combatSpur.def += 4;
			this.combatSpur.res += 4;
			boostText += this.name + " gets +4 to all stats from initiating or being within 2 spaces of an ally with Meisterbogen.<br>";
		}
		if(this.hasExactly("Cunning Bow")){
			if((this.rValue < 0 && this.combineBonPen(enemy,currTurn,"buff","debuff") >= 10) || (this.rValue > 0 && (this.toggle.weapon == 1 || this.toggle.weapon == 3))){
				enemy.combatSpur.atk -= 5;
				enemy.combatSpur.spd -= 5;
				enemy.combatSpur.def -= 5;
				enemy.combatSpur.res -= 5;
				skillName = data.skills[this.weaponIndex].name;
				boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -5 to all stats.<br>";
			}
			if(this.rValue == 5 && this.combatStartHp / this.maxHp >= 0.25){
				this.combatSpur.atk += 5;
				this.combatSpur.spd += 5;
				boostText += this.name + " gets +5 to atk & spd from HP >= 25% with Cunning Bow.<br>";
				var eNegate = this.checkNegate(enemy, currTurn);
				var dDef = 0;
				if(eNegate[2] == false){
					dDef += Math.min(enemy.combatDebuffs.def,enemy.debuffs.def);
					if(enemy.penalty.panic){
						dDef -= Math.max(enemy.combatBuffs.def,enemy.buffs.def);
					}
				}
				if(dDef < 0){
					enemy.combatSpur.def += dDef;
					boostText += this.name + " inflicts " + dDef + " def on " + enemy.name + " from HP >= 25% with Cunning Bow.<br>";
				}
			}
		}
		if(this.hasExactly("Child's Compass") && this.combatStartHp / this.maxHp >= 0.25){
			this.combatSpur.atk += 5;
			this.combatSpur.spd += 5;
			this.combatSpur.def += 5;
			this.combatSpur.res += 5;
			boostText += this.name + " gets +5 to all stats from HP >= 25% with Child's Compass.<br>";
			var asVal = this.toggle.weapon * 4;
			this.combatSpur.atk += asVal;
			this.combatSpur.spd += asVal;
			boostText += this.name + " gets additional +" + asVal + " to atk & spd from HP >= 25% with Child's Compass.<br>";
		}
		if(this.hasExactly("Crow's Crystal") && this.combatStartHp / this.maxHp >= 0.25){
			this.combatSpur.atk += 6;
			this.combatSpur.spd += 6;
			boostText += this.name + " gets +6 to atk & spd from HP >= 25% with Crow's Crystal.<br>";
		}
		if((this.hasExactly("Guide's Hourglass") || this.hasExactly("Celestial Globe")) && (this.initiator || this.toggle.weapon == 1)){
			this.combatSpur.atk += 5;
			this.combatSpur.spd += 5;
			this.combatSpur.def += 5;
			this.combatSpur.res += 5;
			boostText += this.name + " gets +5 to all stats from initiating or being within 2 spaces of an ally with " + data.skills[this.weaponIndex].name + ".<br>";
		}
		if(this.has("Magical Lantern") && (this.initiator || this.toggle.weapon == 1)){
			this.combatSpur.atk += 5;
			this.combatSpur.res += 5;
			boostText += this.name + " gets +5 to atk & res from initiating or being within 2 spaces of an ally with " + data.skills[this.weaponIndex].name + ".<br>";
		}
		if((this.hasExactly("Arcane Qiang") || this.hasExactly("Monarch Blade")) && this.combatStartHp / this.maxHp >= 0.25){
			this.combatSpur.atk += 5;
			this.combatSpur.spd += 5;
			this.combatSpur.def += 5;
			this.combatSpur.res += 5;
			boostText += this.name + " gets +5 to all stats from HP >= 25% with " + data.skills[this.weaponIndex].name + ".<br>";
		}
		if(this.hasExactly("Joyous Tome") && this.toggle.weapon > 0){
			this.combatSpur.atk += 5;
			this.combatSpur.spd += 5;
			this.combatSpur.def += 5;
			this.combatSpur.res += 5;
			boostText += this.name + " gets +5 to all stats from being within 3 spaces of an ally with Joyous Tome.<br>";
		}
		if(this.hasExactly("Liberation") && this.combatStartHp / this.maxHp >= 0.25){
			this.combatSpur.atk += 5;
			this.combatSpur.spd += 5;
			this.combatSpur.def += 5;
			this.combatSpur.res += 5;
			var sVal = 4;
			if(this.toggle.weapon > 0){
				sVal += this.toggle.weapon * 4;
			}
			enemy.combatSpur.spd -= sVal;
			enemy.combatSpur.def -= sVal;
			boostText += this.name + " gets +5 to all stats and inflicts -" + sVal + " spd & def to " + enemy.name + " from HP >= 25% with Liberation.<br>";
		}
		if((this.has("Protection Bow") || this.has("Protection Pike")) && this.toggle.weapon == 1){
			this.combatSpur.atk += 5;
			this.combatSpur.def += 5;
			boostText += this.name + " gets +5 to atk & def from being within 3 spaces of an ally with " + data.skills[this.weaponIndex].name + ".<br>";
		}
		if(this.hasExactly("Astra Blade") && this.rValue > 0){
			if(this.initiator || this.toggle.weapon > 9){
				this.combatSpur.atk += 4;
				this.combatSpur.spd += 4;
				this.combatSpur.def += 4;
				this.combatSpur.res += 4;
				boostText += this.name + " gets +4 to all stats from initiating or being within 2 spaces of an ally with Astra Blade.<br>";
			}
			if(this.rValue == 5 && this.combatStartHp / this.maxHp >= 0.25){
				this.combatSpur.atk += 4;
				this.combatSpur.spd += 4;
				this.combatSpur.def += 4;
				this.combatSpur.res += 4;
				var aText = "";
				var aStat = this.toggle.weapon;
				if(aStat > 9){
					aStat -= 10;
				}
				if(aStat > 0){
					aStat = aStat * 2;
					this.combatSpur.atk += aStat;
					enemy.combatSpur.def -= aStat;
					aText = ", gets an additional +" + aStat + " to atk, and inflicts -" + aStat + " def to " + enemy.name;
				}
				boostText += this.name + " gets +4 to all stats" + aText + " from HP >= 25% with Astra Blade.<br>";
			}
		}
		if(this.hasExactly("Noble Lance") && this.rValue > 0){
			if(this.combatStartHp / this.maxHp < 1 || enemy.combatStartHp / enemy.maxHp >= 0.75){
				this.combatSpur.atk += 4;
				this.combatSpur.spd += 4;
				this.combatSpur.def += 4;
				this.combatSpur.res += 4;
				boostText += this.name + " gets +4 to all stats from HP <= 99% or enemy HP >= 75% with Noble Lance.<br>";
			}
			if(this.rValue == 5 && (this.initiator || enemy.combatStartHp / enemy.maxHp >= 0.75)){
				this.combatSpur.atk += 4;
				this.combatSpur.spd += 4;
				this.combatSpur.def += 4;
				this.combatSpur.res += 4;
				boostText += this.name + " gets +4 to all stats from initiating or enemy HP >= 75% with Noble Lance.<br>";
			}
		}
		if(this.hasExactly("Command Lance")){
			if(this.toggle.weapon > 9){
				this.combatSpur.atk += 4;
				this.combatSpur.spd += 4;
				this.combatSpur.def += 4;
				this.combatSpur.res += 4;
				boostText += this.name + " gets +4 to all stats from being within 3 spaces of an ally with Command Lance.<br>";
			}
			if(this.rValue == 5 && this.combatStartHp / this.maxHp >= 0.25){
				var clVar = this.toggle.weapon;
				if(clVar > 9){
					clVar -= 10;
				}
				clVar = (clVar * 2) + 4;
				this.combatSpur.atk += clVar;
				this.combatSpur.spd += clVar;
				this.combatSpur.def += clVar;
				this.combatSpur.res += clVar;
				boostText += this.name + " gets +" + clVar + " to all stats from HP >= 25% with Command Lance.<br>";
			}
		}
		if(this.hasExactly("Flower of Joy") && this.rValue > 0){
			if(this.toggle.weapon == 1){
				this.combatSpur.atk += 4;
				this.combatSpur.spd += 4;
				this.combatSpur.def += 4;
				this.combatSpur.res += 4;
				boostText += this.name + " gets +4 to all stats from being in a cardinal direction of an ally with Flower of Joy.<br>";
			}
			if(this.rValue == 5 && this.combatStartHp / this.maxHp >= 0.25){
				this.combatSpur.atk += 4;
				this.combatSpur.spd += 4;
				this.combatSpur.def += 4;
				this.combatSpur.res += 4;
				boostText += this.name + " gets +4 to all stats from HP >= 25% with Flower of Joy.<br>";
			}
		}
		if(this.has("Guardian Fang") && this.rValue > 0){
			if(this.initiator || this.toggle.weapon == 1){
				this.combatSpur.atk += 5;
				this.combatSpur.spd += 5;
				boostText += this.name + " gets +5 to atk & spd from initiating or not being adjacent to an ally with Guardian Fang.<br>";
			}
			if(this.rValue == 5 && this.combatStartHp / this.maxHp >= 0.25){
				this.combatSpur.atk += 5;
				this.combatSpur.spd += 5;
				boostText += this.name + " gets +5 to atk & spd from HP >= 25% with Guardian Fang.<br>";
			}
		}
		if(this.hasExactly("Ifingr")){
			if(this.toggle.weapon == 1){
				var buffVal = 4;
				if(this.rValue > 0){
					buffVal = 6;
				}
				this.combatSpur.atk += buffVal;
				this.combatSpur.spd += buffVal;
				this.combatSpur.def += buffVal;
				this.combatSpur.res += buffVal;
				boostText += this.name + " gets +" + buffVal + " in all stats from being within 3 spaces to an ally with Ifingr.<br>";
			}
			if(this.rValue == 5 && this.combatStartHp / this.maxHp >= 0.25){
				this.combatSpur.atk += 4;
				this.combatSpur.spd += 4;
				this.combatSpur.def += 4;
				this.combatSpur.res += 4;
				boostText += this.name + " gets +4 to all stats from HP >= 25% with Ifingr.<br>";
			}
		}
		if(this.hasExactly("Volunteer Bow")){
			if(this.combatStartHp / this.maxHp >= 0.25){
				var vText = "";
				this.combatSpur.atk += 4;
				this.combatSpur.spd += 4;
				this.combatSpur.def += 4;
				this.combatSpur.res += 4;
				if(enemy.range == "ranged"){
					enemy.combatSpur.atk -= 5;
					enemy.combatSpur.spd -= 5;
					vText = " and inflicts -5 atk & spd to " + enemy.name;
				}
				boostText += this.name + " gets +4 to all stats" + vText + " from HP >= 25% with Volunteer Bow.<br>";
			}
			if(this.rValue == 5 && this.toggle.weapon == 1){
				this.combatSpur.atk += 4;
				this.combatSpur.spd += 4;
				this.combatSpur.def += 4;
				this.combatSpur.res += 4;
				boostText += this.name + " gets +4 to all stats from being within 3 spaces of an ally with Volunteer Bow.<br>";
			}
		}
		if(this.hasExactly("Dawnsweet Box") && this.combatStartHp / this.maxHp >= 0.25){
			this.combatSpur.atk += 5;
			this.combatSpur.spd += 5;
			this.combatSpur.def += 5;
			this.combatSpur.res += 5;
			var sVal = 4;
			if(this.toggle.weapon > 0){
				sVal += this.toggle.weapon * 3;
			}
			enemy.combatSpur.atk -= sVal;
			enemy.combatSpur.spd -= sVal;
			boostText += this.name + " gets +5 to all stats and inflicts -" + sVal + " atk & spd to " + enemy.name + " from HP >= 25% with Dawnsweet Box.<br>";
		}
		if(this.hasExactly("Duskbloom Bow") && (this.initiator || this.toggle.weapon > 1)){
			this.combatSpur.atk += 5;
			this.combatSpur.spd += 5;
			this.combatSpur.def += 5;
			this.combatSpur.res += 5;
			boostText += this.name + " gets +5 to all stats from initiating or being within 2 spaces of an ally with Duskbloom Bow.<br>";
		}
		if((this.has("Petalfall Blade") || this.has("Petalfall Vase") || this.has("Null Blade") || this.has("Null Spear") || this.has("Clever Dagger")) && this.combatStartHp / this.maxHp >= 0.25){
			this.combatSpur.atk += 5;
			this.combatSpur.spd += 5;
			boostText += this.name + " gets +5 to atk & spd from HP >= 25% with " + data.skills[this.weaponIndex].name + ".<br>";
		}
		if((this.hasExactly("Dusk-Dawn Staff") || this.hasExactly("Crimean Scepter")) && (this.initiator || this.toggle.weapon == 1)){
			this.combatSpur.atk += 6;
			this.combatSpur.spd += 6;
			boostText += this.name + " gets +6 to atk & spd from initiating or being within 2 spaces of an ally with " + data.skills[this.weaponIndex].name + ".<br>";
		}
		if(this.hasExactly("Queensblade") && this.combatStartHp / this.maxHp >= 0.25){
			this.combatSpur.atk += 5;
			this.combatSpur.spd += 5;
			this.combatSpur.def += 5;
			this.combatSpur.res += 5;
			boostText += this.name + " gets +5 to all stats from HP >= 25% with Queensblade.<br>";
		}
		if(this.hasExactly("Queenslance") && (this.initiator || this.toggle.weapon == 1 || this.toggle.weapon == 3)){
			this.combatSpur.atk += 5;
			this.combatSpur.spd += 5;
			this.combatSpur.def += 5;
			this.combatSpur.res += 5;
			boostText += this.name + " gets +5 to all stats from initiating or being within 2 spaces of an ally with Queenslance.<br>";
		}
		if((this.has("Gronndeer") || this.has("Raudrdeer") || this.has("Blardeer") || this.has("Hvitrdeer")) && (!this.initiator || enemy.combatStartHp / enemy.maxHp >= 0.75)){
			this.combatSpur.atk += 5;
			enemy.combatSpur.atk -= 5;
			boostText += this.name + " gets +5 atk and inflicts -5 atk to " + enemy.name + " from enemy initiating or enemy HP >= 75% with " + data.skills[this.weaponIndex].name + ".<br>";
		}
		if(this.hasExactly("Bow of Repose") && this.combatStartHp / this.maxHp < 1){
			this.combatSpur.atk += 5;
			this.combatSpur.spd += 5;
			this.combatSpur.def += 5;
			this.combatSpur.res += 5;
			var sVal = this.toggle.weapon;
			if(sVal > 9){
				sVal -= 10;
			}
			sVal = sVal * 2 + 3;
			enemy.combatSpur.spd -= sVal;
			enemy.combatSpur.def -= sVal;
			boostText += this.name + " gets +5 to all stats and inflicts -" + sVal + " spd & def to " + enemy.name + " from HP <= 99% with Bow of Repose.<br>";
		}
		if(this.hasExactly("Nightmare's Egg") && this.combatStartHp / this.maxHp >= 0.25){
			this.combatSpur.atk += 6;
			this.combatSpur.spd += 6;
			boostText += this.name + " gets +6 to atk & spd from HP >= 25% with Nightmare's Egg.<br>";
		}
		if(this.has("Bunny's Egg") && this.combatStartHp / this.maxHp >= 0.25){
			this.combatSpur.atk += 5;
			this.combatSpur.spd += 5;
			boostText += this.name + " gets +5 to atk & spd from HP >= 25% with " + data.skills[this.weaponIndex].name + ".<br>";
		}
		if(this.has("Hare's Lance") && this.combatStartHp / this.maxHp >= 0.25){
			this.combatSpur.atk += 5;
			this.combatSpur.def += 5;
			boostText += this.name + " gets +5 to atk & def from HP >= 25% with " + data.skills[this.weaponIndex].name + ".<br>";
		}
		if(this.hasExactly("Sisterly War Axe") && (this.initiator || this.toggle.weapon == 1)){
			this.combatSpur.atk += 6;
			this.combatSpur.spd += 6;
			boostText += this.name + " gets +6 to atk & spd from initiating or being within 2 spaces of an ally with Sisterly War Axe.<br>";
		}
		if(this.hasExactly("Creator Sword") && this.rValue > 0){
			if(this.initiator || this.toggle.weapon == 1){
				this.combatSpur.atk += 4;
				this.combatSpur.spd += 4;
				this.combatSpur.def += 4;
				this.combatSpur.res += 4;
				boostText += this.name + " gets +4 to all stats from initiating or being within 2 spaces of an ally with Creator Sword.<br>";
			}
			if(this.rValue == 5 && this.combatStartHp / this.maxHp >= 0.25){
				this.combatSpur.atk += 4;
				this.combatSpur.spd += 4;
				this.combatSpur.def += 4;
				this.combatSpur.res += 4;
				boostText += this.name + " gets +4 to all stats from HP >= 25% with Creator Sword.<br>";
			}
		}
		if(this.hasExactly("Mercurius") && this.rValue > 0){
			if(this.combatStartHp / this.maxHp >= 0.25){
				this.combatSpur.atk += 4;
				this.combatSpur.spd += 4;
				this.combatSpur.def += 4;
				this.combatSpur.res += 4;
				boostText += this.name + " gets +4 to all stats from HP >= 25% with Mercurius.<br>";
			}
			if(this.rValue == 5 && this.toggle.weapon == 1){
				this.combatSpur.atk += 4;
				this.combatSpur.spd += 4;
				this.combatSpur.def += 4;
				this.combatSpur.res += 4;
				boostText += this.name + " gets +4 to all stats from being within 3 spaces of an ally with Mercurius.<br>";
			}
		}
		if(this.hasExactly("Saintly Seraphim") && this.rValue > 0){
			if(this.initiator || this.toggle.weapon > 0){
				this.combatSpur.atk += 5;
				this.combatSpur.spd += 5;
				boostText += this.name + " gets +5 to atk & spd from initiating or being within 2 spaces of an ally with Saintly Seraphim.<br>";
			}
			if(this.rValue == 5 && this.toggle.weapon == 2){
				this.combatSpur.atk += 5;
				this.combatSpur.spd += 5;
				boostText += this.name + " gets +5 to atk & spd from being within 3 spaces of an ally with Saintly Seraphim.<br>";;
			}
		}
		if(this.hasExactly("Nurturing Breath") && this.rValue > 0 && this.prfVal > 0){
			var nVal = Math.min(this.prfVal * 2, 6);
			this.combatSpur.atk += nVal;
			this.combatSpur.spd += nVal;
			this.combatSpur.def += nVal;
			this.combatSpur.res += nVal;
			boostText += this.name + " gets +" + nVal + " to all stats from having " + this.prfVal + " allies within 7x7 spaces with Nurturing Breath.<br>";
		}
		if(this.has("New Foxkit Fang") && this.rValue > 0){
			if(!this.initiator || enemy.combatStartHp / enemy.maxHp >= 0.75){
				this.combatSpur.atk += 4;
				this.combatSpur.spd += 4;
				this.combatSpur.def += 4;
				this.combatSpur.res += 4;
				boostText += this.name + " gets +4 to all stats from enemy initiating or enemy HP >= 75% with New Foxkit Fang.<br>"
			}
			if(this.rValue == 5 && this.combatStartHp / this.maxHp >= 0.25){
				this.combatSpur.atk += 4;
				this.combatSpur.spd += 4;
				this.combatSpur.def += 4;
				this.combatSpur.res += 4;
				var srText = this.name + " gets +4 to all stats from HP >= 25%";
				if(this.transform == true){
					enemy.combatSpur.atk -= 4;
					enemy.combatSpur.spd -= 4;
					enemy.combatSpur.def -= 4;
					enemy.combatSpur.res -= 4;
					srText += " and inflicts -4 to all stats to " + enemy.name + " from being transformed"
				}
				srText += " with New Foxkit Fang.<br>";
				boostText += srText;
			}
		}
		if(this.hasExactly("Frelian Lance") && (!this.initiator || enemy.combatStartHp / enemy.maxHp >= 0.75)){
			this.combatSpur.atk += 6;
			enemy.combatSpur.atk -= 6;
			var fVal = Math.floor(allStats[18] * 0.2);
			enemy.combatSpur.atk -= fVal;
			enemy.combatSpur.def -= fVal;
			boostText += this.name + " gets +6 to atk and inflicts -6 atk and an additional -" + fVal + " atk & def to " + enemy.name + " from enemy initiating or enemy HP >= 75% with Frelian Lance.<br>";
		}
		if(this.hasExactly("Frelian Blade") && (!this.initiator || enemy.combatStartHp / enemy.maxHp >= 0.75)){
			this.combatSpur.atk += 5;
			this.combatSpur.spd += 5;
			this.combatSpur.def += 5;
			this.combatSpur.res += 5;
			var sVal = Math.floor(allStats[17] * 0.15);
			enemy.combatSpur.atk -= sVal;
			enemy.combatSpur.spd -= sVal;
			enemy.combatSpur.def -= sVal;
			boostText += this.name + " gets +5 to all stats and inflicts -" + sVal + " atk/spd/def to " + enemy.name + " from enemy initiating or enemy HP >= 75% with Frelian Blade.<br>";
		}
		if(this.hasExactly("Arcane Nastrond") && (this.initiator || this.toggle.weapon == 1)){
			this.combatSpur.atk += 5;
			this.combatSpur.spd += 5;
			this.combatSpur.def += 5;
			this.combatSpur.res += 5;
			var aVal = 4;
			if(enemy.specialIndex != -1){
				aVal = 12 - ((data.skills[enemy.specialIndex].charge - enemy.initSkillCharge()) * 2);
				aVal = Math.max(4, aVal);
			}
			this.combatSpur.atk += aVal;
			boostText += this.name + " gets +5 to all stats and an additional +" + aVal + " atk from initiating or being within 2 spaces of an ally with Arcane Nastrond.<br>";
		}
		if(this.hasExactly("Abyssal Blade") && (this.initiator || this.toggle.weapon == 1)){
			this.combatSpur.atk += 5;
			this.combatSpur.spd += 5;
			this.combatSpur.def += 5;
			this.combatSpur.res += 5;
			boostText += this.name + " gets +5 to all stats from initiating or being within 2 spaces of an ally with Abyssal Blade.<br>";
		}
		if(this.hasExactly("Wizened Breath")){
			if(this.combatStartHp / this.maxHp >= 0.25){
				this.combatSpur.atk += 4;
				this.combatSpur.spd += 4;
				this.combatSpur.def += 4;
				this.combatSpur.res += 4;
				var nCheck = this.checkNegate(enemy,currTurn);
				var nText = "";
				if(nCheck[0] == false && nCheck[1] == false && nCheck[2] == false && nCheck[3] == false){
					var dAtk = Math.min(enemy.combatDebuffs.atk,enemy.debuffs.atk);
					var dSpd = Math.min(enemy.combatDebuffs.spd,enemy.debuffs.spd);
					var dDef = Math.min(enemy.combatDebuffs.def,enemy.debuffs.def);
					var dRes = Math.min(enemy.combatDebuffs.res,enemy.debuffs.res);
					if(enemy.penalty.panic){
						dAtk -= Math.max(enemy.combatBuffs.atk,enemy.buffs.atk);
						dSpd -= Math.max(enemy.combatBuffs.spd,enemy.buffs.spd);
						dDef -= Math.max(enemy.combatBuffs.def,enemy.buffs.def);
						dRes -= Math.max(enemy.combatBuffs.res,enemy.buffs.res);
					}
					dAtk = Math.max(6+dAtk, 0);
					dSpd = Math.max(6+dSpd, 0);
					dDef = Math.max(6+dDef, 0);
					dRes = Math.max(6+dRes, 0);
					enemy.combatSpur.atk -= dAtk;
					enemy.combatSpur.spd -= dSpd;
					enemy.combatSpur.def -= dDef;
					enemy.combatSpur.res -= dRes;
					nText = " and inflicts -" + dAtk + " atk/-" + dSpd + " spd/-" + dDef + " def/-" + dRes + " res on " + enemy.name;
				}
				boostText += this.name + " gets +4 to all stats" + nText + " from HP >= 25% with Wizened Breath.<br>";
			}
			if(this.rValue == 5 && (!this.initiator || enemy.combatStartHp / enemy.maxHp >= 0.75)){
				this.combatSpur.atk += 4;
				this.combatSpur.spd += 4;
				this.combatSpur.def += 4;
				this.combatSpur.res += 4;
				boostText += this.name + " gets +4 to all stats from enemy initiating or enemy HP >= 75% with Wizened Breath.<br>";
			}
		}
		if(this.hasExactly("Masked Lance")){
			if(this.initiator || this.toggle.weapon == 1){
				this.combatSpur.atk += 4;
				this.combatSpur.spd += 4;
				this.combatSpur.def += 4;
				this.combatSpur.res += 4;
				var mVar = Math.floor(allStats[19] * 0.2);
				enemy.combatSpur.atk -= mVar;
				enemy.combatSpur.def -= mVar;
				enemy.combatSpur.res -= mVar;
				boostText += this.name + " gets +4 to all stats and inflicts -" + mVar + " atk/def/res on " + enemy.name + " from initiating or being within 2 spaces of an ally with Masked Lance.<br>";
			}
			if(this.rValue == 5 && this.combatStartHp / this.maxHp >= 0.25){
				this.combatSpur.atk += 4;
				this.combatSpur.spd += 4;
				this.combatSpur.def += 4;
				this.combatSpur.res += 4;
				boostText += this.name + " gets +4 to all stats from HP >= 25% with Masked Lance.<br>";
			}
		}
		if(this.hasExactly("Victorious Axe") && this.rValue > 0){
			if(this.combatStartHp / this.maxHp >= 0.25 || this.toggle.weapon == 1 || this.toggle.weapon == 3){
				this.combatSpur.atk += 4;
				this.combatSpur.spd += 4;
				this.combatSpur.def += 4;
				this.combatSpur.res += 4;
				boostText += this.name + " gets +4 to all stats from HP >= 25% or # of foes in 2 spaces >= # of allies in 2 spaces with Victorious Axe.<br>";
			}
			if(this.rValue == 5 && (this.initiator || this.toggle.weapon > 1)){
				this.combatSpur.atk += 4;
				this.combatSpur.spd += 4;
				this.combatSpur.def += 4;
				this.combatSpur.res += 4;
				boostText += this.name + " gets +4 to all stats from initiating or not being adjacent to an ally with Victorious Axe.<br>";
			}
		}
		if(this.hasExactly("Staff of Lilies")){
			if(this.combatStartHp / this.maxHp >= 0.25){
				this.combatSpur.atk += 4;
				this.combatSpur.spd += 4;
				this.combatSpur.def += 4;
				this.combatSpur.res += 4;
				boostText += this.name + " gets +4 to all stats from HP >= 25% with Staff of Lilies.<br>";
			}
			if(this.rValue == 5 && (this.initiator || this.toggle.weapon == 1)){
				this.combatSpur.atk += 4;
				this.combatSpur.spd += 4;
				this.combatSpur.def += 4;
				this.combatSpur.res += 4;
				boostText += this.name + " gets +4 to all stats from initiating or being within 2 spaces of an ally with Staff of Lilies.<br>";
			}
		}
		if(this.hasExactly("Fiery War Sword") && (this.initiator || this.toggle.weapon == 1)){
			var fVal = 5;
			if(this.prfVal > 0){
				fVal += this.prfVal * 3;
			}
			this.combatSpur.atk += fVal;
			this.combatSpur.spd += fVal;
			this.combatSpur.def += fVal;
			this.combatSpur.res += fVal;
			boostText += this.name + " gets +" + fVal + " to all stats from initiating or being within 2 spaces of an ally with Fiery War Sword.<br>";
		}
		if(this.hasExactly("Gusty War Bow") && this.toggle.weapon > 1){
			this.combatSpur.atk += 5;
			this.combatSpur.spd += 5;
			this.combatSpur.def += 5;
			this.combatSpur.res += 5;
			boostText += this.name + " gets +5 to all stats from being within 3 spaces of an ally with Gusty War Bow.<br>";
		}
		if(this.hasExactly("Mystic War Staff") && this.toggle.weapon > 1){
			this.combatSpur.atk += 6;
			this.combatSpur.res += 6;
			boostText += this.name + " gets +6 to atk & res from being within 3 spaces of an ally with Mystic War Staff.<br>";
		}
		if(this.hasExactly("Lone-Wolf Blade") && this.combatStartHp / this.maxHp >= 0.25){
			var lVar = " from HP >= 25%";
			this.combatSpur.atk += 5;
			this.combatSpur.spd += 5;
			this.combatSpur.def += 5;
			this.combatSpur.res += 5;
			if(this.toggle.weapon == 1){
				enemy.combatSpur.atk -= 5;
				enemy.combatSpur.spd -= 5;
				enemy.combatSpur.def -= 5;
				lVar = " and inflicts -5 atk/spd/def to " + enemy.name + " from not being adjacent to an ally and HP >= 25%";
			}
			boostText += this.name + " gets +5 to all stats" + lVar + " with Lone-Wolf Blade.<br>";
		}
		if(this.hasExactly("Revealing Breath") && (!this.initiator || enemy.combatStartHp / enemy.maxHp >= 0.75)){
			this.combatSpur.atk += 5;
			this.combatSpur.spd += 5;
			this.combatSpur.def += 5;
			this.combatSpur.res += 5;
			boostText += this.name + " gets +5 to all stats from enemy initiating or enemy HP >= 75% with Revealing Breath.<br>";
		}
		if((this.hasExactly("Arcane Luin") || this.hasExactly("Arcane Devourer") || this.hasExactly("Arcane Euphoria") || this.hasExactly("Arcane Caliburnus") || this.hasExactly("Arcane Thunder") || this.hasExactly("Arcane Charmer")) && this.combatStartHp / this.maxHp >= 0.25){
			this.combatSpur.atk += 5;
			this.combatSpur.spd += 5;
			this.combatSpur.def += 5;
			this.combatSpur.res += 5;
			boostText += this.name + " gets +5 to all stats from HP >= 25% with " + data.skills[this.weaponIndex].name + ".<br>";
		}
		if(this.hasExactly("Knightly Devotion") && (this.initiator || this.toggle.a == 1)){
			this.combatSpur.atk += 8;
			this.combatSpur.spd += 8;
			this.combatSpur.def += 8;
			this.combatSpur.res += 8;
			if(this.penalty.panic){
				this.combatBuffs = {"atk":0,"spd":0,"def":0,"res":0};
				this.buffs = {"atk":0,"spd":0,"def":0,"res":0};
			}
			this.combatDebuffs = {"atk":0,"spd":0,"def":0,"res":0};
			this.debuffs = {"atk":0,"spd":0,"def":0,"res":0};
			boostText += this.name + " gets +8 to all stats and neutralizes penalties from initiating or being within 2 spaces of an ally with Knightly Devotion.<br>";
		}
		if(this.hasExactly("Asclepius") && this.combatStartHp / this.maxHp >= 0.25){
			this.combatSpur.atk += 6;
			this.combatSpur.res += 6;
			boostText += this.name + " gets +6 to atk & res from HP >= 25% with Asclepius.<br>";
		}
		if((this.hasExactly("Horn of the Land") || this.hasExactly("Cute Paper Crane")) && this.combatStartHp / this.maxHp >= 0.25){
			var hVal = 5;
			if(this.specialIndex != -1){
				hVal += (data.skills[this.specialIndex].charge - this.initSkillCharge()) * 2;
			}
			this.combatSpur.atk += hVal;
			this.combatSpur.spd += hVal;
			this.combatSpur.def += hVal;
			this.combatSpur.res += hVal;
			boostText += this.name + " gets +" + hVal + " to all stats from HP >= 25% with " + data.skills[this.weaponIndex].name + ".<br>";
		}
		if(this.hasExactly("Freeblade's Edge")){
			if(!this.initiator || enemy.combatStartHp / enemy.maxHp >= 0.75){
				this.combatSpur.atk += 4;
				this.combatSpur.spd += 4;
				this.combatSpur.def += 4;
				this.combatSpur.res += 4;
				boostText += this.name + " gets +4 to all stats from enemy initiating or enemy HP >= 75% with Freeblade's Edge.<br>";
			}
			if(this.rValue == 5 && this.combatStartHp / this.maxHp >= 0.25){
				this.combatSpur.atk += 4;
				this.combatSpur.spd += 4;
				this.combatSpur.def += 4;
				this.combatSpur.res += 4;
				boostText += this.name + " gets +4 to all stats from HP >= 25% with Freeblade's Edge.<br>";
			}
		}
		if(this.hasExactly("Pupil's Tome")){
			if(this.initiator || enemy.range == "ranged"){
				this.combatSpur.atk += 4;
				this.combatSpur.spd += 4;
				this.combatSpur.def += 4;
				this.combatSpur.res += 4;
				if(this.penalty.panic){
					this.combatBuffs.atk = 0;
					this.combatBuffs.res = 0;
					this.buffs.atk = 0;
					this.buffs.res = 0;
				}
				this.combatDebuffs.atk = 0;
				this.combatDebuffs.res = 0;
				this.debuffs.atk = 0;
				this.debuffs.res = 0;
				boostText += this.name + " gets +4 to all stats and neutralizes penalties to atk & res from initiating or enemy range == 2 with Pupil's Tome.<br>";
			}
			if(this.rValue == 5 && this.toggle.weapon == 1){
				this.combatSpur.atk += 4;
				this.combatSpur.spd += 4;
				this.combatSpur.def += 4;
				this.combatSpur.res += 4;
				var pVar = Math.floor(allStats[19] * 0.2);
				enemy.combatSpur.atk -= pVar;
				enemy.combatSpur.res -= pVar;
				boostText += this.name + " gets +4 to all stats and inflicts -" + pVar + " atk & res to " + enemy.name + " from being within 3 spaces of an ally with Pupil's Tome.<br>";
			}
		}
		if(this.hasExactly("Revenger Lance")){
			if(this.initiator || this.toggle.weapon == 1){
				this.combatSpur.atk += 4;
				this.combatSpur.spd += 4;
				this.combatSpur.def += 4;
				this.combatSpur.res += 4;
				boostText += this.name + " gets +4 to all stats from initiating or being within 2 spaces of an ally with Revenger Lance.<br>";
			}
			if(this.rValue == 5 && this.combatStartHp / this.maxHp >= 0.25){
				this.combatSpur.atk += 4;
				this.combatSpur.spd += 4;
				this.combatSpur.def += 4;
				this.combatSpur.res += 4;
				boostText += this.name + " gets +4 to all stats from HP >= 25% with Revenger Lance.<br>";
			}
		}
		if(this.hasExactly("Valbar's Lance")){
			if(this.toggle.weapon == 1){
				this.combatSpur.atk += 5;
				this.combatSpur.def += 5;
				boostText += this.name + " gets +5 to atk & def from being within 3 spaces of an ally with Valbar's Lance.<br>";
			}
			if(this.rValue == 5 && (!this.initiator || enemy.combatStartHp / enemy.maxHp >= 0.75)){
				this.combatSpur.atk += 5;
				this.combatSpur.def += 5;
				boostText += this.name + " gets +5 to atk & def from enemy initiating or enemy HP >= 75% with Valbar's Lance.<br>";
			}
		}
		if(this.hasExactly("Captain's Sword") && this.combatStartHp / this.maxHp >= 0.25){
			this.combatSpur.atk += 5;
			this.combatSpur.spd += 5;
			this.combatSpur.def += 5;
			this.combatSpur.res += 5;
			boostText += this.name + " gets +5 to all stats from HP >= 25% with Captain's Sword.<br>";
		}
		if(this.hasExactly("Sacrifice Staff") && (this.initiator || this.toggle.weapon == 1)){
			this.combatSpur.atk += 5;
			this.combatSpur.spd += 5;
			this.combatSpur.def += 5;
			this.combatSpur.res += 5;
			boostText += this.name + " gets +5 to all stats from initiating or being within 2 spaces of an ally with Sacrifice Staff.<br>";
		}
		if(this.hasExactly("Silent Breath") && (!this.initiator || enemy.combatStartHp / enemy.maxHp >= 0.75)){
			this.combatSpur.atk += 5;
			this.combatSpur.spd += 5;
			this.combatSpur.def += 5;
			this.combatSpur.res += 5;
			var dStats = [0,0,0,0];
			if(!enemy.penalty.panic){
				dStats[0] += Math.max(enemy.combatBuffs.atk,enemy.buffs.atk) * -2;
				dStats[1] += Math.max(enemy.combatBuffs.spd,enemy.buffs.spd) * -2;
				dStats[2] += Math.max(enemy.combatBuffs.def,enemy.buffs.def) * -2;
				dStats[3] += Math.max(enemy.combatBuffs.res,enemy.buffs.res) * -2;
			}
			enemy.combatSpur.atk += dStats[0];
			enemy.combatSpur.spd += dStats[1];
			enemy.combatSpur.def += dStats[2];
			enemy.combatSpur.res += dStats[3];
			boostText += this.name + " gets +5 to all stats and inflicts " +  dStats[0] + " atk/" +  dStats[1] + " spd/" +  dStats[2] + " def/" +  dStats[3] + " res to " + enemy.name + " from enemy initiating or enemy HP >= 75% with Silent Breath.<br>";
		}
		if(this.hasExactly("Dead-Fang Axe") && this.combatStartHp / this.maxHp >= 0.25){
			this.combatSpur.atk += 5;
			this.combatSpur.spd += 5;
			this.combatSpur.def += 5;
			this.combatSpur.res += 5;
			boostText += this.name + " gets +5 to all stats from HP >= 25% with Dead-Fang Axe.<br>";
			if(checkAllBuffs(enemy, this, currTurn) && allStats[9]){
				var extraStats = [0,0,0,0];
				var buffText = "";
				var debuffText = "";
				if(!allStats[15][0]){
					extraStats[0] = Math.max(enemy.buffs.atk,enemy.combatBuffs.atk);
					if(extraStats[0] > 0){
						this.combatSpur.atk += extraStats[0];
						enemy.combatSpur.atk -= extraStats[0];
						buffText += " +" + extraStats[0] + " atk";
						debuffText += " -" + extraStats[0] + " atk";
					}
				}
				if(!allStats[15][1]){
					extraStats[1] = Math.max(enemy.buffs.spd,enemy.combatBuffs.spd);
					if(extraStats[1] > 0){
						this.combatSpur.spd += extraStats[1];
						enemy.combatSpur.spd -= extraStats[1];
						buffText += " +" + extraStats[1] + " spd";
						debuffText += " -" + extraStats[1] + " spd";
					}
				}
				if(!allStats[15][2]){
					extraStats[2] = Math.max(enemy.buffs.def,enemy.combatBuffs.def);
					if(extraStats[2] > 0){
						this.combatSpur.def += extraStats[2];
						enemy.combatSpur.def -= extraStats[2];
						buffText += " +" + extraStats[2] + " def";
						debuffText += " -" + extraStats[2] + " def";
					}
				}
				if(!allStats[15][3]){
					extraStats[3] = Math.max(enemy.buffs.res,enemy.combatBuffs.res);
					if(extraStats[3] > 0){
						this.combatSpur.res += extraStats[3];
						enemy.combatSpur.res -= extraStats[3];
						buffText += " +" + extraStats[3] + " res";
						debuffText += " -" + extraStats[3] + " res";
					}
				}
				boostText += this.name + " gets" + buffText + " and inflicts" + debuffText + " to " + enemy.name + " from HP >= 25% with Dead-Fang Axe.<br>";
			}
		}
		if(this.hasExactly("Heartbroker Bow") && (this.initiator || this.buddy.adjacent > 0 || this.buddy.two > 0)){
			var buffVal = 5;
			buffVal = Math.min(this.dragonflower + buffVal, 10);
			this.combatSpur.atk += buffVal;
			this.combatSpur.spd += buffVal;
			this.combatSpur.def += buffVal;
			this.combatSpur.res += buffVal;
			boostText += this.name + " gets +" + buffVal + " to all stats from initiating or being within 2 spaces of an ally with Heartbroker Bow.<br>";
		}
		if(this.hasExactly("Chon'sin Sprig") && (this.initiator || this.toggle.weapon == 1)){
			this.combatSpur.atk += 5;
			this.combatSpur.spd += 5;
			this.combatSpur.def += 5;
			this.combatSpur.res += 5;
			var sDebuff = Math.floor(allStats[20] * 0.25) - 8;
			sDebuff = Math.max(sDebuff,0);
			sDebuff = Math.min(sDebuff,10);
			enemy.combatSpur.spd -= sDebuff;
			enemy.combatSpur.def -= sDebuff;
			boostText += this.name + " gets +5 to all stats and inflicts -" + sDebuff + " spd & def on " + enemy.name + " from initiating or being within 2 spaces of an ally with Chon'sin Sprig.<br>";
		}
		if((this.has("Bridal Blade") || this.has("Ring of Affiance") || this.has("Reversal Blade") || this.has("Reversal Lance")) && (this.initiator || this.buddy.adjacent > 0 || this.buddy.two > 0)){
			this.combatSpur.atk += 4;
			this.combatSpur.spd += 4;
			this.combatSpur.def += 4;
			this.combatSpur.res += 4;
			boostText += this.name + " gets +4 to all stats from initiating or being within 2 spaces of an ally with " + data.skills[this.weaponIndex].name + ".<br>";
			var dAtk = Math.max(enemy.combatBuffs.atk,enemy.buffs.atk) * -2;
			var dSpd = Math.max(enemy.combatBuffs.spd,enemy.buffs.spd) * -2;
			var dDef = Math.max(enemy.combatBuffs.def,enemy.buffs.def) * -2;
			var dRes = Math.max(enemy.combatBuffs.res,enemy.buffs.res) * -2;
			if(enemy.penalty.panic){
				dAtk = 0;
				dSpd = 0;
				dDef = 0;
				dRes = 0;
			}
			enemy.combatSpur.atk += dAtk;
			enemy.combatSpur.spd += dSpd;
			enemy.combatSpur.def += dDef;
			enemy.combatSpur.res += dRes;
			boostText += this.name + " inflicts " + dAtk + "/" + dSpd + "/" + dDef + "/" + dRes + " in stats to " + enemy.name + " from enemy buffs with " + data.skills[this.weaponIndex].name + ".<br>";
		}
		if(this.hasExactly("Twin Divinestone") && this.combatStartHp / this.maxHp >= 0.25){
			this.combatSpur.atk += 5;
			this.combatSpur.spd += 5;
			this.combatSpur.def += 5;
			this.combatSpur.res += 5;
			boostText += this.name + " gets +5 to all stats from HP >= 25% with Twin Divinestone.<br>";
		}
		if(this.hasExactly("Fujin-Raijin Yumi") && this.combatStartHp / this.maxHp >= 0.25){
			this.combatSpur.atk += 6;
			this.combatSpur.spd += 6;
			boostText += this.name + " gets +6 to atk & spd from HP >= 25% with Fujin-Raijin Yumi.<br>";
		}
		if(this.hasExactly("Guardian's Bow") && this.rValue > 0){
			if(this.initiator || allStats[17] + this.getPhantom("Spd") >= allStats[21] + enemy.getPhantom("Spd") - 7){
				enemy.combatSpur.atk -= 5;
				enemy.combatSpur.spd -= 5;
				enemy.combatSpur.def -= 5;
				boostText += this.name + " inflicts -5 atk/spd/def to " + enemy.name + " from initiating or having spd >= enemy spd - 7 with Guardian's Bow.<br>";
			}
			if(this.rValue == 5 && this.combatStartHp / this.maxHp >= 0.25){
				this.combatSpur.atk += 4;
				this.combatSpur.spd += 4;
				this.combatSpur.def += 4;
				this.combatSpur.res += 4;
				boostText += this.name + " gets +4 to all stats from HP >= 25% with Guardian's Bow.<br>";
			}
		}
		if(this.hasExactly("Violdrake Bow")){
			if(this.combatStartHp / this.maxHp >= 0.25){
				this.combatSpur.atk += 4;
				this.combatSpur.spd += 4;
				this.combatSpur.def += 4;
				this.combatSpur.res += 4;
				boostText += this.name + " gets +4 to all stats from HP >= 25% with Violdrake Bow.<br>";
			}
			if(this.rValue == 5 && (enemy.combatStartHp / enemy.maxHp >= 0.75 || this.toggle.weapon == 1)){
				this.combatSpur.atk += 4;
				this.combatSpur.spd += 4;
				this.combatSpur.def += 4;
				this.combatSpur.res += 4;
				var eNegate = this.checkNegate(enemy, currTurn);
				var dAtk = 0;
				var dSpd = 0;
				var dDef = 0;
				var dRes = 0;
				if(eNegate[0] == false){
					dAtk += Math.min(enemy.combatDebuffs.atk,enemy.debuffs.atk);
					if(enemy.penalty.panic){
						dAtk -= Math.max(enemy.combatBuffs.atk,enemy.buffs.atk);
					}
				}
				if(eNegate[1] == false){
					dSpd += Math.min(enemy.combatDebuffs.spd,enemy.debuffs.spd);
					if(enemy.penalty.panic){
						dSpd -= Math.max(enemy.combatBuffs.spd,enemy.buffs.spd);
					}
				}
				if(eNegate[2] == false){
					dDef += Math.min(enemy.combatDebuffs.def,enemy.debuffs.def);
					if(enemy.penalty.panic){
						dDef -= Math.max(enemy.combatBuffs.def,enemy.buffs.def);
					}
				}
				if(eNegate[3] == false){
					dRes += Math.min(enemy.combatDebuffs.res,enemy.debuffs.res);
					if(enemy.penalty.panic){
						dRes -= Math.max(enemy.combatBuffs.res,enemy.buffs.res);
					}
				}
				enemy.combatSpur.atk += dAtk;
				enemy.combatSpur.spd += dSpd;
				enemy.combatSpur.def += dDef;
				enemy.combatSpur.res += dRes;
				boostText += this.name + " gets +4 to all stats and inflicts " + dAtk + " atk/" + dSpd + " spd/" + dDef + " def/" + dRes + " res on " + enemy.name + " from enemy HP >= 75% or [Penalty] being active on enemy with Violdrake Bow.<br>";
			}
		}
		if(this.hasExactly("Vassal-Saint Steel") && this.combatStartHp / this.maxHp >= 0.25){
			this.combatSpur.atk += 5;
			this.combatSpur.spd += 5;
			this.combatSpur.def += 5;
			this.combatSpur.res += 5;
			var deVal = 3;
			if(enemy.specialIndex != -1){
				deVal = 11 - ((data.skills[enemy.specialIndex].charge - enemy.initSkillCharge()) * 2);
				deVal = Math.max(deVal,3);
			}
			enemy.combatSpur.spd -= deVal;
			enemy.combatSpur.def -= deVal;
			boostText += this.name + " gets +5 to all stats and inflicts -" + deVal + " spd & def on " + enemy.name + " from HP >= 25% with Vassal-Saint Steel.<br>";
		}
		if(this.hasExactly("Ilian Merc Lance") && this.toggle.weapon > 1){
			this.combatSpur.atk += 5;
			this.combatSpur.spd += 5;
			this.combatSpur.def += 5;
			this.combatSpur.res += 5;
			boostText += this.name + " gets +5 to all stats from # of adjacent allies <= 1 with Ilian Merc Lance.<br>";
		}
		if(this.hasExactly("Heidr") && (this.initiator || this.toggle.weapon > 1)){
			this.combatSpur.atk += 5;
			this.combatSpur.spd += 5;
			this.combatSpur.def += 5;
			this.combatSpur.res += 5;
			boostText += this.name + " gets +5 to all stats from initiating or being within 2 spaces of an ally with Heidr.<br>";
		}
		if(this.has("Seaside Parasol") && this.combatStartHp / this.maxHp >= 0.25){
			this.combatSpur.atk += 5;
			this.combatSpur.spd += 5;
			var deVal = 0;
			if((this.toggle.weapon > 0 && this.toggle.weapon < 5) || (this.toggle.weapon > 10 && this.toggle.weapon < 15)){
				deVal = this.toggle.weapon * 4;
				if(this.toggle.weapon > 9){
					deVal = (this.toggle.weapon - 10) * 4;
				}
			}
			enemy.combatSpur.res -= deVal;
			boostText += this.name + " gets +5 to atk & spd and inflicts -" + deVal + " res on " + enemy.name + " from HP >= 25% with " + data.skills[this.weaponIndex].name + ".<br>";
		}
		if(this.hasExactly("Partnership Bow") && this.combatStartHp / this.maxHp >= 0.25){
			this.combatSpur.atk += 5;
			this.combatSpur.spd += 5;
			this.combatSpur.def += 5;
			this.combatSpur.res += 5;
			var deVal = 0;
			if((this.toggle.weapon > 0 && this.toggle.weapon < 5) || (this.toggle.weapon > 10 && this.toggle.weapon < 15)){
				deVal = this.toggle.weapon * 4;
				if(this.toggle.weapon > 9){
					deVal = (this.toggle.weapon - 10) * 4;
				}
			}
			enemy.combatSpur.spd -= deVal;
			enemy.combatSpur.def -= deVal;
			boostText += this.name + " gets +5 to all stats and inflicts -" + deVal + " spd & def on " + enemy.name + " from HP >= 25% with Partnership Bow.<br>";
		}
		if(this.hasExactly("Radiant Aureola") && (!this.initiator || enemy.combatStartHp / enemy.maxHp >= 0.75)){
			this.combatSpur.atk += 5;
			this.combatSpur.spd += 5;
			this.combatSpur.def += 5;
			this.combatSpur.res += 5;
			boostText += this.name + " gets +5 to all stats from enemy initiating or enemy HP >= 75% with Radiant Aureola.<br>";
		}
		if(this.hasExactly("Bern's New Way") && this.toggle.c == 1){
			this.combatSpur.atk += 5;
			this.combatSpur.spd += 5;
			this.combatSpur.def += 5;
			this.combatSpur.res += 5;
			boostText += this.name + " gets +5 to all stats from being within 3 spaces of an ally with Bern's New Way.<br>";
		}
		if(this.hasExactly("Venin Edge") && this.rValue > 0){
			if(this.combatStartHp / this.maxHp >= 0.25){
				this.combatSpur.atk += 4;
				this.combatSpur.spd += 4;
				this.combatSpur.def += 4;
				this.combatSpur.res += 4;
				boostText += this.name + " gets +4 to all stats from HP >= 25% with Venin Edge.<br>";
			}
			if(this.rValue == 5 && this.buddy.adjacent < 2){
				this.combatSpur.atk += 4;
				this.combatSpur.spd += 4;
				this.combatSpur.def += 4;
				this.combatSpur.res += 4;
				boostText += this.name + " gets +4 to all stats from # of adjacent allies <= 1 with Venin Edge.<br>";
			}
		}
		if(this.hasExactly("Randgridr")){
			if(enemy.combatStartHp / enemy.maxHp >= 1 || (this.rValue > 0 && enemy.combatStartHp / enemy.maxHp >= 0.75)){
				var rText = "enemy HP = 100%";
				if(this.rValue > 0){
					rText = "enemy HP >= 75%";
				}
				enemy.combatSpur.atk -= 6;
				enemy.combatSpur.def -= 6;
				if(this.penalty.panic){
					this.combatBuffs = {"atk":0,"spd":0,"def":0,"res":0};
					this.buffs = {"atk":0,"spd":0,"def":0,"res":0};
				}
				this.combatDebuffs = {"atk":0,"spd":0,"def":0,"res":0};
				this.debuffs = {"atk":0,"spd":0,"def":0,"res":0};
				boostText += this.name + " neutralizes penalties and inflicts -6 atk and def on " + enemy.name + " from " + rText + " with Randgridr.<br>";
			}
			if(this.rValue == 5 && (this.initiator || this.toggle.weapon == 1 || this.toggle.weapon == 3)){
				var rTotal = 4 + (this.prfVal * 2);
				this.combatSpur.atk += rTotal;
				this.combatSpur.spd += rTotal;
				this.combatSpur.def += rTotal;
				this.combatSpur.res += rTotal;
				boostText += this.name + " gets +" + rTotal + " to all stats from initiating or being within 2 spaces of an ally with Randgridr.<br>";
			}
		}
		if(this.hasExactly("Prized Lance")){
			if(enemy.combatStartHp / enemy.maxHp >= 1 || (this.rValue > 0 && (this.initiator || enemy.combatStartHp / enemy.maxHp >= 0.75))){
				var pText = "enemy HP = 100%";
				if(this.rValue > 0){
					pText = "initiating or enemy HP >= 75%";
				}
				this.combatSpur.atk += 4;
				this.combatSpur.spd += 4;
				this.combatSpur.def += 4;
				this.combatSpur.res += 4;
				boostText += this.name + " gets +4 to all stats from " + pText + " with Prized Lance.<br>";
			}
			if(this.rValue == 5 && this.combatStartHp / this.maxHp >= 0.25){
				this.combatSpur.atk += 4;
				this.combatSpur.spd += 4;
				this.combatSpur.def += 4;
				this.combatSpur.res += 4;
				boostText += this.name + " gets +4 to all stats from HP >= 25% with Prized Lance.<br>";
			}
		}
		if(this.hasExactly("Desert-Tiger Axe")){
			if(this.combatStartHp / this.maxHp >= 0.25){
				this.combatSpur.atk += 4;
				this.combatSpur.spd += 4;
				this.combatSpur.def += 4;
				this.combatSpur.res += 4;
				boostText += this.name + " gets +4 to all stats from HP >= 25% with Desert-Tiger Axe.<br>";
			}
			if(this.rValue == 5 && this.toggle.weapon == 1){
				this.combatSpur.atk += 4;
				this.combatSpur.spd += 4;
				this.combatSpur.def += 4;
				this.combatSpur.res += 4;
				boostText += this.name + " gets +4 to all stats from being within 3 spaces of an ally with Desert-Tiger Axe.<br>";
			}
		}
		if(this.hasExactly("Divine Draught") && this.combatStartHp / this.maxHp >= 0.25){
			this.combatSpur.atk += 5;
			this.combatSpur.spd += 5;
			this.combatSpur.def += 5;
			this.combatSpur.res += 5;
			boostText += this.name + " gets +5 to all stats from HP >= 25% with Divine Draught.<br>";
		}
		if(this.hasExactly("Ice-Bound Brand") && (!this.initiator || enemy.combatStartHp / enemy.maxHp >= 0.75)){
			this.combatSpur.atk += 5;
			this.combatSpur.spd += 5;
			this.combatSpur.def += 5;
			this.combatSpur.res += 5;
			var idVal = Math.floor(allStats[17] * 0.2);
			enemy.combatSpur.atk -= idVal;
			enemy.combatSpur.spd -= idVal;
			boostText += this.name + " gets +5 to all stats and inflicts -" + idVal + " atk & spd to " + enemy.name + " from enemy initiating or enemy HP >= 75% with Ice-Bound Brand.<br>";
		}
		if(this.has("Seashell Bowl") && this.combatStartHp / this.maxHp >= 0.25){
			this.combatSpur.atk += 5;
			this.combatSpur.spd += 5;
			var sbVal = Math.floor(this.combatStartHp * 0.25);
			sbVal = Math.min(sbVal,10);
			enemy.combatSpur.spd -= sbVal;
			enemy.combatSpur.res -= sbVal;
			boostText += this.name + " gets +5 to atk & spd and inflicts -" + sbVal + " spd & res to " + enemy.name + " from HP >= 25% with " + data.skills[this.weaponIndex].name + ".<br>";
		}
		if((this.has("Wooden Tackle") || this.has("Campaign Lance") || this.has("Campaign Blade")) && this.combatStartHp / this.maxHp >= 0.25){
			this.combatSpur.atk += 5;
			this.combatSpur.def += 5;
			var wtVal = Math.floor(this.combatStartHp * 0.25);
			wtVal = Math.min(wtVal,10);
			enemy.combatSpur.atk -= wtVal;
			enemy.combatSpur.def -= wtVal;
			boostText += this.name + " gets +5 to atk & def and inflicts -" + wtVal + " atk & def to " + enemy.name + " from HP >= 25% with " + data.skills[this.weaponIndex].name + ".<br>";
		}
		if((this.hasExactly("Fair-Fight Blade") || this.hasExactly("Tome of Luxuries")) && this.combatStartHp / this.maxHp >= 0.25){
			this.combatSpur.atk += 5;
			this.combatSpur.spd += 5;
			this.combatSpur.def += 5;
			this.combatSpur.res += 5;
			boostText += this.name + " gets +5 to all stats from HP >= 25% with " + data.skills[this.weaponIndex].name + ".<br>";
		}
		if(this.hasExactly("Arcane Darkbow") && this.combatStartHp / this.maxHp >= 0.25){
			this.combatSpur.atk += 6;
			this.combatSpur.spd += 6;
			if(this.penalty.panic){
				this.combatBuffs = {"atk":0,"spd":0,"def":0,"res":0};
				this.buffs = {"atk":0,"spd":0,"def":0,"res":0};
			}
			this.combatDebuffs = {"atk":0,"spd":0,"def":0,"res":0};
			this.debuffs = {"atk":0,"spd":0,"def":0,"res":0};
			boostText += this.name + " gets +6 to atk & spd and neutralizes penalties from HP >= 25% with Arcane Darkbow.<br>";
		}
		if(this.hasExactly("Arcane Nihility") && this.combatStartHp / this.maxHp >= 0.25){
			this.combatSpur.atk += 5;
			this.combatSpur.spd += 5;
			this.combatSpur.def += 5;
			this.combatSpur.res += 5;
			boostText += this.name + " gets +5 to all stats from HP >= 25% with Arcane Nihility.<br>";
			if(checkAllBuffs(enemy, this, currTurn) && allStats[9]){
				var extraStats = [0,0,0,0];
				var buffText = "";
				var debuffText = "";
				if(!allStats[15][0]){
					extraStats[0] = Math.max(enemy.buffs.atk,enemy.combatBuffs.atk);
					if(extraStats[0] > 0){
						this.combatSpur.atk += extraStats[0];
						enemy.combatSpur.atk -= extraStats[0];
						buffText += " +" + extraStats[0] + " atk";
						debuffText += " -" + extraStats[0] + " atk";
					}
				}
				if(!allStats[15][1]){
					extraStats[1] = Math.max(enemy.buffs.spd,enemy.combatBuffs.spd);
					if(extraStats[1] > 0){
						this.combatSpur.spd += extraStats[1];
						enemy.combatSpur.spd -= extraStats[1];
						buffText += " +" + extraStats[1] + " spd";
						debuffText += " -" + extraStats[1] + " spd";
					}
				}
				if(!allStats[15][2]){
					extraStats[2] = Math.max(enemy.buffs.def,enemy.combatBuffs.def);
					if(extraStats[2] > 0){
						this.combatSpur.def += extraStats[2];
						enemy.combatSpur.def -= extraStats[2];
						buffText += " +" + extraStats[2] + " def";
						debuffText += " -" + extraStats[2] + " def";
					}
				}
				if(!allStats[15][3]){
					extraStats[3] = Math.max(enemy.buffs.res,enemy.combatBuffs.res);
					if(extraStats[3] > 0){
						this.combatSpur.res += extraStats[3];
						enemy.combatSpur.res -= extraStats[3];
						buffText += " +" + extraStats[3] + " res";
						debuffText += " -" + extraStats[3] + " res";
					}
				}
				boostText += this.name + " gets" + buffText + " and inflicts" + debuffText + " to " + enemy.name + " from HP >= 25% and enemy having buffs with Arcane Nihility.<br>";
			}
		}
		if(this.hasExactly("Power of Nihility") && this.toggle.a == 1){
			this.combatSpur.atk += 9;
			this.combatSpur.spd += 9;
			this.combatSpur.def += 9;
			this.combatSpur.res += 9;
			boostText += this.name + " gets +9 to all stats from # of adjacent allies <= 1 with Power of Nihility.<br>";
		}
		if(this.hasExactly("Dream Deliverer") && this.toggle.c > 1){
			this.combatSpur.def += 4;
			this.combatSpur.res += 4;
			boostText += this.name + " gets +4 to def & res from being within 3 spaces of an ally with Dream Deliverer.<br>";
		}
		if(this.hasExactly("Nightmare Horn") && this.rValue > 0){
			if(enemy.combatStartHp / enemy.maxHp >= 0.5){
				this.combatSpur.atk += 4;
				this.combatSpur.spd += 4;
				this.combatSpur.def += 4;
				this.combatSpur.res += 4;
				boostText += this.name + " gets +4 to all stats from enemy HP >= 50% with Nightmare Horn.<br>";
			}
			if(this.rValue == 5 && this.combatStartHp / this.maxHp >= 0.25){
				this.combatSpur.atk += 4;
				this.combatSpur.spd += 4;
				this.combatSpur.def += 4;
				this.combatSpur.res += 4;
				boostText += this.name + " gets +4 to all stats from HP >= 25% with Nightmare Horn.<br>";
			}
		}
		if(this.hasExactly("Thracia Kinglance")){
			if(!this.initiator || enemy.combatStartHp / enemy.maxHp >= 0.75){
				this.combatSpur.atk += 4;
				this.combatSpur.spd += 4;
				this.combatSpur.def += 4;
				this.combatSpur.res += 4;
				var tkVal = Math.floor(allStats[18] * 0.15);
				enemy.combatSpur.atk -= tkVal;
				boostText += this.name + " gets +4 to all stats and inflicts -" + tkVal + " atk to " + enemy.name + " from enemy initiating or enemy HP >= 75% with Thracia Kinglance.<br>";
			}
			if(this.rValue == 5 && this.combatStartHp / this.maxHp >= 0.25){
				this.combatSpur.atk += 4;
				this.combatSpur.spd += 4;
				this.combatSpur.def += 4;
				this.combatSpur.res += 4;
				boostText += this.name + " gets +4 to all stats from HP >= 25% with Thracia Kinglance.<br>";
			}
		}
		if(this.hasExactly("Western Axe")){
			if(this.toggle.weapon == 1){
				this.combatSpur.atk += 4;
				this.combatSpur.spd += 4;
				this.combatSpur.def += 4;
				this.combatSpur.res += 4;
				boostText += this.name + " gets +4 to all stats from being within 3 spaces of an ally with Western Axe.<br>";
			}
			if(this.rValue == 5 && (!this.initiator || enemy.combatStartHp / enemy.maxHp >= 0.75)){
				var dAtk = 4 + (Math.min(this.combatDebuffs.atk,this.debuffs.atk) * -2);
				var dSpd = 4 + (Math.min(this.combatDebuffs.spd,this.debuffs.spd) * -2);
				var dDef = 4 + (Math.min(this.combatDebuffs.def,this.debuffs.def) * -2);
				var dRes = 4 + (Math.min(this.combatDebuffs.res,this.debuffs.res) * -2);
				if(this.penalty.panic){
					dAtk += Math.max(this.combatBuffs.atk,this.buffs.atk) * 2;
					dSpd += Math.max(this.combatBuffs.spd,this.buffs.spd) * 2;
					dDef += Math.max(this.combatBuffs.def,this.buffs.def) * 2;
					dRes += Math.max(this.combatBuffs.res,this.buffs.res) * 2;
				}
				this.combatSpur.atk += dAtk;
				this.combatSpur.spd += dSpd;
				this.combatSpur.def += dDef;
				this.combatSpur.res += dRes;
				boostText += this.name + " gets net + " + dAtk + "/" + dSpd + "/" + dDef + "/" + dRes + " in stats from having penalty active with Western Axe.<br>";
			}
		}
		if(this.hasExactly("Baked Treats") && (this.initiator || this.buddy.adjacent > 0 || this.buddy.two > 0)){
			this.combatSpur.atk += 6;
			this.combatSpur.spd += 6;
			boostText += this.name + " gets +6 to atk & spd from initiating or being within 2 spaces of an ally with Baked Treats.<br>";
		}
		if(this.hasExactly("Mastermind") && (this.initiator || this.buddy.adjacent > 0 || this.buddy.two > 0)){
			this.combatSpur.atk += 9;
			this.combatSpur.spd += 9;
			boostText += this.name + " gets +9 to atk & spd from initiating or being within 2 spaces of an ally with Mastermind.<br>";
		}
		if(this.hasExactly("Knightly Manner") && this.combatStartHp / this.maxHp >= 0.25){
			this.combatSpur.atk += 5;
			this.combatSpur.spd += 5;
			this.combatSpur.def += 5;
			this.combatSpur.res += 5;
			boostText += this.name + " gets +5 to all stats from HP >= 25% with Knightly Manner.<br>";
		}
		if(this.has("Teatime Set") && (this.initiator || this.buddy.adjacent > 0 || this.buddy.two > 0)){
			this.combatSpur.atk += 5;
			this.combatSpur.spd += 5;
			boostText += this.name + " gets +5 to atk & spd from initiating or being within 2 spaces of an ally with " + data.skills[this.weaponIndex].name + ".<br>";
		}
		if(this.hasExactly("Teatime's Edge") && this.combatStartHp / this.maxHp >= 0.25){
			var teVal = Math.floor(allStats[20] * 0.25) - 2;
			teVal = Math.min(teVal,16);
			teVal = Math.max(teVal,6);
			this.combatSpur.atk += teVal;
			this.combatSpur.spd += teVal;
			boostText += this.name + " gets +" + teVal + " to atk & spd from HP >= 25% with Teatime's Edge.<br>";
		}
		if(this.has("Teacake Tower") && (this.initiator || this.buddy.adjacent > 0 || this.buddy.two > 0)){
			this.combatSpur.atk += 4;
			this.combatSpur.spd += 4;
			this.combatSpur.def += 4;
			this.combatSpur.res += 4;
			var dAtk = Math.max(enemy.combatBuffs.atk,enemy.buffs.atk) * -2;
			var dSpd = Math.max(enemy.combatBuffs.spd,enemy.buffs.spd) * -2;
			var dDef = Math.max(enemy.combatBuffs.def,enemy.buffs.def) * -2;
			var dRes = Math.max(enemy.combatBuffs.res,enemy.buffs.res) * -2;
			if(enemy.penalty.panic){
				dAtk = 0;
				dSpd = 0;
				dDef = 0;
				dRes = 0;
			}
			enemy.combatSpur.atk += dAtk;
			enemy.combatSpur.spd += dSpd;
			enemy.combatSpur.def += dDef;
			enemy.combatSpur.res += dRes;
			boostText += this.name + " gets +4 to all stats and inflicts " + dAtk + "/" + dSpd + "/" + dDef + "/" + dRes + " in stats to " + enemy.name + " from initiating or being within 2 spaces of an ally with " + data.skills[this.weaponIndex].name + ".<br>";
		}
		if(this.hasExactly("Arch-Sage Tome") && (this.buddy.adjacent > 0 || this.buddy.two > 0 || this.buddy.three > 0)){
			var dAtk = 5 + this.buddy.buffs.atk;
			var dSpd = 5 + this.buddy.buffs.spd;
			var dDef = 5 + this.buddy.buffs.def;
			var dRes = 5 + this.buddy.buffs.res;
			if(!this.penalty.panic){
				dAtk = Math.max(this.combatBuffs.atk,this.buffs.atk,this.buddy.buffs.atk) + 5;
				dSpd = Math.max(this.combatBuffs.spd,this.buffs.spd,this.buddy.buffs.spd) + 5;
				dDef = Math.max(this.combatBuffs.def,this.buffs.def,this.buddy.buffs.def) + 5;
				dRes = Math.max(this.combatBuffs.res,this.buffs.res,this.buddy.buffs.res) + 5;
			}
			this.combatSpur.atk += dAtk;
			this.combatSpur.spd += dSpd;
			this.combatSpur.def += dDef;
			this.combatSpur.res += dRes;
			boostText += this.name + " gets + " + dAtk + "/" + dSpd + "/" + dDef + "/" + dRes + " in stats from being within 3 spaces of an ally with Arch-Sage Tome.<br>";
		}
		if(this.hasExactly("Rare Talent") && this.combatStartHp / this.maxHp >= 0.25){
			this.combatSpur.atk += 7;
			this.combatSpur.spd += 7;
			this.combatSpur.def += 7;
			this.combatSpur.res += 7;
			boostText += this.name + " gets +7 to all stats from HP >= 25% with Rare Talent.<br>";
		}
		if(this.hasExactly("The Cycle's Turn") && (this.initiator || this.toggle.weapon == 1 || checkAllBuffs(this, enemy, currTurn))){
			var ctVal = Math.min(currTurn*2,10) + 5;
			this.combatSpur.atk += ctVal;
			this.combatSpur.spd += ctVal;
			this.combatSpur.def += 5;
			this.combatSpur.res += 5;
			boostText += this.name + " gets +" + ctVal + " to atk & spd and +5 to def & res from initiating or having a [Bonus] active with The Cycle's Turn.<br>";
		}
		if(this.hasExactly("Deliverer's Brand") && this.combatStartHp / this.maxHp >= 0.25){
			this.combatSpur.atk += 5;
			this.combatSpur.spd += 5;
			this.combatSpur.def += 5;
			this.combatSpur.res += 5;
			boostText += this.name + " gets +5 to all stats from HP >= 25% with Deliverer's Brand.<br>";
		}
		if(this.hasExactly("Aptitude Arrows") && this.combatStartHp / this.maxHp >= 0.25){
			this.combatSpur.atk += 10;
			this.combatSpur.spd += 10;
			this.combatSpur.def += 10;
			this.combatSpur.res += 10;
			if(this.penalty.panic){
				this.combatBuffs = {"atk":0,"spd":0,"def":0,"res":0};
				this.buffs = {"atk":0,"spd":0,"def":0,"res":0};
			}
			this.combatDebuffs = {"atk":0,"spd":0,"def":0,"res":0};
			this.debuffs = {"atk":0,"spd":0,"def":0,"res":0};
			boostText += this.name + " gets +10 to all stats and neutralizes penalties from HP >= 25% with Aptitude Arrows.<br>";
		}
		if((this.hasExactly("Dragon's Fist") || this.hasExactly("Divine One's Arts")) && this.combatStartHp / this.maxHp >= 0.25){
			this.combatSpur.atk += 5;
			this.combatSpur.spd += 5;
			this.combatSpur.def += 5;
			this.combatSpur.res += 5;
			var sVal = 4;
			if(this.toggle.weapon > 0){
				sVal += this.toggle.weapon * 3;
			}
			enemy.combatSpur.atk -= sVal;
			enemy.combatSpur.spd -= sVal;
			enemy.combatSpur.def -= sVal;
			enemy.combatSpur.res -= sVal;
			boostText += this.name + " gets +5 to all stats and inflicts -" + sVal + " all stats to " + enemy.name + " from HP >= 25% with " + data.skills[this.weaponIndex].name + ".<br>";
		}
		if(this.hasExactly("Hel's Reaper") && this.rValue > 0){
			if(!this.initiator || enemy.combatStartHp / enemy.maxHp >= 0.5){
				this.combatSpur.atk += 4;
				this.combatSpur.spd += 4;
				this.combatSpur.def += 4;
				this.combatSpur.res += 4;
				boostText += this.name + " gets +4 to all stats from enemy initiating or enemy HP >= 50% with Hel's Reaper.<br>";
			}
			if(this.rValue == 5 && (this.combatStartHp / this.maxHp >= 0.25 || this.toggle.weapon == 1)){
				this.combatSpur.atk += 4;
				this.combatSpur.spd += 4;
				this.combatSpur.def += 4;
				this.combatSpur.res += 4;
				boostText += this.name + " gets +4 to all stats from HP >= 25% or [Penalty] active on enemy with Hel's Reaper.<br>";
			}
		}
		if(this.hasExactly("Mirage Falchion")){
			var mfVal = 0;
			var mfText = "atk & def from initiating";
			if(this.initiator){
				if(this.rValue < 0){
					mfVal = 3 + (this.toggle.weapon * 2);
				}
				else{
					mfVal = 4 + (this.toggle.weapon * 3);
					this.combatSpur.spd += mfVal;
					this.combatSpur.res += mfVal;
					mfText = "to all stats from initiating";
				}
			}
			else{
				if(this.rValue < 0){
					mfVal = 7 - (this.toggle.weapon * 2);
					mfText = "atk & def from enemy initiating";
				}
				else{
					mfVal = 10 - (this.toggle.weapon * 3);
					this.combatSpur.spd += mfVal;
					this.combatSpur.res += mfVal;
					mfText = "to all stats from enemy initiating";
				}
			}
			this.combatSpur.atk += mfVal;
			this.combatSpur.def += mfVal;
			boostText += this.name + " gets +" + mfVal + " " + mfText + " with Mirage Falchion.<br>";
			if(this.rValue == 5 && (this.initiator || this.buddy.adjacent > 0 || this.buddy.two > 0)){
				this.combatSpur.atk += 4;
				this.combatSpur.spd += 4;
				this.combatSpur.def += 4;
				this.combatSpur.res += 4;
				boostText += this.name + " gets +4 to all stats from initiating or being within 2 spaces of an ally with Mirage Falchion.<br>";
			}
		}
		if(this.hasExactly("Phantasm Tome")){
			if(enemy.combatStartHp / enemy.maxHp >= 0.5 || (this.rValue > 0 && this.initiator)){
				enemy.combatSpur.spd -= 6;
				enemy.combatSpur.res -= 6;
				boostText += this.name + " has activated Phantasm Tome. Effect on " + enemy.name + ": -6 to spd and res.<br>";
			}
			if(this.rValue == 5 && this.combatStartHp / this.maxHp >= 0.25){
				this.combatSpur.atk += 5;
				this.combatSpur.spd += 5;
				this.combatSpur.def += 5;
				this.combatSpur.res += 5;
				boostText += this.name + " gets +5 to all stats from HP >= 25% with Phantasm Tome.<br>";
			}
		}
		if(this.hasExactly("Playful Pinwheel") && this.combatStartHp / this.maxHp >= 0.25){
			this.combatSpur.atk += 5;
			this.combatSpur.spd += 5;
			this.combatSpur.def += 5;
			this.combatSpur.res += 5;
			var pTotal = (Object.values(this.bonus).reduce((a, item) => a + (item === true ? 1 : 0), 0) + this.bonus.extra + Object.values(enemy.penalty).reduce((a, item) => a + (item === true ? 1 : 0), 0) + enemy.penalty.extra) * 2;
			this.combatSpur.atk += pTotal;
			this.combatSpur.spd += pTotal;
			boostText += this.name + " gets +5 to all stats and an additional +" + pTotal + " atk & spd from HP >= 25% with Playful Pinwheel.<br>";
		}
		if(this.hasExactly("Fujin Uchiwa") && this.combatStartHp / this.maxHp >= 0.25){
			var extraStats = [0,0,0,0];
			var buffText = "";
			var debuffText = "";
			if(checkAllBuffs(enemy, this, currTurn) && allStats[9]){
				if(!allStats[15][0]){
					extraStats[0] = Math.max(enemy.buffs.atk,enemy.combatBuffs.atk);
					enemy.combatSpur.atk -= extraStats[0];
					debuffText += " -" + extraStats[0] + " atk";
				}
				if(!allStats[15][1]){
					extraStats[1] = Math.max(enemy.buffs.spd,enemy.combatBuffs.spd);
					enemy.combatSpur.spd -= extraStats[1];
					debuffText += " -" + extraStats[1] + " spd";
				}
				if(!allStats[15][2]){
					extraStats[2] = Math.max(enemy.buffs.def,enemy.combatBuffs.def);
					enemy.combatSpur.def -= extraStats[2];
					debuffText += " -" + extraStats[2] + " def";
				}
				if(!allStats[15][3]){
					extraStats[3] = Math.max(enemy.buffs.res,enemy.combatBuffs.res);
					enemy.combatSpur.res -= extraStats[3];
					debuffText += " -" + extraStats[3] + " res";
				}
				if(debuffText != ""){
					debuffText = " and inflicts" + debuffText + " to " + enemy.name;
				}
			}
			if(checkAllBuffs(this, enemy, currTurn) && allStats[8]){
				if(!allStats[14][0]){
					extraStats[0] = Math.max(extraStats[0],this.buffs.atk,this.combatBuffs.atk);
				}
				if(!allStats[14][1]){
					extraStats[1] = Math.max(extraStats[1],this.buffs.spd,this.combatBuffs.spd);
				}
				if(!allStats[14][2]){
					extraStats[2] = Math.max(extraStats[2],this.buffs.def,this.combatBuffs.def);
				}
				if(!allStats[14][3]){
					extraStats[3] = Math.max(extraStats[3],this.buffs.res,this.combatBuffs.res);
				}
			}
			extraStats[0] += 5;
			buffText += " +" + extraStats[0] + " atk";
			extraStats[1] += 5;
			buffText += " +" + extraStats[1] + " spd";
			extraStats[2] += 5;
			buffText += " +" + extraStats[2] + " def";
			extraStats[3] += 5;
			buffText += " +" + extraStats[3] + " res";
			this.combatSpur.atk += extraStats[0];
			this.combatSpur.spd += extraStats[1];
			this.combatSpur.def += extraStats[2];
			this.combatSpur.res += extraStats[3];
			boostText += this.name + " gets" + buffText + debuffText + " from HP >= 25% with Fujin Uchiwa.<br>";
		}
		if((this.has("Whitewind Bow") || this.has("Lucrative Bow") || this.has("Gainful Dagger")) && this.combatStartHp / this.maxHp >= 0.25){
			var pTotal = (Object.values(this.bonus).reduce((a, item) => a + (item === true ? 1 : 0), 0) + this.bonus.extra + Object.values(enemy.penalty).reduce((a, item) => a + (item === true ? 1 : 0), 0) + enemy.penalty.extra) * 2 + 5;
			this.combatSpur.atk += pTotal;
			this.combatSpur.spd += pTotal;
			boostText += this.name + " gets +" + pTotal + " atk & spd from HP >= 25% with " + data.skills[this.weaponIndex].name + ".<br>";
		}
		if(this.hasExactly("Brightwind Fans") && this.combatStartHp / this.maxHp >= 0.25){
			this.combatSpur.atk += 5;
			this.combatSpur.spd += 5;
			this.combatSpur.def += 5;
			this.combatSpur.res += 5;
			var idVal = Math.floor(allStats[17] * 0.2);
			this.combatSpur.atk += idVal;
			this.combatSpur.spd += idVal;
			boostText += this.name + " gets +5 to all stats and an additional +" + idVal + " to atk & spd from HP >= 25% with Brightwind Fans.<br>";
		}
		if(this.has("Wind Tribe Club") && this.combatStartHp / this.maxHp >= 0.25){
			var pTotal = (Object.values(this.bonus).reduce((a, item) => a + (item === true ? 1 : 0), 0) + this.bonus.extra + Object.values(enemy.penalty).reduce((a, item) => a + (item === true ? 1 : 0), 0) + enemy.penalty.extra) * 2 + 5;
			this.combatSpur.atk += pTotal;
			this.combatSpur.def += pTotal;
			boostText += this.name + " gets +" + pTotal + " atk & def from HP >= 25% with " + data.skills[this.weaponIndex].name + ".<br>";
		}
		if(this.hasExactly("Heired Forseti") && this.combatStartHp / this.maxHp >= 0.25){
			this.combatSpur.atk += 6;
			this.combatSpur.spd += 6;
			boostText += this.name + " gets +6 to atk & spd from HP >= 25% with Heired Forseti.<br>";
		}
		if(this.hasExactly("Heired Yewfelle") && (this.initiator || this.buddy.adjacent > 0 || this.buddy.two > 0)){
			this.combatSpur.atk += 5;
			this.combatSpur.spd += 5;
			this.combatSpur.def += 5;
			this.combatSpur.res += 5;
			var hyVal = Math.floor(allStats[20] * 0.25) - 8;
			hyVal = Math.min(hyVal,10);
			hyVal = Math.max(hyVal,0);
			this.combatSpur.atk += hyVal;
			this.combatSpur.spd += hyVal;
			boostText += this.name + " gets +5 to all stats and an additional +" + hyVal + " to atk & spd from initiating or being within 2 spaces of an ally with Heired Yewfelle.<br>";
		}
		if(this.has("Protection Edge") && (this.buddy.adjacent > 0 || this.buddy.two > 0 || this.buddy.three > 0)){
			this.combatSpur.atk += 5;
			this.combatSpur.def += 5;
			boostText += this.name + " gets +5 to atk & def from being within 3 spaces of an ally with " + data.skills[this.weaponIndex].name + ".<br>";
		}
		if(this.hasExactly("Heired Gungnir") && this.combatStartHp / this.maxHp >= 0.25){
			this.combatSpur.atk += 5;
			this.combatSpur.spd += 5;
			this.combatSpur.def += 5;
			this.combatSpur.res += 5;
			boostText += this.name + " gets +5 to all stats from HP >= 25% with Heired Gungnir.<br>";
		}
		if(this.hasExactly("Absolute Amiti") && (this.buddy.adjacent > 0 || this.buddy.two > 0 || this.buddy.three > 0)){
			this.combatSpur.atk += 5;
			this.combatSpur.spd += 5;
			this.combatSpur.def += 5;
			this.combatSpur.res += 5;
			var aaVal = 3;
			if(enemy.specialIndex != -1){
				aaVal = 11 - ((data.skills[enemy.specialIndex].charge - enemy.initSkillCharge()) * 2);
				aaVal = Math.max(aaVal,3);
			}
			this.combatSpur.atk += aaVal;
			this.combatSpur.spd += aaVal;
			boostText += this.name + " gets +5 to all stats and an additional +" + aaVal + " to atk & spd from being within 3 spaces of an ally with Absolute Amiti.<br>";
		}
		if(this.hasExactly("Mirage Feather")){
			if((this.rValue < 0 && this.initiator && this.toggle.weapon == 1) || (this.rValue > 0 && (this.initiator || this.buddy.adjacent > 0 || this.buddy.two > 0))){
				this.combatSpur.atk += 6;
				this.combatSpur.spd += 6;
				var mfText = "after an ally has already acted";
				if(this.rValue > 0){
					mfText = "or being within 2 spaces of an ally";
				}
				boostText += this.name + " gets +6 to atk and spd from initiating " + mfText + " with Mirage Feather.<br>";
			}
			if(this.rValue == 5 && this.combatStartHp / this.maxHp >= 0.25){
				this.combatSpur.atk += 5;
				this.combatSpur.spd += 5;
				if(this.penalty.panic){
					this.combatBuffs.atk = 0;
					this.combatBuffs.spd = 0;
					this.buffs.atk = 0;
					this.buffs.spd = 0;
				}
				this.combatDebuffs.atk = 0;
				this.combatDebuffs.spd = 0;
				this.debuffs.atk = 0;
				this.debuffs.spd = 0;
				boostText += this.name + " gets +5 to atk & spd and neutralizes penalties to atk & spd from HP >= 25% with Mirage Feather.<br>";
				if(this.initiator && this.toggle.weapon == 1){
					this.combatSpur.atk += 5;
					this.combatSpur.spd += 5;
					boostText += this.name + " gets an additional +5 to atk & spd from initiating after an ally has already acted with Mirage Feather.<br>";
				}
			}
		}
		if(this.hasExactly("Bun-Bun Baton") && this.rValue > 0){
			if(this.combatStartHp / this.maxHp >= 0.25){
				this.combatSpur.atk += 4;
				this.combatSpur.spd += 4;
				this.combatSpur.def += 4;
				this.combatSpur.res += 4;
				boostText += this.name + " gets +4 to all stats from HP >= 25% with Bun-Bun Baton.<br>";
			}
			if(this.rValue == 5 && (!this.initiator || enemy.combatStartHp / enemy.maxHp >= 0.75)){
				this.combatSpur.atk += 4;
				this.combatSpur.spd += 4;
				this.combatSpur.def += 4;
				this.combatSpur.res += 4;
				boostText += this.name + " gets +4 to all stats from enemy initiating or enemy HP >= 75% with Bun-Bun Baton.<br>";
			}
		}
		if(this.hasExactly("Hyperion Lance")){
			if(!this.initiator || enemy.combatStartHp / enemy.maxHp >= 0.75){
				this.combatSpur.atk += 4;
				this.combatSpur.spd += 4;
				this.combatSpur.def += 4;
				this.combatSpur.res += 4;
				var hlVal = Math.floor(allStats[18] * 0.1);
				enemy.combatSpur.atk -= hlVal;
				enemy.combatSpur.spd -= hlVal;
				enemy.combatSpur.def -= hlVal;
				boostText += this.name + " gets +4 to all stats and inflicts -" + hlVal + " atk/spd/def to " + enemy.name + " from from enemy initiating or enemy HP >= 75% with Hyperion Lance.<br>";
			}
			if(this.rValue == 5 && this.combatStartHp / this.maxHp >= 0.25){
				this.combatSpur.atk += 4;
				this.combatSpur.spd += 4;
				this.combatSpur.def += 4;
				this.combatSpur.res += 4;
				boostText += this.name + " gets +4 to all stats from HP >= 25% with Hyperion Lance.<br>";
			}
		}
		if(this.hasExactly("Wildcat Dagger")){
			if(this.combatStartHp / this.maxHp >= 0.25){
				this.combatSpur.atk += 4;
				this.combatSpur.spd += 4;
				this.combatSpur.def += 4;
				this.combatSpur.res += 4;
				boostText += this.name + " gets +4 to all stats";
				if(checkAllBuffs(enemy, this, currTurn) && allStats[9]){
					var extraStats = [0,0,0,0];
					var buffText = "";
					var debuffText = "";
					if(!allStats[15][0]){
						extraStats[0] = Math.max(enemy.buffs.atk,enemy.combatBuffs.atk);
						if(extraStats[0] > 0){
							this.combatSpur.atk += extraStats[0];
							enemy.combatSpur.atk -= extraStats[0];
							buffText += " +" + extraStats[0] + " atk";
							debuffText += " -" + extraStats[0] + " atk";
						}
					}
					if(!allStats[15][1]){
						extraStats[1] = Math.max(enemy.buffs.spd,enemy.combatBuffs.spd);
						if(extraStats[1] > 0){
							this.combatSpur.spd += extraStats[1];
							enemy.combatSpur.spd -= extraStats[1];
							buffText += " +" + extraStats[1] + " spd";
							debuffText += " -" + extraStats[1] + " spd";
						}
					}
					if(!allStats[15][2]){
						extraStats[2] = Math.max(enemy.buffs.def,enemy.combatBuffs.def);
						if(extraStats[2] > 0){
							this.combatSpur.def += extraStats[2];
							enemy.combatSpur.def -= extraStats[2];
							buffText += " +" + extraStats[2] + " def";
							debuffText += " -" + extraStats[2] + " def";
						}
					}
					if(!allStats[15][3]){
						extraStats[3] = Math.max(enemy.buffs.res,enemy.combatBuffs.res);
						if(extraStats[3] > 0){
							this.combatSpur.res += extraStats[3];
							enemy.combatSpur.res -= extraStats[3];
							buffText += " +" + extraStats[3] + " res";
							debuffText += " -" + extraStats[3] + " res";
						}
					}
					boostText += " and gets" + buffText + " and inflicts" + debuffText + " to " + enemy.name;
				}
				boostText += " from HP >= 25% with Wildcat Dagger.<br>";
			}
			if(this.rValue == 5 && (this.initiator || enemy.combatStartHp / enemy.maxHp >= 0.75)){
				this.combatSpur.atk += 4;
				this.combatSpur.spd += 4;
				this.combatSpur.def += 4;
				this.combatSpur.res += 4;
				boostText += this.name + " gets +4 to all stats from initiating or enemy HP >= 75% with Wildcat Dagger.<br>";
			}
		}
		if(this.hasExactly("Inspirited Spear") && this.combatStartHp / this.maxHp >= 0.25){
			this.combatSpur.atk += 5;
			this.combatSpur.spd += 5;
			this.combatSpur.def += 5;
			this.combatSpur.res += 5;
			var isVal = Math.floor(allStats[18] * 0.15);
			enemy.combatSpur.atk -= isVal;
			enemy.combatSpur.spd -= isVal;
			enemy.combatSpur.def -= isVal;
			boostText += this.name + " gets +5 to all stats and inflicts -" + isVal + " atk/spd/def to " + enemy.name + " from HP >= 25% with Inspirited Spear.<br>";
		}
		if(this.hasExactly("Kitty-Cat Parasol") && (this.initiator || this.buddy.adjacent > 0 || this.buddy.two > 0)){
			this.combatSpur.atk += 6;
			this.combatSpur.res += 6;
			boostText += this.name + " gets +6 to atk & res from initiating or being within 2 spaces of an ally with Kitty-Cat Parasol.<br>";
		}
		if((this.has("Pumpkin Stem") || this.has("Farmer's Tool") || this.has("Doubler Bow") || this.has("Doubler Sword") || this.has("Doubler Lance")) && (this.initiator || ((this.buddy.adjacent > 0 || this.buddy.two > 0) && this.toggle.weapon > 1))){
			var dAtk = 0;
			var dSpd = 0;
			var dDef = 0;
			var dRes = 0;
			if(this.buddy.adjacent > 0 || this.buddy.two > 0){
				dAtk = this.buddy.buffs.atk;
				dSpd = this.buddy.buffs.spd;
				dDef = this.buddy.buffs.def;
				dRes = this.buddy.buffs.res;
			}
			if(!this.penalty.panic){
				dAtk = Math.max(this.combatBuffs.atk,this.buffs.atk,dAtk);
				dSpd = Math.max(this.combatBuffs.spd,this.buffs.spd,dSpd);
				dDef = Math.max(this.combatBuffs.def,this.buffs.def,dDef);
				dRes = Math.max(this.combatBuffs.res,this.buffs.res,dRes);
			}
			dAtk += 4;
			dSpd += 4;
			dDef += 4;
			dRes += 4;
			this.combatSpur.atk += dAtk;
			this.combatSpur.spd += dSpd;
			this.combatSpur.def += dDef;
			this.combatSpur.res += dRes;
			boostText += this.name + " gets + " + dAtk + "/" + dSpd + "/" + dDef + "/" + dRes + " in stats from initiating or being within 2 spaces of an ally with " + data.skills[this.weaponIndex].name + ".<br>";
		}
		if(this.hasExactly("Payday Pouch") && (this.initiator || ((this.buddy.adjacent > 0 || this.buddy.two > 0) && this.toggle.weapon > 1))){
			this.combatSpur.atk += 5;
			this.combatSpur.spd += 5;
			this.combatSpur.def += 5;
			this.combatSpur.res += 5;
			var ppVal = Math.floor(allStats[20] * 0.25) - 8;
			ppVal = Math.max(ppVal,0);
			ppVal = Math.min(ppVal,10);
			this.combatSpur.atk += ppVal;
			this.combatSpur.spd += ppVal;
			boostText += this.name + " gets +5 to all stats and an additional +" + ppVal + " to atk & spd from initiating or being within 2 spaces of an ally with Payday Pouch.<br>";
		}
		if(this.hasExactly("Worldly Lance") && (this.initiator || ((this.buddy.adjacent > 0 || this.buddy.two > 0) && this.toggle.weapon > 1))){
			var wlVal = Math.floor(allStats[18] * 0.2) + 6;
			enemy.combatSpur.atk -= wlVal;
			enemy.combatSpur.def -= wlVal;
			boostText += this.name + " inflicts -" + wlVal + " atk & def to " + enemy.name + " from initiating or being within 2 spaces of an ally with Worldly Lance.<br>";
		}
		if((this.hasExactly("Flower of Tribute") || this.hasExactly("Flower of Caring")) && this.combatStartHp / this.maxHp >= 0.25){
			this.combatSpur.atk += 5;
			this.combatSpur.spd += 5;
			this.combatSpur.def += 5;
			this.combatSpur.res += 5;
			boostText += this.name + " gets +5 to all stats from HP >= 25% with " + data.skills[this.weaponIndex].name + ".<br>";
			if(this.hasExactly("Flower of Caring") && this.toggle.weapon == 1){
				this.combatSpur.atk += 4;
				this.combatSpur.spd += 4;
				this.combatSpur.def += 4;
				this.combatSpur.res += 4;
				boostText += this.name + " gets an additional +4 to all stats from HP >= 25% and having an ally in cardinal direction with " + data.skills[this.weaponIndex].name + ".<br>";
			}
		}
		if(this.hasExactly("Obscurite") && (this.initiator || ((this.buddy.adjacent > 0 || this.buddy.two > 0) && this.toggle.weapon > 1))){
			this.combatSpur.atk += 5;
			this.combatSpur.spd += 5;
			this.combatSpur.def += 5;
			this.combatSpur.res += 5;
			boostText += this.name + " gets +5 to all stats from initiating or being within 2 spaces of an ally with Obscurite.<br>";
		}
		if(this.hasExactly("Fell Protection") && (this.initiator || this.buddy.adjacent > 0 || this.buddy.two > 0)){
			this.combatSpur.atk += 5;
			this.combatSpur.res += 5;
			boostText += this.name + " gets +5 to atk & res from initiating or being within 2 spaces of an ally with Fell Protection.<br>";
		}
		if(this.hasExactly("Brilliant Rapier")){
			if(!this.initiator || enemy.combatStartHp / enemy.maxHp >= 0.75){
				this.combatSpur.atk += 4;
				this.combatSpur.spd += 4;
				this.combatSpur.def += 4;
				this.combatSpur.res += 4;
				boostText += this.name + " gets +4 to all stats from from enemy initiating or enemy HP >= 75% with Brilliant Rapier.<br>";
			}
			if(this.rValue == 5 && (this.initiator || this.buddy.adjacent > 0 || this.buddy.two > 0)){
				var dAtk = 0;
				var dSpd = 0;
				var dDef = 0;
				var dRes = 0;
				if(this.buddy.adjacent > 0 || this.buddy.two > 0){
					dAtk = this.buddy.buffs.atk;
					dSpd = this.buddy.buffs.spd;
					dDef = this.buddy.buffs.def;
					dRes = this.buddy.buffs.res;
				}
				if(!this.penalty.panic){
					dAtk = Math.max(this.combatBuffs.atk,this.buffs.atk,dAtk);
					dSpd = Math.max(this.combatBuffs.spd,this.buffs.spd,dSpd);
					dDef = Math.max(this.combatBuffs.def,this.buffs.def,dDef);
					dRes = Math.max(this.combatBuffs.res,this.buffs.res,dRes);
				}
				dAtk += 4;
				dSpd += 4;
				dDef += 4;
				dRes += 4;
				this.combatSpur.atk += dAtk;
				this.combatSpur.spd += dSpd;
				this.combatSpur.def += dDef;
				this.combatSpur.res += dRes;
				boostText += this.name + " gets + " + dAtk + "/" + dSpd + "/" + dDef + "/" + dRes + " in stats from initiating or being within 2 spaces of an ally with Brilliant Rapier.<br>";
			}
		}
		if(this.hasExactly("Flower of Plenty") && this.rValue > 0){
			if(this.toggle.weapon == 1){
				this.combatSpur.atk += 5;
				this.combatSpur.res += 5;
				boostText += this.name + " gets +5 to atk & res from having an ally within 5 rows & 3 columns with Flower of Plenty.<br>";
			}
			if(this.rValue == 5 && this.combatStartHp / this.maxHp >= 0.25){
				this.combatSpur.atk += 5;
				this.combatSpur.res += 5;
				boostText += this.name + " gets +5 to atk & res from HP >= 25% with Flower of Plenty.<br>";
			}
		}
		if(this.hasExactly("Earthly Gae Bolg")){
			if(enemy.moveType != "flying" || (this.rValue > 0 && this.combatStartHp / this.maxHp >= 0.5)){
				enemy.combatSpur.atk -= 5;
				enemy.combatSpur.def -= 5;
				boostText += this.name + " has activated Earthly Gae Bolg. Effect on " + enemy.name + ": -5 to atk and def.<br>";
			}
			if(this.rValue == 5 && (!this.initiator || enemy.combatStartHp / enemy.maxHp >= 0.75)){
				enemy.combatSpur.atk -= 5;
				enemy.combatSpur.def -= 5;
				if(this.penalty.panic){
					this.combatBuffs.atk = 0;
					this.combatBuffs.def = 0;
					this.buffs.atk = 0;
					this.buffs.def = 0;
				}
				this.combatDebuffs.atk = 0;
				this.combatDebuffs.def = 0;
				this.debuffs.atk = 0;
				this.debuffs.def = 0;
				boostText += this.name + " inflicts -5 atk & def to " + enemy.name + " and neutralizes penalties to atk & def from enemy initiating or enemy HP >= 75% with Earthly Gae Bolg.<br>";
			}
		}
		if(this.hasExactly("Vouge") && this.rValue > 0){
			if(this.combatStartHp / this.maxHp >= 0.25){
				this.combatSpur.atk += 4;
				this.combatSpur.spd += 4;
				this.combatSpur.def += 4;
				this.combatSpur.res += 4;
				boostText += this.name + " gets +4 to all stats from HP >= 25% with Vouge.<br>";
			}
			if(this.rValue == 5 && (!this.initiator || enemy.combatStartHp / enemy.maxHp >= 0.75)){
				this.combatSpur.atk += 4;
				this.combatSpur.spd += 4;
				this.combatSpur.def += 4;
				this.combatSpur.res += 4;
				boostText += this.name + " gets +4 to all stats from enemy initiating or enemy HP >= 75% with Vouge.<br>";
			}
		}
		if(this.hasExactly("Flame Battleaxe")){
			if(this.combatStartHp / this.maxHp >= 0.25){
				var fbVal = 7;
				if(enemy.specialIndex != -1){
					fbVal = 15 - ((data.skills[enemy.specialIndex].charge - enemy.initSkillCharge()) * 2);
					fbVal = Math.max(fbVal,7);
				}
				enemy.combatSpur.atk -= fbVal;
				enemy.combatSpur.def -= fbVal;
				boostText += this.name + " inflicts -" + fbVal + " atk & def to " + enemy.name + " from HP >= 25% with Flame Battleaxe.<br>";
			}
			if(this.rValue == 5 && (!this.initiator || enemy.combatStartHp / enemy.maxHp >= 0.75)){
				enemy.combatSpur.atk -= 5;
				enemy.combatSpur.def -= 5;
				boostText += this.name + " inflicts -5 atk & def to " + enemy.name + " from enemy initiating or enemy HP >= 75% with Flame Battleaxe.<br>";
			}
		}
		if(this.hasExactly("Scarlet Spear") && this.combatStartHp / this.maxHp >= 0.25){
			var ssVal = Math.floor(allStats[20] * 0.25) - 2;
			ssVal = Math.max(ssVal,6);
			ssVal = Math.min(ssVal,16);
			this.combatSpur.atk += ssVal;
			enemy.combatSpur.atk -= ssVal;
			boostText += this.name + " gets +" + ssVal + " to atk and inflicts -" + ssVal + " atk to " + enemy.name + " from HP >= 25% with Scarlet Spear.<br>";
		}
		//+5 all stats when HP >= 25% only
		if((this.hasExactly("Spy's Shuriken") || this.hasExactly("Troubling Blade") || this.hasExactly("Corsair Cleaver") || this.hasExactly("Repair") || this.hasExactly("Flingster Spear") || this.has("Raudrcrab")) && this.combatStartHp / this.maxHp >= 0.25){
			this.combatSpur.atk += 5;
			this.combatSpur.spd += 5;
			this.combatSpur.def += 5;
			this.combatSpur.res += 5;
			boostText += this.name + " gets +5 to all stats from HP >= 25% with " + data.skills[this.weaponIndex].name + ".<br>";
		}
		if((this.has("Kumo Yumi") || this.has("Kumo Naginata"))  && enemy.combatStartHp / enemy.maxHp >= 0.75){
			this.combatSpur.atk += 4;
			this.combatSpur.spd += 4;
			this.combatSpur.def += 4;
			this.combatSpur.res += 4;
			boostText += this.name + " gets +4 to all stats from enemy HP >= 75% with " + data.skills[this.weaponIndex].name + ".<br>";
		}
		if((this.hasExactly("Arcane Void") || this.hasExactly("Arcane Thrima")) && this.combatStartHp / this.maxHp >= 0.25){
			this.combatSpur.atk += 5;
			this.combatSpur.spd += 5;
			this.combatSpur.def += 5;
			this.combatSpur.res += 5;
			var eNegate = this.checkNegate(enemy, currTurn);
			var dAtk = 0;
			var dSpd = 0;
			var dDef = 0;
			var dRes = 0;
			if(eNegate[0] == false){
				dAtk += Math.min(enemy.combatDebuffs.atk,enemy.debuffs.atk);
				if(enemy.penalty.panic){
					dAtk -= Math.max(enemy.combatBuffs.atk,enemy.buffs.atk);
				}
			}
			if(eNegate[1] == false){
				dSpd += Math.min(enemy.combatDebuffs.spd,enemy.debuffs.spd);
				if(enemy.penalty.panic){
					dSpd -= Math.max(enemy.combatBuffs.spd,enemy.buffs.spd);
				}
			}
			if(eNegate[2] == false){
				dDef += Math.min(enemy.combatDebuffs.def,enemy.debuffs.def);
				if(enemy.penalty.panic){
					dDef -= Math.max(enemy.combatBuffs.def,enemy.buffs.def);
				}
			}
			if(eNegate[3] == false){
				dRes += Math.min(enemy.combatDebuffs.res,enemy.debuffs.res);
				if(enemy.penalty.panic){
					dRes -= Math.max(enemy.combatBuffs.res,enemy.buffs.res);
				}
			}
			if(enemy.buddy.adjacent > 0 || enemy.buddy.two > 0){
				dAtk = Math.min(dAtk,enemy.buddy.debuffs.atk);
				dSpd = Math.min(dSpd,enemy.buddy.debuffs.spd);
				dDef = Math.min(dDef,enemy.buddy.debuffs.def);
				dRes = Math.min(dRes,enemy.buddy.debuffs.res);
			}
			enemy.combatSpur.atk += dAtk;
			enemy.combatSpur.spd += dSpd;
			enemy.combatSpur.def += dDef;
			enemy.combatSpur.res += dRes;
			boostText += this.name + " gets +5 to all stats and inflicts " + dAtk + " atk/" + dSpd + " spd/" + dDef + " def/" + dRes + " res on " + enemy.name + " from HP >= 25% with " + data.skills[this.weaponIndex].name + ".<br>";
		}
		if((this.hasExactly("Guarding Lance") || this.hasExactly("Blade Royale")) && (this.initiator || this.buddy.adjacent > 0 || this.buddy.two > 0)){
			this.combatSpur.atk += 5;
			this.combatSpur.spd += 5;
			this.combatSpur.def += 5;
			this.combatSpur.res += 5;
			boostText += this.name + " gets +5 to all stats from initiating or being within 2 spaces of an ally with " + data.skills[this.weaponIndex].name + ".<br>";
		}
		if(this.hasExactly("Gondul") && (this.initiator || enemy.range == "ranged")){
			this.combatSpur.atk += 5;
			this.combatSpur.spd += 5;
			this.combatSpur.def += 5;
			this.combatSpur.res += 5;
			var xVal = 0;
			if(!this.penalty.panic){
				xVal = Math.max(this.combatBuffs.atk,this.buffs.atk) + Math.max(this.combatBuffs.spd,this.buffs.spd) + Math.max(this.combatBuffs.def,this.buffs.def) + Math.max(this.combatBuffs.res,this.buffs.res);
			}
			xVal = Math.max(xVal,this.buddy.buffs.atk + this.buddy.buffs.spd + this.buddy.buffs.def + this.buddy.buffs.res);
			var sdrVal = Math.floor(xVal * 0.5);
			boostText += this.name + " gets +5 to all stats and an additional " + xVal + " atk/" + sdrVal + " spd/" + sdrVal + " def/" + sdrVal + " res from initiating or enemy Range == 2 with Gondul.<br>";
		}
		if(this.hasExactly("Incipit Kvasir") && this.combatStartHp / this.maxHp >= 0.25){
			this.combatSpur.atk += 5;
			this.combatSpur.spd += 5;
			this.combatSpur.def += 5;
			this.combatSpur.res += 5;
			var ikVal = Math.floor(allStats[17] * 0.15);
			enemy.combatSpur.spd -= ikVal;
			enemy.combatSpur.res -= ikVal;
			boostText += this.name + " gets +5 to all stats and inflicts -" + ikVal + " spd & res to " + enemy.name + " from HP >= 25% with Incipit Kvasir.<br>";
		}
		if(this.hasExactly("Quietus Gullveig") && (this.initiator || enemy.combatStartHp / enemy.maxHp >= 0.75)){
			this.combatSpur.atk += 5;
			this.combatSpur.spd += 5;
			this.combatSpur.def += 5;
			this.combatSpur.res += 5;
			var qgVal = Math.floor(allStats[17] * 0.15);
			this.combatSpur.atk += qgVal;
			this.combatSpur.spd += qgVal;
			boostText += this.name + " gets +5 to all stats and an additional +" + qgVal + " atk & spd from initiating or enemy HP >= 75% with Quietus Gullveig.<br>";
		}
		if(this.hasExactly("Iago's Tome") && this.rValue > 0){
			if(this.combatStartHp / this.maxHp >= 0.25){
				this.combatSpur.atk += 4;
				this.combatSpur.spd += 4;
				this.combatSpur.def += 4;
				this.combatSpur.res += 4;
				boostText += this.name + " gets +4 to all stats from HP >= 25% with Iago's Tome.<br>";
			}
			if(this.rValue == 5 && (!this.initiator || enemy.combatStartHp / enemy.maxHp >= 0.75)){
				this.combatSpur.atk += 4;
				this.combatSpur.spd += 4;
				this.combatSpur.def += 4;
				this.combatSpur.res += 4;
				boostText += this.name + " gets +4 to all stats from enemy initiating or enemy HP >= 75% with Iago's Tome.<br>";
			}
		}
		if(this.hasExactly("Whitedown Spear")){
			if(this.rValue < 0 && this.initiator && (this.toggle.weapon == 1 || this.toggle.weapon == 3)){
				enemy.combatSpur.atk -= 4;
				enemy.combatSpur.def -= 4;
				boostText += this.name + " inflicts -4 atk & def to " + enemy.name + " from # of flying units >= 3 and initiating with Whitedown Spear.<br>";
			}
			else if(this.rValue > 0 && (this.initiator || this.buddy.adjacent > 0 || this.buddy.two > 0 || this.buddy.three > 0)){
				enemy.combatSpur.atk -= 4;
				enemy.combatSpur.spd -= 4;
				enemy.combatSpur.def -= 4;
				boostText += this.name + " inflicts -4 atk/spd/def to " + enemy.name + " from initiating or being within 3 spaces of an ally with Whitedown Spear.<br>";
			}
			if(this.rValue == 5 && this.combatStartHp / this.maxHp >= 0.25){
				this.combatSpur.atk += 4;
				this.combatSpur.spd += 4;
				this.combatSpur.def += 4;
				this.combatSpur.res += 4;
				boostText += this.name + " gets +4 to all stats from HP >= 25% with Whitedown Spear.<br>";
			}
		}
		if(this.hasExactly("Sacaen-Wolf Bow")){
			if(this.initiator || this.buddy.adjacent > 0 || this.buddy.two > 0){
				this.combatSpur.atk += 4;
				this.combatSpur.spd += 4;
				this.combatSpur.def += 4;
				this.combatSpur.res += 4;
				boostText += this.name + " gets +4 to all stats from initiating or being within 2 spaces of an ally with Sacaen-Wolf Bow.<br>";
			}
			if(this.rValue == 5 && this.combatStartHp / this.maxHp >= 0.25){
				this.combatSpur.atk += 4;
				this.combatSpur.spd += 4;
				this.combatSpur.def += 4;
				this.combatSpur.res += 4;
				boostText += this.name + " gets +4 to all stats from HP >= 25% with Sacaen-Wolf Bow.<br>";
			}
		}
		if(this.hasExactly("Mirage Longbow") && this.rValue > 0){
			if(this.initiator || this.buddy.adjacent > 0 || this.buddy.two > 0){
				this.combatSpur.atk += 5;
				this.combatSpur.spd += 5;
				boostText += this.name + " gets +5 to atk & spd from initiating or being within 2 spaces of an ally with Mirage Longbow.<br>";
			}
			if(this.rValue == 5 && this.combatStartHp / this.maxHp >= 0.25){
				this.combatSpur.atk += 5;
				this.combatSpur.spd += 5;
				if(this.penalty.panic){
					this.combatBuffs.atk = 0;
					this.combatBuffs.spd = 0;
					this.buffs.atk = 0;
					this.buffs.spd = 0;
				}
				this.combatDebuffs.atk = 0;
				this.combatDebuffs.spd = 0;
				this.debuffs.atk = 0;
				this.debuffs.spd = 0;
				boostText += this.name + " gets +5 to atk & spd and neutralizes penalties to atk & spd from HP >= 25% with Mirage Longbow.<br>";
			}
		}
		if(this.hasExactly("Striving Sword") && (this.buddy.adjacent > 0 || this.buddy.two > 0 || this.buddy.three > 0)){
			var ssVal = Math.floor(allStats[20] * 0.25) - 4;
			ssVal = Math.max(ssVal,5);
			ssVal = Math.min(ssVal,14);
			this.combatSpur.atk += ssVal;
			this.combatSpur.spd += ssVal;
			this.combatSpur.def += ssVal;
			this.combatSpur.res += ssVal;
			boostText += this.name + " gets +" + ssVal + " to all stats from being within 3 spaces of an ally with Striving Sword.<br>";
		}
		if(this.hasExactly("World-Tree Tail") && this.combatStartHp / this.maxHp >= 0.25){
			this.combatSpur.atk += 5;
			this.combatSpur.spd += 5;
			this.combatSpur.def += 5;
			this.combatSpur.res += 5;
			var wtVal = 9 - (3 * this.toggle.weapon);
			this.combatSpur.atk += wtVal;
			this.combatSpur.spd += wtVal;
			boostText += this.name + " gets +5 to all stats and an additional +" + wtVal + " atk & spd from HP >= 25% with World-Tree Tail.<br>";
		}
		if(this.hasExactly("Mending Heart") && (this.initiator || this.buddy.adjacent > 0 || this.buddy.two > 0)){
			this.combatSpur.atk += 4;
			this.combatSpur.spd += 4;
			this.combatSpur.def += 4;
			this.combatSpur.res += 4;
			boostText += this.name + " gets +4 to all stats from initiating or being within 2 spaces of an ally with Mending Heart.<br>";
		}
		if(this.hasExactly("Silent Yule Knife") && this.combatStartHp / this.maxHp >= 0.25){
			this.combatSpur.atk += 5;
			this.combatSpur.spd += 5;
			this.combatSpur.def += 5;
			this.combatSpur.res += 5;
			var sykVal = 9 - (2 * this.buddy.adjacent);
			this.combatSpur.atk += sykVal;
			this.combatSpur.spd += sykVal;
			boostText += this.name + " gets +5 to all stats and an additional +" + sykVal + " atk & spd from HP >= 25% with Silent Yule Knife.<br>";
		}
		if(this.hasExactly("Blue Yule Axe") && this.combatStartHp / this.maxHp >= 0.25){
			var bVal = Math.floor(allStats[17] * 0.15) + 5;
			this.combatSpur.atk += bVal;
			this.combatSpur.spd += bVal;
			this.combatSpur.def += bVal;
			this.combatSpur.res += bVal;
			boostText += this.name + " gets +" + bVal + " to all stats from HP >= 25% with Blue Yule Axe.<br>";
		}
		if((this.hasExactly("Holy Yule Blade") || this.hasExactly("Tender Vessel")) && this.combatStartHp / this.maxHp >= 0.25){
			var hybVal = Math.floor(allStats[19] * 0.2) + 5;
			this.combatSpur.atk += hybVal;
			this.combatSpur.def += hybVal;
			this.combatSpur.res += hybVal;
			boostText += this.name + " gets +" + hybVal + " to atk/def/res from HP >= 25% with " +  data.skills[this.weaponIndex].name + ".<br>";
		}
		if(this.has("Golden Yule Bow") && this.combatStartHp / this.maxHp >= 0.25){
			var gybVal = this.toggle.weapon + 4;
			this.combatSpur.atk += gybVal;
			this.combatSpur.spd += gybVal;
			this.combatSpur.def += gybVal;
			this.combatSpur.res += gybVal;
			boostText += this.name + " gets +" + gybVal + " to all stats from HP >= 25% with " +  data.skills[this.weaponIndex].name + ".<br>";
		}
		if(this.hasExactly("Bewitching Tome") && (this.initiator || enemy.range == "ranged")){
			this.combatSpur.atk += 5;
			this.combatSpur.spd += 5;
			this.combatSpur.def += 5;
			this.combatSpur.res += 5;
			var btVal = Math.floor(allStats[17] * 0.2);
			this.combatSpur.atk += btVal;
			this.combatSpur.spd += btVal;
			boostText += this.name + " gets +5 to all stats and an additional +" + btVal + " atk & spd from initiating or enemy range = 2 with Bewitching Tome.<br>";
		}
		if(this.hasExactly("Faded Paper Fan") && (this.initiator || this.buddy.adjacent > 0 || this.buddy.two > 0)){
			this.combatSpur.atk += 5;
			this.combatSpur.spd += 5;
			this.combatSpur.def += 5;
			this.combatSpur.res += 5;
			var ikVal = Math.floor(allStats[17] * 0.2);
			enemy.combatSpur.spd -= ikVal;
			enemy.combatSpur.res -= ikVal;
			boostText += this.name + " gets +5 to all stats and inflicts -" + ikVal + " spd & res to " + enemy.name + " from initiating or being within 2 spaces of an ally with Faded Paper Fan.<br>";
		}
		if((this.has("Dragon's Stone") || this.has("New-Sun Stone")) && this.combatStartHp / this.maxHp >= 0.25){
			this.combatSpur.atk += 4;
			this.combatSpur.spd += 4;
			this.combatSpur.def += 4;
			this.combatSpur.res += 4;
			boostText += this.name + " gets +4 to all stats from HP >= 25% with " +  data.skills[this.weaponIndex].name + ".<br>";
		}
		if(this.hasExactly("Goddess Temari") && this.combatStartHp / this.maxHp >= 0.25){
			var gtVal = Math.min(currTurn * 2,8) + 5;
			if(this.toggle.weapon == 1){
				gtVal = 13;
			}
			this.combatSpur.atk += gtVal;
			this.combatSpur.spd += gtVal;
			this.combatSpur.def += gtVal;
			this.combatSpur.res += gtVal;
			boostText += this.name + " gets +" + gtVal + " to all stats from HP >= 25% with Goddess Temari.<br>";
		}
		if(this.hasExactly("Future-Sighted") && (this.buddy.adjacent > 0 || this.buddy.two > 0 || this.buddy.three > 0)){
			this.combatSpur.atk += 4;
			this.combatSpur.spd += 4;
			this.combatSpur.def += 4;
			this.combatSpur.res += 4;
			boostText += this.name + " gets +4 to all stats from being within 3 spaces of an ally with Future-Sighted.<br>";
		}
		if(this.hasExactly("Stoutheart Lance")){
			if(this.combatStartHp / this.maxHp >= 0.25){
				var dAtk = Math.min(this.combatDebuffs.atk,this.debuffs.atk) * -2 + 4;
				var dSpd = Math.min(this.combatDebuffs.spd,this.debuffs.spd) * -2 + 4;
				var dDef = Math.min(this.combatDebuffs.def,this.debuffs.def) * -2 + 4;
				var dRes = Math.min(this.combatDebuffs.res,this.debuffs.res) * -2 + 4;
				if(this.penalty.panic){
					dAtk += Math.max(this.combatBuffs.atk,this.buffs.atk) * 2;
					dSpd += Math.max(this.combatBuffs.spd,this.buffs.spd) * 2;
					dDef += Math.max(this.combatBuffs.def,this.buffs.def) * 2;
					dRes += Math.max(this.combatBuffs.res,this.buffs.res) * 2;
				}
				this.combatSpur.atk += dAtk;
				this.combatSpur.spd += dSpd;
				this.combatSpur.def += dDef;
				this.combatSpur.res += dRes;
				boostText += this.name + " gets net + " + dAtk + "/" + dSpd + "/" + dDef + "/" + dRes + " in stats from HP >= 25% with Stoutheart Lance.<br>";
			}
			if(this.rValue == 5 && (this.initiator || this.buddy.adjacent > 0 || this.buddy.two > 0)){
				this.combatSpur.atk += 4;
				this.combatSpur.spd += 4;
				this.combatSpur.def += 4;
				this.combatSpur.res += 4;
				boostText += this.name + " gets +4 to all stats from initiating or being within 2 spaces of an ally with Stoutheart Lance.<br>";
			}
		}
		if(this.hasExactly("Dragoon Axe")){
			if((this.rValue < 0 && enemy.combatStartHp / enemy.maxHp >= 1) || (this.rValue > 0 && (!this.initiator || enemy.combatStartHp / enemy.maxHp >= 0.75))){
				this.combatSpur.atk += 4;
				this.combatSpur.spd += 4;
				this.combatSpur.def += 4;
				this.combatSpur.res += 4;
				var daText = "= 100%";
				if(this.rValue > 0){
					daText = ">= 75% or enemy initiating";
				}
				boostText += this.name + " gets +4 to all stats from enemy HP " + daText + " with Dragoon Axe.<br>";
			}
			if(this.rValue == 5 && (this.buddy.adjacent > 0 || this.buddy.two > 0 || this.buddy.three > 0)){
				this.combatSpur.atk += 4;
				this.combatSpur.spd += 4;
				this.combatSpur.def += 4;
				this.combatSpur.res += 4;
				boostText += this.name + " gets +4 to all stats from being within 3 spaces of an ally with Dragoon Axe.<br>";
			}
		}
		if(this.hasExactly("Constant Dagger")){
			if(this.initiator || (this.rValue > 0 && (this.buddy.adjacent > 0 || this.buddy.two > 0))){
				this.combatSpur.atk += 5;
				this.combatSpur.spd += 5;
				var cdText = "initiating";
				if(this.rValue > 0){
					cdText += " or being within 2 spaces of an ally";
				}
				boostText += this.name + " gets +5 atk & spd from " + cdText + " with Constant Dagger.<br>";
			}
			if(this.rValue == 5 && this.combatStartHp / this.maxHp >= 0.25){
				this.combatSpur.atk += 5;
				this.combatSpur.spd += 5;
				boostText += this.name + " gets +5 to atk & spd from HP >= 25% with Constant Dagger.<br>";
			}
		}
		if(this.hasExactly("Thief")){
			enemy.combatSpur.atk -= 4;
			enemy.combatSpur.spd -= 4;
			enemy.combatSpur.def -= 4;
			enemy.combatSpur.res -= 4;
			boostText += this.name + " has activated Thief. Effect on " + enemy.name + ": -4 to all stats.<br>";
			if(this.combatStartHp / this.maxHp >= 0.25){
				this.combatSpur.atk += 6;
				this.combatSpur.spd += 6;
				boostText += this.name + " gets +6 to atk & spd from HP >= 25% with Thief.<br>";
			}
		}
		if(this.hasExactly("Thunder's Fist") && this.combatStartHp / this.maxHp >= 0.25){
			this.combatSpur.atk += 7;
			this.combatSpur.spd += 7;
			this.combatSpur.def += 7;
			this.combatSpur.res += 7;
			boostText += this.name + " gets +7 to all stats from HP >= 25% with Thunder's Fist.<br>";
		}
		if(this.hasExactly("Arcadian Axes") && this.combatStartHp / this.maxHp >= 0.25){
			var aaVal = Math.floor(allStats[19] * 0.2) + 5;
			enemy.combatSpur.atk -= aaVal;
			enemy.combatSpur.def -= aaVal;
			enemy.combatSpur.res -= aaVal;
			boostText += this.name + " inflicts -" + aaVal + " atk/def/res to " + enemy.name + " from HP >= 25% with Arcadian Axes.<br>";
		}
		if(this.hasExactly("Blade of Sands") && (this.initiator || this.buddy.adjacent > 0 || this.buddy.two > 0)){
			this.combatSpur.atk += 5;
			this.combatSpur.spd += 5;
			this.combatSpur.def += 5;
			this.combatSpur.res += 5;
			boostText += this.name + " gets +5 to all stats from initiating or being within 2 spaces of an ally with Blade of Sands.<br>";
		}
		if((this.has("Nabata Beacon") || this.has("Nabata Lance")) && (this.initiator || this.buddy.adjacent > 0 || this.buddy.two > 0)){
			this.combatSpur.atk += 4;
			this.combatSpur.spd += 4;
			this.combatSpur.def += 4;
			this.combatSpur.res += 4;
			boostText += this.name + " gets +4 to all stats from initiating or being within 2 spaces of an ally with " + data.skills[this.weaponIndex].name + ".<br>";
		}
		if(this.hasExactly("Sandglass Bow") && (this.initiator || this.buddy.adjacent > 0 || this.buddy.two > 0)){
			this.combatSpur.atk += 6;
			this.combatSpur.spd += 6;
			boostText += this.name + " gets +6 to atk & spd from initiating or being within 2 spaces of an ally with Sandglass Bow.<br>";
		}
		if((this.hasExactly("Monarch's Stone") || this.hasExactly("Arcane Fellstone")) && this.combatStartHp / this.maxHp >= 0.25){
			var msVal = Math.floor(allStats[20] * 0.25) - 4;
			msVal = Math.max(msVal,5);
			msVal = Math.min(msVal,14);
			this.combatSpur.atk += msVal;
			this.combatSpur.spd += msVal;
			this.combatSpur.def += msVal;
			this.combatSpur.res += msVal;
			boostText += this.name + " gets +" + msVal + " to all stats from from HP >= 25% with " + data.skills[this.weaponIndex].name + ".<br>";
		}
		if((this.hasExactly("Dragon Monarch") || this.hasExactly("Corrupted Dragon")) && this.toggle.c == 1){
			this.combatSpur.atk += 4;
			this.combatSpur.spd += 4;
			this.combatSpur.def += 4;
			this.combatSpur.res += 4;
			boostText += this.name + " gets +4 to all stats from having an ally within 5 rows & columns centered on unit with " + data.skills[this.cIndex].name + ".<br>";
		}
		if(this.hasExactly("Hero-King Sword") && this.combatStartHp / this.maxHp >= 0.25){
			var hsVal = Math.floor(allStats[17] * 0.2) + 5;
			this.combatSpur.atk += hsVal;
			this.combatSpur.spd += hsVal;
			this.combatSpur.def += hsVal;
			this.combatSpur.res += hsVal;
			boostText += this.name + " gets +" + hsVal + " to all stats from HP >= 25% with Hero-King Sword.<br>";
		}
		if(this.hasExactly("Feather Sword") && this.rValue > 0){
			if(!this.initiator || enemy.combatStartHp / enemy.maxHp >= 0.75){
				this.combatSpur.atk += 4;
				this.combatSpur.spd += 4;
				this.combatSpur.def += 4;
				this.combatSpur.res += 4;
				boostText += this.name + " gets +4 to all stats from enemy initiating or enemy HP >= 75% with Feather Sword.<br>";
			}
			if(this.rValue == 5 && this.combatStartHp / this.maxHp >= 0.25){
				this.combatSpur.atk += 4;
				this.combatSpur.spd += 4;
				this.combatSpur.def += 4;
				this.combatSpur.res += 4;
				var fsVal = (this.buddy.adjacent + this.buddy.two + this.buddy.three) * 3;
				fsVal = Math.min(fsVal,6);
				var fsText = "";
				if(fsVal > 0){
					fsText = " and an additional +" + fsVal + " to atk & spd";
				}
				boostText += this.name + " gets +4 to all stats" + fsText + " from HP >= 25% with Feather Sword.<br>";
			}
		}
		if(this.hasExactly("Lyngheidr")){
			if(this.initiator || (this.rValue > 0 && (this.buddy.adjacent > 0 || this.buddy.two > 0))){
				this.combatSpur.atk += 6;
				this.combatSpur.spd += 6;
				var lText = this.name + " gets +6 atk and spd from initiating with Lyngheidr.<br>";
				if(this.rValue > 0){
					this.combatSpur.def += 4;
					this.combatSpur.res += 4;
					if(this.penalty.panic){
						this.combatBuffs.atk = 0;
						this.combatBuffs.spd = 0;
						this.buffs.atk = 0;
						this.buffs.spd = 0;
					}
					this.combatDebuffs.atk = 0;
					this.combatDebuffs.spd = 0;
					this.debuffs.atk = 0;
					this.debuffs.spd = 0;
					lText = this.name + " gets +6 atk & spd, +4 def & res, and neutralizes penalties to atk & spd from initiating or being within 2 spaces of an ally with Lyngheidr.<br>";
				}
				boostText += lText;
			}
			if(this.rValue == 5 && this.combatStartHp / this.maxHp >= 0.25){
				this.combatSpur.atk += 4;
				this.combatSpur.spd += 4;
				this.combatSpur.def += 4;
				this.combatSpur.res += 4;
				boostText += this.name + " gets +4 to all stats from HP >= 25% with Lyngheidr.<br>";
			}
		}
		if(this.hasExactly("Airborne Spear")){
			if(this.initiator || this.buddy.adjacent > 0 || this.buddy.two > 0){
				this.combatSpur.atk += 4;
				this.combatSpur.spd += 4;
				this.combatSpur.def += 4;
				this.combatSpur.res += 4;
				boostText += this.name + " gets +4 to all stats from initiating or being within 2 spaces of an ally with Airborne Spear.<br>";
			}
			if(this.rValue == 5 && this.combatStartHp / this.maxHp >= 0.25){
				this.combatSpur.atk += 4;
				this.combatSpur.spd += 4;
				this.combatSpur.def += 4;
				this.combatSpur.res += 4;
				boostText += this.name + " gets +4 to all stats from HP >= 25% with Airborne Spear.<br>";
			}
		}
		
		if(this.hasExactly("Rinkah's Club")){
			if(!this.initiator || this.combatStartHp / this.maxHp < 1 || (this.rValue > 0 && enemy.combatStartHp / enemy.maxHp >= 0.75)){
				this.combatSpur.atk += 5;
				this.combatSpur.def += 5;
				var rcText = this.name + " gets +5 to atk & def from enemy initiating or HP < 100% with Rinkah's Club.<br>"
				if(this.rValue > 0){
					this.combatSpur.spd += 4;
					this.combatSpur.res += 4;
					rcText = this.name + " gets +5 atk & def and +4 spd & res from enemy initiating, HP < 100%, or enemy HP >= 75% with Rinkah's Club.<br>";
				}
				boostText += rcText ;
			}
			if(this.rValue == 5 && (this.buddy.adjacent > 0 || this.buddy.two > 0 || this.buddy.three > 0)){
				this.combatSpur.atk += 4;
				this.combatSpur.spd += 4;
				this.combatSpur.def += 4;
				this.combatSpur.res += 4;
				boostText += this.name + " gets +4 to all stats from being within 3 spaces of an ally with Rinkah's Club.<br>";
			}
		}
		if(this.hasExactly("Flower of Sorrow")){
			if(this.toggle.weapon == 1){
				var fsVal = 4;
				if(this.rValue > 0){
					fsVal++;
				}
				enemy.combatSpur.def -= fsVal;
				enemy.combatSpur.res -= fsVal;
				boostText += this.name + " inflicts -" + fsVal + " def & res to " + enemy.name + " from being in cardinal direction with Flower of Sorrow.<br>";
			}
			if(this.rValue > 0 && (enemy.combatStartHp / enemy.maxHp >= 0.75 || enemy.buddy.adjacent > 0 || enemy.buddy.two > 0)){
				enemy.combatSpur.atk -= 4;
				enemy.combatSpur.spd -= 4;
				enemy.combatSpur.res -= 4;
				boostText += this.name + " inflicts -4 atk/spd/res to " + enemy.name + " from enemy HP >= 75% or enemy being within 2 spaces of another enemy with Flower of Sorrow.<br>";
			}
			if(this.rValue == 5 && this.combatStartHp / this.maxHp >= 0.25){
				enemy.combatSpur.atk -= 4;
				enemy.combatSpur.spd -= 4;
				enemy.combatSpur.res -= 4;
				boostText += this.name + " inflicts -4 atk/spd/res to " + enemy.name + " from HP >= 25% with Flower of Sorrow.<br>";
			}
		}
		if((this.hasExactly("Loving Breath") || this.hasExactly("Righteous Lance")) && (!this.initiator || enemy.combatStartHp / enemy.maxHp >= 0.75)){
			var lbVal = (this.buddy.adjacent + this.buddy.two + this.buddy.three) * 4 + 6;
			lbVal = Math.min(lbVal,14);
			enemy.combatSpur.atk -= lbVal;
			if(this.hasExactly("Loving Breath")){
				this.combatSpur.atk += lbVal;
				boostText += this.name + " gets +" + lbVal + " to atk and inflicts -" + lbVal + " atk to " + enemy.name + " from enemy initiating or enemy HP >= 75% with Loving Breath.<br>";
			}
			else{
				enemy.combatSpur.def -= lbVal;
				boostText += this.name + " inflicts -" + lbVal + " atk & def to " + enemy.name + " from enemy initiating or enemy HP >= 75% with Righteous Lance.<br>";
			}
		}
		if(this.has("Devoted Basket") && this.combatStartHp / this.maxHp >= 0.25){
			var dbVal = Math.floor(allStats[17] * 0.15) + 5;
			this.combatSpur.atk += dbVal;
			this.combatSpur.spd += dbVal;
			boostText += this.name + " gets +" + dbVal + " to atk & spd from HP >= 25% with " + data.skills[this.weaponIndex].name + ".<br>";
		}
		if(this.has("Axe of Devotion") && this.combatStartHp / this.maxHp >= 0.25){
			var dbVal = Math.floor(allStats[18] * 0.15) + 5;
			this.combatSpur.atk += dbVal;
			this.combatSpur.def += dbVal;
			boostText += this.name + " gets +" + dbVal + " to atk & def from HP >= 25% with " + data.skills[this.weaponIndex].name + ".<br>";
		}
		if(this.hasExactly("Gray Illusion") && (this.initiator || enemy.combatStartHp / enemy.maxHp >= 0.75)){
			this.combatSpur.atk += 9;
			this.combatSpur.def += 9;
			this.combatSpur.res += 9;
			boostText += this.name + " gets +9 to atk/def/res from initiating or enemy HP >= 75% with Gray Illusion.<br>";
		}
		if(this.hasExactly("Axe of Adoration") && this.combatStartHp / this.maxHp >= 0.25){
			var aaVal = 8;
			if(enemy.specialIndex != -1 && data.skills[enemy.specialIndex].charge - enemy.initSkillCharge() < 4){
				aaVal = 16 - ((data.skills[enemy.specialIndex].charge - enemy.initSkillCharge()) * 2);
			}
			enemy.combatSpur.atk -= aaVal;
			enemy.combatSpur.spd -= aaVal;
			enemy.combatSpur.def -= aaVal;
			boostText += this.name + " inflicts -" + aaVal + " atk/spd/def to " + enemy.name + " from HP >= 25% with " + data.skills[this.weaponIndex].name + ".<br>";
		}
		if((this.hasExactly("Glittering Anima") || this.hasExactly("Twinkling Anima")) && (this.buddy.adjacent > 0 || this.buddy.two > 0 || this.buddy.three > 0)){
			this.combatSpur.atk += 5;
			this.combatSpur.spd += 5;
			boostText += this.name + " gets +5 to atk & spd from being within 3 spaces of an ally with " + data.skills[this.cIndex].name + ".<br>";
		}
		if(this.hasExactly("Icebound Tome") && (this.initiator || enemy.range == "ranged")){
			var itVal = Math.floor(allStats[20] * 0.25) - 4;
			itVal = Math.min(itVal,14);
			itVal = Math.max(itVal,5);
			this.combatSpur.atk += itVal;
			this.combatSpur.spd += itVal;
			this.combatSpur.def += itVal;
			this.combatSpur.res += itVal;
			boostText += this.name + " gets +" + itVal + " to all stats from initiating or enemy range = 2 with " + data.skills[this.weaponIndex].name + ".<br>";
		}
		if(this.hasExactly("Obsession") && this.combatStartHp / this.maxHp >= 0.25){
			this.combatSpur.atk += 9;
			this.combatSpur.spd += 9;
			this.combatSpur.def += 9;
			this.combatSpur.res += 9;
			boostText += this.name + " gets +9 to all stats from HP >= 25% with " + data.skills[this.aIndex].name + ".<br>";
		}
		if(this.hasExactly("Emblems' Miracle") && (this.buddy.adjacent > 0 || this.buddy.two > 0 || this.buddy.three > 0)){
			this.combatSpur.atk += 9;
			this.combatSpur.spd += 9;
			this.combatSpur.def += 9;
			this.combatSpur.res += 9;
			boostText += this.name + " gets +9 to all stats from being within 3 spaces of an ally with Emblems' Miracle.<br>";
		}
		if(this.hasExactly("Wings of Light+") && this.toggle.c == 1){
			this.combatSpur.atk += 5;
			this.combatSpur.spd += 5;
			this.combatSpur.def += 5;
			this.combatSpur.res += 5;
			boostText += this.name + " gets +5 to all stats from having a Mythic Hero ally on the team or having an ally within 3 rows/columns (centered) with Wings of Light+.<br>";
		}
		if(this.hasExactly("Lucky Bow")){
			if(!this.initiator || enemy.combatStartHp / enemy.maxHp >= 0.75){
				this.combatSpur.atk += 11;
				this.combatSpur.spd += 4;
				this.combatSpur.def += 4;
				this.combatSpur.res += 4;
				enemy.combatSpur.atk -= 7;
				boostText += this.name + " gets +4 to all stats, an additional +7 to atk, and inflicts -7 atk to " + enemy.name + " from enemy initiating or enemy HP >= 75% with Lucky Bow.<br>";
			}
			if(this.rValue == 5 && this.combatStartHp / this.maxHp >= 0.25){
				this.combatSpur.atk += 4;
				this.combatSpur.spd += 4;
				this.combatSpur.def += 4;
				this.combatSpur.res += 4;
				boostText += this.name + " gets +4 to all stats from HP >= 25% with Lucky Bow.<br>";
			}
		}
		if(this.hasExactly("Aurora Breath")){
			if(this.rValue < 0 && this.initiator){
				this.combatSpur.atk += 6;
				boostText += this.name + " gets +6 to atk from initiating with Aurora Breath.<br>";
			}
			else if(this.rValue < 0 && !this.initiator){
				this.combatSpur.def += 6;
				this.combatSpur.res += 6;
				boostText += this.name + " gets +6 to def & res from enemy initiating with Aurora Breath.<br>";
			}
			else if(this.rValue > 0){
				this.combatSpur.atk += 6;
				this.combatSpur.def += 6;
				this.combatSpur.res += 6;
				boostText += this.name + " gets +6 to atk/def/res with Aurora Breath.<br>";
			}
			if(this.rValue == 5 && this.combatStartHp / this.maxHp >= 0.25){
				this.combatSpur.atk += 4;
				this.combatSpur.def += 4;
				this.combatSpur.res += 4;
				boostText += this.name + " gets +4 to atk/def/res from HP >= 25% with Aurora Breath.<br>";
			}
		}
		if(this.hasExactly("Crusher") && this.rValue > 0){
			if(this.combatStartHp / this.maxHp >= 0.25){
				this.combatSpur.atk += 4;
				this.combatSpur.spd += 4;
				this.combatSpur.def += 4;
				this.combatSpur.res += 4;
				boostText += this.name + " gets +4 to all stats from HP >= 25% with Crusher.<br>";
			}
			if(this.rValue == 5 && (this.initiator || this.buddy.adjacent > 0 || this.buddy.two > 0)){
				this.combatSpur.atk += 4;
				this.combatSpur.spd += 4;
				this.combatSpur.def += 4;
				this.combatSpur.res += 4;
				var dSpd = Math.min(enemy.combatDebuffs.spd,enemy.debuffs.spd);
				var dDef = Math.min(enemy.combatDebuffs.def,enemy.debuffs.def);
				var dRes = Math.min(enemy.combatDebuffs.res,enemy.debuffs.res);
				if(enemy.penalty.panic){
					dSpd -= Math.max(enemy.combatBuffs.spd,enemy.buffs.spd);
					dDef -= Math.max(enemy.combatBuffs.def,enemy.buffs.def);
					dRes -= Math.max(enemy.combatBuffs.res,enemy.buffs.res);
				}
				dSpd = Math.max(6+dSpd, 0);
				dDef = Math.max(6+dDef, 0);
				dRes = Math.max(6+dRes, 0);
				enemy.combatSpur.spd -= dSpd;
				enemy.combatSpur.def -= dDef;
				enemy.combatSpur.res -= dRes;
				boostText += this.name + " gets +4 to all stats and inflicts -" + dSpd + " spd/-" + dDef + " def/-" + dRes + " res on " + enemy.name + " from initiating or being within 2 spaces of an ally with Crusher.<br>";
			}
		}
		if(this.hasExactly("Hippity-Hop Axe") && (this.buddy.adjacent > 0 || this.buddy.two > 0 || this.buddy.three > 0)){
			var hhVal = Math.min((this.buddy.adjacent + this.buddy.two + this.buddy.three) * 3 + 5, 14);
			if(this.toggle.weapon > 1){
				hhVal = 14;
			}
			this.combatSpur.atk += hhVal;
			this.combatSpur.spd += hhVal;
			this.combatSpur.def += hhVal;
			this.combatSpur.res += hhVal;
			boostText += this.name + " gets +" + hhVal + " to all stats from being within 3 spaces of an ally with Hippity-Hop Axe.<br>";
		}
		if(this.hasExactly("Daydream Egg") && (enemy.combatStartHp / enemy.maxHp >= 0.75 || enemy.checkBonPen(3,this,currTurn))){
			this.combatSpur.atk += 5;
			this.combatSpur.def += 5;
			this.combatSpur.res += 5;
			boostText += this.name + " gets +5 to atk/def/res from enemy HP >= 75% or [Penalty] being active on " + enemy.name + " with Daydream Egg.<br>";
		}
		if(this.hasExactly("Sky-Hopper Egg") && this.combatStartHp / this.maxHp >= 0.25){
			this.combatSpur.atk += 5;
			this.combatSpur.spd += 5;
			this.combatSpur.def += 5;
			this.combatSpur.res += 5;
			var sheVal = this.toggle.weapon * 4;
			this.combatSpur.atk += sheVal;
			this.combatSpur.spd += sheVal;
			boostText += this.name + " gets +5 to all stats and an additional +" + sheVal + " atk & spd from HP >= 25% with Sky-Hopper Egg.<br>";
		}
		if(this.has("Carrot Bow") && (!this.initiator || enemy.combatStartHp / enemy.maxHp >= 0.75)){
			this.combatSpur.atk += 5;
			this.combatSpur.res += 5;
			boostText += this.name + " gets +5 to atk & res from enemy initiating or enemy HP >= 75% with " + data.skills[this.weaponIndex].name + ".<br>";
		}
		if(this.hasExactly("Pure-Wing Spear") && (this.buddy.adjacent > 0 || this.buddy.two > 0 || this.buddy.three > 0)){
			var psVal = Math.min((this.buddy.adjacent + this.buddy.two + this.buddy.three) * 3 + 5, 14);
			this.combatSpur.atk += psVal;
			this.combatSpur.spd += psVal;
			this.combatSpur.def += psVal;
			this.combatSpur.res += psVal;
			boostText += this.name + " gets +" + psVal + " to all stats from being within 3 spaces of an ally with Pure-Wing Spear.<br>";
		}
		if((this.hasExactly("Sunlight") || this.hasExactly("Sunlight+")) && this.combatStartHp / this.maxHp >= 0.25){
			this.combatSpur.atk += 5;
			this.combatSpur.spd += 5;
			var srVal = Math.min((Object.values(enemy.bonus).reduce((a, item) => a + (item === true ? 1 : 0), 0) + enemy.bonus.extra + Object.values(enemy.penalty).reduce((a, item) => a + (item === true ? 1 : 0), 0) + enemy.penalty.extra) * 4, 16);
			enemy.combatSpur.res -= srVal;
			boostText += this.name + " gets +5 to atk & spd and inflicts -" + srVal + " res to " + enemy.name + " from HP >= 25% with " + data.skills[this.weaponIndex].name + ".<br>";
		}
		if(this.hasExactly("Lightburst Tome") && this.combatStartHp / this.maxHp >= 0.25){
			var ltVal = 8;
			if(enemy.specialIndex != -1){
				ltVal = 16 - ((data.skills[enemy.specialIndex].charge - enemy.initSkillCharge()) * 2);
				ltVal = Math.max(ltVal,8);
			}
			enemy.combatSpur.atk -= ltVal ;
			enemy.combatSpur.spd -= ltVal ;
			enemy.combatSpur.res -= ltVal ;
			boostText += this.name + " inflicts -" + ltVal + " atk/spd/res to " + enemy.name + " from HP >= 25% with " + data.skills[this.weaponIndex].name + ".<br>";
		}
		if(this.hasExactly("Tender Excalibur") && this.combatStartHp / this.maxHp >= 0.25){
			this.combatSpur.atk += 5;
			this.combatSpur.spd += 5;
			this.combatSpur.def += 5;
			this.combatSpur.res += 5;
			var teVal = 9 - (this.toggle.weapon * 3);
			this.combatSpur.atk += teVal;
			this.combatSpur.spd += teVal;
			boostText += this.name + " gets +5 to all stats and an additional +" + teVal + " atk & spd from HP >= 25% with Tender Excalibur.<br>";
		}
		if(this.hasExactly("Emblem Ragnell") && this.combatStartHp / this.maxHp >= 0.25){
			var erVal = Math.floor(allStats[20] * 0.25) - 2;
			erVal = Math.min(erVal,16);
			erVal = Math.max(erVal,6);
			this.combatSpur.atk += erVal;
			enemy.combatSpur.atk -= erVal;
			if(this.penalty.panic){
				this.combatBuffs = {"atk":0,"spd":0,"def":0,"res":0};
				this.buffs = {"atk":0,"spd":0,"def":0,"res":0};
			}
			this.combatDebuffs = {"atk":0,"spd":0,"def":0,"res":0};
			this.debuffs = {"atk":0,"spd":0,"def":0,"res":0};
			boostText += this.name + " gets +" + erVal + " to atk, inflicts -" + erVal + " atk to " + enemy.name + ", and neutralizes penalties from HP >= 25% with Emblem Ragnell.<br>";
		}
		if(this.hasExactly("Hades O")){
			if(this.initiator || (this.rValue > 0 && (this.buddy.adjacent > 0 || this.buddy.two > 0))){
				var hoVal = 4;
				var hoText = " from initiating";
				var hoSText = "";
				if(this.rValue > 0){
					hoVal++;
					hoText = " and neutralizes penalties to atk & spd from initiating  or being within 2 spaces of an ally";
					if(this.penalty.panic){
						this.combatBuffs.atk = 0;
						this.combatBuffs.spd = 0;
						this.buffs.atk = 0;
						this.buffs.spd = 0;
					}
					this.combatDebuffs.atk = 0;
					this.combatDebuffs.spd = 0;
					this.debuffs.atk = 0;
					this.debuffs.spd = 0;
				}
				this.combatSpur.atk += hoVal;
				this.combatSpur.spd += hoVal;
				if(this.specialIndex != -1 && ((this.rValue < 0 && data.skills[this.specialIndex].charge <= this.charge) || (this.rValue > 0 && data.skills[this.specialIndex].charge - this.charge < 3))){
					this.combatSpur.atk += 6;
					hoSText = " and an additional +6 to atk";
					if(this.rValue > 0){
						this.combatSpur.atk += 1;
						this.combatSpur.spd += 7;
						hoSText = " and an additional +7 to atk & spd";
					}
				}
				boostText += this.name + " gets +" + hoVal + " to atk & spd" + hoSText + hoText + " with Hades O.<br>";
			}
			if(this.rValue == 5 && (this.initiator || enemy.range == "ranged")){
				this.combatSpur.atk += 5;
				this.combatSpur.spd += 5;
				boostText += this.name + " gets +5 to atk & spd from initiating or enemy's range = 2 with Hades O.<br>";
			}
		}
		if(this.hasExactly("Dark Scripture")){
			if(this.buddy.adjacent == 0 || (this.rValue > 0 && !this.initiator)){
				enemy.combatSpur.atk -= 6;
				enemy.combatSpur.res -= 6;
				var dsText = " to " + enemy.name + " from not being adjacent to an ally";
				if(this.rValue > 0){
					enemy.combatSpur.spd -= 4;
					dsText = " and -4 spd to " + enemy.name + " from enemy initiating or not being adjacent to an ally";
				}
				boostText += this.name + " inflicts -6 atk & res" + dsText + " with Dark Scripture.<br>";
			}
			if(this.rValue == 5 && this.combatStartHp / this.maxHp >= 0.25){
				enemy.combatSpur.atk -= 4;
				enemy.combatSpur.spd -= 4;
				enemy.combatSpur.res -= 4;
				boostText += this.name + " inflicts -4 atk/spd/res to " + enemy.name + " from HP >= 25% with Dark Scripture.<br>";
			}
		}
		if(this.hasExactly("Daniel-Made Bow")){
			enemy.combatSpur.atk -= 5;
			var dmText = "";
			if(this.rValue > 0){
				enemy.combatSpur.def -= 5;
				dmText = " & def";
				this.support.crux++;
			}
			boostText += this.name + " inflicts -5 atk" + dmText + " to " + enemy.name + " with Daniel-Made Bow.<br>";
			if(this.rValue == 5 && (this.initiator || this.buddy.adjacent > 0 || this.buddy.two > 0)){
				this.combatSpur.atk += 5;
				this.combatSpur.def += 5;
				boostText += this.name + " gets +5 to atk & def from initiating or being within 2 spaces of an ally with Daniel-Made Bow.<br>";
			}
		}
		if(this.hasExactly("Bride's Fang")){
			if(enemy.combatStartHp / enemy.maxHp >= 0.75 || (this.rValue > 0 && this.initiator)){
				enemy.combatSpur.atk -= 5;
				enemy.combatSpur.spd -= 5;
				enemy.combatSpur.def -= 5;
				var bfText = "";
				if(this.rValue > 0){
					bfText = " or initiating";
				}
				boostText += this.name + " inflicts -5 atk/spd/def to " + enemy.name + " from enemy HP >= 75%" + bfText + " with Bride's Fang.<br>";
			}
			if(this.rValue == 5 && this.combatStartHp / this.maxHp >= 0.25){
				enemy.combatSpur.atk -= 4;
				enemy.combatSpur.spd -= 4;
				enemy.combatSpur.def -= 4;
				boostText += this.name + " inflicts -4 atk/spd/def to " + enemy.name + " from HP >= 25% with Bride's Fang.<br>";
			}
		}
		if((this.hasExactly("Fell War Tome") || this.hasExactly("Draconic Pacts")) && (this.initiator || this.buddy.adjacent > 0 || this.buddy.two > 0)){
			var fwVal = 8;
			if(enemy.specialIndex != -1){
				fwVal = 16 - ((data.skills[enemy.specialIndex].charge - enemy.initSkillCharge()) * 2);
				fwVal = Math.max(fwVal,8);
			}
			this.combatSpur.atk += fwVal;
			this.combatSpur.spd += fwVal;
			this.combatSpur.def += fwVal;
			this.combatSpur.res += fwVal;
			boostText += this.name + " gets +" + fwVal + " to all stats from initiating or being within 2 spaces of an ally with " + data.skills[this.weaponIndex].name + ".<br>";
		}
		if(this.hasExactly("Exalt's War Staff") && this.buddy.adjacent + this.buddy.two + this.buddy.three > 0){
			this.combatSpur.atk += 6;
			this.combatSpur.res += 6;
			boostText += this.name + " gets +6 to atk & res from being within 3 spaces of an ally with Exalt's War Staff.<br>";
		}
		if(this.hasExactly("New War Axe") && this.buddy.adjacent + this.buddy.two + this.buddy.three > 0){
			var nwVal = Math.floor(allStats[20] * 0.25) - 4;
			nwVal = Math.min(nwVal,14);
			nwVal = Math.max(nwVal,5);
			this.combatSpur.atk += nwVal;
			this.combatSpur.def += nwVal;
			this.combatSpur.res += nwVal;
			boostText += this.name + " gets +" + nwVal + " to atk/def/res from being within 3 spaces of an ally with New War Axe.<br>";
		}
		if(this.hasExactly("Fell Wyrmscale") && this.combatStartHp / this.maxHp >= 0.25){
			this.combatSpur.atk += 8;
			this.combatSpur.spd += 8;
			this.combatSpur.def += 8;
			this.combatSpur.res += 8;
			boostText += this.name + " gets +8 to all stats from HP >= 25% with Fell Wyrmscale.<br>";
		}
		if(this.hasExactly("Heavy War Axe") && (this.initiator || this.buddy.adjacent > 0 || this.buddy.two > 0)){
			this.combatSpur.atk += 5;
			this.combatSpur.spd += 5;
			this.combatSpur.def += 5;
			this.combatSpur.res += 5;
			boostText += this.name + " gets +5 to all stats from initiating or being within 2 spaces of an ally with Heavy War Axe.<br>";
		}
		if(this.hasExactly("Forager Naginata") && this.combatStartHp / this.maxHp >= 0.25){
			var fnVal = Math.min((this.buddy.adjacent + this.buddy.two + this.buddy.three) * 3 + 1, 10);
			this.combatSpur.atk += 5 + fnVal;
			this.combatSpur.spd += 5 + fnVal;
			this.combatSpur.def += 5 + fnVal;
			this.combatSpur.res += 5 + fnVal;
			boostText += this.name + " gets +5 to all stats and an additional +" + fnVal + " to all stats from HP >= 25% with Forager Naginata.<br>";
		}
		if(this.hasExactly("Perspicacious") && this.combatStartHp / this.maxHp >= 0.25){
			var pVal = this.toggle.weapon * 3 + 6;
			enemy.combatSpur.atk -= pVal;
			enemy.combatSpur.def -= pVal;
			boostText += this.name + " inflicts -" + pVal + " atk & def to " + enemy.name + " from HP >= 25% with Perspicacious.<br>";
		}
		if((this.has("Raudrlantern") || this.has("Gronnlantern")) && (this.initiator || this.buddy.adjacent > 0 || this.buddy.two > 0)){
			this.combatSpur.atk += 5;
			this.combatSpur.res += 5;
			boostText += this.name + " gets +5 to atk & res from initiating or being within 2 spaces of an ally with " + data.skills[this.weaponIndex].name + ".<br>";
		}
		if(this.hasExactly("Tri-Path Splitter") && this.buddy.adjacent + this.buddy.two + this.buddy.three > 0){
			this.combatSpur.atk += 5;
			this.combatSpur.spd += 5;
			this.combatSpur.def += 5;
			this.combatSpur.res += 5;
			boostText += this.name + " gets +5 to all stats from being within 3 spaces of an ally with Tri-Path Splitter.<br>";
		}
		if(this.hasExactly("Supreme Thokk") && this.combatStartHp / this.maxHp >= 0.25){
			var stVal = Math.floor(allStats[19] * 0.2) + 6;
			this.combatSpur.atk += stVal;
			this.combatSpur.res += stVal;
			boostText += this.name + " gets +" + stVal + " to atk & res from HP >= 25% with Supreme Thokk.<br>";
		}
		if(this.hasExactly("Divine Deceit") && this.checkBonPen(2,enemy,currTurn)){
			this.combatSpur.atk += 5;
			this.combatSpur.res += 5;
			boostText += this.name + " gets +5 to atk & res from enemy having a Penalty effect active with Divine Deceit.<br>";
		}
		if(this.hasExactly("Amatsu") && this.rValue > 0){
			if(this.combatStartHp / this.maxHp >= 0.25){
				this.combatSpur.atk += 4;
				this.combatSpur.spd += 4;
				this.combatSpur.def += 4;
				this.combatSpur.res += 4;
				boostText += this.name + " gets +4 to all stats from HP >= 25% with Amatsu.<br>";
			}
			if(this.rValue == 5 && (!this.initiator || enemy.combatStartHp / enemy.maxHp >= 0.75)){
				this.combatSpur.atk += 4;
				this.combatSpur.spd += 4;
				this.combatSpur.def += 4;
				this.combatSpur.res += 4;
				boostText += this.name + " gets +4 to all stats from enemy initiating or enemy HP >= 75% with Amatsu.<br>";
			}
		}
		if(this.hasExactly("Blood Tome") && this.rValue > 0){
			if(this.initiator || enemy.range == "ranged"){
				this.combatSpur.atk += 5;
				enemy.combatSpur.atk -= 5;
				boostText += this.name + " gets +5 to atk and inflicts -5 atk to " + enemy.name + " from initiating or enemy range == 2 with Blood Tome.<br>";
			}
			if(this.rValue == 5 && this.combatStartHp / this.maxHp >= 0.25){
				this.combatSpur.atk += 5;
				enemy.combatSpur.atk -= 5;
				boostText += this.name + " gets +5 to atk and inflicts -5 atk to " + enemy.name + " from HP >= 25% with Blood Tome.<br>";
			}
		}
		if(this.hasExactly("Summer Strikers")){
			if((this.initiator && (this.rValue > 0 || this.combatStartHp / this.maxHp >= 0.25)) || (this.rValue > 0 && enemy.range == "ranged")){
				this.combatSpur.atk += 5;
				this.combatSpur.spd += 5;
				var ssText = " and HP >= 25%";
				if(this.rValue > 0){
					ssText = " or enemy range == 2";
				}
				boostText += this.name + " gets +5 atk & spd from initiating" + ssText + " with Summer Strikers.<br>";
			}
			if(this.rValue == 5 && this.combatStartHp / this.maxHp >= 0.25){
				var ssVal = Math.floor(allStats[17] * 0.2) + 5;
				this.combatSpur.atk += ssVal;
				this.combatSpur.spd += ssVal;
				boostText += this.name + " gets +" + ssVal + " to atk & spd from HP >= 25% with Summer Strikers.<br>";
			}
		}
		if(this.hasExactly("Fell Child's Might") && (this.initiator || enemy.range == "ranged")){
			var fmVal = Math.floor(allStats[19] * 0.2) + 6;
			enemy.combatSpur.atk -= fmVal;
			enemy.combatSpur.res -= fmVal;
			boostText += this.name + " inflicts -" + fmVal + " atk & res to " + enemy.name + " from initiating or enemy range == 2 with Fell Child's Might.<br>";
		}
		if((this.hasExactly("Fell Successor") || this.hasExactly("Fell Majesty")) && (this.initiator || this.buddy.adjacent > 0 || this.buddy.two > 0)){
			enemy.combatSpur.atk -= 5;
			enemy.combatSpur.res -= 5;
			boostText += this.name + " inflicts -5 atk & res to " + enemy.name + " from initiating or being within 2 spaces of an ally with " + data.skills[this.cIndex].name + ".<br>";
		}
		if((this.hasExactly("Dead-Crow Tome") || this.hasExactly("Nidavellir Ballista")) && this.combatStartHp / this.maxHp >= 0.25){
			var dtVal = Math.floor(allStats[17] * 0.2) + 6;
			this.combatSpur.atk += dtVal;
			this.combatSpur.spd += dtVal;
			boostText += this.name + " gets +" + dtVal + " to atk & spd from HP >= 25% with " + data.skills[this.weaponIndex].name + ".<br>";
		}
		if(this.hasExactly("Ereshkigal") && this.combatStartHp / this.maxHp >= 0.25){
			var eVal = Math.floor(allStats[19] * 0.2) + 6;
			enemy.combatSpur.atk -= eVal;
			enemy.combatSpur.res -= eVal;
			boostText += this.name + " inflicts -" + eVal + " atk & res to " + enemy.name + " from HP >= 25% with Ereshkigal.<br>";
		}
		if(this.hasExactly("Dead-Wolf Blade") && this.combatStartHp / this.maxHp >= 0.25){
			var dbVal = Math.floor(allStats[17] * 0.15) + 5;
			this.combatSpur.atk += dbVal;
			this.combatSpur.spd += dbVal;
			this.combatSpur.def += dbVal;
			this.combatSpur.res += dbVal;
			boostText += this.name + " gets +" + dbVal + " to all stats from HP >= 25% with Dead-Wolf Blade.<br>";
		}
		if((this.hasExactly("Closing Florets") || this.hasExactly("United Bouquet") || this.hasExactly("Love of Nerthuz")) && this.combatStartHp / this.maxHp >= 0.25){
			var cfVal = (this.toggle.weapon * 3) + 5;
			this.combatSpur.atk += cfVal;
			this.combatSpur.spd += cfVal;
			this.combatSpur.def += cfVal;
			this.combatSpur.res += cfVal;
			boostText += this.name + " gets +" + cfVal + " to all stats from HP >= 25% with " + data.skills[this.weaponIndex].name + ".<br>";
		}
		if(this.hasExactly("Absolute Closure") && this.transform == true){
			this.combatSpur.atk += 4;
			this.combatSpur.spd += 4;
			this.combatSpur.def += 4;
			this.combatSpur.res += 4;
			boostText += this.name + " gets +4 to all stats from transforming with Absolute Closure.<br>";
		}
		if(this.hasExactly("Wildflower Edge") && (this.initiator || this.buddy.adjacent > 0 || this.buddy.two > 0)){
			var weVal = Math.floor(allStats[17] * 0.15) + 5;
			this.combatSpur.atk += weVal;
			this.combatSpur.spd += weVal;
			this.combatSpur.def += weVal;
			this.combatSpur.res += weVal;
			boostText += this.name + " gets +" + weVal + " to all stats from initiating or being within 2 spaces of an ally with Wildflower Edge.<br>";
		}
		if((this.has("Dragonbloom") || this.has("Harp Bow")) && (this.initiator || this.buddy.adjacent > 0 || this.buddy.two > 0)){
			this.combatSpur.atk += 4;
			this.combatSpur.spd += 4;
			this.combatSpur.def += 4;
			this.combatSpur.res += 4;
			boostText += this.name + " gets +4 to all stats from initiating or being within 2 spaces of an ally with " + data.skills[this.weaponIndex].name + ".<br>";
		}
		if(this.hasExactly("Forever Yours") && (this.initiator || this.buddy.adjacent + this.buddy.two + this.buddy.three > 0)){
			this.combatSpur.atk += 4;
			this.combatSpur.spd += 4;
			this.combatSpur.def += 4;
			this.combatSpur.res += 4;
			boostText += this.name + " gets +4 to all stats from initiating or being within 3 spaces of an ally with Forever Yours.<br>";
		}
		if(this.hasExactly("Hoshido's Breath") && this.combatStartHp / this.maxHp >= 0.25){
			var hbVal = Math.min((this.buddy.adjacent + this.buddy.two + this.buddy.three) * 3 + 5, 14);
			this.combatSpur.atk += hbVal;
			this.combatSpur.spd += hbVal;
			this.combatSpur.def += hbVal;
			this.combatSpur.res += hbVal;
			boostText += this.name + " gets +" + hbVal + " to all stats from HP >= 25% with Hoshido's Breath.<br>";
		}
		if(this.hasExactly("Exotic Fruit Juice")){
			enemy.combatSpur.spd -= 6;
			enemy.combatSpur.res -= 6;
			boostText += this.name + " has activated Exotic Fruit Juice. Effect on " + enemy.name + ": -6 to spd & res.<br>";
			if(this.rValue == 5 && (this.initiator || enemy.combatStartHp / enemy.maxHp >= 0.75)){
				enemy.combatSpur.spd -= 5;
				enemy.combatSpur.res -= 5;
				boostText += this.name + " has activated Exotic Fruit Juice. Effect on " + enemy.name + ": -5 to spd & res.<br>";
			}
		}
		if(this.hasExactly("Thief's Honesty")){
			if(this.combatStartHp / this.maxHp >= 0.25){
				this.combatSpur.atk += 4;
				this.combatSpur.spd += 4;
				this.combatSpur.def += 4;
				this.combatSpur.res += 4;
				boostText += this.name + " gets +4 to all stats from HP >= 25% with Thief's Honesty.<br>";
			}
			if(this.rValue == 5 && (this.initiator || this.buddy.adjacent > 0 || this.buddy.two > 0)){
				this.combatSpur.atk += 4;
				this.combatSpur.spd += 4;
				this.combatSpur.def += 4;
				this.combatSpur.res += 4;
				boostText += this.name + " gets +4 to all stats from initiating or being within 2 spaces of an ally with Thief's Honesty.<br>";
				if(checkAllBuffs(enemy, this, currTurn) && allStats[9]){
					var extraStats = [0,0,0,0];
					var buffText = "";
					var debuffText = "";
					if(!allStats[15][0]){
						extraStats[0] = Math.max(enemy.buffs.atk,enemy.combatBuffs.atk);
						if(extraStats[0] > 0){
							this.combatSpur.atk += extraStats[0];
							enemy.combatSpur.atk -= extraStats[0];
							buffText += " +" + extraStats[0] + " atk";
							debuffText += " -" + extraStats[0] + " atk";
						}
					}
					if(!allStats[15][1]){
						extraStats[1] = Math.max(enemy.buffs.spd,enemy.combatBuffs.spd);
						if(extraStats[1] > 0){
							this.combatSpur.spd += extraStats[1];
							enemy.combatSpur.spd -= extraStats[1];
							buffText += " +" + extraStats[1] + " spd";
							debuffText += " -" + extraStats[1] + " spd";
						}
					}
					if(!allStats[15][2]){
						extraStats[2] = Math.max(enemy.buffs.def,enemy.combatBuffs.def);
						if(extraStats[2] > 0){
							this.combatSpur.def += extraStats[2];
							enemy.combatSpur.def -= extraStats[2];
							buffText += " +" + extraStats[2] + " def";
							debuffText += " -" + extraStats[2] + " def";
						}
					}
					if(!allStats[15][3]){
						extraStats[3] = Math.max(enemy.buffs.res,enemy.combatBuffs.res);
						if(extraStats[3] > 0){
							this.combatSpur.res += extraStats[3];
							enemy.combatSpur.res -= extraStats[3];
							buffText += " +" + extraStats[3] + " res";
							debuffText += " -" + extraStats[3] + " res";
						}
					}
					boostText += this.name + " gets" + buffText + " and inflicts" + debuffText + " to " + enemy.name + " from initiating or being within 2 spaces of an ally and enemy having buffs with Thief's Honesty.<br>";
				}
			}
		}
		if((this.hasExactly("Caladbolg") || this.hasExactly("Arcane Tempest") || this.hasExactly("Arcane Sly Knife") || this.hasExactly("Arcane Medusa")) && this.combatStartHp / this.maxHp >= 0.25){
			var cbVal = Math.floor(allStats[20] * 0.25) - 4;
			cbVal = Math.min(cbVal, 14);
			cbVal = Math.max(cbVal, 5);
			this.combatSpur.atk += cbVal;
			this.combatSpur.spd += cbVal;
			this.combatSpur.def += cbVal;
			this.combatSpur.res += cbVal;
			boostText += this.name + " gets +" + cbVal + " to all stats from HP >= 25% with " + data.skills[this.weaponIndex].name + ".<br>";
		}
		if(this.hasExactly("Silver of Dawn") && this.combatStartHp / this.maxHp >= 0.25){
			var sdVal = Math.floor(allStats[19] * 0.2) + 6;
			enemy.combatSpur.atk -= sdVal;
			enemy.combatSpur.res -= sdVal;
			boostText += this.name + " inflicts -" + sdVal + " atk & res to " + enemy.name + " from HP >= 25% with Silver of Dawn.<br>";
		}
		if(this.hasExactly("Yune's Protection") && (this.initiator || this.buddy.adjacent > 0 || this.buddy.two > 0)){
			var eNegate = this.checkNegate(enemy, currTurn);
			var dAtk = 0;
			var dSpd = 0;
			var dDef = 0;
			var dRes = 0;
			var ypVal = 5;
			if(eNegate[0] == false){
				dAtk += Math.min(enemy.combatDebuffs.atk,enemy.debuffs.atk);
				if(enemy.penalty.panic){
					dAtk -= Math.max(enemy.combatBuffs.atk,enemy.buffs.atk);
				}
			}
			dAtk = Math.min(dAtk, enemy.buddy.debuffs.atk);
			if(eNegate[1] == false){
				dSpd += Math.min(enemy.combatDebuffs.spd,enemy.debuffs.spd);
				if(enemy.penalty.panic){
					dSpd -= Math.max(enemy.combatBuffs.spd,enemy.buffs.spd);
				}
			}
			dSpd = Math.min(dSpd, enemy.buddy.debuffs.spd);
			if(eNegate[2] == false){
				dDef += Math.min(enemy.combatDebuffs.def,enemy.debuffs.def);
				if(enemy.penalty.panic){
					dDef -= Math.max(enemy.combatBuffs.def,enemy.buffs.def);
				}
			}
			dDef = Math.min(dDef, enemy.buddy.debuffs.def);
			if(eNegate[3] == false){
				dRes += Math.min(enemy.combatDebuffs.res,enemy.debuffs.res);
				if(enemy.penalty.panic){
					dRes -= Math.max(enemy.combatBuffs.res,enemy.buffs.res);
				}
			}
			dRes = Math.min(dRes, enemy.buddy.debuffs.res);
			ypVal = ypVal - dAtk - dSpd - dDef - dRes;
			enemy.combatSpur.atk -= ypVal;
			enemy.combatSpur.res -= ypVal;
			boostText += this.name + " inflicts -" + ypVal + " atk & res to " + enemy.name + " from initiating or being within 2 spaces of an ally with Yune's Protection.<br>";
		}
		if(this.hasExactly("Prince's Lance") && (this.initiator || this.buddy.adjacent > 0 || this.buddy.two > 0)){
			var ssVal = Math.floor(allStats[20] * 0.25) - 4;
			ssVal = Math.max(ssVal,5);
			ssVal = Math.min(ssVal,14);
			this.combatSpur.atk += ssVal;
			this.combatSpur.spd += ssVal;
			this.combatSpur.def += ssVal;
			this.combatSpur.res += ssVal;
			var dAtk = Math.max(enemy.combatBuffs.atk,enemy.buffs.atk) * -2;
			var dSpd = Math.max(enemy.combatBuffs.spd,enemy.buffs.spd) * -2;
			var dDef = Math.max(enemy.combatBuffs.def,enemy.buffs.def) * -2;
			var dRes = Math.max(enemy.combatBuffs.res,enemy.buffs.res) * -2;
			if(enemy.penalty.panic){
				dAtk = 0;
				dSpd = 0;
				dDef = 0;
				dRes = 0;
			}
			enemy.combatSpur.atk += dAtk;
			enemy.combatSpur.spd += dSpd;
			enemy.combatSpur.def += dDef;
			enemy.combatSpur.res += dRes;
			boostText += this.name + " gets +" + ssVal + " to all stats and inflicts " + dAtk + "/" + dSpd + "/" + dDef + "/" + dRes + " in stats to " + enemy.name + " from initiating or being within 2 spaces of an ally with Prince's Lance.<br>";
		}
		if(this.has("Sea Tambourine") && this.combatStartHp / this.maxHp >= 0.25){
			var stVal = 5;
			if(currTurn % 2 == 1){
				stVal += 6;
			}
			this.combatSpur.atk += stVal;
			this.combatSpur.spd += stVal;
			boostText += this.name + " gets +" + stVal + " to atk & spd from HP >= 25% with " + data.skills[this.weaponIndex].name + ".<br>";
		}
		if(this.hasExactly("Golden Sunlight") && (this.initiator || enemy.combatStartHp / enemy.maxHp >= 0.75)){
			var gsVal = Math.min(this.buddy.erorc * 3 + 5, 14);
			this.combatSpur.atk += gsVal;
			this.combatSpur.spd += gsVal;
			this.combatSpur.def += gsVal;
			this.combatSpur.res += gsVal;
			boostText += this.name + " gets +" + gsVal + " to all stats from initiating or enemy HP >= 75% with Golden Sunlight.<br>";
		}
		if(this.has("Tropical Conch") && this.combatStartHp / this.maxHp >= 0.25){
			var tcVal = 5;
			if(currTurn % 2 == 1){
				tcVal += 6;
			}
			this.combatSpur.atk += tcVal;
			this.combatSpur.def += tcVal;
			boostText += this.name + " gets +" + tcVal + " to atk & def from HP >= 25% with " + data.skills[this.weaponIndex].name + ".<br>";
		}
		if(this.hasExactly("Caring Magic") && (this.initiator || this.buddy.adjacent > 0 || this.buddy.two > 0)){
			var cmVal = Math.floor(allStats[17] * 0.2) + 6;
			this.combatSpur.atk += cmVal;
			this.combatSpur.spd += cmVal;
			boostText += this.name + " gets +" + cmVal + " to atk & spd from initiating or being within 2 spaces of an ally with Caring Magic.<br>";
		}
		if(this.hasExactly("Wyvern Lance")){
			enemy.combatSpur.atk -= 5;
			enemy.combatSpur.def -= 5;
			boostText += this.name + " inflicts -5 atk & def to " + enemy.name + " with Wyvern Lance.<br>";
			if(this.rValue == 5 && (!this.initiator || enemy.combatStartHp / enemy.maxHp >= 0.75)){
				var wlVal = Math.floor(allStats[18] * 0.15) + 5;
				enemy.combatSpur.atk -= wlVal;
				enemy.combatSpur.def -= wlVal;
				if(this.penalty.panic){
					this.combatBuffs.atk = 0;
					this.combatBuffs.def = 0;
					this.buffs.atk = 0;
					this.buffs.def = 0;
				}
				this.combatDebuffs.atk = 0;
				this.combatDebuffs.def = 0;
				this.debuffs.atk = 0;
				this.debuffs.def = 0;
				boostText += this.name + " inflicts -" + wlVal + " atk & def to " + enemy.name + " and neutralizes penalties to atk & def from enemy initiating or enemy HP >= 75% with Wyvern Lance.<br>";
			}
		}
		if(this.hasExactly("Plegian War Axe")){
			if(this.initiator || this.buddy.adjacent > 0 || this.buddy.two > 0){
				this.combatSpur.atk += 4;
				this.combatSpur.spd += 4;
				this.combatSpur.def += 4;
				this.combatSpur.res += 4;
				boostText += this.name + " gets +4 to all stats from initiating or being within 2 spaces of an ally with Plegian War Axe.<br>";
			}
			if(this.rValue == 5 && this.combatStartHp / this.maxHp >= 0.25){
				this.combatSpur.atk += 4;
				this.combatSpur.spd += 4;
				this.combatSpur.def += 4;
				this.combatSpur.res += 4;
				boostText += this.name + " gets +4 to all stats from HP >= 25% with Plegian War Axe.<br>";
			}
		}
		if(this.hasExactly("Order's Sentence")){
			if(this.combatStartHp / this.maxHp >= 0.25 || this.checkBonPen(1, enemy, currTurn)){
				this.combatSpur.atk += 5;
				this.combatSpur.spd += 5;
				this.combatSpur.def += 5;
				this.combatSpur.res += 5;
				boostText += this.name + " gets +5 to all stats from HP >= 25% or having a [Bonus] active with Order's Sentence.<br>";
			}
			if(this.rValue == 5 && (this.initiator || enemy.range == "ranged")){
				this.combatSpur.atk += 4;
				this.combatSpur.spd += 4;
				this.combatSpur.def += 4;
				this.combatSpur.res += 4;
				boostText += this.name + " gets +4 to all stats from initiating or enemy range = 2 with Order's Sentence.<br>";
			}
		}
		if(this.hasExactly("Order's Restraint+") && this.buddy.adjacent + this.buddy.two + this.buddy.three > 0){
			this.combatSpur.atk += 4;
			this.combatSpur.spd += 4;
			this.combatSpur.def += 4;
			this.combatSpur.res += 4;
			boostText += this.name + " gets +4 to all stats from having an ally within 3 spaces with Order's Restraint+.<br>";
		}
		if((this.hasExactly("Maritime Arts") || this.hasExactly("Wintery Arts")) && this.buddy.adjacent + this.buddy.two + this.buddy.three > 0){
			this.combatSpur.atk += 5;
			this.combatSpur.spd += 5;
			this.combatSpur.def += 5;
			this.combatSpur.res += 5;
			var sVal = 4;
			if(this.toggle.weapon > 0){
				sVal += Math.min(this.toggle.weapon * 3, 6);
			}
			enemy.combatSpur.atk -= sVal;
			enemy.combatSpur.spd -= sVal;
			enemy.combatSpur.def -= sVal;
			enemy.combatSpur.res -= sVal;
			boostText += this.name + " gets +5 to all stats and inflicts -" + sVal + " all stats to " + enemy.name + " from having an ally within 3 spaces with " + data.skills[this.weaponIndex].name + ".<br>";
		}
		if(this.hasExactly("Breaker Bow") && this.combatStartHp / this.maxHp >= 0.25){
			var bbVal = this.toggle.weapon * 6;
			this.combatSpur.atk += 5 + bbVal;
			this.combatSpur.spd += 5 + bbVal;
			this.combatSpur.def += 5;
			this.combatSpur.res += 5;
			boostText += this.name + " gets +5 to all stats and an additional +" + bbVal + " atk & spd from HP >= 25% with Breaker Bow.<br>";
		}
		if((this.has("Small Spade") || this.has("Helping Dagger")) && this.combatStartHp / this.maxHp >= 0.25){
			var ssVal = this.toggle.weapon * 5 + 5;
			this.combatSpur.atk += ssVal;
			this.combatSpur.spd += ssVal;
			boostText += this.name + " gets +" + ssVal + " to atk & spd from HP >= 25% with " + data.skills[this.weaponIndex].name + ".<br>";
		}
		if(this.hasExactly("Diva-Pair Parasol")){
			if(allStats[18] + 5 >= allStats[22]){
				var dpVal = Math.floor(allStats[20] * 0.15);
				enemy.combatSpur.atk -= dpVal;
				enemy.combatSpur.spd -= dpVal;
				boostText += this.name + " inflicts -" + dpVal + " atk & spd to " + enemy.name + " from Def + 5 >= enemy Def with Diva-Pair Parasol.<br>";
			}
			if(this.combatStartHp / this.maxHp >= 0.25){
				var dpVal = Math.min((this.buddy.adjacent + this.buddy.two + this.buddy.three) * 3 + 5, 14);
				this.combatSpur.atk += dpVal;
				this.combatSpur.spd += dpVal;
				this.combatSpur.def += dpVal;
				this.combatSpur.res += dpVal;
				boostText += this.name + " gets +" + dpVal + " to all stats from HP >= 25% with Diva-Pair Parasol.<br>";
			}
		}
		if((this.hasExactly("Anchor Axe") || this.hasExactly("Anchor Axe+")) && this.combatStartHp / this.maxHp >= 0.25){
			var aaVal = this.toggle.weapon * 5 + 5;
			this.combatSpur.atk += aaVal;
			this.combatSpur.def += aaVal;
			boostText += this.name + " gets +" + aaVal + " to atk & def from HP >= 25% with " + data.skills[this.weaponIndex].name + ".<br>";
		}
		if(this.hasExactly("Lance of Grado") && this.buddy.adjacent + this.buddy.two + this.buddy.three > 0){
			var lgVal = 5;
			lgVal += Math.min(9, (this.buddy.adjacent + this.buddy.two + this.buddy.three) * 3);
			this.combatSpur.atk += lgVal;
			this.combatSpur.spd += lgVal;
			this.combatSpur.def += lgVal;
			this.combatSpur.res += lgVal;
			if(this.penalty.panic){
				this.combatBuffs = {"atk":0,"spd":0,"def":0,"res":0};
				this.buffs = {"atk":0,"spd":0,"def":0,"res":0};
			}
			this.combatDebuffs = {"atk":0,"spd":0,"def":0,"res":0};
			this.debuffs = {"atk":0,"spd":0,"def":0,"res":0};
			boostText += this.name + " gets +" + lgVal + " to all stats and neutralizes all penalties from having an ally within 3 spaces with Lance of Grado.<br>";
		}
		if(this.hasExactly("Obsidian Tactics") && (!this.initiator || enemy.combatStartHp / enemy.maxHp >= 0.75)){
			this.combatSpur.atk += 9;
			this.combatSpur.spd += 9;
			this.combatSpur.def += 9;
			this.combatSpur.res += 9;
			var otText = "";
			if(this.toggle.a > 0){
				var otVal = this.toggle.a * 2;
				enemy.combatSpur.atk -= otVal;
				enemy.combatSpur.def -= otVal;
				otText = " and inflicts -" + otVal + " atk & def to " + enemy.name;
			}
			boostText += this.name + " gets +9 to all stats" + otText + " from enemy initiating or enemy HP >= 75% with Obsidian Tactics.<br>";
		}
		if(this.hasExactly("Wild Wind Sword") && this.combatStartHp / this.maxHp >= 0.25){
			var dAtk = 5 + Math.min(this.combatDebuffs.atk,this.debuffs.atk) * -2;
			var dSpd = 5 + Math.min(this.combatDebuffs.spd,this.debuffs.spd) * -2;
			var dDef = 5 + Math.min(this.combatDebuffs.def,this.debuffs.def) * -2;
			var dRes = 5 + Math.min(this.combatDebuffs.res,this.debuffs.res) * -2;
			if(this.penalty.panic){
				dAtk += Math.max(this.combatBuffs.atk,this.buffs.atk) * 2;
				dSpd += Math.max(this.combatBuffs.spd,this.buffs.spd) * 2;
				dDef += Math.max(this.combatBuffs.def,this.buffs.def) * 2;
				dRes += Math.max(this.combatBuffs.res,this.buffs.res) * 2;
			}
			this.combatSpur.atk += dAtk;
			this.combatSpur.spd += dSpd;
			this.combatSpur.def += dDef;
			this.combatSpur.res += dRes;
			boostText += this.name + " gets net + " + dAtk + "/" + dSpd + "/" + dDef + "/" + dRes + " in stats from HP >= 25% with Wild Wind Sword.<br>";
		}
		if(this.hasExactly("Sisterly Axe") && this.buddy.adjacent + this.buddy.two + this.buddy.three > 0){
			var saVal = 5;
			if(this.toggle.weapon > 0 && this.toggle.weapon != 10){
				saVal += this.toggle.weapon % 10 * 3;
			}
			this.combatSpur.atk += saVal;
			this.combatSpur.spd += saVal;
			this.combatSpur.def += saVal;
			this.combatSpur.res += saVal;
			boostText += this.name + " gets +" + saVal + " to all stats from having an ally within 3 spaces with Sisterly Axe.<br>";
		}
		if(this.hasExactly("Sunstone's Blade") && (this.initiator || this.toggle.weapon == 1)){
			this.combatSpur.atk += 5;
			this.combatSpur.spd += 5;
			this.combatSpur.def += 5;
			this.combatSpur.res += 5;
			var sbVal = Math.floor(allStats[18] * 0.2);
			enemy.combatSpur.atk -= sbVal;
			enemy.combatSpur.def -= sbVal;
			boostText += this.name + " gains +5 to all stats and inflicts -" + sbVal + " atk & def to " + enemy.name + " from initiating or having an ally within 3 rows/columns with Sunstone's Blade.<br>";
		}
		if(this.hasExactly("Nectar Horn") && (!this.initiator || enemy.combatStartHp / enemy.maxHp >= 0.75)){
			var nhVal = 6;
			nhVal += Math.floor(allStats[19] * 0.2);
			enemy.combatSpur.atk -= nhVal;
			enemy.combatSpur.def -= nhVal;
			boostText += this.name + " inflicts -" + nhVal + " atk & def to " + enemy.name + " from enemy initiating or enemy HP >= 75% with Nectar Horn.<br>";
		}
		if((this.hasExactly("Quieting Antler") || this.hasExactly("Delivering Antler")) && (this.initiator || this.buddy.adjacent > 0 || this.buddy.two > 0)){
			var qaText = ""
			var qaVal = 6;
			qaVal += Math.floor(allStats[18] * 0.2);
			enemy.combatSpur.atk -= qaVal;
			enemy.combatSpur.def -= qaVal;
			if(this.hasExactly("Delivering Antler")){
				if(this.penalty.panic){
					this.combatBuffs.atk = 0;
					this.combatBuffs.def = 0;
					this.buffs.atk = 0;
					this.buffs.def = 0;
				}
				this.combatDebuffs.atk = 0;
				this.combatDebuffs.def = 0;
				this.debuffs.atk = 0;
				this.debuffs.def = 0;
				qaText = " and neutralizes penalties to atk & def";
			}
			boostText += this.name + " inflicts -" + qaVal + " atk & def to " + enemy.name + qaText + " from initiating or being within 2 spaces of an ally with " + data.skills[this.weaponIndex].name + ".<br>";
		}
		if(this.hasExactly("Mercenary Lance")){
			if(!this.initiator || enemy.combatStartHp / enemy.maxHp >= 0.75){
				enemy.combatSpur.atk -= 5;
				enemy.combatSpur.def -= 5;
				if(this.penalty.panic){
					this.combatBuffs = {"atk":0,"spd":0,"def":0,"res":0};
					this.buffs = {"atk":0,"spd":0,"def":0,"res":0};
				}
				this.combatDebuffs = {"atk":0,"spd":0,"def":0,"res":0};
				this.debuffs = {"atk":0,"spd":0,"def":0,"res":0};
				boostText += this.name + " inflicts -5 atk & def to " + enemy.name + " and neutralizes penalties from enemy initiating or enemy HP >= 75% with Mercenary Lance.<br>";
			}
			if(this.rValue == 5 && this.combatStartHp / this.maxHp >= 0.25){
				var mlVal = 5 + Math.floor(allStats[18] * 0.15);
				enemy.combatSpur.atk -= mlVal;
				enemy.combatSpur.def -= mlVal;
				boostText += this.name + " inflicts -" + mlVal + " atk & def to " + enemy.name + " from HP >= 25% with Mercenary Lance.<br>";
			}
		}
		if(this.hasExactly("Tiger-Eye Axe")){
			if(this.combatStartHp / this.maxHp >= 0.25){
				this.combatSpur.atk += 4;
				this.combatSpur.spd += 4;
				this.combatSpur.def += 4;
				this.combatSpur.res += 4;
				boostText += this.name + " gets +4 to all stats from HP >= 25% with Tiger-Eye Axe.<br>";
			}
			if(this.rValue == 5 && (this.checkBonPen(1,enemy,currTurn) || enemy.checkBonPen(3,this.currTurn))){
				this.combatSpur.atk += 4;
				this.combatSpur.spd += 4;
				this.combatSpur.def += 4;
				this.combatSpur.res += 4;
				var eNegate = this.checkNegate(enemy, currTurn);
				var dAtk = 0;
				var dSpd = 0;
				var dDef = 0;
				if(eNegate[0] == false){
					dAtk += Math.min(enemy.combatDebuffs.atk,enemy.debuffs.atk);
					if(enemy.penalty.panic){
						dAtk -= Math.max(enemy.combatBuffs.atk,enemy.buffs.atk);
					}
				}
				if(eNegate[1] == false){
					dSpd += Math.min(enemy.combatDebuffs.spd,enemy.debuffs.spd);
					if(enemy.penalty.panic){
						dSpd -= Math.max(enemy.combatBuffs.spd,enemy.buffs.spd);
					}
				}
				if(eNegate[2] == false){
					dDef += Math.min(enemy.combatDebuffs.def,enemy.debuffs.def);
					if(enemy.penalty.panic){
						dDef -= Math.max(enemy.combatBuffs.def,enemy.buffs.def);
					}
				}
				if(enemy.buddy.adjacent > 0 || enemy.buddy.two > 0){
					dAtk = Math.min(dAtk,enemy.buddy.debuffs.atk);
					dSpd = Math.min(dSpd,enemy.buddy.debuffs.spd);
					dDef = Math.min(dDef,enemy.buddy.debuffs.def);
				}
				enemy.combatSpur.atk += dAtk;
				enemy.combatSpur.spd += dSpd;
				enemy.combatSpur.def += dDef;
				boostText += this.name + " gets +4 to all stats and inflicts " + dAtk + " atk/" + dSpd + " spd/" + dDef + " def on " + enemy.name + " from having any [Bonus] active or having any [Penalty] active on enemy with Tiger-Eye Axe.<br>";
			}
		}
		if(this.hasExactly("Summertime Axe") && this.combatStartHp / this.maxHp >= 0.25){
			var saVal = Math.floor(allStats[17] * 0.15);
			this.combatSpur.atk += saVal;
			this.combatSpur.spd += saVal;
			this.combatSpur.def += saVal;
			this.combatSpur.res += saVal;
			boostText += this.name + " gets +" + saVal + " to all stats from HP >= 25% with Summertime Axe.<br>";
		}
		if(this.hasExactly("Breezy Spear")){
			var bsVal = 5 + Math.floor(allStats[17] * 0.15);
			this.combatSpur.atk += bsVal;
			this.combatSpur.spd += bsVal;
			this.combatSpur.def += bsVal;
			this.combatSpur.res += bsVal;
			boostText += this.name + " gets +" + bsVal + " to all stats with Breezy Spear.<br>";
		}
		if((this.has("Juicy Bucketful") || this.has("Stall-Game Bow")) && this.combatStartHp / this.maxHp >= 0.25){
			this.combatSpur.atk += 4;
			this.combatSpur.spd += 4;
			this.combatSpur.def += 4;
			this.combatSpur.res += 4;
			boostText += this.name + " gets +4 to all stats from HP >= 25% with " + data.skills[this.weaponIndex].name + ".<br>";
		}
		if(this.hasExactly("Fluttering Fan") && this.buddy.rorc > 0){
			var ffVal = Math.min(this.buddy.erorc * 3 + 5, 14);
			this.combatSpur.atk += ffVal;
			this.combatSpur.spd += ffVal;
			this.combatSpur.def += ffVal;
			this.combatSpur.res += ffVal;
			boostText += this.name + " gets +" + ffVal + " to all stats from having an ally within 3 rows/columns with Fluttering Fan.<br>";
		}
		if(this.hasExactly("Atk Spd Mastery") && enemy.combatStartHp / enemy.maxHp >= 0.5){
			var asmVal = 7;
			if(this.toggle.a == 1){
				asmVal += 4;
			}
			this.combatSpur.atk += asmVal;
			this.combatSpur.spd += asmVal;
			boostText += this.name + " gets +" + asmVal + " to atk & spd from enemy HP >= 50% with Atk Spd Mastery.<br>";
		}
		if(this.hasExactly("Exalt's Tactics") && this.combatStartHp / this.maxHp >= 0.25){
			var etVal = Math.min(this.buddy.rorc * 3 + 5, 14);
			enemy.combatSpur.atk -= etVal;
			enemy.combatSpur.spd -= etVal;
			enemy.combatSpur.res -= etVal;
			if(this.penalty.panic){
				this.combatBuffs = {"atk":0,"spd":0,"def":0,"res":0};
				this.buffs = {"atk":0,"spd":0,"def":0,"res":0};
			}
			this.combatDebuffs = {"atk":0,"spd":0,"def":0,"res":0};
			this.debuffs = {"atk":0,"spd":0,"def":0,"res":0};
			boostText += this.name + " inflicts -" + etVal + " atk/spd/res to " + enemy.name + " and neutralizes penalties from HP >= 25% with Exalt's Tactics.<br>";
		}
		if(this.hasExactly("According to Plan") && this.combatStartHp / this.maxHp >= 0.25){
			enemy.combatSpur.atk -= 5;
			enemy.combatSpur.spd -= 5;
			enemy.combatSpur.res -= 5;
			boostText += this.name + " inflicts -5 atk/spd/res to " + enemy.name + " from HP >= 25% with According to Plan.<br>";
		}
		if(this.hasExactly("New Levin Sword") && (enemy.combatStartHp / enemy.maxHp >= 0.75 || this.buddy.adjacent < 2)){
			var lsVal = 5 + Math.floor(allStats[17] * 0.15);
			this.combatSpur.atk += lsVal;
			this.combatSpur.spd += lsVal;
			this.combatSpur.def += lsVal;
			this.combatSpur.res += lsVal;
			boostText += this.name + " gets +" + lsVal + " to all stats from enemy HP >= 75% or having less than 2 adjacent allies with New Levin Sword.<br>";
		}
		if(this.hasExactly("Lone Wolf") && (this.combatStartHp / this.maxHp >= 0.25 || this.buddy.adjacent < 2)){
			enemy.combatSpur.atk -= 5;
			enemy.combatSpur.spd -= 5;
			enemy.combatSpur.def -= 5;
			enemy.combatSpur.res -= 5;
			boostText += this.name + " inflicts -5 all stats to " + enemy.name + " from HP >= 25% or having less than 2 adjacent allies with Lone Wolf.<br>";
		}
		if(this.hasExactly("The Inexhaustible") && (this.initiator || this.checkBonPen(1,enemy,currTurn))){
			var tiVal = 5 + Math.floor(allStats[17] * 0.15);
			this.combatSpur.atk += tiVal;
			this.combatSpur.spd += tiVal;
			this.combatSpur.def += tiVal;
			this.combatSpur.res += tiVal;
			boostText += this.name + " gets +" + tiVal + " to all stats from initiating or having a [Bonus] active with The Inexhaustible.<br>";
		}
		if(this.hasExactly("Majestic Glitnir") && (this.initiator || this.buddy.rorc > 0)){
			var mgVal = Math.min(this.buddy.rorc * 3 + 5, 14);
			this.combatSpur.def += mgVal;
			this.combatSpur.res += mgVal;
			enemy.combatSpur.def -= mgVal;
			enemy.combatSpur.res -= mgVal;
			boostText += this.name + " gets +" + mgVal + " to def & res and inflicts -" + mgVal + " def & res to " + enemy.name + " from initiating or having an ally within 3 rows/columns with Majestic Glitnir.<br>";
		}
		if(this.hasExactly("Berserker Axe") && (!this.initiator || enemy.combatStartHp / enemy.maxHp >= 0.75)){
			var baVal = Math.floor(allStats[20] * 0.25) - 4;
			baVal = Math.min(baVal,14);
			baVal = Math.max(baVal,5);
			this.combatSpur.atk += baVal;
			this.combatSpur.spd += baVal;
			this.combatSpur.def += baVal;
			this.combatSpur.res += baVal;
			boostText += this.name + " gets +" + baVal + " to all stats from enemy initiating or enemy HP >= 75% with Berserker Axe.<br>";
		}
		if(this.hasExactly("Dual Sword") && this.combatStartHp / this.maxHp >= 0.25){
			var dsVal = Math.min(this.buddy.erorc * 3 + 5, 14);
			this.combatSpur.atk += dsVal;
			this.combatSpur.spd += dsVal;
			this.combatSpur.def += dsVal;
			this.combatSpur.res += dsVal;
			var dsPen = this.toggle.weapon * 4 + 4;
			enemy.combatSpur.atk -= dsPen;
			enemy.combatSpur.spd -= dsPen;
			enemy.combatSpur.def -= dsPen;
			enemy.combatSpur.res -= dsPen;
			boostText += this.name + " gets +" + dsVal + " to all stats and inflicts -" + dsPen + " all stats to " + enemy.name + " from HP >= 25% with Dual Sword.<br>";
		}
		if(this.hasExactly("Grim Brokkr")){
			if(this.initiator || this.buddy.adjacent == 0 || (this.rValue > 0 && this.buddy.adjacent < 2)){
				var gbText = " inflicts -6 atk & res to " + enemy.name + " from not being adjacent to an ally";
				enemy.combatSpur.atk -= 6;
				enemy.combatSpur.res -= 6;
				if(this.rValue > 0){
					enemy.combatSpur.spd -= 5;
					gbText = " inflicts -6 atk/res & -5 spd to " + enemy.name + " from # of adjacent allies <= 1";
				}
				boostText += this.name + gbText + " with Grim Brokkr.<br>";
			}
			if(this.rValue == 5 && this.combatStartHp / this.maxHp >= 0.25){
				var gbVal = 6 + enemy.buddy.adjacent + enemy.buddy.two + enemy.buddy.three;
				enemy.combatSpur.atk -= gbVal;
				enemy.combatSpur.spd -= gbVal;
				enemy.combatSpur.res -= gbVal;
				boostText += this.name + " inflicts -" + gbVal + " atk/spd/res to " + enemy.name + " from HP >= 25% with Grim Brokkr.<br>";
			}
		}
		if(this.hasExactly("Ice-Tribe Axe") && (this.initiator || this.toggle.weapon == 1)){
			var itVal = Math.floor(allStats[17] * 0.15) + 5;
			this.combatSpur.atk += itVal;
			this.combatSpur.spd += itVal;
			this.combatSpur.def += itVal;
			this.combatSpur.res += itVal;
			boostText += this.name + " gets +" + itVal + " to all stats from initiating or having an ally with Null Dragon Bonus within 3 spaces with Ice-Tribe Axe.<br>";
		}
		if(this.hasExactly("Ilian Frost Blade") && (this.initiator || this.buddy.adjacent > 0 || this.buddy.two > 0)){
			var ifVal = Math.min(this.dragonflower * 2 + 5, 15);
			this.combatSpur.atk += ifVal;
			this.combatSpur.spd += ifVal;
			this.combatSpur.def += ifVal;
			this.combatSpur.res += ifVal;
			boostText += this.name + " gets +" + ifVal + " to all stats from initiating or being within 2 spaces of an ally with Ilian Frost Blade.<br>";
		}
		if((this.has("Ice Dagger") || this.has("Ice Dragonstone") || this.has("Giant Shuriken") || this.has("Snaking Bow")) && (this.initiator || this.buddy.adjacent > 0 || this.buddy.two > 0)){
			this.combatSpur.atk += 5;
			this.combatSpur.spd += 5;
			this.combatSpur.def += 5;
			this.combatSpur.res += 5;
			boostText += this.name + " gets +5 to all stats from initiating or being within 2 spaces of an ally with " + data.skills[this.weaponIndex].name + ".<br>";
		}
		if(this.hasExactly("Ice-Crystal Spear") && (!this.initiator || enemy.combatStartHp / enemy.maxHp >= 0.75)){
			var icVal = Math.min((this.buddy.adjacent + this.buddy.two + this.buddy.three) * 3 + 5, 14);
			this.combatSpur.atk += icVal;
			this.combatSpur.spd += icVal;
			this.combatSpur.def += icVal;
			this.combatSpur.res += icVal;
			if(this.penalty.panic){
				this.combatBuffs = {"atk":0,"spd":0,"def":0,"res":0};
				this.buffs = {"atk":0,"spd":0,"def":0,"res":0};
			}
			this.combatDebuffs = {"atk":0,"spd":0,"def":0,"res":0};
			this.debuffs = {"atk":0,"spd":0,"def":0,"res":0};
			boostText += this.name + " gets +" + icVal + " to all stats and neutralizes penalties from enemy initiating or enemy HP >= 75% with Ice-Crystal Spear.<br>";
		}
		if(this.hasExactly("Desert Spear") && this.buddy.adjacent + this.buddy.two + this.buddy.three > 0){
			var dsVal = Math.floor(allStats[18] * 0.15) + 5;
			this.combatSpur.atk += dsVal;
			this.combatSpur.spd += dsVal;
			this.combatSpur.def += dsVal;
			this.combatSpur.res += dsVal;
			boostText += this.name + " gets +" + dsVal + " to all stats from having an ally within 3 spaces with Desert Spear.<br>";
		}
		if(this.hasExactly("Sentinel Bow") && (this.initiator || enemy.range == "ranged")){
			var sbVal = Math.floor(allStats[17] * 0.15) + 5;
			this.combatSpur.atk += sbVal;
			this.combatSpur.spd += sbVal;
			this.combatSpur.def += sbVal;
			this.combatSpur.res += sbVal;
			boostText += this.name + " gets +" + sbVal + " to all stats from initiating or enemy range = 2 with Sentinel Bow.<br>";
		}
		if((this.hasExactly("Suave Blade") || this.hasExactly("Holy-War Spear")) && (this.initiator || this.buddy.adjacent > 0 || this.buddy.two > 0)){
			var sbVal = Math.min(this.buddy.erorc * 3 + 5, 14);
			this.combatSpur.atk += sbVal;
			this.combatSpur.spd += sbVal;
			this.combatSpur.def += sbVal;
			this.combatSpur.res += sbVal;
			boostText += this.name + " gets +" + sbVal + " to all stats from initiating or being within 2 spaces of an ally with " + data.skills[this.weaponIndex].name + ".<br>";
		}
		if(this.hasExactly("Dvergr Wayfinder") && this.combatStartHp / this.maxHp >= 0.25){
			var dwVal = Math.min(this.buddy.rorc * 3 + 5, 14);
			this.combatSpur.atk += dwVal;
			this.combatSpur.spd += dwVal;
			this.combatSpur.def += dwVal;
			this.combatSpur.res += dwVal;
			boostText += this.name + " gets +" + dwVal + " to all stats from HP >= 25% with Dvergr Wayfinder.<br>";
		}
		if(this.hasExactly("Praise-Piner Axe") && (!this.initiator || enemy.combatStartHp / enemy.maxHp >= 0.75)){
			var paVal = Math.floor(allStats[18] * 0.15) + 5;
			enemy.combatSpur.atk -= paVal;
			enemy.combatSpur.def -= paVal;
			enemy.combatSpur.res -= paVal;
			boostText += this.name + " inflicts -" + paVal + " atk/def/res to " + enemy.name + " from enemy initiating or enemy HP >= 75% with Praise-Piner Axe.<br>";
		}
		if(this.hasExactly("Petrify") && this.rValue > 0){
			if(this.initiator || this.buddy.adjacent < 2){
				this.combatSpur.atk += 5;
				this.combatSpur.spd += 5;
				this.combatSpur.def += 5;
				this.combatSpur.res += 5;
				boostText += this.name + " gets +5 to all stats from initiating or # of adjacent allies <= 1 with Petrify.<br>";
			}
			if(this.rValue == 5 && this.combatStartHp / this.maxHp >= 0.25){
				this.combatSpur.atk += 5;
				this.combatSpur.spd += 5;
				this.combatSpur.def += 5;
				this.combatSpur.res += 5;
				boostText += this.name + " gets +5 to all stats from HP >= 25% with Petrify.<br>";
			}
		}
		if(this.hasExactly("Crimson Lance")){
			if(this.combatStartHp / this.maxHp >= 0.25){
				this.combatSpur.atk += 5;
				this.combatSpur.spd += 5;
				this.combatSpur.def += 5;
				this.combatSpur.res += 5;
				boostText += this.name + " gets +5 to all stats from HP >= 25% with Crimson Lance.<br>";
			}
			if(this.rValue == 5){
				enemy.combatSpur.atk -= 4;
				enemy.combatSpur.spd -= 4;
				enemy.combatSpur.def -= 4;
				boostText += this.name + " inflicts -4 atk/spd/def to " + enemy.name + " with Crimson Lance.<br>";
				if(!this.initiator || enemy.combatStartHp / enemy.maxHp >= 0.75){
					this.combatSpur.atk += 5;
					this.combatSpur.spd += 5;
					this.combatSpur.def += 5;
					this.combatSpur.res += 5;
					boostText += this.name + " gets +5 to all stats from enemy initiating or enemy HP >= 75% with Crimson Lance.<br>";
				}
			}
		}
		if(this.hasExactly("Craver's Tome")){
			if(this.combatStartHp / this.maxHp >= 0.25){
				this.combatSpur.atk += 5;
				this.combatSpur.spd += 5;
				this.combatSpur.def += 5;
				this.combatSpur.res += 5;
				boostText += this.name + " gets +5 to all stats from HP >= 25% with Craver's Tome.<br>";
			}
			if(this.rValue == 5 && this.combatStartHp / this.maxHp >= 0.25){
				this.combatSpur.atk += 5;
				this.combatSpur.spd += 5;
				this.combatSpur.def += 5;
				this.combatSpur.res += 5;
				if(this.penalty.panic){
					this.combatBuffs.res = 0;
					this.buffs.res = 0;
				}
				this.combatDebuffs.res = 0;
				this.debuffs.res = 0;
				boostText += this.name + " gets +5 to all stats and neutralizes penalty to res from HP >= 25% with Craver's Tome.<br>";
			}
		}
		if(this.hasExactly("Caduceus Staff")){
			if(this.buddy.adjacent + this.buddy.two + this.buddy.three > 0){
				this.combatSpur.atk += 5;
				this.combatSpur.spd += 5;
				this.combatSpur.def += 5;
				this.combatSpur.res += 5;
				boostText += this.name + " gets +5 to all stats from being within 3 spaces of an ally with Caduceus Staff.<br>";
			}
			if(this.rValue == 5 && (this.initiator || this.buddy.adjacent > 0 || this.buddy.two > 0)){
				this.combatSpur.atk += 5;
				this.combatSpur.spd += 5;
				this.combatSpur.def += 5;
				this.combatSpur.res += 5;
				boostText += this.name + " gets +5 to all stats from initiating or being within 2 spaces of an ally with Caduceus Staff.<br>";
			}
		}
		if(this.hasExactly("Horn of Harvest") && (!this.initiator || enemy.combatStartHp / enemy.maxHp >= 0.75)){
			var hhVal = Math.min((this.buddy.adjacent + this.buddy.two + this.buddy.three) * 3 + 6, 15);
			enemy.combatSpur.atk -= hhVal;
			enemy.combatSpur.def -= hhVal;
			boostText += this.name + " inflicts -" + hhVal + " atk & def to " + enemy.name + " from enemy initiating or enemy HP >= 75% with Horn of Harvest.<br>";
		}
		if((this.hasExactly("Hungry Cat Fang") && this.combatStartHp / this.maxHp >= 0.25) || (this.hasExactly("Full Rabbit Fang") && (this.transform == true || this.toggle.weapon > 1))){
			var hcText = "HP >= 25%";
			if(this.hasExactly("Full Rabbit Fang")){
				hcText = "# of adjacent non-human allies <= 1 or is transformed";
			}
			var hcVal = Math.min(this.buddy.erorc * 3 + 5, 14);
			this.combatSpur.atk += hcVal;
			this.combatSpur.spd += hcVal;
			this.combatSpur.def += hcVal;
			this.combatSpur.res += hcVal;
			boostText += this.name + " gets +" + hcVal + " to all stats from " + hcText + " with " + data.skills[this.weaponIndex].name + ".<br>";
		}
		if(this.hasExactly("Stone of Delights") && this.buddy.adjacent + this.buddy.two + this.buddy.three > 0){
			var sdVal = Math.min((this.buddy.adjacent + this.buddy.two + this.buddy.three) * 3 + 5, 14);
			enemy.combatSpur.atk -= sdVal;
			enemy.combatSpur.def -= sdVal;
			enemy.combatSpur.res -= sdVal;
			boostText += this.name + " inflicts -" + sdVal + " atk/def/res to " + enemy.name + " from being within 3 spaces of an ally with Stone of Delights.<br>";
		}
		if(this.hasExactly("Opposing Stones") && (!this.initiator || enemy.combatStartHp / enemy.maxHp >= 0.75)){
			var osVal = Math.min((this.buddy.adjacent + this.buddy.two + this.buddy.three) * 3 + 5, 14);
			enemy.combatSpur.atk -= osVal;
			enemy.combatSpur.def -= osVal;
			enemy.combatSpur.res -= osVal;
			boostText += this.name + " inflicts -" + osVal + " atk/def/res to " + enemy.name + " from enemy initiating or enemy HP >= 75% with Opposing Stones.<br>";
		}
		if((this.hasExactly("Arcane Blutgang") || this.hasExactly("Arcane Truthfire")) && this.combatStartHp / this.maxHp >= 0.25){
			var abVal = Math.floor(allStats[20] * 0.25) - 4;
			abVal = Math.min(abVal, 14);
			abVal = Math.max(abVal, 5);
			this.combatSpur.atk += abVal;
			this.combatSpur.spd += abVal;
			this.combatSpur.def += abVal;
			this.combatSpur.res += abVal;
			boostText += this.name + " gets +" + abVal + " to all stats from HP >= 25% with " + data.skills[this.weaponIndex].name + ".<br>";
		}
		if(this.hasExactly("Just Bow") && (this.initiator || this.buddy.rorc > 0)){
			var jbVal = Math.floor(allStats[17] * 0.15) + 5;
			this.combatSpur.atk += jbVal;
			this.combatSpur.spd += jbVal;
			this.combatSpur.def += jbVal;
			this.combatSpur.res += jbVal;
			boostText += this.name + " gets +" + jbVal + " to all stats from initiating or having an ally within 3 rows/columns with Just Bow.<br>";
		}
		if(this.hasExactly("Vedrfolnir's Edge") && (this.initiator || this.buddy.rorc > 0)){
			var veVal = Math.min(this.buddy.rorc * 3 + 5, 14);
			this.combatSpur.atk += veVal;
			this.combatSpur.spd += veVal;
			this.combatSpur.def += veVal;
			this.combatSpur.res += veVal;
			if(this.penalty.panic){
				this.combatBuffs = {"atk":0,"spd":0,"def":0,"res":0};
				this.buffs = {"atk":0,"spd":0,"def":0,"res":0};
			}
			this.combatDebuffs = {"atk":0,"spd":0,"def":0,"res":0};
			this.debuffs = {"atk":0,"spd":0,"def":0,"res":0};
			boostText += this.name + " gets +" + veVal + " to all stats and neutralizes penalties from initiating or having an ally within 3 rows/columns with Vedrfolnir's Edge.<br>";
		}
		if(this.hasExactly("Quieting Claw") && this.combatStartHp / this.maxHp >= 0.25){
			this.combatSpur.atk += 5;
			this.combatSpur.spd += 5;
			this.combatSpur.def += 5;
			this.combatSpur.res += 5;
			var qcVal = this.toggle.weapon * 3 + 4;
			enemy.combatSpur.atk -= qcVal;
			enemy.combatSpur.spd -= qcVal;
			enemy.combatSpur.def -= qcVal;
			enemy.combatSpur.res -= qcVal;
			boostText += this.name + " gets +5 to all stats and inflicts -" + qcVal + " all stats to " + enemy.name + " from HP >= 25% with Quieting Claw.<br>";
		}
		if(this.hasExactly("Heavenly Icicle")){
			enemy.combatSpur.spd -= 5;
			enemy.combatSpur.def -= 5;
			boostText += this.name + " inflicts -5 spd & def to " + enemy.name + " with Heavenly Icicle.<br>";
			if(this.combatStartHp / this.maxHp >= 0.25){
				enemy.combatSpur.atk -= 5;
				boostText += this.name + " inflicts -5 atk to " + enemy.name + " from HP >= 25% with Heavenly Icicle.<br>";
			}
			if(this.rValue == 5 && (this.initiator || this.buddy.adjacent + this.buddy.two + this.buddy.three > 0)){
				enemy.combatSpur.atk -= 5;
				enemy.combatSpur.spd -= 5;
				enemy.combatSpur.def -= 5;
				boostText += this.name + " inflicts -5 atk/spd/def to " + enemy.name + " from initiating or being within 3 spaces of an ally with Heavenly Icicle.<br>";
			}
		}
		if(this.hasExactly("Scroll of Curses") && (this.initiator || enemy.combatStartHp / enemy.maxHp >= 0.75)){
			var scVal = Math.floor(allStats[17] * 0.2) + 6;
			this.combatSpur.atk += scVal;
			this.combatSpur.spd += scVal;
			boostText += this.name + " gets +" + scVal + " to atk & spd from initiating or enemy HP >= 75% with Scroll of Curses.<br>";
		}
		if(this.hasExactly("Scroll of Teas") && (this.initiator || this.buddy.adjacent + this.buddy.two + this.buddy.three > 0)){
			var stVal = Math.floor(allStats[17] * 0.15) + 5;
			this.combatSpur.atk += stVal;
			this.combatSpur.spd += stVal;
			this.combatSpur.def += stVal;
			this.combatSpur.res += stVal;
			boostText += this.name + " gets +" + stVal + " to all stats from initiating or being within 3 spaces of an ally with Scroll of Teas.<br>";
		}
		if(this.hasExactly("Bold Kusarigama") && (this.initiator || this.buddy.adjacent > 0 || this.buddy.two > 0)){
			var bkVal = Math.floor(allStats[18] * 0.15) + 5;
			this.combatSpur.atk += bkVal;
			this.combatSpur.spd += bkVal;
			this.combatSpur.def += bkVal;
			this.combatSpur.res += bkVal;
			boostText += this.name + " gets +" + bkVal + " to all stats from initiating or being within 2 spaces of an ally with Bold Kusarigama.<br>";
		}
		if(this.hasExactly("Ylisse Ninja Bow") && (this.initiator || this.buddy.adjacent > 0 || this.buddy.two > 0)){
			var ynVal = Math.floor(allStats[17] * 0.15) + 5;
			this.combatSpur.atk += ynVal;
			this.combatSpur.spd += ynVal;
			this.combatSpur.def += ynVal;
			this.combatSpur.res += ynVal;
			boostText += this.name + " gets +" + ynVal + " to all stats from initiating or being within 2 spaces of an ally with Ylisse Ninja Bow.<br>";
		}
		if(this.hasExactly("Light of Etruria") && !this.initiator){
			var leVal = Math.floor(allStats[19] * 0.2) + 6;
			enemy.combatSpur.atk -= leVal;
			enemy.combatSpur.spd -= leVal;
			boostText += this.name + " inflicts -" + leVal + " atk & spd to " + enemy.name + " from enemy initiating with Light of Etruria.<br>";
		}
		if((this.hasExactly("Arcane Giant Axe") || this.hasExactly("Arcane Fell Arts")) && (!this.initiator || this.combatStartHp / this.maxHp >= 0.25)){
			var abVal = Math.floor(allStats[20] * 0.25) - 4;
			abVal = Math.min(abVal, 14);
			abVal = Math.max(abVal, 5);
			this.combatSpur.atk += abVal;
			this.combatSpur.spd += abVal;
			this.combatSpur.def += abVal;
			this.combatSpur.res += abVal;
			boostText += this.name + " gets +" + abVal + " to all stats from enemy initiating or HP >= 25% with " + data.skills[this.weaponIndex].name + ".<br>";
		}
		if((this.hasExactly("Enticing Dose") || this.hasExactly("New Year Fang")) && (this.transform == true || this.combatStartHp / this.maxHp >= 0.25)){
			var edVal = Math.floor(allStats[18] * 0.2) + 6;
			enemy.combatSpur.atk -= edVal;
			enemy.combatSpur.def -= edVal;
			boostText += this.name + " inflicts -" + edVal + " atk & def to " + enemy.name + " from being transformed or HP >= 25% with " + data.skills[this.weaponIndex].name + ".<br>";
		}
		if(this.hasExactly("Divine Toxin") && (this.transform == true || !this.initiator)){
			this.combatSpur.atk += 10;
			this.combatSpur.def += 10;
			this.combatSpur.res += 10;
			boostText += this.name + " gets +10 to atk/def/res from being transformed or enemy initiating with Divine Toxin.<br>";
		}
		if(this.hasExactly("Quieting Branch") && this.combatStartHp / this.maxHp >= 0.25){
			var qbVal = Math.floor(allStats[19] * 0.2) + 6;
			enemy.combatSpur.atk -= qbVal;
			enemy.combatSpur.def -= qbVal;
			boostText += this.name + " inflicts -" + qbVal + " atk & def to " + enemy.name + " from HP >= 25% with Quieting Branch.<br>";
		}
		if(this.hasExactly("Thunderbrand")){
			if(enemy.combatStartHp / enemy.maxHp >= 0.5){
				var tbText = "atk & spd";
				this.combatSpur.atk += 5;
				this.combatSpur.spd += 5;
				if(this.rValue > 0){
					this.combatSpur.def += 5;
					this.combatSpur.res += 5;
					tbText = "all stats";
				}
				boostText += this.name + " gets +5 to " + tbText + " from enemy >= 50% HP with Thunderbrand.<br>";
			}
			if(this.rValue == 5 && (this.initiator || this.buddy.adjacent > 0 || this.buddy.two > 0)){
				this.combatSpur.atk += 5;
				this.combatSpur.spd += 5;
				this.combatSpur.def += 5;
				this.combatSpur.res += 5;
				if(this.penalty.panic){
					this.combatBuffs.atk = 0;
					this.combatBuffs.spd = 0;
					this.buffs.atk = 0;
					this.buffs.spd = 0;
				}
				this.combatDebuffs.atk = 0;
				this.combatDebuffs.spd = 0;
				this.debuffs.atk = 0;
				this.debuffs.spd = 0;
				boostText += this.name + " gets +5 to all stats and neutralizes penalties to atk & spd from initiating or being within 2 spaces of an ally with Thunderbrand.<br>";
			}
		}
		if(this.hasExactly("Banshee TH") && this.rValue > 0){
			if(!this.initiator || enemy.combatStartHp / enemy.maxHp >= 0.75){
				var btVal = Object.values(enemy.penalty).reduce((a, item) => a + (item === true ? 1 : 0), 0) + enemy.penalty.extra + 6;
				enemy.combatSpur.atk -= btVal;
				enemy.combatSpur.res -= btVal;
				boostText += this.name + " inflicts -" + btVal + " atk & res to " + enemy.name + " from enemy initiating or enemy HP >= 75% with Banshee TH.<br>";
			}
			if(this.rValue == 5 && this.combatStartHp / this.maxHp >= 0.25){
				enemy.combatSpur.atk -= 6;
				enemy.combatSpur.res -= 6;
				boostText += this.name + " inflicts -6 atk & res to " + enemy.name + " from HP >= 25% with Banshee TH.<br>";
			}
		}
		if(this.hasExactly("Moonless Breath") && this.rValue > 0){
			if(this.buddy.adjacent + this.buddy.two + this.buddy.three > 0){
				enemy.combatSpur.atk -= 5;
				enemy.combatSpur.def -= 5;
				enemy.combatSpur.res -= 5;
				boostText += this.name + " inflicts -5 atk/def/res to " + enemy.name + " from being within 3 spaces of an ally with Moonless Breath.<br>";
			}
			if(this.rValue == 5 && this.combatStartHp / this.maxHp >= 0.25){
				var mbVal = Math.floor(allStats[19] * 0.1) + 5;
				enemy.combatSpur.atk -= mbVal;
				enemy.combatSpur.def -= mbVal;
				enemy.combatSpur.res -= mbVal;
				boostText += this.name + " inflicts -" + mbVal + " atk/def/res to " + enemy.name + " from HP >= 25% with Moonless Breath.<br>";
			}
		}
		if(this.hasExactly("Convoy Dagger")){
			if(this.buddy.adjacent + this.buddy.two + this.buddy.three > 0){
				enemy.combatSpur.atk -= 6;
				enemy.combatSpur.spd -= 6;
				boostText += this.name + " inflicts -6 atk & spd to " + enemy.name + " from being within 3 spaces of an ally with Convoy Dagger.<br>";
			}
			if(this.rValue == 5 && (!this.initiator || enemy.combatStartHp / enemy.maxHp >= 0.75)){
				enemy.combatSpur.atk -= 6;
				enemy.combatSpur.spd -= 6;
				boostText += this.name + " inflicts -6 atk & spd to " + enemy.name + " from enemy initiating or enemy HP >= 75% with Convoy Dagger.<br>";
			}
		}
		if(this.hasExactly("Fellowship Blade") && this.buddy.adjacent + this.buddy.two + this.buddy.three > 0){
			var fbVal = Math.floor(allStats[18] * 0.2) + 6;
			enemy.combatSpur.atk -= fbVal;
			enemy.combatSpur.def -= fbVal;
			boostText += this.name + " inflicts -" + fbVal + " atk & def to " + enemy.name + " from being within 3 spaces of an ally with Fellowship Blade.<br>";
		}
		if(this.hasExactly("Oath of Ostia") && (!this.initiator || enemy.combatStartHp / enemy.maxHp >= 0.75)){
			enemy.combatSpur.atk -= 10;
			enemy.combatSpur.def -= 10;
			boostText += this.name + " inflicts -10 atk & def to " + enemy.name + " from enemy initiating or enemy HP >= 75% with Oath of Ostia.<br>";
		}
		if(this.hasExactly("Odr of Creation") && (this.initiator || this.buddy.adjacent > 0 || this.buddy.two > 0)){
			var ocVal = Math.min(this.buddy.rorc * 3 + 5, 14);
			this.combatSpur.atk += ocVal;
			this.combatSpur.spd += ocVal;
			this.combatSpur.def += ocVal;
			this.combatSpur.res += ocVal;
			if(this.penalty.panic){
				this.combatBuffs = {"atk":0,"spd":0,"def":0,"res":0};
				this.buffs = {"atk":0,"spd":0,"def":0,"res":0};
			}
			this.combatDebuffs = {"atk":0,"spd":0,"def":0,"res":0};
			this.debuffs = {"atk":0,"spd":0,"def":0,"res":0};
			boostText += this.name + " gets +" + ocVal + " to all stats and neutralizes penalties from initiating or being within 2 spaces of an ally with Odr of Creation.<br>";
		}
		if((this.hasExactly("Spear") || this.hasExactly("Red-Fist Blades") || this.hasExactly("Rampart Bow")) && this.combatStartHp / this.maxHp >= 0.25){
			var dwVal = Math.min(this.buddy.erorc * 3 + 5, 14);
			var dwText = "";
			this.combatSpur.atk += dwVal;
			this.combatSpur.spd += dwVal;
			this.combatSpur.def += dwVal;
			this.combatSpur.res += dwVal;
			if(this.hasExactly("Rampart Bow")){
				if(this.penalty.panic){
					this.combatBuffs = {"atk":0,"spd":0,"def":0,"res":0};
					this.buffs = {"atk":0,"spd":0,"def":0,"res":0};
				}
				this.combatDebuffs = {"atk":0,"spd":0,"def":0,"res":0};
				this.debuffs = {"atk":0,"spd":0,"def":0,"res":0};
				dwText = " and neutralizes penalties"
			}
			boostText += this.name + " gets +" + dwVal + " to all stats " + dwText + " from HP >= 25% with " + data.skills[this.weaponIndex].name + ".<br>";
		}
		if(this.hasExactly("Icy Ravager") && (!this.initiator || enemy.combatStartHp / enemy.maxHp >= 0.75)){
			var irVal = Math.floor(allStats[18] * 0.2) + 6;
			enemy.combatSpur.atk -= irVal;
			enemy.combatSpur.def -= irVal;
			boostText += this.name + " inflicts -" + irVal + " atk & def to " + enemy.name + " from enemy initiating or enemy HP >= 75% with Icy Ravager.<br>";
		}
		if(this.hasExactly("Leaden Regrets") && (!this.initiator || this.transform == true)){
			enemy.combatSpur.atk -= 10;
			enemy.combatSpur.def -= 10;
			boostText += this.name + " inflicts -10 atk & def to " + enemy.name + " from enemy initiating or being transformed with Leaden Regrets.<br>";
		}
		if((this.hasExactly("Snowman Staff") || this.hasExactly("Lady's Bow")) && this.buddy.adjacent + this.buddy.two + this.buddy.three > 0){
			var ssVal = Math.floor(allStats[17] * 0.2) + 6;
			this.combatSpur.atk += ssVal;
			this.combatSpur.spd += ssVal;
			boostText += this.name + " gets +" + ssVal + " to atk & spd from being within 3 spaces of an ally with " + data.skills[this.weaponIndex].name + ".<br>";
		}
		if((this.hasExactly("Snaking Sword") || this.hasExactly("True-Bond Bow") || this.hasExactly("Azure Twin Edge")) && (this.initiator || this.buddy.adjacent > 0 || this.buddy.two > 0)){
			var ssVal = Math.min(this.buddy.rorc * 3 + 5, 14);
			this.combatSpur.atk += ssVal;
			this.combatSpur.spd += ssVal;
			this.combatSpur.def += ssVal;
			this.combatSpur.res += ssVal;
			boostText += this.name + " gets +" + ssVal + " to all stats from initiating or being within 2 spaces of an ally with " + data.skills[this.weaponIndex].name + ".<br>";
		}
		if(this.hasExactly("New Year Talon") && (this.transform == true || enemy.combatStartHp / enemy.maxHp >= 0.75)){
			var ntVal = Math.floor(allStats[17] * 0.15) + 5;
			this.combatSpur.atk += ntVal;
			this.combatSpur.spd += ntVal;
			this.combatSpur.def += ntVal;
			this.combatSpur.res += ntVal;
			boostText += this.name + " gets +" + ntVal + " to all stats from being transformed or enemy HP >= 75% with New Year Talon.<br>";
		}
		if(this.hasExactly("New Year Treats") && this.combatStartHp / this.maxHp >= 0.25){
			var ntVal = Math.floor(allStats[19] * 0.2) + 5;
			this.combatSpur.atk += ntVal;
			this.combatSpur.def += ntVal;
			this.combatSpur.res += ntVal;
			boostText += this.name + " gets +" + ntVal + " to atk/def/res from HP >= 25% with New Year Treats.<br>";
		}
		if(this.hasExactly("Fimbulvetr Morn") && this.combatStartHp / this.maxHp >= 0.25){
			enemy.combatSpur.atk -= 6;
			enemy.combatSpur.res -= 6;
			boostText += this.name + " inflicts -6 atk & res to " + enemy.name + " from HP >= 25% with Fimbulvetr Morn.<br>";
			if(this.rValue == 5){
				enemy.combatSpur.atk -= 6;
				enemy.combatSpur.res -= 6;
				boostText += this.name + " inflicts -6 atk & res to " + enemy.name + " from HP >= 25% with Fimbulvetr Morn.<br>";
			}
		}
		if(this.hasExactly("Goddess Axe") && this.rValue == 5 && (this.initiator || this.buddy.adjacent > 0 || this.buddy.two > 0)){
			this.combatSpur.atk += 6;
			this.combatSpur.def += 6;
			boostText += this.name + " gets +6 to atk & def from initiating or being within 2 spaces of an ally with Goddess Axe.<br>";
		}
		if(this.hasExactly("Joker's Wild") && this.rValue > 0 && this.buddy.adjacent + this.buddy.two + this.buddy.three > 0){
			this.combatSpur.atk += 5;
			this.combatSpur.spd += 5;
			this.combatSpur.def += 5;
			this.combatSpur.res += 5;
			boostText += this.name + " gets +5 to all stats from being within 3 spaces of an ally with Joker's Wild.<br>";
			if(this.rValue == 5){
				this.combatSpur.atk += 5;
				this.combatSpur.spd += 5;
				this.combatSpur.def += 5;
				this.combatSpur.res += 5;
				boostText += this.name + " gets +5 to all stats from being within 3 spaces of an ally with Joker's Wild.<br>";
			}
		}
		if(this.hasExactly("Staff of Yngvi") && this.buddy.adjacent + this.buddy.two + this.buddy.three > 0){
			var syVal = Math.floor(allStats[19] * 0.2) + 6;
			this.combatSpur.atk += syVal;
			this.combatSpur.res += syVal;
			boostText += this.name + " gets +" + syVal + " to atk & res from being within 3 spaces of an ally with " + data.skills[this.weaponIndex].name + ".<br>";
		}
		if((this.hasExactly("Divine Yewfelle") || this.hasExactly("Salvage")) && (this.initiator || this.buddy.adjacent > 0 || this.buddy.two > 0)){
			var dyVal = Math.floor(allStats[17] * 0.2) + 6;
			this.combatSpur.atk += dyVal;
			this.combatSpur.spd += dyVal;
			boostText += this.name + " gets +" + dyVal + " to atk & spd from initiating or being within 2 spaces of an ally with " + data.skills[this.weaponIndex].name + ".<br>";
		}
		if(this.hasExactly("Swirling Lance") && this.buddy.adjacent + this.buddy.two + this.buddy.three > 0){
			var slVal = Math.min((this.buddy.adjacent + this.buddy.two + this.buddy.three) * 3 + 5, 14);
			this.combatSpur.atk += slVal;
			this.combatSpur.spd += slVal;
			this.combatSpur.def += slVal;
			this.combatSpur.res += slVal;
			boostText += this.name + " gets +" + slVal + " to all stats from being within 3 spaces of an ally with Swirling Lance.<br>";
		}
		if(this.hasExactly("Swirling Scimitar") && this.buddy.adjacent + this.buddy.two + this.buddy.three > 0){
			var ssVal = 10;
			if(this.dragonflower > 0){
				ssVal += 4;
			}
			this.combatSpur.atk += ssVal;
			this.combatSpur.spd += ssVal;
			this.combatSpur.def += ssVal;
			this.combatSpur.res += ssVal;
			boostText += this.name + " gets +" + ssVal + " to all stats from being within 3 spaces of an ally with Swirling Scimitar.<br>";
		}
		if((this.has("Jehanna Dagger") || this.has("Jehanna Lance")) && this.buddy.adjacent + this.buddy.two + this.buddy.three > 0){
			this.combatSpur.atk += 5;
			this.combatSpur.spd += 5;
			this.combatSpur.def += 5;
			this.combatSpur.res += 5;
			boostText += this.name + " gets +5 to all stats from being within 3 spaces of an ally with " + data.skills[this.weaponIndex].name + ".<br>";
		}
		if(this.hasExactly("Laconic Axe") && (this.initiator || this.buddy.rorc > 0)){
			var laVal = Math.min(this.buddy.rorc * 3 + 5, 14);
			this.combatSpur.atk += laVal;
			this.combatSpur.spd += laVal;
			this.combatSpur.def += laVal;
			this.combatSpur.res += laVal;
			boostText += this.name + " gets +" + laVal + " to all stats from initiating or having an ally within 3 rows/columns with Laconic Axe.<br>";
		}
		if(this.hasExactly("Sword of Isaach") && this.combatStartHp / this.maxHp >= 0.25){
			var siVal = Math.floor(allStats[17] * 0.15) + 5;
			this.combatSpur.atk += siVal;
			this.combatSpur.spd += siVal;
			this.combatSpur.def += siVal;
			this.combatSpur.res += siVal;
			boostText += this.name + " gets +" + siVal + " to all stats from HP >= 25% with Sword of Isaach.<br>";
		}
		if(this.hasExactly("Blessed Aureola") && this.buddy.rorc > 0){
			var baVal = Math.floor(allStats[19] * 0.2) + 5;
			var baText = "";
			this.combatSpur.atk += baVal;
			this.combatSpur.def += baVal;
			this.combatSpur.res += baVal;
			if(enemy.weaponType == "redtome" || enemy.weaponType == "bluetome" || enemy.weaponType == "greentome" || enemy.weaponType == "graytome"){
				this.combatSpur.atk += 10;
				baText = " and an additional +10 to atk";
			}
			boostText += this.name + " gets +" + baVal + " to atk/def/res" + baText + " from having an ally within 3 rows/columns with Blessed Aureola.<br>";
		}
		if(this.hasExactly("Beyond Reason") && (!this.initiator || enemy.combatStartHp / enemy.maxHp >= 0.75)){
			var brVal = Math.min((Object.values(enemy.penalty).reduce((a, item) => a + (item === true ? 1 : 0), 0) + enemy.penalty.extra) * 2, 12);
			var dAtk = Math.min(this.combatDebuffs.atk,this.debuffs.atk) * -2 + brVal;
			var dDef = Math.min(this.combatDebuffs.def,this.debuffs.def) * -2 + brVal;
			var dRes = Math.min(this.combatDebuffs.res,this.debuffs.res) * -2 + brVal;
			if(this.penalty.panic){
				dAtk += Math.max(this.combatBuffs.atk,this.buffs.atk) * 2;
				dDef += Math.max(this.combatBuffs.def,this.buffs.def) * 2;
				dRes += Math.max(this.combatBuffs.res,this.buffs.res) * 2;
			}
			this.combatSpur.atk += dAtk;
			this.combatSpur.def += dDef;
			this.combatSpur.res += dRes;
			boostText += this.name + " gains +" + dAtk + " atk/+" + dDef + " def/+" + dRes + " res from enemy initiating or enemy HP >= 75% with Beyond Reason.<br>";
		}
		if(this.hasExactly("Aerial Longsword")){
			if(this.initiator || this.buddy.adjacent > 0 || this.buddy.two > 0){
				var alVal = Math.floor(allStats[17] * 0.1) + 5;
				this.combatSpur.atk += alVal;
				this.combatSpur.spd += alVal;
				this.combatSpur.def += alVal;
				this.combatSpur.res += alVal;
				boostText += this.name + " gets +" + alVal + " to all stats from initiating or being within 2 spaces of an ally with Aerial Longsword.<br>";
			}
			if(this.rValue == 5 && this.combatStartHp / this.maxHp >= 0.25){
				this.combatSpur.atk += 5;
				this.combatSpur.spd += 5;
				this.combatSpur.def += 5;
				this.combatSpur.res += 5;
				boostText += this.name + " gets +5 to all stats from HP >= 25% with Aerial Longsword.<br>";
			}
		}
		if(this.hasExactly("Dark Monograph")){
			if(!this.initiator || enemy.combatStartHp / enemy.maxHp >= 0.75){
				enemy.combatSpur.atk -= 5;
				enemy.combatSpur.spd -= 5;
				enemy.combatSpur.res -= 5;
				boostText += this.name + " inflicts -5 atk/spd/res to " + enemy.name + " from enemy initiating or enemy HP >= 75% with Dark Monograph.<br>";
			}
			if(this.rValue == 5 && this.combatStartHp / this.maxHp >= 0.25){
				enemy.combatSpur.atk -= 5;
				enemy.combatSpur.spd -= 5;
				enemy.combatSpur.res -= 5;
				if(this.penalty.panic){
					this.combatBuffs.atk = 0;
					this.combatBuffs.spd = 0;
					this.combatBuffs.res = 0;
					this.buffs.atk = 0;
					this.buffs.spd = 0;
					this.buffs.res= 0;
				}
				this.combatDebuffs.atk = 0;
				this.combatDebuffs.spd = 0;
				this.combatDebuffs.res = 0;
				this.debuffs.atk = 0;
				this.debuffs.spd = 0;
				this.debuffs.res = 0;
				boostText += this.name + " inflicts -5 atk/spd/res to " + enemy.name + " and neutralizes penalties to atk/spd/res from HP >= 25% with Dark Monograph.<br>";
			}
		}
		if(this.hasExactly("Eagle's Heart") && (this.initiator || this.buddy.adjacent < 2)){
			var ehVal = Math.floor(allStats[18] * 0.2) + 6;
			enemy.combatSpur.atk -= ehVal;
			enemy.combatSpur.def -= ehVal;
			boostText += this.name + " inflicts -" + ehVal + " atk & def to " + enemy.name + " from initiating or # of adjacent allies <= 1 with Eagle's Heart.<br>";
		}
		if(this.hasExactly("Pure Storm") && (this.initiator || this.buddy.adjacent < 2)){
			enemy.combatSpur.atk -= 5;
			enemy.combatSpur.def -= 5;
			boostText += this.name + " inflicts -5 atk & def to " + enemy.name + " from initiating or # of adjacent allies <= 1 with Pure Storm.<br>";
		}
		if((this.hasExactly("Lion's Heart") || this.hasExactly("Deer's Heart")) && (this.initiator || this.buddy.adjacent > 0 || this.buddy.two > 0)){
			var lhVal = Math.floor(allStats[17] * 0.15) + 5;
			this.combatSpur.atk += lhVal;
			this.combatSpur.spd += lhVal;
			this.combatSpur.def += lhVal;
			this.combatSpur.res += lhVal;
			boostText += this.name + " gets +" + lhVal + " to all stats from initiating or being within 2 spaces of an ally with " + data.skills[this.weaponIndex].name + ".<br>";
		}
		if(this.hasExactly("Pure Atrocity") && (this.initiator || this.buddy.adjacent > 0 || this.buddy.two > 0)){
			enemy.combatSpur.spd -= 5;
			enemy.combatSpur.def -= 5;
			boostText += this.name + " inflicts -5 spd & def to " + enemy.name + " from initiating or being within 2 spaces of an ally with Pure Atrocity.<br>";
		}
		if(this.hasExactly("Pure Starfall") && (this.initiator || this.bonus.dStar == true)){
			enemy.combatSpur.spd -= 5;
			enemy.combatSpur.def -= 5;
			boostText += this.name + " inflicts -5 spd & def to " + enemy.name + " from initiating or having [Deep Star] active with Pure Starfall.<br>";
		}
		if(this.hasExactly("Devoted Breath") && (!this.initiator || enemy.combatStartHp / enemy.maxHp >= 0.75)){
			var dbVal = Math.floor(allStats[19] * 0.2) + 5;
			this.combatSpur.atk += dbVal;
			this.combatSpur.def += dbVal;
			this.combatSpur.res += dbVal;
			boostText += this.name + " gets +" + dbVal + " to atk/def/res from enemy initiating or enemy HP >= 75% with Devoted Breath.<br>";
		}
		if((this.has("Devoted Cup") || this.has("Hexblade Sword")) && (this.initiator || this.buddy.adjacent > 0 || this.buddy.two > 0)){
			this.combatSpur.atk += 5;
			this.combatSpur.spd += 5;
			this.combatSpur.def += 5;
			this.combatSpur.res += 5;
			boostText += this.name + " gets +5 to all stats from initiating or being within 2 spaces of an ally with " + data.skills[this.weaponIndex].name + ".<br>";
		}
		if(this.hasExactly("Protective")){
			enemy.combatSpur.atk -= 5;
			enemy.combatSpur.spd -= 5;
			enemy.combatSpur.def -= 5;
			enemy.combatSpur.res -= 5;
			boostText += this.name + " inflicts -5 all stats to " + enemy.name + " with Protective.<br>";
			if(this.combatStartHp / this.maxHp >= 0.25){
				this.combatSpur.atk += 9;
				this.combatSpur.spd += 9;
				this.combatSpur.def += 9;
				this.combatSpur.res += 9;
				boostText += this.name + " gets +9 to all stats from HP >= 25% with Protective.<br>";
			}
		}
		if(this.hasExactly("Fell Slaystone") && (!this.initiator || enemy.combatStartHp / enemy.maxHp >= 0.75)){
			var fsVal = Math.min((this.buddy.adjacent + this.buddy.two + this.buddy.three) * 3 + 5, 14);
			this.combatSpur.atk += fsVal;
			this.combatSpur.spd += fsVal;
			this.combatSpur.def += fsVal;
			this.combatSpur.res += fsVal;
			boostText += this.name + " gets +" + fsVal + " to all stats from enemy initiating or enemy HP >= 75% with Fell Slaystone.<br>";
		}
		if(this.hasExactly("Hidden Blade") && this.combatStartHp / this.maxHp >= 0.25){
			var hbVal = Math.floor(allStats[17] * 0.2) + 6;
			this.combatSpur.atk += hbVal;
			this.combatSpur.spd += hbVal;
			boostText += this.name + " gets +" + hbVal + " to atk & spd from HP >= 25% with Hidden Blade.<br>";
		}
		if(this.hasExactly("Trained to Kill") && (this.initiator || this.buddy.adjacent > 0 || this.buddy.two > 0)){
			this.combatSpur.atk += 10;
			this.combatSpur.spd += 10;
			boostText += this.name + " gets +10 to atk & spd from initiating or being within 2 spaces of an ally with Trained to Kill.<br>";
		}
		if(this.hasExactly("Nova") && (Object.values(this.bonus).reduce((a, item) => a + (item === true ? 1 : 0), 0) + this.bonus.extra || Object.values(enemy.bonus).reduce((a, item) => a + (item === true ? 1 : 0), 0) + enemy.bonus.extra || Object.values(this.penalty).reduce((a, item) => a + (item === true ? 1 : 0), 0) + this.penalty.extra || Object.values(enemy.penalty).reduce((a, item) => a + (item === true ? 1 : 0), 0) + enemy.penalty.extra)){
			var nvVal = Math.floor(allStats[19] * 0.2) + 6;
			this.combatSpur.atk += nvVal;
			this.combatSpur.res += nvVal;
			boostText += this.name + " gets +" + nvVal + " to atk & res from unit or enemy having [Bonus] or [Penalty] with Nova.<br>";
		}
		if(this.hasExactly("Quiet Strength") && (this.initiator || this.buddy.adjacent > 0 || this.buddy.two > 0)){
			this.combatSpur.atk += 5;
			this.combatSpur.spd += 5;
			if(this.penalty.panic){
				this.combatBuffs.atk = 0;
				this.combatBuffs.spd = 0;
				this.buffs.atk = 0;
				this.buffs.spd = 0;
			}
			this.combatDebuffs.atk = 0;
			this.combatDebuffs.spd = 0;
			this.debuffs.atk = 0;
			this.debuffs.spd = 0;
			boostText += this.name + " gets +5 to atk & spd and neutralizes penalties to atk & spd from initiating or being within 2 spaces of an ally with Quiet Strength.<br>";
		}
		if(this.hasExactly("Staff of the Saint") && this.rValue > 0){
			if(this.buddy.adjacent + this.buddy.two + this.buddy.three > 0){
				this.combatSpur.atk += 5;
				this.combatSpur.spd += 5;
				this.combatSpur.def += 5;
				this.combatSpur.res += 5;
				boostText += this.name + " gets +5 to all stats from being within 3 spaces of an ally with Staff of the Saint.<br>";
			}
			if(this.rValue == 5 && (!this.initiator || enemy.combatStartHp / enemy.maxHp >= 0.75)){
				var ssVal = Math.min((this.buddy.adjacent + this.buddy.two + this.buddy.three) * 2 + 5, 11);
				this.combatSpur.atk += ssVal;
				this.combatSpur.spd += ssVal;
				this.combatSpur.def += ssVal;
				this.combatSpur.res += ssVal;
				if(this.penalty.panic){
					this.combatBuffs = {"atk":0,"spd":0,"def":0,"res":0};
					this.buffs = {"atk":0,"spd":0,"def":0,"res":0};
				}
				this.combatDebuffs = {"atk":0,"spd":0,"def":0,"res":0};
				this.debuffs = {"atk":0,"spd":0,"def":0,"res":0};
				boostText += this.name + " gets +" + ssVal + " to all stats and neutralizes penalties from enemy initiating or enemy HP >= 75% with Staff of the Saint.<br>";
			}
		}
		if(this.hasExactly("Twin Star Axe") && this.rValue == 5 && this.buddy.adjacent + this.buddy.two + this.buddy.three > 0){
			this.combatSpur.atk += 6;
			enemy.combatSpur.atk -= 6;
			boostText += this.name + " gets +6 to atk and inflicts -6 atk to " + enemy.name + " from being within 3 spaces of an ally with Twin Star Axe.<br>";
		}
		if(this.hasExactly("Kia Staff") && this.rValue > 0){
			if(this.buddy.adjacent + this.buddy.two + this.buddy.three > 0){
				this.combatSpur.atk += 5;
				this.combatSpur.spd += 5;
				this.combatSpur.def += 5;
				this.combatSpur.res += 5;
				boostText += this.name + " gets +5 to all stats from being within 3 spaces of an ally with Kia Staff.<br>";
			}
			if(this.rValue == 5 && this.combatStartHp / this.maxHp >= 0.25){
				this.combatSpur.atk += 5;
				this.combatSpur.spd += 5;
				this.combatSpur.def += 5;
				this.combatSpur.res += 5;
				boostText += this.name + " gets +5 to all stats from HP >= 25% with Kia Staff.<br>";
			}
		}
		if(this.hasExactly("Gentle Fell Egg") && (this.initiator || this.buddy.adjacent > 0 || this.buddy.two > 0)){
			var geVal = Math.floor(allStats[19] * 0.2);
			this.combatSpur.atk += geVal;
			this.combatSpur.res += geVal;
			boostText += this.name + " gets +" + geVal + " to atk & res from initiating or being within 2 spaces of an ally with Gentle Fell Egg.<br>";
		}
		if(this.hasExactly("Petaldream Horn")){
			var dAtk = 0;
			var dSpd = 0;
			var dDef = 0;
			var dRes = 0;
			if(!allStats[15][0]){
				dAtk = Math.max(enemy.combatBuffs.atk,enemy.buffs.atk);
			}
			if(!allStats[15][1]){
				dSpd = Math.max(enemy.combatBuffs.spd,enemy.buffs.spd);
			}
			if(!allStats[15][2]){
				dDef = Math.max(enemy.combatBuffs.def,enemy.buffs.def);
			}
			if(!allStats[15][3]){
				dRes = Math.max(enemy.combatBuffs.res,enemy.buffs.res);
			}
			if(enemy.penalty.panic){
				dAtk = 0;
				dSpd = 0;
				dDef = 0;
				dRes = 0;
			}
			var fAtk = dAtk + 5;
			var fSpd = dSpd + 5;
			var fDef = dDef + 5;
			var fRes = dRes + 5;
			enemy.combatSpur.atk -= fAtk;
			enemy.combatSpur.spd -= fSpd;
			enemy.combatSpur.def -= fDef;
			enemy.combatSpur.res -= fRes;
			this.combatSpur.atk += dAtk;
			this.combatSpur.spd += dSpd;
			this.combatSpur.def += dDef;
			this.combatSpur.res += dRes;
			boostText += this.name + " inflicts -" + fAtk + "/-" + fSpd + "/-" + fDef + "/-" + fRes + " to " + enemy.name + " and gets " + dAtk + "/" + dSpd + "/" + dDef + "/" + dRes + " with Petaldream Horn.<br>";
			if(this.combatStartHp / this.maxHp >= 0.25){
				var phVal = Math.min(this.buddy.erorc * 3 + 3, 9);
				this.combatSpur.atk += phVal;
				this.combatSpur.spd += phVal;
				this.combatSpur.def += phVal;
				this.combatSpur.res += phVal;
				boostText += this.name + " gets +" + phVal + " to all stats from HP >= 25% with Petaldream Horn.<br>";
			}
		}
		if(this.hasExactly("Nihility's Undoing") && (this.transform == true || enemy.combatStartHp / enemy.maxHp >= 0.75)){
			var nuVal = Math.min(this.buddy.spaces + 8, 11);
			this.combatSpur.atk += nuVal;
			this.combatSpur.spd += nuVal;
			this.combatSpur.def += nuVal;
			this.combatSpur.res += nuVal;
			boostText += this.name + " gets +" + nuVal + " to all stats from being transformed or enemy HP >= 75% with Nihility's Undoing.<br>";
		}
		if(this.has("Spring-Air Egg") || this.has("Spring-Air Axe")){
			enemy.combatSpur.atk -= 5;
			enemy.combatSpur.spd -= 5;
			enemy.combatSpur.def -= 5;
			enemy.combatSpur.res -= 5;
			boostText += this.name + " inflicts -5 all stats to " + enemy.name + " with " + data.skills[this.weaponIndex].name + ".<br>";
		}
		if(this.hasExactly("Springing Spear") && this.buddy.rorc > 0){
			var ssVal = Math.floor(allStats[19] * 0.2) + 6;
			enemy.combatSpur.atk -= ssVal;
			enemy.combatSpur.def -= ssVal;
			boostText += this.name + " inflicts -" + ssVal + " atk & def to " + enemy.name + " from having an ally within 3 rows/columns with Springing Spear.<br>";
		}
		if(this.hasExactly("Prior's Tome") && this.buddy.adjacent + this.buddy.two + this.buddy.three > 0){
			var syVal = Math.floor(allStats[19] * 0.2) + 6;
			this.combatSpur.atk += syVal;
			this.combatSpur.res += syVal;
			if(this.penalty.panic){
				this.combatBuffs.atk = 0;
				this.combatBuffs.res = 0;
				this.buffs.atk = 0;
				this.buffs.res = 0;
			}
			this.combatDebuffs.atk = 0;
			this.combatDebuffs.res = 0;
			this.debuffs.atk = 0;
			this.debuffs.res = 0;
			boostText += this.name + " gets +" + syVal + " to atk & res and neutralizes penalties to atk & res from being within 3 spaces of an ally with Prior's Tome.<br>";
		}
		if(this.hasExactly("Tailwind Shuriken") && this.rValue > 0){
			if(this.combatStartHp / this.maxHp >= 0.25 && this.buddy.rorc > 0){
				var tsVal = Math.min(this.buddy.rorc * 2, 6);
				this.combatSpur.atk += tsVal;
				this.combatSpur.spd += tsVal;
				boostText += this.name + " gets +" + tsVal + " to atk & spd from HP >= 25% with Tailwind Shuriken.<br>";
			}
			if(this.rValue == 5){
				enemy.combatSpur.spd -= 5;
				enemy.combatSpur.def -= 5;
				boostText += this.name + " inflicts -5 spd & def to " + enemy.name + " with Tailwind Shuriken.<br>";
			}
		}
		if(this.hasExactly("Tome of Fury")){
			if(this.combatStartHp / this.maxHp >= 0.25){
				this.combatSpur.atk += 5;
				this.combatSpur.spd += 5;
				this.combatSpur.def += 5;
				this.combatSpur.res += 5;
				boostText += this.name + " gets +5 to all stats from HP >= 25% with Tome of Fury.<br>";
			}
			if(this.rValue == 5 && (this.initiator || this.buddy.adjacent > 0 || this.buddy.two > 0)){
				this.combatSpur.atk += 5;
				this.combatSpur.spd += 5;
				this.combatSpur.def += 5;
				this.combatSpur.res += 5;
				boostText += this.name + " gets +5 to all stats from initiating or being within 2 spaces of an ally with Tome of Fury.<br>";
			}
		}
		if(this.hasExactly("Proud Spear")){
			if(this.initiator || enemy.combatStartHp / enemy.maxHp >= 0.75){
				this.combatSpur.atk += 5;
				this.combatSpur.spd += 5;
				this.combatSpur.def += 5;
				this.combatSpur.res += 5;
				boostText += this.name + " gets +5 to all stats from initiating or enemy HP >= 75% with Proud Spear.<br>";
			}
			if(this.rValue == 5 && this.combatStartHp / this.maxHp >= 0.25){
				this.combatSpur.atk += 5;
				this.combatSpur.spd += 5;
				this.combatSpur.def += 5;
				this.combatSpur.res += 5;
				boostText += this.name + " gets +5 to all stats from HP >= 25% with Proud Spear.<br>";
			}
		}
		if(this.hasExactly("Taciturn Axe")){
			if(this.buddy.adjacent + this.buddy.two + this.buddy.three > 0){
				enemy.combatSpur.atk -= 6;
				enemy.combatSpur.def -= 6;
				boostText += this.name + " inflicts -6 atk & def to " + enemy.name + " from being within 3 spaces of an ally with Taciturn Axe.<br>";
			}
			if(this.rValue == 5 && (!this.initiator || enemy.combatStartHp / enemy.maxHp >= 0.75)){
				var taVal = Math.floor(allStats[18] * 0.1) + 6;
				enemy.combatSpur.atk -= taVal;
				enemy.combatSpur.def -= taVal;
				if(this.penalty.panic){
					this.combatBuffs = {"atk":0,"spd":0,"def":0,"res":0};
					this.buffs = {"atk":0,"spd":0,"def":0,"res":0};
				}
				this.combatDebuffs = {"atk":0,"spd":0,"def":0,"res":0};
				this.debuffs = {"atk":0,"spd":0,"def":0,"res":0};
				boostText += this.name + " neutralizes penalties and inflicts -" + taVal + " atk & def to " + enemy.name + " from enemy initiating or enemy HP >= 75% with Taciturn Axe.<br>";
			}
		}
		if(((this.hasExactly("Tome of Dusk") || this.hasExactly("Baton of Dusk")) && this.combatStartHp / this.maxHp >= 0.25) || (this.hasExactly("Axe of Dusk") && (this.initiator || enemy.combatStartHp / enemy.maxHp >= 0.75))){
			var tdVal = Math.min(this.buddy.erorc * 3 + 5, 14);
			this.combatSpur.atk += tdVal;
			this.combatSpur.spd += tdVal;
			this.combatSpur.def += tdVal;
			this.combatSpur.res += tdVal;
			boostText += this.name + " gets +" + tdVal + " to all stats from HP >= 25% with " + data.skills[this.weaponIndex].name + ".<br>";
		}
		if(this.hasExactly("Duskstone") && this.combatStartHp / this.maxHp >= 0.25){
			var dsVal = Math.min(this.buddy.erorc * 3 + 5, 14);
			enemy.combatSpur.atk -= dsVal;
			enemy.combatSpur.spd -= dsVal;
			enemy.combatSpur.def -= dsVal;
			enemy.combatSpur.res -= dsVal;
			boostText += this.name + " inflicts -" + dsVal + " all stats to " + enemy.name + " from HP >= 25% with Duskstone.<br>";
		}
		if(this.hasExactly("Sword of Dusk")){
			enemy.combatSpur.atk -= 5;
			enemy.combatSpur.spd -= 5;
			enemy.combatSpur.def -= 5;
			boostText += this.name + " inflicts -5 atk/spd/def to " + enemy.name + " with Sword of Dusk.<br>";
			if(this.combatStartHp / this.maxHp >= 0.25){
				var sdVal = Math.min(this.buddy.erorc * 3, 9);
				this.combatSpur.atk += sdVal;
				this.combatSpur.spd += sdVal;
				this.combatSpur.def += sdVal;
				this.combatSpur.res += sdVal;
				boostText += this.name + " gets +" + sdVal + " to all stats from HP >= 25% with Sword of Dusk.<br>";
			}
		}
		if(this.hasExactly("Ancient Majesty") && this.combatStartHp / this.maxHp >= 0.25){
			var amVal = Math.min(this.buddy.rorc * 3 + 5, 14);
			this.combatSpur.atk += amVal;
			this.combatSpur.spd += amVal;
			this.combatSpur.def += amVal;
			this.combatSpur.res += amVal;
			boostText += this.name + " gets +" + amVal + " to all stats from HP >= 25% with Ancient Majesty.<br>";
		}
		if(this.hasExactly("Fundament") && this.combatStartHp / this.maxHp >= 0.25){
			var ftVal = Math.floor(allStats[19] * 0.2) + 6;
			enemy.combatSpur.atk -= ftVal;
			enemy.combatSpur.res -= ftVal;
			boostText += this.name + " inflicts -" + ftVal + " atk & res to " + enemy.name + " from HP >= 25% with Fundament.<br>";
		}
		if(this.hasExactly("Gift of Guidance") && this.combatStartHp / this.maxHp >= 0.25){
			if(this.penalty.panic){
				this.combatBuffs = {"atk":0,"spd":0,"def":0,"res":0};
				this.buffs = {"atk":0,"spd":0,"def":0,"res":0};
			}
			this.combatDebuffs = {"atk":0,"spd":0,"def":0,"res":0};
			this.debuffs = {"atk":0,"spd":0,"def":0,"res":0};
			boostText += this.name + " neutralizes penalties from HP >= 25% with Gift of Guidance.<br>";
		}
		if(this.hasExactly("Ancient Betrayal") && this.combatStartHp / this.maxHp >= 0.25){
			var abVal = Math.floor(allStats[19] * 0.2) + 5;
			enemy.combatSpur.atk -= abVal;
			enemy.combatSpur.def -= abVal;
			enemy.combatSpur.res -= abVal;
			boostText += this.name + " inflicts -" + abVal + " atk/def/res to " + enemy.name + " from HP >= 25% with Ancient Betrayal.<br>";
		}
		if((this.hasExactly("Ancient Voice") || this.hasExactly("Sword of Peace")) && this.buddy.adjacent + this.buddy.two + this.buddy.three > 0){
			var avVal = Math.min((this.buddy.adjacent + this.buddy.two + this.buddy.three) * 3 + 5, 14);
			this.combatSpur.atk += avVal;
			this.combatSpur.spd += avVal;
			this.combatSpur.def += avVal;
			this.combatSpur.res += avVal;
			boostText += this.name + " gets +" + avVal + " to all stats from being within 3 spaces of an ally with " + data.skills[this.weaponIndex].name + ".<br>";
		}
		if(this.hasExactly("Ancient Trickery") && this.combatStartHp / this.maxHp >= 0.25){
			var atVal = Math.min(Math.floor(allStats[20] * 0.25) - 4, 14);
			atVal = Math.max(atVal, 5);
			this.combatSpur.atk += atVal;
			this.combatSpur.spd += atVal;
			this.combatSpur.def += atVal;
			this.combatSpur.res += atVal;
			boostText += this.name + " gets +" + atVal + " to all stats from HP >= 25% with Ancient Trickery.<br>";
		}
		if(this.hasExactly("Jaws of Closure")){
			enemy.combatSpur.atk -= 5;
			enemy.combatSpur.spd -= 5;
			enemy.combatSpur.def -= 5;
			enemy.combatSpur.res -= 5;
			boostText += this.name + " inflicts -5 all stats to " + enemy.name + " with Jaws of Closure.<br>";
			if(this.combatStartHp / this.maxHp >= 0.25){
				var jcVal = Math.floor(allStats[17] * 0.15);
				this.combatSpur.atk += jcVal;
				this.combatSpur.spd += jcVal;
				this.combatSpur.def += jcVal;
				this.combatSpur.res += jcVal;
				boostText += this.name + " gets +" + jcVal + " to all stats from HP >= 25% with Jaws of Closure.<br>";
			}
		}
		if(this.hasExactly("New Opening") && (this.transform == true || enemy.combatStartHp / enemy.maxHp >= 0.75)){
			this.combatSpur.atk += 9;
			this.combatSpur.spd += 9;
			this.combatSpur.def += 9;
			this.combatSpur.res += 9;
			boostText += this.name + " gets +9 to all stats from being transformed or enemy HP >= 75% with New Opening.<br>";
		}
		
		//Owl-type Weapon
		if((this.has("Raudrowl") || this.has("Blarowl") || this.has("Gronnowl") || this.hasExactly("Nidhogg") || (this.hasExactly("Wolf Queen Fang") && this.rValue < 0) || ((this.hasExactly("Wind's Brand") || this.hasExactly("Hermit's Tome")) && this.rValue == 5) || this.hasExactly("Nifl Frostflowers") || this.hasExactly("Muspell Fireposy") || this.hasExactly("Reese's Tome") || this.has("Glittering Breath") || this.has("Goodie Boot") || this.hasExactly("Bull Blade") || this.hasExactly("Panther Lance")) && this.toggle.weapon > 0 && this.toggle.weapon != 10){
			var skillName = data.skills[this.weaponIndex].name;
			var buffVal = 2;
			var multiplier = this.toggle.weapon;
			if(this.toggle.weapon > 9){
				multiplier = multiplier - 10;
			}
			buffVal = buffVal * multiplier;
			if((this.hasExactly("Nifl Frostflowers") && this.rValue < 0) || (this.hasExactly("Muspell Fireposy") && this.rValue < 0) || (this.hasExactly("Wolf Queen Fang") && this.rValue < 0)){
				buffVal = Math.min(buffVal, 6);
				this.combatSpur.atk += buffVal;
				this.combatSpur.spd += buffVal;
				boostText += this.name + " gets +" + buffVal + " to atk and spd from being within 2 spaces to  " + multiplier + " allies with " + skillName + ".<br>";
			}
			else if(this.hasExactly("Nifl Frostflowers") && this.rValue > 0){
				buffVal = Math.min(buffVal, 4);
				this.combatSpur.atk += buffVal;
				boostText += this.name + " gets +" + buffVal + " to atk from being within 3 spaces to  " + multiplier + " allies with " + skillName + ".<br>";
			}
			else if(this.has("Glittering Breath") || this.has("Goodie Boot")){
				buffVal = Math.min(buffVal, 6);
				this.combatSpur.def += buffVal;
				this.combatSpur.res += buffVal;
				boostText += this.name + " gets +" + buffVal + " to def and res from being within 2 spaces to  " + multiplier + " allies with " + skillName + ".<br>";
			}
			else if(this.hasExactly("Bull Blade") || this.hasExactly("Panther Lance")){
				buffVal = Math.min(buffVal, 6);
				this.combatSpur.atk += buffVal;
				this.combatSpur.def += buffVal;
				boostText += this.name + " gets +" + buffVal + " to atk and def from being within 2 spaces to  " + multiplier + " allies with " + skillName + ".<br>";
			}
			else if(this.hasExactly("Muspell Fireposy") && this.rValue > 0){
				buffVal = 5 + (multiplier * 2);
				buffVal = Math.min(buffVal, 9);
				this.combatSpur.atk += buffVal;
				this.combatSpur.spd += 5;
				boostText += this.name + " gets +" + buffVal + " to atk and +5 to spd from being within 3 spaces to  " + multiplier + " allies with " + skillName + ".<br>";
			}
			else{
				this.combatSpur.atk += buffVal;
				this.combatSpur.spd += buffVal;
				this.combatSpur.def += buffVal;
				this.combatSpur.res += buffVal;
				boostText += this.name + " gets +" + buffVal + " in all stats from being adjacent to  " + multiplier + " allies with " + skillName + ".<br>";
			}
		}
		//Tome of Grado (moved up to go before Unity skills)
		if(this.hasExactly("Tome of Grado") && (enemy.combatStartHp / enemy.maxHp >= 1 || !this.initiator)){
			enemy.combatSpur.atk -= 6;
			enemy.combatSpur.res -= 6;
			skillName = data.skills[this.weaponIndex].name;
			boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -6 to atk and res.<br>";
			if(this.penalty.panic){
				this.combatBuffs.atk = 0;
				this.combatBuffs.res = 0;
				this.buffs.atk = 0;
				this.buffs.res = 0;
			}
			this.combatDebuffs.atk = 0;
			this.combatDebuffs.res = 0;
			this.debuffs.atk = 0;
			this.debuffs.res = 0;
			boostText += this.name + " has neutralized penalties to atk and res.<br>";
		}
		//Aether Raids specific A skills
		if(this.has("AR-D Atk Res") && this.toggle.a > 1){
			var tVal = 0;
			skillName = data.skills[this.aIndex].name;
			if(this.toggle.a == 5){
				tVal = this.has("AR-D Atk Res") * 3 + 1;
			}
			else if(this.toggle.a == 4){
				tVal = this.has("AR-D Atk Res") * 2 + 1;
			}
			else if(this.toggle.a == 3){
				tVal = this.has("AR-D Atk Res") + 1;
			}
			else if(this.toggle.a == 2){
				tVal = 1;
			}
			this.combatSpur.atk += tVal;
			this.combatSpur.res += tVal;
			boostText += this.name + " gets +" + tVal + " atk and res from " + skillName + ".<br>";
		}
		else if(this.has("AR-D Spd Def") && this.toggle.a > 1){
			var tVal = 0;
			skillName = data.skills[this.aIndex].name;
			if(this.toggle.a == 5){
				tVal = this.has("AR-D Spd Def") * 3 + 1;
			}
			else if(this.toggle.a == 4){
				tVal = this.has("AR-D Spd Def") * 2 + 1;
			}
			else if(this.toggle.a == 3){
				tVal = this.has("AR-D Spd Def") + 1;
			}
			else if(this.toggle.a == 2){
				tVal = 1;
			}
			this.combatSpur.spd += tVal;
			this.combatSpur.def += tVal;
			boostText += this.name + " gets +" + tVal + " spd and def from " + skillName + ".<br>";
		}
		else if(this.has("AR-D Def Res") && this.toggle.a > 1){
			var tVal = 0;
			skillName = data.skills[this.aIndex].name;
			if(this.toggle.a == 5){
				tVal = this.has("AR-D Def Res") * 3 + 1;
			}
			else if(this.toggle.a == 4){
				tVal = this.has("AR-D Def Res") * 2 + 1;
			}
			else if(this.toggle.a == 3){
				tVal = this.has("AR-D Def Res") + 1;
			}
			else if(this.toggle.a == 2){
				tVal = 1;
			}
			if(this.hasExactly("AR-D Def Res 4")){
				tVal = tVal - 2;
			}
			this.combatSpur.def += tVal;
			this.combatSpur.res += tVal;
			boostText += this.name + " gets +" + tVal + " def and res from " + skillName + ".<br>";
		}
		else if(this.has("AR-D Spd Res") && this.toggle.a > 1){
			var tVal = 0;
			skillName = data.skills[this.aIndex].name;
			if(this.toggle.a == 5){
				tVal = this.has("AR-D Spd Res") * 3 + 1;
			}
			else if(this.toggle.a == 4){
				tVal = this.has("AR-D Spd Res") * 2 + 1;
			}
			else if(this.toggle.a == 3){
				tVal = this.has("AR-D Spd Res") + 1;
			}
			else if(this.toggle.a == 2){
				tVal = 1;
			}
			this.combatSpur.spd += tVal;
			this.combatSpur.res += tVal;
			boostText += this.name + " gets +" + tVal + " spd and res from " + skillName + ".<br>";
		}
		else if(this.has("AR-D Atk Def") && this.toggle.a > 1){
			var tVal = 0;
			skillName = data.skills[this.aIndex].name;
			if(this.toggle.a == 5){
				tVal = this.has("AR-D Atk Def") * 3 + 1;
			}
			else if(this.toggle.a == 4){
				tVal = this.has("AR-D Atk Def") * 2 + 1;
			}
			else if(this.toggle.a == 3){
				tVal = this.has("AR-D Atk Def") + 1;
			}
			else if(this.toggle.a == 2){
				tVal = 1;
			}
			this.combatSpur.atk += tVal;
			this.combatSpur.def += tVal;
			boostText += this.name + " gets +" + tVal + " atk and def from " + skillName + ".<br>";
		}
		else if(this.has("AR-D Atk Spd") && this.toggle.a > 1){
			var tVal = 0;
			skillName = data.skills[this.aIndex].name;
			if(this.toggle.a == 5){
				tVal = this.has("AR-D Atk Spd") * 3 + 1;
			}
			else if(this.toggle.a == 4){
				tVal = this.has("AR-D Atk Spd") * 2 + 1;
			}
			else if(this.toggle.a == 3){
				tVal = this.has("AR-D Atk Spd") + 1;
			}
			else if(this.toggle.a == 2){
				tVal = 1;
			}
			if(this.hasExactly("AR-D Atk Spd 4")){
				tVal = tVal - 2;
			}
			this.combatSpur.atk += tVal;
			this.combatSpur.spd += tVal;
			boostText += this.name + " gets +" + tVal + " atk and spd from " + skillName + ".<br>";
		}
		if(this.has("AR-O Atk Def") && this.toggle.a > 1){
			var tVal = 0;
			skillName = data.skills[this.aIndex].name;
			if(this.toggle.a == 2){
				tVal = this.has("AR-O Atk Def") * 3 + 1;
			}
			else if(this.toggle.a == 3){
				tVal = this.has("AR-O Atk Def") * 2 + 1;
			}
			else if(this.toggle.a == 4){
				tVal = this.has("AR-O Atk Def") + 1;
			}
			else if(this.toggle.a == 5){
				tVal = 1;
			}
			this.combatSpur.atk += tVal;
			this.combatSpur.def += tVal;
			boostText += this.name + " gets +" + tVal + " atk and def from " + skillName + ".<br>";
		}
		else if(this.has("AR-O Atk Spd") && this.toggle.a > 1){
			var tVal = 0;
			skillName = data.skills[this.aIndex].name;
			if(this.toggle.a == 2){
				tVal = this.has("AR-O Atk Spd") * 3 + 1;
			}
			else if(this.toggle.a == 3){
				tVal = this.has("AR-O Atk Spd") * 2 + 1;
			}
			else if(this.toggle.a == 4){
				tVal = this.has("AR-O Atk Spd") + 1;
			}
			else if(this.toggle.a == 5){
				tVal = 1;
			}
			this.combatSpur.atk += tVal;
			this.combatSpur.spd += tVal;
			boostText += this.name + " gets +" + tVal + " atk and spd from " + skillName + ".<br>";
		}
		else if(this.has("AR-O Spd Res") && this.toggle.a > 1){
			var tVal = 0;
			skillName = data.skills[this.aIndex].name;
			if(this.toggle.a == 2){
				tVal = this.has("AR-O Spd Res") * 3 + 1;
			}
			else if(this.toggle.a == 3){
				tVal = this.has("AR-O Spd Res") * 2 + 1;
			}
			else if(this.toggle.a == 4){
				tVal = this.has("AR-O Spd Res") + 1;
			}
			else if(this.toggle.a == 5){
				tVal = 1;
			}
			this.combatSpur.spd += tVal;
			this.combatSpur.res += tVal;
			boostText += this.name + " gets +" + tVal + " spd and res from " + skillName + ".<br>";
		}
		//Form A skills
		if(this.has("Atk Spd Form")){
			var buffVal = 0;
			if(this.hasSlot("Atk Spd Form","a") && this.toggle.a > 0){
				skillName = data.skills[this.aIndex].name;
				if(this.hasSlot("Atk Spd Form 1","a")){
					buffVal = this.toggle.a;
				}
				else if(this.hasSlot("Atk Spd Form 2","a")){
					buffVal = this.toggle.a + 2;
				}
				else if(this.hasSlot("Atk Spd Form 3","a")){
					buffVal = this.toggle.a * 2 + 1;
				}
				this.combatSpur.atk += buffVal;
				this.combatSpur.spd += buffVal;
				boostText += this.name + " gets +" + buffVal + " in atk and spd from " + skillName + " by having " + this.toggle.a + " allies within 2 spaces.<br>";
			}
			if(this.hasSlot("Atk Spd Form","s") && this.toggle.s > 0){
				skillName = data.skills[this.sIndex].name;
				if(this.hasSlot("Atk Spd Form 1","s")){
					buffVal = this.toggle.s;
				}
				else if(this.hasSlot("Atk Spd Form 2","s")){
					buffVal = this.toggle.s + 2;
				}
				else if(this.hasSlot("Atk Spd Form 3","s")){
					buffVal = this.toggle.s * 2 + 1;
				}
				this.combatSpur.atk += buffVal;
				this.combatSpur.spd += buffVal;
				boostText += this.name + " gets +" + buffVal + " in atk and spd from " + skillName + " by having " + this.toggle.s + " allies within 2 spaces.<br>";
			}
		}
		if(this.has("Spd Def Form")){
			var buffVal = 0;
			if(this.hasSlot("Spd Def Form","a") && this.toggle.a > 0){
				skillName = data.skills[this.aIndex].name;
				if(this.hasSlot("Spd Def Form 1","a")){
					buffVal = this.toggle.a;
				}
				else if(this.hasSlot("Spd Def Form 2","a")){
					buffVal = this.toggle.a + 2;
				}
				else if(this.hasSlot("Spd Def Form 3","a")){
					buffVal = this.toggle.a * 2 + 1;
				}
				this.combatSpur.spd += buffVal;
				this.combatSpur.def += buffVal;
				boostText += this.name + " gets +" + buffVal + " in spd and def from " + skillName + " by having " + this.toggle.a + " allies within 2 spaces.<br>";
			}
			if(this.hasSlot("Spd Def Form","s") && this.toggle.s > 0){
				skillName = data.skills[this.sIndex].name;
				if(this.hasSlot("Spd Def Form 1","s")){
					buffVal = this.toggle.s;
				}
				else if(this.hasSlot("Spd Def Form 2","s")){
					buffVal = this.toggle.s + 2;
				}
				else if(this.hasSlot("Spd Def Form 3","s")){
					buffVal = this.toggle.s * 2 + 1;
				}
				this.combatSpur.spd += buffVal;
				this.combatSpur.def += buffVal;
				boostText += this.name + " gets +" + buffVal + " in spd and def from " + skillName + " by having " + this.toggle.s + " allies within 2 spaces.<br>";
			}
		}
		if(this.has("Atk Def Form")){
			var buffVal = 0;
			if(this.hasSlot("Atk Def Form","a") && this.toggle.a > 0){
				skillName = data.skills[this.aIndex].name;
				if(this.hasSlot("Atk Def Form 1","a")){
					buffVal = this.toggle.a;
				}
				else if(this.hasSlot("Atk Def Form 2","a")){
					buffVal = this.toggle.a + 2;
				}
				else if(this.hasSlot("Atk Def Form 3","a")){
					buffVal = this.toggle.a * 2 + 1;
				}
				this.combatSpur.atk += buffVal;
				this.combatSpur.def += buffVal;
				boostText += this.name + " gets +" + buffVal + " in atk and def from " + skillName + " by having " + this.toggle.a + " allies within 2 spaces.<br>";
			}
			if(this.hasSlot("Atk Def Form","s") && this.toggle.s > 0){
				skillName = data.skills[this.sIndex].name;
				if(this.hasSlot("Atk Def Form 1","s")){
					buffVal = this.toggle.s;
				}
				else if(this.hasSlot("Atk Def Form 2","s")){
					buffVal = this.toggle.s + 2;
				}
				else if(this.hasSlot("Atk Def Form 3","s")){
					buffVal = this.toggle.s * 2 + 1;
				}
				this.combatSpur.atk += buffVal;
				this.combatSpur.def += buffVal;
				boostText += this.name + " gets +" + buffVal + " in atk and def from " + skillName + " by having " + this.toggle.s + " allies within 2 spaces.<br>";
			}
		}
		if(this.has("Spd Res Form")){
			var buffVal = 0;
			if(this.hasSlot("Spd Res Form","a") && this.toggle.a > 0){
				skillName = data.skills[this.aIndex].name;
				if(this.hasSlot("Spd Res Form 1","a")){
					buffVal = this.toggle.a;
				}
				else if(this.hasSlot("Spd Res Form 2","a")){
					buffVal = this.toggle.a + 2;
				}
				else if(this.hasSlot("Spd Res Form 3","a")){
					buffVal = this.toggle.a * 2 + 1;
				}
				this.combatSpur.spd += buffVal;
				this.combatSpur.res += buffVal;
				boostText += this.name + " gets +" + buffVal + " in spd and res from " + skillName + " by having " + this.toggle.a + " allies within 2 spaces.<br>";
			}
			if(this.hasSlot("Spd Res Form","s") && this.toggle.s > 0){
				skillName = data.skills[this.sIndex].name;
				if(this.hasSlot("Spd Res Form 1","s")){
					buffVal = this.toggle.s;
				}
				else if(this.hasSlot("Spd Res Form 2","s")){
					buffVal = this.toggle.s + 2;
				}
				else if(this.hasSlot("Spd Res Form 3","s")){
					buffVal = this.toggle.s * 2 + 1;
				}
				this.combatSpur.spd += buffVal;
				this.combatSpur.res += buffVal;
				boostText += this.name + " gets +" + buffVal + " in spd and res from " + skillName + " by having " + this.toggle.s + " allies within 2 spaces.<br>";
			}
		}
		if(this.has("Atk Res Form")){
			var buffVal = 0;
			if(this.hasSlot("Atk Res Form","a") && this.toggle.a > 0){
				skillName = data.skills[this.aIndex].name;
				if(this.hasSlot("Atk Res Form 1","a")){
					buffVal = this.toggle.a;
				}
				else if(this.hasSlot("Atk Res Form 2","a")){
					buffVal = this.toggle.a + 2;
				}
				else if(this.hasSlot("Atk Res Form 3","a")){
					buffVal = this.toggle.a * 2 + 1;
				}
				this.combatSpur.atk += buffVal;
				this.combatSpur.res += buffVal;
				boostText += this.name + " gets +" + buffVal + " in atk and res from " + skillName + " by having " + this.toggle.a + " allies within 2 spaces.<br>";
			}
			if(this.hasSlot("Atk Res Form","s") && this.toggle.s > 0){
				skillName = data.skills[this.sIndex].name;
				if(this.hasSlot("Atk Res Form 1","s")){
					buffVal = this.toggle.s;
				}
				else if(this.hasSlot("Atk Res Form 2","s")){
					buffVal = this.toggle.s + 2;
				}
				else if(this.hasSlot("Atk Res Form 3","s")){
					buffVal = this.toggle.s * 2 + 1;
				}
				this.combatSpur.atk += buffVal;
				this.combatSpur.res += buffVal;
				boostText += this.name + " gets +" + buffVal + " in atk and res from " + skillName + " by having " + this.toggle.s + " allies within 2 spaces.<br>";
			}
		}
		if(this.has("Def Res Form")){
			var buffVal = 0;
			if(this.hasSlot("Def Res Form","a") && this.toggle.a > 0){
				skillName = data.skills[this.aIndex].name;
				if(this.hasSlot("Def Res Form 1","a")){
					buffVal = this.toggle.a;
				}
				else if(this.hasSlot("Def Res Form 2","a")){
					buffVal = this.toggle.a + 2;
				}
				else if(this.hasSlot("Def Res Form 3","a")){
					buffVal = this.toggle.a * 2 + 1;
				}
				this.combatSpur.def += buffVal;
				this.combatSpur.res += buffVal;
				boostText += this.name + " gets +" + buffVal + " in def and res from " + skillName + " by having " + this.toggle.a + " allies within 2 spaces.<br>";
			}
			if(this.hasSlot("Def Res Form","s") && this.toggle.s > 0){
				skillName = data.skills[this.sIndex].name;
				if(this.hasSlot("Def Res Form 1","s")){
					buffVal = this.toggle.s;
				}
				else if(this.hasSlot("Def Res Form 2","s")){
					buffVal = this.toggle.s + 2;
				}
				else if(this.hasSlot("Def Res Form 3","s")){
					buffVal = this.toggle.s * 2 + 1;
				}
				this.combatSpur.def += buffVal;
				this.combatSpur.res += buffVal;
				boostText += this.name + " gets +" + buffVal + " in def and res from " + skillName + " by having " + this.toggle.s + " allies within 2 spaces.<br>";
			}
		}
		//Oath 4 skills
		if(this.hasExactly("Atk Spd Oath 4") && (this.buddy.adjacent > 0 || this.buddy.two > 0)){
			this.combatSpur.atk += 3;
			this.combatSpur.spd += 3;
			boostText += this.name + " gets +3 to atk & spd from being within 2 spaces of an ally with Atk Spd Oath 4.<br>";
		}
		if(this.hasExactly("Atk Res Oath 4") && (this.buddy.adjacent > 0 || this.buddy.two > 0)){
			this.combatSpur.atk += 3;
			this.combatSpur.res += 3;
			boostText += this.name + " gets +3 to atk & res from being within 2 spaces of an ally with Atk Res Oath 4.<br>";
		}
		if(this.hasExactly("Atk Def Oath 4") && (this.buddy.adjacent > 0 || this.buddy.two > 0)){
			this.combatSpur.atk += 3;
			this.combatSpur.def += 3;
			boostText += this.name + " gets +3 to atk & def from being within 2 spaces of an ally with Atk Def Oath 4.<br>";
		}
		if(this.hasExactly("Def Res Oath 4") && (this.buddy.adjacent > 0 || this.buddy.two > 0)){
			this.combatSpur.def += 3;
			this.combatSpur.res += 3;
			boostText += this.name + " gets +3 to def & res from being within 2 spaces of an ally with Def Res Oath 4.<br>";
		}
		//Alarm skills
		if(this.hasExactly("Alarm Atk Spd") && this.toggle.c > 1){
			this.combatSpur.atk += 3;
			this.combatSpur.spd += 3;
			boostText += this.name + " gets +3 to atk & spd from number of allies adjacent <= 1 with Alarm Atk Spd.<br>";
		}
		if(this.hasExactly("Alarm Spd Def") && this.toggle.c > 1){
			this.combatSpur.spd += 3;
			this.combatSpur.def += 3;
			boostText += this.name + " gets +3 to spd & def from number of allies adjacent <= 1 with Alarm Atk Spd.<br>";
		}
		if(this.hasExactly("Alarm Atk Def") && this.toggle.c > 1){
			this.combatSpur.atk += 3;
			this.combatSpur.def += 3;
			boostText += this.name + " gets +3 to atk & def from number of allies adjacent <= 1 with Alarm Atk Def.<br>";
		}
		if(this.hasExactly("Alarm Def Res") && this.toggle.c > 1){
			this.combatSpur.def += 3;
			this.combatSpur.res += 3;
			boostText += this.name + " gets +3 to def & res from number of allies adjacent <= 1 with Alarm Def Res.<br>";
		}
		if(this.hasExactly("Tip the Scales!") && this.toggle.c > 1 && (this.buddy.adjacent > 0 || this.buddy.two > 0)){
			this.combatSpur.atk += 3;
			this.combatSpur.spd += 3;
			this.combatSpur.def += 3;
			this.combatSpur.res += 3;
			boostText += this.name + " gets +3 to all stats from being within 2 spaces of an ally with Tip the Scales!.<br>";
		}
		if(this.hasExactly("Atk Spd Pledge") && (this.buddy.adjacent > 0 || this.buddy.two > 0)){
			this.combatSpur.atk += 3;
			this.combatSpur.spd += 3;
			boostText += this.name + " gets +3 to atk & spd from being within 2 spaces of an ally with Atk Spd Pledge.<br>";
		}
		if(this.hasExactly("Def Res Pledge") && (this.buddy.adjacent > 0 || this.buddy.two > 0)){
			this.combatSpur.def += 3;
			this.combatSpur.res += 3;
			boostText += this.name + " gets +3 to def & res from being within 2 spaces of an ally with Def Res Pledge.<br>";
		}
		if(this.hasExactly("Incite Atk Spd") && this.buddy.adjacent < 2){
			this.combatSpur.atk += 3;
			this.combatSpur.spd += 3;
			boostText += this.name + " gets +3 to atk & spd from # of adjacent allies <= 1 with Incite Atk Spd.<br>";
		}
		if(this.hasExactly("Incite Atk Res") && this.buddy.adjacent < 2){
			this.combatSpur.atk += 3;
			this.combatSpur.res += 3;
			boostText += this.name + " gets +3 to atk & res from # of adjacent allies <= 1 with Incite Atk Res.<br>";
		}
		if(this.hasExactly("Incite Spd Def") && this.buddy.adjacent < 2){
			this.combatSpur.spd += 3;
			this.combatSpur.def += 3;
			boostText += this.name + " gets +3 to spd & def from # of adjacent allies <= 1 with Incite Spd Def.<br>";
		}
		if(this.hasExactly("AS Incite Hone")){
			var ihVal = this.toggle.c % 10 + 2;
			this.combatSpur.atk += ihVal;
			this.combatSpur.spd += ihVal;
			boostText += this.name + " gets +" + ihVal + " to atk & spd with AS Incite Hone.<br>";
		}
		if(this.hasExactly("AR Incite Hone")){
			var ihVal = this.toggle.c % 10 + 2;
			this.combatSpur.atk += ihVal;
			this.combatSpur.res += ihVal;
			boostText += this.name + " gets +" + ihVal + " to atk & res with AR Incite Hone.<br>";
		}
		if(this.hasExactly("Breath of Life 4") && this.buddy.adjacent + this.buddy.two > 0){
			this.combatSpur.def += 4;
			boostText += this.name + " gets +4 to def from being within 2 spaces of an ally with Breath of Life 4.<br>";
		}
		if(this.hasExactly("Odd Def Wave 4") && currTurn % 2 == 1){
			this.combatSpur.def += 6;
			boostText += this.name + " gets +6 to def from being an odd-numbered turn with Odd Def Wave 4.<br>";
		}
		if(this.hasExactly("Odd Spd Wave 4") && currTurn % 2 == 1){
			this.combatSpur.spd += 6;
			boostText += this.name + " gets +6 to spd from being an odd-numbered turn with Odd Spd Wave 4.<br>";
		}
		if(this.hasExactly("Even Res Wave D") && currTurn % 2 == 0){
			this.combatSpur.res += 6;
			boostText += this.name + " gets +6 to res from being an even-numbered turn with Even Res Wave D.<br>";
		}
		if(this.hasExactly("Even Atk Wave N") && currTurn % 2 == 0){
			this.combatSpur.atk += 6;
			boostText += this.name + " gets +6 to atk from being an even-numbered turn with Even Atk Wave N.<br>";
		}
		if(this.hasExactly("Creation Pulse") && enemy.checkBonPen(3,this,currTurn)){
			this.combatSpur.atk += 3;
			this.combatSpur.spd += 3;
			boostText += this.name + " gets +3 to atk & spd from [Penalty] being active on enemy with Creation Pulse.<br>";
		}
		if((this.hasExactly("Endless Tempest") || this.hasExactly("Brutal Tempest")) && this.buddy.spaces > 0){
			var etVal = Math.min(this.buddy.spaces, 3)
			this.combatSpur.atk += etVal;
			this.combatSpur.spd += etVal;
			this.combatSpur.def += etVal;
			this.combatSpur.res += etVal;
			boostText += this.name + " gets +" + etVal + " to all stats from unit or enemy initiating after moving " + this.buddy.spaces + " space(s) with " + data.skills[this.cIndex].name + ".<br>";
		}
		if(this.hasExactly("Paranoia") && this.combatStartHp / this.maxHp < 1){
			this.combatSpur.atk += 5;
			this.combatSpur.spd += 5;
			boostText += this.name + " gets +5 to atk & spd from HP <= 99% with Paranoia.<br>";
		}
		if(this.hasExactly("Goddess Bearer 2") && this.buddy.rorc > 0){
			this.combatSpur.atk += 4;
			this.combatSpur.spd += 4;
			this.combatSpur.def += 4;
			this.combatSpur.res += 4;
			boostText += this.name + " gets +4 to all stats from having an ally within 3 rows/columns with Goddess Bearer 2.<br>";
		}
		if((this.hasExactly("Shadow Shift 4") || this.hasExactly("Shadow Smite 4")) && this.buddy.adjacent + this.buddy.two + this.buddy.three > 0){
			this.combatSpur.atk += 3;
			this.combatSpur.spd += 3;
			this.combatSpur.def += 3;
			this.combatSpur.res += 3;
			boostText += this.name + " gets +3 to all stats from being within 3 spaces of an ally with " + data.skills[this.cIndex].name + ".<br>";
		}
		if(this.hasExactly("Connected World") && this.buddy.adjacent + this.buddy.two + this.buddy.three > 0){
			this.combatSpur.atk += 5;
			this.combatSpur.def += 5;
			this.combatSpur.res += 5;
			boostText += this.name + " gets +5 to atk/def/res from being within 3 spaces of an ally with Connected World.<br>";
		}
		if(this.hasExactly("Divine Talon") && (this.transform == true || enemy.combatStartHp / enemy.maxHp >= 0.75)){
			this.combatSpur.atk += 5;
			this.combatSpur.spd += 5
			this.combatSpur.def += 5;
			this.combatSpur.res += 5;
			boostText += this.name + " gets +5 to all stats from being transformed or enemy HP >= 75% with Divine Talon.<br>";
		}
		if(this.hasExactly("Worldbreaker+")){
			this.combatSpur.atk += 5;
			this.combatSpur.def += 5;
			this.combatSpur.res += 5;
			boostText += this.name + " gets +5 to atk/def/res from Worldbreaker+.<br>";
		}
		if(this.hasExactly("Barricade") && this.buddy.adjacent + this.buddy.two + this.buddy.three > 0){
			this.combatSpur.def += 4;
			this.combatSpur.res += 4;
			if(this.penalty.panic){
				this.combatBuffs.def = 0;
				this.combatBuffs.res = 0;
				this.buffs.def = 0;
				this.buffs.res = 0;
			}
			this.combatDebuffs.def = 0;
			this.combatDebuffs.res = 0;
			this.debuffs.def = 0;
			this.debuffs.res = 0;
			boostText += this.name + " gets +4 to def & res and neutralizes penalties to def & res from being within 3 spaces of an ally with Barricade.<br>";
		}
		if(this.hasExactly("Lookout Force") && (this.initiator || this.buddy.adjacent > 0 || this.buddy.two > 0)){
			this.combatSpur.atk += 4;
			this.combatSpur.spd += 4;
			if(this.penalty.panic){
				this.combatBuffs.atk = 0;
				this.combatBuffs.spd = 0;
				this.buffs.atk = 0;
				this.buffs.spd = 0;
			}
			this.combatDebuffs.atk = 0;
			this.combatDebuffs.spd = 0;
			this.debuffs.atk = 0;
			this.debuffs.spd = 0;
			boostText += this.name + " gets +4 to atk & spd and neutralizes penalties to atk & spd from initiating or being within 2 spaces of an ally with Lookout Force.<br>";
		}
		if(this.hasExactly("Active Lookout") && (this.initiator || this.buddy.adjacent > 0 || this.buddy.two > 0)){
			this.combatSpur.atk += 4;
			this.combatSpur.spd += 4;
			boostText += this.name + " gets +4 to atk & spd from initiating or being within 2 spaces of an ally with Active Lookout.<br>";
		}
		if(this.hasExactly("Nectar's Magic") && (this.initiator || this.buddy.adjacent > 0 || this.buddy.two > 0)){
			this.combatSpur.atk += 5;
			this.combatSpur.def += 5;
			this.combatSpur.res += 5;
			boostText += this.name + " gets +5 to atk/def/res from initiating or being within 2 spaces of an ally with Nectar's Magic.<br>";
		}
		if(this.hasExactly("Time Pulse Edge") || this.hasExactly("Pulse On Blades")){
			var teVal = 2;
			if(this.specialIndex != -1){
				teVal += data.skills[this.specialIndex].charge - this.initSkillCharge();
			}
			this.combatSpur.atk += teVal;
			this.combatSpur.spd += teVal;
			boostText += this.name + " gets +" + teVal + " to atk & spd with " + data.skills[this.cIndex].name + ".<br>";
		}
		else if(this.hasExactly("Time Pulse Helm")){
			var teVal = 2;
			if(this.specialIndex != -1){
				teVal += data.skills[this.specialIndex].charge - this.initSkillCharge();
			}
			this.combatSpur.atk += teVal;
			this.combatSpur.res += teVal;
			boostText += this.name + " gets +" + teVal + " to atk & res with " + data.skills[this.cIndex].name + ".<br>";
		}
		if(this.hasExactly("Assault Rush") && this.initiator){
			this.combatSpur.atk += 5;
			boostText += this.name + " gets +5 to atk from initiating with Assault Rush.<br>";
		}
		
		//Slick fighter comes before unity
		if(this.has("Slick Fighter")){
			var sfCheck = "";
			if(this.hasExactly("Slick Fighter 4") && (!this.initiator || this.combatStartHp / this.maxHp >= 0.25)){
				enemy.combatSpur.atk -= 5;
				sfCheck = "and inflicts -5 atk to " + enemy.name + " from enemy initiating or HP >= 25%";
			}
			else if(!this.initiator && this.hp/this.maxHp >= 1 - 0.25 * this.has("Slick Fighter")){
				sfCheck = "from enemy initiating and HP >= " + (100 - 25 * this.has("Slick Fighter")) + "%";
			}
			if(sfCheck != ""){
				if(this.penalty.panic){
					this.combatBuffs = {"atk":0,"spd":0,"def":0,"res":0};
					this.buffs = {"atk":0,"spd":0,"def":0,"res":0};
				}
				this.combatDebuffs = {"atk":0,"spd":0,"def":0,"res":0};
				this.debuffs = {"atk":0,"spd":0,"def":0,"res":0};
				skillName = data.skills[this.bIndex].name;
				boostText += this.name + " neutralizes penalties " + sfCheck + " with " + skillName + ".<br>";
			}
		}
		if(this.has("Flow Force") && this.initiator){
			if((this.hasExactly("Flow Force 1") && this.combatStartHp / this.maxHp >= 1) || (this.hasExactly("Flow Force 2") && this.combatStartHp / this.maxHp >= 0.5) || this.hasExactly("Flow Force 3")){
				if(this.penalty.panic){
					this.combatBuffs.atk = 0;
					this.combatBuffs.spd = 0;
					this.buffs.atk = 0;
					this.buffs.spd = 0;
				}
				this.combatDebuffs.atk = 0;
				this.combatDebuffs.spd = 0;
				this.debuffs.atk = 0;
				this.debuffs.spd = 0;
				boostText += this.name + " has neutralized penalties to atk & spd with " + data.skills[this.bIndex].name + ".<br>";
			}
		}
		if(this.hasExactly("Speedtaker 4")){
			if(this.penalty.panic){
					this.combatBuffs.spd = 0;
					this.buffs.spd = 0;
				}
				this.combatDebuffs.spd = 0;
				this.debuffs.spd = 0;
				boostText += this.name + " has neutralized penalties to spd with " + data.skills[this.bIndex].name + ".<br>";
		}
		//Null Penalty check (Duel Rules)
		if(this.support.nullPenalty == true || this.bonus.nPenalty == true){
			if(this.penalty.panic){
				this.combatBuffs = {"atk":0,"spd":0,"def":0,"res":0};
				this.buffs = {"atk":0,"spd":0,"def":0,"res":0};
			}
			this.combatDebuffs = {"atk":0,"spd":0,"def":0,"res":0};
			this.debuffs = {"atk":0,"spd":0,"def":0,"res":0};
			boostText += this.name + " neutralizes penalties.<br>";
		}
		if(this.support.nullPenAtk == true){
			if(this.penalty.panic){
				this.combatBuffs.atk = 0;
				this.buffs.atk = 0;
			}
			this.combatDebuffs.atk = 0;
			this.debuffs.atk = 0;
			boostText += this.name + " neutralizes penalties to atk.<br>";
		}
		if(this.support.nullPenSpd == true){
			if(this.penalty.panic){
				this.combatBuffs.spd = 0;
				this.buffs.spd = 0;
			}
			this.combatDebuffs.spd = 0;
			this.debuffs.spd = 0;
			boostText += this.name + " neutralizes penalties to spd.<br>";
		}
		if(this.support.nullPenDef == true){
			if(this.penalty.panic){
				this.combatBuffs.def = 0;
				this.buffs.def = 0;
			}
			this.combatDebuffs.def = 0;
			this.debuffs.def = 0;
			boostText += this.name + " neutralizes penalties to def.<br>";
		}
		if(this.support.nullPenRes == true){
			if(this.penalty.panic){
				this.combatBuffs.res = 0;
				this.buffs.res = 0;
			}
			this.combatDebuffs.res = 0;
			this.debuffs.res = 0;
			boostText += this.name + " neutralizes penalties to res.<br>";
		}
		
		if(this.hasExactly("Savage Breath")){
			if(this.toggle.weapon < 4 && this.toggle.weapon > -1){
				var buffVal = 6 - this.toggle.weapon * 2;
				if(this.rValue > 0){
					buffVal++;
				}
				if(buffVal > 0){
					this.combatSpur.atk += buffVal;
					this.combatSpur.spd += buffVal;
					this.combatSpur.def += buffVal;
					this.combatSpur.res += buffVal;
					boostText += this.name + " gets +" + buffVal + " in all stats from Savage Breath by having " + this.toggle.weapon + " allies within 2 spaces.<br>";
				}
			}
			if(this.rValue > 0 && this.toggle.weapon > -1 && this.toggle.weapon < 2){
				if(this.penalty.panic){
					this.combatBuffs = {"atk":0,"spd":0,"def":0,"res":0};
					this.buffs = {"atk":0,"spd":0,"def":0,"res":0};
				}
				this.combatDebuffs = {"atk":0,"spd":0,"def":0,"res":0};
				this.debuffs = {"atk":0,"spd":0,"def":0,"res":0};
				boostText += this.name + " neutralizes penalties from having less than 2 allies within 2 spaces with Savage Breath.<br>";
			}
			if(this.rValue == 5 && this.combatStartHp / this.maxHp >= 0.25){
				this.combatSpur.atk += 4;
				this.combatSpur.spd += 4;
				this.combatSpur.def += 4;
				this.combatSpur.res += 4;
				boostText += this.name + " gets +4 to all stats from HP >= 25% with Savage Breath.<br>";
			}
		}
		if(this.hasExactly("Brutal Breath")){
			var buffVal = Math.max(5 - (this.buddy.adjacent + this.buddy.two) * 2,0);
			if(this.rValue > 0){
				buffVal = Math.max(11 - (this.buddy.adjacent + this.buddy.two) * 2,4);
			}
			this.combatSpur.atk += buffVal;
			this.combatSpur.spd += buffVal;
			this.combatSpur.def += buffVal;
			this.combatSpur.res += buffVal;
			var bbVal = this.buddy.adjacent + this.buddy.two;
			if(buffVal > 0){
				boostText += this.name + " gets +" + buffVal + " to all stats from having " + bbVal + " allies within 2 spaces with Brutal Breath.<br>";
			}
			if(this.rValue == 5 && (!this.initiator || enemy.combatStartHp / enemy.maxHp >= 0.75)){
				this.combatSpur.atk += 4;
				this.combatSpur.spd += 4;
				this.combatSpur.def += 4;
				this.combatSpur.res += 4;
				boostText += this.name + " gets +4 to all stats from enemy initiating or enemy HP >= 75% with Brutal Breath.<br>";
			}
		}
		//Divine Breath
		if(this.hasExactly("Divine Breath") && this.toggle.weapon > 0){
			skillName = data.skills[this.weaponIndex].name;
			var buffVal = this.toggle.weapon * 3;
			this.combatSpur.atk += buffVal;
			this.combatSpur.spd += buffVal;
			this.combatSpur.def += buffVal;
			this.combatSpur.res += buffVal;
			var sVar = 2;
			if(this.rValue > 0){
				sVar = 4;
			}
			boostText += this.name + " gets +" + buffVal + " in all stats from " + skillName + " by having " + this.toggle.weapon + " allies within " + sVar + " spaces.<br>";
		}
		//Armored Transformed Beast
		if(this.moveType == "armored" && this.weaponType == "beast" && this.transform == true){
			this.anyCounter = true;
		}
		
		//Brazen Skills
		if(this.combatStartHp / this.maxHp <= 0.8){
			if(this.has("Brazen Atk Def")){
				var skillName = "";
				var buffVal = 0;
				if(this.hasSlot("Brazen Atk Def","a")){
					buffVal = this.hasSlot("Brazen Atk Def","a") * 2 + 1;
					skillName = data.skills[this.aIndex].name;
					this.combatSpur.atk += buffVal;
					this.combatSpur.def += buffVal;
					boostText += this.name + " gets +" + buffVal + " atk and def with " + skillName + ".<br>";
				}
				if(this.hasSlot("Brazen Atk Def","s")){
					buffVal = this.hasSlot("Brazen Atk Def","s") * 2 + 1;
					skillName = data.skills[this.sIndex].name;
					this.combatSpur.atk += buffVal;
					this.combatSpur.def += buffVal;
					boostText += this.name + " gets +" + buffVal + " atk and def with " + skillName + ".<br>";
				}
			}
			if(this.has("Brazen Atk Spd")){
				var skillName = "";
				var buffVal = 0;
				if(this.hasSlot("Brazen Atk Spd","a")){
					buffVal = this.hasSlot("Brazen Atk Spd","a") * 2 + 1;
					skillName = data.skills[this.aIndex].name;
					this.combatSpur.atk += buffVal;
					this.combatSpur.spd += buffVal;
					if(this.hasExactly("Brazen Atk Spd 4")){
						this.combatSpur.spd += 1;
						boostText += this.name + " gets +9 atk and +10 spd with " + skillName + ".<br>";
					}
					else{
						boostText += this.name + " gets +" + buffVal + " atk and spd with " + skillName + ".<br>";
					}
				}
				if(this.hasSlot("Brazen Atk Spd","s")){
					buffVal = this.hasSlot("Brazen Atk Spd","s") * 2 + 1;
					skillName = data.skills[this.sIndex].name;
					this.combatSpur.atk += buffVal;
					this.combatSpur.spd += buffVal;
					boostText += this.name + " gets +" + buffVal + " atk and spd with " + skillName + ".<br>";
				}
			}
			if(this.has("Brazen Def Res")){
				var skillName = "";
				var buffVal = 0;
				if(this.hasSlot("Brazen Def Res","a")){
					buffVal = this.hasSlot("Brazen Def Res","a") * 2 + 1;
					skillName = data.skills[this.aIndex].name;
					this.combatSpur.def += buffVal;
					this.combatSpur.res += buffVal;
					boostText += this.name + " gets +" + buffVal + " def and res with " + skillName + ".<br>";
				}
				if(this.hasSlot("Brazen Def Res","s")){
					buffVal = this.hasSlot("Brazen Def Res","s") * 2 + 1;
					skillName = data.skills[this.sIndex].name;
					this.combatSpur.def += buffVal;
					this.combatSpur.res += buffVal;
					boostText += this.name + " gets +" + buffVal + " def and res with " + skillName + ".<br>";
				}
			}
			if(this.has("Brazen Atk Res")){
				var skillName = "";
				var buffVal = 0;
				if(this.hasSlot("Brazen Atk Res","a")){
					buffVal = this.hasSlot("Brazen Atk Res","a") * 2 + 1;
					skillName = data.skills[this.aIndex].name;
					this.combatSpur.atk += buffVal;
					this.combatSpur.res += buffVal;
					boostText += this.name + " gets +" + buffVal + " atk and res with " + skillName + ".<br>";
				}
				if(this.hasSlot("Brazen Atk Res","s")){
					buffVal = this.hasSlot("Brazen Atk Res","s") * 2 + 1;
					skillName = data.skills[this.sIndex].name;
					this.combatSpur.atk += buffVal;
					this.combatSpur.res += buffVal;
					boostText += this.name + " gets +" + buffVal + " atk and res with " + skillName + ".<br>";
				}
			}
			if(this.has("Brazen Spd Def")){
				var skillName = "";
				var buffVal = 0;
				if(this.hasSlot("Brazen Spd Def","a")){
					buffVal = this.hasSlot("Brazen Spd Def","a") * 2 + 1;
					skillName = data.skills[this.aIndex].name;
					this.combatSpur.spd += buffVal;
					this.combatSpur.def += buffVal;
					boostText += this.name + " gets +" + buffVal + " spd and def with " + skillName + ".<br>";
				}
				if(this.hasSlot("Brazen Spd Def","s")){
					buffVal = this.hasSlot("Brazen Spd Def","s") * 2 + 1;
					skillName = data.skills[this.sIndex].name;
					this.combatSpur.spd += buffVal;
					this.combatSpur.def += buffVal;
					boostText += this.name + " gets +" + buffVal + " spd and def with " + skillName + ".<br>";
				}
			}
			if(this.has("Brazen Spd Res")){
				var skillName = "";
				var buffVal = 0;
				if(this.hasSlot("Brazen Spd Res","a")){
					buffVal = this.hasSlot("Brazen Spd Res","a") * 2 + 1;
					skillName = data.skills[this.aIndex].name;
					this.combatSpur.spd += buffVal;
					this.combatSpur.res += buffVal;
					boostText += this.name + " gets +" + buffVal + " spd and res with " + skillName + ".<br>";
				}
				if(this.hasSlot("Brazen Spd Res","s")){
					buffVal = this.hasSlot("Brazen Spd Res","s") * 2 + 1;
					skillName = data.skills[this.sIndex].name;
					this.combatSpur.spd += buffVal;
					this.combatSpur.res += buffVal;
					boostText += this.name + " gets +" + buffVal + " spd and res with " + skillName + ".<br>";
				}
			}
			if(this.hasExactly("Folkvangr") && this.rValue > 0){
				var buffVal = 7;
				this.combatSpur.atk += buffVal;
				this.combatSpur.def += buffVal;
				boostText += this.name + " gets +" + buffVal + " atk and def with Folkvangr.<br>";
			}
			else if(this.hasExactly("Ragnarok") && this.rValue == 5){
				var buffVal = 7;
				this.combatSpur.atk += buffVal;
				this.combatSpur.spd += buffVal;
				boostText += this.name + " gets +" + buffVal + " atk and spd with Ragnarok.<br>";
			}
		}
		
		//Catch skills
		if(this.has("Atk Spd Catch")){
			if(this.hasSlot("Atk Spd Catch","a") && (enemy.combatStartHp / enemy.maxHp >= 1 || this.toggle.a == 1)){
				var skillName = data.skills[this.aIndex].name;
				var buffVal = this.hasSlot("Atk Spd Catch","a") + 2;
				if(this.hasExactly("Atk Spd Catch 4")){
					buffVal++;
				}
				this.combatSpur.atk += buffVal;
				this.combatSpur.spd += buffVal;
				boostText += this.name + " gets +" + buffVal + " atk and spd from enemy HP=100% or Penalty is active on enemy with " + skillName + ".<br>";
				if(this.hasExactly("Atk Spd Catch 4") && enemy.combatStartHp / enemy.maxHp >= 1 && this.toggle.a == 1){
					this.combatSpur.atk += 2;
					this.combatSpur.spd += 2;
					boostText += this.name + " gets +2 atk and spd from enemy HP=100% and Penalty is active on enemy with " + skillName + ".<br>";
				}
			}
			if(this.hasSlot("Atk Spd Catch","s") && (enemy.combatStartHp / enemy.maxHp >= 1 || this.toggle.s == 1)){
				var skillName = data.skills[this.sIndex].name;
				var buffVal = this.hasSlot("Atk Spd Catch","s") + 2;
				this.combatSpur.atk += buffVal;
				this.combatSpur.spd += buffVal;
				boostText += this.name + " gets +" + buffVal + " atk and spd from enemy HP=100% or Penalty is active on enemy with " + skillName + ".<br>";
			}
		}
		if(this.has("Atk Def Catch")){
			if(this.hasSlot("Atk Def Catch","a") && (enemy.combatStartHp / enemy.maxHp >= 1 || this.toggle.a == 1)){
				var skillName = data.skills[this.aIndex].name;
				var buffVal = this.hasSlot("Atk Def Catch","a") + 2;
				if(this.hasExactly("Atk Def Catch 4")){
					buffVal++;
				}
				this.combatSpur.atk += buffVal;
				this.combatSpur.def += buffVal;
				boostText += this.name + " gets +" + buffVal + " atk and def from enemy HP=100% or Penalty is active on enemy with " + skillName + ".<br>";
				if(this.hasExactly("Atk Def Catch 4") && enemy.combatStartHp / enemy.maxHp >= 1 && this.toggle.a == 1){
					this.combatSpur.atk += 2;
					this.combatSpur.def += 2;
					boostText += this.name + " gets +2 atk and def from enemy HP=100% and Penalty is active on enemy with " + skillName + ".<br>";
				}
			}
			if(this.hasSlot("Atk Def Catch","s") && (enemy.combatStartHp / enemy.maxHp >= 1 || this.toggle.s == 1)){
				var skillName = data.skills[this.sIndex].name;
				var buffVal = this.hasSlot("Atk Def Catch","s") + 2;
				this.combatSpur.atk += buffVal;
				this.combatSpur.def += buffVal;
				boostText += this.name + " gets +" + buffVal + " atk and def from enemy HP=100% or Penalty is active on enemy with " + skillName + ".<br>";
			}
		}
		if(this.has("Def Res Catch")){
			if(this.hasSlot("Def Res Catch","a") && (enemy.combatStartHp / enemy.maxHp >= 1 || this.toggle.a == 1)){
				var skillName = data.skills[this.aIndex].name;
				var buffVal = this.hasSlot("Def Res Catch","a") + 2;
				if(this.hasExactly("Def Res Catch 4")){
					buffVal++;
				}
				this.combatSpur.def += buffVal;
				this.combatSpur.res += buffVal;
				boostText += this.name + " gets +" + buffVal + " def and res from enemy HP=100% or Penalty is active on enemy with " + skillName + ".<br>";
				if(this.hasExactly("Def Res Catch 4") && enemy.combatStartHp / enemy.maxHp >= 1 && this.toggle.a == 1){
					this.combatSpur.def += 2;
					this.combatSpur.res += 2;
					boostText += this.name + " gets +2 def and res from enemy HP=100% and Penalty is active on enemy with " + skillName + ".<br>";
				}
			}
			if(this.hasSlot("Def Res Catch","s") && (enemy.combatStartHp / enemy.maxHp >= 1 || this.toggle.s == 1)){
				var skillName = data.skills[this.sIndex].name;
				var buffVal = this.hasSlot("Def Res Catch","s") + 2;
				this.combatSpur.def += buffVal;
				this.combatSpur.res += buffVal;
				boostText += this.name + " gets +" + buffVal + " def and res from enemy HP=100% or Penalty is active on enemy with " + skillName + ".<br>";
			}
		}
		if(this.has("Atk Res Catch")){
			if(this.hasSlot("Atk Res Catch","a") && (enemy.combatStartHp / enemy.maxHp >= 1 || this.toggle.a == 1)){
				var skillName = data.skills[this.aIndex].name;
				var buffVal = this.hasSlot("Atk Res Catch","a") + 2;
				if(this.hasExactly("Atk Res Catch 4")){
					buffVal++;
				}
				this.combatSpur.atk += buffVal;
				this.combatSpur.res += buffVal;
				boostText += this.name + " gets +" + buffVal + " atk and res from enemy HP=100% or Penalty is active on enemy with " + skillName + ".<br>";
				if(this.hasExactly("Atk Res Catch 4") && enemy.combatStartHp / enemy.maxHp >= 1 && this.toggle.a == 1){
					this.combatSpur.atk += 2;
					this.combatSpur.res += 2;
					boostText += this.name + " gets +2 atk and res from enemy HP=100% and Penalty is active on enemy with " + skillName + ".<br>";
				}
			}
			if(this.hasSlot("Atk Res Catch","s") && (enemy.combatStartHp / enemy.maxHp >= 1 || this.toggle.s == 1)){
				var skillName = data.skills[this.sIndex].name;
				var buffVal = this.hasSlot("Atk Res Catch","s") + 2;
				this.combatSpur.atk += buffVal;
				this.combatSpur.res += buffVal;
				boostText += this.name + " gets +" + buffVal + " atk and res from enemy HP=100% or Penalty is active on enemy with " + skillName + ".<br>";
			}
		}
		if(this.has("Spd Def Catch")){
			if(this.hasSlot("Spd Def Catch","a") && (enemy.combatStartHp / enemy.maxHp >= 1 || this.toggle.a == 1)){
				var skillName = data.skills[this.aIndex].name;
				var buffVal = this.hasSlot("Spd Def Catch","a") + 2;
				if(this.hasExactly("Spd Def Catch 4")){
					buffVal++;
				}
				this.combatSpur.spd += buffVal;
				this.combatSpur.def += buffVal;
				boostText += this.name + " gets +" + buffVal + " spd and def from enemy HP=100% or Penalty is active on enemy with " + skillName + ".<br>";
				if(this.hasExactly("Spd Def Catch 4") && enemy.combatStartHp / enemy.maxHp >= 1 && this.toggle.a == 1){
					this.combatSpur.spd += 2;
					this.combatSpur.def += 2;
					boostText += this.name + " gets +2 spd and def from enemy HP=100% and Penalty is active on enemy with " + skillName + ".<br>";
				}
			}
			if(this.hasSlot("Spd Def Catch","s") && (enemy.combatStartHp / enemy.maxHp >= 1 || this.toggle.s == 1)){
				var skillName = data.skills[this.sIndex].name;
				var buffVal = this.hasSlot("Spd Def Catch","s") + 2;
				this.combatSpur.spd += buffVal;
				this.combatSpur.def += buffVal;
				boostText += this.name + " gets +" + buffVal + " spd and def from enemy HP=100% or Penalty is active on enemy with " + skillName + ".<br>";
			}
		}
		if(this.has("Spd Res Catch")){
			if(this.hasSlot("Spd Res Catch","a") && (enemy.combatStartHp / enemy.maxHp >= 1 || this.toggle.a == 1)){
				var skillName = data.skills[this.aIndex].name;
				var buffVal = this.hasSlot("Spd Res Catch","a") + 2;
				if(this.hasExactly("Spd Res Catch 4")){
					buffVal++;
				}
				this.combatSpur.spd += buffVal;
				this.combatSpur.res += buffVal;
				boostText += this.name + " gets +" + buffVal + " spd and res from enemy HP=100% or Penalty is active on enemy with " + skillName + ".<br>";
				if(this.hasExactly("Spd Res Catch 4") && enemy.combatStartHp / enemy.maxHp >= 1 && this.toggle.a == 1){
					this.combatSpur.spd += 2;
					this.combatSpur.res += 2;
					boostText += this.name + " gets +2 spd and res from enemy HP=100% and Penalty is active on enemy with " + skillName + ".<br>";
				}
			}
			if(this.hasSlot("Spd Res Catch","s") && (enemy.combatStartHp / enemy.maxHp >= 1 || this.toggle.s == 1)){
				var skillName = data.skills[this.sIndex].name;
				var buffVal = this.hasSlot("Spd Res Catch","s") + 2;
				this.combatSpur.spd += buffVal;
				this.combatSpur.res += buffVal;
				boostText += this.name + " gets +" + buffVal + " spd and res from enemy HP=100% or Penalty is active on enemy with " + skillName + ".<br>";
			}
		}
		
		//Ideal skills
		if(this.has("Atk Spd Ideal")){
			if(this.hasSlot("Atk Spd Ideal","a") && (this.combatStartHp / this.maxHp >= 1 || this.toggle.a == 1 || checkAllBuffs(this, enemy, currTurn))){
				var skillName = data.skills[this.aIndex].name;
				var buffVal = this.hasSlot("Atk Spd Ideal","a") + 2;
				if(this.hasExactly("Atk Spd Ideal 4")){
					buffVal++;
				}
				this.combatSpur.atk += buffVal;
				this.combatSpur.spd += buffVal;
				boostText += this.name + " gets +" + buffVal + " atk & spd from HP=100% or having a Bonus active with " + skillName + ".<br>";
				if(this.hasExactly("Atk Spd Ideal 4") && this.combatStartHp / this.maxHp >= 1 && (this.toggle.a == 1 || checkAllBuffs(this, enemy, currTurn))){
					this.combatSpur.atk += 2;
					this.combatSpur.spd += 2;
					boostText += this.name + " gets +2 atk & spd from HP=100% and having a Bonus active with " + skillName + ".<br>";
				}
			}
			if(this.hasSlot("Atk Spd Ideal","s") && (this.combatStartHp / this.maxHp >= 1 || this.toggle.s == 1 || checkAllBuffs(this, enemy, currTurn))){
				var skillName = data.skills[this.sIndex].name;
				var buffVal = this.hasSlot("Atk Spd Ideal","s") + 2;
				this.combatSpur.atk += buffVal;
				this.combatSpur.spd += buffVal;
				boostText += this.name + " gets +" + buffVal + " atk & spd from HP=100% or having a Bonus active with " + skillName + ".<br>";
			}
		}
		if(this.has("Atk Def Ideal")){
			if(this.hasSlot("Atk Def Ideal","a") && (this.combatStartHp / this.maxHp >= 1 || this.toggle.a == 1 || checkAllBuffs(this, enemy, currTurn))){
				var skillName = data.skills[this.aIndex].name;
				var buffVal = this.hasSlot("Atk Def Ideal","a") + 2;
				if(this.hasExactly("Atk Def Ideal 4")){
					buffVal++;
				}
				this.combatSpur.atk += buffVal;
				this.combatSpur.def += buffVal;
				boostText += this.name + " gets +" + buffVal + " atk and def from HP=100% or having a Bonus active with " + skillName + ".<br>";
				if(this.hasExactly("Atk Def Ideal 4") && this.combatStartHp / this.maxHp >= 1 && (this.toggle.a == 1 || checkAllBuffs(this, enemy, currTurn))){
					this.combatSpur.atk += 2;
					this.combatSpur.def += 2;
					boostText += this.name + " gets +2 atk & def from HP=100% and having a Bonus active with " + skillName + ".<br>";
				}
			}
			if(this.hasSlot("Atk Def Ideal","s") && (this.combatStartHp / this.maxHp >= 1 || this.toggle.s == 1 || checkAllBuffs(this, enemy, currTurn))){
				var skillName = data.skills[this.sIndex].name;
				var buffVal = this.hasSlot("Atk Def Ideal","s") + 2;
				this.combatSpur.atk += buffVal;
				this.combatSpur.def += buffVal;
				boostText += this.name + " gets +" + buffVal + " atk & def from HP=100% or having a Bonus active with " + skillName + ".<br>";
			}
		}
		if(this.has("Atk Res Ideal")){
			if(this.hasSlot("Atk Res Ideal","a") && (this.combatStartHp / this.maxHp >= 1 || this.toggle.a == 1 || checkAllBuffs(this, enemy, currTurn))){
				var skillName = data.skills[this.aIndex].name;
				var buffVal = this.hasSlot("Atk Res Ideal","a") + 2;
				if(this.hasExactly("Atk Res Ideal 4")){
					buffVal++;
				}
				this.combatSpur.atk += buffVal;
				this.combatSpur.res += buffVal;
				boostText += this.name + " gets +" + buffVal + " atk and res from HP=100% or having a Bonus active with " + skillName + ".<br>";
				if(this.hasExactly("Atk Res Ideal 4") && this.combatStartHp / this.maxHp >= 1 && (this.toggle.a == 1 || checkAllBuffs(this, enemy, currTurn))){
					this.combatSpur.atk += 2;
					this.combatSpur.res += 2;
					boostText += this.name + " gets +2 atk & res from HP=100% and having a Bonus active with " + skillName + ".<br>";
				}
			}
			if(this.hasSlot("Atk Res Ideal","s") && (this.combatStartHp / this.maxHp >= 1 || this.toggle.s == 1 || checkAllBuffs(this, enemy, currTurn))){
				var skillName = data.skills[this.sIndex].name;
				var buffVal = this.hasSlot("Atk Res Ideal","s") + 2;
				this.combatSpur.atk += buffVal;
				this.combatSpur.res += buffVal;
				boostText += this.name + " gets +" + buffVal + " atk & res from HP=100% or having a Bonus active with " + skillName + ".<br>";
			}
		}
		if(this.has("Def Res Ideal")){
			if(this.hasSlot("Def Res Ideal","a") && (this.combatStartHp / this.maxHp >= 1 || this.toggle.a == 1 || checkAllBuffs(this, enemy, currTurn))){
				var skillName = data.skills[this.aIndex].name;
				var buffVal = this.hasSlot("Def Res Ideal","a") + 2;
				if(this.hasExactly("Def Res Ideal 4")){
					buffVal++;
				}
				this.combatSpur.def += buffVal;
				this.combatSpur.res += buffVal;
				boostText += this.name + " gets +" + buffVal + " def and res from HP=100% or having a Bonus active with " + skillName + ".<br>";
				if(this.hasExactly("Def Res Ideal 4") && this.combatStartHp / this.maxHp >= 1 && (this.toggle.a == 1 || checkAllBuffs(this, enemy, currTurn))){
					this.combatSpur.def += 2;
					this.combatSpur.res += 2;
					boostText += this.name + " gets +2 def & res from HP=100% and having a Bonus active with " + skillName + ".<br>";
				}
			}
			if(this.hasSlot("Def Res Ideal","s") && (this.combatStartHp / this.maxHp >= 1 || this.toggle.s == 1 || checkAllBuffs(this, enemy, currTurn))){
				var skillName = data.skills[this.sIndex].name;
				var buffVal = this.hasSlot("Def Res Ideal","s") + 2;
				this.combatSpur.def += buffVal;
				this.combatSpur.res += buffVal;
				boostText += this.name + " gets +" + buffVal + " def & res from HP=100% or having a Bonus active with " + skillName + ".<br>";
			}
		}
		if(this.has("Spd Def Ideal")){
			if(this.hasSlot("Spd Def Ideal","a") && (this.combatStartHp / this.maxHp >= 1 || this.toggle.a == 1 || checkAllBuffs(this, enemy, currTurn))){
				var skillName = data.skills[this.aIndex].name;
				var buffVal = this.hasSlot("Spd Def Ideal","a") + 2;
				if(this.hasExactly("Spd Def Ideal 4")){
					buffVal++;
				}
				this.combatSpur.spd += buffVal;
				this.combatSpur.def += buffVal;
				boostText += this.name + " gets +" + buffVal + " spd & def from HP=100% or having a Bonus active with " + skillName + ".<br>";
				if(this.hasExactly("Spd Def Ideal 4") && this.combatStartHp / this.maxHp >= 1 && (this.toggle.a == 1 || checkAllBuffs(this, enemy, currTurn))){
					this.combatSpur.spd += 2;
					this.combatSpur.def += 2;
					boostText += this.name + " gets +2 spd & def from HP=100% and having a Bonus active with " + skillName + ".<br>";
				}
			}
			if(this.hasSlot("Spd Def Ideal","s") && (this.combatStartHp / this.maxHp >= 1 || this.toggle.s == 1 || checkAllBuffs(this, enemy, currTurn))){
				var skillName = data.skills[this.sIndex].name;
				var buffVal = this.hasSlot("Spd Def Ideal","s") + 2;
				this.combatSpur.spd += buffVal;
				this.combatSpur.def += buffVal;
				boostText += this.name + " gets +" + buffVal + " spd & def from HP=100% or having a Bonus active with " + skillName + ".<br>";
			}
		}
		if(this.has("Spd Res Ideal")){
			if(this.hasSlot("Spd Res Ideal","a") && (this.combatStartHp / this.maxHp >= 1 || this.toggle.a == 1 || checkAllBuffs(this, enemy, currTurn))){
				var skillName = data.skills[this.aIndex].name;
				var buffVal = this.hasSlot("Spd Res Ideal","a") + 2;
				if(this.hasExactly("Spd Res Ideal 4")){
					buffVal++;
				}
				this.combatSpur.spd += buffVal;
				this.combatSpur.res += buffVal;
				boostText += this.name + " gets +" + buffVal + " spd & res from HP=100% or having a Bonus active with " + skillName + ".<br>";
				if(this.hasExactly("Spd Res Ideal 4") && this.combatStartHp / this.maxHp >= 1 && (this.toggle.a == 1 || checkAllBuffs(this, enemy, currTurn))){
					this.combatSpur.spd += 2;
					this.combatSpur.res += 2;
					boostText += this.name + " gets +2 spd & res from HP=100% and having a Bonus active with " + skillName + ".<br>";
				}
			}
			if(this.hasSlot("Spd Res Ideal","s") && (this.combatStartHp / this.maxHp >= 1 || this.toggle.s == 1 || checkAllBuffs(this, enemy, currTurn))){
				var skillName = data.skills[this.sIndex].name;
				var buffVal = this.hasSlot("Spd Res Ideal","s") + 2;
				this.combatSpur.spd += buffVal;
				this.combatSpur.res += buffVal;
				boostText += this.name + " gets +" + buffVal + " spd & res from HP=100% or having a Bonus active with " + skillName + ".<br>";
			}
		}
		//Hexblade skills
		if(this.hasExactly("Atk Spd Hexblade") && (checkAllBuffs(this, enemy, currTurn) || Object.values(this.bonus).reduce((a, item) => a + (item === true ? 1 : 0), 0) + this.bonus.extra > 0)){
			this.combatSpur.atk += 7;
			this.combatSpur.spd += 7;
			boostText += this.name + " gets +7 to atk & spd from having a [Bonus] active with Atk Spd Hexblade.<br>";
		}
		if(this.hasExactly("Spd Res Hexblade") && (checkAllBuffs(this, enemy, currTurn) || Object.values(this.bonus).reduce((a, item) => a + (item === true ? 1 : 0), 0) + this.bonus.extra > 0)){
			this.combatSpur.spd += 7;
			this.combatSpur.res += 7;
			boostText += this.name + " gets +7 to spd & res from having a [Bonus] active with Spd Res Hexblade.<br>";
		}
		//Prime skills
		if(this.hasSlot("Atk Spd Prime","a") && (checkAllBuffs(this, enemy, currTurn) || Object.values(this.bonus).reduce((a, item) => a + (item === true ? 1 : 0), 0) + this.bonus.extra > 0)){
			var sAdjust = 1;
			if(this.hasSlot("Atk Spd Prime","a") > 2){
				sAdjust = 3;
			}
			var pVal = (Object.values(this.bonus).reduce((a, item) => a + (item === true ? 1 : 0), 0) + this.bonus.extra) * 2 + sAdjust;
			pVal = Math.min(pVal,this.hasSlot("Atk Spd Prime","a") * 2 + 1);
			this.combatSpur.atk += pVal;
			this.combatSpur.spd += pVal;
			boostText += this.name + " gets +" + pVal + " atk & spd from having a [Bonus] active with " + data.skills[this.aIndex].name + ".<br>";
		}
		if(this.hasSlot("Atk Def Prime","a") && (checkAllBuffs(this, enemy, currTurn) || Object.values(this.bonus).reduce((a, item) => a + (item === true ? 1 : 0), 0) + this.bonus.extra > 0)){
			var sAdjust = 1;
			if(this.hasSlot("Atk Def Prime","a") > 2){
				sAdjust = 3;
			}
			var pVal = (Object.values(this.bonus).reduce((a, item) => a + (item === true ? 1 : 0), 0) + this.bonus.extra) * 2 + sAdjust;
			pVal = Math.min(pVal,this.hasSlot("Atk Def Prime","a") * 2 + 1);
			this.combatSpur.atk += pVal;
			this.combatSpur.def += pVal;
			boostText += this.name + " gets +" + pVal + " atk & def from having a [Bonus] active with " + data.skills[this.aIndex].name + ".<br>";
		}
		if(this.has("Spd Def Prime") && (checkAllBuffs(this, enemy, currTurn) || Object.values(this.bonus).reduce((a, item) => a + (item === true ? 1 : 0), 0) + this.bonus.extra > 0)){
			var sAdjust = 1;
			if(this.has("Spd Def Prime") > 2){
				sAdjust = 3;
			}
			var pVal = (Object.values(this.bonus).reduce((a, item) => a + (item === true ? 1 : 0), 0) + this.bonus.extra) * 2 + sAdjust;
			pVal = Math.min(pVal,this.has("Spd Def Prime") * 2 + 1);
			this.combatSpur.spd += pVal;
			this.combatSpur.def += pVal;
			boostText += this.name + " gets +" + pVal + " spd & def from having a [Bonus] active with " + data.skills[this.aIndex].name + ".<br>";
		}
		if(this.hasSlot("Atk Def Prime","s") && (checkAllBuffs(this, enemy, currTurn) || Object.values(this.bonus).reduce((a, item) => a + (item === true ? 1 : 0), 0) + this.bonus.extra > 0)){
			var sAdjust = 1;
			if(this.hasSlot("Atk Def Prime","s") > 2){
				sAdjust = 3;
			}
			var pVal = (Object.values(this.bonus).reduce((a, item) => a + (item === true ? 1 : 0), 0) + this.bonus.extra) * 2 + sAdjust;
			pVal = Math.min(pVal,this.hasSlot("Atk Def Prime","s") * 2 + 1);
			this.combatSpur.atk += pVal;
			this.combatSpur.def += pVal;
			boostText += this.name + " gets +" + pVal + " atk & def from having a [Bonus] active with " + data.skills[this.sIndex].name + ".<br>";
		}
		if(this.hasSlot("Atk Spd Prime","s") && (checkAllBuffs(this, enemy, currTurn) || Object.values(this.bonus).reduce((a, item) => a + (item === true ? 1 : 0), 0) + this.bonus.extra > 0)){
			var sAdjust = 1;
			if(this.hasSlot("Atk Spd Prime","s") > 2){
				sAdjust = 3;
			}
			var pVal = (Object.values(this.bonus).reduce((a, item) => a + (item === true ? 1 : 0), 0) + this.bonus.extra) * 2 + sAdjust;
			pVal = Math.min(pVal,this.hasSlot("Atk Spd Prime","s") * 2 + 1);
			this.combatSpur.atk += pVal;
			this.combatSpur.spd += pVal;
			boostText += this.name + " gets +" + pVal + " atk & spd from having a [Bonus] active with " + data.skills[this.sIndex].name + ".<br>";
		}
		//Wild skills
		if(this.hasExactly("Atk Spd Wild") && (this.buddy.adjacent < 2 || this.transform == true)){
			this.combatSpur.atk += 7;
			this.combatSpur.spd += 7;
			boostText += this.name + " gets +7 to atk & spd from being transformed or # of adjacent allies other than beast/dragon <= 1 with Atk Spd Wild.<br>";
		}
		//Fortune skills
		if(this.hasExactly("Atk Spd Fortune") && (!this.initiator || this.transform == true)){
			this.combatSpur.atk += 8;
			this.combatSpur.spd += 8;
			boostText += this.name + " gets +8 to atk & spd from being transformed or enemy initiating with Atk Spd Fortune.<br>";
		}
		if(this.hasExactly("Atk Res Fortune") && (!this.initiator || this.transform == true)){
			this.combatSpur.atk += 8;
			this.combatSpur.res += 8;
			boostText += this.name + " gets +8 to atk & res from being transformed or enemy initiating with Atk Res Fortune.<br>";
		}
		//Sway/Tidings skills
		if(this.hasExactly("Sway Atk Res") && (this.initiator || this.buddy.adjacent + this.buddy.two + this.buddy.three > 0)){
			var swayVal = Math.min((this.buddy.adjacent + this.buddy.two + this.buddy.three) * 2 + 8, 12);
			this.combatSpur.atk += swayVal;
			this.combatSpur.res += swayVal;
			boostText += this.name + " gets +" + swayVal + " to atk & res from initiating or being within 3 spaces of an ally with Sway Atk Res.<br>";
		}
		if((this.hasExactly("Sway Atk Spd") || this.hasExactly("Atk Spd Tidings")) && (this.initiator || this.buddy.adjacent + this.buddy.two + this.buddy.three > 0)){
			var swayVal = Math.min((this.buddy.adjacent + this.buddy.two + this.buddy.three) * 2 + 8, 12);
			this.combatSpur.atk += swayVal;
			this.combatSpur.spd += swayVal;
			boostText += this.name + " gets +" + swayVal + " to atk & spd from initiating or being within 3 spaces of an ally with " + data.skills[this.aIndex].name + ".<br>";
		}
		//Perfect skills
		if(this.hasExactly("Perfect Atk Spd") && (this.combatStartHp / this.maxHp >= 0.25 || this.buddy.adjacent + this.buddy.two + this.buddy.three > 0)){
			var perfVal = 7;
			if(this.combatStartHp / this.maxHp >= 0.25 && this.buddy.adjacent + this.buddy.two + this.buddy.three > 0){
				perfVal += 3;
			}
			this.combatSpur.atk += perfVal;
			this.combatSpur.spd += perfVal;
			boostText += this.name + " gets +" + perfVal + " to atk & spd from HP >= 25% and/or being within 3 spaces of an ally with Perfect Atk Spd.<br>";
		}
		
		//Sealed Falchion
		if(this.hasExactly("Sealed Falchion") && (this.combatStartHp / this.maxHp < 1 || ((this.toggle.weapon == 1 || checkAllBuffs(this, enemy, currTurn)) && this.rValue > 0))){
			var buffVal = 5;
			this.combatSpur.atk += buffVal;
			this.combatSpur.spd += buffVal;
			this.combatSpur.def += buffVal;
			this.combatSpur.res += buffVal;
			boostText += this.name + " gets +5 to all stats with Sealed Falchion.<br>";
		}
		//Refined Sealed Falchoin
		if(this.hasExactly("Sealed Falchion") && this.rValue == 5 && enemy.combatStartHp / enemy.maxHp >= 0.75){
			var buffVal = 5;
			this.combatSpur.atk += buffVal;
			this.combatSpur.spd += buffVal;
			this.combatSpur.def += buffVal;
			boostText += this.name + " gets +5 atk/spd/def from enemy HP >= 75% with Sealed Falchion.<br>";
		}
		//Peri's Lance
		if(this.hasExactly("Peri's Lance") && this.combatStartHp / this.maxHp < 1 && this.rValue == 5){
			var buffVal = 4;
			this.combatSpur.atk += buffVal;
			this.combatSpur.spd += buffVal;
			this.combatSpur.def += buffVal;
			this.combatSpur.res += buffVal;
			boostText += this.name + " gets +4 to all stats from HP < 100% with Peri's Lance.<br>";
		}
		if(this.hasExactly("Fell Breath")){
			if(enemy.combatStartHp / enemy.maxHp < 1 || (this.rValue > 0 && allStats[16] > allStats[20])){
				this.combatSpur.atk += 6;
				this.combatSpur.res += 6;
				var rAdd = "";
				if(this.rValue > 0 && allStats[16] > allStats[20]){
					rAdd = "or having more atk than " + enemy.name + " ";
				}
				boostText += this.name + " gets +6 atk and res from enemy HP < 100% " + rAdd + "with Fell Breath.<br>";
			}
			if(this.rValue == 5 && (this.initiator || this.toggle.weapon == 1)){
				this.combatSpur.atk += 5;
				enemy.combatSpur.atk -= 5;
				boostText += this.name + " gets +5 atk and inflicts -5 atk to " + enemy.name + " from initiating or being within 2 spaces of an ally with Fell Breath.<br>";
			}
		}
			
		//Loptous mechanic.  No combat spur debuff, simply make it negative.
		if(enemy.hasExactly("Loptous") && (this.effMod(enemy, currTurn) == 1 || this.has("Poison Dagger"))){
			this.combatSpur.atk -= 6;
			if(enemy.rValue > 0){
				this.combatSpur.res -= 6;
				boostText += this.name + " gets -6 atk and res from " + enemy.name + " wielding Loptous.<br>";
			}
			else{
				boostText += this.name + " gets -6 atk from " + enemy.name + " wielding Loptous.<br>";
			}
		}
		
		//Ragnarok.  Both refined and unrefined
		if(this.hasExactly("Ragnarok")){
			if(this.rValue > 0 || this.combatStartHp / this.maxHp >= 1){
				this.combatSpur.atk += 5;
				this.combatSpur.spd += 5;
				boostText += this.name + " gets +5 atk and spd with Ragnarok.<br>";
			}
		}
		
		//Gae Bolg
		if(this.hasExactly("Gae Bolg") && enemy.moveType != "flying"){
			var buffVal = 5;
			this.combatSpur.atk += buffVal;
			this.combatSpur.def += buffVal;
			boostText += this.name + " gets +5 to atk and def with Gae Bolg.<br>";
		}
		if(this.hasExactly("Gae Bolg") && this.rValue == 5 && this.toggle.weapon == 1){
			var buffVal = 5;
			this.combatSpur.atk += buffVal;
			this.combatSpur.def += buffVal;
			boostText += this.name + " gets +5 to atk and def from having a sword/lance/axe/cavalry ally with Gae Bolg.<br>";
		}
		
		//Joint Drive Skills
		if((this.hasExactly("Joint Drive Atk") || this.hasExactly("Opening Retainer")) && this.buddy.adjacent + this.buddy.two > 0){
			this.combatSpur.atk += 4;
			boostText += this.name + " gets +4 to atk from being within 2 spaces of an ally with " + data.skills[this.cIndex].name + ".<br>";
		}
		if(this.hasExactly("Joint Drive Spd") && this.buddy.adjacent + this.buddy.two > 0){
			this.combatSpur.spd += 4;
			boostText += this.name + " gets +4 to spd from being within 2 spaces of an ally with " + data.skills[this.cIndex].name + ".<br>";
		}
		if(this.hasExactly("Joint Drive Res") && this.buddy.adjacent + this.buddy.two > 0){
			this.combatSpur.res += 4;
			boostText += this.name + " gets +4 to res from being within 2 spaces of an ally with " + data.skills[this.cIndex].name + ".<br>";
		}
		if(this.hasExactly("Joint Drive Def") && this.buddy.adjacent + this.buddy.two > 0){
			this.combatSpur.def += 4;
			boostText += this.name + " gets +4 to def from being within 2 spaces of an ally with " + data.skills[this.cIndex].name + ".<br>";
		}
		if(this.hasExactly("Joint Dist Guard") && (this.buddy.adjacent > 0 || this.buddy.two > 0) && enemy.range == "ranged"){
			this.combatSpur.def += 4;
			this.combatSpur.res += 4;
			boostText += this.name + " gets +4 to def and res from being within 2 spaces of an ally with " + data.skills[this.cIndex].name + ".<br>";
		}
		if(this.hasExactly("Joint Close Guard") && (this.buddy.adjacent > 0 || this.buddy.two > 0) && enemy.range == "melee"){
			this.combatSpur.def += 4;
			this.combatSpur.res += 4;
			boostText += this.name + " gets +4 to def and res from being within 2 spaces of an ally with " + data.skills[this.cIndex].name + ".<br>";
		}
		if((this.hasExactly("Open Retainer+") || this.hasExactly("Divine God Fang") || this.hasExactly("Love for All!")) && this.buddy.adjacent + this.buddy.two + this.buddy.three > 0){
			this.combatSpur.atk += 5;
			this.combatSpur.spd += 5;
			this.combatSpur.def += 5;
			this.combatSpur.res += 5;
			boostText += this.name + " gets +5 to all stats from being within 3 spaces of an ally with " + data.skills[this.cIndex].name + ".<br>";
		}
		if(this.hasExactly("Holy Ground+") && this.buddy.adjacent + this.buddy.two + this.buddy.three > 0){
			this.combatSpur.atk += 5;
			this.combatSpur.spd += 5;
			this.combatSpur.res += 5;
			boostText += this.name + " gets +5 to atk/spd/res from being within 3 spaces of an ally with " + data.skills[this.cIndex].name + ".<br>";
		}
		
		//Save Skills
		if(this.has("DR Near Save") && this.toggle.c == 1 && enemy.range == "melee" && !this.initiator){
			var buffVal = this.has("DR Near Save");
			if(buffVal == 3){
				buffVal++;
			}
			this.combatSpur.def += buffVal;
			this.combatSpur.res += buffVal;
			boostText += this.name + " gets +" + buffVal + " to def and res from triggering Savior on ally with " + data.skills[this.cIndex].name + ".<br>";
		}
		if(this.has("AR Far Save") && this.toggle.c == 1 && enemy.range == "ranged" && !this.initiator){
			var buffVal = this.has("AR Far Save");
			if(buffVal == 3){
				buffVal++;
			}
			this.combatSpur.atk += buffVal;
			this.combatSpur.res += buffVal;
			boostText += this.name + " gets +" + buffVal + " to atk and res from triggering Savior on ally with " + data.skills[this.cIndex].name + ".<br>";
		}
		if(this.has("AD Near Save") && this.toggle.c == 1 && enemy.range == "melee" && !this.initiator){
			var buffVal = this.has("AD Near Save");
			if(buffVal == 3){
				buffVal++;
			}
			this.combatSpur.atk += buffVal;
			this.combatSpur.def += buffVal;
			boostText += this.name + " gets +" + buffVal + " to atk and def from triggering Savior on ally with " + data.skills[this.cIndex].name + ".<br>";
		}
		if(this.has("AR Near Save") && this.toggle.c == 1 && enemy.range == "melee" && !this.initiator){
			var buffVal = this.has("AR Near Save");
			if(buffVal == 3){
				buffVal++;
			}
			this.combatSpur.atk += buffVal;
			this.combatSpur.res += buffVal;
			boostText += this.name + " gets +" + buffVal + " to atk and res from triggering Savior on ally with " + data.skills[this.cIndex].name + ".<br>";
		}
		if(this.has("DR Far Save") && this.toggle.c == 1 && enemy.range == "ranged" && !this.initiator){
			var buffVal = this.has("DR Far Save");
			if(buffVal == 3){
				buffVal++;
			}
			this.combatSpur.def += buffVal;
			this.combatSpur.res += buffVal;
			boostText += this.name + " gets +" + buffVal + " to def and res from triggering Savior on ally with " + data.skills[this.cIndex].name + ".<br>";
		}
		if(this.has("AD Far Save") && this.toggle.c == 1 && enemy.range == "ranged" && !this.initiator){
			var buffVal = this.has("AD Far Save");
			if(buffVal == 3){
				buffVal++;
			}
			this.combatSpur.atk += buffVal;
			this.combatSpur.def += buffVal;
			boostText += this.name + " gets +" + buffVal + " to atk and def from triggering Savior on ally with " + data.skills[this.cIndex].name + ".<br>";
		}
		if(this.has("AS Near Save") && this.toggle.c == 1 && enemy.range == "melee" && !this.initiator){
			var buffVal = this.has("AS Near Save");
			if(buffVal == 3){
				buffVal++;
			}
			this.combatSpur.atk += buffVal;
			this.combatSpur.spd += buffVal;
			boostText += this.name + " gets +" + buffVal + " to atk and spd from triggering Savior on ally with " + data.skills[this.cIndex].name + ".<br>";
		}
		if(this.has("AS Far Save") && this.toggle.c == 1 && enemy.range == "ranged" && !this.initiator){
			var buffVal = this.has("AS Far Save");
			if(buffVal == 3){
				buffVal++;
			}
			this.combatSpur.atk += buffVal;
			this.combatSpur.spd += buffVal;
			boostText += this.name + " gets +" + buffVal + " to atk and spd from triggering Savior on ally with " + data.skills[this.cIndex].name + ".<br>";
		}
		if(this.hasExactly("With Everyone 2") && this.toggle.c == 1 && enemy.range == "ranged" && !this.initiator){
			this.combatSpur.atk += 4;
			this.combatSpur.spd += 4;
			this.combatSpur.def += 4;
			this.combatSpur.res += 4;
			boostText += this.name + " gets +4 to all stats from triggering Savior on ally with " + data.skills[this.cIndex].name + ".<br>";
		}
		if(this.hasExactly("Darkling Dragon") && this.toggle.c > 1 && enemy.range == "ranged" && !this.initiator){
			this.combatSpur.atk += 4;
			this.combatSpur.def += 4;
			this.combatSpur.res += 4;
			boostText += this.name + " gets +4 to atk/def/res from triggering Savior on ally with " + data.skills[this.cIndex].name + ".<br>";
		}
		if(this.has("Twin N Save") && enemy.range == "melee"){
			var tnoStat = "";
			var tntStat = "";
			if(this.hasExactly("DR Twin N Save")){
				tnoStat = "def";
				tntStat = "res";
			}
			else if(this.hasExactly("AD Twin N Save")){
				tnoStat = "atk";
				tntStat = "def";
			}
			else if(this.hasExactly("AR Twin N Save")){
				tnoStat = "atk";
				tntStat = "res";
			}
			this.combatSpur[tnoStat] += 4;
			this.combatSpur[tntStat] += 4;
			boostText += this.name + " gets +4 to " + tnoStat + " & " + tntStat + " from enemy range = 1 with " + data.skills[this.cIndex].name + ".<br>";
		}
		if(this.has("Twin F Save") && enemy.range == "ranged"){
			var tnoStat = "";
			var tntStat = "";
			if(this.hasExactly("AR Twin F Save")){
				tnoStat = "atk";
				tntStat = "res";
			}
			else if(this.hasExactly("AD Twin F Save")){
				tnoStat = "atk";
				tntStat = "def";
			}
			
			this.combatSpur[tnoStat] += 4;
			this.combatSpur[tntStat] += 4;
			boostText += this.name + " gets +4 to " + tnoStat + " & " + tntStat + " from enemy range = 2 with " + data.skills[this.cIndex].name + ".<br>";
		}
		if(this.has("Briar F Save") && enemy.range == "ranged"){
			var tnoStat = "";
			var tntStat = "";
			if(this.hasExactly("AD Briar F Save")){
				tnoStat = "atk";
				tntStat = "def";
			}
			
			this.combatSpur[tnoStat] += 4;
			this.combatSpur[tntStat] += 4;
			boostText += this.name + " gets +4 to " + tnoStat + " & " + tntStat + " from enemy range = 2 with " + data.skills[this.cIndex].name + ".<br>";
		}
		if(this.hasExactly("Higher Ground") && enemy.range == "ranged"){
			this.combatSpur.def += 4;
			this.combatSpur.res += 4;
			boostText += this.name + " gets +4 to def & res from enemy range = 2 with " + data.skills[this.cIndex].name + ".<br>";
		}
		if(this.hasExactly("Lower Ground") && enemy.range == "melee"){
			this.combatSpur.def += 4;
			this.combatSpur.res += 4;
			boostText += this.name + " gets +4 to def & res from enemy range = 1 with " + data.skills[this.cIndex].name + ".<br>";
		}
		if(this.hasExactly("Res Scowl Echo") && (!this.initiator || enemy.combatStartHp / enemy.maxHp >= 0.75)){
			this.combatSpur.res += 4;
			boostText += this.name + " gets +4 to res from enemy initiating or enemy HP >= 75% with Res Scowl Echo.<br>";
		}
		
		//Following cluster of skills are "negative" spurs
		//Book Of Shadows
		if(this.hasExactly("Book Of Shadows") && this.toggle.weapon == 1){
			enemy.combatSpur.atk -= 4;
			enemy.combatSpur.spd -= 4;
			enemy.combatSpur.def -= 4;
			enemy.combatSpur.res -= 4;
			skillName = data.skills[this.weaponIndex].name;
			boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -4 to all stats.<br>";
		}
		//Tharja's Hex
		if(this.hasExactly("Tharja's Hex") && this.rValue == 5){
			enemy.combatSpur.atk -= 4;
			enemy.combatSpur.spd -= 4;
			skillName = data.skills[this.weaponIndex].name;
			boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -4 to atk and spd.<br>";
		}
		//Cavalry Beast weapons
		if(this.moveType == "cavalry" && this.weaponType == "beast" && this.transform == true){
			if(data.skills[this.weaponIndex].skill_id > 3666 || (data.skills[this.weaponIndex].skill_id == 2418 && this.rValue > 0)){
				var adVal = this.prfVal + 3;
				enemy.combatSpur.atk -= adVal;
				enemy.combatSpur.def -= adVal;
				skillName = data.skills[this.weaponIndex].name;
				boostText += this.name + " has activated transformed " + skillName + ". Effect on " + enemy.name + ": -" + adVal + " to atk and def.<br>";
			}
			else if(this.initiator){
				enemy.combatSpur.atk -= 4;
				enemy.combatSpur.def -= 4;
				skillName = data.skills[this.weaponIndex].name;
				boostText += this.name + " has activated transformed " + skillName + ". Effect on " + enemy.name + ": -4 to atk and def.<br>";
			}
		}
		//Renowned Bow
		if(this.hasExactly("Renowned Bow") && this.rValue == 5){
			enemy.combatSpur.atk -= 4;
			enemy.combatSpur.def -= 4;
			skillName = data.skills[this.weaponIndex].name;
			boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -4 to atk and def.<br>";
		}
		//Guardian's Axe/Dark Royal Spear - Refined
		if((this.hasExactly("Guardian's Axe") || this.hasExactly("Dark Royal Spear")) && this.rValue == 5){
			enemy.combatSpur.atk -= 3;
			enemy.combatSpur.def -= 3;
			skillName = data.skills[this.weaponIndex].name;
			boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -3 to atk and def.<br>";
		}
		//Sun Dragonstone - Refined
		if(this.hasExactly("Sun Dragonstone") && this.rValue == 5){
			enemy.combatSpur.atk -= 3;
			enemy.combatSpur.spd -= 3;
			skillName = data.skills[this.weaponIndex].name;
			boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -3 to atk and spd.<br>";
		}
		//Beruka's Axe
		if(this.hasExactly("Beruka's Axe") && this.rValue == 5){
			enemy.combatSpur.atk -= 4;
			skillName = data.skills[this.weaponIndex].name;
			boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -4 to atk.<br>";
		}
		//Fox Tomes and Jakob's Tray
		if((this.has("Raudrfox") || this.has("Blarfox") || this.has("Gronnfox") || this.has("Helmsman Axe") || this.hasExactly("Jakob's Tray")) && this.initiator){
			enemy.combatSpur.atk -= 4;
			enemy.combatSpur.spd -= 4;
			enemy.combatSpur.def -= 4;
			enemy.combatSpur.res -= 4;
			skillName = data.skills[this.weaponIndex].name;
			boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -4 to all stats.<br>";
		}
		if(this.has("Light and Dark")){
			var buffVal = 2;
			if(this.hasExactly("Light and Dark 2")){
				buffVal = 5;
				if(this.penalty.panic){
					this.combatBuffs = {"atk":0,"spd":0,"def":0,"res":0};
					this.buffs = {"atk":0,"spd":0,"def":0,"res":0};
				}
				this.combatDebuffs = {"atk":0,"spd":0,"def":0,"res":0};
				this.debuffs = {"atk":0,"spd":0,"def":0,"res":0};
				boostText += this.name + " neutralizes penalties with Light and Dark 2.<br>";
			}
			enemy.combatSpur.atk -= buffVal;
			enemy.combatSpur.spd -= buffVal;
			enemy.combatSpur.def -= buffVal;
			enemy.combatSpur.res -= buffVal;
			skillName = data.skills[this.bIndex].name;
			boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -" + buffVal + " to all stats.<br>";
		}
		if(this.has("Killing Intent") && (enemy.combatStartHp / enemy.maxHp < 1 || this.toggle.b > 0)){
			enemy.combatSpur.spd -= 5;
			enemy.combatSpur.res -= 5;
			skillName = data.skills[this.bIndex].name;
			boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -5 to spd and res.<br>";
		}
		//Corvus Tome
		if(this.hasExactly("Corvus Tome") && allStats[20] >= allStats[16] + 3 && this.rValue == 5){
			enemy.combatSpur.atk -= 6;
			enemy.combatSpur.res -= 6;
			skillName = data.skills[this.weaponIndex].name;
			boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -6 to atk and res.<br>";
		}
		if(this.hasExactly("Mirage Rod")){
			enemy.combatSpur.atk -= 6;
			enemy.combatSpur.res -= 6;
			skillName = data.skills[this.weaponIndex].name;
			boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -6 to atk and res.<br>";
			if(this.rValue == 5 && (!this.initiator || enemy.combatStartHp / enemy.maxHp >= 0.75)){
				enemy.combatSpur.atk -= 5;
				enemy.combatSpur.res -= 5;
				boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -5 to atk and res.<br>";
			}
		}
		//Deadly Balance
		if(this.hasExactly("Deadly Balance") && (this.combatStartHp / this.maxHp >= 0.5 || this.toggle.b == 1)){
			enemy.combatSpur.atk -= 5;
			enemy.combatSpur.def -= 5;
			boostText += this.name + " has activated Deadly Balance. Effect on " + enemy.name + ": -5 to atk and def.<br>";
		}
		if(this.hasExactly("Thorn Lance")){
			if(allStats[16] > allStats[20] || (this.rValue > 0 && this.combatStartHp / this.maxHp >= 0.25)){
				enemy.combatSpur.atk -= 6;
				enemy.combatSpur.def -= 6;
				skillName = data.skills[this.weaponIndex].name;
				boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -6 to atk and def.<br>";
			}
			if(this.rValue == 5 && (!this.initiator || enemy.combatStartHp / enemy.maxHp >= 0.75)){
				enemy.combatSpur.atk -= 5;
				enemy.combatSpur.def -= 5;
				skillName = data.skills[this.weaponIndex].name;
				boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -5 to atk and def.<br>";
				var tlVal = Math.floor(this.prfVal * 0.5);
				enemy.combatSpur.atk -= tlVal;
				this.combatSpur.atk += tlVal;
				boostText += this.name + " gets +" + tlVal + " to atk and inflicts -" + tlVal + " atk to " + enemy.name + " from enemy initiating or enemy HP >= 75% with Thorn Lance.<br>";
			}
		}
		//Thunderhead
		if(this.hasExactly("Thunderhead") && this.rValue == 5){
			enemy.combatSpur.spd -= 5;
			enemy.combatSpur.res -= 5;
			skillName = data.skills[this.weaponIndex].name;
			boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -5 to spd & res.<br>";
		}
		//Belief in Love
		if(this.hasExactly("Belief in Love") && (enemy.combatStartHp / enemy.maxHp >= 1 || !this.initiator)){
			enemy.combatSpur.atk -= 5;
			enemy.combatSpur.def -= 5;
			boostText += this.name + " has activated Belief in Love. Effect on " + enemy.name + ": -5 to atk & def.<br>";
		}
		if(this.hasExactly("Aymr")){
			if(this.toggle.weapon == 1 || (this.rValue > 0 && !this.initiator)){
				enemy.combatSpur.atk -= 6;
				enemy.combatSpur.def -= 6;
				skillName = data.skills[this.weaponIndex].name;
				boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -6 to atk & def.<br>";
			}
			if(this.rValue == 5 && (enemy.combatStartHp / enemy.maxHp >= 0.75 || this.toggle.weapon == 1)){
				enemy.combatSpur.atk -= 5;
				enemy.combatSpur.def -= 5;
				skillName = data.skills[this.weaponIndex].name;
				boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -5 to atk & def.<br>";
			}
		}
		if(this.hasExactly("Gurgurant")){
			enemy.combatSpur.atk -= 5;
			enemy.combatSpur.def -= 5;
			skillName = data.skills[this.weaponIndex].name;
			boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -5 to atk & def.<br>";
			if(this.rValue == 5 && (!this.initiator || enemy.combatStartHp / enemy.maxHp >= 0.75)){
				var gVal = Math.floor(allStats[18] * 0.15) + 5;
				enemy.combatSpur.atk -= gVal;
				enemy.combatSpur.def -= gVal;
				boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -" + gVal + " to atk & def.<br>";
			}
		}
		//Stalwart Sword
		if(this.hasExactly("Stalwart Sword") && !this.initiator){
			enemy.combatSpur.atk -= 6;
			skillName = data.skills[this.weaponIndex].name;
			boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -6 to atk.<br>";
		}
		if(this.hasExactly("Flower of Ease")){
			if(this.toggle.weapon == 1){
				var feVal = 3;
				if(this.rValue > 0){
					feVal++;
				}
				enemy.combatSpur.atk -= feVal;
				enemy.combatSpur.def -= feVal;
				enemy.combatSpur.res -= feVal;
				skillName = data.skills[this.weaponIndex].name;
				boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -" + feVal + " to atk/def/res.<br>";
			}
			if(this.rValue > 0 && (enemy.combatStartHp / enemy.maxHp >= 0.75 || this.toggle.weapon == 1)){
				enemy.combatSpur.atk -= 5;
				enemy.combatSpur.def -= 5;
				skillName = data.skills[this.weaponIndex].name;
				boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -5 to atk & def.<br>";
			}
			if(this.rValue == 5 && this.combatStartHp / this.maxHp >= 0.25){
				enemy.combatSpur.atk -= 5;
				enemy.combatSpur.def -= 5;
				skillName = data.skills[this.weaponIndex].name;
				boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -5 to atk & def.<br>";
			}
		}
		//Summer Passing weapons & Rein Bow
		if(this.has("Coral Bow") || this.has("Rein Bow") || this.has("Rein Axe") || this.has("Rein Sword") || this.has("Rein Lance")){
			enemy.combatSpur.spd -= 5;
			enemy.combatSpur.def -= 5;
			skillName = data.skills[this.weaponIndex].name;
			boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -5 to spd and def.<br>";
		}
		if(this.has("Flora Guide")){
			enemy.combatSpur.spd -= 5;
			enemy.combatSpur.res -= 5;
			skillName = data.skills[this.weaponIndex].name;
			boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -5 to spd and res.<br>";
		}
		if(this.has("Palm Staff")){
			enemy.combatSpur.atk -= 5;
			enemy.combatSpur.spd -= 5;
			skillName = data.skills[this.weaponIndex].name;
			boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -5 to atk and spd.<br>";
		}
		if(this.hasExactly("Virtuous Tyrfing")){
			if((this.combatStartHp / this.maxHp < 1 || !this.initiator) || (this.rValue > 0 && enemy.combatStartHp / enemy.maxHp >= 0.75)){
				enemy.combatSpur.atk -= 6;
				enemy.combatSpur.def -= 6;
				skillName = data.skills[this.weaponIndex].name;
				boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -6 to atk & def.<br>";
			}
			if(this.rValue == 5 && (this.initiator || this.toggle.weapon == 1)){
				enemy.combatSpur.atk -= 5;
				enemy.combatSpur.def -= 5;
				skillName = data.skills[this.weaponIndex].name;
				boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -5 to atk & def.<br>";
			}
		}
		if((this.has("Helm Bow") || this.has("Unbound Bow")) && this.toggle.weapon == 1){
			var skillName = data.skills[this.weaponIndex].name;
			enemy.combatSpur.spd -= 5;
			enemy.combatSpur.def -= 5;
			boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -5 to spd and def.<br>";
		}
		if((this.has("Flowing Lance") || this.has("Deck Swabber") || this.has("Unbound Blade") || this.has("Unbound Axe") || this.has("Unbound Lance")) && this.buddy.adjacent == 0){
			var skillName = data.skills[this.weaponIndex].name;
			enemy.combatSpur.atk -= 5;
			enemy.combatSpur.def -= 5;
			boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -5 to atk and def.<br>";
		}
		if(this.hasExactly("Effie's Lance") && this.rValue == 5 && this.toggle.weapon == 1){
			var skillName = data.skills[this.weaponIndex].name;
			enemy.combatSpur.atk -= 5;
			enemy.combatSpur.def -= 5;
			boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -5 to atk and def.<br>";
		}
		if(this.hasExactly("Flower Hauteclere")){
			if(this.combatStartHp / this.maxHp >= 0.25){
				enemy.combatSpur.atk -= 6;
				enemy.combatSpur.def -= 6;
				skillName = data.skills[this.weaponIndex].name;
				boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -6 to atk and def.<br>";
			}
			if(this.rValue == 5 && this.toggle.weapon > 0){
				var moveVal = this.toggle.weapon - 1;
				var buffVal = moveVal * 2 + 3;
				this.combatSpur.atk += buffVal;
				this.combatSpur.def += buffVal;
				this.combatSpur.res += buffVal;
				boostText += this.name + " gets +" + buffVal + " atk/def/res from unit or enemy initiating after moving " + moveVal + " space(s) with Flower Hauteclere.<br>";
				enemy.combatSpur.atk -= 6;
				enemy.combatSpur.def -= 6;
				skillName = data.skills[this.weaponIndex].name;
				boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -6 to atk and def.<br>";
			}
		}
		//Refined Hlidskjalf
		if(this.hasExactly("Hlidskjalf") && this.rValue == 5){
			enemy.combatSpur.def -= 3;
			enemy.combatSpur.res -= 3;
			skillName = data.skills[this.weaponIndex].name;
			boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -3 to def and res.<br>";
		}
		if(this.hasExactly("Flame Lance")){
			if(this.combatStartHp / this.maxHp >= 0.5 || (this.rValue > 0 && this.combatStartHp / this.maxHp >= 0.25)){
				var flText = "";
				enemy.combatSpur.spd -= 5;
				enemy.combatSpur.res -= 5;
				if(this.rValue > 0){
					enemy.combatSpur.atk -= 4;
					flText = " & -4 to atk";
				}
				skillName = data.skills[this.weaponIndex].name;
				boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -5 to spd & res" + flText + ".<br>";
			}
			if(this.rValue == 5 && (this.initiator || this.buddy.adjacent < 2)){
				enemy.combatSpur.atk -= 4;
				enemy.combatSpur.spd -= 4;
				enemy.combatSpur.res -= 4;
				skillName = data.skills[this.weaponIndex].name;
				boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -4 to atk/spd/res.<br>";
				var dAtk = Math.max(enemy.combatBuffs.atk,enemy.buffs.atk) * -2;
				var dSpd = Math.max(enemy.combatBuffs.spd,enemy.buffs.spd) * -2;
				var dRes = Math.max(enemy.combatBuffs.res,enemy.buffs.res) * -2;
				if(enemy.penalty.panic){
					dAtk = 0;
					dSpd = 0;
					dRes = 0;
				}
				enemy.combatSpur.atk += dAtk;
				enemy.combatSpur.spd += dSpd;
				enemy.combatSpur.res += dRes;
				boostText += this.name + " inflicts " + dAtk + "/" + dSpd + "/" + dRes + " in stats to " + enemy.name + " from enemy buffs with " + skillName + ".<br>";
			}
		}
		//Blackfire Breath
		if(this.has("Blackfire Breath") && this.toggle.weapon == 1){
			enemy.combatSpur.atk -= 5;
			enemy.combatSpur.res -= 5;
			skillName = data.skills[this.weaponIndex].name;
			boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -5 to atk and res.<br>";
		}
		//Obsessive Curse
		if(this.hasExactly("Obsessive Curse")){
			enemy.combatSpur.spd -= 5;
			enemy.combatSpur.res -= 5;
			skillName = data.skills[this.weaponIndex].name;
			boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -5 to spd and res.<br>";
		}
		//Elise's Staff
		if(this.hasExactly("Elise's Staff") && this.initiator && this.rValue == 5){
			enemy.combatSpur.atk -= 4;
			enemy.combatSpur.spd -= 4;
			enemy.combatSpur.def -= 4;
			enemy.combatSpur.res -= 4;
			skillName = data.skills[this.weaponIndex].name;
			boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -4 to all stats.<br>";
		}
		//Refined Eternal Breath
		if(this.hasExactly("Eternal Breath") && this.rValue == 5 && (this.toggle.weapon == 2 || this.toggle.weapon == 3 || checkAllBuffs(this, enemy, currTurn))){
			enemy.combatSpur.atk -= 4;
			enemy.combatSpur.res -= 4;
			skillName = data.skills[this.weaponIndex].name;
			boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -4 to atk and res.<br>";
		}
		if(this.hasExactly("Obsidian Lance")){
			skillName = data.skills[this.weaponIndex].name;
			if(this.buddy.adjacent == 0 || (this.rValue > 0 && (enemy.combatStartHp / enemy.maxHp >= 0.75 || this.buddy.adjacent < 2))){
				enemy.combatSpur.atk -= 6;
				enemy.combatSpur.def -= 6;
				boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -6 to atk & def.<br>";
			}
			if(this.rValue == 5){
				enemy.combatSpur.atk -= 5;
				enemy.combatSpur.def -= 5;
				boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -5 to atk & def.<br>";
				if(this.combatStartHp / this.maxHp >= 0.25){
					enemy.combatSpur.atk -= 6;
					enemy.combatSpur.def -= 6;
					boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -6 to atk & def.<br>";
				}
			}
		}
		//First-Dream Bow
		if(this.hasExactly("First-Dream Bow")){
			enemy.combatSpur.atk -= 4;
			skillName = data.skills[this.weaponIndex].name;
			boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -4 to atk.<br>";
		}
		//Renewed Fang
		if(this.hasExactly("Renewed Fang") && this.toggle.weapon == 1){
			enemy.combatSpur.atk -= 6;
			enemy.combatSpur.spd -= 6;
			skillName = data.skills[this.weaponIndex].name;
			boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -6 to atk and spd.<br>";
		}
		//Plegian weapons
		if((this.has("Plegian Torch") || this.has("Hvitrvulture") || this.has("Raudrvulture") || this.has("Gronnvulture") || this.has("Blarvulture")) && this.toggle.weapon == 1){
			var eNegate = this.checkNegate(enemy, currTurn);
			var dAtk = -5;
			var dRes = -5;
			if(eNegate[0] == false){
				dAtk += Math.min(enemy.combatDebuffs.atk,enemy.debuffs.atk);
				if(enemy.penalty.panic){
					dAtk -= Math.max(enemy.combatBuffs.atk,enemy.buffs.atk);
				}
			}
			if(eNegate[3] == false){
				dRes += Math.min(enemy.combatDebuffs.res,enemy.debuffs.res);
				if(enemy.penalty.panic){
					dRes -= Math.max(enemy.combatBuffs.res,enemy.buffs.res);
				}
			}
			enemy.combatSpur.atk += dAtk;
			enemy.combatSpur.res += dRes;
			boostText += this.name + " inflicts " + dAtk + " atk and " + dRes + " res on " + enemy.name + " from not being adjacent to an ally with " + data.skills[this.weaponIndex].name + ".<br>";
		}
		if((this.has("Plegian Bow") || this.has("Plegian Axe") || this.has("Vulture Blade") || this.has("Vulture Axe") || this.has("Vulture Lance") || this.has("Vulture Bow")) && this.toggle.weapon == 1){
			var eNegate = this.checkNegate(enemy, currTurn);
			var dAtk = -5;
			var dDef = -5;			
			if(eNegate[0] == false){
				dAtk += Math.min(enemy.combatDebuffs.atk,enemy.debuffs.atk);
				if(enemy.penalty.panic){
					dAtk -= Math.max(enemy.combatBuffs.atk,enemy.buffs.atk);
				}
			}
			if(eNegate[2] == false){
				dDef += Math.min(enemy.combatDebuffs.def,enemy.debuffs.def);
				if(enemy.penalty.panic){
					dDef -= Math.max(enemy.combatBuffs.def,enemy.buffs.def);
				}
			}			
			enemy.combatSpur.atk += dAtk;
			enemy.combatSpur.def += dDef;
			boostText += this.name + " inflicts " + dAtk + " atk and " + dDef + " def on " + enemy.name + " from not being adjacent to an ally with " + data.skills[this.weaponIndex].name + ".<br>";
		}
		if(this.hasExactly("Fell Flambeau") && this.toggle.weapon == 1){
			var eNegate = this.checkNegate(enemy, currTurn);
			var dAtk = -5;
			var dSpd = -5;
			var dDef = -5;
			var dRes = -5;
			if(eNegate[0] == false){
				dAtk += Math.min(enemy.combatDebuffs.atk,enemy.debuffs.atk);
				if(enemy.penalty.panic){
					dAtk -= Math.max(enemy.combatBuffs.atk,enemy.buffs.atk);
				}
			}
			if(eNegate[1] == false){
				dSpd += Math.min(enemy.combatDebuffs.spd,enemy.debuffs.spd);
				if(enemy.penalty.panic){
					dSpd -= Math.max(enemy.combatBuffs.spd,enemy.buffs.spd);
				}
			}
			if(eNegate[2] == false){
				dDef += Math.min(enemy.combatDebuffs.def,enemy.debuffs.def);
				if(enemy.penalty.panic){
					dDef -= Math.max(enemy.combatBuffs.def,enemy.buffs.def);
				}
			}
			if(eNegate[3] == false){
				dRes += Math.min(enemy.combatDebuffs.res,enemy.debuffs.res);
				if(enemy.penalty.panic){
					dRes -= Math.max(enemy.combatBuffs.res,enemy.buffs.res);
				}
			}
			enemy.combatSpur.atk += dAtk;
			enemy.combatSpur.spd += dSpd;
			enemy.combatSpur.def += dDef;
			enemy.combatSpur.res += dRes;
			boostText += this.name + " inflicts " + dAtk + " atk/" + dSpd + " spd/" + dDef + " def/" + dRes + " res on " + enemy.name + " from not being adjacent to an ally with " + data.skills[this.weaponIndex].name + ".<br>";
		}
		//Refined Warrior Princess
		if(this.hasExactly("Warrior Princess") && this.rValue == 5){
			enemy.combatSpur.atk -= 4;
			enemy.combatSpur.spd -= 4;
			enemy.combatSpur.def -= 4;
			skillName = data.skills[this.weaponIndex].name;
			boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -4 to atk/spd/def.<br>";
		}
		//Loyalist Axe & Sea-Sear Lance
		if((this.hasExactly("Loyalist Axe") || this.hasExactly("Sea-Sear Lance")) && (!this.initiator || enemy.combatStartHp / enemy.maxHp >= 0.75)){
			enemy.combatSpur.atk -= 6;
			enemy.combatSpur.def -= 6;
			skillName = data.skills[this.weaponIndex].name;
			boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -6 to atk and def.<br>";
		}
		//Love of a King weapons
		if((this.has("Unity Blooms") || this.has("Amity Blooms") || this.has("Pact Blooms")) && this.toggle.weapon == 1){
			enemy.combatSpur.atk -= 5;
			enemy.combatSpur.res -= 5;
			skillName = data.skills[this.weaponIndex].name;
			boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -5 to atk and res.<br>";
		}
		if(this.hasExactly("Sparking Tome")){
			if(enemy.combatStartHp / enemy.maxHp >= 0.5 || (this.rValue > 0 && this.initiator)){
				var stText = "";
				var dSpd = -6;
				var dRes = -6;
				if(!enemy.penalty.panic){
					dSpd += Math.max(enemy.combatBuffs.spd,enemy.buffs.spd) * -2;
					dRes += Math.max(enemy.combatBuffs.res,enemy.buffs.res) * -2;
				}
				enemy.combatSpur.spd += dSpd;
				enemy.combatSpur.res += dRes;
				if(this.rValue > 0){
					var dAtk= -5;
					if(!enemy.penalty.panic){
						dAtk += Math.max(enemy.combatBuffs.atk,enemy.buffs.atk) * -2;
					}
					enemy.combatSpur.atk += dAtk;
					stText = dAtk + " atk/";
				}
				boostText += this.name + " has activated Sparking Tome. Effect on " + enemy.name + ": " + stText + dSpd + " spd/" + dRes + " res.<br>";
			}
			if(this.rValue == 5 && (this.initiator || this.buddy.adjacent > 0 || this.buddy.two > 0)){
				enemy.combatSpur.atk -= 5;
				enemy.combatSpur.spd -= 5;
				enemy.combatSpur.res -= 5;
				boostText += this.name + " has activated Sparking Tome. Effect on " + enemy.name + ": -5 to atk/spd/res.<br>";
			}
		}
		//Refined Grimoire
		if(this.hasExactly("Grimoire") && this.rValue == 5){
			enemy.combatSpur.atk -= 4;
			enemy.combatSpur.spd -= 4;
			enemy.combatSpur.res -= 4;
			skillName = data.skills[this.weaponIndex].name;
			boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -4 to atk/spd/res.<br>";
		}
		//Refined Naglfar
		if(this.hasExactly("Naglfar") && this.rValue == 5 && this.combatStartHp / this.maxHp >= 0.5){
			enemy.combatSpur.atk -= 4;
			enemy.combatSpur.res -= 4;
			skillName = data.skills[this.weaponIndex].name;
			boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -4 to atk and res.<br>";
		}
		//Icy Fimbulvetr
		if(this.hasExactly("Icy Fimbulvetr") && this.combatStartHp / this.maxHp >= 0.25){
			enemy.combatSpur.atk -= 6;
			enemy.combatSpur.res -= 6;
			skillName = data.skills[this.weaponIndex].name;
			boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -6 to atk and res.<br>";
		}
		//Refined Berserk Armads
		if(this.hasExactly("Berserk Armads") && this.rValue == 5 && (enemy.combatStartHp / enemy.maxHp >= 1 || !this.initiator)){
			enemy.combatSpur.atk -= 5;
			enemy.combatSpur.def -= 5;
			skillName = data.skills[this.weaponIndex].name;
			boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -5 to atk and def.<br>";
		}
		//Refined Siegfried
		if(this.hasExactly("Siegfried") && this.rValue == 5 && enemy.combatStartHp / enemy.maxHp >= 0.75){
			enemy.combatSpur.atk -= 5;
			enemy.combatSpur.def -= 5;
			skillName = data.skills[this.weaponIndex].name;
			boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -5 to atk and def.<br>";
		}
		if((this.hasExactly("Tome of Despair") || this.hasExactly("Brilliant Starlight")) && this.combatStartHp / this.maxHp >= 0.25){
			enemy.combatSpur.atk -= 6;
			enemy.combatSpur.res -= 6;
			skillName = data.skills[this.weaponIndex].name;
			boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -6 to atk and res.<br>";
		}
		//Axe of Despair
		if(this.hasExactly("Axe of Despair") && this.combatStartHp / this.maxHp >= 0.25){
			enemy.combatSpur.atk -= 6;
			enemy.combatSpur.def -= 6;
			skillName = data.skills[this.weaponIndex].name;
			boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -6 to atk and def.<br>";
		}
		//Twin-Crest Power
		if(this.hasExactly("Twin-Crest Power") && this.combatStartHp / this.maxHp >= 0.25){
			enemy.combatSpur.atk -= 6;
			enemy.combatSpur.def -= 6;
			skillName = data.skills[this.weaponIndex].name;
			boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -6 to atk and def.<br>";
		}
		//Refined Hoarfrost Knife and Stout Tomahawk
		if((this.hasExactly("Hoarfrost Knife") || this.hasExactly("Stout Tomahawk")) && this.rValue == 5 && (this.initiator || this.buddy.adjacent > 0 || this.buddy.two > 0)){
			enemy.combatSpur.atk -= 5;
			enemy.combatSpur.def -= 5;
			skillName = data.skills[this.weaponIndex].name;
			boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -5 to atk and def.<br>";
		}
		//Refined Masking Axe
		if(this.hasExactly("Masking Axe") && this.rValue == 5 && this.toggle.weapon == 1){
			enemy.combatSpur.atk -= 5;
			enemy.combatSpur.def -= 5;
			skillName = data.skills[this.weaponIndex].name;
			boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -5 to atk and def.<br>";
		}
		//Any Refined Blizzard
		if(this.hasExactly("Blizzard") && this.rValue > 0 && enemy.combatStartHp / enemy.maxHp >= 0.75){
			enemy.combatSpur.spd -= 4;
			enemy.combatSpur.res -= 4;
			skillName = data.skills[this.weaponIndex].name;
			boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -4 to spd and res.<br>";
		}
		//Frostbite Breath
		if(this.hasExactly("Frostbite Breath") && this.combatStartHp / this.maxHp >= 0.25){
			enemy.combatSpur.atk -= 5;
			enemy.combatSpur.spd -= 5;
			enemy.combatSpur.def -= 5;
			enemy.combatSpur.res -= 5;
			skillName = data.skills[this.weaponIndex].name;
			boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -5 to all stats.<br>";
		}
		//Refined Loyalty Spear
		if(this.hasExactly("Loyalty Spear") && this.rValue == 5 && this.combatStartHp / this.maxHp >= 0.25){
			enemy.combatSpur.atk -= 4;
			enemy.combatSpur.spd -= 4;
			enemy.combatSpur.def -= 4;
			skillName = data.skills[this.weaponIndex].name;
			boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -4 to atk/spd/def.<br>";
		}
		//Crossbones Claw
		if(this.hasExactly("Crossbones Claw") && this.toggle.weapon == 1){
			enemy.combatSpur.spd -= 6;
			enemy.combatSpur.def -= 6;
			skillName = data.skills[this.weaponIndex].name;
			boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -6 to spd and def.<br>";
		}
		if(this.hasExactly("Charging Horn")){
			if(this.toggle.weapon > 0){
				var cMod = this.toggle.weapon * 2;
				if(this.rValue > 0){
					cMod = this.toggle.weapon * 3;
				}
				enemy.combatSpur.atk -= cMod;
				enemy.combatSpur.res -= cMod;
				skillName = data.skills[this.weaponIndex].name;
				boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -" + cMod + " to atk and res.<br>";
			}
			if(this.rValue == 5 && this.combatStartHp / this.maxHp >= 0.25){
				enemy.combatSpur.atk -= 6;
				enemy.combatSpur.res -= 6;
				boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -6 to atk and res.<br>";
			}
		}
		//Refined Flame Siegmund
		if(this.hasExactly("Flame Siegmund") && this.rValue == 5 && this.combatStartHp / this.maxHp >= 0.25){
			enemy.combatSpur.atk -= 5;
			enemy.combatSpur.def -= 5;
			skillName = data.skills[this.weaponIndex].name;
			boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -5 to atk and def.<br>";
		}
		//Refined Muspell Fireposy
		if(this.hasExactly("Muspell Fireposy") && this.rValue == 5 && this.toggle.weapon > 0){
			var debuffVal = this.toggle.weapon * 2;
			debuffVal = Math.min(6,debuffVal);
			enemy.combatSpur.spd -= debuffVal;
			enemy.combatSpur.res -= debuffVal;
			skillName = data.skills[this.weaponIndex].name;
			boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -" + debuffVal + " to spd and res.<br>";
		}
		//Refined Loptous
		if(this.hasExactly("Loptous") && this.rValue == 5 && this.combatStartHp / this.maxHp >= 0.25){
			enemy.combatSpur.atk -= 5;
			enemy.combatSpur.res -= 5;
			skillName = data.skills[this.weaponIndex].name;
			boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -5 to atk and res.<br>";
		}
		if(this.hasExactly("Dazzling Breath")){
			skillName = data.skills[this.weaponIndex].name;
			if(!this.initiator || enemy.combatStartHp / enemy.maxHp >= 0.75){
				enemy.combatSpur.atk -= 5;
				enemy.combatSpur.spd -= 5;
				enemy.combatSpur.def -= 5;
				enemy.combatSpur.res -= 5;
				boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -5 to all stats.<br>";
			}
			if(this.rValue > 0){
				enemy.combatSpur.atk -= 5;
				enemy.combatSpur.spd -= 5;
				enemy.combatSpur.def -= 5;
				enemy.combatSpur.res -= 5;
				boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -5 to all stats.<br>";
			}
			if(this.rValue == 5 && this.buddy.adjacent + this.buddy.two + this.buddy.three > 0){
				enemy.combatSpur.atk -= 5;
				enemy.combatSpur.spd -= 5;
				enemy.combatSpur.def -= 5;
				enemy.combatSpur.res -= 5;
				boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -5 to all stats.<br>";
			}
		}
		//Refined Thunder Armads
		if(this.hasExactly("Thunder Armads") && this.rValue > 0 && this.toggle.weapon == 1){
			enemy.combatSpur.atk -= 5;
			enemy.combatSpur.def -= 5;
			skillName = data.skills[this.weaponIndex].name;
			boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -5 to atk and def.<br>";
		}
		if(this.hasExactly("Thunder Armads") && this.rValue == 5 && (!this.initiator || enemy.combatStartHp / enemy.maxHp >= 0.75)){
			enemy.combatSpur.atk -= 5;
			enemy.combatSpur.def -= 5;
			skillName = data.skills[this.weaponIndex].name;
			boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -5 to atk and def.<br>";
		}
		//Refined Fanged Basilikos
		if(this.hasExactly("Fanged Basilikos") && this.rValue == 5 && enemy.combatStartHp / enemy.maxHp >= 0.75){
			skillName = data.skills[this.weaponIndex].name;
			var dSpd = -5;
			var dDef = -5;
			if(!enemy.penalty.panic){
				dSpd += Math.max(enemy.combatBuffs.spd,enemy.buffs.spd) * -2;
				dDef += Math.max(enemy.combatBuffs.def,enemy.buffs.def) * -2;
			}
			enemy.combatSpur.spd += dSpd;
			enemy.combatSpur.def += dDef;
			boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": " + dSpd + " to spd and " + dDef + " to def.<br>";
		}
		//Refined Wolf Berg
		if(this.hasExactly("Wolf Berg") && this.rValue == 5 && enemy.combatStartHp / enemy.maxHp >= 0.75){
			enemy.combatSpur.atk -= 5;
			enemy.combatSpur.def -= 5;
			skillName = data.skills[this.weaponIndex].name;
			boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -5 to atk and def.<br>";
		}
		//Inviolable Axe
		if(this.hasExactly("Inviolable Axe") && (this.initiator || this.toggle.weapon == 1)){
			enemy.combatSpur.atk -= 4;
			enemy.combatSpur.spd -= 4;
			enemy.combatSpur.def -= 4;
			skillName = data.skills[this.weaponIndex].name;
			boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -4 to atk/spd/def.<br>";
		}
		if(this.hasExactly("Inviolable Axe") && this.rValue == 5 && this.combatStartHp / this.maxHp >= 0.25){
			enemy.combatSpur.atk -= 4;
			enemy.combatSpur.spd -= 4;
			enemy.combatSpur.def -= 4;
			skillName = data.skills[this.weaponIndex].name;
			boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -4 to atk/spd/def.<br>";
		}
		//Ancient Ragnell
		if(this.hasExactly("Ancient Ragnell") && (this.combatStartHp / this.maxHp >= 0.5 || this.toggle.weapon == 1 || checkAllBuffs(this, enemy, currTurn))){
			enemy.combatSpur.atk -= 6;
			enemy.combatSpur.def -= 6;
			skillName = data.skills[this.weaponIndex].name;
			boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -6 to atk and def.<br>";
		}
		//Dreamflake
		if(this.hasExactly("Dreamflake") && this.toggle.weapon == 1){
			enemy.combatSpur.atk -= 5;
			skillName = data.skills[this.weaponIndex].name;
			boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -5 to atk.<br>";
		}
		//Jotnar Bow
		if(this.hasExactly("Jotnar Bow") && (this.initiator || this.toggle.weapon == 1)){
			var dAtk = -5;
			var dSpd = -5;
			var dDef = -5;
			skillName = data.skills[this.weaponIndex].name;
			if(!allStats[14][0]){
				dAtk -= Math.max(this.combatBuffs.atk,this.buffs.atk);
			}
			if(!allStats[14][1]){
				dSpd -= Math.max(this.combatBuffs.spd,this.buffs.spd);
			}
			if(!allStats[14][2]){
				dDef -= Math.max(this.combatBuffs.def,this.buffs.def);
			}
			enemy.combatSpur.atk += dAtk;
			enemy.combatSpur.spd += dSpd;
			enemy.combatSpur.def += dDef;
			boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": " + dAtk + " atk/" + dSpd + " spd/" + dDef + " def.<br>";
		}
		//Blade of Jehanna
		if(this.hasExactly("Blade of Jehanna") && this.combatStartHp / this.maxHp >= 0.25){
			enemy.combatSpur.spd -= 6;
			enemy.combatSpur.def -= 6;
			skillName = data.skills[this.weaponIndex].name;
			boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -6 to spd and def.<br>";
		}
		//Achimenes Furl
		if(this.hasExactly("Achimenes Furl") && this.toggle.weapon > 0){
			enemy.combatSpur.atk -= 5;
			enemy.combatSpur.def -= 5;
			enemy.combatSpur.res -= 5;
			skillName = data.skills[this.weaponIndex].name;
			boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -5 to atk/def/res.<br>";
		}
		//Refined Gjoll
		if(this.hasExactly("Gjoll") && this.rValue > 0){
			skillName = data.skills[this.weaponIndex].name;
			if(this.combatStartHp / this.maxHp >= 0.25 || this.toggle.weapon == 1 || this.toggle.weapon == 3){
				enemy.combatSpur.atk -= 5;
				enemy.combatSpur.def -= 5;
				boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -5 to atk and def.<br>";
			}
			if(this.rValue == 5 && (this.initiator || this.toggle.weapon > 1)){
				var dAtk = -5;
				var dDef = -5;
				if(!allStats[15][0]){
					dAtk -= Math.max(enemy.combatBuffs.atk,enemy.buffs.atk) * 2;
				}
				if(!allStats[15][2]){
					dDef -= Math.max(enemy.combatBuffs.def,enemy.buffs.def) * 2;
				}
				enemy.combatSpur.atk += dAtk;
				enemy.combatSpur.def += dDef;
				boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": " + dAtk + " atk and " + dDef + " def.<br>";
			}
		}
		//Book of Dreams
		if(this.hasExactly("Book of Dreams") && ((this.rValue > 0 && (this.initiator || this.toggle.weapon == 1 || this.toggle.weapon == 3)) || (this.rValue < 0 && this.toggle.weapon == 1))){
			enemy.combatSpur.atk -= 4;
			enemy.combatSpur.spd -= 4;
			enemy.combatSpur.def -= 4;
			enemy.combatSpur.res -= 4;
			skillName = data.skills[this.weaponIndex].name;
			boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -4 to all stats.<br>";
		}
		//Dew Dragonstone
		if(this.hasExactly("Dew Dragonstone") && this.toggle.weapon == 1){
			enemy.combatSpur.atk -= 5;
			enemy.combatSpur.spd -= 5;
			enemy.combatSpur.def -= 5;
			enemy.combatSpur.res -= 5;
			if(this.penalty.panic){
				this.combatBuffs = {"atk":0,"spd":0,"def":0,"res":0};
				this.buffs = {"atk":0,"spd":0,"def":0,"res":0};
			}
			this.combatDebuffs = {"atk":0,"spd":0,"def":0,"res":0};
			this.debuffs = {"atk":0,"spd":0,"def":0,"res":0};
			skillName = data.skills[this.weaponIndex].name;
			boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -5 to all stats and neutralizes all penalties.<br>";
		}
		//Bright-Shell Egg
		if(this.hasExactly("Bright-Shell Egg") && (checkAllBuffs(this, enemy, currTurn) || this.toggle.weapon > 1)){
			enemy.combatSpur.spd -= 6;
			enemy.combatSpur.res -= 6;
			skillName = data.skills[this.weaponIndex].name;
			boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -6 to spd and res.<br>";		
		}
		//Refined Hikami
		if(this.hasExactly("Hikami") && this.rValue > 0){
			if(this.combatStartHp / this.maxHp >= 0.25){
				enemy.combatSpur.atk -= 4;
				enemy.combatSpur.spd -= 4;
				enemy.combatSpur.def -= 4;
				skillName = data.skills[this.weaponIndex].name;
				boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -4 to atk/spd/def.<br>";
			}
			if(this.rValue == 5 && (this.initiator || this.toggle.weapon > 1)){
				enemy.combatSpur.atk -= 4;
				enemy.combatSpur.spd -= 4;
				enemy.combatSpur.def -= 4;
				skillName = data.skills[this.weaponIndex].name;
				boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -4 to atk/spd/def.<br>";
			}
		}
		//Refined Aversa's Night
		if(this.hasExactly("Aversa's Night") && this.rValue > 0){
			if(this.combatStartHp / this.maxHp >= 0.25){
				enemy.combatSpur.atk -= 4;
				enemy.combatSpur.spd -= 4;
				enemy.combatSpur.res -= 4;
				skillName = data.skills[this.weaponIndex].name;
				boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -4 to atk/spd/res.<br>";
			}
			if(this.rValue == 5 && (enemy.combatStartHp / enemy.maxHp >= 0.75 || this.toggle.weapon == 2 || this.toggle.weapon == 3)){
				var eNegate = this.checkNegate(enemy, currTurn);
				var dAtk = -4;
				var dSpd = -4;
				var dRes = -4;
				if(eNegate[0] == false){
					dAtk += Math.min(enemy.combatDebuffs.atk,enemy.debuffs.atk);
					if(enemy.penalty.panic){
						dAtk -= Math.max(enemy.combatBuffs.atk,enemy.buffs.atk);
					}
				}
				if(eNegate[1] == false){
					dSpd += Math.min(enemy.combatDebuffs.spd,enemy.debuffs.spd);
					if(enemy.penalty.panic){
						dSpd -= Math.max(enemy.combatBuffs.spd,enemy.buffs.spd);
					}
				}
				if(eNegate[3] == false){
					dRes += Math.min(enemy.combatDebuffs.res,enemy.debuffs.res);
					if(enemy.penalty.panic){
						dRes -= Math.max(enemy.combatBuffs.res,enemy.buffs.res);
					}
				}
				enemy.combatSpur.atk += dAtk;
				enemy.combatSpur.spd += dSpd;
				enemy.combatSpur.res += dRes;
				boostText += this.name + " inflicts " + dAtk + " atk/" + dSpd + " spd/" + dRes + " res on " + enemy.name + " from enemy HP >= 75% or inflicted with Penalty with Aversa's Night.<br>";
			}
		}
		//Windy War Tome
		if(this.hasExactly("Windy War Tome") && (!this.initiator || enemy.combatStartHp / enemy.maxHp >= 0.75)){
			enemy.combatSpur.atk -= 6;
			enemy.combatSpur.res -= 6;
			skillName = data.skills[this.weaponIndex].name;
			boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -6 to atk and res.<br>";
		}
		if(this.hasExactly("Shadow Breath") && (!this.initiator || enemy.combatStartHp / enemy.maxHp >= 0.75)){
			enemy.combatSpur.atk -= 6;
			enemy.combatSpur.res -= 6;
			skillName = data.skills[this.weaponIndex].name;
			boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -6 to atk and res.<br>";
		}
		if(this.hasExactly("Headsman Glitnir") && this.combatStartHp / this.maxHp >= 0.25){
			enemy.combatSpur.atk -= 5;
			enemy.combatSpur.spd -= 5;
			enemy.combatSpur.def -= 5;
			skillName = data.skills[this.weaponIndex].name;
			boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -5 to atk/spd/def.<br>";
		}
		if(this.hasExactly("Godly Breath") && (this.initiator || this.toggle.weapon == 1)){
			enemy.combatSpur.atk -= 5;
			enemy.combatSpur.spd -= 5;
			enemy.combatSpur.def -= 5;
			enemy.combatSpur.res -= 5;
			skillName = data.skills[this.weaponIndex].name;
			boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -5 to all stats.<br>";
		}
		if(this.hasExactly("Kriemhild") && this.rValue == 5 && (!this.initiator || enemy.combatStartHp / enemy.maxHp >= 0.75)){
			enemy.combatSpur.atk -= 5;
			enemy.combatSpur.def -= 5;
			skillName = data.skills[this.weaponIndex].name;
			boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -5 to atk and def.<br>";
		}
		if(this.hasExactly("Morph Fimbulvetr") && this.toggle.weapon == 1){
			enemy.combatSpur.atk -= 8;
			enemy.combatSpur.res -= 8;
			skillName = data.skills[this.weaponIndex].name;
			boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -8 to atk and res.<br>";
		}
		if(this.hasExactly("Wolfskin Fang") && this.rValue == 5 && (!this.initiator || enemy.combatStartHp / enemy.maxHp >= 0.75)){
			enemy.combatSpur.atk -= 5;
			enemy.combatSpur.def -= 5;
			skillName = data.skills[this.weaponIndex].name;
			boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -5 to atk and def.<br>";
		}
		if(this.hasExactly("Spirit Forest Writ") && this.toggle.weapon == 1){
			enemy.combatSpur.atk -= 6;
			enemy.combatSpur.res -= 6;
			skillName = data.skills[this.weaponIndex].name;
			boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -6 to atk and res.<br>";
			if(allStats[19] + this.getPhantom("Res") > allStats[23] + enemy.getPhantom("Res")){
				var diffVal = Math.floor((allStats[19] - allStats[23]) * 0.8);
				diffVal = Math.min(12, diffVal);
				enemy.combatSpur.atk -= diffVal;
				enemy.combatSpur.res -= diffVal;
				boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -" + diffVal + " to atk and res.<br>";
			}
		}
		if((this.hasExactly("Arcane Eljudnir") || this.hasExactly("Seafoam Splitter")) && this.combatStartHp / this.maxHp >= 0.25){
			enemy.combatSpur.atk -= 6;
			enemy.combatSpur.def -= 6;
			skillName = data.skills[this.weaponIndex].name;
			boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -6 to atk and def.<br>";
		}
		if(this.has("Serenity Breath") && (!this.initiator || enemy.combatStartHp / enemy.maxHp >= 0.75)){
			enemy.combatSpur.atk -= 5;
			enemy.combatSpur.res -= 5;
			skillName = data.skills[this.weaponIndex].name;
			boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -5 to atk and res.<br>";
		}
		if(this.hasExactly("Blade of Favors") && (this.initiator || this.toggle.weapon > 1)){
			var eNegate = this.checkNegate(enemy, currTurn);
			var dAtk = -5;
			var dSpd = -5;
			var dDef = -5;
			if(eNegate[0] == false){
				dAtk += Math.min(enemy.combatDebuffs.atk,enemy.debuffs.atk);
				if(enemy.penalty.panic){
					dAtk -= Math.max(enemy.combatBuffs.atk,enemy.buffs.atk);
				}
			}
			if(eNegate[1] == false){
				dSpd += Math.min(enemy.combatDebuffs.spd,enemy.debuffs.spd);
				if(enemy.penalty.panic){
					dSpd -= Math.max(enemy.combatBuffs.spd,enemy.buffs.spd);
				}
			}
			if(eNegate[2] == false){
				dDef += Math.min(enemy.combatDebuffs.def,enemy.debuffs.def);
				if(enemy.penalty.panic){
					dDef -= Math.max(enemy.combatBuffs.def,enemy.buffs.def);
				}
			}
			enemy.combatSpur.atk += dAtk;
			enemy.combatSpur.spd += dSpd;
			enemy.combatSpur.def += dDef;
			boostText += this.name + " inflicts " + dAtk + " atk/" + dSpd + " spd/" + dDef + " def on " + enemy.name + " from initiating or being within 2 spaces of an ally with Blade of Favors.<br>";
		}
		if((this.hasExactly("Breaker Lance") || this.hasExactly("Ravager")) && this.combatStartHp / this.maxHp >= 0.25){
			enemy.combatSpur.atk -= 6;
			enemy.combatSpur.def -= 6;
			skillName = data.skills[this.weaponIndex].name;
			boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -6 to atk & def.<br>";
		}
		if(this.hasExactly("Solemn Axe") && this.combatStartHp / this.maxHp >= 0.25 && this.specialIndex != -1 && data.defensiveSpecials.indexOf(data.skills[this.specialIndex].name) == -1 && data.gaeSpecials.indexOf(data.skills[this.specialIndex].name) == -1 && enemy.combatStartHp / enemy.maxHp >= 0.4){
			var sDebuff = Math.floor(allStats[20] * 0.25) - 8;
			sDebuff = Math.max(sDebuff,0);
			sDebuff = Math.min(sDebuff,10);
			enemy.combatSpur.atk -= sDebuff;
			enemy.combatSpur.spd -= sDebuff;
			skillName = data.skills[this.weaponIndex].name;
			boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -" + sDebuff + " to atk and spd.<br>";
		}
		if(this.has("Peppy Bow") && this.combatStartHp / this.maxHp >= 0.25){
			enemy.combatSpur.atk -= 5;
			enemy.combatSpur.def -= 5;
			skillName = data.skills[this.weaponIndex].name;
			boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -5 to atk and def.<br>";
		}
		if(this.has("Peppy Cane") && this.combatStartHp / this.maxHp >= 0.25){
			enemy.combatSpur.atk -= 5;
			enemy.combatSpur.res -= 5;
			skillName = data.skills[this.weaponIndex].name;
			boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -5 to atk and res.<br>";
		}
		if(this.hasExactly("Master's Tactics") && this.combatStartHp / this.maxHp >= 0.25){
			enemy.combatSpur.atk -= 5;
			enemy.combatSpur.spd -= 5;
			enemy.combatSpur.res -= 5;
			skillName = data.skills[this.weaponIndex].name;
			boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -5 to atk/spd/res.<br>";
		}
		if(this.hasExactly("Sol Lance") && this.rValue > 0){
			if(this.combatStartHp / this.maxHp >= 0.25){
				enemy.combatSpur.atk -= 5;
				enemy.combatSpur.def -= 5;
				skillName = data.skills[this.weaponIndex].name;
				boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -5 to atk and def.<br>";
			}
			if(this.rValue == 5 && this.toggle.weapon == 1){
				enemy.combatSpur.atk -= 5;
				enemy.combatSpur.def -= 5;
				skillName = data.skills[this.weaponIndex].name;
				boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -5 to atk and def.<br>";
			}
		}
		if(this.hasExactly("Valiant War Axe") && this.combatStartHp / this.maxHp >= 0.25){
			enemy.combatSpur.def -= 6;
			var aVal = 6;
			if(this.toggle.weapon == 1){
				aVal = 10;
				if(enemy.specialIndex != -1){
					aVal = 18 - (data.skills[enemy.specialIndex].charge - enemy.initSkillCharge()) * 2;
				}
				aVal = Math.max(aVal,10);
			}
			enemy.combatSpur.atk -= aVal;
			boostText += this.name + " has activated Valiant War Axe. Effect on " + enemy.name + ": -" + aVal + " to atk, -6 to def.<br>";
		}
		
		if((this.hasExactly("Total War Tome") || this.hasExactly("Vallastone")) && this.combatStartHp / this.maxHp >= 0.25){
			enemy.combatSpur.atk -= 5;
			enemy.combatSpur.spd -= 5;
			enemy.combatSpur.def -= 5;
			enemy.combatSpur.res -= 5;
			skillName = data.skills[this.weaponIndex].name;
			boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -5 to all stats.<br>";
		}
		if(this.hasExactly("Ethereal Breath") && this.rValue > 0){
			if(this.combatStartHp / this.maxHp >= 0.25){
				enemy.combatSpur.atk -= 5;
				enemy.combatSpur.res -= 5;
				skillName = data.skills[this.weaponIndex].name;
				boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -5 to atk and res.<br>";
			}
			if(this.rValue == 5 && (enemy.combatStartHp / enemy.maxHp >= 0.75 || !this.initiator)){
				enemy.combatSpur.atk -= 5;
				enemy.combatSpur.res -= 5;
				if(this.penalty.panic){
					this.combatBuffs.def = 0;
					this.combatBuffs.res = 0;
					this.buffs.def = 0;
					this.buffs.res = 0;
				}
				this.combatDebuffs.def = 0;
				this.combatDebuffs.res = 0;
				this.debuffs.def = 0;
				this.debuffs.res = 0;
				skillName = data.skills[this.weaponIndex].name;
				boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -5 to atk and res and neutralizes penalties to def & res.<br>";
			}
		}
		if(this.hasExactly("Wyvern Hatchet") && (!this.initiator || enemy.combatStartHp / enemy.maxHp >= 0.75)){
			var debuffVal = 6;
			var dAtk = Math.min(enemy.combatDebuffs.atk,enemy.debuffs.atk);
			if(enemy.penalty.panic){
				dAtk -= Math.max(enemy.combatBuffs.atk,enemy.buffs.atk);
			}
			dAtk = Math.max(7+dAtk, 0);
			debuffVal += dAtk;
			enemy.combatSpur.atk -= debuffVal;
			enemy.combatSpur.def -= 6;
			skillName = data.skills[this.weaponIndex].name;
			boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -" + debuffVal + " to atk & -6 to def.<br>";
		}
		if(this.hasExactly("Father's-Son Axe") && this.rValue == 5 && (this.initiator || this.toggle.weapon == 1)){
			enemy.combatSpur.atk -= 5;
			enemy.combatSpur.def -= 5;
			skillName = data.skills[this.weaponIndex].name;
			boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -5 to atk and def.<br>";
		}
		if(this.hasExactly("Sparkling Sun") && this.toggle.weapon == 1){
			var ssVal = Math.floor(this.combatStartHp * 0.3) + 6;
			ssVal = Math.min(ssVal,18);
			enemy.combatSpur.atk -= ssVal;
			enemy.combatSpur.res -= ssVal;
			skillName = data.skills[this.weaponIndex].name;
			boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -" + ssVal + " to atk and res.<br>";
		}
		if(this.hasExactly("Packleader Tome") && this.combatStartHp / this.maxHp >= 0.25){
			var eNegate = this.checkNegate(enemy, currTurn);
			var dAtk = -5;
			var dSpd = -5;
			var dRes = -5;
			if(eNegate[0] == false){
				dAtk += Math.min(enemy.combatDebuffs.atk,enemy.debuffs.atk);
				if(enemy.penalty.panic){
					dAtk -= Math.max(enemy.combatBuffs.atk,enemy.buffs.atk);
				}
			}
			if(eNegate[1] == false){
				dSpd += Math.min(enemy.combatDebuffs.spd,enemy.debuffs.spd);
				if(enemy.penalty.panic){
					dSpd -= Math.max(enemy.combatBuffs.spd,enemy.buffs.spd);
				}
			}
			if(eNegate[3] == false){
				dRes += Math.min(enemy.combatDebuffs.res,enemy.debuffs.res);
				if(enemy.penalty.panic){
					dRes -= Math.max(enemy.combatBuffs.res,enemy.buffs.res);
				}
			}
			enemy.combatSpur.atk += dAtk;
			enemy.combatSpur.spd += dSpd;
			enemy.combatSpur.res += dRes;
			boostText += this.name + " inflicts " + dAtk + " atk/" + dSpd + " spd/" + dRes + " res on " + enemy.name + " from HP >= 25% with " + data.skills[this.weaponIndex].name + ".<br>";
		}
		if(this.hasExactly("Dream Horn") && this.combatStartHp / this.maxHp >= 0.25){
			enemy.combatSpur.atk -= 6;
			enemy.combatSpur.def -= 6;
			skillName = data.skills[this.weaponIndex].name;
			boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -6 to atk & def.<br>";
		}
		if(this.hasExactly("Flower of Tribute") && this.toggle.weapon == 1){
			enemy.combatSpur.spd -= 5;
			enemy.combatSpur.def -= 5;
			skillName = data.skills[this.weaponIndex].name;
			boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -5 to spd & def.<br>";
		}
		if(this.hasExactly("Radiant Scrolls") && (this.initiator || this.buddy.adjacent > 0 || this.buddy.two > 0)){
			enemy.combatSpur.atk -= 6;
			enemy.combatSpur.res -= 6;
			skillName = data.skills[this.weaponIndex].name;
			boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -6 to atk & res.<br>";
		}
		if(this.has("Halting Bow") && this.combatStartHp / this.maxHp >= 0.25){
			enemy.combatSpur.atk -= 5;
			enemy.combatSpur.def -= 5;
			skillName = data.skills[this.weaponIndex].name;
			boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -5 to atk & def.<br>";
		}
		if(this.hasExactly("Grimleal Text") && this.combatStartHp / this.maxHp >= 0.25){
			enemy.combatSpur.atk -= 6;
			enemy.combatSpur.res -= 6;
			skillName = data.skills[this.weaponIndex].name;
			boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -6 to atk & res.<br>";
		}
		if(this.hasExactly("Black Yule Lance") && this.combatStartHp / this.maxHp >= 0.25){
			var byVal = 15 - (this.buddy.adjacent * 2);
			enemy.combatSpur.atk -= byVal;
			enemy.combatSpur.def -= byVal;
			skillName = data.skills[this.weaponIndex].name;
			boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -" + byVal + " to atk & def.<br>";
		}
		if(this.hasExactly("Penitent Lance") && this.combatStartHp / this.maxHp >= 0.25){
			var plVal = (this.bonus.extra + Object.values(this.bonus).reduce((a, item) => a + (item === true ? 1 : 0), 0)) * 2 + 6;
			plVal = Math.min(plVal,12);
			enemy.combatSpur.atk -= plVal;
			enemy.combatSpur.def -= plVal;
			boostText += this.name + " has activated " + data.skills[this.weaponIndex].name + ". Effect on " + enemy.name + ": -" + plVal + " to atk and def.<br>";
		}
				
		//A Skills
		if(this.hasExactly("Dragonscale") && (enemy.combatStartHp / enemy.maxHp == 1 || !this.initiator)){
			enemy.combatSpur.atk -= 6;
			enemy.combatSpur.res -= 6;
			skillName = data.skills[this.aIndex].name;
			boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -6 to atk and res.<br>";
		}
		if(this.hasExactly("Dragonhide") && (enemy.combatStartHp / enemy.maxHp >= 0.75 || !this.initiator)){
			enemy.combatSpur.atk -= 8;
			enemy.combatSpur.spd -= 8;
			enemy.combatSpur.def -= 8;
			enemy.combatSpur.res -= 8;
			skillName = data.skills[this.aIndex].name;
			boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -8 to all stats.<br>";
		}
		if(this.hasExactly("Nightmare") && (enemy.combatStartHp / enemy.maxHp >= 0.75 || !this.initiator)){
			enemy.combatSpur.atk -= 10;
			enemy.combatSpur.def -= 10;
			skillName = data.skills[this.aIndex].name;
			boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -10 to atk & def.<br>";
		}
		if(this.hasExactly("Gift of Magic") && (this.initiator || enemy.range == "ranged")){
			enemy.combatSpur.atk -= 10;
			enemy.combatSpur.res -= 10;
			skillName = data.skills[this.aIndex].name;
			boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -10 to atk & res.<br>";
		}
		if(this.hasExactly("Part of the Plan") && this.combatStartHp / this.maxHp >= 0.25){
			enemy.combatSpur.atk -= 8;
			enemy.combatSpur.spd -= 8;
			enemy.combatSpur.res -= 8;
			skillName = data.skills[this.aIndex].name;
			boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -8 to atk/spd/res.<br>";
		}
		if(this.hasExactly("Ostia's Heart") && (enemy.combatStartHp / enemy.maxHp >= 0.75 || !this.initiator)){
			enemy.combatSpur.atk -= 8;
			enemy.combatSpur.def -= 8;
			skillName = data.skills[this.aIndex].name;
			boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -8 to atk and def.<br>";
		}
		if(this.hasExactly("Realms United") && (enemy.combatStartHp / enemy.maxHp >= 0.75 || !this.initiator)){
			enemy.combatSpur.atk -= 7;
			enemy.combatSpur.spd -= 7;
			enemy.combatSpur.def -= 7;
			enemy.combatSpur.res -= 7;
			skillName = data.skills[this.aIndex].name;
			boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -7 to all stats.<br>";
		}
		
		//B skills
		if(this.hasExactly("Murderous Lion") && this.toggle.b == 1){
			enemy.combatSpur.spd -= 3;
			enemy.combatSpur.def -= 3;
			skillName = data.skills[this.bIndex].name;
			boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -3 to spd and def.<br>";
		}
		if((this.has("Sun-Twin Wing") || this.hasExactly("Tut-Tut")) && this.combatStartHp / this.maxHp >= 0.25){
			enemy.combatSpur.spd -= 5;
			enemy.combatSpur.def -= 5;
			var stwText = "";
			if(this.hasExactly("Sun-Twin Wing+")){
				enemy.combatSpur.atk -= 5;
				stwText = "atk/";
			}
			skillName = data.skills[this.bIndex].name;
			boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -5 to " + stwText + "spd/def.<br>";
		}
		if(this.has("Moon-Twin Wing") && this.combatStartHp / this.maxHp >= 0.25){
			var mtwText = "atk & spd";
			enemy.combatSpur.atk -= 5;
			enemy.combatSpur.spd -= 5;
			if(this.hasExactly("Moon-Twin Wing+")){
				enemy.combatSpur.def -= 5;
				mtwText = "atk/spd/def";
			}
			skillName = data.skills[this.bIndex].name;
			boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -5 to " + mtwText + ".<br>";
		}
		if(this.has("Prescience")){
			var pText = "atk & res";
			enemy.combatSpur.atk -= 5;
			enemy.combatSpur.res -= 5;
			if(this.hasExactly("Prescience 2")){
				enemy.combatSpur.spd -= 5;
				var yVal = 0;
				var eNegate = this.checkNegate(enemy, currTurn);
				if(eNegate[0] == false){
					var aVal = Math.min(enemy.combatDebuffs.atk,enemy.debuffs.atk);
					if(enemy.penalty.panic){
						aVal -= Math.max(enemy.combatBuffs.atk,enemy.buffs.atk);
					}
					yVal += aVal;
				}
				if(eNegate[1] == false){
					var sVal = Math.min(enemy.combatDebuffs.spd,enemy.debuffs.spd);
					if(enemy.penalty.panic){
						sVal -= Math.max(enemy.combatBuffs.spd,enemy.buffs.spd);
					}
					yVal += sVal;
				}
				if(eNegate[2] == false){
					var dVal = Math.min(enemy.combatDebuffs.def,enemy.debuffs.def);
					if(enemy.penalty.panic){
						dVal -= Math.max(enemy.combatBuffs.def,enemy.buffs.def);
					}
					yVal += dVal;
				}
				if(eNegate[3] == false){
					var rVal = Math.min(enemy.combatDebuffs.res,enemy.debuffs.res);
					if(enemy.penalty.panic){
						rVal -= Math.max(enemy.combatBuffs.res,enemy.buffs.res);
					}
					yVal += rVal;
				}
				yVal = Math.min(yVal,enemy.buddy.debuffs.atk + enemy.buddy.debuffs.spd + enemy.buddy.debuffs.def + enemy.buddy.debuffs.res);
				enemy.combatSpur.spd += yVal;
				enemy.combatSpur.res += yVal;
				pText = "atk/spd/res and an additional " + yVal + " spd & res";
			}
			skillName = data.skills[this.bIndex].name;
			boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -5 to " + pText + ".<br>";
		}
		if((this.hasExactly("Divine Recreation") && enemy.combatStartHp / enemy.maxHp >= 0.5) || (this.hasExactly("Divine Recreation 2") && (this.initiator || enemy.combatStartHp / enemy.maxHp >= 0.5))){
			enemy.combatSpur.atk -= 4;
			enemy.combatSpur.spd -= 4;
			enemy.combatSpur.def -= 4;
			enemy.combatSpur.res -= 4;
			skillName = data.skills[this.bIndex].name;
			boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -4 to all stats.<br>";
		}
		if((this.hasExactly("Chivalry") && enemy.combatStartHp / enemy.maxHp >= 0.5) || this.hasExactly("Chivalry 2")){
			enemy.combatSpur.atk -= 5;
			enemy.combatSpur.spd -= 5;
			enemy.combatSpur.def -= 5;
			boostText += this.name + " has activated " + data.skills[this.bIndex].name + ". Effect on " + enemy.name + ": -5 to atk/spd/def.<br>";
		}
		if(this.hasExactly("New Divinity") && this.combatStartHp / this.maxHp >= 0.25){
			enemy.combatSpur.atk -= 5;
			enemy.combatSpur.res -= 5;
			skillName = data.skills[this.bIndex].name;
			boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -5 to atk and res.<br>";
		}
		if(this.hasExactly("Soaring Wings")){
			var swVal = 4 + Math.min(this.buddy.spaces, 4);
			enemy.combatSpur.spd -= swVal;
			enemy.combatSpur.def -= swVal;
			skillName = data.skills[this.bIndex].name;
			boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -" + swVal + " to spd and def.<br>";
		}
		if(this.hasExactly("Raging Storm 2") && (this.combatStartHp / this.maxHp >= 0.25 || this.toggle.b == 1)){
			enemy.combatSpur.atk -= 5;
			enemy.combatSpur.def -= 5;
			skillName = data.skills[this.bIndex].name;
			boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -5 to atk and def.<br>";
		}
		if(this.hasExactly("Deadly Balance+") && (this.combatStartHp / this.maxHp >= 0.25 || this.toggle.b == 1)){
			enemy.combatSpur.atk -= 5;
			enemy.combatSpur.spd -= 5;
			enemy.combatSpur.def -= 5;
			boostText += this.name + " has activated Deadly Balance+. Effect on " + enemy.name + ": -5 to atk/spd/def.<br>";
		}
		if(this.hasExactly("Sabotage AR 3") && allStats[19] + this.getPhantom("Res") > allStats[23] + enemy.getPhantom("Res")){
			var eNegate = this.checkNegate(enemy, currTurn);
			var dAtk = 0;
			var dRes = 0;
			if(eNegate[0] == false){
				dAtk += Math.min(enemy.combatDebuffs.atk,enemy.debuffs.atk);
				if(enemy.penalty.panic){
					dAtk -= Math.max(enemy.combatBuffs.atk,enemy.buffs.atk);
				}
			}
			if(eNegate[3] == false){
				dRes += Math.min(enemy.combatDebuffs.res,enemy.debuffs.res);
				if(enemy.penalty.panic){
					dRes -= Math.max(enemy.combatBuffs.res,enemy.buffs.res);
				}
			}
			if(enemy.buddy.adjacent > 0 || enemy.buddy.two > 0){
				dAtk = Math.min(dAtk,enemy.buddy.debuffs.atk);
				dRes = Math.min(dRes,enemy.buddy.debuffs.res);
			}
			dAtk -= 3;
			dRes -= 3;
			enemy.combatSpur.atk += dAtk;
			enemy.combatSpur.res += dRes;
			skillName = data.skills[this.bIndex].name;
			boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": " + dAtk + " atk & " + dRes + " res.<br>";
		}
		if(this.hasExactly("Sabotage SR 3") && allStats[19] + this.getPhantom("Res") > allStats[23] + enemy.getPhantom("Res")){
			var eNegate = this.checkNegate(enemy, currTurn);
			var dSpd = 0;
			var dRes = 0;
			if(eNegate[1] == false){
				dSpd += Math.min(enemy.combatDebuffs.spd,enemy.debuffs.spd);
				if(enemy.penalty.panic){
					dSpd -= Math.max(enemy.combatBuffs.spd,enemy.buffs.spd);
				}
			}
			if(eNegate[3] == false){
				dRes += Math.min(enemy.combatDebuffs.res,enemy.debuffs.res);
				if(enemy.penalty.panic){
					dRes -= Math.max(enemy.combatBuffs.res,enemy.buffs.res);
				}
			}
			if(enemy.buddy.adjacent > 0 || enemy.buddy.two > 0){
				dSpd = Math.min(dSpd,enemy.buddy.debuffs.spd);
				dRes = Math.min(dRes,enemy.buddy.debuffs.res);
			}
			dSpd -= 3;
			dRes -= 3;
			enemy.combatSpur.spd += dSpd;
			enemy.combatSpur.res += dRes;
			skillName = data.skills[this.bIndex].name;
			boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": " + dSpd + " spd & " + dRes + " res.<br>";
		}
		if(this.hasExactly("Sabotage AD 3") && allStats[19] + this.getPhantom("Res") > allStats[23] + enemy.getPhantom("Res")){
			var eNegate = this.checkNegate(enemy, currTurn);
			var dAtk = 0;
			var dDef = 0;
			if(eNegate[0] == false){
				dAtk += Math.min(enemy.combatDebuffs.atk,enemy.debuffs.atk);
				if(enemy.penalty.panic){
					dAtk -= Math.max(enemy.combatBuffs.atk,enemy.buffs.atk);
				}
			}
			if(eNegate[2] == false){
				dDef += Math.min(enemy.combatDebuffs.def,enemy.debuffs.def);
				if(enemy.penalty.panic){
					dDef -= Math.max(enemy.combatBuffs.def,enemy.buffs.def);
				}
			}
			if(enemy.buddy.adjacent > 0 || enemy.buddy.two > 0){
				dAtk = Math.min(dAtk,enemy.buddy.debuffs.atk);
				dDef = Math.min(dDef,enemy.buddy.debuffs.def);
			}
			dAtk -= 3;
			dDef -= 3;
			enemy.combatSpur.atk += dAtk;
			enemy.combatSpur.def += dDef;
			skillName = data.skills[this.bIndex].name;
			boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": " + dAtk + " atk & " + dDef + " def.<br>";
		}
		if(this.hasExactly("Ruler of Nihility") && (enemy.combatStartHp / enemy.maxHp >= 0.75 || enemy.penalty.extra > 0 || Object.values(enemy.penalty).reduce((a, item) => a + (item === true ? 1 : 0), 0) > 0 || enemy.debuffs.atk < 0 || enemy.debuffs.spd < 0 || enemy.debuffs.def < 0 || enemy.debuffs.res < 0 || enemy.combatDebuffs.atk < 0 || enemy.combatDebuffs.spd < 0 || enemy.combatDebuffs.def < 0 || enemy.combatDebuffs.res < 0)){
			enemy.combatSpur.atk -= 5;
			enemy.combatSpur.def -= 5;
			skillName = data.skills[this.bIndex].name;
			boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -5 to atk and def.<br>";
		}
		if(this.hasExactly("Raging Tempest") && this.buddy.adjacent < 2){
			enemy.combatSpur.atk -= 5;
			enemy.combatSpur.def -= 5;
			skillName = data.skills[this.bIndex].name;
			boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -5 to atk and def.<br>";
		}
		if(this.hasExactly("Barbarity") && enemy.combatStartHp / enemy.maxHp >= 0.25){
			enemy.combatSpur.atk -= 4;
			enemy.combatSpur.spd -= 4;
			enemy.combatSpur.def -= 4;
			skillName = data.skills[this.bIndex].name;
			boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -4 to atk/spd/def.<br>";
		}
		if(this.hasExactly("Font of Wisdom")){
			var eNegate = this.checkNegate(enemy, currTurn);
			var dAtk = 0;
			var dSpd = 0;
			var dRes = 0;
			if(eNegate[0] == false){
				dAtk += Math.min(enemy.combatDebuffs.atk,enemy.debuffs.atk);
				if(enemy.penalty.panic){
					dAtk -= Math.max(enemy.combatBuffs.atk,enemy.buffs.atk);
				}
			}
			if(eNegate[1] == false){
				dSpd += Math.min(enemy.combatDebuffs.spd,enemy.debuffs.spd);
				if(enemy.penalty.panic){
					dSpd -= Math.max(enemy.combatBuffs.spd,enemy.buffs.spd);
				}
			}
			if(eNegate[3] == false){
				dRes += Math.min(enemy.combatDebuffs.res,enemy.debuffs.res);
				if(enemy.penalty.panic){
					dRes -= Math.max(enemy.combatBuffs.res,enemy.buffs.res);
				}
			}
			if(enemy.buddy.adjacent > 0 || enemy.buddy.two > 0){
				dAtk = Math.min(dAtk,enemy.buddy.debuffs.atk);
				dSpd = Math.min(dSpd,enemy.buddy.debuffs.spd);
				dRes = Math.min(dRes,enemy.buddy.debuffs.res);
			}
			dAtk -= 5;
			dSpd -= 5;
			dRes -= 5;
			enemy.combatSpur.atk += dAtk;
			enemy.combatSpur.spd += dSpd;
			enemy.combatSpur.res += dRes;
			skillName = data.skills[this.bIndex].name;
			boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": " + dAtk + " atk/" + dSpd + " spd/" + dRes + " res.<br>";
		}
		
		//Lull skills
		if(this.has("Lull Atk Def")){
			var debuffVal = this.has("Lull Atk Def");
			if(this.hasExactly("Lull Atk Def 4")){
				debuffVal += this.toggle.b;
			}
			enemy.combatSpur.atk -= debuffVal;
			enemy.combatSpur.def -= debuffVal;
			skillName = data.skills[this.bIndex].name;
			boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -" + debuffVal + " to atk & def.<br>";
		}
		else if(this.has("Lull Spd Def")){
			var debuffVal = this.has("Lull Spd Def");
			if(this.hasExactly("Lull Spd Def 4")){
				debuffVal += this.toggle.b;
			}
			enemy.combatSpur.spd -= debuffVal;
			enemy.combatSpur.def -= debuffVal;
			skillName = data.skills[this.bIndex].name;
			boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -" + debuffVal + " to spd & def.<br>";
		}
		else if(this.has("Lull Atk Spd")){
			var debuffVal = this.has("Lull Atk Spd");
			enemy.combatSpur.atk -= debuffVal;
			enemy.combatSpur.spd -= debuffVal;
			skillName = data.skills[this.bIndex].name;
			boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -" + debuffVal + " to atk & spd.<br>";
		}
		else if(this.has("Lull Atk Res")){
			var debuffVal = this.has("Lull Atk Res");
			enemy.combatSpur.atk -= debuffVal;
			enemy.combatSpur.res -= debuffVal;
			skillName = data.skills[this.bIndex].name;
			boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -" + debuffVal + " to atk & res.<br>";
		}
		else if(this.has("Lull Spd Res")){
			var debuffVal = this.has("Lull Spd Res");
			if(this.hasExactly("Lull Spd Res 4")){
				debuffVal += this.toggle.b;
			}
			enemy.combatSpur.spd -= debuffVal;
			enemy.combatSpur.res -= debuffVal;
			skillName = data.skills[this.bIndex].name;
			boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -" + debuffVal + " to spd & res.<br>";
		}
		
		//Trace skills
		if(this.has("SD Near Trace")){
			var debuffVal = this.has("SD Near Trace");
			enemy.combatSpur.spd -= debuffVal;
			enemy.combatSpur.def -= debuffVal;
			boostText += this.name + " has activated " + data.skills[this.bIndex].name + ". Effect on " + enemy.name + ": -" + debuffVal + " to spd & def.<br>";
		}
		else if(this.has("SR Far Trace")){
			var debuffVal = this.has("SR Far Trace");
			enemy.combatSpur.spd -= debuffVal;
			enemy.combatSpur.res -= debuffVal;
			boostText += this.name + " has activated " + data.skills[this.bIndex].name + ". Effect on " + enemy.name + ": -" + debuffVal + " to spd & res.<br>";
		}
		else if(this.has("AD Far Trace")){
			var debuffVal = this.has("AD Far Trace");
			enemy.combatSpur.atk -= debuffVal;
			enemy.combatSpur.def -= debuffVal;
			boostText += this.name + " has activated " + data.skills[this.bIndex].name + ". Effect on " + enemy.name + ": -" + debuffVal + " to atk & def.<br>";
		}
		else if(this.has("AD Near Trace")){
			var debuffVal = this.has("AD Near Trace");
			enemy.combatSpur.atk -= debuffVal;
			enemy.combatSpur.def -= debuffVal;
			boostText += this.name + " has activated " + data.skills[this.bIndex].name + ". Effect on " + enemy.name + ": -" + debuffVal + " to atk & def.<br>";
		}
		else if(this.has("AR Far Trace")){
			var debuffVal = this.has("AR Far Trace");
			enemy.combatSpur.atk -= debuffVal;
			enemy.combatSpur.res -= debuffVal;
			boostText += this.name + " has activated " + data.skills[this.bIndex].name + ". Effect on " + enemy.name + ": -" + debuffVal + " to atk & res.<br>";
		}
		else if(this.has("AS Far Trace")){
			var debuffVal = this.has("AS Far Trace");
			enemy.combatSpur.atk -= debuffVal;
			enemy.combatSpur.spd -= debuffVal;
			boostText += this.name + " has activated " + data.skills[this.bIndex].name + ". Effect on " + enemy.name + ": -" + debuffVal + " to atk & spd.<br>";
		}
		else if(this.has("SD Far Trace")){
			var debuffVal = this.has("SD Far Trace");
			enemy.combatSpur.spd -= debuffVal;
			enemy.combatSpur.def -= debuffVal;
			boostText += this.name + " has activated " + data.skills[this.bIndex].name + ". Effect on " + enemy.name + ": -" + debuffVal + " to spd & def.<br>";
		}
		else if(this.has("SR Near Trace")){
			var debuffVal = this.has("SR Near Trace");
			enemy.combatSpur.spd -= debuffVal;
			enemy.combatSpur.res -= debuffVal;
			boostText += this.name + " has activated " + data.skills[this.bIndex].name + ". Effect on " + enemy.name + ": -" + debuffVal + " to spd & res.<br>";
		}
		else if(this.has("AR Near Trace")){
			var debuffVal = this.has("AR Near Trace");
			enemy.combatSpur.atk -= debuffVal;
			enemy.combatSpur.res -= debuffVal;
			boostText += this.name + " has activated " + data.skills[this.bIndex].name + ". Effect on " + enemy.name + ": -" + debuffVal + " to atk & res.<br>";
		}
		else if(this.has("AS Near Trace")){
			var debuffVal = this.has("AS Near Trace");
			enemy.combatSpur.atk -= debuffVal;
			enemy.combatSpur.spd -= debuffVal;
			boostText += this.name + " has activated " + data.skills[this.bIndex].name + ". Effect on " + enemy.name + ": -" + debuffVal + " to atk & spd.<br>";
		}
		
		//Tempo skills
		if(this.hasSlot("Spd Def Tempo","b")){
			var debuffVal = this.hasSlot("Spd Def Tempo","b");
			enemy.combatSpur.spd -= debuffVal;
			enemy.combatSpur.def -= debuffVal;
			skillName = data.skills[this.bIndex].name;
			boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -" + debuffVal + " to spd & def.<br>";
		}
		if(this.hasSlot("Spd Def Tempo","s")){
			var debuffVal = this.hasSlot("Spd Def Tempo","s");
			enemy.combatSpur.spd -= debuffVal;
			enemy.combatSpur.def -= debuffVal;
			skillName = data.skills[this.sIndex].name;
			boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -" + debuffVal + " to spd & def.<br>";
		}
		if(this.has("Atk Res Tempo")){
			var debuffVal = this.has("Atk Res Tempo");
			enemy.combatSpur.atk -= debuffVal;
			enemy.combatSpur.res -= debuffVal;
			skillName = data.skills[this.bIndex].name;
			boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -" + debuffVal + " to atk & res.<br>";
		}
		if(this.hasSlot("Spd Res Tempo","b")){
			var debuffVal = this.hasSlot("Spd Res Tempo","b");
			enemy.combatSpur.spd -= debuffVal;
			enemy.combatSpur.res -= debuffVal;
			skillName = data.skills[this.bIndex].name;
			boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -" + debuffVal + " to spd & res.<br>";
		}
		if(this.hasSlot("Spd Res Tempo","s")){
			var debuffVal = this.hasSlot("Spd Res Tempo","s");
			enemy.combatSpur.spd -= debuffVal;
			enemy.combatSpur.res -= debuffVal;
			skillName = data.skills[this.sIndex].name;
			boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -" + debuffVal + " to spd & res.<br>";
		}
		
		//Bulwark skills
		if(this.has("Atk Def Bulwark")){
			var debuffVal = this.has("Atk Def Bulwark") + 1;
			debuffVal = Math.min(debuffVal,4);
			enemy.combatSpur.atk -= debuffVal;
			enemy.combatSpur.def -= debuffVal;
			skillName = data.skills[this.bIndex].name;
			boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -" + debuffVal + " to atk & def.<br>";
		}
		if(this.has("Spd Def Bulwark")){
			var debuffVal = this.has("Spd Def Bulwark") + 1;
			debuffVal = Math.min(debuffVal,4);
			enemy.combatSpur.spd -= debuffVal;
			enemy.combatSpur.def -= debuffVal;
			skillName = data.skills[this.bIndex].name;
			boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -" + debuffVal + " to spd & def.<br>";
		}
		if(this.has("Spd Res Bulwark")){
			var debuffVal = this.has("Spd Res Bulwark") + 1;
			debuffVal = Math.min(debuffVal,4);
			enemy.combatSpur.spd -= debuffVal;
			enemy.combatSpur.res -= debuffVal;
			skillName = data.skills[this.bIndex].name;
			boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -" + debuffVal + " to spd & res.<br>";
		}
		if(this.has("Atk Spd Bulwark")){
			var debuffVal = this.has("Atk Spd Bulwark") + 1;
			debuffVal = Math.min(debuffVal,4);
			enemy.combatSpur.atk -= debuffVal;
			enemy.combatSpur.spd -= debuffVal;
			skillName = data.skills[this.bIndex].name;
			boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -" + debuffVal + " to atk & spd.<br>";
		}
		
		//Preempt skills
		if(this.has("Spd Preempt")){
			var debuffVal = this.has("Spd Preempt") + 1;
			enemy.combatSpur.spd -= debuffVal;
			skillName = data.skills[this.bIndex].name;
			boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -" + debuffVal + " to spd.<br>";
		}
		
		if(this.hasSlot("Pegasus Flight","b")){
			var spdCheck = 7;
			var diffVal = 0;
			var pVal = (this.hasSlot("Pegasus Flight","b") + 2) * 0.1;
			var mVal = this.hasSlot("Pegasus Flight","b") * 2 + 1;
			if(this.hasExactly("Pegasus Flight 4")){
				spdCheck = 10;
				diffVal = 4;
				pVal = 0.8;
				mVal = 8;
			}
			if(allStats[17] + this.getPhantom("Spd") >= allStats[21] + enemy.getPhantom("Spd") - spdCheck){
				var resDiff = Math.max(allStats[19] - allStats[23],0);
				resDiff = Math.floor(pVal * resDiff);
				diffVal += Math.min(resDiff,mVal);
				if(diffVal > 0){
					enemy.combatSpur.atk -= diffVal;
					enemy.combatSpur.def -= diffVal;
					skillName = data.skills[this.bIndex].name;
					boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -" + diffVal + " to atk & def.<br>";
				}
			}
		}
		if(this.hasSlot("Pegasus Flight","s")){
			var spdCheck = 7;
			var diffVal = 0;
			var pVal = (this.hasSlot("Pegasus Flight","s") + 2) * 0.1;
			var mVal = this.hasSlot("Pegasus Flight","s") * 2 + 1;
			if(allStats[17] + this.getPhantom("Spd") >= allStats[21] + enemy.getPhantom("Spd") - spdCheck){
				var resDiff = Math.max(allStats[19]- allStats[23],0);
				resDiff = Math.floor(pVal * resDiff);
				diffVal += Math.min(resDiff,mVal);
				if(diffVal > 0){
					enemy.combatSpur.atk -= diffVal;
					enemy.combatSpur.def -= diffVal;
					skillName = data.skills[this.sIndex].name;
					boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -" + diffVal + " to atk & def.<br>";
				}
			}
		}
		//Wyvern Flight
		if(this.has("Wyvern Flight") && allStats[17] + this.getPhantom("Spd") >= allStats[21] + enemy.getPhantom("Spd") - 10){
			var diffVal = Math.max(allStats[18] - allStats[22],0);
			diffVal = Math.floor((this.has("Wyvern Flight") + 2) * 0.1 * diffVal);
			if(diffVal > 0){
				diffVal = Math.min(diffVal,this.has("Wyvern Flight") * 2 + 1);
				enemy.combatSpur.atk -= diffVal;
				enemy.combatSpur.def -= diffVal;
				skillName = data.skills[this.bIndex].name;
				boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -" + diffVal + " to atk & def.<br>";
			}
		}
		if(this.hasExactly("Mystic Boost 4") || this.hasExactly("Laguz Friend 4") || (this.hasExactly("Reopening") && this.combatStartHp / this.maxHp >= 0.25) || (this.hasExactly("Wily Fighter 4") && (!this.initiator || this.combatStartHp / this.maxHp >= 0.25))){
			enemy.combatSpur.atk -= 5;
			skillName = data.skills[this.bIndex].name;
			boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -5 to atk.<br>";
		}
		if(this.hasExactly("Guard 4") && this.combatStartHp / this.maxHp >= 0.25){
			enemy.combatSpur.atk -= 4;
			skillName = data.skills[this.bIndex].name;
			boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -4 to atk.<br>";
		}
		if(this.hasExactly("Poetic Justice") || this.hasExactly("Dazzling Shift") || this.hasExactly("Dazzle Far Trace")){
			enemy.combatSpur.spd -= 4;
			skillName = data.skills[this.bIndex].name;
			boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -4 to spd.<br>";
		}
		if(this.hasExactly("Dazzling Discord") || this.hasExactly("AR Far Resound") || this.hasExactly("Atk Res Detect") || this.hasExactly("Atk Res Havoc")){
			enemy.combatSpur.atk -= 4;
			enemy.combatSpur.res -= 4;
			skillName = data.skills[this.bIndex].name;
			boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -4 to atk & res.<br>";
		}
		if(this.hasExactly("Vengeful Fighter 4") && !this.initiator && this.combatStartHp / this.maxHp >= 0.25){
			enemy.combatSpur.atk -= 4;
			skillName = data.skills[this.bIndex].name;
			boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -4 to atk.<br>";
		}
		if((this.hasExactly("Savvy Fighter 4") && !this.initiator) || this.hasExactly("Clever Fighter") || this.hasExactly("Shield Fighter")){
			enemy.combatSpur.atk -= 4;
			enemy.combatSpur.spd -= 4;
			skillName = data.skills[this.bIndex].name;
			boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -4 to atk & spd.<br>";
		}
		if(this.hasExactly("Weaving Fighter") && this.combatStartHp / this.maxHp >= 0.25){
			enemy.combatSpur.atk -= 4;
			enemy.combatSpur.def -= 4;
			skillName = data.skills[this.bIndex].name;
			boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -4 to atk & def.<br>";
		}
		if((this.hasExactly("Dragon's Ire 4") || this.hasExactly("Canny Fighter")) && this.combatStartHp / this.maxHp >= 0.25){
			enemy.combatSpur.atk -= 4;
			enemy.combatSpur.res -= 4;
			skillName = data.skills[this.bIndex].name;
			boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -4 to atk & res.<br>";
		}
		if(this.hasExactly("Guard Bearing 4") || this.hasExactly("Gambit 4") || this.hasExactly("Potent 4") || this.hasExactly("Potent Disarm")){
			enemy.combatSpur.spd -= 4;
			enemy.combatSpur.def -= 4;
			skillName = data.skills[this.bIndex].name;
			boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -4 to spd & def.<br>";
		}
		if(this.hasExactly("Full Disarm")){
			var fdVal = Math.min((Object.values(this.bonus).reduce((a, item) => a + (item === true ? 1 : 0), 0) + this.bonus.extra + Object.values(enemy.penalty).reduce((a, item) => a + (item === true ? 1 : 0), 0) + enemy.penalty.extra) * 2 + 4, 12);
			enemy.combatSpur.spd -= fdVal;
			enemy.combatSpur.def -= fdVal;
			skillName = data.skills[this.bIndex].name;
			boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -" + fdVal + " to spd & def.<br>";
		}
		//Seal 4 skills
		if(this.hasExactly("Seal Res 4")){
			var debuffVal = 4;
			var nCheck = this.checkNegate(enemy,currTurn);
			if(nCheck[3] == false){
				var dRes = Math.min(enemy.combatDebuffs.res,enemy.debuffs.res);
				if(enemy.penalty.panic){
					dRes -= Math.max(enemy.combatBuffs.res,enemy.buffs.res);
				}
				dRes = Math.max(7+dRes, 0);
				debuffVal += dRes;
			}
			enemy.combatSpur.res -= debuffVal;
			skillName = data.skills[this.bIndex].name;
			boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -" + debuffVal + " to res.<br>";
		}
		if(this.hasExactly("Seal Def 4")){
			var debuffVal = 4;
			var nCheck = this.checkNegate(enemy,currTurn);
			if(nCheck[2] == false){
				var dDef = Math.min(enemy.combatDebuffs.def,enemy.debuffs.def);
				if(enemy.penalty.panic){
					dDef -= Math.max(enemy.combatBuffs.def,enemy.buffs.def);
				}
				dDef = Math.max(7+dDef, 0);
				debuffVal += dDef;
			}
			enemy.combatSpur.def -= debuffVal;
			skillName = data.skills[this.bIndex].name;
			boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -" + debuffVal + " to def.<br>";
		}
		if(this.hasExactly("Seal Spd 4")){
			var debuffVal = 4;
			var nCheck = this.checkNegate(enemy,currTurn);
			if(nCheck[1] == false){
				var dSpd = Math.min(enemy.combatDebuffs.spd,enemy.debuffs.spd);
				if(enemy.penalty.panic){
					dSpd -= Math.max(enemy.combatBuffs.spd,enemy.buffs.spd);
				}
				dSpd = Math.max(7+dSpd, 0);
				debuffVal += dSpd;
			}
			enemy.combatSpur.spd -= debuffVal;
			skillName = data.skills[this.bIndex].name;
			boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -" + debuffVal + " to spd.<br>";
		}
		if(this.hasExactly("Seal Atk 4")){
			var debuffVal = 4;
			var nCheck = this.checkNegate(enemy,currTurn);
			if(nCheck[0] == false){
				var dAtk = Math.min(enemy.combatDebuffs.atk,enemy.debuffs.atk);
				if(enemy.penalty.panic){
					dAtk -= Math.max(enemy.combatBuffs.atk,enemy.buffs.atk);
				}
				dAtk = Math.max(7+dAtk, 0);
				debuffVal += dAtk;
			}
			enemy.combatSpur.atk -= debuffVal;
			skillName = data.skills[this.bIndex].name;
			boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -" + debuffVal + " to atk.<br>";
		}
		if(this.hasExactly("Seal Spd Res 3")){
			var debuffVal = 3;
			var dSpd = Math.min(enemy.combatDebuffs.spd,enemy.debuffs.spd);
			if(enemy.penalty.panic){
				dSpd -= Math.max(enemy.combatBuffs.spd,enemy.buffs.spd);
			}
			dSpd = Math.max(6+dSpd, 0) + debuffVal;
			var dRes = Math.min(enemy.combatDebuffs.res,enemy.debuffs.res);
			if(enemy.penalty.panic){
				dRes -= Math.max(enemy.combatBuffs.res,enemy.buffs.res);
			}
			dRes = Math.max(6+dRes, 0) + debuffVal;
			enemy.combatSpur.spd -= dSpd;
			enemy.combatSpur.res -= dRes;
			skillName = data.skills[this.bIndex].name;
			boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -" + dSpd + " spd & -" + dRes + " res.<br>";
		}
		if(this.hasExactly("Seal Def Res 3")){
			var debuffVal = 3;
			var dDef = Math.min(enemy.combatDebuffs.def,enemy.debuffs.def);
			if(enemy.penalty.panic){
				dDef -= Math.max(enemy.combatBuffs.def,enemy.buffs.def);
			}
			dDef = Math.max(6+dDef, 0) + debuffVal;
			var dRes = Math.min(enemy.combatDebuffs.res,enemy.debuffs.res);
			if(enemy.penalty.panic){
				dRes -= Math.max(enemy.combatBuffs.res,enemy.buffs.res);
			}
			dRes = Math.max(6+dRes, 0) + debuffVal;
			enemy.combatSpur.def -= dDef;
			enemy.combatSpur.res -= dRes;
			skillName = data.skills[this.bIndex].name;
			boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -" + dDef + " def & -" + dRes + " res.<br>";
		}
		if(this.hasExactly("Seal Spd Def 3")){
			var debuffVal = 3;
			var dSpd = Math.min(enemy.combatDebuffs.spd,enemy.debuffs.spd);
			if(enemy.penalty.panic){
				dSpd -= Math.max(enemy.combatBuffs.spd,enemy.buffs.spd);
			}
			dSpd = Math.max(6+dSpd, 0) + debuffVal;
			var dDef = Math.min(enemy.combatDebuffs.def,enemy.debuffs.def);
			if(enemy.penalty.panic){
				dDef -= Math.max(enemy.combatBuffs.def,enemy.buffs.def);
			}
			dDef = Math.max(6+dDef, 0) + debuffVal;
			enemy.combatSpur.spd -= dSpd;
			enemy.combatSpur.def -= dDef;
			skillName = data.skills[this.bIndex].name;
			boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -" + dSpd + " spd & -" + dDef + " def.<br>";
		}
		if(this.hasExactly("Seal Atk Res 3")){
			var debuffVal = 3;
			var dAtk = Math.min(enemy.combatDebuffs.atk,enemy.debuffs.atk);
			if(enemy.penalty.panic){
				dAtk -= Math.max(enemy.combatBuffs.atk,enemy.buffs.atk);
			}
			dAtk = Math.max(6+dAtk, 0) + debuffVal;
			var dRes = Math.min(enemy.combatDebuffs.res,enemy.debuffs.res);
			if(enemy.penalty.panic){
				dRes -= Math.max(enemy.combatBuffs.res,enemy.buffs.res);
			}
			dRes = Math.max(6+dRes, 0) + debuffVal;
			enemy.combatSpur.atk -= dAtk;
			enemy.combatSpur.res -= dRes;
			skillName = data.skills[this.bIndex].name;
			boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -" + dAtk + " atk & -" + dRes + " res.<br>";
		}
		if(this.hasExactly("Phys Null Follow") || this.hasExactly("Close Call 4") || this.hasExactly("Repel 4") || this.hasExactly("Spurn 4") || this.hasExactly("Beast Sense 4") || this.hasExactly("Disarm Trap 4") || this.hasExactly("Spd Def Snag 4") || this.hasExactly("Spd Def Ruse 4") || this.hasExactly("Buffer 4") || this.hasExactly("Beast Agility 4") || this.hasExactly("Beast Assault 4") || this.hasExactly("Spd Def Detect") || this.hasExactly("Speedtaker 4") || this.hasExactly("Flow Desperation") || ((this.hasExactly("Bestial Assault") || this.hasExactly("Bestial Agility")) && (this.transform == true || this.combatStartHp / this.maxHp >= 0.25))){
			enemy.combatSpur.spd -= 4;
			enemy.combatSpur.def -= 4;
			skillName = data.skills[this.bIndex].name;
			boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -4 to spd & def.<br>";
		}
		if(this.hasExactly("Atk Def Snag 4") || this.hasExactly("Wyvern Rift") || (this.hasExactly("Momentum 4") && this.buddy.spaces > 0) || this.hasExactly("AD Spiked Wall")){
			enemy.combatSpur.atk -= 4;
			enemy.combatSpur.def -= 4;
			boostText += this.name + " has activated " + data.skills[this.bIndex].name + ". Effect on " + enemy.name + ": -4 to atk & def.<br>";
		}
		if(this.hasExactly("Escape Route 4")){
			enemy.combatSpur.atk -= 3;
			enemy.combatSpur.spd -= 3;
			skillName = data.skills[this.bIndex].name;
			boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -3 to atk & spd.<br>";
		}
		if(this.hasExactly("Soul of Zofia 2") && this.combatStartHp / this.maxHp >= 0.25){
			enemy.combatSpur.spd -= 5;
			skillName = data.skills[this.bIndex].name;
			boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -5 to spd.<br>";
		}
		if((this.hasExactly("Fruit of Life") || this.hasExactly("Twin-Sky Wing") || this.hasExactly("Under the Sun")) && this.combatStartHp / this.maxHp >= 0.25){
			enemy.combatSpur.spd -= 5;
			enemy.combatSpur.def -= 5;
			skillName = data.skills[this.bIndex].name;
			boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -5 to spd & def.<br>";
		}
		if(this.hasExactly("Sunlight Bangle") && this.toggle.b > 0){
			var sbVal = this.toggle.b + 3;
			enemy.combatSpur.atk -= sbVal;
			enemy.combatSpur.def -= sbVal;
			skillName = data.skills[this.bIndex].name;
			boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -" + sbVal + " to atk & def.<br>";
		}
		if(this.hasExactly("Wings of Mercy 4")){
			enemy.combatSpur.def -= 3;
			enemy.combatSpur.res -= 3;
			skillName = data.skills[this.bIndex].name;
			boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -3 to def & res.<br>";
		}
		if(this.hasExactly("Brash Assault 4") && this.initiator && (this.combatStartHp / this.maxHp < 1 || enemy.combatStartHp / enemy.maxHp >= 1)){
			enemy.combatSpur.def -= 4;
			enemy.combatSpur.res -= 4;
			skillName = data.skills[this.bIndex].name;
			boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -4 to def & res.<br>";
		}
		if(this.hasExactly("Mag Null Follow") || this.hasExactly("Wrathful Tempo") || this.hasExactly("High Dragon Wall") || this.hasExactly("Resonance 4") || this.hasExactly("SR Spiked Wall") || this.hasExactly("Called to Serve")){
			enemy.combatSpur.spd -= 4;
			enemy.combatSpur.res -= 4;
			skillName = data.skills[this.bIndex].name;
			boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -4 to spd & res.<br>";
		}
		if(this.hasExactly("Null C-Disrupt 4") || this.hasExactly("Counter Roar 4") || this.hasExactly("Pegasus Rift") || this.hasExactly("Spd Def Link 4") || this.hasExactly("Laguz Loyalty") || this.hasExactly("AS Spiked Wall")){
			enemy.combatSpur.atk -= 4;
			enemy.combatSpur.spd -= 4;
			skillName = data.skills[this.bIndex].name;
			boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -4 to atk & spd.<br>";
		}
		if(this.hasExactly("Desperation 4")){
			enemy.combatSpur.spd -= 4;
			skillName = data.skills[this.bIndex].name;
			boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -4 to spd.<br>";
		}
		if((this.hasExactly("Flow Refresh 4") || this.hasExactly("Flow Guard 4") || this.hasExactly("Assassin's Strike")) && this.initiator){
			enemy.combatSpur.spd -= 4;
			enemy.combatSpur.def -= 4;
			skillName = data.skills[this.bIndex].name;
			boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -4 to spd & def.<br>";
		}
		if(this.hasExactly("Occultist's Strike") && this.initiator){
			enemy.combatSpur.spd -= 4;
			enemy.combatSpur.res -= 4;
			skillName = data.skills[this.bIndex].name;
			boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -4 to spd & res.<br>";
		}
		if(this.hasExactly("Aerial Maneuvers") && this.combatStartHp / this.maxHp >= 0.5 && enemy.combatStartHp / enemy.maxHp >= 0.5){
			enemy.combatSpur.spd -= 4;
			enemy.combatSpur.def -= 4;
			skillName = data.skills[this.bIndex].name;
			boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -4 to spd & def.<br>";
		}
		if(this.hasExactly("Magic Gambit 4") && (this.initiator || enemy.range == "ranged")){
			enemy.combatSpur.spd -= 4;
			enemy.combatSpur.res -= 4;
			skillName = data.skills[this.bIndex].name;
			boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -4 to spd & res.<br>";
		}
		if(this.hasExactly("Atk Spd Link 4")){
			enemy.combatSpur.spd -= 4;
			enemy.combatSpur.def -= 2;
			enemy.combatSpur.res -= 2;
			skillName = data.skills[this.bIndex].name;
			boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -4 to spd & -2 def/res.<br>";
		}
		if(this.hasExactly("Assault Force") && (this.initiator || this.buddy.adjacent > 0 || this.buddy.two > 0)){
			enemy.combatSpur.spd -= 4;
			enemy.combatSpur.def -= 4;
			if(this.penalty.panic){
				this.combatBuffs = {"atk":0,"spd":0,"def":0,"res":0};
				this.buffs = {"atk":0,"spd":0,"def":0,"res":0};
			}
			this.combatDebuffs = {"atk":0,"spd":0,"def":0,"res":0};
			this.debuffs = {"atk":0,"spd":0,"def":0,"res":0};
			skillName = data.skills[this.bIndex].name;
			boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -4 to spd & def and neutralizes penalties.<br>";
		}
		if(this.hasExactly("Edged Scales") && (!this.initiator || this.combatStartHp / this.maxHp >= 0.25)){
			enemy.combatSpur.spd -= 4;
			enemy.combatSpur.def -= 4;
			enemy.combatSpur.res -= 4;
			boostText += this.name + " has activated Edged Scales. Effect on " + enemy.name + ": -4 to spd/def/res.<br>";
		}
		if(this.hasExactly("Get Behind Me") && (this.initiator || this.toggle.b == 1)){
			var dPen = 5;
			dPen += Math.floor(allStats[22] * 0.3);
			enemy.combatSpur.spd -= 5;
			enemy.combatSpur.def -= dPen;
			skillName = data.skills[this.bIndex].name;
			boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -5 to spd & -" + dPen + " to def.<br>";
		}
		if((this.hasExactly("Holy War's End 2") || this.hasExactly("Sunlit Bangle D")) && this.combatStartHp / this.maxHp >= 0.25){
			enemy.combatSpur.atk -= 5;
			enemy.combatSpur.def -= 5;
			skillName = data.skills[this.bIndex].name;
			boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -5 to atk & def.<br>";
		}
		if(this.hasExactly("Gold Unwinding") || (this.hasExactly("Spoil Rotten") && this.combatStartHp / this.maxHp >= 0.25)){
			enemy.combatSpur.spd -= 5;
			enemy.combatSpur.res -= 5;
			skillName = data.skills[this.bIndex].name;
			boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -5 to spd & res.<br>";
		}
		if(((this.hasExactly("Deep Star") || this.hasExactly("I Remember...")) && (this.initiator || this.buddy.adjacent > 0 || this.buddy.two > 0)) || this.hasExactly("Yngvi Ascendant+") || (this.hasExactly("Fallen Star 2") && (this.initiator || this.bonus.dStar))){
			enemy.combatSpur.spd -= 5;
			enemy.combatSpur.def -= 5;
			skillName = data.skills[this.bIndex].name;
			boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -5 to spd & def.<br>";
		}
		if(this.hasExactly("Atrocity 2") && enemy.combatStartHp / enemy.maxHp >= 0.4){
			enemy.combatSpur.atk -= 4;
			enemy.combatSpur.spd -= 4;
			enemy.combatSpur.def -= 4;
			skillName = data.skills[this.bIndex].name;
			boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -4 to atk/spd/def.<br>";
		}
		if(((this.hasExactly("Ice Prince's Seal") || this.hasExactly("Dark Perfume")) && this.combatStartHp / this.maxHp >= 0.25) || this.hasExactly("Moonlit Bangle Q")){
			enemy.combatSpur.atk -= 5;
			enemy.combatSpur.spd -= 5;
			enemy.combatSpur.def -= 5;
			skillName = data.skills[this.bIndex].name;
			boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -5 to atk/spd/def.<br>";
		}
		if(this.hasExactly("Divine Strength")){
			var dsVal = 5;
			if(allStats[16] >= allStats[20] - 5){
				dsVal += 6;
			}
			if(allStats[18] >= allStats[22] - 5){
				dsVal += 6;
			}
			enemy.combatSpur.atk -= dsVal;
			enemy.combatSpur.def -= dsVal;
			skillName = data.skills[this.bIndex].name;
			boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -" + dsVal + " to atk & def.<br>";
		}
		if(this.hasExactly("Shadow Slide") && this.buddy.adjacent + this.buddy.two + this.buddy.three > 0){
			enemy.combatSpur.atk -= 5;
			enemy.combatSpur.spd -= 5;
			enemy.combatSpur.def -= 5;
			skillName = data.skills[this.bIndex].name;
			boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -5 to atk/spd/def.<br>";
		}
		if(this.hasExactly("Dragon's Scales") && (!this.initiator || this.combatStartHp / this.maxHp >= 0.25)){
			var dsVal = Math.max(allStats[18] - allStats[22], allStats[19] - allStats[23], 0) + 4;
			dsVal = Math.min(dsVal, 11);
			enemy.combatSpur.atk -= dsVal;
			enemy.combatSpur.def -= dsVal;
			enemy.combatSpur.res -= dsVal;
			boostText += this.name + " has activated Dragon's Scales. Effect on " + enemy.name + ": -" + dsVal + " to atk/def/res.<br>";
		}
		if(this.hasExactly("Spd Res Discord") && (enemy.penalty.discord || this.toggle.b % 10 > 0)){
			var srVal = this.toggle.b % 10;
			if(enemy.penalty.discord){
				srVal++;
			}
			srVal = srVal * 2 + 4;
			enemy.combatSpur.spd -= srVal;
			enemy.combatSpur.res -= srVal;
			boostText += this.name + " has activated Spd Res Discord. Effect on " + enemy.name + ": -" + srVal + " to spd & res.<br>";
		}
		if(this.hasExactly("Atk Res Discord") && (enemy.penalty.discord || this.toggle.b % 10 > 0)){
			var srVal = this.toggle.b % 10;
			if(enemy.penalty.discord){
				srVal++;
			}
			srVal = srVal * 2 + 4;
			enemy.combatSpur.atk -= srVal;
			enemy.combatSpur.res -= srVal;
			boostText += this.name + " has activated Atk Res Discord. Effect on " + enemy.name + ": -" + srVal + " to atk & res.<br>";
		}
		if(this.hasExactly("Def Res Discord") && (enemy.penalty.discord || this.toggle.b % 10 > 0)){
			var srVal = this.toggle.b % 10;
			if(enemy.penalty.discord){
				srVal++;
			}
			srVal = srVal * 2 + 4;
			enemy.combatSpur.def -= srVal;
			enemy.combatSpur.res -= srVal;
			boostText += this.name + " has activated Def Res Discord. Effect on " + enemy.name + ": -" + srVal + " to def & res.<br>";
		}
		if(this.hasExactly("Vedrfolnir's Wing") && this.combatStartHp / this.maxHp >= 0.25){
			var extraStats = [5,5,5];
			if(checkAllBuffs(enemy, this, currTurn) && allStats[9]){
				if(!allStats[15][0]){
					extraStats[0] += Math.max(enemy.buffs.atk,enemy.combatBuffs.atk) * 2;
				}
				if(!allStats[15][1]){
					extraStats[1] += Math.max(enemy.buffs.spd,enemy.combatBuffs.spd) * 2;
				}
				if(!allStats[15][2]){
					extraStats[2] += Math.max(enemy.buffs.def,enemy.combatBuffs.def) * 2;
				}
			}
			enemy.combatSpur.atk -= extraStats[0];
			enemy.combatSpur.spd -= extraStats[1];
			enemy.combatSpur.def -= extraStats[2];
			boostText += this.name + " inflicts -" + extraStats[0] + " atk/-" + extraStats[1] + " spd/-" + extraStats[2] + " def to " + enemy.name + " from HP >= 25% with Vedrfolnir's Wing.<br>";
		}
		if(this.hasExactly("Brutal Ferocity") && (!this.initiator || this.combatStartHp / this.maxHp >= 0.25)){
			var bfVal = Math.min(5 + this.maxHp - enemy.combatStartHp, 18);
			bfVal = Math.max(bfVal, 8);
			enemy.combatSpur.atk -= bfVal;
			enemy.combatSpur.def -= bfVal;
			boostText += this.name + " inflicts -" + bfVal + " atk & def to " + enemy.name + " from enemy initiating or HP >= 25% with Brutal Ferocity.<br>";
		}
		if(this.hasExactly("Yggdrasill's Alter")){
			var yaVal = this.toggle.b % 10;
			if(enemy.penalty.discord){
				yaVal++;
			}
			yaVal = yaVal * 3 + 5;
			enemy.combatSpur.atk -= yaVal;
			enemy.combatSpur.def -= yaVal;
			boostText += this.name + " inflicts -" + yaVal + " atk & def to " + enemy.name + " with Yggdrasill's Alter.<br>";
		}
		if(this.hasExactly("Heavenly Wings") &&  this.combatStartHp / this.maxHp >= 0.25){
			var hwVal = Math.min(this.buddy.spaces * 3 + 5, 14);
			enemy.combatSpur.atk -= hwVal;
			enemy.combatSpur.spd -= hwVal;
			enemy.combatSpur.def -= hwVal;
			boostText += this.name + " inflicts -" + hwVal + " atk/spd/def to " + enemy.name + " from HP >= 25% with Heavenly Wings.<br>";
		}
		if(this.hasExactly("Pure Dragon Wall")){
			enemy.combatSpur.atk -= 5;
			enemy.combatSpur.def -= 5;
			enemy.combatSpur.res -= 5;
			skillName = data.skills[this.bIndex].name;
			boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -5 to atk/def/res.<br>";
		}
		if(this.hasExactly("Faithful Loyalty 2") || this.hasExactly("Shield of Hope")){
			enemy.combatSpur.atk -= 5;
			enemy.combatSpur.spd -= 5;
			enemy.combatSpur.def -= 5;
			skillName = data.skills[this.bIndex].name;
			boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -5 to atk/spd/def.<br>";
		}
		if(this.hasExactly("Mounting Fear")){
			enemy.combatSpur.atk -= 5;
			enemy.combatSpur.res -= 5;
			skillName = data.skills[this.bIndex].name;
			boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -5 to atk & res.<br>";
		}
		
		if(this.hasExactly("Inevitable Death") || this.hasExactly("Fetters of Dromi") || this.hasExactly("Heart of Crimea")){
			enemy.combatSpur.atk -= 4;
			enemy.combatSpur.spd -= 4;
			enemy.combatSpur.def -= 4;
			enemy.combatSpur.res -= 4;
			skillName = data.skills[this.cIndex].name;
			boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -4 to all stats.<br>";
		}
		if(this.hasExactly("Inevitable Death+")){
			enemy.combatSpur.atk -= 5;
			enemy.combatSpur.spd -= 5;
			enemy.combatSpur.def -= 5;
			enemy.combatSpur.res -= 5;
			skillName = data.skills[this.cIndex].name;
			boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -5 to all stats.<br>";
		}
		if(this.hasExactly("Impenetrable Void")){
			enemy.combatSpur.atk -= 5;
			enemy.combatSpur.spd -= 5;
			enemy.combatSpur.def -= 5;
			enemy.combatSpur.res -= 5;
			skillName = data.skills[this.cIndex].name;
			boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -5 to all stats.<br>";
		}
		if(this.hasExactly("Rallying Cry") && this.toggle.c > 1){
			enemy.combatSpur.spd -= 5;
			enemy.combatSpur.def -= 5;
			enemy.combatSpur.res -= 5;
			skillName = data.skills[this.cIndex].name;
			boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -5 to spd/def/res.<br>";
		}
		if(this.hasExactly("Deadly Miasma") && this.initiator){
			enemy.combatSpur.atk -= 5;
			enemy.combatSpur.spd -= 5;
			enemy.combatSpur.def -= 5;
			enemy.combatSpur.res -= 5;
			skillName = data.skills[this.cIndex].name;
			boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -5 to all stats.<br>";
		}
		if(this.hasExactly("Divine Nectar") && this.buddy.adjacent + this.buddy.two + this.buddy.three > 0){
			enemy.combatSpur.atk -= 5;
			enemy.combatSpur.def -= 5;
			skillName = data.skills[this.cIndex].name;
			boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -5 to atk & def.<br>";
		}
		//Rein skills
		if(this.hasSlot("Atk Spd Rein","c")){
			var debuffVal = this.hasSlot("Atk Spd Rein","c") + 1;
			enemy.combatSpur.atk -= debuffVal;
			enemy.combatSpur.spd -= debuffVal;
			skillName = data.skills[this.cIndex].name;
			boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -" + debuffVal + " to atk & spd.<br>";
		}
		else if(this.hasSlot("Spd Def Rein","c")){
			var debuffVal = this.hasSlot("Spd Def Rein","c") + 1;
			enemy.combatSpur.spd -= debuffVal;
			enemy.combatSpur.def -= debuffVal;
			skillName = data.skills[this.cIndex].name;
			boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -" + debuffVal + " to spd & def.<br>";
		}
		else if(this.hasSlot("Atk Res Rein","c")){
			var debuffVal = this.hasSlot("Atk Res Rein","c") + 1;
			enemy.combatSpur.atk -= debuffVal;
			enemy.combatSpur.res -= debuffVal;
			skillName = data.skills[this.cIndex].name;
			boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -" + debuffVal + " to atk & res.<br>";
		}
		else if(this.has("Atk Def Rein")){
			var debuffVal = this.has("Atk Def Rein") + 1;
			enemy.combatSpur.atk -= debuffVal;
			enemy.combatSpur.def -= debuffVal;
			skillName = data.skills[this.cIndex].name;
			boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -" + debuffVal + " to atk & def.<br>";
		}
		else if(this.has("Spd Res Rein")){
			var debuffVal = this.has("Spd Res Rein") + 1;
			enemy.combatSpur.spd -= debuffVal;
			enemy.combatSpur.res -= debuffVal;
			skillName = data.skills[this.cIndex].name;
			boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -" + debuffVal + " to spd & res.<br>";
		}
		else if(this.has("Def Res Rein")){
			var debuffVal = this.has("Def Res Rein") + 1;
			enemy.combatSpur.def -= debuffVal;
			enemy.combatSpur.res -= debuffVal;
			skillName = data.skills[this.cIndex].name;
			boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -" + debuffVal + " to def & res.<br>";
		}
		else if(this.hasExactly("Spd Res Hold") || this.hasExactly("Spd Res Crux")){
			enemy.combatSpur.spd -= 4;
			enemy.combatSpur.res -= 4;
			boostText += this.name + " has activated " + data.skills[this.cIndex].name + ". Effect on " + enemy.name + ": -4 to spd & res.<br>";
		}
		else if(this.hasExactly("Atk Res Hold") || this.hasExactly("Atk Res Crux")){
			enemy.combatSpur.atk -= 4;
			enemy.combatSpur.res -= 4;
			skillName = data.skills[this.cIndex].name;
			boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -4 to atk & res.<br>";
		}
		else if(this.hasExactly("Spd Def Hold") || this.hasExactly("SD Rein Snap") || this.hasExactly("Spd Def Crux") || this.hasExactly("SD Hold Guide")){
			enemy.combatSpur.spd -= 4;
			enemy.combatSpur.def -= 4;
			skillName = data.skills[this.cIndex].name;
			boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -4 to spd & def.<br>";
		}
		else if(this.hasExactly("Atk Def Hold")){
			enemy.combatSpur.atk -= 4;
			enemy.combatSpur.def -= 4;
			skillName = data.skills[this.cIndex].name;
			boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -4 to atk & def.<br>";
		}
		else if(this.hasExactly("Atk Spd Hold") || this.hasExactly("AS Rein Snap")){
			enemy.combatSpur.atk -= 4;
			enemy.combatSpur.spd -= 4;
			skillName = data.skills[this.cIndex].name;
			boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -4 to atk & spd.<br>";
		}
		else if(this.hasExactly("Def Res Hold")){
			enemy.combatSpur.def -= 4;
			enemy.combatSpur.res -= 4;
			skillName = data.skills[this.cIndex].name;
			boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -4 to def & res.<br>";
		}
		else if(this.hasExactly("Pulse Smog")){
			enemy.combatSpur.spd -= 3;
			enemy.combatSpur.def -= 3;
			skillName = data.skills[this.cIndex].name;
			boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -3 to spd & def.<br>";
		}
		
		//Feud skills
		if(this.has("Red Feud") > 1 && enemy.color == "red"){
			var debuffVal = 2;
			if(this.hasExactly("Red Feud 3")){
				debuffVal = 4;
			}
			enemy.combatSpur.atk -= debuffVal;
			enemy.combatSpur.spd -= debuffVal;
			enemy.combatSpur.def -= debuffVal;
			enemy.combatSpur.res -= debuffVal;
			skillName = data.skills[this.cIndex].name;
			boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -" + debuffVal + " to all stats.<br>";
		}
		if(this.has("C Feud") > 1 && enemy.color == "gray"){
			var debuffVal = 2;
			if(this.hasExactly("C Feud 3")){
				debuffVal = 4;
			}
			enemy.combatSpur.atk -= debuffVal;
			enemy.combatSpur.spd -= debuffVal;
			enemy.combatSpur.def -= debuffVal;
			enemy.combatSpur.res -= debuffVal;
			skillName = data.skills[this.cIndex].name;
			boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -" + debuffVal + " to all stats.<br>";
		}
		if(this.has("Green Feud") > 1 && enemy.color == "green"){
			var debuffVal = 2;
			if(this.hasExactly("Green Feud 3")){
				debuffVal = 4;
			}
			enemy.combatSpur.atk -= debuffVal;
			enemy.combatSpur.spd -= debuffVal;
			enemy.combatSpur.def -= debuffVal;
			enemy.combatSpur.res -= debuffVal;
			skillName = data.skills[this.cIndex].name;
			boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -" + debuffVal + " to all stats.<br>";
		}
		if(this.has("Blue Feud") > 1 && enemy.color == "blue"){
			var debuffVal = 2;
			if(this.hasExactly("Blue Feud 3")){
				debuffVal = 4;
			}
			enemy.combatSpur.atk -= debuffVal;
			enemy.combatSpur.spd -= debuffVal;
			enemy.combatSpur.def -= debuffVal;
			enemy.combatSpur.res -= debuffVal;
			skillName = data.skills[this.cIndex].name;
			boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -" + debuffVal + " to all stats.<br>";
		}
		if(this.hasExactly("Preempt Screech")){
			enemy.combatSpur.spd -= 4;
			enemy.combatSpur.def -= 4;
			skillName = data.skills[this.cIndex].name;
			boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -4 to spd & def.<br>";
		}
		//S Skills
		if(this.hasSlot("Atk Res Rein","s")){
			var debuffVal = this.hasSlot("Atk Res Rein","s") + 1;
			enemy.combatSpur.atk -= debuffVal;
			enemy.combatSpur.res -= debuffVal;
			skillName = data.skills[this.sIndex].name;
			boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -" + debuffVal + " to atk & res.<br>";
		}
		else if(this.hasSlot("Spd Def Rein","s")){
			var debuffVal = this.hasSlot("Spd Def Rein","s") + 1;
			enemy.combatSpur.spd -= debuffVal;
			enemy.combatSpur.def -= debuffVal;
			skillName = data.skills[this.sIndex].name;
			boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -" + debuffVal + " to spd & def.<br>";
		}
		else if(this.hasSlot("Atk Spd Rein","s")){
			var debuffVal = this.hasSlot("Atk Spd Rein","s") + 1;
			enemy.combatSpur.atk -= debuffVal;
			enemy.combatSpur.spd -= debuffVal;
			skillName = data.skills[this.sIndex].name;
			boostText += this.name + " has activated " + skillName + ". Effect on " + enemy.name + ": -" + debuffVal + " to atk & spd.<br>";
		}
		//X Skills
		if(this.hasExactly("Lull Echo") && Object.values(enemy.bonus).reduce((a, item) => a + (item === true ? 1 : 0), 0) + enemy.bonus.extra > 0){
			var leVal = Math.min(Object.values(enemy.bonus).reduce((a, item) => a + (item === true ? 1 : 0), 0) + enemy.bonus.extra, 4);
			enemy.combatSpur.atk -= leVal;
			enemy.combatSpur.spd -= leVal;
			enemy.combatSpur.def -= leVal;
			enemy.combatSpur.res -= leVal;
			boostText += this.name + " has activated Lull Echo. Effect on " + enemy.name + ": -" + leVal + " to all stats.<br>";
		}
		
		if(this.bonus.penDoubler == true){
			var eNegate = this.checkNegate(enemy, currTurn);
			var dAtk = 0;
			var dSpd = 0;
			var dDef = 0;
			var dRes = 0;
			if(eNegate[0] == false){
				dAtk += Math.min(enemy.combatDebuffs.atk,enemy.debuffs.atk);
				if(enemy.penalty.panic){
					dAtk -= Math.max(enemy.combatBuffs.atk,enemy.buffs.atk);
				}
			}
			if(eNegate[1] == false){
				dSpd += Math.min(enemy.combatDebuffs.spd,enemy.debuffs.spd);
				if(enemy.penalty.panic){
					dSpd -= Math.max(enemy.combatBuffs.spd,enemy.buffs.spd);
				}
			}
			if(eNegate[2] == false){
				dDef += Math.min(enemy.combatDebuffs.def,enemy.debuffs.def);
				if(enemy.penalty.panic){
					dDef -= Math.max(enemy.combatBuffs.def,enemy.buffs.def);
				}
			}
			if(eNegate[3] == false){
				dRes += Math.min(enemy.combatDebuffs.res,enemy.debuffs.res);
				if(enemy.penalty.panic){
					dRes -= Math.max(enemy.combatBuffs.res,enemy.buffs.res);
				}
			}
			enemy.combatSpur.atk += dAtk;
			enemy.combatSpur.spd += dSpd;
			enemy.combatSpur.def += dDef;
			enemy.combatSpur.res += dRes;
			boostText += this.name + " inflicts " + dAtk + " atk/" + dSpd + " spd/" + dDef + " def/" + dRes + " res on " + enemy.name + " from Foe Penalty Doubler.<br>";
		}
		if(enemy.penalty.sabotage == true){
			var eNegate = this.checkNegate(enemy, currTurn);
			var dAtk = 0;
			var dSpd = 0;
			var dDef = 0;
			var dRes = 0;
			if(eNegate[0] == false){
				dAtk += Math.min(enemy.combatDebuffs.atk,enemy.debuffs.atk);
				if(enemy.penalty.panic){
					dAtk -= Math.max(enemy.combatBuffs.atk,enemy.buffs.atk);
				}
			}
			dAtk = Math.min(dAtk, enemy.buddy.debuffs.atk);
			if(eNegate[1] == false){
				dSpd += Math.min(enemy.combatDebuffs.spd,enemy.debuffs.spd);
				if(enemy.penalty.panic){
					dSpd -= Math.max(enemy.combatBuffs.spd,enemy.buffs.spd);
				}
			}
			dSpd = Math.min(dSpd, enemy.buddy.debuffs.spd);
			if(eNegate[2] == false){
				dDef += Math.min(enemy.combatDebuffs.def,enemy.debuffs.def);
				if(enemy.penalty.panic){
					dDef -= Math.max(enemy.combatBuffs.def,enemy.buffs.def);
				}
			}
			dDef = Math.min(dDef, enemy.buddy.debuffs.def);
			if(eNegate[3] == false){
				dRes += Math.min(enemy.combatDebuffs.res,enemy.debuffs.res);
				if(enemy.penalty.panic){
					dRes -= Math.max(enemy.combatBuffs.res,enemy.buffs.res);
				}
			}
			dRes = Math.min(dRes, enemy.buddy.debuffs.res);
			enemy.combatSpur.atk += dAtk;
			enemy.combatSpur.spd += dSpd;
			enemy.combatSpur.def += dDef;
			enemy.combatSpur.res += dRes;
			boostText += enemy.name + " is inflicted with " + dAtk + " atk/" + dSpd + " spd/" + dDef + " def/" + dRes + " res from [Sabotage].<br>";
		}
		if(enemy.penalty.discord == true){
			var dVal = enemy.buddy.adjacent + enemy.buddy.two + 2;
			dVal = Math.min(dVal,5);
			enemy.combatSpur.atk -= dVal;
			enemy.combatSpur.spd -= dVal;
			enemy.combatSpur.def -= dVal;
			enemy.combatSpur.res -= dVal;
			boostText += enemy.name + " is inflicted with -" + dVal + " to all stats from [Discord].<br>";
		}
		if(enemy.penalty.tGrip == true){
			enemy.combatSpur.atk -= 4;
			enemy.combatSpur.spd -= 4;
			enemy.combatSpur.def -= 4;
			enemy.combatSpur.res -= 4;
			boostText += enemy.name + " is inflicted with -4 to all stats from [Time's Grip].<br>";
		}
		if(enemy.penalty.hush == true){
			enemy.combatSpur.atk -= 5;
			enemy.combatSpur.spd -= 5;
			enemy.combatSpur.def -= 5;
			enemy.combatSpur.res -= 5;
			boostText += enemy.name + " is inflicted with -5 to all stats from [Hush Spectrum].<br>";
		}
		if(enemy.penalty.spoils == true){
			enemy.combatSpur.atk -= 5;
			enemy.combatSpur.spd -= 5;
			enemy.combatSpur.def -= 5;
			enemy.combatSpur.res -= 5;
			boostText += enemy.name + " is inflicted with -5 to all stats from [Share Spoils].<br>";
		}
		if(enemy.vein == 4){
			enemy.combatSpur.atk -= 5;
			enemy.combatSpur.spd -= 5;
			enemy.combatSpur.def -= 5;
			enemy.combatSpur.res -= 5;
			boostText += enemy.name + " is inflicted with -5 to all stats from Divine Vein (Haze).<br>";
		}
		if(enemy.vein == 5){
			enemy.combatSpur.spd -= 5;
			boostText += enemy.name + " is inflicted with -5 to spd from Divine Vein (Water).<br>";
		}
		
		//this.blow = function(){
		if(this.initiator){
			var skillName = "";
			var buffVal = 0;
			
			if(this.has("Death Blow")){
				if(this.hasSlot("Death Blow","a")){
					buffVal = this.hasSlot("Death Blow","a") * 2;
					skillName = data.skills[this.aIndex].name;
					this.combatSpur.atk += buffVal;
					boostText += this.name + " gets +" + buffVal + " atk from initiating with " + skillName + ".<br>";
				}
				if(this.hasSlot("Death Blow","s")){
					buffVal = this.hasSlot("Death Blow","s") * 2;
					skillName = data.skills[this.sIndex].name;
					this.combatSpur.atk += buffVal;
					boostText += this.name + " gets +" + buffVal + " atk from initiating with " + skillName + ".<br>";
				}
				if(this.hasExactly("Death Blow Echo")){
					this.combatSpur.atk += 4;
					boostText += this.name + " gets +4 atk from initiating with Death Blow Echo.<br>";
				}
			}
			if(this.has("Darting Blow")){
				if(this.hasSlot("Darting Blow","a")){
					buffVal = this.hasSlot("Darting Blow","a") * 2;
					if(buffVal == 8){
						buffVal++;
					}
					skillName = data.skills[this.aIndex].name;
					this.combatSpur.spd += buffVal;
					boostText += this.name + " gets +" + buffVal + " spd from initiating with " + skillName + ".<br>";
				}
				if(this.hasSlot("Darting Blow","s")){
					buffVal = this.hasSlot("Darting Blow","s") * 2;
					skillName = data.skills[this.sIndex].name;
					this.combatSpur.spd += buffVal;
					boostText += this.name + " gets +" + buffVal + " spd from initiating with " + skillName + ".<br>";
				}
			}
			if(this.hasExactly("Fleeting Echo")){
				this.combatSpur.spd += 2;
				boostText += this.name + " gets +2 spd from initiating with Fleeting Echo.<br>";
			}
			if(this.has("Armored Blow")){
				if(this.hasSlot("Armored Blow","a")){
					buffVal = this.hasSlot("Armored Blow","a") * 2;
					skillName = data.skills[this.aIndex].name;
					this.combatSpur.def += buffVal;
					boostText += this.name + " gets +" + buffVal + " def from initiating with " + skillName + ".<br>";
				}
				if(this.hasSlot("Armored Blow","s")){
					buffVal = this.hasSlot("Armored Blow","s") * 2;
					skillName = data.skills[this.sIndex].name;
					this.combatSpur.def += buffVal;
					boostText += this.name + " gets +" + buffVal + " def from initiating with " + skillName + ".<br>";
				}
			}
			if(this.has("Warding Blow")){
				if(this.hasSlot("Warding Blow","a")){
					buffVal = this.hasSlot("Warding Blow","a") * 2;
					skillName = data.skills[this.aIndex].name;
					this.combatSpur.res += buffVal;
					boostText += this.name + " gets +" + buffVal + " res from initiating with " + skillName + ".<br>";
				}
				if(this.hasSlot("Warding Blow","s")){
					buffVal = this.hasSlot("Warding Blow","s") * 2;
					skillName = data.skills[this.sIndex].name;
					this.combatSpur.res += buffVal;
					boostText += this.name + " gets +" + buffVal + " res from initiating with " + skillName + ".<br>";
				}
			}
			if(this.has("Swift Sparrow")){
				if(this.hasSlot("Swift Sparrow","a")){
					buffVal = this.hasSlot("Swift Sparrow","a") * 2;
					var spdVal = buffVal;
					if(this.hasExactly("Swift Sparrow 3")){
						spdVal++;
					}
					else if(this.hasExactly("Sly Swift Sparrow")){
						buffVal = 8;
						spdVal = 8;
					}
					skillName = data.skills[this.aIndex].name;
					this.combatSpur.atk += buffVal;
					this.combatSpur.spd += spdVal;
					boostText += this.name + " gets +" + buffVal + " atk and +" + spdVal + " spd from initiating with " + skillName + ".<br>";
				}
				if(this.hasSlot("Swift Sparrow","s")){
					buffVal = this.hasSlot("Swift Sparrow","s") * 2;
					skillName = data.skills[this.sIndex].name;
					this.combatSpur.atk += buffVal;
					this.combatSpur.spd += buffVal;
					boostText += this.name + " gets +" + buffVal + " atk and spd from initiating with " + skillName + ".<br>";
				}
			}
			if(this.has("Sturdy Blow") && !this.hasExactly("Sly Sturdy Blow")){
				if(this.hasSlot("Sturdy Blow","a")){
					buffVal = this.hasSlot("Sturdy Blow","a") * 2;
					skillName = data.skills[this.aIndex].name;
					this.combatSpur.atk += buffVal;
					this.combatSpur.def += buffVal;
					boostText += this.name + " gets +" + buffVal + " atk and def from initiating with " + skillName + ".<br>";
				}
				if(this.hasSlot("Sturdy Blow","s")){
					buffVal = this.hasSlot("Sturdy Blow","s") * 2;
					skillName = data.skills[this.sIndex].name;
					this.combatSpur.atk += buffVal;
					this.combatSpur.def += buffVal;
					boostText += this.name + " gets +" + buffVal + " atk and def from initiating with " + skillName + ".<br>";
				}
			}
			if(this.has("Mirror Strike")){
				if(this.hasSlot("Mirror Strike","a")){
					buffVal = this.hasSlot("Mirror Strike","a") * 2;
					skillName = data.skills[this.aIndex].name;
					this.combatSpur.atk += buffVal;
					this.combatSpur.res += buffVal;
					boostText += this.name + " gets +" + buffVal + " atk and res from initiating with " + skillName + ".<br>";
				}
				if(this.hasSlot("Mirror Strike","s")){
					buffVal = this.hasSlot("Mirror Strike","s") * 2;
					skillName = data.skills[this.sIndex].name;
					this.combatSpur.atk += buffVal;
					this.combatSpur.res += buffVal;
					boostText += this.name + " gets +" + buffVal + " atk and res from initiating with " + skillName + ".<br>";
				}
			}
			if(this.has("Steady Blow")){
				if(this.hasSlot("Steady Blow","a")){
					buffVal = this.hasSlot("Steady Blow","a") * 2;
					skillName = data.skills[this.aIndex].name;
					this.combatSpur.spd += buffVal;
					this.combatSpur.def += buffVal;
					boostText += this.name + " gets +" + buffVal + " spd and def from initiating with " + skillName + ".<br>";
				}
				if(this.hasSlot("Steady Blow","s")){
					buffVal = this.hasSlot("Steady Blow","s") * 2;
					skillName = data.skills[this.sIndex].name;
					this.combatSpur.spd += buffVal;
					this.combatSpur.def += buffVal;
					boostText += this.name + " gets +" + buffVal + " spd and def from initiating with " + skillName + ".<br>";
				}
			}
			if(this.has("Swift Strike")){
				if(this.hasSlot("Swift Strike","a")){
					buffVal = this.hasSlot("Swift Strike","a") * 2;
					skillName = data.skills[this.aIndex].name;
					this.combatSpur.spd += buffVal;
					this.combatSpur.res += buffVal;
					boostText += this.name + " gets +" + buffVal + " spd and res from initiating with " + skillName + ".<br>";
				}
				if(this.hasSlot("Swift Strike","s")){
					buffVal = this.hasSlot("Swift Strike","s") * 2;
					skillName = data.skills[this.sIndex].name;
					this.combatSpur.spd += buffVal;
					this.combatSpur.res += buffVal;
					boostText += this.name + " gets +" + buffVal + " spd and res from initiating with " + skillName + ".<br>";
				}
			}
			if(this.has("Bracing Blow")){
				if(this.hasSlot("Bracing Blow","a")){
					buffVal = this.hasSlot("Bracing Blow","a") * 2;
					skillName = data.skills[this.aIndex].name;
					this.combatSpur.def += buffVal;
					this.combatSpur.res += buffVal;
					boostText += this.name + " gets +" + buffVal + " def and res from initiating with " + skillName + ".<br>";
				}
				if(this.hasSlot("Bracing Blow","s")){
					buffVal = this.hasSlot("Bracing Blow","s") * 2;
					skillName = data.skills[this.sIndex].name;
					this.combatSpur.def += buffVal;
					this.combatSpur.res += buffVal;
					boostText += this.name + " gets +" + buffVal + " def and res from initiating with " + skillName + ".<br>";
				}
			}
			if(this.hasExactly("Sturdy Impact") || this.hasExactly("Sly Sturdy Blow")){
				buffVal = 6;
				if(this.hasExactly("Sly Sturdy Blow")){
					buffVal += 2;
				}
				var defVal = 10;
				skillName = data.skills[this.aIndex].name;
				this.combatSpur.atk += buffVal;
				this.combatSpur.def += defVal;
				boostText += this.name + " gets +" + buffVal + " atk and +" + defVal + " def from initiating with " + skillName + ".<br>";
			}
			if(this.hasExactly("Mirror Impact") || this.hasExactly("Sly Mirror")){
				buffVal = 6;
				if(this.hasExactly("Sly Mirror")){
					buffVal += 2;
				}
				var resVal = 10;
				skillName = data.skills[this.aIndex].name;
				this.combatSpur.atk += buffVal;
				this.combatSpur.res += resVal;
				boostText += this.name + " gets +" + buffVal + " atk and +" + resVal + " res from initiating with " + skillName + ".<br>";
			}
			if(this.hasExactly("Steady Impact")){
				buffVal = 7;
				var defVal = 10;
				skillName = data.skills[this.aIndex].name;
				this.combatSpur.spd += buffVal;
				this.combatSpur.def += defVal;
				boostText += this.name + " gets +" + buffVal + " spd and +" + defVal + " def from initiating with " + skillName + ".<br>";
			}
			if(this.hasExactly("Swift Impact")){
				buffVal = 7;
				var resVal = 10;
				skillName = data.skills[this.aIndex].name;
				this.combatSpur.spd += buffVal;
				this.combatSpur.res += resVal;
				boostText += this.name + " gets +" + buffVal + " spd and +" + resVal + " res from initiating with " + skillName + ".<br>";
			}
			if(this.hasExactly("Surge Sparrow") || this.hasExactly("Remote Sparrow") || this.hasExactly("Flash Sparrow") || this.hasExactly("Flared Sparrow")){
				buffVal = 7;
				skillName = data.skills[this.aIndex].name;
				this.combatSpur.atk += buffVal;
				this.combatSpur.spd += buffVal;
				boostText += this.name + " gets +" + buffVal + " atk and spd from initiating with " + skillName + ".<br>";
			}
			if(this.hasExactly("Sturdy Surge")){
				skillName = data.skills[this.aIndex].name;
				this.combatSpur.atk += 7;
				this.combatSpur.def += 10;
				boostText += this.name + " gets +7 atk and +10 def from initiating with " + skillName + ".<br>";
			}
			if(this.hasExactly("Remote Mirror") || this.hasExactly("Flared Mirror")){
				skillName = data.skills[this.aIndex].name;
				this.combatSpur.atk += 7;
				this.combatSpur.res += 10;
				boostText += this.name + " gets +7 atk and +10 res from initiating with " + skillName + ".<br>";
			}
			if(this.hasExactly("Remote Sturdy")){
				skillName = data.skills[this.aIndex].name;
				this.combatSpur.atk += 7;
				this.combatSpur.def += 10;
				boostText += this.name + " gets +7 atk and +10 def from initiating with " + skillName + ".<br>";
			}
			if(this.hasExactly("Fortifications")){
				skillName = data.skills[this.aIndex].name;
				this.combatSpur.def += 6;
				this.combatSpur.res += 6;
				boostText += this.name + " gets +6 def & res from initiating with " + skillName + ".<br>";
			}
			//Session skills
			if(this.has("Blade Session")){
				if(this.hasSlot("Blade Session","a")){
					buffVal = this.hasSlot("Blade Session","a") + (this.toggle.a * this.hasSlot("Blade Session","a"));
					skillName = data.skills[this.aIndex].name;
					this.combatSpur.atk += buffVal;
					this.combatSpur.spd += buffVal;
					boostText += this.name + " gets +" + buffVal + " atk and spd from initiating with " + skillName + ".<br>";
				}
				if(this.hasSlot("Blade Session","s")){
					buffVal = this.hasSlot("Blade Session","s") + (this.toggle.s * this.hasSlot("Blade Session","s"));
					skillName = data.skills[this.sIndex].name;
					this.combatSpur.atk += buffVal;
					this.combatSpur.spd += buffVal;
					boostText += this.name + " gets +" + buffVal + " atk and spd from initiating with " + skillName + ".<br>";
				}
			}
			//Weapons
			if(this.hasExactly("Durandal")){
				var txtStat = "+4 atk";
				this.combatSpur.atk += 4;
				if(this.rValue > 0){
					this.combatSpur.atk += 2;
					txtStat = "+6 atk";
					if(this.rValue == 5){
						this.combatSpur.atk += 4;
						this.combatSpur.spd += 4;
						txtStat = "+10 atk and +4 spd";
					}
				}
				boostText += this.name + " gets " + txtStat + " from initiating with Durandal.<br>";
			}
			else if(this.hasExactly("Dark Greatsword")){
				this.combatSpur.atk += 4;
				this.combatSpur.spd += 4;
				boostText += this.name + " gets +4 atk and spd from initiating with Dark Greatsword.<br>";
			}
			else if(this.hasExactly("Forblaze") && this.rValue == 5){
				this.combatSpur.atk += 6;
				boostText += this.name + " gets +6 atk from initiating with Forblaze.<br>";
			}
			else if((this.hasExactly("Hana's Katana") || this.hasExactly("Amiti")) && this.rValue == 5){
				this.combatSpur.atk += 4;
				this.combatSpur.spd += 4;
				boostText += this.name + " gets +4 atk and spd from initiating with " + data.skills[this.weaponIndex].name + ".<br>";
			}
			else if(this.hasExactly("Book of Orchids")){
				this.combatSpur.atk += 6;
				boostText += this.name + " gets +6 atk from initiating with Book of Orchids.<br>";
			}
			else if(this.hasExactly("Sanngridr")){
				buffVal = 3;
				if(this.rValue > 0){
					buffVal++;
				}
				this.combatSpur.atk += buffVal;
				this.combatSpur.spd += buffVal;
				boostText += this.name + " gets +" + buffVal + " atk and spd from initiating with " + data.skills[this.weaponIndex].name + ".<br>";
				//Refined
				if(this.rValue == 5){
					this.combatSpur.atk += 6;
					this.combatSpur.spd += 6;
					boostText += this.name + " gets +6 atk and spd from initiating with " + data.skills[this.weaponIndex].name + ".<br>";
				}
			}
			else if(this.has("Yato") && this.rValue < 0){
				this.combatSpur.spd += 4;
				boostText += this.name + " gets +4 spd from initiating with Yato.<br>";
			}
			else if((this.hasExactly("Tome Of Thoron") || this.hasExactly("Steady Lance")) && this.rValue == 5){
				this.combatSpur.spd += 6;
				boostText += this.name + " gets +6 spd from initiating with " + data.skills[this.weaponIndex].name + ".<br>";
			}
			else if(this.hasExactly("Parthia") && this.rValue < 0){
				this.combatSpur.res += 4;
				boostText += this.name + " gets +4 res from initiating with Parthia.<br>";
			}
			//Summer weapons
			else if(this.has("Shell Lance") || this.has("Cocobow") || this.has("Beach Banner")){
				skillName = data.skills[this.weaponIndex].name;
				this.combatSpur.atk += 2;
				this.combatSpur.spd += 2;
				this.combatSpur.def += 2;
				this.combatSpur.res += 2;
				boostText += this.name + " gets +2 to all stats from initiating with " + skillName + ".<br>";
			}
			//Thogn
			else if(this.has("Thogn") && this.rValue < 0 && enemy.range == "melee"){
				skillName = data.skills[this.weaponIndex].name;
				this.combatSpur.atk += 4;
				this.combatSpur.spd += 4;
				this.combatSpur.def += 4;
				this.combatSpur.res += 4;
				boostText += this.name + " gets +4 to all stats from initiating with " + skillName + ".<br>";
			}
			//Bridal Weapons
			else if(this.has("Lofty Blossoms") || this.has("Cake Cutter") || this.has("Vessel of Cheer") || this.has("Bouquet Bow") || this.hasExactly("Doting Staff")){
				skillName = data.skills[this.weaponIndex].name;
				this.combatSpur.atk += 4;
				this.combatSpur.spd += 4;
				boostText += this.name + " gets +4 to atk and spd from initiating with " + skillName + ".<br>";
			}
			//Ninis's Ice Lance
			else if(this.has("Ninis's Ice Lance") && this.rValue < 0){
				skillName = data.skills[this.weaponIndex].name;
				this.combatSpur.atk += 4;
				this.combatSpur.spd += 4;
				this.combatSpur.def += 4;
				this.combatSpur.res += 4;
				boostText += this.name + " gets +4 to all stats from initiating with " + skillName + ".<br>";
			}
			//Blazing Durandal Special Refined
			else if(this.hasExactly("Blazing Durandal") && this.rValue == 5){
				buffVal = 7;
				var defVal = 10;
				skillName = data.skills[this.weaponIndex].name;
				this.combatSpur.spd += buffVal;
				this.combatSpur.def += defVal;
				boostText += this.name + " gets +" + buffVal + " spd and +" + defVal + " def from initiating with " + skillName + ".<br>";
			}
			//Frederick's Axe refined
			else if(this.hasExactly("Frederick's Axe") && this.rValue == 5){
				this.combatSpur.atk += 6;
				boostText += this.name + " gets +6 atk from initiating with Frederick's Axe.<br>";
			}
			//Budding Bow/Melee Bouquet/Instant weapons
			else if(this.has("Budding Bow") || this.has("Melee Bouquet") || this.has("Instant Lance") || this.has("Instant Axe") || this.has("Instant Bow") || this.has("Instant Sword")){
				skillName = data.skills[this.weaponIndex].name;
				this.combatSpur.atk += 4;
				this.combatSpur.def += 4;
				boostText += this.name + " gets +4 atk and def from initiating with " + skillName + ".<br>";
			}
			//Candied Dagger
			else if(this.hasExactly("Candied Dagger")){
				this.combatSpur.spd += 4;
				boostText += this.name + " gets +4 spd from initiating with Candied Dagger.<br>";
			}
			//Hewn Lance
			else if(this.hasExactly("Hewn Lance") && this.rValue == 5){
				this.combatSpur.atk += 4;
				this.combatSpur.def += 4;
				boostText += this.name + " gets +4 atk and def from initiating with Hewn Lance.<br>";
			}
			//Courtly Fan
			else if(this.has("Courtly Fan")){
				this.combatSpur.atk += 5;
				this.combatSpur.spd += 5;
				skillName = data.skills[this.weaponIndex].name;
				boostText += this.name + " gets +5 atk and spd from initiating with " + skillName + ".<br>";
			}
			//Staff of Rausten
			else if(this.hasExactly("Staff of Rausten")){
				this.combatSpur.atk += 6;
				this.combatSpur.spd += 6;
				boostText += this.name + " gets +6 atk and spd from initiating with Staff of Rausten.<br>";
			}
			//Hoarfrost Knife
			else if(this.hasExactly("Hoarfrost Knife") && (this.rValue > 0 || (this.rValue < 0 && enemy.range == "melee"))){
				buffVal = 20;
				skillName = data.skills[this.weaponIndex].name;
				this.combatSpur.def += buffVal;
				boostText += this.name + " gets +" + buffVal + " def from initiating with " + skillName + ".<br>";
			}
			//Soleil's Shine Special Refined
			else if(this.hasExactly("Soleil's Shine") && this.rValue == 5){
				skillName = data.skills[this.weaponIndex].name;
				this.combatSpur.atk += 5;
				this.combatSpur.spd += 5;
				boostText += this.name + " gets +5 atk and spd from initiating with " + skillName + ".<br>";
			}
			//Vicious Dagger
			else if(this.has("Vicious Dagger")){
				skillName = data.skills[this.weaponIndex].name;
				this.combatSpur.atk += 5;
				this.combatSpur.spd += 5;
				boostText += this.name + " gets +5 atk and spd from initiating with " + skillName + ".<br>";
			}
		}

		//this.defendBuff = function(relevantDefType){
		if(!this.initiator){
			//Not actually going to limit text from relevantDefType, beccause res/def may always be relevant for special attacks
			var buffVal = 0;
			var skillName = "";
			//Weapons
			if((this.hasExactly("Binding Blade") && this.rValue > 0) || this.has("Water Breath") || (this.hasExactly("Naga") && this.rValue > 0)){
				this.combatSpur.def += 4;
				this.combatSpur.res += 4;
				boostText += this.name + " gets +4 def and res while defending with " + data.skills[this.weaponIndex].name + ".<br>";
			}
			else if(this.hasExactly("Binding Blade") || this.hasExactly("Naga")){
				this.combatSpur.def += 2;
				this.combatSpur.res += 2;
				boostText += this.name + " gets +2 def and res while defending with " + data.skills[this.weaponIndex].name + ".<br>";
			}
			else if(this.hasExactly("Berkut's Lance+") && this.rValue > 0){
				this.combatSpur.res += 7;
				boostText += this.name + " gets +7 res while defending with " + data.skills[this.weaponIndex].name + ".<br>";
			}
			else if(this.has("Berkut's Lance")){
				this.combatSpur.res += 4;
				boostText += this.name + " gets +4 res while defending with " + data.skills[this.weaponIndex].name + ".<br>";
			}
			else if(this.hasExactly("Bright Naginata") || this.has("Luncheon Lance") || (this.hasExactly("Daybreak Lance") && this.rValue == 5)){
				buffVal = 4;
				skillName = data.skills[this.weaponIndex].name;
				this.combatSpur.atk += buffVal;
				this.combatSpur.def += buffVal;
				boostText += this.name + " gets +" + buffVal + " atk and def from being attacked with " + skillName + ".<br>";
			}
			else if(this.has("Handbell") || this.has("Sack o Gifts") || this.has("Tannenboom!") || this.hasExactly("Candelabra") || this.hasExactly("Candelabra+")){
				buffVal = 2;
				skillName = data.skills[this.weaponIndex].name;
				this.combatSpur.atk += buffVal;
				this.combatSpur.spd += buffVal;
				this.combatSpur.def += buffVal;
				this.combatSpur.res += buffVal;
				boostText += this.name + " gets +" + buffVal + " atk/spd/def/res from being attacked with " + skillName + ".<br>";
			}
			else if(this.has("Safeguard") || this.has("Vanguard") || this.has("Rearguard")){
				buffVal = 7;
				skillName = data.skills[this.weaponIndex].name;
				this.combatSpur.def += buffVal;
				boostText += this.name + " gets +" + buffVal + " def from being attacked with " + skillName + ".<br>";
			}
			else if(this.hasExactly("Dauntless Lance") && this.rValue == 5){
				this.combatSpur.spd += 4;
				this.combatSpur.def += 4;
				boostText += this.name + " gets +4 spd and def while defending with " + data.skills[this.weaponIndex].name + ".<br>";
			}
			else if(this.has("Reprisal Lance") || this.has("Reprisal Axe")){
				skillName = data.skills[this.weaponIndex].name;
				this.combatSpur.atk += 6;
				boostText += this.name + " gets +6 atk from being attacked with " + skillName + ".<br>";
			}
			else if(this.has("Barrier Blade") || this.has("Barrier Lance") || this.has("Barrier Axe")){
				buffVal = 7;
				skillName = data.skills[this.weaponIndex].name;
				this.combatSpur.res += buffVal;
				boostText += this.name + " gets +" + buffVal + " res from being attacked with " + skillName + ".<br>";
			}
			else if(this.hasExactly("Hinata's Katana")){
				this.combatSpur.atk += 4;
				this.combatSpur.def += 4;
				boostText += this.name + " gets +4 atk and def while defending with " + data.skills[this.weaponIndex].name + ".<br>";
			}
			else if(this.hasExactly("Eternal Tome") && this.rValue == 5){
				this.combatSpur.def += 4;
				this.combatSpur.res += 4;
				boostText += this.name + " gets +4 def and res while defending with " + data.skills[this.weaponIndex].name + ".<br>";
			}
			else if(this.has("Sandwiches!")){
				buffVal = 4;
				skillName = data.skills[this.weaponIndex].name;
				this.combatSpur.atk += buffVal;
				this.combatSpur.res += buffVal;
				boostText += this.name + " gets +" + buffVal + " atk and res from being attacked with " + skillName + ".<br>";
			}
			
			//A Skills
			if(this.has("Steady Breath")){
				if(this.hasSlot("Steady Breath","a")){
					skillName = data.skills[this.aIndex].name;
					this.combatSpur.def += 4;
					boostText += this.name + " gets +4 def from being attacked with " + skillName + ".<br>";
				}
				if(this.hasSlot("Steady Breath","s")){
					skillName = data.skills[this.sIndex].name;
					this.combatSpur.def += 4;
					boostText += this.name + " gets +4 def from being attacked with " + skillName + ".<br>";
				}
			}
			if(this.has("Warding Breath")){
				if(this.hasSlot("Warding Breath","a")){
					skillName = data.skills[this.aIndex].name;
					this.combatSpur.res += 4;
					boostText += this.name + " gets +4 res from being attacked with " + skillName + ".<br>";
				}
				if(this.hasSlot("Warding Breath","s")){
					skillName = data.skills[this.sIndex].name;
					this.combatSpur.res += 4;
					boostText += this.name + " gets +4 res from being attacked with " + skillName + ".<br>";
				}
			}
			if(this.has("Fierce Breath")){
				if(this.hasSlot("Fierce Breath","a")){
					skillName = data.skills[this.aIndex].name;
					this.combatSpur.atk += 4;
					boostText += this.name + " gets +4 atk from being attacked with " + skillName + ".<br>";
				}
				if(this.hasSlot("Fierce Breath","s")){
					skillName = data.skills[this.sIndex].name;
					this.combatSpur.atk += 4;
					boostText += this.name + " gets +4 atk from being attacked with " + skillName + ".<br>";
				}
			}
			if(this.has("Darting Breath")){
				if(this.hasSlot("Darting Breath","a")){
					skillName = data.skills[this.aIndex].name;
					this.combatSpur.spd += 4;
					boostText += this.name + " gets +4 spd from being attacked with " + skillName + ".<br>";
				}
				if(this.hasSlot("Darting Breath","s")){
					skillName = data.skills[this.sIndex].name;
					this.combatSpur.spd += 4;
					boostText += this.name + " gets +4 spd from being attacked with " + skillName + ".<br>";
				}
			}
			if(this.has("Sturdy Stance")){
				if(this.hasSlot("Sturdy Stance","a")){
					buffVal = this.hasSlot("Sturdy Stance","a") * 2;
					skillName = data.skills[this.aIndex].name;
					this.combatSpur.atk += buffVal;
					this.combatSpur.def += buffVal;
					boostText += this.name + " gets +" + buffVal + " atk and def from being attacked with " + skillName + ".<br>";
				}
				if(this.hasSlot("Sturdy Stance","s")){
					buffVal = this.hasSlot("Sturdy Stance","s") * 2;
					skillName = data.skills[this.sIndex].name;
					this.combatSpur.atk += buffVal;
					this.combatSpur.def += buffVal;
					boostText += this.name + " gets +" + buffVal + " atk and def from being attacked with " + skillName + ".<br>";
				}
			}
			if(this.has("Mirror Stance")){
				if(this.hasSlot("Mirror Stance","a")){
					buffVal = this.hasSlot("Mirror Stance","a") * 2;
					skillName = data.skills[this.aIndex].name;
					this.combatSpur.atk += buffVal;
					this.combatSpur.res += buffVal;
					boostText += this.name + " gets +" + buffVal + " atk and res from being attacked with " + skillName + ".<br>";
				}
				if(this.hasSlot("Mirror Stance","s")){
					buffVal = this.hasSlot("Mirror Stance","s") * 2;
					skillName = data.skills[this.sIndex].name;
					this.combatSpur.atk += buffVal;
					this.combatSpur.res += buffVal;
					boostText += this.name + " gets +" + buffVal + " atk and res from being attacked with " + skillName + ".<br>";
				}
			}
			if(this.has("Swift Stance")){
				if(this.hasSlot("Swift Stance","a")){
					buffVal = this.hasSlot("Swift Stance","a") * 2;
					skillName = data.skills[this.aIndex].name;
					this.combatSpur.spd += buffVal;
					this.combatSpur.res += buffVal;
					boostText += this.name + " gets +" + buffVal + " spd and res from being attacked with " + skillName + ".<br>";
				}
				if(this.hasSlot("Swift Stance","s")){
					buffVal = this.hasSlot("Swift Stance","s") * 2;
					skillName = data.skills[this.sIndex].name;
					this.combatSpur.spd += buffVal;
					this.combatSpur.res += buffVal;
					boostText += this.name + " gets +" + buffVal + " spd and res from being attacked with " + skillName + ".<br>";
				}
			}
			if(this.has("Kestrel Stance")){
				if(this.hasSlot("Kestrel Stance","a")){
					buffVal = this.hasSlot("Kestrel Stance","a") * 2;
					skillName = data.skills[this.aIndex].name;
					this.combatSpur.atk += buffVal;
					this.combatSpur.spd += buffVal;
					boostText += this.name + " gets +" + buffVal + " atk and spd from being attacked with " + skillName + ".<br>";
				}
				if(this.hasSlot("Kestrel Stance","s")){
					buffVal = this.hasSlot("Kestrel Stance","s") * 2;
					skillName = data.skills[this.sIndex].name;
					this.combatSpur.atk += buffVal;
					this.combatSpur.spd += buffVal;
					boostText += this.name + " gets +" + buffVal + " atk and spd from being attacked with " + skillName + ".<br>";
				}
			}
			if(this.has("Bracing Stance")){
				if(this.hasSlot("Bracing Stance","a")){
					buffVal = this.hasSlot("Bracing Stance","a") * 2;
					skillName = data.skills[this.aIndex].name;
					this.combatSpur.def += buffVal;
					this.combatSpur.res += buffVal;
					boostText += this.name + " gets +" + buffVal + " def and res from being attacked with " + skillName + ".<br>";
				}
				if(this.hasSlot("Bracing Stance","s")){
					buffVal = this.hasSlot("Bracing Stance","s") * 2;
					skillName = data.skills[this.sIndex].name;
					this.combatSpur.def += buffVal;
					this.combatSpur.res += buffVal;
					boostText += this.name + " gets +" + buffVal + " def and res from being attacked with " + skillName + ".<br>";
				}
			}
			if(this.has("Steady Posture")){
				if(this.hasSlot("Steady Posture","a")){
					buffVal = this.hasSlot("Steady Posture","a") * 2;
					skillName = data.skills[this.aIndex].name;
					this.combatSpur.spd += buffVal;
					this.combatSpur.def += buffVal;
					boostText += this.name + " gets +" + buffVal + " spd and def from being attacked with " + skillName + ".<br>";
				}
				if(this.hasSlot("Steady Posture","s")){
					buffVal = this.hasSlot("Steady Posture","s") * 2;
					skillName = data.skills[this.sIndex].name;
					this.combatSpur.spd += buffVal;
					this.combatSpur.def += buffVal;
					boostText += this.name + " gets +" + buffVal + " spd and def from being attacked with " + skillName + ".<br>";
				}
			}
			if(this.hasExactly("Dragonskin")){
				buffVal = 4;
				skillName = data.skills[this.aIndex].name;
				this.combatSpur.def += buffVal;
				this.combatSpur.res += buffVal;
				boostText += this.name + " gets +" + buffVal + " def and res from being attacked with " + skillName + ".<br>";
			}
			//Laws of Sacae
			if(this.hasExactly("Laws Of Sacae") && this.toggle.a == 1){
				buffVal = 4;
				skillName = data.skills[this.aIndex].name;
				this.combatSpur.atk += buffVal;
				this.combatSpur.spd += buffVal;
				this.combatSpur.def += buffVal;
				this.combatSpur.res += buffVal;
				boostText += this.name + " gets +" + buffVal + " in all stats from being within 2 spaces of >=2 allies and being attacked with " + skillName + ".<br>";
			}
			if(this.hasExactly("Ostian Counter")){
				buffVal = 4;
				skillName = data.skills[this.aIndex].name;
				this.combatSpur.atk += buffVal;
				this.combatSpur.def += buffVal;
				boostText += this.name + " gets +" + buffVal + " atk and def from being attacked with " + skillName + ".<br>";
			}
			if(this.has("Steady Stance")){
				if(this.hasSlot("Steady Stance","a")){
					buffVal = this.hasSlot("Steady Stance","a") * 2;
					skillName = data.skills[this.aIndex].name;
					this.combatSpur.def += buffVal;
					boostText += this.name + " gets +" + buffVal + " def from being attacked with " + skillName + ".<br>";
				}
				if(this.hasSlot("Steady Stance","s")){
					buffVal = this.hasSlot("Steady Stance","s") * 2;
					skillName = data.skills[this.sIndex].name;
					this.combatSpur.def += buffVal;
					boostText += this.name + " gets +" + buffVal + " def from being attacked with " + skillName + ".<br>";
				}
			}
			if(this.has("Darting Stance")){
				if(this.hasSlot("Darting Stance","a")){
					buffVal = this.hasSlot("Darting Stance","a") * 2;
					skillName = data.skills[this.aIndex].name;
					this.combatSpur.spd += buffVal;
					boostText += this.name + " gets +" + buffVal + " spd from being attacked with " + skillName + ".<br>";
				}
				if(this.hasSlot("Darting Stance","s")){
					buffVal = this.hasSlot("Darting Stance","s") * 2;
					skillName = data.skills[this.sIndex].name;
					this.combatSpur.spd += buffVal;
					boostText += this.name + " gets +" + buffVal + " spd from being attacked with " + skillName + ".<br>";
				}
			}
			if(this.has("Fierce Stance")){
				if(this.hasSlot("Fierce Stance","a")){
					buffVal = this.hasSlot("Fierce Stance","a") * 2;
					skillName = data.skills[this.aIndex].name;
					this.combatSpur.atk += buffVal;
					boostText += this.name + " gets +" + buffVal + " atk from being attacked with " + skillName + ".<br>";
				}
				if(this.hasSlot("Fierce Stance","s")){
					buffVal = this.hasSlot("Fierce Stance","s") * 2;
					skillName = data.skills[this.sIndex].name;
					this.combatSpur.atk += buffVal;
					boostText += this.name + " gets +" + buffVal + " atk from being attacked with " + skillName + ".<br>";
				}
			}
			if(this.has("Warding Stance")){
				if(this.hasSlot("Warding Stance","a")){
					buffVal = this.hasSlot("Warding Stance","a") * 2;
					skillName = data.skills[this.aIndex].name;
					this.combatSpur.res += buffVal;
					boostText += this.name + " gets +" + buffVal + " res from being attacked with " + skillName + ".<br>";
				}
				if(this.hasSlot("Warding Stance","s")){
					buffVal = this.hasSlot("Warding Stance","s") * 2;
					skillName = data.skills[this.sIndex].name;
					this.combatSpur.res += buffVal;
					boostText += this.name + " gets +" + buffVal + " res from being attacked with " + skillName + ".<br>";
				}
			}
			//Ward Skills
			if((this.hasExactly("Distant Ward") || this.hasExactly("Close Ward")) && data.magicalWeapons.indexOf(enemy.weaponType) != -1){
				this.combatSpur.atk += 5;
				this.combatSpur.res += 5;
				this.anyCounter = true;
				boostText += this.name + " gets +5 in atk and res and can counter from any range from being attacked with " + data.skills[this.aIndex].name + ".<br>";
			}
			//Reversal Skills
			if(this.hasExactly("Close Reversal")){
				skillName = data.skills[this.aIndex].name;
				this.combatSpur.def += 5;
				boostText += this.name + " gets +5 def from being attacked with " + skillName + ".<br>";
			}
			//DC Stance Skills
			if(this.hasExactly("Distant Stance")){
				skillName = data.skills[this.aIndex].name;
				this.combatSpur.res += 5;
				boostText += this.name + " gets +5 res from being attacked with " + skillName + ".<br>";
			}
			if(this.hasExactly("Distant Dart")){
				skillName = data.skills[this.aIndex].name;
				this.combatSpur.spd += 5;
				boostText += this.name + " gets +5 spd from being attacked with " + skillName + ".<br>";
			}
			if(this.hasExactly("Distant Ferocity")){
				skillName = data.skills[this.aIndex].name;
				this.combatSpur.atk += 5;
				boostText += this.name + " gets +5 atk from being attacked with " + skillName + ".<br>";
			}
			if(this.hasExactly("Distant Reversal")){
				skillName = data.skills[this.aIndex].name;
				this.combatSpur.def += 5;
				boostText += this.name + " gets +5 def from being attacked with " + skillName + ".<br>";
			}
			//Session skills
			if(this.has("Shield Session")){
				if(this.hasSlot("Shield Session","a")){
					buffVal = (this.hasSlot("Shield Session","a") * 3) - (this.toggle.a * this.hasSlot("Shield Session","a"));
					this.combatSpur.def += buffVal;
					this.combatSpur.res += buffVal;
					skillName = data.skills[this.aIndex].name;
					boostText += this.name + " gets +" + buffVal + " def and res from being attacked with " + skillName + ".<br>";
				}
				if(this.hasSlot("Shield Session","s")){
					buffVal = (this.hasSlot("Shield Session","s") * 3) - (this.toggle.s * this.hasSlot("Shield Session","s"));
					this.combatSpur.def += buffVal;
					this.combatSpur.res += buffVal;
					skillName = data.skills[this.sIndex].name;
					boostText += this.name + " gets +" + buffVal + " def and res from being attacked with " + skillName + ".<br>";
				}
			}
			//Foil Skills
			if((this.hasExactly("Close Foil") || this.hasExactly("Distant Foil")) && data.physicalWeapons.indexOf(enemy.weaponType) != -1){
				this.combatSpur.atk += 5;
				this.combatSpur.def += 5;
				this.anyCounter = true;
				boostText += this.name + " gets +5 to atk & def and can counter from any range from being attacked with " + data.skills[this.aIndex].name + ".<br>";
			}
		}
		//[Bonus]
		if(this.bonus.resoB){
			this.combatSpur.atk += 4;
			this.combatSpur.spd += 4;
			boostText += this.name + " gets +4 to atk & spd from being affected by Resonance: Blades.<br>";
		}
		if(this.bonus.resoS){
			this.combatSpur.def += 4;
			this.combatSpur.res += 4;
			this.bonus.stopD = true;
			boostText += this.name + " gets +4 to def & res and denies follow-up attack from enemy on first combat from being affected by Resonance: Shields.<br>";
		}
		if(this.bonus.spectrum){
			this.combatSpur.atk += 5;
			this.combatSpur.spd += 5;
			this.combatSpur.def += 5;
			this.combatSpur.res += 5;
			boostText += this.name + " gets +5 to all stats from being affected by Rally Spectrum.<br>";
		}
		if(this.bonus.incited && this.initiator){
			var inVal = Math.min(this.buddy.spaces, 3);
			this.combatSpur.atk += inVal;
			this.combatSpur.spd += inVal;
			this.combatSpur.def += inVal;
			this.combatSpur.res += inVal;
			boostText += this.name + " gets +" + inVal + " to all stats from initiating and being affected by Incited.<br>";
		}
		if(this.bonus.paranoia && this.combatStartHp / this.maxHp < 1){
			this.combatSpur.atk += 5;
			boostText += this.name + " gets +5 to atk from being affected by Paranoia.<br>";
		}
		if(this.bonus.fWitness){
			this.combatSpur.atk += 5;
			this.combatSpur.spd += 5;
			this.combatSpur.def += 5;
			this.combatSpur.res += 5;
			boostText += this.name + " gets +5 to all stats from being affected by Future Witness.<br>";
		}
		if(this.bonus.anathema){
			enemy.combatSpur.spd -= 4;
			enemy.combatSpur.def -= 4;
			enemy.combatSpur.res -= 4;
			boostText += this.name + " inflicts -4 spd/def/res to " + enemy.name + " from being affected by Anathema.<br>";
		}
		if(this.bonus.dosage){
			this.combatSpur.atk += 5;
			this.combatSpur.spd += 5;
			this.combatSpur.def += 5;
			this.combatSpur.res += 5;
			boostText += this.name + " gets +5 to all stats from being affected by Dosage.<br>";
		}
		if(this.bonus.empathy > 0){
			this.combatSpur.atk += this.bonus.empathy;
			this.combatSpur.spd += this.bonus.empathy;
			this.combatSpur.def += this.bonus.empathy;
			this.combatSpur.res += this.bonus.empathy;
			boostText += this.name + " gets +" + this.bonus.empathy + " to all stats from being affected by Empathy.<br>";
		}
		if(this.bonus.divinely > 0){
			var divVal = this.bonus.divinely * 3;
			this.combatSpur.atk += divVal;
			this.combatSpur.spd += divVal;
			this.combatSpur.def += divVal;
			this.combatSpur.res += divVal;
			boostText += this.name + " gets +" + divVal + " to all stats from being affected by Divinely Inspiring.<br>";
		}
		if(this.bonus.dHex){
			var debuffVal = 5;
			var dAtk = Math.min(enemy.combatDebuffs.atk,enemy.debuffs.atk);
			var dSpd = Math.min(enemy.combatDebuffs.spd,enemy.debuffs.spd);
			var dDef = Math.min(enemy.combatDebuffs.def,enemy.debuffs.def);
			var dRes = Math.min(enemy.combatDebuffs.res,enemy.debuffs.res);
			if(enemy.penalty.panic){
				dAtk -= Math.max(enemy.combatBuffs.atk,enemy.buffs.atk);
				dSpd -= Math.max(enemy.combatBuffs.spd,enemy.buffs.spd);
				dDef -= Math.max(enemy.combatBuffs.def,enemy.buffs.def);
				dRes -= Math.max(enemy.combatBuffs.res,enemy.buffs.res);
			}
			dAtk = Math.max(5+dAtk, 0) + debuffVal;
			dSpd = Math.max(5+dSpd, 0) + debuffVal;
			dDef = Math.max(5+dDef, 0) + debuffVal;
			dRes = Math.max(5+dRes, 0) + debuffVal;
			enemy.combatSpur.atk -= dAtk;
			enemy.combatSpur.spd -= dSpd;
			enemy.combatSpur.def -= dDef;
			enemy.combatSpur.res -= dRes;
			boostText += this.name + " inflicts -" + dAtk + "/-" + dSpd + "/-" + dDef + "/-" + dRes + " to " + enemy.name + " from being affected by Draconic Hex.<br>";
		}
		//[Support]
		if(this.support.diva > 0){
			var divaVal = Math.floor(allStats[20] * 0.15) * this.support.diva;
			enemy.combatSpur.atk -= divaVal;
			enemy.combatSpur.spd -= divaVal;
			boostText += this.name + " inflicts -" + divaVal + " atk & spd to " + enemy.name + " from Diva-Pair Parasol Support(s).<br>";
		}
		if(this.support.petal){
			var dAtk = 0;
			var dSpd = 0;
			var dDef = 0;
			var dRes = 0;
			if(!allStats[15][0]){
				dAtk = Math.max(enemy.combatBuffs.atk,enemy.buffs.atk);
			}
			if(!allStats[15][1]){
				dSpd = Math.max(enemy.combatBuffs.spd,enemy.buffs.spd);
			}
			if(!allStats[15][2]){
				dDef = Math.max(enemy.combatBuffs.def,enemy.buffs.def);
			}
			if(!allStats[15][3]){
				dRes = Math.max(enemy.combatBuffs.res,enemy.buffs.res);
			}
			if(enemy.penalty.panic){
				dAtk = 0;
				dSpd = 0;
				dDef = 0;
				dRes = 0;
			}
			enemy.combatSpur.atk -= dAtk;
			enemy.combatSpur.spd -= dSpd;
			enemy.combatSpur.def -= dDef;
			enemy.combatSpur.res -= dRes;
			this.combatSpur.atk += dAtk;
			this.combatSpur.spd += dSpd;
			this.combatSpur.def += dDef;
			this.combatSpur.res += dRes;
			boostText += this.name + " inflicts -" + dAtk + "/-" + dSpd + "/-" + dDef + "/-" + dRes + " to " + enemy.name + " and gets " + dAtk + "/" + dSpd + "/" + dDef + "/" + dRes + " from Syphon support.<br>";
		}
		//Emblem boosts
		if(this.emblem == "Eirika" && this.range == "melee" && this.specialIndex != -1 && data.AOESpecials.indexOf(data.skills[this.specialIndex].name) == -1 && data.AOEMultiSpecials.indexOf(data.skills[this.specialIndex].name) == -1){
			this.combatSpur.atk -= 4;
			boostText += this.name + " is inflicted with -4 atk from Emblem (Eirika).<br>";
		}
		//Vein boosts
		if(this.vein == 1){
			this.combatSpur.def += 6;
			this.combatSpur.res += 6;
			boostText += this.name + " gets +6 def & res from Divine Vein (Stone).<br>";
		}
		//Captain skills
		if(options.threatenRule=="Summ. Duels" && this.sdIndex != -1){
			var fCheck = this.isFeuded(enemy);
			if(this.hasCaptain("Adroit Captain") && this.toggle.sd == 0){
				this.combatSpur.spd += 5;
				boostText += this.name + " gets +5 spd from being the captain with Adroit Captain.<br>";
			}
			else if(this.hasCaptain("Effulgence") && (this.toggle.sd == 0 || fCheck == false)){
				this.combatSpur.atk += 4;
				this.combatSpur.spd += 4;
				if(this.penalty.panic){
					this.combatBuffs = {"atk":0,"spd":0,"def":0,"res":0};
					this.buffs = {"atk":0,"spd":0,"def":0,"res":0};
				}
				this.combatDebuffs = {"atk":0,"spd":0,"def":0,"res":0};
				this.debuffs = {"atk":0,"spd":0,"def":0,"res":0};
				var cText = "the captain";
				if(this.toggle.sd == 1){
					cText = "within 2 spaces of your captain";
				}
				boostText += this.name + " gets +4 atk & spd and neutralizes penalties from being " + cText + " with Effulgence.<br>";
			}
			else if(this.hasCaptain("Eminence")){
				enemy.combatSpur.def -= 3;
				enemy.combatSpur.res -= 3;
				boostText += enemy.name + " is inflicted with -3 def & res from being within 3 spaces of your captain with Eminence.<br>";
			}
			else if(this.hasCaptain("Erosion") && (((enemy.has("Near Save") || enemy.has("Twin N Save") || enemy.hasExactly("Lower Ground")) && enemy.toggle.c == 1 && this.range == "melee" && this.initiator) || ((((enemy.has("Far Save") || enemy.has("Twin F Save") || enemy.hasExactly("With Everyone 2") || enemy.hasExactly("Woeful Upheaval") || enemy.hasExactly("Higher Ground")) && enemy.toggle.c == 1) || (enemy.hasExactly("Darkling Dragon") && enemy.toggle.c > 1)) && this.range == "ranged" && this.initiator))){
				enemy.combatSpur.def -= 4;
				enemy.combatSpur.res -= 4;
				enemy.penalty.lit = true;
				boostText += enemy.name + " is inflicted with -4 def & res and cannot counterattack from triggering Savior skill with Erosion.<br>";
			}
			else if(this.hasCaptain("Mass Confusion") && (this.toggle.sd == 0 || this.toggle.sd == 2)){
				this.combatSpur.atk += 5;
				boostText += this.name + " gets +5 atk from being the captain with Mass Confusion.<br>";
			}
			else if(this.hasCaptain("Might of Myriads") && !(((this.has("Near Save") || this.has("Twin N Save") || this.hasExactly("Lower Ground")) && this.toggle.c == 1 && enemy.range == "melee" && !this.initiator) || ((((this.has("Far Save") || this.has("Twin F Save") || this.hasExactly("With Everyone 2") || this.hasExactly("Woeful Upheaval") || this.hasExactly("Higher Ground")) && this.toggle.c == 1) || (this.hasExactly("Darkling Dragon") && this.toggle.c > 1)) && enemy.range == "ranged" && !this.initiator))){
				this.combatSpur.atk += 6;
				this.combatSpur.spd += 6;
				this.combatSpur.def += 6;
				this.combatSpur.res += 6;
				this.anyCounter = true;
				boostText += this.name + " gets +6 to all stats and is able to counterattack regardless of enemy's range from being the captain with Might of Myriads.<br>";
			}
			else if(this.hasCaptain("Tandem Form")){
				this.combatSpur.atk += 4;
				this.combatSpur.spd += 4;
				boostText += this.name + " gets +4 atk & spd from being the captain with Tandem Form.<br>";
			}
			else if(this.hasCaptain("Reversal")){
				var rText = "within 2 spaces of your captain";
				if(this.toggle.sd == 0){
					rText = "the captain";
					this.combatSpur.atk += 5;
					boostText += this.name + " gets +5 atk from being the captain with Reversal.<br>";
				}
				var dAtk = 0;
				var dSpd = 0;
				var dDef = 0;
				var dRes = 0;
				if(!allStats[15][0]){
					dAtk = Math.max(enemy.combatBuffs.atk,enemy.buffs.atk) * -2;
				}
				if(!allStats[15][1]){
					dSpd = Math.max(enemy.combatBuffs.spd,enemy.buffs.spd) * -2;
				}
				if(!allStats[15][2]){
					dDef = Math.max(enemy.combatBuffs.def,enemy.buffs.def) * -2;
				}
				if(!allStats[15][3]){
					dRes = Math.max(enemy.combatBuffs.res,enemy.buffs.res) * -2;
				}
				if(enemy.penalty.panic){
					dAtk = 0;
					dSpd = 0;
					dDef = 0;
					dRes = 0;
				}
				enemy.combatSpur.atk += dAtk;
				enemy.combatSpur.spd += dSpd;
				enemy.combatSpur.def += dDef;
				enemy.combatSpur.res += dRes;
				boostText += this.name + " inflicts " + dAtk + "/" + dSpd + "/" + dDef + "/" + dRes + " in stats to " + enemy.name + " from being " + rText + " with Reversal.<br>";
			}
		}
		//SD stat boost melee vs. ranged
		if(options.threatenRule=="Summ. Duels" && enemy.range == "ranged" && this.range == "melee" && !((((this.has("Far Save") || this.has("Twin F Save") || this.hasExactly("With Everyone 2") || this.hasExactly("Woeful Upheaval") || this.hasExactly("Higher Ground")) && this.toggle.c == 1) || (this.hasExactly("Darkling Dragon") && this.toggle.c > 1)) && !this.initiator)){
			this.combatSpur.def += 7;
			this.combatSpur.res += 7;
			boostText += this.name + " gets +7 def & res from being a melee hero fighting a ranged enemy in Summoner Duels.<br>";
		}
		
		
		//These skills go at the end as debuff negation must go before
		//Grand Strategy
		if(this.bonus.gStrat && !this.penalty.ploy){
			var dAtk = Math.min(this.combatDebuffs.atk,this.debuffs.atk) * -2;
			var dSpd = Math.min(this.combatDebuffs.spd,this.debuffs.spd) * -2;
			var dDef = Math.min(this.combatDebuffs.def,this.debuffs.def) * -2;
			var dRes = Math.min(this.combatDebuffs.res,this.debuffs.res) * -2;
			if(this.penalty.panic){
				dAtk += Math.max(this.combatBuffs.atk,this.buffs.atk) * 2;
				dSpd += Math.max(this.combatBuffs.spd,this.buffs.spd) * 2;
				dDef += Math.max(this.combatBuffs.def,this.buffs.def) * 2;
				dRes += Math.max(this.combatBuffs.res,this.buffs.res) * 2;
			}
			this.combatSpur.atk += dAtk;
			this.combatSpur.spd += dSpd;
			this.combatSpur.def += dDef;
			this.combatSpur.res += dRes;
			boostText += this.name + " gets net + " + dAtk + "/" + dSpd + "/" + dDef + "/" + dRes + " in stats from having penalty active with [Grand Strategy].<br>";
		}
		if(this.hasExactly("Chaos Ragnell")){
			var dAtk = Math.min(this.combatDebuffs.atk,this.debuffs.atk) * -2;
			var dSpd = Math.min(this.combatDebuffs.spd,this.debuffs.spd) * -2;
			var dDef = Math.min(this.combatDebuffs.def,this.debuffs.def) * -2;
			var dRes = Math.min(this.combatDebuffs.res,this.debuffs.res) * -2;
			if(this.penalty.panic){
				dAtk += Math.max(this.combatBuffs.atk,this.buffs.atk) * 2;
				dSpd += Math.max(this.combatBuffs.spd,this.buffs.spd) * 2;
				dDef += Math.max(this.combatBuffs.def,this.buffs.def) * 2;
				dRes += Math.max(this.combatBuffs.res,this.buffs.res) * 2;
			}
			this.combatSpur.atk += dAtk;
			this.combatSpur.spd += dSpd;
			this.combatSpur.def += dDef;
			this.combatSpur.res += dRes;
			boostText += this.name + " gets net + " + dAtk + "/" + dSpd + "/" + dDef + "/" + dRes + " in stats from having penalty active with Chaos Ragnell.<br>";
			if(this.rValue > 0){
				this.combatSpur.atk += 4;
				this.combatSpur.spd += 4;
				this.combatSpur.def += 4;
				this.combatSpur.res += 4;
				boostText += this.name + " gets +4 to all stats with Chaos Ragnell.<br>";
				if(this.rValue == 5 && this.combatStartHp / this.maxHp >= 0.25){
					this.combatSpur.atk += 4;
					this.combatSpur.spd += 4;
					this.combatSpur.def += 4;
					this.combatSpur.res += 4;
					boostText += this.name + " gets +4 to all stats from HP >= 25% with Chaos Ragnell.<br>";
				}
			}
		}
		if(this.hasExactly("Lance of Heroics")){
			if(this.combatStartHp / this.maxHp >= 0.25){
				var mStat = this.toggle.weapon;
				if(mStat > 9){
					mStat -= 10;
				}
				mStat = mStat * 2 + 4;
				this.combatSpur.atk += mStat;
				this.combatSpur.spd += mStat;
				this.combatSpur.def += mStat;
				this.combatSpur.res += mStat;
				boostText += this.name + " gets +" + mStat + " to all stats from HP >= 25% with Lance of Heroics.<br>";
			}
			if(this.rValue == 5 && this.toggle.weapon > 9){
				this.combatSpur.atk += 4;
				this.combatSpur.spd += 4;
				this.combatSpur.def += 4;
				this.combatSpur.res += 4;
				boostText += this.name + " gets +4 to all stats from being within 3 spaces of an ally with Lance of Heroics.<br>";
				var dAtk = Math.min(this.combatDebuffs.atk,this.debuffs.atk) * -2;
				var dSpd = Math.min(this.combatDebuffs.spd,this.debuffs.spd) * -2;
				var dDef = Math.min(this.combatDebuffs.def,this.debuffs.def) * -2;
				var dRes = Math.min(this.combatDebuffs.res,this.debuffs.res) * -2;
				if(this.penalty.panic){
					dAtk += Math.max(this.combatBuffs.atk,this.buffs.atk) * 2;
					dSpd += Math.max(this.combatBuffs.spd,this.buffs.spd) * 2;
					dDef += Math.max(this.combatBuffs.def,this.buffs.def) * 2;
					dRes += Math.max(this.combatBuffs.res,this.buffs.res) * 2;
				}
				this.combatSpur.atk += dAtk;
				this.combatSpur.spd += dSpd;
				this.combatSpur.def += dDef;
				this.combatSpur.res += dRes;
				boostText += this.name + " gets net + " + dAtk + "/" + dSpd + "/" + dDef + "/" + dRes + " in stats from having penalty active and being within 3 spaces of an ally with Lance of Heroics.<br>";
			}
		}
		//Unity skills
		if(this.hasExactly("Atk Def Unity") && (this.buddy.adjacent > 0 || this.buddy.two > 0)){
			var dAtk = 5 + Math.min(this.combatDebuffs.atk,this.debuffs.atk) * -2;
			var dDef = 5 + Math.min(this.combatDebuffs.def,this.debuffs.def) * -2;
			if(this.penalty.panic){
				dAtk += Math.max(this.combatBuffs.atk,this.buffs.atk) * 2;
				dDef += Math.max(this.combatBuffs.def,this.buffs.def) * 2;
			}
			this.combatSpur.atk += dAtk;
			this.combatSpur.def += dDef;
			boostText += this.name + " gets net +" + dAtk + " atk & +" + dDef + " def from having ally within 2 spaces with Atk Def Unity.<br>";
		}
		if(this.hasExactly("Atk Res Unity") && (this.buddy.adjacent > 0 || this.buddy.two > 0)){
			var dAtk = 5 + Math.min(this.combatDebuffs.atk,this.debuffs.atk) * -2;
			var dRes = 5 + Math.min(this.combatDebuffs.res,this.debuffs.res) * -2;
			if(this.penalty.panic){
				dAtk += Math.max(this.combatBuffs.atk,this.buffs.atk) * 2;
				dRes += Math.max(this.combatBuffs.res,this.buffs.res) * 2;
			}
			this.combatSpur.atk += dAtk;
			this.combatSpur.res += dRes;
			boostText += this.name + " gets net +" + dAtk + " atk & +" + dRes + " res from having ally within 2 spaces with Atk Res Unity.<br>";
		}
		if(this.hasExactly("Atk Spd Unity") && (this.buddy.adjacent > 0 || this.buddy.two > 0)){
			var dAtk = 5 + Math.min(this.combatDebuffs.atk,this.debuffs.atk) * -2;
			var dSpd = 5 + Math.min(this.combatDebuffs.spd,this.debuffs.spd) * -2;
			if(this.penalty.panic){
				dAtk += Math.max(this.combatBuffs.atk,this.buffs.atk) * 2;
				dSpd += Math.max(this.combatBuffs.spd,this.buffs.spd) * 2;
			}
			this.combatSpur.atk += dAtk;
			this.combatSpur.spd += dSpd;
			boostText += this.name + " gets net +" + dAtk + " atk & +" + dSpd + " spd from having ally within 2 spaces with Atk Spd Unity.<br>";
		}
		if(this.hasExactly("Def Res Unity") && (this.buddy.adjacent > 0 || this.buddy.two > 0)){
			var dDef = 5 + Math.min(this.combatDebuffs.def,this.debuffs.def) * -2;
			var dRes = 5 + Math.min(this.combatDebuffs.res,this.debuffs.res) * -2;
			if(this.penalty.panic){
				dDef += Math.max(this.combatBuffs.def,this.buffs.def) * 2;
				dRes += Math.max(this.combatBuffs.res,this.buffs.res) * 2;
			}
			this.combatSpur.def += dDef;
			this.combatSpur.res += dRes;
			boostText += this.name + " gets net +" + dDef + " def & +" + dRes + " res from having ally within 2 spaces with Def Res Unity.<br>";
		}
		if(this.hasExactly("Spd Def Unity") && (this.buddy.adjacent > 0 || this.buddy.two > 0)){
			var dSpd = 5 + Math.min(this.combatDebuffs.spd,this.debuffs.spd) * -2;
			var dDef = 5 + Math.min(this.combatDebuffs.def,this.debuffs.def) * -2;
			if(this.penalty.panic){
				dSpd += Math.max(this.combatBuffs.spd,this.buffs.spd) * 2;
				dDef += Math.max(this.combatBuffs.def,this.buffs.def) * 2;
			}
			this.combatSpur.spd += dSpd;
			this.combatSpur.def += dDef;
			boostText += this.name + " gets net +" + dSpd + " spd & +" + dDef + " def from having ally within 2 spaces with Spd Def Unity.<br>";
		}
		if(this.hasExactly("Part of the Plan") && this.combatStartHp / this.maxHp >= 0.25){
			var dAtk = Math.min(this.combatDebuffs.atk,this.debuffs.atk) * -2;
			var dSpd = Math.min(this.combatDebuffs.spd,this.debuffs.spd) * -2;
			var dDef = Math.min(this.combatDebuffs.def,this.debuffs.def) * -2;
			var dRes = Math.min(this.combatDebuffs.res,this.debuffs.res) * -2;
			if(this.penalty.panic){
				dAtk += Math.max(this.combatBuffs.atk,this.buffs.atk) * 2;
				dSpd += Math.max(this.combatBuffs.spd,this.buffs.spd) * 2;
				dDef += Math.max(this.combatBuffs.def,this.buffs.def) * 2;
				dRes += Math.max(this.combatBuffs.res,this.buffs.res) * 2;
			}
			this.combatSpur.atk += dAtk;
			this.combatSpur.spd += dSpd;
			this.combatSpur.def += dDef;
			this.combatSpur.res += dRes;
			boostText += this.name + " gets net + " + dAtk + "/" + dSpd + "/" + dDef + "/" + dRes + " in stats from HP >= 25% with Part of the Plan.<br>";
		}
		if(this.hasExactly("Believe in Love")){
			var dAtk = Math.min(this.combatDebuffs.atk,this.debuffs.atk) * -2;
			var dSpd = Math.min(this.combatDebuffs.spd,this.debuffs.spd) * -2;
			var dDef = Math.min(this.combatDebuffs.def,this.debuffs.def) * -2;
			var dRes = Math.min(this.combatDebuffs.res,this.debuffs.res) * -2;
			if(this.penalty.panic){
				dAtk += Math.max(this.combatBuffs.atk,this.buffs.atk) * 2;
				dSpd += Math.max(this.combatBuffs.spd,this.buffs.spd) * 2;
				dDef += Math.max(this.combatBuffs.def,this.buffs.def) * 2;
				dRes += Math.max(this.combatBuffs.res,this.buffs.res) * 2;
			}
			this.combatSpur.atk += dAtk;
			this.combatSpur.spd += dSpd;
			this.combatSpur.def += dDef;
			this.combatSpur.res += dRes;
			enemy.combatSpur.atk -= 5;
			enemy.combatSpur.spd -= 5;
			enemy.combatSpur.def -= 5;
			boostText += this.name + " gets net + " + dAtk + "/" + dSpd + "/" + dDef + "/" + dRes + " in stats and inflicts -5 atk/spd/def to " + enemy.name + " with Believe in Love.<br>";
		}
		return boostText;
	};
	
	this.postCombatHPAdjust = function(galeused,enemy,tCheck){
		var postCombatHPText = "";
		var skillName = "";
		var healName = "";
		var hpTally = 0;
		
		//HP loss
		if(!this.has("Embla's Ward") && this.bonus.enGarde == false){
			//weapons
			if(this.hasExactly("Mystletainn") && this.rValue == 5){
				hpTally -= 6;
				skillName += data.skills[this.weaponIndex].name;
			}
			else if(this.hasExactly("Axe of Virility") && this.rValue == 5){
				hpTally -= 6;
				skillName += data.skills[this.weaponIndex].name;
			}
			else if(this.hasExactly("Hinata's Katana") && this.rValue == 5){
				hpTally -= 6;
				skillName += data.skills[this.weaponIndex].name;
			}
			else if(this.has("Spooky Censer") || this.has("Madness Flask") || this.has("Pumpkin-a-Box") || this.has("Candlewax Bow")){
				hpTally -= 6;
				skillName += data.skills[this.weaponIndex].name;
			}
			else if(this.didAttack && this.hasExactly("Ragnarok")){
				if(this.rValue > 0 || this.combatStartHp / this.maxHp >= 1){
					hpTally -= 5;
					skillName += data.skills[this.weaponIndex].name;
				}
			}
			else if(this.hasExactly("Cursed Lance") && this.rValue < 0){
				hpTally -= 4;
				skillName += data.skills[this.weaponIndex].name;
			}
			else if(this.hasExactly("Cursed Lance") && this.rValue > 0){
				hpTally -= 6;
				skillName += data.skills[this.weaponIndex].name;
			}
			else if(this.hasExactly("Falchion") && this.name == "Alm" && this.rValue == 5 && this.combatStartHp / this.maxHp >= 1 && this.initiator){
				hpTally -= 5;
				skillName += data.skills[this.weaponIndex].name;
			}
			else if(this.hasExactly("Lyfjaberg") && this.rValue < 0 && this.combatStartHp / this.maxHp >= 0.5){
				hpTally -= 4;
				skillName += data.skills[this.weaponIndex].name;
			}
			else if(this.hasExactly("Death") && this.didAttack){
				hpTally -= 4;
				skillName += data.skills[this.weaponIndex].name;
			}
			else if(this.hasExactly("Devil Axe") && this.didAttack){
				hpTally -= 4;
				skillName += data.skills[this.weaponIndex].name;
			}
			else if(this.hasExactly("Beloved Zofia") && this.didAttack && (this.combatStartHp / this.maxHp == 1 || this.rValue > 0)){
				hpTally -= 4;
				skillName += data.skills[this.weaponIndex].name;
			}
			else if(this.hasExactly("Seashell") || this.hasExactly("Seashell") || this.has("Refreshing Bolt") || this.has("Deft Harpoon") || this.has("Melon Crusher") && this.didAttack && this.combatStartHp / this.maxHp >= 1){
				hpTally -= 2;
				skillName += data.skills[this.weaponIndex].name;
			}
			else if(this.hasExactly("Wild Tiger Fang") && this.transform == true && this.didAttack){
				hpTally -= 5;
				skillName += data.skills[this.weaponIndex].name;
			}
			//a skills
			if(((this.hasSlot("Atk Spd Push","a") && !this.hasExactly("Atk Spd Push 4")) || (this.hasSlot("Atk Def Push","a") && !this.hasExactly("Atk Def Push 4")) || (this.hasSlot("Atk Res Push","a") && !this.hasExactly("Atk Res Push 4"))) && this.didAttack && this.combatStartHp / this.maxHp >= 1){
				hpTally -= 1;
				if(skillName != ""){
					skillName += ", ";
				}
				skillName += data.skills[this.aIndex].name;
			}
			else if(this.didAttack && (this.hasExactly("Atk Spd Push 4") || this.hasExactly("Atk Res Push 4") || this.hasExactly("Atk Def Push 4") || this.hasExactly("Distant Pressure") || this.hasExactly("Close Salvo") || this.hasExactly("Distant Storm")) && this.combatStartHp / this.maxHp >= 0.25){
				hpTally -= 5;
				if(skillName != ""){
					skillName += ", ";
				}
				skillName += data.skills[this.aIndex].name;
			}
			else if(this.hasSlot("Fury","a")){
				hpTally -= this.hasSlot("Fury","a") * 2;
				if(skillName != ""){
					skillName += ", ";
				}
				skillName += data.skills[this.aIndex].name;
			}
			else if(this.hasExactly("Scendscale") && this.didAttack){
				hpTally -= 7;
				if(skillName != ""){
					skillName += ", ";
				}
				skillName += data.skills[this.aIndex].name;
			}
			//b skills
			if(this.hasExactly("Double Lion") && this.combatStartHp / this.maxHp >= 1 && this.initiator){
				hpTally -= 1;
				if(skillName != ""){
					skillName += ", ";
				}
				skillName += data.skills[this.bIndex].name;
			}
			//s skills
			if((this.hasSlot("Atk Def Push","s") || this.hasSlot("Atk Res Push","s") || this.hasSlot("Atk Spd Push","s")) && this.didAttack && this.combatStartHp / this.maxHp >= 1){
				hpTally -= 1;
				if(skillName != ""){
					skillName += ", ";
				}
				skillName += data.skills[this.sIndex].name;
			}
			else if(this.hasSlot("Fury","s")){
				hpTally -= this.hasSlot("Fury","s") * 2;
				if(skillName != ""){
					skillName += ", ";
				}
				skillName += data.skills[this.sIndex].name;
			}
			//enemy triggers
			//weapons
			if(enemy.hasExactly("Deathly Dagger") && enemy.didAttack){
				if(enemy.rValue < 0 && enemy.initiator){
					hpTally -= 7;
					if(skillName != ""){
						skillName += ", ";
					}
					skillName += "Enemy's " + data.skills[enemy.weaponIndex].name;
				}
				else if(enemy.rValue > 0){
					hpTally -= 10;
					if(skillName != ""){
						skillName += ", ";
					}
					skillName += "Enemy's " + data.skills[enemy.weaponIndex].name;
				}
			}
			else if((enemy.has("Pain") || enemy.hasExactly("Venin Edge")) && enemy.didAttack){
				hpTally -= 10;
				if(skillName != ""){
					skillName += ", ";
				}
				skillName += "Enemy's " + data.skills[enemy.weaponIndex].name;
			}
			else if((enemy.hasExactly("Sniper's Bow") || (enemy.hasExactly("Obsessive Curse") && enemy.rValue == 5) || (enemy.hasExactly("Skadi") && enemy.rValue == 5 && enemy.combatStartHp / enemy.maxHp >= 0.25) || enemy.has("Serpentine Staff") || enemy.has("Incurable") || enemy.has("Bone Carver") || (enemy.has("Miasma Dagger") && enemy.combatStartHp / enemy.maxHp >= 0.25)) && enemy.didAttack){
				hpTally -= 7;
				if(skillName != ""){
					skillName += ", ";
				}
				skillName += "Enemy's " + data.skills[enemy.weaponIndex].name;
			}
			else if((enemy.hasExactly("Quick Mulagir") || enemy.hasExactly("Constant Dagger")) && enemy.rValue == 5 && enemy.combatStartHp / enemy.maxHp >= 0.25 && !this.initiator && enemy.didAttack){
				hpTally -= 7;
				if(skillName != ""){
					skillName += ", ";
				}
				skillName += "Enemy's " + data.skills[enemy.weaponIndex].name;
			}
			else if((enemy.hasExactly("Soothing Scent") || (enemy.hasExactly("Flower of Sorrow") && enemy.rValue == 5)) && enemy.combatStartHp / enemy.maxHp >= 0.25 && enemy.didAttack){
				hpTally -= 10;
				if(skillName != ""){
					skillName += ", ";
				}
				skillName += "Enemy's " + data.skills[enemy.weaponIndex].name;
			}
			else if(enemy.hasExactly("Athame") && enemy.rValue == 5 && !this.initiator && enemy.didAttack){
				hpTally -= 5;
				if(skillName != ""){
					skillName += ", ";
				}
				skillName += "Enemy's " + data.skills[enemy.weaponIndex].name;
			}
			else if(enemy.hasExactly("Wildflower Edge") && !this.initiator && enemy.didAttack){
				hpTally -= 10;
				if(skillName != ""){
					skillName += ", ";
				}
				skillName += "Enemy's " + data.skills[enemy.weaponIndex].name;
			}
			//b skills
			if(enemy.hasSlot("Poison Strike","b") && !this.initiator && enemy.hp > 0){
				hpTally -= enemy.hasSlot("Poison Strike","b")* 3 + 1;
				if(skillName != ""){
					skillName += ", ";
				}
				skillName += "Enemy's " + data.skills[enemy.bIndex].name;
			}
			//c skills
			if(enemy.hasExactly("Deadly Miasma") && !this.initiator && enemy.hp > 0){
				hpTally -= 7;
				if(skillName != ""){
					skillName += ", ";
				}
				skillName += "Enemy's " + data.skills[enemy.cIndex].name;
			}
			//s skills
			if(enemy.hasSlot("Poison Strike","s") && !this.initiator && enemy.hp > 0){
				hpTally -= enemy.hasSlot("Poison Strike","s")* 3 + 1;
				if(skillName != ""){
					skillName += ", ";
				}
				skillName += "Enemy's " + data.skills[enemy.sIndex].name;
			}
			//specials
			if(enemy.hasExactly("Great Aether") && (enemy.sTrigger == 1 || tCheck == 1)){
				hpTally -= 5;
				if(skillName != ""){
					skillName += ", ";
				}
				skillName += "Enemy's " + data.skills[enemy.specialIndex].name;
			}
		}
		
		//HP gain
		//weapons
		if(!this.penalty.fatal || this.bonus.nectar > 0){
			if(((this.hasExactly("Blue Egg+") || this.hasExactly("Green Egg+") || this.hasExactly("Carrot Axe+") || this.hasExactly("Carrot Lance+")) && this.rValue > 0) || (this.initiator && (this.has("Blue Egg") || this.has("Green Egg") || this.has("Carrot Axe") || this.has("Carrot Lance")))){
				hpTally += 4;
				healName += data.skills[this.weaponIndex].name;
			}
			else if((this.hasExactly("Starpoint Lance") && (this.toggle.weapon == 1 || this.rValue > 0)) || (this.hasExactly("Sparkling Sun") && this.toggle.weapon == 1) || ((this.has("Wooden Tackle") || this.has("Seashell Bowl") || this.has("Campaign Lance") || this.has("Campaign Blade") || (this.hasExactly("Mercenary Lance") && this.rValue == 5)) && this.combatStartHp / this.maxHp >= 0.25)){
				hpTally += 10;
				healName += data.skills[this.weaponIndex].name;
			}
			else if((this.has("Hidden Thorns") || this.has("Melon Float") || this.has("Conch Bouquet") || this.has("Blarrabbit") || this.has("Raudrrabbit") || this.has("Gronnrabbit")) && this.toggle.weapon == 1 && !galeused){
				hpTally += 7;
				healName += data.skills[this.weaponIndex].name;
			}
			else if((this.hasExactly("Royal Sword") || this.hasExactly("Inviolable Axe") || this.hasExactly("Aurora Breath") || this.hasExactly("Dark Creator S") || this.hasExactly("Holytide Tyrfing") || this.hasExactly("Geirdriful") || this.hasExactly("Obsidian Lance") || this.hasExactly("Bereft Lance") || this.hasExactly("Kia Staff") || this.hasExactly("Proud Spear")) && this.rValue == 5 && this.combatStartHp / this.maxHp >= 0.25){
				hpTally += 7;
				healName += data.skills[this.weaponIndex].name;
			}
			else if(this.hasExactly("Aureola") || ((this.hasExactly("Mirage Falchion") || this.hasExactly("Brutal Breath")) && this.rValue > 0)){
				hpTally += 7;
				healName += data.skills[this.weaponIndex].name;
			}
			else if(this.hasExactly("Tome of Favors") && enemy.weaponType != "beast"){
				hpTally += 7;
				healName += data.skills[this.weaponIndex].name;
			}
			else if((this.hasExactly("Springtime Staff") || this.hasExactly("Father's-Son Axe")) && this.rValue == 5 && (this.initiator || this.toggle.weapon == 1)){
				hpTally += 7;
				healName += data.skills[this.weaponIndex].name;
			}
			else if(this.hasExactly("Ivaldi") && this.rValue == 5 && enemy.combatStartHp / enemy.maxHp >= 0.75){
				hpTally += 7;
				healName += data.skills[this.weaponIndex].name;
			}
			else if((this.hasExactly("Nifl's Bite") || this.has("Staff of Tribute") || this.hasExactly("Western Axe")) && this.toggle.weapon == 1){
				hpTally += 7;
				healName += data.skills[this.weaponIndex].name;
			}
			else if(this.hasExactly("Festive Siegmund") && this.rValue > 0 && (enemy.combatStartHp / enemy.maxHp >= 0.75 || this.toggle.weapon == 1)){
				hpTally += 7;
				healName += data.skills[this.weaponIndex].name;
			}
			else if((this.hasExactly("Dusk Dragonstone") || this.hasExactly("Lyfjaberg") || this.hasExactly("Volunteer Bow")) && this.rValue == 5 && this.toggle.weapon == 1){
				hpTally += 7;
				healName += data.skills[this.weaponIndex].name;
			}
			else if((this.hasExactly("Pastel Poleaxe") || this.hasExactly("Lands Sword") || this.hasExactly("Crimson Lance") || this.hasExactly("Arcane Grima") || this.hasExactly("Brilliant Starlight") || this.hasExactly("Captain's Sword") || this.hasExactly("Twin Divinestone") || this.hasExactly("Inspirited Spear") || (this.hasExactly("Areadbhar") && this.rValue > 0) || this.hasExactly("Scarlet Spear") || this.hasExactly("Blue Yule Axe") || this.hasExactly("Axe of Adoration") || this.hasExactly("Lightburst Tome") || this.hasExactly("Diva-Pair Parasol") || this.hasExactly("Wild Wind Sword") || this.hasExactly("Summertime Axe") || this.hasExactly("Craver's Tome") || this.hasExactly("Quieting Branch") || this.hasExactly("Sword of Isaach") || this.hasExactly("Petaldream Horn") || this.hasExactly("Fundament")) && this.combatStartHp / this.maxHp >= 0.25){
				hpTally += 7;
				healName += data.skills[this.weaponIndex].name;
			}
			else if((this.hasExactly("Conjurer Curios") || this.hasExactly("Command Lance") || this.hasExactly("Flower of Joy") || this.hasExactly("Charging Horn") || this.hasExactly("Mirage Axe") || this.hasExactly("Primordial Breath") || this.hasExactly("Airborne Spear") || this.hasExactly("Bride's Fang") || this.hasExactly("Fimbulvetr Morn")) && this.rValue == 5 && this.combatStartHp / this.maxHp >= 0.25){
				hpTally += 7;
				healName += data.skills[this.weaponIndex].name;
			}
			else if(this.hasExactly("Joyous Tome") && this.toggle.weapon > 0){
				hpTally += 7;
				healName += data.skills[this.weaponIndex].name;
			}
			else if((this.hasExactly("Valbar's Lance") || this.hasExactly("Thorn Lance") || this.hasExactly("Zephyr Breath") || this.hasExactly("Vouge") || this.hasExactly("Mirage Rod") || this.hasExactly("Amatsu")) && this.rValue == 5 && (!this.initiator || enemy.combatStartHp / enemy.maxHp >= 0.75)){
				hpTally += 7;
				healName += data.skills[this.weaponIndex].name;
			}
			else if(this.hasExactly("Hel's Reaper") && this.rValue > 0 && (!this.initiator || enemy.combatStartHp / enemy.maxHp >= 0.5)){
				hpTally += 7;
				healName += data.skills[this.weaponIndex].name;
			}
			else if((this.hasExactly("Heired Yewfelle") || this.hasExactly("Holy-War Spear") || ((this.hasExactly("Stoutheart Lance") || this.hasExactly("Thief's Honesty") || this.hasExactly("Goddess Axe") || this.hasExactly("Tome of Fury")) && this.rValue == 5) || this.hasExactly("Ebon Bolverk") || this.hasExactly("Lion's Heart") || this.hasExactly("Deer's Heart") || this.hasExactly("True-Bond Bow")) && (this.initiator || this.buddy.adjacent > 0 || this.buddy.two > 0)){
				hpTally += 7;
				healName += data.skills[this.weaponIndex].name;
			}
			else if(this.hasExactly("Flower of Caring") && this.combatStartHp / this.maxHp >= 0.25){
				hpTally += 5;
				healName += data.skills[this.weaponIndex].name;
			}
			else if((this.hasExactly("Gondul") || this.hasExactly("Bewitching Tome") || (this.hasExactly("Order's Sentence") && this.rValue == 5)) && (this.initiator || enemy.range == "ranged")){
				hpTally += 7;
				healName += data.skills[this.weaponIndex].name;
			}
			else if(this.hasExactly("Quietus Gullveig") && this.initiator){
				hpTally += 7;
				healName += data.skills[this.weaponIndex].name;
			}
			else if(this.hasExactly("Dragoon Axe") && this.rValue > 0 && (!this.initiator || enemy.combatStartHp / enemy.maxHp >= 0.75)){
				hpTally += 7;
				healName += data.skills[this.weaponIndex].name;
			}
			else if((this.hasExactly("Loving Breath") || this.hasExactly("Righteous Lance") || this.hasExactly("Praise-Piner Axe") || this.hasExactly("Opposing Stones") || this.hasExactly("Dark Monograph")) && (!this.initiator || enemy.combatStartHp / enemy.maxHp >= 0.75)){
				hpTally += 7;
				healName += data.skills[this.weaponIndex].name;
			}
			else if(((this.hasExactly("Astral Breath") && this.rValue > 0) || this.hasExactly("Lance of Grado") || this.hasExactly("Swirling Scimitar") || ((this.hasExactly("Spear of Assal") || this.hasExactly("Twin Star Axe")) && this.rValue == 5) || this.hasExactly("Prior's Tome") || this.hasExactly("Taciturn Axe")) && this.buddy.adjacent + this.buddy.two + this.buddy.three > 0){
				hpTally += 7;
				healName += data.skills[this.weaponIndex].name;
			}
			else if((this.hasExactly("Hallowed Tyrfing") || this.hasExactly("Apotheosis Spear")) && this.rValue > 0 && (this.initiator || enemy.combatStartHp / enemy.maxHp >= 0.75)){
				hpTally += 7;
				healName += data.skills[this.weaponIndex].name;
			}
			else if((this.hasExactly("Frostfire Breath") && this.rValue > 0 && (Object.values(this.bonus).reduce((a, item) => a + (item === true ? 1 : 0), 0) + this.bonus.extra > 0)) || this.hasExactly("Wyvern Lance") || this.hasExactly("Breezy Spear")){
				hpTally += 7;
				healName += data.skills[this.weaponIndex].name;
			}
			else if(this.hasExactly("Sunstone's Blade") && (this.initiator || this.toggle.weapon == 1)){
				hpTally += 10;
				healName += data.skills[this.weaponIndex].name;
			}
			else if(((this.hasExactly("Grim Brokkr") && this.rValue > 0) || this.hasExactly("Eagle's Heart")) && (this.initiator || this.buddy.adjacent < 2)){
				hpTally += 7;
				healName += data.skills[this.weaponIndex].name;
			}
			else if(this.hasExactly("Sky-Pirate Claw") && this.rValue > 0 && (this.transform == true || this.toggle.weapon == 1)){
				hpTally += 7;
				healName += data.skills[this.weaponIndex].name;
			}
			else if(this.hasExactly("Scroll of Teas") && (this.initiator || this.buddy.adjacent + this.buddy.two + this.buddy.three > 0)){
				hpTally += 10;
				healName += data.skills[this.weaponIndex].name;
			}
			else if(this.hasExactly("Laconic Axe") && (this.initiator || this.buddy.rorc > 0)){
				hpTally += 7;
				healName += data.skills[this.weaponIndex].name;
			}
			else if(this.hasExactly("Sword of Peace") && this.buddy.adjacent + this.buddy.two + this.buddy.three > 0){
				hpTally += 10;
				healName += data.skills[this.weaponIndex].name;
			}
			
			//a skills
			if(this.hasExactly("Knightly Devotion") && (this.initiator || this.toggle.a == 1)){
				hpTally += 7;
				if(healName != ""){
					healName += ", ";
				}
				healName += data.skills[this.aIndex].name;
			}
			else if((this.hasExactly("Atk Spd Wild") && (this.buddy.adjacent < 2 || this.transform == true)) || ((this.hasExactly("Atk Spd Fortune") || this.hasExactly("Atk Res Fortune")) && (!this.initiator || this.transform == true))){
				hpTally += 7;
				if(healName != ""){
					healName += ", ";
				}
				healName += data.skills[this.aIndex].name;
			}
			else if(this.hasExactly("Emblems' Miracle") && this.arise == true){
				hpTally += 99;
				if(healName != ""){
					healName += ", ";
				}
				healName += data.skills[this.aIndex].name;
			}
			else if(this.hasExactly("Fell Wyrmscale") && this.combatStartHp / this.maxHp >= 0.25){
				hpTally += 7;
				if(healName != ""){
					healName += ", ";
				}
				healName += data.skills[this.aIndex].name;
			}
			else if(this.hasExactly("Beyond Reason") && (!this.initiator || enemy.combatStartHp / enemy.maxHp >= 0.75)){
				hpTally += 7;
				if(healName != ""){
					healName += ", ";
				}
				healName += data.skills[this.aIndex].name;
			}
			else if(this.hasExactly("Primordial Boost") && (!this.initiator || this.combatStartHp / this.maxHp >= 0.5)){
				hpTally += 7;
				if(healName != ""){
					healName += ", ";
				}
				healName += data.skills[this.aIndex].name;
			}
			else if(this.hasExactly("New Opening") && (this.transform == true || enemy.combatStartHp / enemy.maxHp >= 0.75)){
				hpTally += 7;
				if(healName != ""){
					healName += ", ";
				}
				healName += data.skills[this.aIndex].name;
			}
			
			//b skills
			if(this.hasSlot("Mystic Boost","b")){
				hpTally += this.hasSlot("Mystic Boost","b") * 2;
				if(this.hasSlot("Mystic Boost","b") == 4){
					hpTally += 2;
				}
				if(healName != ""){
					healName += ", ";
				}
				healName += data.skills[this.bIndex].name;
			}
			else if((this.hasExactly("Armored Wall") || this.hasExactly("Weaving Fighter") || this.hasExactly("Canny Fighter") || this.hasExactly("Under the Sun") || this.hasExactly("Vedrfolnir's Wing")) && this.combatStartHp / this.maxHp >= 0.25){
				hpTally += 7;
				if(healName != ""){
					healName += ", ";
				}
				healName += data.skills[this.bIndex].name;
			}
			else if(this.has("Flow Refresh") && this.initiator){
				if(this.has("Flow Refresh") == 1 && this.combatStartHp / this.maxHp >= 1){
					hpTally += 5;
					if(healName != ""){
						healName += ", ";
					}
					healName += data.skills[this.bIndex].name;
				}
				else if(this.has("Flow Refresh") == 2 && this.combatStartHp / this.maxHp >= 0.5){
					hpTally += 7;
					if(healName != ""){
						healName += ", ";
					}
					healName += data.skills[this.bIndex].name;
				}
				else if(this.has("Flow Refresh") >= 3){
					hpTally += 10;
					if(healName != ""){
						healName += ", ";
					}
					healName += data.skills[this.bIndex].name;
				}
			}
			else if(this.hasExactly("Solar Brace 2")){
				hpTally += 10;
				if(healName != ""){
					healName += ", ";
				}
				healName += data.skills[this.bIndex].name;
			}
			else if(this.hasExactly("True Dragon Wall") && this.toggle.b > 1){
				hpTally += 7;
				if(healName != ""){
					healName += ", ";
				}
				healName += data.skills[this.bIndex].name;
			}
			else if(this.hasExactly("Pure Dragon Wall") && (this.toggle.b > 1 || this.buddy.adjacent + this.buddy.two > 0)){
				hpTally += 10;
				if(healName != ""){
					healName += ", ";
				}
				healName += data.skills[this.bIndex].name;
			}
			else if(this.has("Atk Def Bulwark")){
				hpTally += this.has("Atk Def Bulwark") * 2 + 1;
				if(this.hasExactly("Atk Def Bulwark 4")){
					hpTally -= 2;
				}
				if(healName != ""){
					healName += ", ";
				}
				healName += data.skills[this.bIndex].name;
			}
			else if(this.has("Spd Def Bulwark")){
				hpTally += this.has("Spd Def Bulwark") * 2 + 1;
				if(healName != ""){
					healName += ", ";
				}
				healName += data.skills[this.bIndex].name;
			}
			else if(this.has("Spd Res Bulwark")){
				hpTally += this.has("Spd Res Bulwark") * 2 + 1;
				if(this.hasExactly("Spd Res Bulwark 4")){
					hpTally -= 2;
				}
				if(healName != ""){
					healName += ", ";
				}
				healName += data.skills[this.bIndex].name;
			}
			else if(this.has("Atk Spd Bulwark")){
				hpTally += this.has("Atk Spd Bulwark") * 2 + 1;
				if(this.hasExactly("Atk Spd Bulwark 4")){
					hpTally -= 2;
				}
				if(healName != ""){
					healName += ", ";
				}
				healName += data.skills[this.bIndex].name;
			}
			else if(this.hasExactly("Counter Roar 4") || this.hasExactly("Divine Strength") || this.hasExactly("Faithful Loyalty 2")){
				hpTally += 7;
				if(healName != ""){
					healName += ", ";
				}
				healName += data.skills[this.bIndex].name;
			}
			else if(this.hasExactly("I Remember...") && (this.initiator || this.buddy.adjacent > 0 || this.buddy.two > 0)){
				hpTally += 7;
				if(healName != ""){
					healName += ", ";
				}
				healName += data.skills[this.bIndex].name;
			}
			//c skills
			if(this.hasExactly("Bern's New Way") && this.toggle.c == 1){
				hpTally += 7;
				if(healName != ""){
					healName += ", ";
				}
				healName += data.skills[this.cIndex].name;
			}
			else if(this.hasExactly("Mending Heart") && (this.initiator || this.buddy.adjacent > 0 || this.buddy.two > 0)){
				hpTally += 7;
				if(healName != ""){
					healName += ", ";
				}
				healName += data.skills[this.cIndex].name;
			}
			else if((this.hasExactly("Shadow Shift 4") || this.hasExactly("Shadow Smite 4")) && this.buddy.adjacent + this.buddy.two + this.buddy.three > 0){
				hpTally += 7;
				if(healName != ""){
					healName += ", ";
				}
				healName += data.skills[this.cIndex].name;
			}
			//s skills
			if(this.hasSlot("Mystic Boost","s")){
				hpTally += this.hasSlot("Mystic Boost","s") * 2;
				if(healName != ""){
					healName += ", ";
				}
				healName += data.skills[this.sIndex].name;
			}
			//specials
			if(this.hasExactly("Righteous Wind") && this.sTrigger == 1){
				hpTally += 10;
				if(healName != ""){
					healName += ", ";
				}
				healName += data.skills[this.specialIndex].name;
			}
			if(this.has("Life Unending") && this.sTrigger == 1){
				hpTally += 99;
				if(healName != ""){
					healName += ", ";
				}
				healName += data.skills[this.specialIndex].name;
			}
			if(this.hasExactly("Sacred Wind") && this.sTrigger == 1){
				hpTally += 20;
				if(healName != ""){
					healName += ", ";
				}
				healName += data.skills[this.specialIndex].name;
			}
			if(this.hasExactly("Great Aether") && this.sTrigger == 1){
				this.toggle.special = Math.max(this.toggle.special,1);
				hpTally += Math.min(this.toggle.special * 5 + 10, Math.floor(this.maxHp / 2));
				if(healName != ""){
					healName += ", ";
				}
				skillName += data.skills[this.specialIndex].name;
			}
			//supports
			if(this.support.revive == true && this.arise == true){
				hpTally += 99;
				if(healName != ""){
					healName += ", ";
				}
				healName += "Sacrifice Staff";
			}
			if(this.support.mboost > 0){
				hpTally += this.support.mboost;
				if(healName != ""){
					healName += ", ";
				}
				healName += "Restore HP After Combat Support";
			}
			if(this.bonus.essence && enemy.hp <= 0){
				hpTally += 10;
				if(healName != ""){
					healName += ", ";
				}
				healName += "Essence Drain";
			}
			if(this.bonus.dosage){
				hpTally += 10;
				if(healName != ""){
					healName += ", ";
				}
				healName += "Dosage";
			}
		}
		//calc hp adjustment
		if(hpTally > 0){
			if(this.maxHp - this.hp < hpTally){
				hpTally = this.maxHp - this.hp;
			}
			this.hp += hpTally;
			if(skillName != ""){
				healName += " and " + skillName;
			}
			postCombatHPText = this.name + " nets " + hpTally + " hp from " + healName + ".<br>";
		}
		else if(hpTally < 0){
			if(this.hp + hpTally <= 0){
				hpTally = -(this.hp - 1);
			}
			this.hp += hpTally;
			if(healName != ""){
				skillName += " and " + healName;
			}
			postCombatHPText = this.name + " nets " + hpTally + " hp from " + skillName + ".<br>";
		}
		return postCombatHPText;
	};
	
	this.tallyHeal = function(enemy, heal, spTrig){
		var thText = "";
		if(!this.penalty.fatal || this.bonus.nectar > 0){
			if(heal > 0){
				thText += this.name + " gains " + heal + " HP.<br>";
			}
		}
		else{
			var dwVal = 1;
			if(this.hasExactly("Wind Parthia") && (this.initiator || this.toggle.weapon == 1 || this.toggle.weapon == 3) && spTrig && this.rValue > 0){
				dwVal = dwVal * 0.4;
			}
			else if((this.hasExactly("Sol Lance") && this.rValue > 0 && this.combatStartHp / this.maxHp >= 0.25) || (this.hasExactly("Imbued Koma") && this.rValue == 5 && this.toggle.weapon == 1) || ((this.hasExactly("New War Axe") || (this.hasExactly("Resolved Fang") && this.rValue == 5)) && this.buddy.adjacent + this.buddy.two + this.buddy.three > 0) || (this.hasExactly("Horn of Harvest") && (!this.initiator || enemy.combatStartHp / enemy.maxHp >= 0.75)) || (this.hasExactly("Moonless Breath") && this.rValue > 0 && this.buddy.adjacent + this.buddy.two + this.buddy.three > 0)){
				dwVal = dwVal * 0.5;
			}
			if(this.hasExactly("Special Fighter 4") && this.combatStartHp / this.maxHp >= 0.4){
				dwVal = dwVal * 0.5;
			}
			if(this.hasExactly("Breath of Life 4") && this.buddy.adjacent + this.buddy.two > 0){
				dwVal = dwVal * 0.5;
			}
			if(this.hasExactly("Life Unending 2") && this.sTrigger == 1){
				dwVal = 0;
			}
			else if(this.hasExactly("Aether's Path")){
				dwVal = dwVal * 0.5;
			}
			if(this.support.rdw > 0){
				dwVal = dwVal * Math.pow(0.5, this.support.rdw);
			}
			heal = heal - Math.floor(heal * dwVal);
			var dwPerc = Math.floor((1 - dwVal) * 100);
			if(heal > 0){
				thText += this.name + " reduces Deep Wounds effect by " + dwPerc + "% and gains " + heal + " HP.<br>";
			}
		}
		this.hp = Math.min(this.maxHp, this.hp + heal);
		return thText;
	};

	this.seal = function(enemy){
		var sealText = "";
		var statName = ["","","",""];
		var bStat = 0;
		var sealAtk = 0;
		var sealSpd = 0;
		var sealDef = 0;
		var sealRes = 0;
		
		if(this.didAttack){
			if(this.hasExactly("Fear")){
				sealAtk = -6;
				statName[0] = data.skills[this.weaponIndex].name;
			}
			else if(this.hasExactly("Fear+")){
				sealAtk = -7;
				statName[0] = data.skills[this.weaponIndex].name;
			}
			else if(this.hasExactly("Slow")){
				sealSpd = -6;
				statName[1] = data.skills[this.weaponIndex].name;
			}
			else if(this.hasExactly("Slow+")){
				sealSpd = -7;
				statName[1] = data.skills[this.weaponIndex].name;
			}
			else if(this.hasExactly("Silver Dagger+") || this.hasExactly("Deathly Dagger") || this.hasExactly("Seashell+") || this.hasExactly("Dancer's Fan+") || this.hasExactly("Kagami Mochi+") || this.hasExactly("Felicia's Plate") || this.hasExactly("Lethal Carrot+") || this.hasExactly("The Cleaner+") || this.hasExactly("Barb Shuriken+") || this.hasExactly("Starfish+") || this.hasExactly("Dusk Uchiwa+") || this.hasExactly("Cloud Maiougi+") || this.hasExactly("Sky Maiougi+") || this.hasExactly("Hoarfrost Knife") || this.hasExactly("Bottled Juice+") || this.hasExactly("Sylgr") || this.hasExactly("Lyfjaberg") || this.hasExactly("Goodie Boot+") || this.hasExactly("Red-Hot Ducks+") || this.hasExactly("Ouch Pouch+") || this.hasExactly("Splashy Bucket+") || this.hasExactly("Saehrimnir") || this.hasExactly("Kagero's Dart") || this.hasExactly("Tropical Treats+") || this.hasExactly("Scallop Blade+") || this.hasExactly("Broadleaf Fan+") || this.hasExactly("Athame") || this.hasExactly("Hunting Blade") || this.hasExactly("Pumpkin-a-Box+") || this.hasExactly("Dragonslasher+") || this.hasExactly("Minty Cane+") || this.hasExactly("Temari+") || this.hasExactly("Jakob's Tray") || this.hasExactly("Constant Dagger") || this.hasExactly("Candied Dagger") || this.hasExactly("Summer Strikers") || this.hasExactly("Hidden Thorns+") || this.hasExactly("Caltrop Dagger+") || this.hasExactly("Courtly Mask+") || this.hasExactly("Courtly Fan+") || this.hasExactly("Tailwind Shuriken") || this.hasExactly("Kaze's Needle") || this.hasExactly("Honorable Blade") || this.hasExactly("Fireman's Hook") || this.hasExactly("Nabata Kunai") || this.hasExactly("Dreamflake") || this.hasExactly("Nidavellir Sprig") || this.hasExactly("Vicious Dagger+") || this.hasExactly("Quick Dagger+") || this.hasExactly("Blade of Jehanna") || this.hasExactly("Bone Carver+") || this.hasExactly("Hurricane Dagger") || this.hasExactly("Armorpin Dagger+") || this.hasExactly("Frozen Delight") || this.hasExactly("Florid Knife+") || this.hasExactly("Shadowy Quill") || this.hasExactly("Kindling Taiko") || this.hasExactly("Everliving Ymir") || this.hasExactly("Asura Blades") || this.hasExactly("Abyssal Blade") || this.hasExactly("Bunny's Egg+") || this.hasExactly("Playful Pinwheel") || this.hasExactly("Brightwind Fans") || this.hasExactly("Miasma Dagger+") || this.hasExactly("Wildcat Dagger") || this.hasExactly("Spy's Shuriken") || this.hasExactly("Arcane Void") || this.hasExactly("Gondul") || this.hasExactly("Silent Yule Knife") || this.hasExactly("Clever Dagger+") || this.hasExactly("Blade Royale") || this.hasExactly("Perspicacious") || this.hasExactly("Thief's Honesty") || this.hasExactly("Arcane Tempest") || this.hasExactly("Small Spade+") || this.hasExactly("Dual Sword") || this.hasExactly("Ice Dagger+") || this.hasExactly("Gainful Dagger+") || this.hasExactly("Giant Shuriken+") || this.hasExactly("Convoy Dagger") || this.hasExactly("Arcane Sly Knife") || this.hasExactly("Red-Fist Blades") || this.hasExactly("Helping Dagger+") || this.hasExactly("Jehanna Dagger+") || this.hasExactly("Hidden Blade")){
				sealDef = -7;
				sealRes = -7;
				statName[2] = data.skills[this.weaponIndex].name;
				statName[3] = data.skills[this.weaponIndex].name;
			}
			else if(this.hasExactly("Silver Dagger") || this.hasExactly("Rogue Dagger+") || this.hasExactly("Seashell") || this.hasExactly("Dancer's Fan") || this.hasExactly("Kagami Mochi") || this.hasExactly("Lethal Carrot") || this.hasExactly("The Cleaner") || this.hasExactly("Barb Shuriken") || this.hasExactly("Starfish") || this.hasExactly("Dusk Uchiwa") || this.hasExactly("Cloud Maiougi") || this.hasExactly("Sky Maiougi") || this.hasExactly("Bottled Juice") || this.hasExactly("Goodie Boot") || this.hasExactly("Red-Hot Ducks") || this.hasExactly("Ouch Pouch") || this.hasExactly("Splashy Bucket") || this.hasExactly("Tropical Treats") || this.hasExactly("Spy's Dagger") || this.hasExactly("Scallop Blade") || this.hasExactly("Broadleaf Fan") || this.hasExactly("Pumpkin-a-Box") || this.hasExactly("Dragonslasher") || this.hasExactly("Minty Cane") || this.hasExactly("Temari") || this.hasExactly("Hidden Thorns") || this.hasExactly("Caltrop Dagger") || this.hasExactly("Courtly Mask") || this.hasExactly("Courtly Fan") || this.hasExactly("Vicious Dagger") || this.hasExactly("Quick Dagger") || this.hasExactly("Bone Carver") || this.hasExactly("Armorpin Dagger") || this.hasExactly("Florid Knife") || this.hasExactly("Bunny's Egg") || this.hasExactly("Miasma Dagger") || this.hasExactly("Clever Dagger") || this.hasExactly("Small Spade") || this.hasExactly("Ice Dagger") || this.hasExactly("Gainful Dagger") || this.hasExactly("Giant Shuriken") || this.hasExactly("Helping Dagger") || this.hasExactly("Jehanna Dagger")){
				sealDef = -5;
				sealRes = -5;
				statName[2] = data.skills[this.weaponIndex].name;
				statName[3] = data.skills[this.weaponIndex].name;
				if((this.hasExactly("Rogue Dagger+") && this.rValue > 0) || this.hasExactly("Spy's Dagger")){
					sealDef = -6;
					sealRes = -6;
				}
			}
			else if((this.hasExactly("Iron Dagger") || this.hasExactly("Steel Dagger") || this.hasExactly("Rogue Dagger")) && sealDef > -3){
				sealDef = -3;
				sealRes = -3;
				statName[2] = data.skills[this.weaponIndex].name;
				statName[3] = data.skills[this.weaponIndex].name;
			}
			else if(this.hasExactly("Poison Dagger+") && sealDef > -6 && enemy.moveType == "infantry"){
				sealDef = -6;
				sealRes = -6;
				statName[2] = data.skills[this.weaponIndex].name;
				statName[3] = data.skills[this.weaponIndex].name;
			}
			else if(this.hasExactly("Poison Dagger") && sealDef > -4 && enemy.moveType == "infantry"){
				sealDef = -4;
				sealRes = -4;
				statName[2] = data.skills[this.weaponIndex].name;
				statName[3] = data.skills[this.weaponIndex].name;
			}
			else if(this.hasExactly("Kitty Paddle+") && sealDef > -7 && (enemy.weaponType == "redtome" || enemy.weaponType == "bluetome" || enemy.weaponType == "greentome" || enemy.weaponType == "graytome")){
				sealDef = -7;
				sealRes = -7;
				statName[2] = data.skills[this.weaponIndex].name;
				statName[3] = data.skills[this.weaponIndex].name;
			}
			else if(this.hasExactly("Kitty Paddle") && sealDef > -5 && (enemy.weaponType == "redtome" || enemy.weaponType == "bluetome" || enemy.weaponType == "greentome" || enemy.weaponType == "graytome")){
				sealDef = -5;
				sealRes = -5;
				statName[2] = data.skills[this.weaponIndex].name;
				statName[3] = data.skills[this.weaponIndex].name;
			}
			else if((this.hasExactly("Smoke Dagger+") && this.rValue > 0) || this.hasExactly("Saizo's Star")){
				sealAtk = -6;
				sealSpd = -6;
				sealDef = -6;
				sealRes = -6;
				statName[0] = data.skills[this.weaponIndex].name;
				statName[1] = data.skills[this.weaponIndex].name;
				statName[2] = data.skills[this.weaponIndex].name;
				statName[3] = data.skills[this.weaponIndex].name;
			}
			else if(this.hasExactly("Clarisse's Bow+") && this.rValue > 0){
				sealAtk = -5;
				sealSpd = -5;
				statName[0] = data.skills[this.weaponIndex].name;
				statName[1] = data.skills[this.weaponIndex].name;
			}
			else if((this.hasExactly("Dark Breath+") && this.rValue > 0) || this.hasExactly("Gloom Breath") || this.hasExactly("Elena's Staff")){
				sealAtk = -7;
				sealSpd = -7;
				statName[0] = data.skills[this.weaponIndex].name;
				statName[1] = data.skills[this.weaponIndex].name;
			}
			else if(this.hasExactly("Peshkatz")){
				sealAtk = -4;
				sealSpd = -4;
				sealDef = -4;
				sealRes = -4;
				if(this.rValue > 0){
					sealAtk = -5;
					sealSpd = -5;
					sealDef = -5;
					sealRes = -5;
				}
				statName[0] = data.skills[this.weaponIndex].name;
				statName[1] = data.skills[this.weaponIndex].name;
				statName[2] = data.skills[this.weaponIndex].name;
				statName[3] = data.skills[this.weaponIndex].name;
			}
			else if(this.hasExactly("Grima's Truth") && this.rValue < 0){
				sealAtk = -5;
				sealSpd = -5;
				statName[0] = data.skills[this.weaponIndex].name;
				statName[1] = data.skills[this.weaponIndex].name;
			}
			else if(this.hasExactly("Hlidskjalf")){
				sealAtk = -4;
				sealSpd = -4;
				sealDef = -4;
				sealRes = -4;
				statName[0] = data.skills[this.weaponIndex].name;
				statName[1] = data.skills[this.weaponIndex].name;
				statName[2] = data.skills[this.weaponIndex].name;
				statName[3] = data.skills[this.weaponIndex].name;
			}
			else if(this.hasExactly("Sniper's Bow")){
				sealAtk = -7;
				sealSpd = -7;
				statName[0] = data.skills[this.weaponIndex].name;
				statName[1] = data.skills[this.weaponIndex].name;
			}
			else if(this.hasExactly("Staff of Lilies") && this.rValue == 5 && (this.initiator || this.toggle.weapon == 1)){
				sealAtk = -6;
				sealSpd = -6;
				statName[0] = data.skills[this.weaponIndex].name;
				statName[1] = data.skills[this.weaponIndex].name;
			}
		}
		
		//non-weapon seals will not work when skill owner is dead
		if(this.hp > 0){
			if(this.has("Seal Atk")){ //Will count for seal atk speed as well
				var sAtk = this.hasGreatest("Seal Atk");
				bStat = Math.max(-sAtk[0] * 2 -1,-7);
				if(this.hasExactly("Seal Atk Res 3")){
					bStat = -6;
				}
				if(bStat < sealAtk){
					sealAtk = bStat;
					statName[0] = this.skillNames[sAtk[1]];
				}
				var aarVal = -this.has("Seal Atk Res") * 2 - 1;
				if(this.hasExactly("Seal Atk Res 3")){
					aarVal = -6;
				}
				if(this.has("Seal Atk Res") && sealRes > aarVal){
					sealRes = aarVal;
					statName[3] = data.skills[this.bIndex].name;
				}
				//This will not work when double seal becomes a sacred seal, all of them will need to be changed to hasGreatest method
				if(this.has("Seal Atk Spd") && sealSpd > -this.has("Seal Atk Spd") * 2 - 1){
					sealSpd = -this.has("Seal Atk Spd") * 2 - 1;
					statName[1] = data.skills[this.bIndex].name;
				}
				if(this.has("Seal Atk Def") && sealDef > -this.has("Seal Atk Def") * 2 - 1){
					sealDef = -this.has("Seal Atk Def") * 2 - 1;
					statName[2] = data.skills[this.bIndex].name;
				}
			}
			if(this.has("Seal Spd")){
				var sSpd = this.hasGreatest("Seal Spd");
				bStat = Math.max(-sSpd[0] * 2 -1,-7);
				if(this.hasExactly("Seal Spd Res 3") || this.hasExactly("Seal Spd Def 3")){
					bStat = -6;
				}
				if(bStat < sealSpd){
					sealSpd = bStat;
					statName[1] = this.skillNames[sSpd[1]];
				}
				var ssrVal = -this.has("Seal Spd Res") * 2 - 1;
				if(this.hasExactly("Seal Spd Res 3")){
					ssrVal = -6;
				}
				if(this.has("Seal Spd Res") && sealRes > ssrVal){
					sealRes = ssrVal;
					statName[3] = data.skills[this.bIndex].name;
				}
				var ssdVal = -this.has("Seal Spd Def") * 2 - 1;
				if(this.hasExactly("Seal Spd Def 3")){
					ssdVal = -6;
				}
				if(this.has("Seal Spd Def") && sealDef > ssdVal){
					sealDef = ssdVal;
					statName[2] = data.skills[this.bIndex].name;
				}
			}
			if(this.has("Seal Def")){
				var sDef = this.hasGreatest("Seal Def");
				bStat = Math.max(-sDef[0] * 2 -1,-7);
				if(this.hasExactly("Seal Def Res 3")){
					bStat = -6;
				}
				if(bStat < sealDef){
					sealDef = bStat;
					statName[2] = this.skillNames[sDef[1]];
				}
				var ssrVal = -this.has("Seal Def Res") * 2 - 1;
				if(this.hasExactly("Seal Def Res 3")){
					ssrVal = -6;
				}
				if(this.has("Seal Def Res") && sealRes > ssrVal){
					sealRes = ssrVal;
					statName[3] = data.skills[this.bIndex].name;
				}
			}
			if(this.has("Seal Res")){
				var sRes = this.hasGreatest("Seal Res");
				bStat = Math.max(-sRes[0] * 2 -1,-7);
				if(bStat < sealRes){
					sealRes = bStat;
					statName[3] = this.skillNames[sRes[1]];
				}
			}
			if(this.hasExactly("Atrocity") && enemy.combatStartHp / enemy.maxHp >= 0.5){
				if(sealAtk > -5){
					sealAtk = -5;
					statName[0] = data.skills[this.bIndex].name;
				}
				if(sealSpd > -5){
					sealSpd = -5;
					statName[1] = data.skills[this.bIndex].name;
				}
				if(sealDef > -5){
					sealDef = -5;
					statName[2] = data.skills[this.bIndex].name;
				}
				if(sealRes > -5){
					sealRes = -5;
					statName[3] = data.skills[this.bIndex].name;
				}
			}
			if((this.hasExactly("Atrocity 2") && enemy.combatStartHp / enemy.maxHp >= 0.4) || (this.hasExactly("Barbarity") && enemy.combatStartHp / enemy.maxHp >= 0.25)){
				if(sealAtk > -6){
					sealAtk = -6;
					statName[0] = data.skills[this.bIndex].name;
				}
				if(sealSpd > -6){
					sealSpd = -6;
					statName[1] = data.skills[this.bIndex].name;
				}
				if(sealDef > -6){
					sealDef = -6;
					statName[2] = data.skills[this.bIndex].name;
				}
				if(sealRes > -6){
					sealRes = -6;
					statName[3] = data.skills[this.bIndex].name;
				}
			}
		}
		if(this.hasExactly("Wizened Breath") && this.combatStartHp / this.maxHp >= 0.25){
			sealAtk = -6;
			sealSpd = -6;
			sealDef = -6;
			sealRes = -6;
			statName[0] = data.skills[this.weaponIndex].name;
			statName[1] = data.skills[this.weaponIndex].name;
			statName[2] = data.skills[this.weaponIndex].name;
			statName[3] = data.skills[this.weaponIndex].name;
		}
		else if(this.hasExactly("Crusher") && this.rValue == 5 && (this.initiator || this.buddy.adjacent > 0 || this.buddy.two > 0)){
			sealSpd = -6;
			sealDef = -6;
			sealRes = -6;
			statName[1] = data.skills[this.weaponIndex].name;
			statName[2] = data.skills[this.weaponIndex].name;
			statName[3] = data.skills[this.weaponIndex].name;
		}
		
		if(sealAtk < enemy.combatDebuffs.atk){
			enemy.combatDebuffs.atk = sealAtk;
			sealText += this.name + " lowers " + enemy.name + "'s atk by " + (-sealAtk) + " after combat with " + statName[0] + ".<br>";
		}
		if(sealSpd < enemy.combatDebuffs.spd){
			enemy.combatDebuffs.spd = sealSpd;
			sealText += this.name + " lowers " + enemy.name + "'s spd by " + (-sealSpd) + " after combat with " + statName[1] + ".<br>";
		}
		if(sealDef < enemy.combatDebuffs.def){
			enemy.combatDebuffs.def = sealDef;
			sealText += this.name + " lowers " + enemy.name + "'s def by " + (-sealDef) + " after combat with " + statName[2] + ".<br>";
		}
		if(sealRes < enemy.combatDebuffs.res){
			enemy.combatDebuffs.res = sealRes;
			sealText += this.name + " lowers " + enemy.name + "'s res by " + (-sealRes) + " after combat with " + statName[3] + ".<br>";
		}
		return sealText;
	};

	this.postCombatBuff = function(){
		var postCombatBuffText = "";

		//Daggers only take effect if the unit performed an attack
		if(this.didAttack){
			var skillName = "";

			//Will need to split these up if there comes another thing which boosts def or res after combat
			var buffAtk = 0;
			var buffSpd = 0;
			var buffDef = 0;
			var buffRes = 0;
			if(this.hasExactly("Rogue Dagger+")){
				buffDef = 5;
				buffRes = 5;
				skillName = data.skills[this.weaponIndex].name;
				if(this.rValue > 0){
					buffDef = 6;
					buffRes = 6;
				}
			}
			else if(this.hasExactly("Rogue Dagger")){
				buffDef = 3;
				buffRes = 3;
				skillName = data.skills[this.weaponIndex].name;
			}
			else if((this.hasExactly("First Bite+") || this.hasExactly("Cupid Arrow+") || this.hasExactly("Blessed Bouquet+")) && this.rValue > 0){
				buffDef = 5;
				buffRes = 5;
				skillName = data.skills[this.weaponIndex].name;
			}
			else if(this.hasExactly("Light Breath+") && this.rValue > 0){
				buffAtk = 5;
				buffSpd = 5;
				buffDef = 5;
				buffRes = 5;
				skillName = data.skills[this.weaponIndex].name;
			}
			else if(this.hasExactly("Peshkatz")){
				buffAtk = 4;
				buffSpd = 4;
				buffDef = 4;
				buffRes = 4;
				if(this.rValue > 0){
					buffAtk = 5;
					buffSpd = 5;
					buffDef = 5;
					buffRes = 5;
				}
				skillName = data.skills[this.weaponIndex].name;
			}
			else if(this.hasExactly("Grima's Truth") && this.rValue < 0){
				buffAtk = 5;
				buffSpd = 5;
				skillName = data.skills[this.weaponIndex].name;
			}
			else if(this.hasExactly("Hlidskjalf")){
				buffAtk = 4;
				buffSpd = 4;
				buffDef = 4;
				buffRes = 4;
				skillName = data.skills[this.weaponIndex].name;
			}
			else if(this.hasExactly("Spy's Dagger")){
				buffDef = 6;
				buffRes = 6;
				skillName = data.skills[this.weaponIndex].name;
			}
			else if((this.hasExactly("Fire Emblem") || this.hasExactly("Hero's Blood")) && this.sTrigger == 1){
				buffAtk = 4;
				buffSpd = 4;
				buffDef = 4;
				buffRes = 4;
				skillName = data.skills[this.specialIndex].name;
			}
			else if((this.hasExactly("Holy-Knight Aura") || this.hasExactly("Chivalric Aura")) && this.sTrigger == 1){
				buffAtk = 6;
				skillName = data.skills[this.specialIndex].name;
			}
			else if(this.hasExactly("Shining Emblem") && this.sTrigger == 1){
				buffAtk = 6;
				buffSpd = 6;
				buffDef = 6;
				buffRes = 6;
				skillName = data.skills[this.specialIndex].name;
			}
			else if(this.hasExactly("Holy-Knight 2") && this.sTrigger == 1){
				buffAtk = 6;
				buffDef = 6;
				skillName = data.skills[this.specialIndex].name;
			}
			
			if(buffAtk > this.combatBuffs.atk){
				this.combatBuffs.atk = buffAtk;
				postCombatBuffText += this.name + " gains " + buffAtk + " atk after combat from " + skillName + ".<br>";
			}
			if(buffSpd > this.combatBuffs.spd){
				this.combatBuffs.spd = buffSpd;
				postCombatBuffText += this.name + " gains " + buffSpd + " spd after combat from " + skillName + ".<br>";
			}
			if(buffDef > this.combatBuffs.def){
				this.combatBuffs.def = buffDef;
				postCombatBuffText += this.name + " gains " + buffDef + " def after combat from " + skillName + ".<br>";
			}
			if(buffRes > this.combatBuffs.res){
				this.combatBuffs.res = buffRes;
				postCombatBuffText += this.name + " gains " + buffRes + " res after combat from " + skillName + ".<br>";
			}
		}

		return postCombatBuffText;
	};

	this.takeDamage = function(dmg){
		//TODO
	};

	//represents one attack of combat
	this.doDamage = function(enemy,brave,AOE,followHit,firstHit,speedBlade,galeused,thisFollowUp,enemyFollowUp,turn,spCharged,potent,eBrave,hitback){
		//didAttack variable for checking daggers and pain
		this.didAttack = true;

		var enemyDefModifier = 0;
		var effectiveBonus = this.effMod(enemy, turn);
		var dmgMultiplier = 1.0;
		var dmgBoost = 0;
		var flatBoost = 0;
		var flatReduction = 0;
		var absorbPct = 0;
		var damageText = "";
		
		var allStats = getEffStats(this, enemy, turn);
		var thisEffAtk = allStats[0];
		var thisEffSpd = allStats[1];
		var thisEffDef = allStats[2];
		var thisEffRes = allStats[3];
		var enemyEffAtk = allStats[4];
		var enemyEffSpd = allStats[5];
		var enemyEffDef = allStats[6];
		var enemyEffRes = allStats[7];
		var bladeCheck = allStats[8];
		var cleanCheck = allStats[9];
		var relevantAOEDef = allStats[11];
		var relevantHP = this.combatStartHp;
		//switch hp if AOE so you don't check combatStartHp
		if(AOE){
			relevantHP = this.hp;
		}
		var parity = false;
		if(this.hasExactly("Queensblade") || enemy.hasExactly("Queensblade") || this.hasExactly("Breezy Spear") || enemy.hasExactly("Breezy Spear")){
			parity = true;
		}

		var enemyTileDef = allStats[22];
		var enemyTileRes = allStats[23];
		
		var relevantDef = enemyEffDef;
		var relevantTileDef = Math.floor(enemyEffDef*enemy.dTile);
		var relevantAOETileDef = Math.floor(enemyTileDef*enemy.dTile);
		
		//hit Res if skill/condition meets rather than Def
		if((this.attackType=="magical" || ((data.magicalWeapons.indexOf(enemy.weaponType) == -1 || enemy.weaponType == "dragon") && this.hasExactly("Hel's Reaper"))) || (this.hasExactly("Flame Lance") && (relevantHP / this.maxHp >= 0.5 || (this.rValue > 0 && relevantHP / this.maxHp >= 0.25)))){
			relevantDef = enemyEffRes;
			relevantTileDef = Math.floor(enemyEffRes*enemy.dTile);
			relevantAOETileDef = Math.floor(enemyTileRes*enemy.dTile);
			relevantAOEDef = allStats[12];
		}
		//select higher skill level between Sorcery Blade A/S
		var sorceryCheck = false;
		if(this.bonus.bexblade == true){
			sorceryCheck = true;
		}
		//AOE needs to check hp
		else if(this.has("Sorcery Blade")){
			if(relevantHP / this.maxHp >= 1.5 + this.hasSlot("Sorcery Blade","a") * -0.5 && this.toggle.a == 1){
				sorceryCheck = true;
			}
			if(relevantHP / this.maxHp >= 1.5 + this.hasSlot("Sorcery Blade","s") * -0.5 && this.toggle.s == 1){
				sorceryCheck = true;
			}
		}
		
		//select lower of def/res to be impacted by upgraded breath, Felicia's Plate, or activated Sorcery Blade (& etc.)
		if(((this.weaponType == "dragon" && (data.upgradedBreath.indexOf(this.skillNames[0]) == -1 || this.rValue > 0) && enemy.range == "ranged") || this.hasExactly("Felicia's Plate") || this.hasExactly("Crusher") || this.hasExactly("Ladyblade") || ((this.hasExactly("Mermaid Bow") || this.hasExactly("Violdrake Bow") || (this.hasExactly("Levin Dagger") && this.rValue == 5)) && this.combatStartHp / this.maxHp >= 0.25) || (this.hasExactly("Shadowy Quill") && (this.initiator || this.toggle.weapon == 1)) || (this.hasExactly("Deliverer's Brand") && this.combatStartHp / this.maxHp >= 0.25 && (this.hasExactly("Glowing Ember") || this.hasExactly("Bonfire") || this.hasExactly("Ignis")) && data.skills[this.specialIndex].charge <= this.charge) || this.hasExactly("New Levin Sword") || this.hasExactly("Ice-Tribe Axe") || this.has("Ice Dagger") || this.hasExactly("Praise-Piner Axe") || (this.hasExactly("Azure Twin Edge") && this.style == 3 && this.tstyle == true) || (this.support.hexblade && this.moveType == "infantry") || sorceryCheck) && (!enemy.has("Mystic Boost")) && (!enemy.has("Splashy Bucket")) && (!enemy.has("Light and Dark")) && !(enemy.hasExactly("Divine Naga") && enemy.rValue > 0) && !(enemy.hasExactly("Naga") && enemy.rValue == 5 && this.weaponType == "dragon") && !(enemy.hasExactly("Aureola") && (enemy.initiator || enemy.buddy.adjacent > 0 || enemy.buddy.two > 0)) && !(enemy.hasExactly("Close Ward") && data.magicalWeapons.indexOf(this.weaponType) != -1 && this.initiator) && !(enemy.hasExactly("Spirit Forest Writ") && enemy.toggle.weapon == 1) && !(enemy.hasExactly("Radiant Aureola") && (this.initiator || this.combatStartHp / this.maxHp >= 0.75)) && !(enemy.hasExactly("Rare Talent") && enemy.combatStartHp / enemy.maxHp >= 0.25) && !(enemy.hasExactly("Indignant Bow") && enemy.rValue > 0) && !enemy.hasExactly("Fell Majesty")){
			relevantDef = Math.min(enemyEffDef, enemyEffRes);
			relevantTileDef = Math.min(Math.floor(enemyEffDef*enemy.dTile), Math.floor(enemyEffRes*enemy.dTile));
			relevantAOETileDef = Math.min(Math.floor(enemyTileDef*enemy.dTile), Math.floor(enemyTileRes*enemy.dTile));
		}
		//AOE damage is not affected by HexBlade status/Light and Dark/etc
		if(((this.weaponType == "dragon" && (data.upgradedBreath.indexOf(this.skillNames[0]) == -1 || this.rValue > 0) && enemy.range == "ranged") || this.hasExactly("Felicia's Plate") || this.hasExactly("Crusher") || this.hasExactly("Ladyblade") || ((this.hasExactly("Mermaid Bow") || this.hasExactly("Violdrake Bow") || (this.hasExactly("Levin Dagger") && this.rValue == 5)) && this.combatStartHp / this.maxHp >= 0.25) || (this.hasExactly("Shadowy Quill") && (this.initiator || this.toggle.weapon == 1)) || this.hasExactly("New Levin Sword") || this.hasExactly("Ice-Tribe Axe") || this.has("Ice Dagger") || this.hasExactly("Praise-Piner Axe") || sorceryCheck) && (!enemy.has("Mystic Boost")) && (!enemy.has("Splashy Bucket")) && !(enemy.hasExactly("Divine Naga") && enemy.rValue > 0) && !(enemy.hasExactly("Naga") && enemy.rValue == 5 && this.weaponType == "dragon") && !(enemy.hasExactly("Aureola") && (enemy.initiator || enemy.buddy.adjacent > 0 || enemy.buddy.two > 0)) && !(enemy.hasExactly("Close Ward") && data.magicalWeapons.indexOf(this.weaponType) != -1 && this.initiator) && !(enemy.hasExactly("Spirit Forest Writ") && enemy.toggle.weapon == 1) && !(enemy.hasExactly("Indignant Bow") && enemy.rValue > 0) && !enemy.hasExactly("Fell Majesty")){
			relevantAOEDef = Math.min(allStats[11], allStats[12]);
		}
		relevantTileDef = Math.max(0,relevantTileDef);
		relevantAOETileDef = Math.max(0,relevantAOETileDef);

		//blade tomes add atk, clean type weapons add atk from enemy buff
		var bladeAtk = 0;
		if(this.has("Raudrblade") || this.has("Blarblade") || this.has("Gronnblade") || this.hasExactly("Thunderhead") || this.hasExactly("Odin's Grimoire") || this.hasExactly("Laevatein") || this.hasExactly("Tharja's Hex") || this.hasExactly("Iris's Tome") || (this.hasExactly("Twin Star Axe") && this.rValue < 0)){
			if(bladeCheck){
				if(!allStats[14][0]){
					bladeAtk += Math.max(this.buffs.atk,this.combatBuffs.atk);
				}
				if(!allStats[14][1]){
					bladeAtk += Math.max(this.buffs.spd,this.combatBuffs.spd);
				}
				if(!allStats[14][2]){
					bladeAtk += Math.max(this.buffs.def,this.combatBuffs.def);
				}
				if(!allStats[14][3]){
					bladeAtk += Math.max(this.buffs.res,this.combatBuffs.res);
				}
				if(this.hasExactly("Twin Star Axe") && this.rValue < 0){
					bladeAtk = Math.floor(bladeAtk / 2);
				}
				thisEffAtk += bladeAtk;
				if(bladeAtk > 0 && !AOE){
					damageText += this.name + " gains +" + bladeAtk + " bonus to atk from " + data.skills[this.weaponIndex].name + ". ";
				}
			}
		}
		//Frostfire Breath adds a bit different, but same principle
		else if(this.hasExactly("Frostfire Breath") && (Object.values(this.bonus).reduce((a, item) => a + (item === true ? 1 : 0), 0) + this.bonus.extra > 0 || checkAllBuffs(this, enemy, turn))){
			if(bladeCheck){
				var fbDef = Math.max(this.buffs.def,this.combatBuffs.def) * 1.5;
				var fbRes = Math.max(this.buffs.res,this.combatBuffs.res) * 1.5;
				if(this.rValue > 0){
					fbDef = Math.max(this.buffs.def,this.combatBuffs.def,this.buddy.buffs.def) * 2;
					fbRes = Math.max(this.buffs.res,this.combatBuffs.res,this.buddy.buffs.res) * 2;
				}
				if(!allStats[14][2]){
					bladeAtk += Math.floor(fbDef);
				}
				if(!allStats[14][3]){
					bladeAtk += Math.floor(fbRes);
				}
				thisEffAtk += bladeAtk;
				if(bladeAtk > 0 && !AOE){
					damageText += this.name + " gains +" + bladeAtk + " bonus to atk from " + data.skills[this.weaponIndex].name + ". ";
				}
			}
		}
		else if((this.has("The Cleaner") || this.hasExactly("Hurricane Dagger")) && cleanCheck){
			if(!allStats[15][0]){
				bladeAtk += Math.max(enemy.buffs.atk,enemy.combatBuffs.atk);
			}
			if(!allStats[15][1]){
				bladeAtk += Math.max(enemy.buffs.spd,enemy.combatBuffs.spd);
			}
			if(!allStats[15][2]){
				bladeAtk += Math.max(enemy.buffs.def,enemy.combatBuffs.def);
			}
			if(!allStats[15][3]){
				bladeAtk += Math.max(enemy.buffs.res,enemy.combatBuffs.res);
			}
			thisEffAtk += bladeAtk;
			if(bladeAtk > 0 && !AOE){
				damageText += this.name + " gains +" + bladeAtk + " bonus to atk from " + data.skills[this.weaponIndex].name + ". ";
			}
		}
		else if(this.hasExactly("Blizzard") || (this.hasExactly("Spy's Dagger") && this.rValue == 5) || this.has("Broadleaf Fan") || (this.hasExactly("Blue-Crow Tome") && this.rValue == 5) || ((this.hasExactly("Valflame") || this.hasExactly("Wargod's Tome")) && this.rValue == 5) || (this.hasExactly("Hikami") && this.rValue == 5 && (this.initiator || this.toggle.weapon > 1))){
			bladeAtk = Math.min(enemy.debuffs.atk,enemy.combatDebuffs.atk) + Math.min(enemy.debuffs.spd,enemy.combatDebuffs.spd) + Math.min(enemy.debuffs.def,enemy.combatDebuffs.def) + Math.min(enemy.debuffs.res,enemy.combatDebuffs.res);
			if(enemy.penalty.panic){
				bladeAtk -= Math.max(enemy.buffs.atk,enemy.combatBuffs.atk) + Math.max(enemy.buffs.spd,enemy.combatBuffs.spd) + Math.max(enemy.buffs.def,enemy.combatBuffs.def) + Math.max(enemy.buffs.res,enemy.combatBuffs.res);
			}
			thisEffAtk -= bladeAtk;
			bladeAtk = bladeAtk * -1;
			if(bladeAtk > 0 && !AOE){
				damageText += this.name + " gains +" + bladeAtk + " bonus to atk from " + data.skills[this.weaponIndex].name + ". ";
			}
		}
		else if(this.hasExactly("Order's Sentence") && (this.combatStartHp / this.maxHp >= 0.25 || this.checkBonPen(1, enemy, turn)) && bladeCheck){
			var bVal = this.buddy.buffs.atk + this.buddy.buffs.spd + this.buddy.buffs.def + this.buddy.buffs.res;
			if(this.rValue > 0){
				if(!this.penalty.panic){
					bVal = Math.max(this.combatBuffs.atk,this.buffs.atk) + Math.max(this.combatBuffs.spd,this.buffs.spd) + Math.max(this.combatBuffs.def,this.buffs.def) + Math.max(this.combatBuffs.res,this.buffs.res);
				}
				bVal = Math.max(bVal,this.buddy.buffs.atk + this.buddy.buffs.spd + this.buddy.buffs.def + this.buddy.buffs.res);
				bVal = Math.floor(bVal * 1.5);
			}
			thisEffAtk += bVal;
			if(bVal > 0 && !AOE){
				damageText += this.name + " gains +" + bVal + " bonus to atk from " + data.skills[this.weaponIndex].name + ". ";
			}
		}
		else if(this.hasExactly("Twin Star Axe") && this.rValue > 0){
			var bVal = this.buddy.buffs.atk + this.buddy.buffs.spd + this.buddy.buffs.def + this.buddy.buffs.res;
			if(bladeCheck && !this.penalty.panic){
				var cVal = Math.max(this.combatBuffs.atk,this.buffs.atk) + Math.max(this.combatBuffs.spd,this.buffs.spd) + Math.max(this.combatBuffs.def,this.buffs.def) + Math.max(this.combatBuffs.res,this.buffs.res);
				bVal = Math.max(bVal, cVal);
			}
			thisEffAtk += bVal;
			enemyEffAtk -= bVal;
			if(bVal > 0 && !AOE){
				damageText += this.name + " gains +" + bVal + " atk and inflicts -" + bVal + " atk to " + enemy.name + " from " + data.skills[this.weaponIndex].name + ". ";
			}
		}
		bladeAtk = 0;
		//Treachery calculation.  Counts as true damage.
		var treachDmg = 0;
		var AOETreachDmg = 0;
		if(this.bonus.treachery && !this.penalty.ploy && !this.penalty.panic){
			if(bladeCheck){
				if(!allStats[14][0]){
					treachDmg += Math.max(this.buffs.atk,this.combatBuffs.atk);
				}
				if(!allStats[14][1]){
					treachDmg += Math.max(this.buffs.spd,this.combatBuffs.spd);
				}
				if(!allStats[14][2]){
					treachDmg += Math.max(this.buffs.def,this.combatBuffs.def);
				}
				if(!allStats[14][3]){
					treachDmg += Math.max(this.buffs.res,this.combatBuffs.res);
				}
			}
			AOETreachDmg = Math.max(this.buffs.atk,this.combatBuffs.atk) + Math.max(this.buffs.spd,this.combatBuffs.spd) + Math.max(this.buffs.def,this.combatBuffs.def) + Math.max(this.buffs.res,this.combatBuffs.res);
		}
		//Dominance calculation.  Counts as true damage.  Includes Panic.
		var domiDmg = 0;
		if(this.bonus.dominance){
			domiDmg -= Math.min(enemy.debuffs.atk,enemy.combatDebuffs.atk) + Math.min(enemy.debuffs.spd,enemy.combatDebuffs.spd) + Math.min(enemy.debuffs.def,enemy.combatDebuffs.def) + Math.min(enemy.debuffs.res,enemy.combatDebuffs.res);
			if(enemy.penalty.panic){
				domiDmg += Math.max(enemy.buffs.atk,enemy.combatBuffs.atk) + Math.max(enemy.buffs.spd,enemy.combatBuffs.spd) + Math.max(enemy.buffs.def,enemy.combatBuffs.def) + Math.max(enemy.buffs.res,enemy.combatBuffs.res);
			}
		}

		var offensiveSpecialActivated = false;
		var AOEActivated = false;
		
		var pcoCharge = 0;
		var peoCharge = 0;
		if(this.specialIndex != -1){
			this.charge = Math.min(this.charge,data.skills[this.specialIndex].charge);
		}
		if(enemy.specialIndex != -1){
			enemy.charge = Math.min(enemy.charge,data.skills[enemy.specialIndex].charge);
		}
		//Pre-first attack CD reduction.  Does not apply on AOE phase
		if(!AOE){
			if((((this.hasExactly("Sturdy War Sword") && this.toggle.weapon > 0) || (this.hasExactly("Chaos Ragnell") && this.rValue == 5)) && this.combatStartHp / this.maxHp >= 0.25) && this.specialIndex != -1 && data.defensiveSpecials.indexOf(data.skills[this.specialIndex].name) == -1 && data.gaeSpecials.indexOf(data.skills[this.specialIndex].name) == -1 && firstHit){
				var pCharge = Math.floor(data.skills[this.specialIndex].charge / 2);
				pcoCharge += pCharge;
				damageText += this.name + " reduces CD by " + pCharge + " before first attack from " + data.skills[this.weaponIndex].name + ". ";
			}
			else if((this.hasExactly("Playful Pinwheel") && this.combatStartHp / this.maxHp >= 0.25) && this.specialIndex != -1 && data.defensiveSpecials.indexOf(data.skills[this.specialIndex].name) == -1 && data.gaeSpecials.indexOf(data.skills[this.specialIndex].name) == -1 && brave != 6 && brave != 7){
				var pCharge = 0;
				if(firstHit){
					pCharge = Math.min(data.skills[this.specialIndex].charge - this.charge,Object.values(this.bonus).reduce((a, item) => a + (item === true ? 1 : 0), 0) + this.bonus.extra);
				}
				else{
					pCharge = Object.values(this.bonus).reduce((a, item) => a + (item === true ? 1 : 0), 0) + this.bonus.extra - this.combatStartCD;
					pCharge = Math.max(pCharge,0);
				}
				pcoCharge += pCharge;
				damageText += this.name + " reduces CD by " + pCharge + " before attack from " + data.skills[this.weaponIndex].name + ". ";
			}
			else if(((this.hasExactly("Remote Breath") && this.buddy.adjacent + this.buddy.two + this.buddy.three > 0) || (this.hasExactly("Void Tome") && this.rValue == 5 && enemy.specialIndex != -1 && enemy.initSkillCharge() >= 1) || (this.hasExactly("Fair-Fight Blade") && this.combatStartHp / this.maxHp >= 0.25 && this.initiator) || (this.hasExactly("Airborne Spear") && this.rValue == 5 && this.combatStartHp / this.maxHp >= 0.25 && thisEffSpd + thisEffRes >= enemyEffSpd + enemyEffRes) || (this.hasExactly("Lightburst Tome") && this.combatStartHp / this.maxHp >= 0.25) || (this.hasExactly("Hades O") && this.rValue == 5 && (this.initiator || enemy.range == "ranged"))) && this.specialIndex != -1 && data.defensiveSpecials.indexOf(data.skills[this.specialIndex].name) == -1 && data.gaeSpecials.indexOf(data.skills[this.specialIndex].name) == -1 && firstHit){
				var pcVal = 1;
				if(this.hasExactly("Airborne Spear")){
					pcVal++;
				}
				pcoCharge += pcVal;
				damageText += this.name + " reduces CD by " + pcVal + " before first attack from " + data.skills[this.weaponIndex].name + ". ";
			}
			else if((this.hasExactly("Black Yule Lance") || this.hasExactly("Blue Yule Axe") || this.has("Golden Yule Bow")) && this.specialIndex != -1 && this.combatStartHp / this.maxHp >= 0.25 && firstHit){
				var pCharge = this.toggle.weapon;
				pcoCharge += pCharge;
				damageText += this.name + " reduces CD by " + pCharge + " before first attack from " + data.skills[this.weaponIndex].name + ". ";
			}
			else if(this.hasExactly("Tender Excalibur") && this.combatStartHp / this.maxHp >= 0.25 && this.specialIndex != -1 && data.defensiveSpecials.indexOf(data.skills[this.specialIndex].name) == -1 && data.gaeSpecials.indexOf(data.skills[this.specialIndex].name) == -1 && brave < 6){
				pcoCharge++;
				damageText += this.name + " reduces CD by 1 before attack from " + data.skills[this.weaponIndex].name + ". ";
			}
			else if(this.hasExactly("Ereshkigal") && this.combatStartHp / this.maxHp >= 0.25 && this.specialIndex != -1 && data.defensiveSpecials.indexOf(data.skills[this.specialIndex].name) == -1 && data.gaeSpecials.indexOf(data.skills[this.specialIndex].name) == -1 && firstHit){
				var pcVal = Math.min(Object.values(this.bonus).reduce((a, item) => a + (item === true ? 1 : 0), 0) + this.bonus.extra, 3);
				pcoCharge += pcVal;
				damageText += this.name + " reduces CD by " + pcVal + " before attack from " + data.skills[this.weaponIndex].name + ". ";
			}
			else if(this.hasExactly("Love of Nerthuz") && this.combatStartHp / this.maxHp >= 0.25 && this.specialIndex != -1 && data.defensiveSpecials.indexOf(data.skills[this.specialIndex].name) == -1 && data.gaeSpecials.indexOf(data.skills[this.specialIndex].name) == -1 && data.skills[this.specialIndex].charge - this.initSkillCharge() >= 3 && firstHit){
				pcoCharge++;
				damageText += this.name + " reduces CD by 1 before attack from " + data.skills[this.weaponIndex].name + ". ";
			}
			else if((this.hasExactly("Caring Magic") || this.hasExactly("Divine Yewfelle")) && (this.initiator || this.buddy.adjacent > 0 || this.buddy.two > 0) && this.specialIndex != -1 && !firstHit && brave < 6 && potent == 0){
				if(this.hasExactly("Divine Yewfelle")){
					pcoCharge += 2;
					damageText += this.name + " reduces CD by 2 before attack from " + data.skills[this.weaponIndex].name + ". ";
				}
				else{
					pcoCharge++;
					damageText += this.name + " reduces CD by 1 before attack from " + data.skills[this.weaponIndex].name + ". ";
				}
			}
			else if(this.hasExactly("Breaker Bow") && this.combatStartHp / this.maxHp >= 0.25 && this.specialIndex != -1 && data.defensiveSpecials.indexOf(data.skills[this.specialIndex].name) == -1 && data.gaeSpecials.indexOf(data.skills[this.specialIndex].name) == -1 && brave != 6 && brave != 7){
				var pCharge = 0;
				if(firstHit){
					pCharge = Math.min(data.skills[this.specialIndex].charge - this.charge, this.toggle.weapon + 1);
				}
				else{
					pCharge = this.toggle.weapon + 1 - this.combatStartCD;
					pCharge = Math.max(pCharge,0);
				}
				pcoCharge += pCharge;
				damageText += this.name + " reduces CD by " + pCharge + " before attack from " + data.skills[this.weaponIndex].name + ". ";
			}
			else if((this.hasExactly("Tiger-Roar Axe") || this.hasExactly("Horn of Opening")) && this.rValue == 5 && (!this.initiator || enemy.combatStartHp / enemy.maxHp >= 0.75) && this.specialIndex != -1 && firstHit){
				pcoCharge++;
				damageText += this.name + " reduces CD by 1 before attack from " + data.skills[this.weaponIndex].name + ". ";
			}
			else if(this.hasExactly("Fluttering Fan") && this.buddy.rorc > 0 && this.specialIndex != -1 && data.defensiveSpecials.indexOf(data.skills[this.specialIndex].name) == -1 && data.gaeSpecials.indexOf(data.skills[this.specialIndex].name) == -1 && brave != 6 && brave != 7){
				pcoCharge++;
				damageText += this.name + " reduces CD by 1 before attack from " + data.skills[this.weaponIndex].name + ". ";
			}
			else if(this.hasExactly("Gate-Anchor Axe") && this.rValue > 0 && (this.initiator || this.buddy.adjacent < 2) && this.buddy.spaces > 0 && firstHit){
				var pCharge = Math.min(this.buddy.spaces, 3);
				pcoCharge += pCharge;
				damageText += this.name + " reduces CD by " + pCharge + " before attack from " + data.skills[this.weaponIndex].name + ". ";
			}
			else if((((this.hasExactly("Arcane Blutgang") || this.hasExactly("Arcane Sly Knife") || this.hasExactly("Arcane Medusa") || (this.hasExactly("Luin") && this.rValue == 5)) && this.combatStartHp / this.maxHp >= 0.25) || ((this.hasExactly("Arcane Giant Axe") || this.hasExactly("Arcane Fell Arts")) && (!this.initiator || this.combatStartHp / this.maxHp >= 0.25))) && this.specialIndex != -1 && firstHit){
				pcoCharge++;
				damageText += this.name + " reduces CD by 1 before attack from " + data.skills[this.weaponIndex].name + ". ";
			}
			else if((this.hasExactly("Just Bow") || this.hasExactly("Bold Kusarigama")) && this.initiator && this.specialIndex != -1 && firstHit){
				pcoCharge++;
				damageText += this.name + " reduces CD by 1 before attack from " + data.skills[this.weaponIndex].name + ". ";
			}
			else if(((((this.hasExactly("Survivalist Bow") && this.rValue > 0) || this.hasExactly("Eagle's Heart")) && (this.initiator || this.buddy.adjacent < 2)) || (((this.hasExactly("Indignant Bow") && this.rValue == 5) || this.hasExactly("Staff of Yngvi") || this.hasExactly("Sword of Peace")) && this.buddy.adjacent + this.buddy.two + this.buddy.three > 0)) && this.specialIndex != -1 && firstHit){
				pcoCharge++;
				damageText += this.name + " reduces CD by 1 before attack from " + data.skills[this.weaponIndex].name + ". ";
			}
			else if(this.hasExactly("Arcane Truthfire") && this.combatStartHp / this.maxHp >= 0.25 && this.specialIndex != -1 && data.defensiveSpecials.indexOf(data.skills[this.specialIndex].name) == -1 && data.gaeSpecials.indexOf(data.skills[this.specialIndex].name) == -1 && data.AOESpecials.indexOf(data.skills[this.specialIndex].name) == -1 && data.AOEMultiSpecials.indexOf(data.skills[this.specialIndex].name) == -1 && firstHit){
				pcoCharge++;
				damageText += this.name + " reduces CD by 1 before attack from " + data.skills[this.weaponIndex].name + ". ";
			}
			else if(((this.hasExactly("New Year Talon") && (this.transform == true || enemy.combatStartHp / enemy.maxHp >= 0.75)) || (this.hasExactly("Blessed Aureola") && this.buddy.rorc > 0)) && this.specialIndex != -1 && firstHit){
				pcoCharge++;
				damageText += this.name + " reduces CD by 1 before first attack from " + data.skills[this.weaponIndex].name + ". ";
			}
			else if(this.hasExactly("Grafcalibur") && this.rValue == 5 && this.combatStartHp / this.maxHp >= 0.25 && this.specialIndex != -1 && !firstHit && brave < 6 && potent == 0){
				pcoCharge += 2;
				damageText += this.name + " reduces CD by 2 before attack from " + data.skills[this.weaponIndex].name + ". ";
			}
			else if(this.hasExactly("Hidden Blade") && this.combatStartHp / this.maxHp >= 0.25 && this.specialIndex != -1 && brave != 6 && brave != 7){
				pcoCharge++;
				damageText += this.name + " reduces CD by 1 before attack from " + data.skills[this.weaponIndex].name + ". ";
			}
			
			if((this.hasExactly("Ruler of Nihility") && (enemy.combatStartHp / enemy.maxHp >= 0.75 || enemy.penalty.extra > 0 || Object.values(enemy.penalty).reduce((a, item) => a + (item === true ? 1 : 0), 0) > 0 || enemy.debuffs.atk < 0 || enemy.debuffs.spd < 0 || enemy.debuffs.def < 0 || enemy.debuffs.res < 0 || enemy.combatDebuffs.atk < 0 || enemy.combatDebuffs.spd < 0 || enemy.combatDebuffs.def < 0 || enemy.combatDebuffs.res < 0)) && this.specialIndex != -1 && data.defensiveSpecials.indexOf(data.skills[this.specialIndex].name) == -1 && data.gaeSpecials.indexOf(data.skills[this.specialIndex].name) == -1 && firstHit){
				pcoCharge++;
				damageText += this.name + " reduces CD by 1 before first attack from " + data.skills[this.bIndex].name + ". ";
			}
			else if(this.hasExactly("Moonlit Bangle Q") && this.specialIndex != -1 && brave != 6 && brave != 7){
				pcoCharge++;
				damageText += this.name + " reduces CD by 1 before first attack from " + data.skills[this.bIndex].name + ". ";
			}
			else if(this.hasExactly("Momentum 4") && this.initiator && this.buddy.spaces > 0 && this.specialIndex != -1 && data.defensiveSpecials.indexOf(data.skills[this.specialIndex].name) == -1 && data.gaeSpecials.indexOf(data.skills[this.specialIndex].name) == -1 && data.AOESpecials.indexOf(data.skills[this.specialIndex].name) == -1 && data.AOEMultiSpecials.indexOf(data.skills[this.specialIndex].name) == -1 && firstHit){
				var pCharge = 1;
				if(this.buddy.spaces > 2){
					pCharge++;
				}
				pcoCharge += pCharge;
				damageText += this.name + " reduces CD by " + pCharge + " before first attack from " + data.skills[this.bIndex].name + ". ";
			}
			else if(this.hasExactly("Heavenly Wings") && this.combatStartHp / this.maxHp >= 0.25 && this.specialIndex != -1 && firstHit){
				pcoCharge++;
				damageText += this.name + " reduces CD by 1 before first attack from " + data.skills[this.bIndex].name + ". ";
			}
			else if(this.hasExactly("Chivalry 2") && this.specialIndex != -1 && firstHit){
				var pCharge = this.buddy.spaces;
				if(pCharge > 3 || enemy.combatStartHp / enemy.maxHp >= 0.75){
					pCharge = 3;
				}
				pcoCharge += pCharge;
				damageText += this.name + " reduces CD by " + pCharge + " before first attack from " + data.skills[this.bIndex].name + ". ";
			}
			else if(this.hasExactly("Pure Atrocity") && (this.initiator || this.buddy.adjacent > 0 || this.buddy.two > 0) && this.specialIndex != -1 && firstHit){
				pcoCharge++;
				damageText += this.name + " reduces CD by 1 before first attack from " + data.skills[this.bIndex].name + ". ";
			}
			
			if(this.hasExactly("Creation Pulse") && enemy.checkBonPen(3,this,turn) && this.specialIndex != -1 && data.defensiveSpecials.indexOf(data.skills[this.specialIndex].name) == -1 && data.gaeSpecials.indexOf(data.skills[this.specialIndex].name) == -1 && firstHit){
				var pCharge = Math.min(Object.values(enemy.penalty).reduce((a, item) => a + (item === true ? 1 : 0), 0) + enemy.penalty.extra, 2);
				pcoCharge += pCharge;
				damageText += this.name + " reduces CD by " + pCharge + " before attack from " + data.skills[this.cIndex].name + ". ";
			}
			else if(((this.hasExactly("Goddess Bearer 2") && this.buddy.rorc > 0) || (this.hasExactly("Assault Rush") && this.initiator) || (this.hasExactly("Quiet Strength") && (this.initiator || this.buddy.adjacent > 0 || this.buddy.two > 0))) && this.specialIndex != -1 && firstHit){
				pcoCharge++;
				damageText += this.name + " reduces CD by 1 before first attack from " + data.skills[this.cIndex].name + ". ";
			}
			else if(this.hasExactly("Worldbreaker+") && this.specialIndex != -1 && firstHit){
				pcoCharge += 2;
				damageText += this.name + " reduces CD by 2 before first attack from " + data.skills[this.cIndex].name + ". ";
			}
			else if(this.hasExactly("Nectar's Magic") && (this.initiator || this.buddy.adjacent > 0 || this.buddy.two > 0) && this.specialIndex != -1 && data.defensiveSpecials.indexOf(data.skills[this.specialIndex].name) == -1 && data.gaeSpecials.indexOf(data.skills[this.specialIndex].name) == -1 && data.AOESpecials.indexOf(data.skills[this.specialIndex].name) == -1 && data.AOEMultiSpecials.indexOf(data.skills[this.specialIndex].name) == -1 && firstHit){
				pcoCharge++;
				damageText += this.name + " reduces CD by 1 before first attack from " + data.skills[this.cIndex].name + ". ";
			}
			else if(this.hasExactly("Holy Ground+") && this.buddy.adjacent + this.buddy.two + this.buddy.three > 0 && this.specialIndex != -1 && firstHit){
				pcoCharge++;
				damageText += this.name + " reduces CD by 1 before first attack from " + data.skills[this.cIndex].name + ". ";
			}
			else if(this.hasExactly("Pulse On Blades") && this.specialIndex != -1 && data.defensiveSpecials.indexOf(data.skills[this.specialIndex].name) == -1 && data.gaeSpecials.indexOf(data.skills[this.specialIndex].name) == -1&& !firstHit && brave < 6 && potent == 0){
				pcoCharge += 2;
				damageText += this.name + " reduces CD by 2 before attack from " + data.skills[this.cIndex].name + ". ";
			}
			else if(this.hasExactly("Preempt Screech") && this.specialIndex != -1 && firstHit){
				pcoCharge++;
				damageText += this.name + " reduces CD by 1 before first attack from " + data.skills[this.cIndex].name + ". ";
			}
			
			if(this.hasExactly("Seidr Burst") && turn < 5 && (firstHit || (brave != 6 && ((thisFollowUp && potent == 0 && brave != 7) || (!thisFollowUp && potent > 0))))){
				pcoCharge += 2;
				damageText += this.name + " reduces CD by 2 before attack from " + data.skills[this.specialIndex].name + ". ";
			}
			else if(this.hasExactly("Crusader's Astra") && brave != 6){
				pcoCharge++;
				damageText += this.name + " reduces CD by 1 before attack from " + data.skills[this.specialIndex].name + ". ";
			}
			else if(this.hasExactly("Frost Moon") && firstHit && !thisFollowUp && brave == 0){
				pcoCharge++;
				damageText += this.name + " reduces CD by 1 before attack from " + data.skills[this.specialIndex].name + ". ";
			}
			else if(this.hasExactly("Haze Slice") && this.initiator && firstHit){
				pcoCharge++;
				damageText += this.name + " reduces CD by 1 before attack from " + data.skills[this.specialIndex].name + ". ";
			}
			
			if(this.bonus.spectrum && this.specialIndex != -1 && data.defensiveSpecials.indexOf(data.skills[this.specialIndex].name) == -1 && data.gaeSpecials.indexOf(data.skills[this.specialIndex].name) == -1 && firstHit){
				var specVal = 2;
				if(this.initSkillCharge() >= 1 || brave > 0){
					specVal--;
				}
				pcoCharge += specVal;
				damageText += this.name + " reduces CD by " + specVal + " before first attack from [Rally Spectrum]. ";
			}
			if(this.bonus.preempt && this.specialIndex != -1 && firstHit){
				pcoCharge++;
				damageText += this.name + " reduces CD by 1 before first attack from [Preempt Pulse]. ";
			}
			if(this.support.cnlove > 0 && this.specialIndex != -1 && firstHit){
				pcoCharge += this.support.cnlove;
				damageText += this.name + " reduces CD by " + this.support.cnlove + " before first attack from CD +1 1st Atk Support. ";
			}
			if(this.support.baura > 0 && this.specialIndex != -1 && firstHit && !thisFollowUp && brave == 0){
				pcoCharge += this.support.baura;
				damageText += this.name + " reduces CD by " + this.support.baura + " before first attack from CD +1 1st + 1hit Support. ";
			}
			if(this.support.flutter > 0 && this.specialIndex != -1 && data.defensiveSpecials.indexOf(data.skills[this.specialIndex].name) == -1 && data.gaeSpecials.indexOf(data.skills[this.specialIndex].name) == -1 && firstHit){
				pcoCharge += this.support.flutter;
				damageText += this.name + " reduces CD by " + this.support.flutter + " before first attack from Flutter Support. ";
			}
			if(((enemy.hasExactly("Caladbolg") && enemy.combatStartHp / enemy.maxHp >= 0.25) || (enemy.hasExactly("Fell Slaystone") && (this.initiator || this.combatStartHp / this.maxHp >= 0.75))) && enemy.specialIndex != -1 && firstHit){
				peoCharge++;
				damageText += enemy.name + " reduces CD by 1 before first attack from " + data.skills[enemy.weaponIndex].name + ". ";
			}
			else if(((enemy.hasExactly("Mercenary Lance") && enemy.rValue == 5 && this.initiator) || enemy.hasExactly("Quieting Branch")) && enemy.combatStartHp / enemy.maxHp >= 0.25 && enemy.specialIndex != -1 && firstHit){
				peoCharge += 2;
				damageText += enemy.name + " reduces CD by 2 before first attack from " + data.skills[enemy.weaponIndex].name + ". ";
			}
			else if(enemy.hasExactly("Swirling Scimitar") && enemy.buddy.adjacent + enemy.buddy.two + enemy.buddy.three > 0 && enemy.specialIndex != -1 && firstHit){
				peoCharge += 2;
				damageText += enemy.name + " reduces CD by 2 before first attack from " + data.skills[enemy.weaponIndex].name + ". ";
			}
			if(enemy.hasExactly("Oath of Ostia") && (this.initiator || this.combatStartHp / this.maxHp >= 0.75) && enemy.specialIndex != -1 && firstHit){
				peoCharge += 2;
				damageText += enemy.name + " reduces CD by 2 before first attack from " + data.skills[enemy.aIndex].name + ". ";
			}
			if((enemy.has("Laguz Friend") || enemy.hasExactly("Laguz Loyalty")) && enemy.specialIndex != -1 && data.gaeSpecials.indexOf(data.skills[enemy.specialIndex].name) == -1 && (data.defensiveSpecials.indexOf(data.skills[enemy.specialIndex].name) != -1 || data.skills[enemy.specialIndex].charge - enemy.initSkillCharge() >= 3) && firstHit){
				peoCharge += 2;
				damageText += enemy.name + " reduces CD by 2 before first attack from " + data.skills[enemy.bIndex].name + ". ";
			}
			else if(enemy.hasExactly("Shield Fighter") && enemy.specialIndex != -1 && data.defensiveSpecials.indexOf(data.skills[enemy.specialIndex].name) != -1 && (firstHit || (!firstHit && ((thisFollowUp && potent == 0 && brave != 7) || (!thisFollowUp && potent > 0))) || brave == 6)){
				peoCharge += 1;
				damageText += enemy.name + " reduces CD by 1 before first attack from " + data.skills[enemy.bIndex].name + ". ";
			}
			else if(enemy.hasExactly("Dragon's Scales") && (this.initiator || enemy.combatStartHp / enemy.maxHp >= 0.25) && enemy.specialIndex != -1 && firstHit){
				peoCharge += 1;
				damageText += enemy.name + " reduces CD by 1 before first attack from " + data.skills[enemy.bIndex].name + ". ";
			}
			if(enemy.hasExactly("Love for All!") && enemy.buddy.adjacent + enemy.buddy.two + enemy.buddy.three > 0 && enemy.specialIndex != -1 && firstHit){
				var laVal = Math.min(enemy.buddy.adjacent + enemy.buddy.two + enemy.buddy.three, 3);
				peoCharge += laVal;
				damageText += enemy.name + " reduces CD by " + laVal + " before first attack from " + data.skills[enemy.cIndex].name + ". ";
			}
			if(enemy.bonus.divinely > 0 && enemy.specialIndex != -1 && firstHit){
				peoCharge += enemy.bonus.divinely;
				damageText += enemy.name + " reduces CD by " + enemy.bonus.divinely + " before first attack from [Divinely Inspiring]. ";
			}
			if(enemy.support.hg > 0 && enemy.specialIndex != -1 && firstHit){
				peoCharge += enemy.support.hg;
				damageText += enemy.name + " reduces CD by " + enemy.support.hg + " before first attack from ally support. ";
			}
			if(this.penalty.hush && this.initSkillCharge() > 0 && enemy.specialIndex != -1 && data.defensiveSpecials.indexOf(data.skills[enemy.specialIndex].name) == -1 && data.gaeSpecials.indexOf(data.skills[enemy.specialIndex].name) == -1 && firstHit){
				peoCharge++;
				damageText += enemy.name + " reduces CD by 1 before first attack from enemy's [Hush Spectrum]. ";
			}
			
			//Pre-first attack CD increase to enemy.  Does not apply on AOE phase
			if((((((enemy.hasExactly("Remote Breath") || enemy.hasExactly("Awoken Breath") || enemy.hasExactly("Stone of Delights") || ((enemy.hasExactly("Dazzling Breath") || enemy.hasExactly("Joker's Wild")) && enemy.rValue == 5)) && enemy.buddy.adjacent + enemy.buddy.two + enemy.buddy.three > 0) || ((enemy.hasExactly("Ghostly Lanterns") || enemy.hasExactly("Twin Divinestone") || enemy.hasExactly("Holy Yule Blade") || enemy.hasExactly("Arcadian Axes") || enemy.hasExactly("Divine One's Arts") || enemy.hasExactly("Hoshido's Breath") || (enemy.hasExactly("Moonless Breath") && enemy.rValue == 5) || enemy.hasExactly("Ancient Betrayal")) && enemy.combatStartHp / enemy.maxHp >= 0.25)) && enemyEffRes + enemy.getPhantom("Res") >= thisEffRes + this.getPhantom("Res") + 5) || (enemy.hasExactly("Dawnsweet Box") && enemy.combatStartHp / enemy.maxHp >= 0.25 && this.color=="red" && enemy.getPhantom("Spd") + enemyEffSpd >= this.getPhantom("Spd") + thisEffSpd + 4) || (enemy.hasExactly("Sun's Percussors") && enemy.rValue == 5 && !this.initiator) || (enemy.hasExactly("Just Bow") && !this.initiator)) && this.specialIndex != -1 && data.defensiveSpecials.indexOf(data.skills[this.specialIndex].name) == -1 && data.gaeSpecials.indexOf(data.skills[this.specialIndex].name) == -1 && firstHit){
				if(enemy.hasExactly("Holy Yule Blade")){
					pcoCharge -= enemy.toggle.weapon;
					damageText += enemy.name + " inflicts CD +" + enemy.toggle.weapon + " to " + this.name + " before first attack from " + data.skills[enemy.weaponIndex].name + ". ";
				}
				else{
					pcoCharge--;
					damageText += enemy.name + " inflicts CD +1 to " + this.name + " before first attack from " + data.skills[enemy.weaponIndex].name + ". ";
					if(enemy.hasExactly("Twin Divinestone")){
						peoCharge++;
						damageText += enemy.name + " reduces CD by 1 before first attack from " + data.skills[enemy.weaponIndex].name + ". ";
					}
				}
			}
			else if(enemy.hasExactly("Duskstone") && enemy.combatStartHp / enemy.maxHp >= 0.25 && enemyEffRes + enemy.getPhantom("Res") >= thisEffRes + this.getPhantom("Res") + 5 && this.specialIndex != -1 && data.defensiveSpecials.indexOf(data.skills[this.specialIndex].name) == -1 && data.gaeSpecials.indexOf(data.skills[this.specialIndex].name) == -1 && (firstHit || brave == 6)){
				pcoCharge--;
				damageText += enemy.name + " inflicts CD +1 to " + this.name + " before first attack from " + data.skills[enemy.weaponIndex].name + ". ";
			}
			if(enemy.hasSlot("Scowl","a") && (this.initiator || this.combatStartHp / this.maxHp >= 0.75) && this.specialIndex != -1 && data.defensiveSpecials.indexOf(data.skills[this.specialIndex].name) == -1 && data.gaeSpecials.indexOf(data.skills[this.specialIndex].name) == -1 && firstHit){
				//Change how this works if it's not all Res Check
				var sCoeff = 18 - (enemy.hasSlot("Scowl","a") * 3);
				if(enemy.hasSlot("Scowl","a") == 4){
					sCoeff--;
				}
				if(enemyEffRes + enemy.getPhantom("Res") >= thisEffRes + this.getPhantom("Res") + sCoeff){
					pcoCharge--;
					damageText += enemy.name + " inflicts CD +1 to " + this.name + " before first attack from " + data.skills[enemy.aIndex].name + ". ";
				}
			}
			else if(enemy.hasExactly("Protective") && enemy.combatStartHp / enemy.maxHp >= 0.25 && (this.emblem != "none" || enemyEffRes + enemy.getPhantom("Res") >= thisEffRes + this.getPhantom("Res") + 5) && this.specialIndex != -1 && data.defensiveSpecials.indexOf(data.skills[this.specialIndex].name) == -1 && data.gaeSpecials.indexOf(data.skills[this.specialIndex].name) == -1 && firstHit){
				pcoCharge--;
				damageText += enemy.name + " inflicts CD +1 to " + this.name + " before first attack from " + data.skills[enemy.aIndex].name + ". ";
			}
			
			if(((enemy.hasExactly("Flow Guard 4") && !this.initiator) || (enemy.hasExactly("Pure Starfall") && (!this.initiator || enemy.bonus.dStar == true))) && this.specialIndex != -1 && data.defensiveSpecials.indexOf(data.skills[this.specialIndex].name) == -1 && data.gaeSpecials.indexOf(data.skills[this.specialIndex].name) == -1 && firstHit){
				pcoCharge--;
				damageText += enemy.name + " inflicts CD +1 to " + this.name + " before first attack from " + data.skills[enemy.bIndex].name + ". ";
			}
			else if(enemy.hasExactly("Pure Dragon Wall") && enemyEffRes + enemy.getPhantom("Res") >= thisEffRes + this.getPhantom("Res") + 5 && this.specialIndex != -1 && data.defensiveSpecials.indexOf(data.skills[this.specialIndex].name) == -1 && data.gaeSpecials.indexOf(data.skills[this.specialIndex].name) == -1 && firstHit){
				pcoCharge--;
				peoCharge++;
				damageText += enemy.name + " inflicts CD +1 to " + this.name + " and reduces CD by 1 before first attack from " + data.skills[enemy.weaponIndex].name + ". ";
			}
			if(enemy.hasExactly("Fell Protection") && (!this.initiator || enemy.buddy.adjacent > 0 || enemy.buddy.two > 0) && enemyEffRes + enemy.getPhantom("Res") >= thisEffRes + this.getPhantom("Res") + 5 && this.specialIndex != -1 && data.defensiveSpecials.indexOf(data.skills[this.specialIndex].name) == -1 && data.gaeSpecials.indexOf(data.skills[this.specialIndex].name) == -1 && firstHit){
				pcoCharge--;
				damageText += enemy.name + " inflicts CD +1 to " + this.name + " before first attack from " + data.skills[enemy.cIndex].name + ". ";
			}
			else if((enemy.hasExactly("Fell Successor") || enemy.hasExactly("Fell Majesty")) && (!this.initiator || enemy.buddy.adjacent > 0 || enemy.buddy.two > 0) && enemyEffRes + enemy.getPhantom("Res") >= thisEffRes + this.getPhantom("Res") + 5 && this.specialIndex != -1 && data.defensiveSpecials.indexOf(data.skills[this.specialIndex].name) == -1 && data.gaeSpecials.indexOf(data.skills[this.specialIndex].name) == -1){
				if(firstHit || (this.range == "ranged" && brave != 6 && ((thisFollowUp && potent == 0 && brave != 7) || (!thisFollowUp && potent > 0)))){
					pcoCharge--;
					damageText += enemy.name + " inflicts CD +1 to " + this.name + " before first attack from " + data.skills[enemy.cIndex].name + ". ";
				}
			}
			else if(enemy.hasExactly("Even Res Wave D") && enemyEffRes + enemy.getPhantom("Res") >= thisEffRes + this.getPhantom("Res") + 5 && this.specialIndex != -1 && data.defensiveSpecials.indexOf(data.skills[this.specialIndex].name) == -1 && data.gaeSpecials.indexOf(data.skills[this.specialIndex].name) == -1 && firstHit){
				pcoCharge--;
				damageText += enemy.name + " inflicts CD +1 to " + this.name + " before first attack from " + data.skills[enemy.cIndex].name + ". ";
			}
			else if(enemy.hasExactly("Pulse Smog") && !this.initiator && this.specialIndex != -1 && data.defensiveSpecials.indexOf(data.skills[this.specialIndex].name) == -1 && data.gaeSpecials.indexOf(data.skills[this.specialIndex].name) == -1 && firstHit){
				pcoCharge--;
				damageText += enemy.name + " inflicts CD +1 to " + this.name + " before first attack from " + data.skills[enemy.cIndex].name + ". ";
			}
			else if(enemy.hasExactly("Goddess Bearer 2") && enemy.buddy.rorc > 0 && this.specialIndex != -1 && firstHit){
				pcoCharge--;
				damageText += enemy.name + " inflicts CD +1 to " + this.name + " before first attack from " + data.skills[enemy.cIndex].name + ". ";
			}
			if(enemy.hasExactly("Res Scowl Echo") && (this.initiator || this.combatStartHp / this.maxHp >= 0.75) && enemyEffRes + enemy.getPhantom("Res") >= thisEffRes + this.getPhantom("Res") + 5 && this.specialIndex != -1 && data.defensiveSpecials.indexOf(data.skills[this.specialIndex].name) == -1 && data.gaeSpecials.indexOf(data.skills[this.specialIndex].name) == -1 && firstHit){
				pcoCharge--;
				damageText += enemy.name + " inflicts CD +1 to " + this.name + " before first attack from " + data.skills[enemy.xIndex].name + ". ";
			}
			if(enemy.bonus.fWitness && !this.initiator && this.specialIndex != -1 && data.defensiveSpecials.indexOf(data.skills[this.specialIndex].name) == -1 && data.gaeSpecials.indexOf(data.skills[this.specialIndex].name) == -1 && firstHit){
				pcoCharge--;
				damageText += enemy.name + " inflicts CD +1 to " + this.name + " before first attack from [Future Witness] Bonus. ";
			}
			if(enemy.support.fellProtect > 0 && this.specialIndex != -1 && data.defensiveSpecials.indexOf(data.skills[this.specialIndex].name) == -1 && data.gaeSpecials.indexOf(data.skills[this.specialIndex].name) == -1 && firstHit){
				pcoCharge -= enemy.support.fellProtect;
				damageText += enemy.name + " inflicts CD +" + enemy.support.fellProtect + " to " + this.name + " before first attack from ally's support. ";
			}
			if(enemy.support.fellSuccess > 0 && this.specialIndex != -1 && data.defensiveSpecials.indexOf(data.skills[this.specialIndex].name) == -1 && data.gaeSpecials.indexOf(data.skills[this.specialIndex].name) == -1){
				if(firstHit || (this.range == "ranged" && brave != 6 && ((thisFollowUp && potent == 0 && brave != 7) || (!thisFollowUp && potent > 0)))){
					pcoCharge -= enemy.support.fellSuccess;
					damageText += enemy.name + " inflicts CD +" + enemy.support.fellSuccess + " to " + this.name + " before first attack from Veyle(s) (Fell) being within 2 spaces. ";
				}
			}
			if(enemy.support.hini > 0 && !this.initiator && this.specialIndex != -1 && data.defensiveSpecials.indexOf(data.skills[this.specialIndex].name) == -1 && data.gaeSpecials.indexOf(data.skills[this.specialIndex].name) == -1 && firstHit){
				pcoCharge -= enemy.support.hini;
				damageText += enemy.name + " inflicts CD +" + enemy.support.hini + " to " + this.name + " before first attack from Hush on Initiate support. ";
			}
			if(this.penalty.hush && this.specialIndex != -1 && data.defensiveSpecials.indexOf(data.skills[this.specialIndex].name) == -1 && data.gaeSpecials.indexOf(data.skills[this.specialIndex].name) == -1 && firstHit){
				pcoCharge--;
				damageText += this.name + " is inflicted with CD +1 before first attack from [Hush Spectrum]. ";
			}
		}
		else if(AOE && this.initiator && this.specialIndex !=- 1 && (data.AOEMultiSpecials.indexOf(data.skills[this.specialIndex].name) != -1 || data.AOESpecials.indexOf(data.skills[this.specialIndex].name) != -1 || this.hasExactly("Gifted Magic"))){
			if(this.hasExactly("Arcane Truthfire") && this.hp / this.maxHp >= 0.25){
				pcoCharge++;
				damageText += this.name + " reduces CD by 1 before AOE attack from " + data.skills[this.weaponIndex].name + ". ";
			}
			if(this.hasExactly("Momentum 4") && this.buddy.spaces > 0){
				var pCharge = 1;
				if(this.buddy.spaces > 2){
					pCharge++;
				}
				pcoCharge += pCharge;
				damageText += this.name + " reduces CD by " + pCharge + " before AOE attack from " + data.skills[this.bIndex].name + ". ";
			}
			if(this.hasExactly("Nectar's Magic")){
				pcoCharge++;
				damageText += this.name + " reduces CD by 1 before AOE attack from " + data.skills[this.cIndex].name + ". ";
			}
		}
		this.charge += pcoCharge;
		enemy.charge += peoCharge;
		this.charge = Math.max(this.charge,this.initSkillCharge());
		enemy.charge = Math.max(enemy.charge,enemy.initSkillCharge());
		
		if(!parity && !(enemy.hasExactly("Sentinel Bow") && (!this.initiator || this.range == "ranged")) && !(enemy.hasExactly("Pure Storm") && enemy.toggle.b > 1 && !this.initiator) && this.specialIndex!=-1 && data.skills[this.specialIndex].charge <= this.charge){
			//Do AOE specials
			if(AOE){
				if(options.threatenRule=="Summ. Duels" && this.range == "ranged" && enemy.range == "melee"){
					relevantAOEDef += 7;
					damageText += enemy.name + " gets +7 def & res vs. AOE special from being a melee hero fighting a ranged enemy in Summoner Duels. ";
				}
				var AOEDamage = 0;
				//AOE specials only calcs with visible stats
				var AOEthisEffAtk = allStats[13];
				if(data.AOESpecials.indexOf(data.skills[this.specialIndex].name) != -1){
					AOEDamage = AOEthisEffAtk - relevantAOEDef - relevantAOETileDef;
					AOEActivated = true;
				}
				else if(data.AOEMultiSpecials.indexOf(data.skills[this.specialIndex].name) != -1){
					AOEDamage = Math.floor(1.5*(AOEthisEffAtk - relevantAOEDef - relevantAOETileDef));
					AOEActivated = true;
				}
				else if(this.hasExactly("Gifted Magic")){
					AOEDamage = Math.floor(0.8*(AOEthisEffAtk - relevantAOEDef - relevantAOETileDef));
					AOEActivated = true;
				}
				if(AOEActivated == true && !(this.style == 1 && this.tstyle == true)){
					if(this.has("Wo Dao") || this.hasExactly("Dark Excalibur") || this.hasExactly("Resolute Blade") || (this.hasExactly("Hauteclere") && this.rValue == 5) || this.has("Giant Spoon") || this.has("Lethal Carrot") || (this.hasExactly("Nameless Blade") && this.rValue == 5) || this.has("Harmonic Lance") || this.has("Wo Gun") || (this.hasExactly("Shanna's Lance") && this.rValue == 5) || this.has("Short Bow") || (this.hasExactly("Selena's Blade") && this.rValue == 5) || this.hasExactly("Concealed Blade")){
						AOEDamage += 10;
						damageText += this.name + " gains 10 damage from weapon. ";
					}
					//Vassal's Blade/Giga Excalibur/Raven King Beak/Red-Hot Ducks Mechanic
					if((this.hasExactly("Vassal's Blade") && this.rValue < 0) || (this.hasExactly("Giga Excalibur") && this.rValue < 0) || (this.hasExactly("Raven King Beak") && this.rValue < 0) || this.has("Red-Hot Ducks") || (this.hasExactly("Resolute Blade") && this.rValue == 5) || this.has("Guardian Fang") || (this.hasExactly("Refreshed Fang") && enemy.combatStartHp / enemy.maxHp >= 0.75)){
						var thisPhantomSpd = this.getPhantom("Spd") + allStats[17];
						var enemyPhantomSpd = enemy.getPhantom("Spd") + allStats[21];
						var spdDmg = 0;
						if(thisPhantomSpd > enemyPhantomSpd){
							spdDmg = ((thisPhantomSpd - enemyPhantomSpd) * 0.7 | 0);
							spdDmg = Math.min(spdDmg,7);
							AOEDamage += spdDmg;
							damageText += this.name + " gains " + spdDmg + " damage from weapon. ";
						}
					}
					//Light Brand/Shining Bow Mechanic
					else if((this.hasExactly("Light Brand") || this.has("Shining Bow") || this.hasExactly("Niles's Bow") || this.hasExactly("Spy-Song Bow")) && allStats[22] >= allStats[23] + 5){
						AOEDamage += 7;
						damageText += this.name + " gains 7 damage from weapon. ";
					}
					//Luna Arc
					else if(this.hasExactly("Luna Arc") && this.initiator){
						var lunaDmg = Math.floor(allStats[22] * 0.25);
						AOEDamage += lunaDmg;
						damageText += this.name + " gains " + lunaDmg + " damage from Luna Arc. ";
					}
					//Astra Blade
					else if(this.hasExactly("Astra Blade") && allStats[16] > allStats[22]){
						var abDmg = Math.floor((allStats[16] - allStats[22]) * 0.5);
						AOEDamage += abDmg;
						damageText += this.name + " gains " + abDmg + " damage from Astra Blade. ";
					}
					//Golden Naginata - Refined
					else if(this.hasExactly("Golden Naginata") && this.rValue == 5 && this.hp / this.maxHp >= 0.7){
						AOEDamage += 7;
						damageText += this.name + " gains 7 damage from Golden Naginata. ";
					}
					else if(this.hasExactly("Saintly Seraphim") && (this.initiator || (this.rValue > 0 && this.toggle.weapon > 0))){
						var saintDmg = Math.floor(allStats[23] * 0.25);
						AOEDamage += saintDmg;
						damageText += this.name + " gains " + saintDmg + " damage from Saintly Seraphim. ";
					}
					//New Foxkit Fang
					else if(this.has("New Foxkit Fang") && allStats[19] + this.getPhantom("Res") > allStats[23] + enemy.getPhantom("Res")){
						var resDmg = ((allStats[19] + this.getPhantom("Res") - allStats[23] - enemy.getPhantom("Res")) * 0.7 | 0);
						resDmg = Math.min(resDmg,7);
						AOEDamage += resDmg;
						damageText += this.name + " gains " + resDmg + " damage from New Foxkit Fang. ";
					}
					//Candied Dagger
					else if(this.hasExactly("Candied Dagger")){
						if(this.initiator){
							var candyDmg = Math.floor(allStats[17] * 0.1);
							AOEDamage += candyDmg;
							damageText += this.name + " gains " + candyDmg + " damage from initiating with Candied Dagger. ";
						}
						//Refined
						if(this.rValue == 5 && enemy.hp / enemy.maxHp >= 1){
							AOEDamage += 7;
							damageText += this.name + " gains 7 damage from Candied Dagger. ";
						}
					}
					else if(this.hasExactly("Levin Dagger") && (enemy.checkBonPen(3,this,turn) || (this.rValue > 0 && this.checkBonPen(1,enemy,turn)))){
						var levinDmg = Math.floor(allStats[19] * 0.2);
						AOEDamage += levinDmg;
						damageText += this.name + " gains " + levinDmg + " damage from Levin Dagger. ";
					}
					else if(this.hasExactly("Resolved Fang") && enemy.combatStartHp / enemy.maxHp >= 0.75){
						if(this.rValue < 0){
							var defDmg = 0;
							if(allStats[18] > allStats[22]){
								defDmg = ((allStats[18] - allStats[22]) * 0.7 | 0);
								defDmg = Math.min(defDmg,7);
								AOEDamage += defDmg;
								damageText += this.name + " gains " + defDmg + " damage from Resolved Fang. ";
							}
						}
						else{
							var extraDmg = Math.floor(allStats[18] * 0.2);
							AOEDamage += extraDmg;
							damageText += this.name + " gains " + extraDmg + " damage from Resolved Fang. ";
						}
					}
					//Refined Giga Excalibur
					else if(this.hasExactly("Giga Excalibur") && this.rValue > 0){
						var spdDmg = Math.floor(allStats[17] * 0.2);
						AOEDamage += spdDmg;
						damageText += this.name + " gains " + spdDmg + " damage from Giga Excalibur. ";
					}
					//Luin and Rose-Quartz Bow
					else if(this.hasExactly("Luin") || this.hasExactly("Rose-Quartz Bow") || this.hasExactly("Celestial Globe") || this.hasExactly("Abyssal Blade") || this.hasExactly("The Cycle's Turn")){
						var spdDmg = Math.floor(allStats[17] * 0.2);
						if(this.hasExactly("Luin") && this.rValue > 0){
							spdDmg += Math.floor(allStats[17] * 0.2);
						}
						AOEDamage += spdDmg;
						damageText += this.name + " gains " + spdDmg + " damage from " + data.skills[this.weaponIndex].name + ". ";
					}
					//Shamshir
					else if(this.hasExactly("Shamshir")){
						AOEDamage += 7;
						damageText += this.name + " gains 7 damage from Shamshir. ";
					}
					//Blade of Renais
					else if(this.hasExactly("Blade of Renais") && (this.initiator || this.toggle.weapon > 1) && (this.toggle.weapon % 2 == 1 || checkAllBuffs(this, enemy, turn))){
						var renaisDmg = Math.floor(allStats[22] * 0.2);
						AOEDamage += renaisDmg;
						damageText += this.name + " gains " + renaisDmg + " damage from Blade of Renais. ";
					}
					//Refined Vassal's Blade
					else if(this.hasExactly("Vassal's Blade") && this.rValue > 0){
						var spdDmg = Math.floor(allStats[17] * 0.15);
						AOEDamage += spdDmg;
						damageText += this.name + " gains " + spdDmg + " damage from Vassal's Blade. ";
					}
					//Fair-Fury Axe
					else if(this.hasExactly("Fair-Fury Axe") && (this.initiator || this.toggle.weapon == 1)){
						var atkDmg = Math.floor(allStats[16] * 0.15);
						AOEDamage += atkDmg;
						damageText += this.name + " gains " + atkDmg + " damage from Fair-Fury Axe. ";
					}
					//Refined Dark Mystletainn
					else if(this.hasExactly("Dark Mystletainn") && this.rValue == 5 && enemy.hp / enemy.maxHp >= 0.75){
						AOEDamage += 7;
						damageText += this.name + " gains 7 damage from Dark Mystletainn. ";
					}
					//Refined Swift Mulagir
					else if(this.hasExactly("Swift Mulagir") && this.rValue == 5){
						var spdDmg = Math.floor(allStats[17] * 0.15);
						AOEDamage += spdDmg;
						damageText += this.name + " gains " + spdDmg + " damage from Swift Mulagir. ";
					}
					//Refined Missiletain
					else if(this.hasExactly("Missiletain") && this.rValue == 5 && this.toggle.weapon == 1){
						var repDmg = Math.min(30,this.maxHp-this.hp);
						AOEDamage += repDmg;
						damageText += this.name + " gains " + repDmg + " damage from Missiletain. ";
					}
					//Refined Sagittae
					else if(this.hasExactly("Sagittae") && this.rValue > 0 && allStats[16] < allStats[20]){
						var sagDmg = Math.floor(allStats[20] * 0.15);
						AOEDamage += sagDmg;
						damageText += this.name + " gains " + sagDmg + " damage from Sagittae. ";
					}
					//Refined Kaze's Needle
					else if(this.hasExactly("Kaze's Needle") && this.rValue == 5 && this.hp / this.maxHp >= 0.25 && this.getPhantom("Spd") + allStats[17] > enemy.getPhantom("Spd") + allStats[21]){
						AOEDamage += 5;
						damageText += this.name + " gains 5 damage from Kaze's Needle. ";
					}
					//Ninja Training Weapons
					else if((this.has("Ninja Yumi") || this.has("Ninja Naginata") || this.has("Shuriken Cleaver")) && this.initiator && this.getPhantom("Spd") + allStats[17] > enemy.getPhantom("Spd") + allStats[21]){
						var nDmg = Math.floor((this.getPhantom("Spd") + allStats[17] - enemy.getPhantom("Spd") - allStats[21]) * 0.5);
						nDmg = Math.min(4,nDmg);
						AOEDamage += nDmg;
						damageText += this.name + " gains " + nDmg + " damage from " + data.skills[this.weaponIndex].name + ". ";
					}
					else if(this.hasExactly("Ninjutsu Scrolls") && this.initiator && this.getPhantom("Spd") + allStats[17] > enemy.getPhantom("Spd") + allStats[21]){
						var nDmg = Math.floor((this.getPhantom("Spd") + allStats[17] - enemy.getPhantom("Spd") - allStats[21]) * 0.7);
						nDmg = Math.min(7,nDmg);
						AOEDamage += nDmg;
						damageText += this.name + " gains " + nDmg + " damage from " + data.skills[this.weaponIndex].name + ". ";
					}
					//Inviolable Axe
					else if(this.hasExactly("Inviolable Axe") && (this.initiator || this.toggle.weapon == 1)){
						AOEDamage += 7;
						damageText += this.name + " gains 7 damage from Inviolable Axe. ";
					}
					//Sparkling Fang
					else if(this.hasExactly("Sparkling Fang") && enemy.hp / enemy.maxHp >= 0.75 && this.getPhantom("Spd") + allStats[17] > enemy.getPhantom("Spd") + allStats[21]){
						AOEDamage += 5;
						damageText += this.name + " gains 5 damage from Sparkling Fang. ";
					}
					//Polished Fang
					else if(this.hasExactly("Polished Fang") && enemy.hp / enemy.maxHp >= 0.75 && allStats[18] > allStats[22]){
						AOEDamage += 5;
						damageText += this.name + " gains 5 damage from Polished Fang. ";
					}
					//Ancient Codex
					else if(this.hasExactly("Ancient Codex") && this.toggle.weapon == 1){
						rDmg = Math.max(allStats[19], allStats[23]);
						rDmg = Math.floor(rDmg * 0.2);
						AOEDamage += rDmg;
						damageText += this.name + " gains " + rDmg + " damage from " + data.skills[this.weaponIndex].name + ". ";
					}
					else if(((this.hasExactly("Blade of Jehanna") && this.toggle.weapon == 0) || this.hasExactly("Firelight Lance")) && this.hp / this.maxHp >= 0.25){
						var blaDmg = Math.floor(allStats[20] * 0.15);
						AOEDamage += blaDmg;
						damageText += this.name + " gains " + blaDmg + " damage from " + data.skills[this.weaponIndex].name + ". ";
					}
					else if(this.hasExactly("Summer's Breath") && this.rValue == 5 && this.toggle.weapon == 1 && this.specialIndex != -1){
						var extraDmg = data.skills[this.specialIndex].charge - this.initSkillCharge();
						extraDmg = Math.floor(allStats[23] * (extraDmg * 0.1 + 0.2));
						AOEDamage += extraDmg;
						damageText += this.name + " gains " + extraDmg + " damage from Summer's Breath. ";
					}
					else if((((this.hasExactly("Dryblade Lance") || this.hasExactly("Heired Forseti")) && this.hp / this.maxHp >= 0.25) || (this.hasExactly("Sisterly War Axe"))) && this.specialIndex != -1){
						var extraDmg = data.skills[this.specialIndex].charge - this.initSkillCharge();
						extraDmg = Math.floor(allStats[17] * (extraDmg * 0.1 + 0.2));
						AOEDamage += extraDmg;
						damageText += this.name + " gains " + extraDmg + " damage from " + data.skills[this.weaponIndex].name + ". ";
					}
					else if(this.hasExactly("Book of Dreams") && this.rValue == 5 && this.hp / this.maxHp >= 0.25){
						var extraDmg = Math.floor(allStats[16] * 0.15);
						AOEDamage += extraDmg;
						damageText += this.name + " gains " + extraDmg + " damage from Book of Dreams. ";
					}
					else if(this.hasExactly("Hurricane Dagger") && this.rValue == 5 && this.hp / this.maxHp >= 0.25 && this.getPhantom("Spd") + allStats[17] > enemy.getPhantom("Spd") + allStats[21]){
						AOEDamage += 5;
						damageText += this.name + " gains 5 damage from Hurricane Dagger. ";
					}
					else if((this.hasExactly("Pastel Poleaxe") && this.hp / this.maxHp >= 0.25) || this.hasExactly("Illuminating Horn") || (this.hasExactly("Moon Gradivus") && this.rValue == 5 && this.toggle.weapon == 1) || this.hasExactly("Wyvern Ono") || (this.hasExactly("Horn of Harvest") && enemy.hp / enemy.maxHp >= 0.75)){
						var extraDmg = Math.floor(allStats[18] * 0.2);
						AOEDamage += extraDmg;
						damageText += this.name + " gains " + extraDmg + " damage from " + data.skills[this.weaponIndex].name + ". ";
					}
					else if(this.hasExactly("Azure Lance") && (this.initiator || this.toggle.weapon == 1 || this.toggle.weapon == 3)){
						AOEDamage += 7;
						damageText += this.name + " gains 7 damage from Azure Lance. ";
					}
					else if(this.hasExactly("Sylgr") && this.rValue > 0 && (allStats[17] + this.getPhantom("Spd") > allStats[21] + enemy.getPhantom("Spd") || enemy.hp / enemy.maxHp >= 0.75)){
						var spdDmg = Math.floor(allStats[17] * 0.15);
						AOEDamage += spdDmg;
						damageText += this.name + " gains " + spdDmg + " damage from Sylgr. ";
					}
					else if(this.hasExactly("True-Love Roses") && (this.initiator || this.toggle.weapon == 1)){
						var extraDmg = Math.floor(allStats[19] * 0.1);
						AOEDamage += extraDmg;
						damageText += this.name + " gains " + extraDmg + " damage from True-Love Roses. ";
					}
					else if(this.hasExactly("Raven King Beak") && this.rValue > 0 && (this.initiator || enemy.hp / enemy.maxHp >= 0.75)){
						var spdDmg = Math.floor(allStats[17] * 0.15);
						AOEDamage += spdDmg;
						damageText += this.name + " gains " + spdDmg + " damage from Raven King Beak. ";
					}
					else if(this.hasExactly("New-Height Bow") && this.toggle.weapon == 1){
						var spdDmg = Math.floor(allStats[17] * 0.15);
						AOEDamage += spdDmg;
						damageText += this.name + " gains " + spdDmg + " damage from New-Height Bow. ";
					}
					else if((this.hasExactly("Mila's Testament") || (this.hasExactly("Meisterbogen") && this.rValue == 5)) && (this.initiator || this.toggle.weapon == 1)){
						var eaDmg = Math.floor(allStats[20] * 0.1);
						AOEDamage += eaDmg;
						damageText += this.name + " gains " + eaDmg + " damage from " + data.skills[this.weaponIndex].name + ". ";
					}
					else if(this.hasExactly("Tri-Edge Lance")){
						var extraDmg = Math.floor(allStats[19] * 0.2);
						AOEDamage += extraDmg;
						damageText += this.name + " gains " + extraDmg + " damage from Tri-Edge Lance. ";
					}
					else if(this.hasExactly("Lofty Leaflet") && enemy.hp / enemy.maxHp >= 0.5){
						var spdDmg = Math.floor(allStats[17] * 0.15);
						AOEDamage += spdDmg;
						damageText += this.name + " gains " + spdDmg + " damage from Lofty Leaflet. ";
					}
					else if(this.has("Brazen Cat Fang") && this.rValue > 0){
						AOEDamage += 10;
						damageText += this.name + " gains 10 damage from Brazen Cat Fang. ";
					}
					else if(this.has("Bunny Fang") && this.rValue == 5 && enemy.hp / enemy.maxHp >= 0.5){
						var spdDmg = Math.floor(allStats[17] * 0.1);
						AOEDamage += spdDmg;
						damageText += this.name + " gains " + spdDmg + " damage from Bunny Fang. ";
					}
					else if((this.hasExactly("Arcane Grima") || this.hasExactly("Arcane Euphoria") || this.hasExactly("Arcane Blutgang") || this.hasExactly("Arcane Truthfire") || this.hasExactly("Arcane Giant Axe") || this.hasExactly("Arcane Sly Knife") || this.hasExactly("Arcane Fell Arts") || this.hasExactly("Arcane Medusa")) && this.hp / this.maxHp >= 0.25){
						var atkDmg = Math.floor(allStats[16] * 0.15);
						AOEDamage += atkDmg;
						damageText += this.name + " gains " + atkDmg + " damage from " + data.skills[this.weaponIndex].name + ". ";
					}
					else if(this.hasExactly("Rite of Souls") && (this.initiator || this.toggle.weapon > 1)){
						var extraDmg = Math.floor(allStats[19] * 0.2);
						AOEDamage += extraDmg;
						damageText += this.name + " gains " + extraDmg + " damage from Rite of Souls. ";
					}
					else if(this.hasExactly("Ardent Durandal") && this.rValue == 5 && (this.initiator || this.toggle.weapon == 1)){
						var extraDmg = Math.floor(allStats[22] * 0.15);
						AOEDamage += extraDmg;
						damageText += this.name + " gains " + extraDmg + " damage from Ardent Durandal. ";
					}
					else if(this.hasExactly("Snide Bow") && this.hp / this.maxHp >= 0.25){
						AOEDamage += 7;
						damageText += this.name + " gains 7 damage from Snide Bow. ";
					}
					else if(this.hasExactly("Seidr") && (this.initiator || this.toggle.weapon == 1)){
						var extraDmg = Math.floor(allStats[19] * 0.2);
						AOEDamage += extraDmg;
						damageText += this.name + " gains " + extraDmg + " damage from Seidr. ";
					}
					else if((this.hasExactly("Dreaming Spear") && this.toggle.weapon == 1) || (this.hasExactly("Radiant Aureola") && enemy.hp / enemy.maxHp >= 0.75) || ((this.hasExactly("New Year Treats") || this.hasExactly("Tome of Dusk") || this.hasExactly("Fundament")) && this.hp / this.maxHp >= 0.25)){
						var extraDmg = Math.floor(allStats[19] * 0.2);
						AOEDamage += extraDmg;
						damageText += this.name + " gains " + extraDmg + " damage from " + data.skills[this.weaponIndex].name + ". ";
					}
					else if((this.hasExactly("Noble Lance") || this.hasExactly("Victorious Axe")) && this.rValue == 5){
						var extraDmg = Math.floor(allStats[16] * 0.1);
						AOEDamage += extraDmg;
						damageText += this.name + " gains " + extraDmg + " damage from " + data.skills[this.weaponIndex].name + ". ";
					}
					else if(this.hasExactly("Imbued Koma") && this.rValue == 5 && this.toggle.weapon == 1){
						var extraDmg = Math.floor(allStats[18] * 0.15);
						AOEDamage += extraDmg;
						damageText += this.name + " gains " + extraDmg + " damage from Imbued Koma. ";
					}
					else if((this.hasExactly("Arcane Luin") || this.hasExactly("Fujin-Raijin Yumi") || this.hasExactly("Aptitude Arrows") || this.hasExactly("Dead-Crow Tome") || (this.hasExactly("Phantasm Tome") && this.rValue == 5) || this.hasExactly("Nidavellir Ballista")) && this.hp / this.maxHp >= 0.25){
						var spdDmg = Math.floor(allStats[17] * 0.2);
						AOEDamage += spdDmg;
						damageText += this.name + " gains " + spdDmg + " damage from " + data.skills[this.weaponIndex].name + ". ";
					}
					else if(this.hasExactly("Freeblade's Edge") && this.rValue == 5 && this.hp / this.maxHp >= 0.25){
						var extraDmg = Math.floor(allStats[18] * 0.15);
						AOEDamage += extraDmg;
						damageText += this.name + " gains " + extraDmg + " damage from Freeblade's Edge. ";
					}
					else if(this.hasExactly("Aymr") && this.rValue == 5 && (this.toggle.weapon == 1 || enemy.hp / enemy.maxHp >= 0.75)){
						var extraDmg = Math.floor(allStats[16] * 0.15);
						AOEDamage += extraDmg;
						damageText += this.name + " gains " + extraDmg + " damage from Aymr. ";
					}
					else if(this.hasExactly("Dead-Fang Axe") && this.hp / this.maxHp >= 0.25){
						var extraDmg = Math.floor(allStats[16] * 0.1);
						AOEDamage += extraDmg;
						damageText += this.name + " gains " + extraDmg + " damage from Dead-Fang Axe. ";
					}
					else if(this.hasExactly("Heartbroker Bow")){
						var extraDmg = Math.floor(allStats[17] * 0.15);
						AOEDamage += extraDmg;
						damageText += this.name + " gains " + extraDmg + " damage from Heartbroker Bow. ";
					}
					else if(((this.hasExactly("Guardian's Bow") && this.rValue == 5) || this.hasExactly("Violdrake Bow")) && this.hp / this.maxHp >= 0.25){
						var spdDmg = Math.floor(allStats[17] * 0.1);
						AOEDamage += spdDmg;
						damageText += this.name + " gains " + spdDmg + " damage from " + data.skills[this.weaponIndex].name + ". ";
					}
					else if(this.hasExactly("Ilian Merc Lance") && this.toggle.weapon > 1){
						var blaDmg = Math.floor(allStats[20] * 0.15);
						AOEDamage += blaDmg;
						damageText += this.name + " gains " + blaDmg + " damage from " + data.skills[this.weaponIndex].name + ". ";
					}
					else if(this.hasExactly("Father's-Son Axe") && this.rValue == 5){
						var extraDmg = Math.floor(this.hp * 0.15);
						AOEDamage += extraDmg;
						damageText += this.name + " gains " + extraDmg + " damage from Father's-Son Axe. ";
					}
					else if(this.hasExactly("Tome of Luxuries") && this.hp / this.maxHp >= 0.25){
						var extraDmg = Math.floor(allStats[19] * 0.15);
						AOEDamage += extraDmg;
						damageText += this.name + " gains " + extraDmg + " damage from " + data.skills[this.weaponIndex].name + ". ";
					}
					else if(this.hasExactly("Arcane Nihility") && this.hp / this.maxHp >= 0.25){
						var extraDmg = Math.floor(allStats[17] * 0.15);
						AOEDamage += extraDmg;
						damageText += this.name + " gains " + extraDmg + " damage from Arcane Nihility. ";
					}
					else if(this.hasExactly("Hel's Reaper") && this.rValue == 5 && (this.hp / this.maxHp >= 0.25 || this.toggle.weapon == 1)){
						var spdDmg = Math.floor(allStats[17] * 0.2);
						AOEDamage += spdDmg;
						damageText += this.name + " gains " + spdDmg + " damage from Hel's Reaper. ";
					}
					else if(this.hasExactly("Studied Forblaze") && this.rValue == 5){
						var extraDmg = Math.floor(allStats[19] * 0.15);
						AOEDamage += extraDmg;
						damageText += this.name + " gains " + extraDmg + " damage from " + data.skills[this.weaponIndex].name + ". ";
					}
					else if(this.hasExactly("Sandglass Bow")){
						var extraDmg = data.skills[this.specialIndex].charge - this.initSkillCharge();
						extraDmg = (Math.floor(allStats[17] * (extraDmg * 0.1 + 0.1))) + Math.floor(allStats[16] * 0.15);
						AOEDamage += extraDmg;
						damageText += this.name + " gains " + extraDmg + " damage from " + data.skills[this.weaponIndex].name + ". ";
					}
					else if(this.hasExactly("Fluttering Fan") && this.buddy.rorc > 0 && this.hp / this.maxHp < 1){
						AOEDamage += 10;
						damageText += this.name + " gains 10 damage from Fluttering Fan. ";
					}
					else if((this.hasExactly("Berserk Armads") || this.hasExactly("Tome Of Thoron") || (this.hasExactly("Devil Axe") && this.rValue == 5)) && this.hp/this.maxHp <= .75){
						AOEDamage += 10;
						damageText += this.name + " gains 10 damage from weapon. ";
					}
					else if(this.hasExactly("Holy-War Spear")){
						var extraDmg = Math.floor(allStats[18] * 0.2);
						AOEDamage += extraDmg;
						damageText += this.name + " gains " + extraDmg + " damage from Holy-War Spear. ";
					}
					else if(this.hasExactly("Stone of Delights") && this.buddy.adjacent + this.buddy.two + this.buddy.three > 0){
						var extraDmg = Math.min(this.maxHp - enemy.hp, 16);
						extraDmg = Math.max(extraDmg, 8);
						AOEDamage += extraDmg;
						damageText += this.name + " gains " + extraDmg + " damage from Stone of Delights. ";
					}
					
					if(this.hasExactly("Flashing Blade 4") && (allStats[17] + this.getPhantom("Spd")) - (allStats[21] + enemy.getPhantom("Spd")) >= 1){
						AOEDamage += 5;
						damageText += this.name + " gains 5 damage from Flashing Blade 4. ";
					}
					else if(this.hasExactly("Heavy Blade 4") && allStats[16] > allStats[20]){
						AOEDamage += 5;
						damageText += this.name + " gains 5 damage from Heavy Blade 4. ";
					}
					else if(this.hasExactly("Scendscale")){
						var scenDmg = Math.floor(allStats[16] * 0.25);
						AOEDamage += scenDmg;
						damageText += this.name + " gains " + scenDmg + " damage from Scendscale. ";
					}
					else if(this.hasExactly("Ashera's Chosen+") && (this.toggle.a == 1 || enemy.hp / enemy.maxHp >= 0.75) && this.getPhantom("Res") + allStats[19] > enemy.getPhantom("Res") + allStats[23]){
						var diffDmg = Math.floor((allStats[19] - allStats[23]) * 0.7);
						diffDmg = Math.min(diffDmg, 7);
						AOEDamage += diffDmg;
						damageText += this.name + " gains " + diffDmg + " damage from Ashera's Chosen+. ";
					}
					else if((this.hasExactly("Sly Swift Sparrow") || this.hasExactly("Sly Mirror") || this.hasExactly("Sly Sturdy Blow")) && ((Object.values(this.bonus).reduce((a, item) => a + (item === true ? 1 : 0), 0) + this.bonus.extra) > 1 || (Object.values(enemy.penalty).reduce((a, item) => a + (item === true ? 1 : 0), 0) + enemy.penalty.extra) > 1)){
						AOEDamage += 5;
						damageText += this.name + " gains 5 damage from " + data.skills[this.aIndex].name + ". ";
					}

					if(this.hasExactly("Wrath 1") || this.hasExactly("Wrath 2") || this.hasExactly("Wrath 3")){
						if(this.hp/this.maxHp <= .25 * this.has("Wrath")){
							AOEDamage += 10;
							damageText += this.name + " gains 10 damage from " + data.skills[this.bIndex].name + ". ";
						}
					}
					else if(this.hasExactly("Bushido")){
						AOEDamage += 10;
						damageText += this.name + " gains 10 damage from Bushido. ";
					}
					else if(this.hasExactly("Lunar Brace")){
						var extraDmg = Math.floor(allStats[22] / 2);
						AOEDamage += extraDmg;
						damageText += this.name + " gains " + extraDmg + " damage from Lunar Brace. ";
					}
					else if(this.hasExactly("Lunar Brace 2")){
						var extraDmg = Math.floor(allStats[22] * 0.15);
						AOEDamage += extraDmg;
						damageText += this.name + " gains " + extraDmg + " damage from Lunar Brace 2. ";
					}
					else if(this.hasExactly("Atrocity") && enemy.hp / enemy.maxHp >= 0.5){
						var atroDmg = Math.floor(allStats[16] * 0.25);
						AOEDamage += atroDmg;
						damageText += this.name + " gains " + atroDmg + " damage from Atrocity. ";
					}
					else if(this.hasExactly("Bushido 2") || this.hasExactly("SR Far Trace 4") || this.hasExactly("AR Far Trace 4") || this.hasExactly("SD Near Trace 4") || this.hasExactly("SR Near Trace 4") || this.hasExactly("SD Far Trace 4") || this.hasExactly("AR Near Trace 4")){
						AOEDamage += 7;
						damageText += this.name + " gains 7 damage from " + data.skills[this.bIndex].name + ". ";
					}
					else if((this.hasExactly("Moonlight Bangle") || this.hasExactly("Moonlit Bangle F")) && this.specialIndex != -1){
						var extraDmg = data.skills[this.specialIndex].charge - this.initSkillCharge();
						extraDmg = Math.floor(allStats[22] * (extraDmg * 0.1 + 0.2));
						AOEDamage += extraDmg;
						damageText += this.name + " gains " + extraDmg + " damage from " + data.skills[this.bIndex].name + ". ";
					}
					else if(this.hasExactly("Hodr's Zeal")){
						var scenDmg = Math.floor(allStats[16] * 0.2);
						AOEDamage += scenDmg;
						damageText += this.name + " gains " + scenDmg + " damage from Hodr's Zeal. ";
					}
					else if(this.hasExactly("Special Spiral 4")){
						AOEDamage += 5;
						damageText += this.name + " gains 5 damage from Special Spiral 4. ";
					}
					else if((this.has("Spurn") < 4 && this.hp/this.maxHp <= 0.25 * this.has("Spurn")) || (this.hasExactly("Spurn 4") && this.hp/this.maxHp <= 0.75)){
						AOEDamage += 5;
						damageText += this.name + " gains 5 damage from Spurn " + this.has("Spurn") + ". ";
					}
					else if(this.hasExactly("Lone Wolf") && (this.hp/this.maxHp >= 0.25 || this.buddy.adjacent < 2)){
						var extraDmg = Math.floor(allStats[17] * 0.2);
						AOEDamage += extraDmg;
						damageText += this.name + " gains " + extraDmg + " damage from Lone Wolf. ";
					}
					else if(this.hasSlot("Momentum","b") && this.buddy.spaces > 0){
						var extraDmg = this.buddy.spaces * this.hasSlot("Momentum","b");
						AOEDamage += extraDmg;
						damageText += this.name + " gains " + extraDmg + " damage from " + data.skills[this.bIndex].name + ". ";
					}
					else if(this.hasExactly("Dark Perfume") && this.hp/this.maxHp >= 0.25){
						var extraDmg = Math.floor(allStats[17] * 0.2);
						AOEDamage += extraDmg;
						damageText += this.name + " gains " + extraDmg + " damage from Dark Perfume. ";
					}
					else if(this.hasExactly("Pure Dragon Wall")){
						var extraDmg = 0.2;
						if(this.toggle.b == 1 || this.toggle.b == 3){
							extraDmg = 0.3;
						}
						extraDmg = Math.floor(allStats[19] * extraDmg);
						AOEDamage += extraDmg;
						damageText += this.name + " gains " + extraDmg + " damage from Pure Dragon Wall. ";
					}
					
					if(this.hasExactly("Far Trace Echo")){
						AOEDamage += 3;
						damageText += this.name + " gains 3 damage from Far Trace Echo. ";
					}
					if(this.emblem == "Sigurd" && this.buddy.spaces > 0){
						var extraDmg = Math.min(this.buddy.spaces * 2, 8);
						AOEDamage += extraDmg;
						damageText += this.name + " gains " + extraDmg + " damage from Emblem (Sigurd). ";
					}
					if(this.moveType == "infantry" && this.weaponType == "beast" && this.transform == true){
						//Bonus dmg now changes based on refine/unit release date
						if(data.heroes[this.heroIndex].hero_id < 782 && this.rValue < 0){
							AOEDamage += 10;
							damageText += this.name + " gains 10 damage from transforming. ";
						}
						else{
							AOEDamage += 7;
							damageText += this.name + " gains 7 damage from transforming. ";
						}
					}
					if(this.bonus.dominance){
						AOEDamage += domiDmg;
						damageText += this.name + " gains " + domiDmg + " damage from Dominance status. ";
					}
					if(this.bonus.treachery && !this.penalty.ploy){
						AOEDamage += AOETreachDmg;
						damageText += this.name + " gains " + AOETreachDmg + " damage from Treachery status. ";
					}
					if(this.support.flutter > 0 && this.hp / this.maxHp < 1){
						var fluVal = 10 * this.support.flutter;
						AOEDamage += fluVal;
						damageText += this.name + " gains " + fluVal + " damage from ally Nephenee(s). ";
					}
					if(enemy.penalty.exposure == true){
						AOEDamage += 10;
						damageText += this.name + " gains 10 damage from " + enemy.name + " being affected by Exposure. ";
					}
					
					this.sTrigger = 1;
					this.resetCharge();
					
					if(enemy.hasExactly("Ethereal Breath") || enemy.hasExactly("Opposing Stones")){
						var aMult = 0.2;
						if(enemy.hasExactly("Ethereal Breath") && enemy.rValue == 5 && enemy.getPhantom("Res") + allStats[23] > this.getPhantom("Res") + allStats[19]){
							var ccMult = Math.min(allStats[23] - allStats[19],10);
							ccMult = 4 * ccMult * 0.01;
							aMult = Math.round(aMult * (1-ccMult) * 100) / 100;
						}
						aMult = 1 - aMult;
						AOEDamage -= Math.floor(AOEDamage * aMult);
						damageText += enemy.name + " reduces AoE Damage by " + aMult + " from " + data.skills[enemy.weaponIndex].name + ". ";
					}
					//Res check Reduction (up to 40%)
					else if((enemy.hasExactly("New Foxkit Fang") || (enemy.hasExactly("Loptous") && enemy.rValue > 0 && (effectiveBonus == 1 || this.has("Poison Dagger"))) || enemy.hasExactly("Windy War Tome") || (enemy.hasExactly("Virtuous Naga") && enemy.rValue > 0 && (allStats[20] > allStats[16] || this.hp / this.maxHp >= 0.75)) || ((enemy.hasExactly("Masked Lance") || enemy.hasExactly("Aurora Breath") || enemy.hasExactly("Dark Scripture")) && enemy.rValue == 5 && enemy.hp / enemy.maxHp >= 0.25) || (enemy.hasExactly("Zephyr Breath") && enemy.rValue == 5) || (enemy.hasExactly("Arch-Sage Tome") && (enemy.buddy.adjacent > 0 || enemy.buddy.two > 0 || enemy.buddy.three > 0)) || enemy.hasExactly("Airborne Spear") || enemy.hasExactly("Loving Breath")) && allStats[23] + enemy.getPhantom("Res") > allStats[19] + this.getPhantom("Res")){
						var ccMult = Math.min(allStats[23] + enemy.getPhantom("Res") - allStats[19] - this.getPhantom("Res"),10);
						var ccCut = ccMult * 0.04;
						AOEDamage -= Math.floor(AOEDamage * ccCut);
						damageText += enemy.name + " reduces AoE Damage by " + ccCut + " from " + data.skills[enemy.weaponIndex].name + ". ";
					}
					//Spd check Reduction (up to 40%)
					else if((enemy.hasExactly("Guardian Fang") || enemy.hasExactly("Nightmare Horn") || (enemy.hasExactly("Bun-Bun Baton") && enemy.rValue == 5)) && enemy.getPhantom("Spd") + allStats[21] > this.getPhantom("Spd") + allStats[17]){
						var ccMult = Math.min((enemy.getPhantom("Spd") + allStats[21]) - (this.getPhantom("Spd") + allStats[17]),10);
						var ccCut = ccMult * 0.04;
						AOEDamage -= Math.floor(AOEDamage * ccCut);
						damageText += enemy.name + " reduces AoE Damage by " + ccCut + " from " + data.skills[enemy.weaponIndex].name + ". ";
					}
					//Blood Tome Reduction
					else if(enemy.hasExactly("Blood Tome") && data.rangedWeapons.indexOf(this.weaponType) != -1){
						AOEDamage -= Math.floor(AOEDamage * 0.8);
						damageText += enemy.name + " reduces AoE Damage by 0.8 from Blood Tome. ";
					}
					//Gilt Goblet Reduction
					else if(enemy.hasExactly("Gilt Goblet") && (this.initiator || this.hp / this.maxHp == 1) && this.weaponType.indexOf("tome") != -1){
						AOEDamage -= Math.floor(AOEDamage * 0.5);
						damageText += enemy.name + " reduces AoE Damage by 0.5 from Gilt Goblet. ";
					}
					else if(enemy.hasExactly("Dark Creator S") && (enemy.toggle.weapon > 10 || (enemy.rValue > 0 && enemy.toggle.weapon % 10 > 0))){
						var sMult = ((enemy.toggle.weapon % 10) * 15) / 100;
						if(enemy.toggle.weapon > 10 && enemy.rValue > 0){
							sMult = ((enemy.toggle.weapon % 10) * 25) / 100;
						}
						AOEDamage -= Math.floor(AOEDamage * sMult);
						damageText += enemy.name + " reduces AoE Damage by " + sMult + " from Dark Creator S. ";
					}
					//HP >= 25% Speed Check Reduction (up to 40%)
					else if((enemy.hasExactly("Areadbhar") || enemy.hasExactly("Brightmare Horn") || enemy.hasExactly("Liberation") || enemy.hasExactly("Monarch Blade") || ((enemy.hasExactly("Storm Sieglinde") || enemy.hasExactly("Wanderer Blade") || enemy.hasExactly("Balmung")) && enemy.rValue == 5)) && enemy.hp / enemy.maxHp >= 0.25 && enemy.getPhantom("Spd") + allStats[21] > this.getPhantom("Spd") + allStats[17]){
						var ccMult = Math.min((enemy.getPhantom("Spd") + allStats[21]) - (this.getPhantom("Spd") + allStats[17]),10);
						var ccCut = ccMult * 0.04;
						AOEDamage -= Math.floor(AOEDamage * ccCut);
						damageText += enemy.name + " reduces AoE Damage by " + ccCut + " from " + data.skills[enemy.weaponIndex].name + ". ";
					}
					//Lilac-Jade Breath
					else if(enemy.hasExactly("Lilac-Jade Breath") && (this.initiator || this.hp / this.maxHp >= 1)){
						AOEDamage -= Math.floor(AOEDamage * 0.4);
						damageText += enemy.name + " reduces AoE Damage by 0.4 from Lilac-Jade Breath. ";
					}
					//Refined Ninis's Ice Lance Reduction
					else if(enemy.hasExactly("Ninis's Ice Lance") && enemy.rValue == 5 && enemy.toggle.weapon == 1 && enemy.getPhantom("Spd") + allStats[21] > this.getPhantom("Spd") + allStats[17]){
						var ccMult = Math.min((enemy.getPhantom("Spd") + allStats[21]) - (this.getPhantom("Spd") + allStats[17]),10);
						var ccCut = ccMult * 0.04;
						AOEDamage -= Math.floor(AOEDamage * ccCut);
						damageText += enemy.name + " reduces AoE Damage by " + ccCut + " from Ninis's Ice Lance. ";
					}
					//Carnage Amatsu
					else if(enemy.hasExactly("Carnage Amatsu") && enemy.toggle.weapon == 1 && enemy.getPhantom("Spd") + allStats[21] > this.getPhantom("Spd") + allStats[17]){
						var ccMult = Math.min((enemy.getPhantom("Spd") + allStats[21]) - (this.getPhantom("Spd") + allStats[17]),10);
						var ccCut = ccMult * 0.04;
						AOEDamage -= Math.floor(AOEDamage * ccCut);
						damageText += enemy.name + " reduces AoE Damage by " + ccCut + " from Carnage Amatsu. ";
					}
					//Refined Hurricane Dagger
					else if(enemy.hasExactly("Hurricane Dagger") && enemy.rValue == 5 && enemy.hp / enemy.maxHp >= 0.25 && enemy.getPhantom("Spd") + allStats[21] > this.getPhantom("Spd") + allStats[17]){
						var ccMult = Math.min((enemy.getPhantom("Spd") + allStats[21]) - (this.getPhantom("Spd") + allStats[17]),10);
						var ccCut = ccMult * 0.03;
						AOEDamage -= Math.floor(AOEDamage * ccCut);
						damageText += enemy.name + " reduces AoE Damage by " + ccCut + " from Hurricane Dagger. ";
					}
					else if(enemy.hasExactly("Imhullu") && enemy.rValue == 5 && enemy.hp / enemy.maxHp >= 0.25 && this.weaponType.indexOf("tome") == -1){
						AOEDamage -= Math.floor(AOEDamage * 0.3);
						damageText += enemy.name + " reduces AoE Damage by 0.3 from Imhullu. ";
					}
					else if(enemy.hasExactly("Godly Breath") && enemy.toggle.weapon == 1){
						AOEDamage -= Math.floor(AOEDamage * 0.3);
						damageText += enemy.name + " reduces AoE Damage by 0.3 from Godly Breath. ";
					}
					else if(enemy.hasExactly("Lion King Fang") && enemy.rValue > 0){
						AOEDamage -= Math.floor(AOEDamage * 0.7);
						damageText += enemy.name + " reduces AoE Damage by 0.7 from Lion King Fang. ";
					}
					else if(enemy.hasExactly("Fang of Finality") && enemy.toggle.weapon > 9){
						var sVar = Math.round((enemy.toggle.weapon - 10 + 1) * 0.2 * 100) / 100;
						AOEDamage -= Math.floor(AOEDamage * sVar);
						damageText += enemy.name + " reduces AoE Damage by " + sVar + " from Fang of Finality. ";
					}
					else if(enemy.hasExactly("Joyous Tome") && enemy.toggle.weapon > 0){
						var jVar = Math.round((enemy.toggle.weapon * 15) * 0.01 * 100) / 100;
						AOEDamage -= Math.floor(AOEDamage * jVar);
						damageText += enemy.name + " reduces AoE Damage by " + jVar + " from Joyous Tome. ";
					}
					else if((enemy.hasExactly("Lone-Wolf Blade") || enemy.hasExactly("Dream Horn") || (enemy.hasExactly("Primordial Breath") && enemy.rValue == 5)) && enemy.hp / enemy.maxHp >= 0.25){
						AOEDamage -= Math.floor(AOEDamage * 0.3);
						damageText += enemy.name + " reduces AoE Damage by 0.3 from " + data.skills[enemy.weaponIndex].name + ". ";
					}
					else if(enemy.hasExactly("Freeblade's Edge") && (this.initiator || this.hp / this.maxHp >= 0.75)){
						AOEDamage -= Math.floor(AOEDamage * 0.3);
						damageText += enemy.name + " reduces AoE Damage by 0.3 from Freeblade's Edge. ";
					}
					else if(enemy.hasExactly("Twin Divinestone") && enemy.hp / enemy.maxHp >= 0.25 && enemy.getPhantom("Res") + allStats[23] > this.getPhantom("Res") + allStats[19]){
						var ccMult = Math.min(allStats[23] - allStats[19],10);
						var ccCut = 4 * ccMult * 0.01;
						AOEDamage -= Math.floor(AOEDamage * ccCut);
						damageText += enemy.name + " reduces AoE Damage by " + ccCut + " from Twin Divinestone. ";
					}
					else if(enemy.hasExactly("Sparkling Sun") && enemy.toggle.weapon == 1){
						AOEDamage -= Math.floor(AOEDamage * 0.75);
						damageText += enemy.name + " reduces AoE Damage by 0.75 from Sparkling Sun. ";
					}
					else if(enemy.hasExactly("Dragon's Fist") && enemy.hp / enemy.maxHp >= 0.25){
						AOEDamage -= Math.floor(AOEDamage * 0.4);
						damageText += enemy.name + " reduces AoE Damage by 0.4 from " + data.skills[enemy.weaponIndex].name + ". ";
					}
					else if(enemy.hasExactly("Hyperion Lance") && enemy.rValue == 5 && enemy.hp / enemy.maxHp >= 0.25){
						var hlVal = 0.2;
						if(enemy.toggle.weapon == 1){
							hlVal = 0.4;
						}
						AOEDamage -= Math.floor(AOEDamage * hlVal);
						damageText += enemy.name + " reduces AoE Damage by " + hlVal + " from " + data.skills[enemy.weaponIndex].name + ". ";
					}
					
					if(enemy.hasExactly("Ashera's Chosen+") && (enemy.toggle.a == 1 || this.hp / this.maxHp >= 0.75) && enemy.getPhantom("Res") + allStats[23] > this.getPhantom("Res") + allStats[19]){
						var ccMult = Math.min(allStats[23] - allStats[19],10);
						var ccCut = 4 * ccMult * 0.01;
						AOEDamage -= Math.floor(AOEDamage * ccCut);
						damageText += enemy.name + " reduces AoE Damage by " + ccCut + " from Ashera's Chosen+. ";
					}
					else if(enemy.hasExactly("Emblems' Miracle") && (enemy.buddy.adjacent > 0 || enemy.buddy.two > 0 || enemy.buddy.three > 0)){
						AOEDamage -= Math.floor(AOEDamage * 0.4);
						damageText += enemy.name + " reduces AoE Damage by 0.4 from " + data.skills[enemy.aIndex].name + ". ";
					}
						
					//Close Call/Repel Reduction
					if((enemy.has("Close Call") || enemy.has("Repel") || enemy.has("Spurn") || enemy.has("Frenzy") || enemy.has("Velocity") || enemy.has("Beast Sense") || enemy.hasExactly("Buffer 4")) && enemy.getPhantom("Spd") + allStats[21] > this.getPhantom("Spd") + allStats[17]){
						var ccMult = Math.min((enemy.getPhantom("Spd") + allStats[21]) - (this.getPhantom("Spd") + allStats[17]),10);
						if(enemy.has("Close Call")){
							var ccCut = Math.round((enemy.has("Close Call") + 1) * ccMult * 0.01 * 100) / 100;
							damageText += enemy.name + " reduces AoE Damage by " + ccCut + " from Close Call. ";
						}
						else if(enemy.has("Repel")){
							var ccCut = Math.round((enemy.has("Repel") + 1) * ccMult * 0.01 * 100) / 100;
							damageText += enemy.name + " reduces AoE Damage by " + ccCut + " from Repel. ";
						}
						else if(enemy.has("Spurn")){
							var ccCut = Math.round((enemy.has("Spurn") + 1) * ccMult * 0.01 * 100) / 100;
							damageText += enemy.name + " reduces AoE Damage by " + ccCut + " from Spurn. ";
						}
						else if(enemy.has("Frenzy")){
							var ccCut = Math.round((enemy.has("Frenzy") + 1) * ccMult * 0.01 * 100) / 100;
							damageText += enemy.name + " reduces AoE Damage by " + ccCut + " from Frenzy. ";
						}
						else if(enemy.has("Velocity")){
							var ccCut = Math.round((enemy.has("Velocity") + 1) * ccMult * 0.01 * 100) / 100;
							damageText += enemy.name + " reduces AoE Damage by " + ccCut + " from Velocity. ";
						}
						else if(enemy.has("Beast Sense")){
							var ccCut = Math.round(enemy.has("Beast Sense") * ccMult * 0.01 * 100) / 100;
							damageText += enemy.name + " reduces AoE Damage by " + ccCut + " from Beast Sense. ";
						}
						else if(enemy.hasExactly("Buffer 4")){
							var ccCut = Math.round(5 * ccMult * 0.01 * 100) / 100;
							damageText += enemy.name + " reduces AoE Damage by " + ccCut + " from Buffer 4. ";
						}
						AOEDamage -= Math.floor(AOEDamage * ccCut);
					}
					//Blue Lion Rule can't overlap with CCall types (for now at least)
					else if(enemy.hasExactly("Blue Lion Rule") && allStats[22] > allStats[18]){
						var ccMult = Math.min(allStats[22] - allStats[18],10);
						var ccCut = 4 * ccMult * 0.01;
						AOEDamage -= Math.floor(AOEDamage * ccCut);
						damageText += enemy.name + " reduces AoE Damage by " + ccCut + " from Blue Lion Rule. ";
					}
					//Dragon Wall (and variants)
					else if((enemy.has("Dragon Wall") || enemy.hasExactly("New Divinity")) && enemy.getPhantom("Res") + allStats[23] > this.getPhantom("Res") + allStats[19]){
						var ccMult = Math.min((enemy.getPhantom("Res") + allStats[23]) - (this.getPhantom("Res") + allStats[19]),10);
						var ccVar = 4;
						if(enemy.hasExactly("True Dragon Wall") || enemy.hasExactly("Pure Dragon Wall")){
							if(enemy.toggle.b == 1 || enemy.toggle.b == 3){
								ccVar = 6;
							}
						}
						else if(enemy.hasExactly("High Dragon Wall")){
							ccVar = 4;
						}
						else if(enemy.has("Dragon Wall")){
							ccVar = enemy.has("Dragon Wall") + 1;
						}
						var ccCut = ccVar * ccMult * 0.01;
						AOEDamage -= Math.floor(AOEDamage * ccCut);
						damageText += enemy.name + " reduces AoE Damage by " + ccCut + " from " + data.skills[enemy.bIndex].name + ". ";
					}
					//Bushido 2
					else if(enemy.hasExactly("Bushido 2") && enemy.getPhantom("Spd") + allStats[21] > this.getPhantom("Spd") + allStats[17]){
						var ccMult = Math.min((enemy.getPhantom("Spd") + allStats[21]) - (this.getPhantom("Spd") + allStats[17]),10);
						var ccCut = 4 * ccMult * 0.01;
						AOEDamage -= Math.floor(AOEDamage * ccCut);
						damageText += enemy.name + " reduces AoE Damage by " + ccCut + " from Bushido 2. ";
					}
					else if(enemy.has("Moon-Twin Wing") && enemy.hp / enemy.maxHp >= 0.25 && enemy.getPhantom("Spd") + allStats[21] > this.getPhantom("Spd") + allStats[17]){
						var ccMult = Math.min((enemy.getPhantom("Spd") + allStats[21]) - (this.getPhantom("Spd") + allStats[17]),10);
						var ccCut = ccMult * 0.04;
						if(enemy.hasExactly("Moon-Twin Wing+")){
							ccCut = ccMult * 0.05;
						}
						AOEDamage -= Math.floor(AOEDamage * ccCut);
						damageText += enemy.name + " reduces AoE Damage by " + ccCut + " from " + data.skills[enemy.bIndex].name + ". ";
					}
					//Assured Rebirth
					else if(enemy.hasExactly("Assured Rebirth") && (enemy.toggle.b > 0 || enemy.getPhantom("Res") + allStats[23] > this.getPhantom("Res") + allStats[19])){
						var ccAlly = enemy.toggle.b * 20 * 0.01;
						var ccRes = Math.min((enemy.getPhantom("Res") + allStats[23]) - (this.getPhantom("Res") + allStats[19]),10);
						ccRes = Math.max(ccRes, 0) * 4 * 0.01;
						var ccCut = Math.min(ccAlly + ccRes, 0.6);
						AOEDamage -= Math.floor(AOEDamage * ccCut);
						damageText += enemy.name + " reduces AoE Damage by " + ccCut + " from Assured Rebirth. ";
					}
					else if(enemy.hasExactly("Chivalry")){
						var ccCut = Math.round(this.hp / this.maxHp * 0.5 * 100) / 100;
						AOEDamage -= Math.floor(AOEDamage * ccCut);
						damageText += enemy.name + " reduces AoE Damage by " + ccCut + " from Chivalry. ";
					}
					else if(enemy.hasExactly("Chivalry 2")){
						var ccCut = 0.5;
						AOEDamage -= Math.floor(AOEDamage * ccCut);
						damageText += enemy.name + " reduces AoE Damage by " + ccCut + " from Chivalry 2. ";
					}
					else if(enemy.hasExactly("Guard Bearing 4")){
						var ccCut = 0.3;
						if(enemy.toggle.b == 1){
							ccCut = 0.6;
						}
						AOEDamage -= Math.floor(AOEDamage * ccCut);
						damageText += enemy.name + " reduces AoE Damage by " + ccCut + " from Guard Bearing 4. ";
					}
					else if((enemy.hasExactly("Gambit 1") || enemy.hasExactly("Gambit 2") || enemy.hasExactly("Gambit 3") || enemy.hasExactly("Gambit 4"))){
						var ccMult = Math.min(enemy.hasSlot("Gambit","b") * 3 + 1,10);
						var ccSp = Math.min(data.skills[enemy.specialIndex].charge - enemy.initSkillCharge(),5);
						var ccCut = Math.round(ccSp * ccMult * 0.01 * 100) / 100;
						AOEDamage -= Math.floor(AOEDamage * ccCut);
						damageText += enemy.name + " reduces AoE Damage by " + ccCut + " from " + data.skills[enemy.bIndex].name + ". ";
					}
					else if(enemy.has("Magic Gambit")){
						var ccMult = Math.min(enemy.hasSlot("Magic Gambit","b") * 3 + 1,10);
						var ccSp = Math.min(data.skills[enemy.specialIndex].charge - enemy.initSkillCharge() - 1,4);
						var ccCut = Math.round(ccSp * ccMult * 0.01 * 100) / 100;
						AOEDamage -= Math.floor(AOEDamage * ccCut);
						damageText += enemy.name + " reduces AoE Damage by " + ccCut + " from " + data.skills[enemy.bIndex].name + ". ";
					}
					else if(enemy.hasExactly("Potent 2") || enemy.hasExactly("Potent 3") || enemy.hasExactly("Potent 4")){
						var ccCut = (enemy.hasSlot("Potent","b") - 1) / 10;
						AOEDamage -= Math.floor(AOEDamage * ccCut);
						damageText += enemy.name + " reduces AoE Damage by " + ccCut + " from " + data.skills[enemy.bIndex].name + ". ";
					}
					else if(enemy.hasExactly("Believe in Love") && enemy.getPhantom("Spd") + allStats[21] > this.getPhantom("Spd") + allStats[17]){
						var ccMult = Math.min((enemy.getPhantom("Spd") + allStats[21]) - (this.getPhantom("Spd") + allStats[17]),10);
						var ccCut = ccMult * 0.05;
						AOEDamage -= Math.floor(AOEDamage * ccCut);
						damageText += enemy.name + " reduces AoE Damage by " + ccCut + " from " + data.skills[enemy.bIndex].name + ". ";
					}
					else if(enemy.hasExactly("Pure Dragon Wall")){
						var ccCut = 0.2;
						if(enemy.toggle.b == 1 || enemy.toggle.b == 3){
							ccCut = 0.3;
						}
						AOEDamage -= Math.floor(AOEDamage * ccCut);
						damageText += enemy.name + " reduces AoE Damage by " + ccCut + " from Pure Dragon Wall. ";
					}
					
					if(enemy.hasExactly("All Together!") && enemy.toggle.c > 0){
						var atCut = 0.4 * enemy.toggle.c;
						AOEDamage -= Math.floor(AOEDamage * atCut);
						damageText += enemy.name + " reduces AoE Damage by " + atCut + " from All Together!. ";
					}
					else if(enemy.hasExactly("Love for All!") && enemy.buddy.adjacent + enemy.buddy.two + enemy.buddy.three > 0){
						var atCut = Math.min(0.4 * (enemy.buddy.adjacent + enemy.buddy.two + enemy.buddy.three), 0.8);
						AOEDamage -= Math.floor(AOEDamage * atCut);
						damageText += enemy.name + " reduces AoE Damage by " + atCut + " from Love for All!. ";
					}
					//specials
					if(enemy.hasExactly("Vital Astra") && spCharged && enemy.getPhantom("Spd") + allStats[21] > this.getPhantom("Spd") + allStats[17]){
						var ccMult = Math.min((enemy.getPhantom("Spd") + allStats[21]) - (this.getPhantom("Spd") + allStats[17]),10);
						var ccCut = 3 * ccMult * 0.01;
						AOEDamage -= Math.floor(AOEDamage * ccCut);
						damageText += enemy.name + " reduces AoE Damage by " + ccCut + " from Vital Astra. ";
					}
					else if(enemy.hasExactly("Arms of the Three") && spCharged && allStats[23] + enemy.getPhantom("Res") > allStats[19] + this.getPhantom("Res")){
						var atVal = Math.min((allStats[23] + enemy.getPhantom("Res") - allStats[19] - this.getPhantom("Res")) * 3, 30) / 100;
						AOEDamage -= Math.floor(AOEDamage * atVal);
						damageText += enemy.name + " reduces AoE Damage by " + atVal + " from Arms of the Three. ";
					}
					//Dodge Status
					if(enemy.bonus.dodge && enemy.getPhantom("Spd") + allStats[21] > this.getPhantom("Spd") + allStats[17]){
						var ccMult = Math.min((enemy.getPhantom("Spd") + allStats[21]) - (this.getPhantom("Spd") + allStats[17]),10);
						var ccCut = 4 * ccMult * 0.01;
						AOEDamage -= Math.floor(AOEDamage * ccCut);
						damageText += enemy.name + " reduces AoE Damage by " + ccCut + " from Dodge Status. ";
					}
					//80% DR (Brilliant Starlight)
					if(enemy.bonus.starlight == true){
						AOEDamage -= Math.floor(AOEDamage * 0.8);
						damageText += enemy.name + " reduces AoE Damage by 0.8 from 80% AOE DR Bonus. ";
					}
					if(enemy.vein == 1){
						AOEDamage -= Math.floor(AOEDamage * 0.5);
						damageText += enemy.name + " reduces AoE Damage by 0.5 from Divine Vein (Bonus). ";
					}
					//% DR that cannot be nullified
					if((enemy.hasExactly("Dragon Fang Shot") || enemy.hasExactly("Requiem Prayer") || enemy.hasExactly("Dragon Fang Fire")) && allStats[23] + enemy.getPhantom("Res") > allStats[19] + this.getPhantom("Res")){
						var dsVal = Math.max(2 - enemy.charge, 0);
						dsVal = Math.min(dsVal, 2);
						var ccMult = Math.min((enemy.getPhantom("Res") + allStats[23]) - (this.getPhantom("Res") + allStats[19]),10);
						dsVal = (4 - dsVal) * ccMult * 0.01;
						if(enemy.hasExactly("Dragon Fang Fire")){
							dsVal = (8 - dsVal) * ccMult * 0.01;
						}
						AOEDamage -= Math.floor(AOEDamage * dsVal);
						damageText += enemy.name + " reduces AoE Damage by " + dsVal + " from " + data.skills[enemy.specialIndex].name + ". ";
					}
					//AOE True DR
					if(enemy.hasExactly("Duality Vessel") && enemy.toggle.weapon == 1 && allStats[22] > allStats[18]){
						var tdr = Math.floor((allStats[22] - allStats[18]) * 1.5);
						AOEDamage -= tdr;
						damageText += enemy.name + " reduces AoE Damage by " + tdr + " from Duality Vessel. ";
					}
					else if(enemy.hasExactly("Horn of Harvest")){
						var tdr = Math.floor(allStats[22] * 0.2);
						AOEDamage -= tdr;
						damageText += enemy.name + " reduces AoE Damage by " + tdr + " from Horn of Harvest. ";
					}
					else if(enemy.hasExactly("Bold Kusarigama") && (enemy.buddy.adjacent > 0 || enemy.buddy.two > 0)){
						var tdr = Math.floor(allStats[22] * 0.25);
						AOEDamage -= tdr;
						damageText += enemy.name + " reduces AoE Damage by " + tdr + " from Bold Kusarigama. ";
					}
					else if(enemy.hasExactly("Arcane Giant Axe") || enemy.hasExactly("Arcane Fell Arts")){
						var tdr = Math.floor(allStats[20] * 0.15);
						AOEDamage -= tdr;
						damageText += enemy.name + " reduces AoE Damage by " + tdr + " from " + data.skills[enemy.weaponIndex].name + ". ";
					}
					if((enemy.hasExactly("Believe in Love") || enemy.hasExactly("Faithful Loyalty 2")) && (this.moveType == "cavalry" || this.moveType == "armored")){
						var xVal = 0;
						if(!enemy.penalty.panic){
							xVal = Math.max(enemy.combatBuffs.atk,enemy.buffs.atk) + Math.max(enemy.combatBuffs.spd,enemy.buffs.spd) + Math.max(enemy.combatBuffs.def,enemy.buffs.def) + Math.max(enemy.combatBuffs.res,enemy.buffs.res);
						}
						xVal = Math.max(xVal,enemy.buddy.buffs.atk + enemy.buddy.buffs.spd + enemy.buddy.buffs.def + enemy.buddy.buffs.res);
						AOEDamage -= xVal;
						damageText += enemy.name + " reduces AoE Damage by " + xVal + " from " + data.skills[enemy.bIndex].name + ". ";
					}
					else if(enemy.hasExactly("Lone Wolf") && (enemy.hp/enemy.maxHp >= 0.25 || enemy.buddy.adjacent < 2)){
						var tdr = Math.floor(allStats[21] * 0.2) * 2;
						AOEDamage -= tdr;
						damageText += enemy.name + " reduces AoE Damage by " + tdr + " from Lone Wolf. ";
					}
					if(enemy.has("Embla's Ward") || AOEDamage < 0){
						AOEDamage = 0;
					}
					if(enemy.hp - AOEDamage < 1){
						AOEDamage = enemy.hp - 1;
					}

					enemy.hp -= AOEDamage;
					damageText += "Before combat, " + this.name + " hits with " + data.skills[this.specialIndex].name + " for " + AOEDamage + ".<br>";
				}
			}
			else{
				//special will fire if it's an attacking special
				if(this.hasExactly("Night Sky") || this.hasExactly("Glimmer")){
					dmgMultiplier = 1.5;
					offensiveSpecialActivated = true;
				}
				else if(this.hasExactly("Astra")){
					dmgMultiplier = 2.5;
					offensiveSpecialActivated = true;
				}
				else if(this.hasExactly("Regnal Astra") || this.hasExactly("Imperial Astra") || this.hasExactly("Supreme Astra") || this.hasExactly("Lodestar Rush") || this.hasExactly("Sacred Wind") || this.hasExactly("Astra Storm") || this.hasExactly("Crusader's Astra") || this.hasExactly("The Fire Emblem")){
					dmgBoost += thisEffSpd * 0.4;
					offensiveSpecialActivated = true;
				}
				else if(this.hasExactly("Fire Emblem") || this.hasExactly("Hero's Blood") || this.hasExactly("Righteous Wind") || this.hasExactly("Vital Astra") || this.hasExactly("Time and Light")){
					dmgBoost += thisEffSpd * 0.3;
					offensiveSpecialActivated = true;
				}
				else if(this.has("Lunar Flash")){
					enemyDefModifier = -0.2;
					dmgBoost += thisEffSpd * 0.2;
					if(this.hasExactly("True Lunar Flash")){
						enemyDefModifier = -0.35;
						dmgBoost += thisEffSpd * 0.35;
					}
					offensiveSpecialActivated = true;
				}
				else if(this.hasExactly("Divine Pulse")){
					dmgBoost += thisEffSpd * 0.25;
					offensiveSpecialActivated = true;
					if(this.beacon[0] == -1){
						this.beacon[0] = -4;
					}
					else{
						this.beacon[0] = -2;
					}
				}
				else if(this.hasExactly("Dragon Gaze") || this.hasExactly("Draconic Aura")){
					//Works like Ignis and Glacies
					dmgBoost += thisEffAtk * 0.3;
					offensiveSpecialActivated = true;
				}
				else if(this.hasExactly("Dragon Fang")){
					dmgBoost += thisEffAtk * 0.5;
					offensiveSpecialActivated = true;
				}
				else if(this.hasExactly("Glowing Ember") || this.hasExactly("Bonfire") || this.hasExactly("Boulder")){
					dmgBoost += thisEffDef/2;
					offensiveSpecialActivated = true;
				}
				else if(this.hasExactly("Ignis") || this.hasExactly("Sandstorm") || this.hasExactly("Dragon Flame")){
					dmgBoost += thisEffDef * 0.8;
					offensiveSpecialActivated = true;
				}
				else if(this.hasExactly("Daylight") || this.hasExactly("Noontime")){
					absorbPct = 0.3;
					offensiveSpecialActivated = true;
				}
				else if(this.hasExactly("Sol")){
					absorbPct = 0.5;
					offensiveSpecialActivated = true;
				}
				else if(this.hasExactly("Sirius")){
					dmgBoost += thisEffSpd * 0.3;
					absorbPct = 0.3;
					offensiveSpecialActivated = true;
				}
				else if(this.hasExactly("Sirius+")){
					dmgBoost += thisEffSpd * 0.35;
					absorbPct = 0.35;
					offensiveSpecialActivated = true;
				}
				else if(this.hasExactly("New Moon") || this.hasExactly("Moonbow")){
					enemyDefModifier = -0.3;
					offensiveSpecialActivated = true;
				}
				else if(this.hasExactly("Black Luna") || this.hasExactly("Lightless Luna")){
					enemyDefModifier = -0.8;
					offensiveSpecialActivated = true;
				}
				else if(this.hasExactly("Bane")){
					enemyDefModifier = -0.4;
					offensiveSpecialActivated = true;
				}
				else if(this.hasExactly("Luna") || this.hasExactly("Brutal Shell")){
					enemyDefModifier = -0.5;
					offensiveSpecialActivated = true;
				}
				else if(this.hasExactly("Chilling Wind") || this.hasExactly("Iceberg")){
					dmgBoost += thisEffRes/2;
					offensiveSpecialActivated = true;
				}
				else if(this.hasExactly("Glacies")){
					dmgBoost += thisEffRes*0.8;
					offensiveSpecialActivated = true;
				}
				else if(this.hasExactly("Frost Moon")){
					dmgBoost += thisEffRes*0.7;
					offensiveSpecialActivated = true;
				}
				else if(this.hasExactly("Retribution") || this.hasExactly("Reprisal")){
					dmgBoost += (this.maxHp-this.hp)*0.3;
					offensiveSpecialActivated = true;
				}
				else if(this.hasExactly("Vengeance")){
					dmgBoost += (this.maxHp-this.hp)*0.5;
					offensiveSpecialActivated = true;
				}
				else if(this.hasExactly("Great Aether")){
					dmgBoost += thisEffAtk * (0.4 + (enemy.strikes * 10 / 100));
					offensiveSpecialActivated = true;
				}
				else if(this.hasExactly("Aether's Path")){
					dmgBoost += Math.max(enemyEffSpd * 0.75, enemyEffDef * 0.75);
					offensiveSpecialActivated = true;
				}
				else if(this.has("Aether")){
					enemyDefModifier = -0.5;
					absorbPct = 0.5;
					offensiveSpecialActivated = true;
				}
				else if(this.hasExactly("Blue Flame")){
					if(this.toggle.special == 1){
						dmgBoost += 25;
					}
					else{
						dmgBoost += 10;
					}
					offensiveSpecialActivated = true;
				}
				else if(this.hasExactly("Ruptured Sky")){
					if(enemy.weaponType == "beast" || enemy.weaponType == "dragon"){
						dmgBoost += enemyEffAtk * 0.4;
					}
					else{
						dmgBoost += enemyEffAtk * 0.2;
					}
					offensiveSpecialActivated = true;
				}
				else if(this.hasExactly("Twin Blades") || this.hasExactly("Circlet of Balance") || this.hasExactly("Armored Floe") || this.hasExactly("Dragon's Roar") || this.hasExactly("Arms of the Three") || this.hasExactly("Dragon Fang Shot") || this.hasExactly("Requiem Prayer") || this.hasExactly("Dragon Fang Fire")){
					dmgBoost += thisEffRes * 0.4;
					offensiveSpecialActivated = true;
				}
				else if(this.hasExactly("Open the Future")){
					dmgBoost += thisEffDef/2;
					absorbPct = 0.25;
					offensiveSpecialActivated = true;
				}
				else if(this.hasExactly("Deadeye")){
					dmgMultiplier = 2.0;
					offensiveSpecialActivated = true;
				}
				else if(this.has("Seidr Shell")){
					dmgBoost += 15;
					if(this.hasExactly("Seidr Shell+")){
						dmgBoost += 5;
					}
					offensiveSpecialActivated = true;
					if(!enemy.has("Mystic Boost")){
						relevantDef = Math.min(enemyEffDef, enemyEffRes);
						relevantTileDef = Math.min(Math.floor(enemyEffDef*enemy.dTile), Math.floor(enemyEffRes*enemy.dTile));
					}
				}
				else if(this.hasExactly("Holy-Knight Aura") || this.hasExactly("Chivalric Aura") || this.hasExactly("Warp Ragnarok")){
					dmgBoost += thisEffAtk * 0.25;
					offensiveSpecialActivated = true;
				}
				else if(this.hasExactly("Sublime Heaven") || this.hasExactly("Supreme Heaven")){
					if(enemy.weaponType == "beast" || enemy.weaponType == "dragon"){
						dmgBoost += thisEffAtk * 0.5;
					}
					else{
						dmgBoost += thisEffAtk * 0.25;
					}
					offensiveSpecialActivated = true;
				}
				else if(this.hasExactly("Sublime Heaven 2")){
					if(enemy.weaponType == "beast" || enemy.weaponType == "dragon"){
						dmgBoost += thisEffAtk * 0.6;
					}
					else{
						dmgBoost += thisEffAtk * 0.3;
					}
					offensiveSpecialActivated = true;
				}
				else if(this.hasExactly("Shining Emblem")){
					dmgBoost += thisEffSpd * 0.35;
					offensiveSpecialActivated = true;
				}
				else if(this.hasExactly("Lethality")){
					enemyDefModifier = -0.75;
					offensiveSpecialActivated = true;
				}
				else if(this.hasExactly("Enclosure")){
					dmgBoost += thisEffAtk * 0.25;
					offensiveSpecialActivated = true;
				}
				else if(this.hasExactly("Holy Pressure") || this.hasExactly("Glitter of Light")){
					dmgBoost += enemyEffRes * 0.45;
					offensiveSpecialActivated = true;
				}
				else if(this.hasExactly("Light's Restraint") || this.hasExactly("Holy Panic")){
					dmgBoost += enemyEffRes * 0.25;
					offensiveSpecialActivated = true;
				}
				else if(this.hasExactly("Armored Beacon") || this.hasExactly("Armored Blaze")){
					dmgBoost += thisEffDef * 0.4;
					offensiveSpecialActivated = true;
				}
				else if(this.hasExactly("Flare")){
					if(this.hp / this.maxHp >= 0.7){
						dmgBoost += enemyEffRes * 0.6;
					}
					else{
						dmgBoost += enemyEffRes * 0.4;
					}
					offensiveSpecialActivated = true;
				}
				else if(this.hasExactly("Dragon Blast") || this.hasExactly("Bond Blast") || this.hasExactly("Gust") || this.hasExactly("Seidr Burst")){
					dmgBoost += thisEffSpd * 0.5;
					offensiveSpecialActivated = true;
				}
				else if(this.hasExactly("Light Is Time")){
					dmgBoost += enemyEffAtk * 0.6;
					offensiveSpecialActivated = true;
				}
				else if(this.hasExactly("Time Is Light")){
					dmgBoost += thisEffSpd * 0.45;
					offensiveSpecialActivated = true;
				}
				else if(this.hasExactly("No Quarter")){
					if(enemy.moveType == "armored"){
						dmgBoost += thisEffAtk * 0.4;
					}
					else{
						dmgBoost += thisEffAtk * 0.3;
					}
					offensiveSpecialActivated = true;
				}
				else if(this.hasExactly("Holy-Knight 2")){
					dmgBoost += thisEffAtk * 0.3;
					offensiveSpecialActivated = true;
				}
				else if(this.hasExactly("Fierce Beast")){
					if(this.transform == true){
						dmgBoost += thisEffAtk * 0.25;
					}
					else{
						dmgBoost += thisEffAtk * 0.2;
					}
					offensiveSpecialActivated = true;
				}
				else if(this.hasExactly("Curved Shot")){
					dmgBoost += Math.max(enemyEffSpd * 0.3, enemyEffDef * 0.3);
					offensiveSpecialActivated = true;
				}
				else if(this.hasExactly("Makings of a King")){
					dmgBoost += thisEffDef * 0.3;
					offensiveSpecialActivated = true;
				}
				else if(this.hasExactly("Sturdy Beast")){
					if(this.transform == true){
						dmgBoost += thisEffDef * 0.5;
					}
					else{
						dmgBoost += thisEffDef * 0.4;
					}
					offensiveSpecialActivated = true;
				}
				else if(this.hasExactly("Nimble Beast")){
					if(this.transform == true){
						dmgBoost += thisEffSpd * 0.5;
					}
					else{
						dmgBoost += thisEffSpd * 0.4;
					}
					offensiveSpecialActivated = true;
				}
				else if(this.hasExactly("Brutal Shell+")){
					dmgBoost += Math.max(enemyEffDef * 0.5, thisEffDef * 0.5);
					offensiveSpecialActivated = true;
				}
				else if(this.hasExactly("Haze Slice")){
					dmgBoost += thisEffAtk * 0.35;
					offensiveSpecialActivated = true;
				}
				else if(this.hasExactly("Twin Strike")){
					dmgBoost += thisEffSpd * 0.6;
					offensiveSpecialActivated = true;
				}
			}

			if(offensiveSpecialActivated){
				//Solar Brace check
				if(this.hasExactly("Solar Brace")){
					absorbPct += 0.3;
				}
				this.resetCharge();
				damageText += this.name + " activates " + data.skills[this.specialIndex].name + ". ";
				if(this.hasExactly("Supreme Astra") && this.onceTurn == false){
					this.charge++;
					this.onceTurn = true;
				}
				if(this.hasExactly("Ylisse Ninja Bow") && (this.initiator || this.buddy.adjacent > 0 || this.buddy.two > 0) && this.onceTurn == false){
					this.charge++;
					this.onceTurn = true;
				}

				if(this.has("Wo Dao") || this.hasExactly("Dark Excalibur") || this.hasExactly("Resolute Blade") || (this.hasExactly("Hauteclere") && this.rValue == 5) || this.has("Giant Spoon") || this.has("Lethal Carrot") || (this.hasExactly("Nameless Blade") && this.rValue == 5) || this.has("Harmonic Lance") || this.has("Wo Gun") || (this.hasExactly("Shanna's Lance") && this.rValue == 5) || this.has("Short Bow") || (this.hasExactly("Selena's Blade") && this.rValue == 5) || this.hasExactly("Concealed Blade") || (this.hasExactly("Moonless Breath") && this.rValue > 0 && this.buddy.adjacent + this.buddy.two + this.buddy.three > 0) || (this.hasExactly("Springing Spear") && this.buddy.rorc > 0)){
					flatBoost += 10;
					damageText += this.name + " gains 10 damage from weapon. ";
				}
				//Vassal's Blade/Giga Excalibur/Raven King Beak/Red-Hot Ducks Mechanic
				if((this.hasExactly("Vassal's Blade") && this.rValue < 0) || (this.hasExactly("Giga Excalibur") && this.rValue < 0) || (this.hasExactly("Raven King Beak") && this.rValue < 0) || this.has("Red-Hot Ducks") || (this.hasExactly("Resolute Blade") && this.rValue == 5) || this.has("Guardian Fang") || (this.hasExactly("Refreshed Fang") && enemy.combatStartHp / enemy.maxHp >= 0.75)){
					var thisPhantomSpd = this.getPhantom("Spd") + thisEffSpd;
					var enemyPhantomSpd = enemy.getPhantom("Spd") + enemyEffSpd;
					var spdDmg = 0;
					if(thisPhantomSpd > enemyPhantomSpd){
						spdDmg = ((thisPhantomSpd - enemyPhantomSpd) * 0.7 | 0);
						spdDmg = Math.min(spdDmg,7);
						flatBoost += spdDmg;
						damageText += this.name + " gains " + spdDmg + " damage from weapon. ";
					}
				}
				//Light Brand/Shining Bow Mechanic
				else if((this.hasExactly("Light Brand") || this.has("Shining Bow") || this.hasExactly("Niles's Bow") || this.hasExactly("Spy-Song Bow")) && enemyEffDef >= enemyEffRes + 5){
					flatBoost += 7;
					damageText += this.name + " gains 7 damage from weapon. ";
				}
				//Luna Arc
				else if(this.hasExactly("Luna Arc") && (this.initiator || (this.rValue > 0 && this.toggle.weapon == 1))){
					var lunaDmg = Math.floor(enemyEffDef * 0.25);
					flatBoost += lunaDmg;
					damageText += this.name + " gains " + lunaDmg + " damage from Luna Arc. ";
				}
				//Astra Blade/Vengeful Lance
				else if((this.hasExactly("Astra Blade") || (this.hasExactly("Vengeful Lance") && this.toggle.weapon == 1 && !thisFollowUp)) && thisEffAtk > enemyEffDef){
					var abDmg = Math.floor((thisEffAtk - enemyEffDef) * 0.5);
					flatBoost += abDmg;
					damageText += this.name + " gains " + abDmg + " damage from " + data.skills[this.weaponIndex].name + ". ";
				}
				else if((this.hasExactly("Golden Naginata") && this.rValue == 5 && this.combatStartHp / this.maxHp >= 0.7) || (this.hasExactly("Stoutheart Lance") && this.combatStartHp / this.maxHp >= 0.75) || (this.hasExactly("Just Bow") && (this.initiator || this.buddy.rorc > 0))){
					flatBoost += 7;
					damageText += this.name + " gains 7 damage from " + data.skills[this.weaponIndex].name + ". ";
				}
				else if(this.hasExactly("Saintly Seraphim") && (this.initiator || (this.rValue > 0 && this.toggle.weapon > 0))){
					var saintDmg = Math.floor(enemyEffRes * 0.25);
					flatBoost += saintDmg;
					damageText += this.name + " gains " + saintDmg + " damage from Saintly Seraphim. ";
				}
				//New Foxkit Fang
				else if(this.has("New Foxkit Fang") && thisEffRes + this.getPhantom("Res") > enemyEffRes + enemy.getPhantom("Res")){
					var resDmg = ((thisEffRes + this.getPhantom("Res") - enemyEffRes - enemy.getPhantom("Res")) * 0.7 | 0);
					resDmg = Math.min(resDmg,7);
					flatBoost += resDmg;
					damageText += this.name + " gains " + resDmg + " damage from New Foxkit Fang. ";
				}
				//Candied Dagger
				else if(this.hasExactly("Candied Dagger")){
					if(this.initiator){
						var candyDmg = Math.floor(thisEffSpd * 0.1);
						flatBoost += candyDmg;
						damageText += this.name + " gains " + candyDmg + " damage from initiating with Candied Dagger. ";
					}
					//Refined
					if(this.rValue == 5 && enemy.combatStartHp / enemy.maxHp >= 1){
						flatBoost += 7;
						damageText += this.name + " gains 7 damage from Candied Dagger. ";
					}
				}
				else if(this.hasExactly("Levin Dagger") && (enemy.checkBonPen(3,this,turn) || (this.rValue > 0 && this.checkBonPen(1,enemy,turn)))){
					var levinDmg = Math.floor(thisEffRes * 0.2);
					flatBoost += levinDmg;
					damageText += this.name + " gains " + levinDmg + " damage from Levin Dagger. ";
				}
				else if(this.hasExactly("Resolved Fang") && (enemy.combatStartHp / enemy.maxHp >= 0.75 || (this.rValue > 0 && !this.initiator))){
					if(this.rValue < 0){
						var defDmg = 0;
						if(thisEffDef > enemyEffDef){
							defDmg = ((thisEffDef - enemyEffDef) * 0.7 | 0);
							defDmg = Math.min(defDmg,7);
							flatBoost += defDmg;
							damageText += this.name + " gains " + defDmg + " damage from Resolved Fang. ";
						}
					}
					else{
						var extraDmg = Math.floor(thisEffDef * 0.2);
						flatBoost += extraDmg;
						damageText += this.name + " gains " + extraDmg + " damage from Resolved Fang. ";
					}
				}
				else if((this.hasExactly("Giga Excalibur") && this.rValue > 0) || (this.hasExactly("Hades O") && this.rValue == 5 && (this.initiator || enemy.range == "ranged")) || (this.hasExactly("The Inexhaustible") && (this.initiator || this.checkBonPen(1,enemy,turn))) || (this.hasExactly("Ice-Tribe Axe") && (this.initiator || this.toggle.weapon == 1)) || (this.hasExactly("Full Rabbit Fang") && (this.transform == true || this.toggle.weapon > 1)) || ((this.hasExactly("Snowman Staff") || this.hasExactly("Swirling Lance") || (this.hasExactly("Joker's Wild") && this.rValue > 0) || (this.hasExactly("Silesse Frost") && this.rValue == 5)) && this.buddy.adjacent + this.buddy.two + this.buddy.three > 0) || (this.hasExactly("Laconic Axe") && (this.initiator || this.buddy.rorc > 0))){
					var spdDmg = Math.floor(thisEffSpd * 0.2);
					flatBoost += spdDmg;
					damageText += this.name + " gains " + spdDmg + " damage from " + data.skills[this.weaponIndex].name + ". ";
				}
				//Luin and Rose-Quartz Bow
				else if((this.hasExactly("Rose-Quartz Bow") || this.hasExactly("Celestial Globe") || this.hasExactly("Abyssal Blade") || this.hasExactly("The Cycle's Turn")) && (this.initiator || this.toggle.weapon == 1)){
					var spdDmg = Math.floor(thisEffSpd * 0.2);
					flatBoost += spdDmg;
					damageText += this.name + " gains " + spdDmg + " damage from " + data.skills[this.weaponIndex].name + ". ";
				}
				else if((this.hasExactly("Wildflower Edge") || this.hasExactly("Caring Magic") || this.hasExactly("Snaking Sword") || ((this.hasExactly("Starpoint Lance") || this.hasExactly("Thunderbrand") || this.hasExactly("Sparking Tome")) && this.rValue == 5) || (this.hasExactly("Grafcalibur") && this.rValue > 0) || this.hasExactly("Luin") || this.hasExactly("Azure Twin Edge")) && (this.initiator || this.buddy.adjacent > 0 || this.buddy.two > 0)){
					var spdDmg = Math.floor(thisEffSpd * 0.2);
					if(this.hasExactly("Luin") && this.rValue > 0){
						spdDmg += Math.floor(thisEffSpd * 0.2);
					}
					flatBoost += spdDmg;
					damageText += this.name + " gains " + spdDmg + " damage from " + data.skills[this.weaponIndex].name + ". ";
				}
				//Shamshir
				else if(this.hasExactly("Shamshir")){
					flatBoost += 7;
					damageText += this.name + " gains 7 damage from Shamshir. ";
				}
				//Blade of Renais
				else if(this.hasExactly("Blade of Renais") && (this.initiator || this.toggle.weapon > 1) && (this.toggle.weapon % 2 == 1 || checkAllBuffs(this, enemy, turn))){
					var renaisDmg = Math.floor(enemyEffDef * 0.2);
					flatBoost += renaisDmg;
					damageText += this.name + " gains " + renaisDmg + " damage from Blade of Renais. ";
				}
				else if(this.hasExactly("Bow of Frelia") && this.combatStartHp / this.maxHp >= 0.25){
					var bfVal = 7;
					if(this.rValue > 0){
						bfVal = 15;
					}
					flatBoost += bfVal;
					damageText += this.name + " gains " + bfVal + " damage from Bow of Frelia. ";
				}
				else if((this.hasExactly("Vassal's Blade") || this.hasExactly("Mirage Longbow")) && this.rValue > 0 && (this.initiator || this.buddy.adjacent > 0 || this.buddy.two > 0)){
					var spdDmg = Math.floor(thisEffSpd * 0.15);
					flatBoost += spdDmg;
					damageText += this.name + " gains " + spdDmg + " damage from " + data.skills[this.weaponIndex].name + ". ";
				}
				else if((this.hasExactly("Fair-Fury Axe") && (this.initiator || this.toggle.weapon == 1)) || ((this.hasExactly("Arcane Giant Axe") || this.hasExactly("Arcane Fell Arts")) && (!this.initiator || this.combatStartHp / this.maxHp >= 0.25))){
					var atkDmg = Math.floor(thisEffAtk * 0.15);
					flatBoost += atkDmg;
					damageText += this.name + " gains " + atkDmg + " damage from " + data.skills[this.weaponIndex].name + ". ";
				}
				//Refined Dark Mystletainn
				else if(this.hasExactly("Dark Mystletainn") && this.rValue == 5 && (enemy.combatStartHp / enemy.maxHp >= 0.75 || !this.initiator)){
					flatBoost += 7;
					damageText += this.name + " gains 7 damage from Dark Mystletainn. ";
				}
				//Refined Swift Mulagir
				else if(this.hasExactly("Swift Mulagir") && this.rValue == 5 && (enemy.combatStartHp / enemy.maxHp >= 0.75 || this.initiator)){
					var spdDmg = Math.floor(thisEffSpd * 0.15);
					flatBoost += spdDmg;
					damageText += this.name + " gains " + spdDmg + " damage from Swift Mulagir ";
				}
				else if((this.hasExactly("Berserk Armads") || this.hasExactly("Tome Of Thoron") || (this.hasExactly("Devil Axe") && this.rValue == 5)) && this.hp/this.maxHp <= .75){
					flatBoost += 10;
					damageText += this.name + " gains 10 damage from weapon. ";
				}
				//Refined Missiletain
				else if(this.hasExactly("Missiletain") && this.rValue == 5 && this.toggle.weapon == 1){
					var repDmg = Math.min(30,this.maxHp-this.hp);
					flatBoost += repDmg;
					damageText += this.name + " gains " + repDmg + " damage from Missiletain. ";
				}
				else if(((this.hasExactly("Sagittae") && allStats[16] < allStats[20]) || (this.hasExactly("Kia Staff") && this.buddy.adjacent + this.buddy.two + this.buddy.three > 0)) && this.rValue > 0){
					var sagDmg = Math.floor(enemyEffAtk * 0.15);
					flatBoost += sagDmg;
					damageText += this.name + " gains " + sagDmg + " damage from " + data.skills[this.weaponIndex].name + ". ";
				}
				//Refined Kaze's Needle
				else if(this.hasExactly("Kaze's Needle") && this.rValue == 5 && this.combatStartHp / this.maxHp >= 0.25 && this.getPhantom("Spd") + thisEffSpd > enemy.getPhantom("Spd") + enemyEffSpd){
					flatBoost += 5;
					damageText += this.name + " gains 5 damage from Kaze's Needle. ";
				}
				//Ninja Training Weapons
				else if((this.has("Ninja Yumi") || this.has("Ninja Naginata") || this.has("Shuriken Cleaver")) && this.initiator && this.getPhantom("Spd") + thisEffSpd > enemy.getPhantom("Spd") + enemyEffSpd){
					var nDmg = Math.floor((this.getPhantom("Spd") + thisEffSpd - enemy.getPhantom("Spd") - enemyEffSpd) * 0.5);
					nDmg = Math.min(4,nDmg);
					flatBoost += nDmg;
					damageText += this.name + " gains " + nDmg + " damage from " + data.skills[this.weaponIndex].name + ". ";
				}
				else if(this.hasExactly("Ninjutsu Scrolls") && this.initiator && this.getPhantom("Spd") + thisEffSpd > enemy.getPhantom("Spd") + enemyEffSpd){
					var nDmg = Math.floor((this.getPhantom("Spd") + thisEffSpd - enemy.getPhantom("Spd") - enemyEffSpd) * 0.7);
					nDmg = Math.min(7,nDmg);
					flatBoost += nDmg;
					damageText += this.name + " gains " + nDmg + " damage from " + data.skills[this.weaponIndex].name + ". ";
				}
				//Inviolable Axe
				else if(this.hasExactly("Inviolable Axe") && (this.initiator || this.toggle.weapon == 1)){
					flatBoost += 7;
					damageText += this.name + " gains 7 damage from Inviolable Axe. ";
				}
				//Sparkling Fang
				else if(this.hasExactly("Sparkling Fang") && enemy.combatStartHp / enemy.maxHp >= 0.75 && this.getPhantom("Spd") + thisEffSpd > enemy.getPhantom("Spd") + enemyEffSpd){
					flatBoost += 5;
					damageText += this.name + " gains 5 damage from Sparkling Fang. ";
				}
				//Polished Fang
				else if(this.hasExactly("Polished Fang") && enemy.combatStartHp / enemy.maxHp >= 0.75 && thisEffDef > enemyEffDef){
					flatBoost += 5;
					damageText += this.name + " gains 5 damage from Polished Fang. ";
				}
				//Ancient Codex
				else if(this.hasExactly("Ancient Codex") && this.toggle.weapon == 1){
					rDmg = Math.max(thisEffRes, enemyEffRes);
					rDmg = Math.floor(rDmg * 0.2);
					flatBoost += rDmg;
					damageText += this.name + " gains " + rDmg + " damage from " + data.skills[this.weaponIndex].name + ". ";
				}
				else if(((this.hasExactly("Blade of Jehanna") && this.toggle.weapon == 0) || this.hasExactly("Firelight Lance") || this.hasExactly("Ancient Majesty") || (this.hasExactly("Exotic Fruit Juice") && this.rValue > 0) || (this.hasExactly("Plegian War Axe") && this.rValue == 5)) && this.combatStartHp / this.maxHp >= 0.25){
					var blaDmg = Math.floor(enemyEffAtk * 0.15);
					flatBoost += blaDmg;
					damageText += this.name + " gains " + blaDmg + " damage from " + data.skills[this.weaponIndex].name + ". ";
				}
				else if(this.hasExactly("Summer's Breath") && this.rValue == 5 && this.toggle.weapon == 1 && this.specialIndex != -1){
					var extraDmg = data.skills[this.specialIndex].charge - this.initSkillCharge();
					extraDmg = Math.floor(enemyEffRes * (extraDmg * 0.1 + 0.2));
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from Summer's Breath. ";
				}
				else if((((this.hasExactly("Dryblade Lance") || this.hasExactly("Heired Forseti")) && this.combatStartHp / this.maxHp >= 0.25) || (this.hasExactly("Sisterly War Axe") && (this.initiator || this.toggle.weapon == 1))) && this.specialIndex != -1){
					var extraDmg = data.skills[this.specialIndex].charge - this.initSkillCharge();
					extraDmg = Math.floor(thisEffSpd * (extraDmg * 0.1 + 0.2));
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from " + data.skills[this.weaponIndex].name + ". ";
				}
				else if((this.hasExactly("Book of Dreams") || this.hasExactly("Whitedown Spear") || this.hasExactly("Hallowed Tyrfing") || this.hasExactly("Sky-Pirate Claw")) && this.rValue == 5 && this.combatStartHp / this.maxHp >= 0.25){
					var extraDmg = Math.floor(thisEffAtk * 0.15);
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from " + data.skills[this.weaponIndex].name + ". ";
				}
				else if(this.hasExactly("Hurricane Dagger") && this.rValue == 5 && this.combatStartHp / this.maxHp >= 0.25 && this.getPhantom("Spd") + thisEffSpd > enemy.getPhantom("Spd") + enemyEffSpd){
					flatBoost += 5;
					damageText += this.name + " gains 5 damage from Hurricane Dagger. ";
				}
				else if(((this.hasExactly("Pastel Poleaxe") || ((this.hasExactly("Gate-Anchor Axe") || this.hasExactly("Auto-Lofnheidr") || this.hasExactly("Obsidian Lance")) && this.rValue == 5) || this.hasExactly("Ancient Voice")) && this.combatStartHp / this.maxHp >= 0.25) || (this.hasExactly("Illuminating Horn") && (this.initiator || this.toggle.weapon == 1)) || (this.hasExactly("Moon Gradivus") && this.rValue == 5 && this.toggle.weapon == 1) || this.hasExactly("Wyvern Ono") || ((this.hasExactly("Crimson Lance") || this.hasExactly("Horn of Opening")) && this.rValue == 5 && (!this.initiator || enemy.combatStartHp / enemy.maxHp >= 0.75)) || ((this.hasExactly("Horn of Harvest") || this.hasExactly("Fell Slaystone")) && (!this.initiator || enemy.combatStartHp / enemy.maxHp >= 0.75)) || (this.hasExactly("Proud Spear") && (this.initiator || enemy.combatStartHp / enemy.maxHp >= 0.75))){
					var extraDmg = Math.floor(thisEffDef * 0.2);
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from " + data.skills[this.weaponIndex].name + ". ";
				}
				else if((this.has("Carrot-Tip Bow") || this.has("Carrot-Tip Spear")) && (enemy.combatStartHp / enemy.maxHp >= 0.75 || this.toggle.weapon == 1) && firstHit){
					var extraDmg = -Math.min(enemy.debuffs.atk,enemy.combatDebuffs.atk) - Math.min(enemy.debuffs.def,enemy.combatDebuffs.def)
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from " + data.skills[this.weaponIndex].name + ". ";
				}
				else if(this.hasExactly("Azure Lance") && (this.initiator || this.toggle.weapon == 1 || this.toggle.weapon == 3)){
					flatBoost += 7;
					damageText += this.name + " gains 7 damage from Azure Lance. ";
				}
				else if(this.hasExactly("Quick Mulagir") && this.rValue == 5 && this.combatStartHp / this.maxHp >= 0.25 && firstHit){
					var extraDmg = Math.floor(thisEffSpd * 0.15);
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from Quick Mulagir. ";
				}
				else if(this.hasExactly("Sylgr") && this.rValue > 0 && (thisEffSpd + this.getPhantom("Spd") > enemyEffSpd + enemy.getPhantom("Spd") || enemy.combatStartHp / enemy.maxHp >= 0.75)){
					var spdDmg = Math.floor(thisEffSpd * 0.15);
					flatBoost += spdDmg;
					damageText += this.name + " gains " + spdDmg + " damage from Sylgr. ";
				}
				else if(this.hasExactly("Large War Axe") && turn % 2 == 1 && firstHit){
					var atkDmg = Math.floor(thisEffAtk * 0.15);
					flatBoost += atkDmg;
					damageText += this.name + " gains " + atkDmg + " damage from Large War Axe. ";
				}
				else if(this.hasExactly("Thunderer Tome") && (this.combatStartHp / this.maxHp < 1 || turn < 4)){
					flatBoost += 7;
					damageText += this.name + " gains 7 damage from Thunderer Tome. ";
				}
				else if(this.hasExactly("Ruinous Frost") && (!this.initiator || enemy.combatStartHp / enemy.maxHp >= 0.75) && firstHit){
					var extraDmg = Math.floor(enemyEffRes * 0.4);
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from Ruinous Frost. ";
				}
				else if(this.hasExactly("Fell Breath") && this.rValue == 5 && (this.initiator || this.toggle.weapon == 1) && firstHit && thisEffAtk > enemyEffRes + enemy.getPhantom("Res")){
					var fbDmg = Math.floor((thisEffAtk - enemyEffRes) * 0.3);
					flatBoost += fbDmg;
					damageText += this.name + " gains " + fbDmg + " damage from Fell Breath. ";
				}
				else if(this.hasExactly("True-Love Roses") && (this.initiator || this.toggle.weapon == 1)){
					var extraDmg = Math.floor(thisEffRes * 0.1);
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from True-Love Roses. ";
				}
				else if(this.hasExactly("Raven King Beak") && this.rValue > 0 && (this.initiator || enemy.combatStartHp / enemy.maxHp >= 0.75)){
					var spdDmg = Math.floor(thisEffSpd * 0.15);
					flatBoost += spdDmg;
					damageText += this.name + " gains " + spdDmg + " damage from Raven King Beak. ";
				}
				else if(this.has("Covert Cat Fang") && this.rValue == 5 && this.combatStartHp / this.maxHp >= 0.25 && this.toggle.weapon > 0){
					var extraDmg = this.toggle.weapon * 5;
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from Covert Cat Fang. ";
				}
				else if(this.hasExactly("New-Height Bow") && this.toggle.weapon == 1){
					var spdDmg = Math.floor(thisEffSpd * 0.15);
					flatBoost += spdDmg;
					damageText += this.name + " gains " + spdDmg + " damage from New-Height Bow. ";
				}
				else if(this.has("Taguel Fang") && this.rValue == 5 && this.combatStartHp / this.maxHp >= 0.25 && thisEffSpd + this.getPhantom("Spd") - enemyEffSpd - enemy.getPhantom("Spd") >= 5){
					flatBoost += 7;
					damageText += this.name + " gains 7 damage from Taguel Fang. ";
				}
				else if((this.hasExactly("Mila's Testament") || (this.hasExactly("Meisterbogen") && this.rValue == 5)) && (this.initiator || this.toggle.weapon == 1)){
					var eaDmg = Math.floor(enemyEffAtk * 0.1);
					flatBoost += eaDmg;
					damageText += this.name + " gains " + eaDmg + " damage from " + data.skills[this.weaponIndex].name + ". ";
				}
				else if((this.hasExactly("Tri-Edge Lance") || this.hasExactly("Gentle Fell Egg")) && (this.initiator || this.buddy.adjacent > 0 || this.buddy.two > 0)){
					var extraDmg = Math.floor(thisEffRes * 0.2);
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from " + data.skills[this.weaponIndex].name + ". ";
				}
				else if(this.hasExactly("Divine Breath") && this.rValue == 5 && this.toggle.weapon > 0 && firstHit && thisEffAtk > enemyEffRes + enemy.getPhantom("Res")){
					var dbDmg = Math.floor((thisEffAtk - enemyEffRes) * 0.25);
					flatBoost += dbDmg;
					damageText += this.name + " gains " + dbDmg + " damage from Divine Breath. ";
				}
				else if(this.hasExactly("Freikugel") && this.toggle.weapon == 1 && this.rValue > 0){
					var spdDmg = Math.floor(thisEffSpd * 0.1);
					flatBoost += spdDmg;
					damageText += this.name + " gains " + spdDmg + " damage from Freikugel. ";
				}
				else if(this.hasExactly("Lofty Leaflet") && enemy.combatStartHp / enemy.maxHp >= 0.5){
					var spdDmg = Math.floor(thisEffSpd * 0.15);
					flatBoost += spdDmg;
					damageText += this.name + " gains " + spdDmg + " damage from Lofty Leaflet. ";
				}
				else if(this.hasExactly("Shadowy Quill") && (this.initiator || this.toggle.weapon == 1)){
					var shadowDmg = [0,0,0,0];
					var nCheck = this.checkNegate(enemy,turn);
					for(var i = 0; i < 4; i++){
						if(allStats[14][i] == false){
							shadowDmg[i] = Math.max(this.buffs[data.buffStats[i]],this.combatBuffs[data.buffStats[i]]);
						}
						if(nCheck[i] == false){
							var negDmg = -Math.min(enemy.debuffs[data.buffStats[i]],enemy.combatDebuffs[data.buffStats[i]]);
							shadowDmg[i] = Math.max(shadowDmg[i],negDmg);
						}
					}
					var qDmg = shadowDmg[0] + shadowDmg[1] + shadowDmg[2] + shadowDmg[3];
					flatBoost += qDmg;
					damageText += this.name + " gains " + qDmg + " damage from Shadowy Quill. ";
				}
				else if(this.hasExactly("Holytide Tyrfing") && this.buddy.spaces > 0){
					var extraDmg = Math.floor(enemyEffDef * 0.1 * Math.min(this.buddy.spaces,4));
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from Holytide Tyrfing. ";
				}
				else if(this.hasExactly("Fuming Freikugel") && this.toggle.weapon == 1 && this.specialIndex != -1){
					var extraDmg = data.skills[this.specialIndex].charge - this.initSkillCharge();
					extraDmg = Math.floor(thisEffSpd * (extraDmg * 0.1 + 0.2));
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from Fuming Freikugel. ";
				}
				else if(this.has("Brazen Cat Fang") && this.rValue > 0 && (this.initiator || this.toggle.weapon == 1)){
					flatBoost += 10;
					damageText += this.name + " gains 10 damage from Brazen Cat Fang. ";
				}
				else if(this.has("Bunny Fang") && this.rValue == 5 && enemy.combatStartHp / enemy.maxHp >= 0.5){
					var spdDmg = Math.floor(thisEffSpd * 0.1);
					flatBoost += spdDmg;
					damageText += this.name + " gains " + spdDmg + " damage from Bunny Fang. ";
				}
				else if((this.hasExactly("Arcane Grima") || this.hasExactly("Knightly Manner") || this.hasExactly("Arcane Euphoria") || this.hasExactly("Diva-Pair Parasol") || this.hasExactly("Arcane Blutgang") || this.hasExactly("Arcane Truthfire") || (this.hasExactly("War-God Mjolnir") && this.rValue > 0) || this.hasExactly("Arcane Sly Knife") || this.hasExactly("Arcane Medusa")) && this.combatStartHp / this.maxHp >= 0.25){
					var atkDmg = Math.floor(thisEffAtk * 0.15);
					flatBoost += atkDmg;
					damageText += this.name + " gains " + atkDmg + " damage from " + data.skills[this.weaponIndex].name + ". ";
				}
				else if(this.hasExactly("Rite of Souls") && (this.initiator || this.toggle.weapon > 1)){
					var extraDmg = Math.floor(thisEffRes * 0.2);
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from Rite of Souls. ";
				}
				else if(this.hasExactly("Ardent Durandal") && this.rValue == 5 && (this.initiator || this.toggle.weapon == 1)){
					var extraDmg = Math.floor(enemyEffDef * 0.15);
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from Ardent Durandal. ";
				}
				else if((this.hasExactly("Snide Bow") || (this.hasExactly("Inner Wellspring") && this.rValue == 5)) && this.combatStartHp / this.maxHp >= 0.25){
					flatBoost += 7;
					damageText += this.name + " gains 7 damage from " + data.skills[this.weaponIndex].name + ". ";
				}
				else if(this.hasExactly("Savage Breath") && this.rValue == 5 && this.combatStartHp / this.maxHp >= 0.25 && thisEffAtk > enemyEffRes+enemy.getPhantom("Res") && firstHit && this.toggle.weapon > -1 && this.toggle.weapon < 3){
					var sbDmg = Math.floor((thisEffAtk - enemyEffRes+enemy.getPhantom("Res")) * (0.3 - (this.toggle.weapon * 0.1)));
					flatBoost += sbDmg;
					damageText += this.name + " gains " + sbDmg + " damage from Savage Breath. ";
				}
				else if(this.hasExactly("Seidr") && (this.initiator || this.toggle.weapon == 1)){
					var extraDmg = Math.floor(thisEffRes * 0.2);
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from Seidr. ";
				}
				else if(this.hasExactly("Fang of Finality") && (this.initiator || this.toggle.weapon > 9)){
					var sVar = this.toggle.weapon;
					if(sVar > 9){
						sVar = sVar - 10;
					}
					sVar = (sVar + 1) * 0.1;
					var extraDmg = Math.floor(thisEffSpd * sVar);
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from Fang of Finality. ";
				}
				else if(this.hasExactly("Joyous Tome") && this.toggle.weapon > 0){
					var extraDmg = this.toggle.weapon * 5;
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from Joyous Tome. ";
				}
				else if((this.hasExactly("Dreaming Spear") && this.toggle.weapon == 1) || ((this.hasExactly("Radiant Aureola") || ((this.hasExactly("Banshee TH") || this.hasExactly("Dazzling Breath") || this.hasExactly("Indignant Bow")) && this.rValue > 0) || this.hasExactly("Dark Monograph")) && (!this.initiator || enemy.combatStartHp / enemy.maxHp >= 0.75))){
					var extraDmg = Math.floor(thisEffRes * 0.2);
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from " + data.skills[this.weaponIndex].name + ". ";
				}
				else if((this.hasExactly("Monarch Blade") || ((this.hasExactly("Prized Lance") || this.hasExactly("Larcei's Edge") || this.hasExactly("Apotheosis Spear")) && this.rValue == 5)) && this.combatStartHp / this.maxHp >= 0.25){
					var spdDmg = Math.floor(thisEffSpd * 0.15);
					flatBoost += spdDmg;
					damageText += this.name + " gains " + spdDmg + " damage from " + data.skills[this.weaponIndex].name + ". ";
				}
				else if(((this.hasExactly("Noble Lance") && (this.initiator || enemy.combatStartHp / enemy.maxHp >= 0.75)) || (this.hasExactly("Tiger-Eye Axe") && (this.checkBonPen(1,enemy,turn) || enemy.checkBonPen(3,this.turn)))) && this.rValue == 5){
					var extraDmg = Math.floor(thisEffAtk * 0.1);
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from " + data.skills[this.weaponIndex].name + ". ";
				}
				else if(this.hasExactly("Duskbloom Bow") && (this.initiator || this.toggle.weapon > 1) && thisEffRes + this.getPhantom("Res") - enemyEffRes - enemy.getPhantom("Res") >= 4){
					var extraDmg = Math.floor(thisEffRes * 0.2);
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from Duskbloom Bow. ";
				}
				else if((this.has("Petalfall Blade") || this.has("Petalfall Vase") || this.has("Null Blade") || this.has("Null Spear")) && this.combatStartHp / this.maxHp >= 0.25 && thisEffSpd + this.getPhantom("Spd") > enemyEffSpd + enemy.getPhantom("Spd")){
					flatBoost += 5;
					damageText += this.name + " gains 5 damage from " + data.skills[this.weaponIndex].name + ". ";
				}
				else if((this.hasExactly("Queensblade") || this.hasExactly("Arcane Luin") || this.hasExactly("Fujin-Raijin Yumi") || this.hasExactly("Teatime's Edge") || this.hasExactly("Aptitude Arrows") || ((this.hasExactly("Phantasm Tome") || this.hasExactly("Lyngheidr") || this.hasExactly("Spear of Shadow") || this.hasExactly("Blade of Shadow") || this.hasExactly("Professorial Guide") || this.hasExactly("Talregan Axe") || this.hasExactly("Survivalist Bow") || this.hasExactly("Tome of Storms") || this.hasExactly("Aerial Longsword") || this.hasExactly("Tailwind Shuriken")) && this.rValue == 5) || this.hasExactly("Flower of Tribute") || this.hasExactly("Monarch's Stone") || this.hasExactly("Sky-Hopper Egg") || this.hasExactly("Dead-Crow Tome") || this.hasExactly("Closing Florets") || this.hasExactly("United Bouquet") || this.hasExactly("Thief's Honesty") || this.hasExactly("Nidavellir Ballista") || this.hasExactly("Dvergr Wayfinder") || this.hasExactly("Red-Fist Blades") || this.hasExactly("Hidden Blade") || this.hasExactly("Petaldream Horn") || this.hasExactly("Baton of Dusk") || this.hasExactly("Ancient Trickery")) && this.combatStartHp / this.maxHp >= 0.25){
					var extraDmg = Math.floor(thisEffSpd * 0.2);
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from " + data.skills[this.weaponIndex].name + ". ";
				}
				else if(this.hasExactly("Imbued Koma") && this.rValue == 5 && this.toggle.weapon == 1){
					var extraDmg = Math.floor(thisEffDef * 0.15);
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from Imbued Koma. ";
				}
				else if(this.hasExactly("Victorious Axe") && this.rValue == 5 && (this.initiator || this.toggle.weapon > 1)){
					var extraDmg = Math.floor(thisEffAtk * 0.1);
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from Victorious Axe. ";
				}
				else if(this.hasExactly("Gusty War Bow") && this.toggle.weapon > 1){
					flatBoost += 7;
					damageText += this.name + " gains 7 damage from Gusty War Bow. ";
				}
				else if(this.hasExactly("Asclepius") && this.combatStartHp / this.maxHp >= 0.25){
					var asDmg = 0;
					var nCheck = this.checkNegate(enemy,turn);
					for(var i = 0; i < 4; i++){
						if(nCheck[i] == false){
							asDmg += -Math.min(enemy.debuffs[data.buffStats[i]],enemy.combatDebuffs[data.buffStats[i]]);
						}
					}
					flatBoost += asDmg;
					damageText += this.name + " gains " + asDmg + " damage from Asclepius. ";
				}
				else if(((this.hasExactly("Freeblade's Edge") && this.rValue == 5) || this.hasExactly("Heired Gungnir")) && this.combatStartHp / this.maxHp >= 0.25){
					var extraDmg = Math.floor(thisEffDef * 0.15);
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from " + data.skills[this.weaponIndex].name + ". ";
				}
				else if(this.hasExactly("Sokkvabekkr") && this.rValue > 0 && this.toggle.weapon == 1){
					flatBoost += 5;
					damageText += this.name + " gains 5 damage from Sokkvabekkr. ";
				}
				else if(this.hasExactly("Aymr") && this.rValue == 5 && (this.toggle.weapon == 1 || enemy.combatStartHp / enemy.maxHp >= 0.75)){
					var extraDmg = Math.floor(thisEffAtk * 0.15);
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from Aymr. ";
				}
				else if((this.hasExactly("Silent Breath") || (this.hasExactly("Brutal Breath") && this.rValue == 5)) && (!this.initiator || enemy.combatStartHp / enemy.maxHp >= 0.75)){
					var extraDmg = Math.floor(thisEffSpd * 0.2);
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from " + data.skills[this.weaponIndex].name + ". ";
				}
				else if((this.hasExactly("Dead-Fang Axe") || this.hasExactly("Spear")) && this.combatStartHp / this.maxHp >= 0.25){
					var extraDmg = Math.floor(thisEffAtk * 0.1);
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from " + data.skills[this.weaponIndex].name + ". ";
				}
				else if((this.hasExactly("Heartbroker Bow") || (this.hasExactly("Brilliant Rapier") && this.rValue == 5) || this.has("Dragonbloom") || this.has("Harp Bow")) && (this.initiator || this.buddy.adjacent > 0 || this.buddy.two > 0)){
					var extraDmg = Math.floor(thisEffSpd * 0.15);
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from " + data.skills[this.weaponIndex].name + ". ";
				}
				else if((((this.hasExactly("Guardian's Bow") || this.hasExactly("Mareeta's Sword")) && this.rValue == 5) || this.hasExactly("Violdrake Bow")) && this.combatStartHp / this.maxHp >= 0.25){
					var spdDmg = Math.floor(thisEffSpd * 0.1);
					flatBoost += spdDmg;
					damageText += this.name + " gains " + spdDmg + " damage from " + data.skills[this.weaponIndex].name + ". ";
				}
				else if((this.hasExactly("Ilian Merc Lance") && this.toggle.weapon > 1) || (this.hasExactly("Salvage") && (this.initiator || this.buddy.adjacent > 0 || this.buddy.two > 0))){
					var blaDmg = Math.floor(enemyEffAtk * 0.15);
					flatBoost += blaDmg;
					damageText += this.name + " gains " + blaDmg + " damage from " + data.skills[this.weaponIndex].name + ". ";
				}
				else if(this.hasExactly("Heidr") && (this.initiator || this.toggle.weapon > 1)){
					var extraDmg = Math.floor(thisEffAtk * 0.15);
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from Heidr. ";
				}
				else if(this.hasExactly("Surfer's Spire") || this.hasExactly("Surfer's Spade")){
					var spdDmg = Math.floor(thisEffSpd * 0.2);
					flatBoost += spdDmg;
					damageText += this.name + " gains " + spdDmg + " damage from " + data.skills[this.weaponIndex].name + ". ";
				}
				else if(this.hasExactly("Father's-Son Axe") && this.rValue == 5 && (this.initiator || this.toggle.weapon == 1)){
					var extraDmg = Math.floor(this.combatStartHp * 0.15);
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from Father's-Son Axe. ";
				}
				else if(this.hasExactly("Void Tome") && this.rValue == 5 && allStats[20] >= 50){
					var extraDmg = Math.floor(allStats[20] * 0.15);
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from Void Tome. ";
				}
				else if(this.hasExactly("Divine Draught") && this.combatStartHp / this.maxHp >= 0.25 && this.toggle.weapon == 2 && this.initiator){
					var extraDmg = Math.max(thisEffAtk, enemyEffAtk) * 0.15;
					extraDmg = Math.floor(extraDmg);
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from Divine Draught. ";
				}
				else if((this.hasExactly("Fair-Fight Blade") && this.combatStartHp / this.maxHp >= 0.25) || (this.hasExactly("Bold Kusarigama") && (this.initiator || this.buddy.adjacent > 0 || this.buddy.two > 0))){
					var extraDmg = Math.floor(thisEffDef * 0.25);
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from " + data.skills[this.weaponIndex].name + ". ";
				}
				else if(this.hasExactly("Tome of Luxuries") && this.combatStartHp / this.maxHp >= 0.25){
					var extraDmg = Math.floor(thisEffRes * 0.15);
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from " + data.skills[this.weaponIndex].name + ". ";
				}
				else if(this.hasExactly("Arcane Nihility") && this.combatStartHp / this.maxHp >= 0.25){
					var extraDmg = Math.floor(thisEffSpd * 0.15);
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from Arcane Nihility. ";
				}
				else if(this.hasExactly("Virtuous Tyrfing") && this.rValue > 0 && (this.combatStartHp / this.maxHp < 1 || !this.initiator || enemy.combatStartHp / enemy.maxHp >= 0.75)){
					var extraDmg = Math.floor(thisEffAtk * 0.15);
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from Virtuous Tyrfing. ";
				}
				else if(this.hasExactly("Hel's Reaper") && this.rValue == 5 && (this.combatStartHp / this.maxHp >= 0.25 || this.toggle.weapon == 1)){
					var spdDmg = Math.floor(thisEffSpd * 0.2);
					flatBoost += spdDmg;
					damageText += this.name + " gains " + spdDmg + " damage from Hel's Reaper. ";
				}
				else if(this.hasExactly("Wildcat Dagger") && this.rValue == 5 && (this.initiator || enemy.combatStartHp / enemy.maxHp >= 0.75)){
					var extraDmg = Math.floor(thisEffSpd * 0.1);
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from Wildcat Dagger. ";
				}
				else if(this.hasExactly("Inspirited Spear") && this.combatStartHp / this.maxHp >= 0.25){
					var extraDmg = Math.floor(thisEffDef * 0.4);
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from Inspirited Spear. ";
				}
				else if(this.hasExactly("Obscurite") && (this.initiator || ((this.buddy.adjacent > 0 || this.buddy.two > 0) && this.toggle.weapon > 1))){
					var extraDmg = Math.floor(thisEffRes * 0.2);
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from Obscurite. ";
				}
				else if((this.hasExactly("Earthly Gae Bolg") && this.rValue > 0 && (enemy.moveType != "flying" || this.combatStartHp / this.maxHp >= 0.5)) || (this.hasExactly("Majestic Glitnir") && (this.initiator || this.buddy.rorc > 0))){
					var extraDmg = Math.floor(thisEffDef * 0.1);
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from " + data.skills[this.weaponIndex].name + ". ";
				}
				else if((this.hasExactly("Radiant Scrolls") && (this.initiator || this.buddy.adjacent > 0 || this.buddy.two > 0)) || (this.hasExactly("Petrify") && this.rValue == 5 && this.combatStartHp / this.maxHp >= 0.25)){
					var yVal = 0;
					var eNegate = this.checkNegate(enemy, turn);
					if(eNegate[0] == false){
						var aVal = Math.min(enemy.combatDebuffs.atk,enemy.debuffs.atk);
						if(enemy.penalty.panic){
							aVal -= Math.max(enemy.combatBuffs.atk,enemy.buffs.atk);
						}
						yVal += aVal;
					}
					if(eNegate[1] == false){
						var sVal = Math.min(enemy.combatDebuffs.spd,enemy.debuffs.spd);
						if(enemy.penalty.panic){
							sVal -= Math.max(enemy.combatBuffs.spd,enemy.buffs.spd);
						}
						yVal += sVal;
					}
					if(eNegate[2] == false){
						var dVal = Math.min(enemy.combatDebuffs.def,enemy.debuffs.def);
						if(enemy.penalty.panic){
							dVal -= Math.max(enemy.combatBuffs.def,enemy.buffs.def);
						}
						yVal += dVal;
					}
					if(eNegate[3] == false){
						var rVal = Math.min(enemy.combatDebuffs.res,enemy.debuffs.res);
						if(enemy.penalty.panic){
							rVal -= Math.max(enemy.combatBuffs.res,enemy.buffs.res);
						}
						yVal += rVal;
					}
					yVal = -Math.min(yVal,enemy.buddy.debuffs.atk + enemy.buddy.debuffs.spd + enemy.buddy.debuffs.def + enemy.buddy.debuffs.res);
					flatBoost += yVal;
					damageText += this.name + " gains " + yVal + " damage from " + data.skills[this.weaponIndex].name + ". ";
				}
				else if(this.hasExactly("Grimleal Text") && this.combatStartHp / this.maxHp >= 0.25){
					var extraDmg = (Object.values(enemy.penalty).reduce((a, item) => a + (item === true ? 1 : 0), 0) + enemy.penalty.extra) * 4;
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from Grimleal Text. ";
				}
				else if((this.hasExactly("Goddess Temari") && this.combatStartHp / this.maxHp >= 0.25 && (turn > 2 || this.toggle.weapon == 1)) || (this.hasExactly("Aureola") && this.rValue > 0 && (this.initiator || this.buddy.adjacent > 0 || this.buddy.two > 0))){
					var xVal = 0;
					if(!this.penalty.panic){
						xVal = Math.max(this.combatBuffs.atk,this.buffs.atk) + Math.max(this.combatBuffs.spd,this.buffs.spd) + Math.max(this.combatBuffs.def,this.buffs.def) + Math.max(this.combatBuffs.res,this.buffs.res);
					}
					xVal = Math.max(xVal,this.buddy.buffs.atk + this.buddy.buffs.spd + this.buddy.buffs.def + this.buddy.buffs.res);
					flatBoost += xVal;
					damageText += this.name + " gains " + xVal + " damage from " + data.skills[this.weaponIndex].name + ". ";
				}
				else if(this.hasExactly("Studied Forblaze") && this.rValue == 5 && (this.initiator || this.buddy.adjacent > 0 || this.buddy.two > 0)){
					var extraDmg = Math.floor(thisEffRes * 0.15);
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from " + data.skills[this.weaponIndex].name + ". ";
				}
				else if(((this.hasExactly("Mirage Rod") && this.rValue == 5) || this.hasExactly("Lucky Bow")) && (enemy.combatStartHp / enemy.maxHp >= 0.75 || !this.initiator)){
					var extraDmg = Math.floor(thisEffAtk * 0.15);
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from " + data.skills[this.weaponIndex].name + ". ";
				}
				else if(this.hasExactly("Winds of Change") && this.rValue > 0 && (this.combatStartHp / this.maxHp >= 0.5 || checkAllBuffs(this, enemy, turn) || Object.values(this.bonus).reduce((a, item) => a + (item === true ? 1 : 0), 0) + this.bonus.extra > 0)){
					var extraDmg = Math.floor(thisEffSpd * 0.15);
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from " + data.skills[this.weaponIndex].name + ". ";
				}
				else if(this.hasExactly("Constant Dagger") && this.rValue > 0 && (this.initiator || this.buddy.adjacent > 0 || this.buddy.two > 0)){
					var extraDmg = Math.floor(thisEffSpd * 0.1);
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from " + data.skills[this.weaponIndex].name + ". ";
				}
				else if(this.hasExactly("Thief") && this.combatStartHp / this.maxHp >= 0.25){
					var extraDmg = (Object.values(this.bonus).reduce((a, item) => a + (item === true ? 1 : 0), 0) + this.bonus.extra) * 5;
					extraDmg = Math.min(extraDmg,20);
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from Thief. ";
				}
				else if(this.hasExactly("Blade of Sands") && (this.initiator || this.buddy.adjacent > 0 || this.buddy.two > 0)){
					var extraDmg = Math.floor(thisEffSpd * 0.2);
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from " + data.skills[this.weaponIndex].name + ". ";
				}
				else if((this.has("Nabata Beacon") || this.has("Nabata Lance") || this.has("Snaking Bow") || this.has("Hexblade Sword") || (this.hasExactly("Skinfaxi") && this.rValue == 5)) && (this.initiator || this.buddy.adjacent > 0 || this.buddy.two > 0)){
					var extraDmg = Math.floor(thisEffAtk * 0.1);
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from " + data.skills[this.weaponIndex].name + ". ";
				}
				else if(this.hasExactly("Sandglass Bow") && (this.initiator || this.buddy.adjacent > 0 || this.buddy.two > 0)){
					var extraDmg = data.skills[this.specialIndex].charge - this.initSkillCharge();
					extraDmg = (Math.floor(thisEffSpd * (extraDmg * 0.1 + 0.1))) + Math.floor(thisEffAtk * 0.15);
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from " + data.skills[this.weaponIndex].name + ". ";
				}
				else if(this.hasExactly("Arcane Charmer") && this.combatStartHp / this.maxHp >= 0.25){
					flatBoost += 7;
					damageText += this.name + " gains 7 damage from " + data.skills[this.weaponIndex].name + ". ";
				}
				else if(this.hasExactly("Aurora Breath") && this.rValue == 5 && this.combatStartHp / this.maxHp >= 0.25 && firstHit){
					var extraDmg = Math.floor(enemyEffRes * 0.15);
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from Aurora Breath. ";
				}
				else if(this.hasExactly("Crusher") && this.rValue == 5 && (this.initiator || this.buddy.adjacent > 0 || this.buddy.two > 0) && (enemy.combatDebuffs.spd < 0 || enemy.debuffs.spd < 0 || enemy.combatDebuffs.def < 0 || enemy.debuffs.def < 0 || enemy.combatDebuffs.res < 0 || enemy.debuffs.res < 0 || (enemy.penalty.panic && (enemy.combatBuffs.spd > 0 || enemy.buffs.spd > 0 || enemy.combatBuffs.def > 0 || enemy.buffs.def > 0 || enemy.combatBuffs.res > 0 || enemy.buffs.res > 0)))){
					var extraDmg = Math.floor(thisEffAtk * 0.15);
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from Crusher. ";
				}
				else if((((this.hasExactly("Dark Scripture") || this.hasExactly("Craver's Tome") || this.hasExactly("New Dawn")) && this.rValue == 5) || this.hasExactly("Supreme Thokk") || this.hasExactly("New Year Treats") || this.hasExactly("Fimbulvetr Morn") || this.hasExactly("Tome of Fury") || this.hasExactly("Tome of Dusk") || this.hasExactly("Fundament")) && this.combatStartHp / this.maxHp >= 0.25){
					var extraDmg = Math.floor(thisEffRes * 0.2);
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from " + data.skills[this.weaponIndex].name + ". ";
				}
				else if(this.hasExactly("Astral Breath") && this.rValue == 5 && this.combatStartHp / this.maxHp >= 0.25){
					var xVal = 0;
					if(!this.penalty.panic){
						xVal = Math.max(this.combatBuffs.atk,this.buffs.atk) + Math.max(this.combatBuffs.spd,this.buffs.spd) + Math.max(this.combatBuffs.def,this.buffs.def) + Math.max(this.combatBuffs.res,this.buffs.res);
					}
					xVal = Math.max(xVal,this.buddy.buffs.atk + this.buddy.buffs.spd + this.buddy.buffs.def + this.buddy.buffs.res);
					flatBoost += xVal;
					damageText += this.name + " gains " + xVal + " damage from Astral Breath. ";
				}
				else if((this.hasExactly("Exalt's War Staff") || this.hasExactly("Staff of Yngvi") || (this.hasExactly("Staff of the Saint") && this.rValue > 0) || this.hasExactly("Prior's Tome")) && this.buddy.adjacent + this.buddy.two + this.buddy.three > 0){
					var extraDmg = Math.floor(thisEffRes * 0.2);
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from " + data.skills[this.weaponIndex].name + ". ";
				}
				else if(this.hasExactly("New War Axe") && this.buddy.adjacent + this.buddy.two + this.buddy.three > 0 && this.hp / this.maxHp >= 0.7){
					var extraDmg = Math.floor(thisEffDef * ((data.skills[this.specialIndex].charge - this.initSkillCharge()) * 10 + 10) / 100);
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from New War Axe. ";
				}
				else if(this.hasExactly("Heavy War Axe") && (this.initiator || this.buddy.adjacent > 0 || this.buddy.two > 0)){
					var extraDmg = Math.floor(thisEffDef * 0.2);
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from Heavy War Axe. ";
				}
				else if(this.hasExactly("Professorial Text") && this.rValue > 0 && (this.initiator || this.toggle.weapon > 0)){
					flatBoost += 7;
					damageText += this.name + " gains 7 damage from Professorial Text. ";
				}
				else if((this.hasExactly("Blood Tome") && this.rValue > 0 && (this.initiator || enemy.range == "ranged")) || (this.hasExactly("Blessed Aureola") && this.buddy.rorc > 0)){
					var extraDmg = Math.floor(thisEffRes * 0.2);
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from " + data.skills[this.weaponIndex].name + ". ";
				}
				else if(this.hasExactly("Ereshkigal") && this.combatStartHp / this.maxHp >= 0.25){
					var extraDmg = Math.min((Object.values(this.bonus).reduce((a, item) => a + (item === true ? 1 : 0), 0) + this.bonus.extra) * 5, 25);
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from Ereshkigal. ";
				}
				else if(this.hasExactly("Silver of Dawn") && this.combatStartHp / this.maxHp >= 0.25){
					var extraDmg = this.toggle.weapon * 5;
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from Silver of Dawn. ";
				}
				else if(this.hasExactly("Golden Sunlight") && (this.initiator || enemy.combatStartHp / enemy.maxHp >= 0.75)){
					var extraDmg = Math.floor(thisEffSpd * 0.2);
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from Golden Sunlight. ";
				}
				else if((this.hasExactly("Maritime Arts") || this.hasExactly("Wintery Arts")) && this.buddy.adjacent + this.buddy.two + this.buddy.three > 0){
					var extraDmg = 5 * this.toggle.weapon;
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from " + data.skills[this.weaponIndex].name + ". ";
				}
				else if(this.hasExactly("Wild Wind Sword") && this.combatStartHp / this.maxHp >= 0.25){
					var extraDmg = Math.floor(this.combineBonPen(enemy,turn,"debuff",false) * 1.5);
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from Wild Wind Sword. ";
				}
				else if(((this.hasExactly("Quieting Antler") || this.hasExactly("Delivering Antler")) && (this.initiator || this.buddy.adjacent > 0 || this.buddy.two > 0)) || (this.hasExactly("Vedrfolnir's Edge") && (this.initiator || this.buddy.rorc > 0))){
					var xVal = 0;
					if(!this.penalty.panic){
						xVal = Math.max(this.combatBuffs.atk,this.buffs.atk) + Math.max(this.combatBuffs.spd,this.buffs.spd) + Math.max(this.combatBuffs.def,this.buffs.def) + Math.max(this.combatBuffs.res,this.buffs.res);
					}
					xVal = Math.max(xVal,this.buddy.buffs.atk + this.buddy.buffs.spd + this.buddy.buffs.def + this.buddy.buffs.res);
					flatBoost += xVal;
					damageText += this.name + " gains " + xVal + " damage from " + data.skills[this.weaponIndex].name + ". ";
				}
				else if(((this.hasExactly("Spear of Assal") && this.rValue == 5) || this.hasExactly("Lady's Bow")) && this.buddy.adjacent + this.buddy.two + this.buddy.three > 0){
					flatBoost += 7;
					damageText += this.name + " gains 7 damage from " + data.skills[this.weaponIndex].name + ". ";
				}
				else if(this.hasExactly("Sun's Percussors") && this.rValue == 5 && (this.initiator || this.buddy.adjacent + this.buddy.two + this.buddy.three > 0)){
					var extraDmg = Math.floor(thisEffSpd * 0.15);
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from Sun's Percussors. ";
				}
				else if(this.hasExactly("Summertime Axe") && this.combatStartHp / this.maxHp >= 0.25){
					var extraDmg = Math.min((Object.values(this.bonus).reduce((a, item) => a + (item === true ? 1 : 0), 0) + this.bonus.extra + Object.values(enemy.bonus).reduce((a, item) => a + (item === true ? 1 : 0), 0) + enemy.bonus.extra) * 5, 30);
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from Summertime Axe. ";
				}
				else if((this.has("Juicy Bucketful") || this.has("Stall-Game Bow") || this.has("Raudrcrab")) && this.combatStartHp / this.maxHp >= 0.25){
					var extraDmg = Math.min((Object.values(this.bonus).reduce((a, item) => a + (item === true ? 1 : 0), 0) + this.bonus.extra + Object.values(enemy.bonus).reduce((a, item) => a + (item === true ? 1 : 0), 0) + enemy.bonus.extra) * 5, 25);
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from " + data.skills[this.weaponIndex].name + ". ";
				}
				else if(this.hasExactly("Fluttering Fan") && this.buddy.rorc > 0 && this.hp / this.maxHp < 1){
					flatBoost += 10;
					damageText += this.name + " gains 10 damage from Fluttering Fan. ";
				}
				else if(this.hasExactly("Berserker Axe") && (!this.initiator || enemy.combatStartHp / enemy.maxHp >= 0.75)){
					var extraDmg = Math.min(this.maxHp - this.hp, 30);
					extraDmg += Math.floor(thisEffAtk * 0.15);
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from Berserker Axe. ";
				}
				else if(this.hasExactly("Grim Brokkr") && this.rValue > 0 && (this.initiator || this.buddy.adjacent < 2)){
					var extraDmg = Math.floor(thisEffAtk * 0.15);
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from Grim Brokkr. ";
				}
				else if(this.hasExactly("Geirdriful") && this.rValue == 5 && this.combatStartHp / this.maxHp >= 0.25){
					var extraDmg = Math.min((Object.values(this.bonus).reduce((a, item) => a + (item === true ? 1 : 0), 0) + this.bonus.extra) * 4, 16);
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from Geirdriful. ";
				}
				else if(this.hasExactly("Holy-War Spear") && (this.initiator || this.buddy.adjacent > 0 || this.buddy.two > 0)){
					var extraDmg = Math.floor(thisEffDef * 0.2);
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from Holy-War Spear. ";
				}
				else if(this.hasExactly("Stone of Delights") && this.buddy.adjacent + this.buddy.two + this.buddy.three > 0){
					var extraDmg = Math.min(this.maxHp - enemy.combatStartHp, 16);
					extraDmg = Math.max(extraDmg, 8);
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from Stone of Delights. ";
				}
				else if((this.hasExactly("Quieting Claw") && this.combatStartHp / this.maxHp >= 0.25) || (this.hasExactly("New Year Talon") && (this.transform == true || enemy.combatStartHp / enemy.maxHp >= 0.75)) || (this.hasExactly("Axe of Dusk") && (this.initiator || enemy.combatStartHp / enemy.maxHp >= 0.75))){
					var extraDmg = (Object.values(enemy.penalty).reduce((a, item) => a + (item === true ? 1 : 0), 0) + enemy.penalty.extra + Object.values(enemy.bonus).reduce((a, item) => a + (item === true ? 1 : 0), 0) + enemy.bonus.extra) * 3;
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from " + data.skills[this.weaponIndex].name + ". ";
				}
				else if(this.hasExactly("Heavenly Icicle") && this.rValue == 5 && (this.initiator || this.buddy.adjacent + this.buddy.two + this.buddy.three > 0)){
					var extraDmg = Math.min((this.buddy.adjacent + this.buddy.two + this.buddy.three + enemy.buddy.adjacent + enemy.buddy.two + enemy.buddy.three + 1) * 4, 16);
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from Heavenly Icicle. ";
				}
				else if(this.hasExactly("Scroll of Teas") && (this.initiator || this.buddy.adjacent + this.buddy.two + this.buddy.three > 0)){
					var extraDmg = this.toggle.weapon * 6;
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from Scroll of Teas. ";
				}
				else if((this.hasExactly("Ylisse Ninja Bow") || this.hasExactly("Divine Yewfelle")) && (this.initiator || this.buddy.adjacent > 0 || this.buddy.two > 0)){
					var extraDmg = Math.min((Object.values(enemy.penalty).reduce((a, item) => a + (item === true ? 1 : 0), 0) + enemy.penalty.extra + Object.values(this.bonus).reduce((a, item) => a + (item === true ? 1 : 0), 0) + this.bonus.extra) * 5, 25);
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from " + data.skills[this.weaponIndex].name + ". ";
				}
				else if((this.hasExactly("Enticing Dose") || this.hasExactly("New Year Fang")) && (this.transform == true || this.combatStartHp / this.maxHp >= 0.25)){
					var extraDmg = Math.floor(enemy.maxHp * 0.3);
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from " + data.skills[this.weaponIndex].name + ". ";
				}
				else if((this.hasExactly("Fellowship Blade") || this.hasExactly("Sword of Peace")) && this.buddy.adjacent + this.buddy.two + this.buddy.three > 0){
					var xVal = 0;
					if(!this.penalty.panic){
						xVal = Math.max(this.combatBuffs.atk,this.buffs.atk) + Math.max(this.combatBuffs.spd,this.buffs.spd) + Math.max(this.combatBuffs.def,this.buffs.def) + Math.max(this.combatBuffs.res,this.buffs.res);
					}
					xVal = Math.max(xVal,this.buddy.buffs.atk + this.buddy.buffs.spd + this.buddy.buffs.def + this.buddy.buffs.res);
					flatBoost += xVal;
					damageText += this.name + " gains " + xVal + " damage from " + data.skills[this.weaponIndex].name + ". ";
				}
				else if((this.hasExactly("Odr of Creation") || (this.hasExactly("Wing-Lifted Spear") && this.rValue > 0)) && (this.initiator || this.buddy.adjacent > 0 || this.buddy.two > 0)){
					var extraDmg = Math.min((Object.values(enemy.bonus).reduce((a, item) => a + (item === true ? 1 : 0), 0) + enemy.bonus.extra + Object.values(this.bonus).reduce((a, item) => a + (item === true ? 1 : 0), 0) + this.bonus.extra) * 5, 25);
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from " + data.skills[this.weaponIndex].name + ". ";
				}
				else if(this.hasExactly("Icy Ravager") && (!this.initiator || enemy.combatStartHp / enemy.maxHp >= 0.75)){
					var extraDmg = this.toggle.weapon * 3 + 10;
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from Icy Ravager. ";
				}
				else if(this.hasExactly("Goddess Axe") && this.rValue == 5 && (this.initiator || this.buddy.adjacent > 0 || this.buddy.two > 0)){
					var extraDmg = Math.floor(thisEffDef * 0.15);
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from Goddess Axe. ";
				}
				else if(this.hasExactly("Rampart Bow") && this.combatStartHp / this.maxHp >= 0.25){
					var extraDmg = Math.max(this.toggle.weapon * 8, 8);
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from Rampart Bow. ";
				}
				else if(this.hasExactly("Sword of Isaach") && this.combatStartHp / this.maxHp >= 0.25){
					var extraDmg = Math.min((Object.values(enemy.penalty).reduce((a, item) => a + (item === true ? 1 : 0), 0) + enemy.penalty.extra + Object.values(this.bonus).reduce((a, item) => a + (item === true ? 1 : 0), 0) + this.bonus.extra) * 5, 25);
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from Sword of Isaach. ";
				}
				else if(this.hasExactly("Ebon Bolverk") && this.rValue > 0 && (this.initiator || this.buddy.adjacent > 0 || this.buddy.two > 0)){
					var extraDmg = Math.min((Object.values(this.bonus).reduce((a, item) => a + (item === true ? 1 : 0), 0) + this.bonus.extra + Object.values(enemy.bonus).reduce((a, item) => a + (item === true ? 1 : 0), 0) + enemy.bonus.extra) * 5, 25);
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from Ebon Bolverk. ";
				}
				else if((this.hasExactly("Eagle's Heart") && (this.initiator || this.buddy.adjacent < 2)) || ((this.hasExactly("Lion's Heart") || this.hasExactly("Deer's Heart") || this.has("Devoted Cup")) && (this.initiator || this.buddy.adjacent > 0 || this.buddy.two > 0))){
					var extraDmg = Math.min((Object.values(this.bonus).reduce((a, item) => a + (item === true ? 1 : 0), 0) + this.bonus.extra + Object.values(enemy.penalty).reduce((a, item) => a + (item === true ? 1 : 0), 0) + enemy.penalty.extra) * 5, 25);
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from " + data.skills[this.weaponIndex].name + ". ";
				}
				else if(this.hasExactly("Devoted Breath") && (!this.initiator || enemy.combatStartHp / enemy.maxHp >= 0.75)){
					var extraDmg = Math.min((this.buddy.adjacent + this.buddy.two + this.buddy.three) * 5, 15);
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from Devoted Breath. ";
				}
				else if((this.has("Spring-Air Egg") || this.has("Spring-Air Axe")) && this.combatStartHp / this.maxHp >= 0.25){
					var extraDmg = Math.min((enemy.buddy.adjacent + enemy.buddy.two + enemy.buddy.three + 1) * 5, 20);
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from " + data.skills[this.weaponIndex].name + ". ";
				}
				else if(this.hasExactly("True-Bond Bow") && (this.initiator || this.buddy.adjacent > 0 || this.buddy.two > 0)){
					var extraDmg = Math.min((this.talent.atk + this.talent.spd) * 2, 30);
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from True-Bond Bow. ";
				}
				else if(this.hasExactly("Taciturn Axe") && this.buddy.adjacent + this.buddy.two + this.buddy.three > 0){
					var extraDmg = Math.floor(thisEffDef * (0.2 + (this.toggle.weapon * 0.1)));
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from Taciturn Axe. ";
				}
				else if(this.hasExactly("Duskstone") && this.combatStartHp / this.maxHp >= 0.25){
					var extraDmg = Math.min((this.buddy.adjacent + this.buddy.two + this.buddy.three) * 5, 15);
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from " + data.skills[this.weaponIndex].name + ". ";
				}
				else if(this.hasExactly("Sword of Dusk") && this.combatStartHp / this.maxHp >= 0.25){
					var extraDmg = Math.floor(thisEffDef * 0.15);
					if(enemy.combatStartHp / enemy.maxHp >= 0.5){
						extraDmg = Math.floor(thisEffDef * 0.25);
					}
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from " + data.skills[this.weaponIndex].name + ". ";
				}
				else if(this.hasExactly("Ancient Betrayal") && this.combatStartHp / this.maxHp >= 0.25){
					var extraDmg = this.toggle.weapon * 5 + 10;
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from " + data.skills[this.weaponIndex].name + ". ";
				}
				else if(this.hasExactly("Jaws of Closure") && this.combatStartHp / this.maxHp >= 0.25){
					var extraDmg = (Math.min(enemy.buddy.adjacent + enemy.buddy.two + enemy.buddy.three, 3)) * 8 + 8;
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from " + data.skills[this.weaponIndex].name + ". ";
				}
				
				if(this.hasExactly("Makings of a King")){
					flatBoost += this.talent.def;
					damageText += this.name + " gains " + this.talent.def + " damage from Makings of a King. ";
				}
		
				if(this.hasExactly("Flashing Blade 4") && (thisEffSpd+this.getPhantom("Spd")) - (enemyEffSpd+enemy.getPhantom("Spd")) >= 1){
					flatBoost += 5;
					damageText += this.name + " gains 5 damage from Flashing Blade 4. ";
				}
				else if(this.hasExactly("Heavy Blade 4") && thisEffAtk > enemyEffAtk){
					flatBoost += 5;
					damageText += this.name + " gains 5 damage from Heavy Blade 4. ";
				}
				else if(this.hasExactly("Scendscale")){
					var scenDmg = Math.floor(thisEffAtk * 0.25);
					flatBoost += scenDmg;
					damageText += this.name + " gains " + scenDmg + " damage from Scendscale. ";
				}
				else if(this.hasExactly("Verdict of Sacae") && this.toggle.a > 0){
					flatBoost += 5;
					damageText += this.name + " gains 5 damage from Verdict of Sacae. ";
				}
				else if((this.has("Atk Res Finish") || this.has("Atk Spd Finish") || this.has("Spd Res Finish") || this.has("Def Res Finish") || this.has("Atk Def Finish") || this.has("Spd Def Finish")) && this.buddy.adjacent + this.buddy.two + this.buddy.three > 0){
					var finishDmg = 0;
					var finishText = "";
					if(this.hasSlot("Atk Res Finish","a")){
						finishDmg = this.hasSlot("Atk Res Finish","a") * 2 - 1;
						if(this.hasExactly("Atk Res Finish 4")){
							finishDmg = 5;
						}
						finishText = data.skills[this.aIndex].name;
					}
					else if(this.hasSlot("Atk Spd Finish","a")){
						finishDmg = this.hasSlot("Atk Spd Finish","a") * 2 - 1;
						if(this.hasExactly("Atk Spd Finish 4")){
							finishDmg = 5;
						}
						finishText = data.skills[this.aIndex].name;
					}
					else if(this.has("Def Res Finish")){
						finishDmg = this.has("Def Res Finish") * 2 - 1;
						if(this.hasExactly("Def Res Finish 4")){
							finishDmg = 5;
						}
						finishText = data.skills[this.aIndex].name;
					}
					else if(this.hasSlot("Atk Def Finish","a")){
						finishDmg = this.hasSlot("Atk Def Finish","a") * 2 - 1;
						if(this.hasExactly("Atk Def Finish 4")){
							finishDmg = 5;
						}
						finishText = data.skills[this.aIndex].name;
					}
					else if(this.hasSlot("Spd Res Finish","a")){
						finishDmg = this.hasSlot("Spd Res Finish","a") * 2 - 1;
						if(this.hasExactly("Spd Res Finish 4")){
							finishDmg = 5;
						}
						finishText = data.skills[this.aIndex].name;
					}
					else if(this.hasSlot("Spd Def Finish","a")){
						finishDmg = this.hasSlot("Spd Def Finish","a") * 2 - 1;
						if(this.hasExactly("Spd Def Finish 4")){
							finishDmg = 5;
						}
						finishText = data.skills[this.aIndex].name;
					}
					if(this.hasSlot("Atk Def Finish","s")){
						finishDmg += this.hasSlot("Atk Def Finish","s") * 2 - 1;
						if(finishText != ""){
							finishText += " and ";
						}
						finishText += data.skills[this.sIndex].name;
					}
					else if(this.hasSlot("Spd Res Finish","s")){
						finishDmg += this.hasSlot("Spd Res Finish","s") * 2 - 1;
						if(finishText != ""){
							finishText += " and ";
						}
						finishText += data.skills[this.sIndex].name;
					}
					else if(this.hasSlot("Atk Res Finish","s")){
						finishDmg += this.hasSlot("Atk Res Finish","s") * 2 - 1;
						if(finishText != ""){
							finishText += " and ";
						}
						finishText += data.skills[this.sIndex].name;
					}
					else if(this.hasSlot("Atk Spd Finish","s")){
						finishDmg += this.hasSlot("Atk Spd Finish","s") * 2 - 1;
						if(finishText != ""){
							finishText += " and ";
						}
						finishText += data.skills[this.sIndex].name;
					}
					flatBoost += finishDmg;
					damageText += this.name + " gains " + finishDmg + " damage from " + finishText + ". ";
				}
				else if(this.hasExactly("Ashera's Chosen+") && (this.toggle.a == 1 || enemy.combatStartHp / enemy.maxHp >= 0.75) && this.getPhantom("Res") + thisEffRes > enemy.getPhantom("Res") + enemyEffRes){
					var diffDmg = Math.floor((thisEffRes - enemyEffRes) * 0.7);
					diffDmg = Math.min(diffDmg, 7);
					flatBoost += diffDmg;
					damageText += this.name + " gains " + diffDmg + " damage from Ashera's Chosen+. ";
				}
				else if(this.hasExactly("Mastermind") && (this.initiator || this.buddy.adjacent > 0 || this.buddy.two > 0)){
					var xVal = 0;
					if(!this.penalty.panic){
						xVal = Math.max(this.combatBuffs.atk,this.buffs.atk) + Math.max(this.combatBuffs.spd,this.buffs.spd) + Math.max(this.combatBuffs.def,this.buffs.def) + Math.max(this.combatBuffs.res,this.buffs.res);
					}
					xVal = Math.max(xVal,this.buddy.buffs.atk + this.buddy.buffs.spd + this.buddy.buffs.def + this.buddy.buffs.res);
					xVal = Math.floor(xVal * 0.8);
					var yVal = 0;
					var eNegate = this.checkNegate(enemy, turn);
					if(eNegate[0] == false){
						var aVal = Math.min(enemy.combatDebuffs.atk,enemy.debuffs.atk);
						if(enemy.penalty.panic){
							aVal -= Math.max(enemy.combatBuffs.atk,enemy.buffs.atk);
						}
						yVal += aVal;
					}
					if(eNegate[1] == false){
						var sVal = Math.min(enemy.combatDebuffs.spd,enemy.debuffs.spd);
						if(enemy.penalty.panic){
							sVal -= Math.max(enemy.combatBuffs.spd,enemy.buffs.spd);
						}
						yVal += sVal;
					}
					if(eNegate[2] == false){
						var dVal = Math.min(enemy.combatDebuffs.def,enemy.debuffs.def);
						if(enemy.penalty.panic){
							dVal -= Math.max(enemy.combatBuffs.def,enemy.buffs.def);
						}
						yVal += dVal;
					}
					if(eNegate[3] == false){
						var rVal = Math.min(enemy.combatDebuffs.res,enemy.debuffs.res);
						if(enemy.penalty.panic){
							rVal -= Math.max(enemy.combatBuffs.res,enemy.buffs.res);
						}
						yVal += rVal;
					}
					yVal = Math.min(yVal,enemy.buddy.debuffs.atk + enemy.buddy.debuffs.spd + enemy.buddy.debuffs.def + enemy.buddy.debuffs.res);
					yVal = Math.floor(yVal * -0.8);
					flatBoost = flatBoost + xVal + yVal;
					damageText += this.name + " gains " + xVal + "+" + yVal + " damage from Mastermind. ";
				}
				else if((this.hasExactly("Thunder's Fist") || this.hasExactly("Fell Wyrmscale")) && this.combatStartHp / this.maxHp >= 0.25){
					var extraDmg = Math.floor(thisEffAtk * 0.15);
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from " + data.skills[this.aIndex].name + ". ";
				}
				else if((this.hasExactly("Sly Swift Sparrow") || this.hasExactly("Sly Mirror") || this.hasExactly("Sly Sturdy Blow")) && this.initiator && ((Object.values(this.bonus).reduce((a, item) => a + (item === true ? 1 : 0), 0) + this.bonus.extra) > 1 || (Object.values(enemy.penalty).reduce((a, item) => a + (item === true ? 1 : 0), 0) + enemy.penalty.extra) > 1)){
					flatBoost += 5;
					damageText += this.name + " gains 5 damage from " + data.skills[this.aIndex].name + ". ";
				}
				else if(this.hasExactly("Protective") && this.combatStartHp / this.maxHp >= 0.25 && this.buddy.hpCondition == true && (this.buddy.rank != "N" || this.buddy.adjacent + this.buddy.two > 0)){
					flatBoost += 15;
					damageText += this.name + " gains 15 damage from " + data.skills[this.aIndex].name + ". ";
				}
				else if(this.has("Blue Skies") && (this.initiator || this.buddy.adjacent > 0 || this.buddy.two > 0)){
					var extraDmg = this.buddy.rorc * 2;
					if(this.has("Blue Skies") == 1){
						extraDmg = this.buddy.rorc;
					}
					else if(this.has("Blue Skies") == 4){
						extraDmg = this.buddy.rorc * 2 + 2;
					}
					extraDmg = Math.min(extraDmg, this.has("Blue Skies") * 2);
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from " + data.skills[this.aIndex].name + ". ";
				}
				else if(this.hasExactly("Trample") && (this.initiator || enemy.combatStartHp / enemy.maxHp >= 0.75) && (this.toggle.a == 1 || enemy.moveType == "infantry" || enemy.moveType == "armored")){
					flatBoost += 5;
					damageText += this.name + " gains 5 damage from " + data.skills[this.aIndex].name + ". ";
				}
				else if(this.hasExactly("New Opening") && (this.transform == true || enemy.combatStartHp / enemy.maxHp >= 0.75)){
					var extraDmg = Math.min(this.buddy.spaces * 4, 12);
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from " + data.skills[this.aIndex].name + ". ";
				}
				
				if(this.hasExactly("Wrath 1") || this.hasExactly("Wrath 2") || this.hasExactly("Wrath 3")){
					if(this.hp/this.maxHp <= .25 * this.has("Wrath")){
						flatBoost += 10;
						damageText += this.name + " gains 10 damage from " + data.skills[this.bIndex].name + ". ";
					}
				}
				else if(this.hasExactly("Bushido")){
					flatBoost += 10;
					damageText += this.name + " gains 10 damage from Bushido. ";
				}
				else if(this.hasExactly("Lunar Brace")){
					var extraDmg = Math.floor(enemyEffDef/2);
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from Lunar Brace. ";
				}
				else if(this.hasExactly("Lunar Brace 2")){
					var extraDmg = Math.floor(enemyEffDef * 0.15);
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from Lunar Brace 2. ";
				}
				else if((this.hasExactly("Atrocity") && enemy.combatStartHp / enemy.maxHp >= 0.5) || (this.hasExactly("Atrocity 2") && enemy.combatStartHp / enemy.maxHp >= 0.4) || (this.hasExactly("Pure Atrocity") && (this.initiator || this.buddy.adjacent > 0 || this.buddy.two > 0))){
					var atroDmg = Math.floor(thisEffAtk * 0.25);
					flatBoost += atroDmg;
					damageText += this.name + " gains " + atroDmg + " damage from " + data.skills[this.bIndex].name + ". ";
				}
				else if(this.hasExactly("Bushido 2") || this.hasExactly("SR Far Trace 4") || this.hasExactly("AR Far Trace 4") || this.hasExactly("SD Near Trace 4") || this.hasExactly("SR Near Trace 4") || this.hasExactly("SD Far Trace 4") || this.hasExactly("AR Near Trace 4")){
					flatBoost += 7;
					damageText += this.name + " gains 7 damage from " + data.skills[this.bIndex].name + ". ";
				}
				else if((this.hasExactly("Moonlight Bangle") || this.hasExactly("Moonlit Bangle F")) && this.specialIndex != -1){
					var extraDmg = data.skills[this.specialIndex].charge - this.initSkillCharge();
					extraDmg = Math.floor(enemyEffDef * (extraDmg * 0.1 + 0.2));
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from " + data.skills[this.bIndex].name + ". ";
				}
				else if((this.has("Spurn") < 4 && this.hp/this.maxHp <= 0.25 * this.has("Spurn")) || (this.hasExactly("Spurn 4") && this.hp/this.maxHp <= 0.75)){
					flatBoost += 5;
					damageText += this.name + " gains 5 damage from Spurn " + this.has("Spurn") + ". ";
				}
				else if(((this.hasSlot("Dragon's Wrath","b") && !this.initiator) || this.hasExactly("Dragon's Wrath 4")) && firstHit && thisEffAtk > enemyEffRes+enemy.getPhantom("Res")){
					var fMulti = this.hasSlot("Dragon's Wrath","b") * 0.05 + 0.05;
					fMulti = Math.floor((thisEffAtk - enemyEffRes + enemy.getPhantom("Res")) * fMulti);
					flatBoost += fMulti;
					damageText += this.name + " gains " + fMulti + " damage from " + data.skills[this.bIndex].name + ". ";
				}
				else if((this.hasExactly("Flow Flight 3") || (this.hasExactly("Flow Flight 2") && this.combatStartHp / this.maxHp >= 0.5) || (this.hasExactly("Flow Flight 1") && this.combatStartHp / this.maxHp >= 1)) && this.initiator && this.getPhantom("Spd") + thisEffSpd >= enemy.getPhantom("Spd") + enemyEffSpd - 10){
					var dMod = (this.has("Flow Flight") * 2 + 1) * 0.1;
					dMod = Math.max(Math.floor((thisEffDef - enemyEffDef) * dMod),0);
					dMod = Math.min(dMod,this.has("Flow Flight") * 2 + 1);
					flatBoost += dMod;
					damageText += this.name + " gains " + dMod + " damage from " + data.skills[this.bIndex].name + ". ";
				}
				else if((this.hasExactly("Flow Feather 3") || (this.hasExactly("Flow Feather 2") && this.combatStartHp / this.maxHp >= 0.5) || (this.hasExactly("Flow Feather 1") && this.combatStartHp / this.maxHp >= 1)) && this.initiator && this.getPhantom("Spd") + thisEffSpd >= enemy.getPhantom("Spd") + enemyEffSpd - 10){
					var dMod = (this.has("Flow Feather") * 2 + 1) * 0.1;
					dMod = Math.max(Math.floor((thisEffRes + this.getPhantom("Res") - enemyEffRes - enemy.getPhantom("Res")) * dMod),0);
					dMod = Math.min(dMod,this.has("Flow Feather") * 2 + 1);
					flatBoost += dMod;
					damageText += this.name + " gains " + dMod + " damage from " + data.skills[this.bIndex].name + ". ";
				}
				else if(this.hasExactly("Hodr's Zeal")){
					var scenDmg = Math.floor(thisEffAtk * 0.2);
					flatBoost += scenDmg;
					damageText += this.name + " gains " + scenDmg + " damage from Hodr's Zeal. ";
				}
				else if(this.hasExactly("Special Spiral 4")){
					flatBoost += 5;
					damageText += this.name + " gains 5 damage from Special Spiral 4. ";
				}
				else if(this.hasExactly("Poetic Justice")){
					var extraDmg = Math.floor(enemyEffAtk * 0.15);
					if(enemy.has("Mystic Boost") || enemy.has("Splashy Bucket")){
						extraDmg = Math.floor(extraDmg * 0.5);
					}
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from Poetic Justice. ";
				}
				else if(this.hasExactly("Gambit 4") && this.specialIndex != -1 && !this.hasExactly("Galeforce")){
					var extraDmg = (data.skills[this.specialIndex].charge - this.initSkillCharge() - 2) * 5;
					extraDmg = Math.min(extraDmg,15);
					extraDmg = Math.max(extraDmg,0);
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from Gambit 4. ";
				}
				else if(this.hasExactly("Magic Gambit 4") && this.specialIndex != -1){
					var extraDmg = (data.skills[this.specialIndex].charge - this.initSkillCharge() - 2) * 4;
					extraDmg = Math.min(extraDmg,12);
					extraDmg = Math.max(extraDmg,0);
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from Magic Gambit 4. ";
				}
				else if(this.hasExactly("Occultist's Strike") && this.initiator){
					var extraDmg = Math.floor(enemyEffRes * 0.2);
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from Occultist's Strike. ";
				}
				else if(this.hasExactly("Assassin's Strike") && this.initiator){
					var extraDmg = Math.floor(enemyEffDef * 0.2);
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from Assassin's Strike. ";
				}
				else if(this.hasExactly("Beast Agility 4") && this.getPhantom("Spd") + thisEffSpd > enemy.getPhantom("Spd") + enemyEffSpd){
					var extraDmg = Math.floor(thisEffSpd * 0.1);
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from Beast Agility 4. ";
				}
				else if(this.hasExactly("Raging Tempest") && this.buddy.adjacent < 2){
					var extraDmg = Math.floor(thisEffAtk * 0.15);
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from Raging Tempest. ";
				}
				else if(this.hasExactly("Barbarity") && enemy.combatStartHp / enemy.maxHp >= 0.25){
					var extraDmg = Math.floor(thisEffAtk * 0.25);
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from Barbarity. ";
				}
				else if(this.hasExactly("Wyvern Rift") && thisEffSpd + thisEffDef >= enemyEffSpd + enemyEffDef - 10){
					var extraDmg = Math.min(allStats[18] - 35,7);
					extraDmg = Math.max(extraDmg,0);
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from " + data.skills[this.bIndex].name + ". ";
				}
				else if(this.hasExactly("Pegasus Rift") && thisEffSpd + thisEffRes >= enemyEffSpd + enemyEffRes - 10){
					var extraDmg = Math.min(allStats[19] - 30,10);
					extraDmg = Math.max(extraDmg,0);
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from " + data.skills[this.bIndex].name + ". ";
				}
				else if((this.hasExactly("Sun-Twin Wing+") || this.hasExactly("Under the Sun") || this.hasExactly("Dark Perfume") || this.hasExactly("Tut-Tut")) && this.combatStartHp / this.maxHp >= 0.25){
					var extraDmg = Math.floor(thisEffSpd * 0.2);
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from " + data.skills[this.bIndex].name + ". ";
				}
				else if(this.has("Laguz Friend") && this.specialIndex != -1 && data.skills[this.specialIndex].charge - this.initSkillCharge() >= 3){
					var extraDmg = Math.max(thisEffDef, thisEffRes) * (this.has("Laguz Friend") * 0.05);
					extraDmg = Math.floor(extraDmg);
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from " + data.skills[this.bIndex].name + ". ";
				}
				else if(this.hasExactly("Laguz Loyalty") && this.specialIndex != -1 && data.skills[this.specialIndex].charge - this.initSkillCharge() >= 3 && !this.initiator){
					flatBoost += 7;
					damageText += this.name + " gains 7 damage from " + data.skills[this.bIndex].name + ". ";
				}
				else if(this.hasExactly("Atk Spd Link 4") && this.toggle.b > 1){
					var xVal = 0;
					if(!this.penalty.panic){
						xVal = Math.max(this.combatBuffs.atk,this.buffs.atk) + Math.max(this.combatBuffs.spd,this.buffs.spd);
					}
					xVal = Math.max(xVal,this.buddy.buffs.atk + this.buddy.buffs.spd);
					flatBoost += xVal;
					damageText += this.name + " gains " + xVal + " damage from Atk Spd Link 4. ";
				}
				else if(this.hasExactly("Spd Def Link 4") && this.toggle.b > 1){
					var xVal = 0;
					if(!this.penalty.panic){
						xVal = Math.max(this.combatBuffs.def,this.buffs.def) + Math.max(this.combatBuffs.spd,this.buffs.spd);
					}
					xVal = Math.max(xVal,this.buddy.buffs.def + this.buddy.buffs.spd);
					flatBoost += xVal;
					damageText += this.name + " gains " + xVal + " damage from Spd Def Link 4. ";
				}
				else if((this.hasExactly("Ice Prince's Seal") && this.combatStartHp / this.maxHp >= 0.25) || (this.hasExactly("Pure Storm") && (this.initiator || this.buddy.adjacent < 2))){
					var extraDmg = Math.floor(thisEffDef * 0.2);
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from " + data.skills[this.bIndex].name + ". ";
				}
				else if(this.hasExactly("Resonance 1") || this.hasExactly("Resonance 2") || this.hasExactly("Resonance 3") || this.hasExactly("Resonance 4") || this.hasExactly("AR Far Resound")){
					var extraDmg = (this.combatStartHp - this.hp) * 2;
					extraDmg = Math.min(extraDmg, 12);
					extraDmg = Math.max(extraDmg, 6);
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from " + data.skills[this.bIndex].name + ". ";
				}
				else if(this.hasExactly("Moon-Twin Wing+") && this.combatStartHp / this.maxHp >= 0.25){
					var extraDmg = Math.floor(thisEffAtk * 0.1);
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from Moon-Twin Wing+. ";
				}
				else if(this.hasExactly("Moonlit Bangle Q")){
					var extraDmg = Math.floor(enemyEffDef * 0.25);
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from Moonlit Bangle Q. ";
				}
				else if(this.hasExactly("Fallen Star 2") && (this.initiator || this.bonus.dStar)){
					var extraDmg = Math.min((Object.values(this.bonus).reduce((a, item) => a + (item === true ? 1 : 0), 0) + this.bonus.extra + Object.values(enemy.penalty).reduce((a, item) => a + (item === true ? 1 : 0), 0) + enemy.penalty.extra) * 5, 25);
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from Fallen Star 2. ";
				}
				else if(this.hasExactly("According to Plan") && this.combatStartHp / this.maxHp >= 0.25){
					var extraDmg = Math.min((Object.values(this.bonus).reduce((a, item) => a + (item === true ? 1 : 0), 0) + this.bonus.extra + Object.values(enemy.penalty).reduce((a, item) => a + (item === true ? 1 : 0), 0) + enemy.penalty.extra) * 5, 25);
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from According to Plan. ";
				}
				else if((this.hasExactly("Lone Wolf") && (this.combatStartHp / this.maxHp >= 0.25 || this.buddy.adjacent < 2)) || (this.hasExactly("Pure Starfall") && (this.initiator || this.bonus.dStar == true))){
					var extraDmg = Math.floor(thisEffSpd * 0.2);
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from " + data.skills[this.bIndex].name + ". ";
				}
				else if(this.hasExactly("Reopening") && this.combatStartHp / this.maxHp >= 0.25){
					var extraDmg = Math.floor(thisEffDef * 0.2);
					if(thisFollowUp || brave == 1 || brave == 2){
						extraDmg = Math.floor(thisEffDef * 0.1);
					}
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from Reopening. ";
				}
				else if(this.hasExactly("Shadow Slide") && this.buddy.adjacent + this.buddy.two + this.buddy.three > 0){
					var extraDmg = Math.floor(thisEffSpd * 0.2);
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from Shadow Slide. ";
				}
				else if(this.hasSlot("Momentum","b") && this.buddy.spaces > 0){
					var extraDmg = this.buddy.spaces * this.hasSlot("Momentum","b");
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from " + data.skills[this.bIndex].name + ". ";
				}
				else if(this.hasExactly("Spd Res Discord") || this.hasExactly("Atk Res Discord") || this.hasExactly("Def Res Discord")){
					var extraDmg = Math.floor(thisEffRes * 0.15);
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from " + data.skills[this.bIndex].name + ". ";
				}
				else if(this.hasExactly("AD Spiked Wall")){
					var extraDmg = Math.max(thisEffDef, thisEffRes) * 0.15;
					extraDmg = Math.floor(extraDmg);
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from " + data.skills[this.bIndex].name + ". ";
				}
				else if(this.hasExactly("SR Spiked Wall")){
					var extraDmg = Math.max(thisEffSpd, thisEffRes) * 0.15;
					extraDmg = Math.floor(extraDmg);
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from " + data.skills[this.bIndex].name + ". ";
				}
				else if(this.hasExactly("AS Spiked Wall")){
					var extraDmg = Math.floor(thisEffSpd * 0.15);
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from " + data.skills[this.bIndex].name + ". ";
				}
				else if((this.hasExactly("Slick Fighter 4") || this.hasExactly("Wily Fighter 4")) && (!this.initiator || this.combatStartHp / this.maxHp >= 0.25)){
					var extraDmg = Math.floor(thisEffDef * 0.2);
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from " + data.skills[this.bIndex].name + ". ";
				}
				else if(this.hasExactly("Yggdrasill's Alter") || this.hasExactly("Font of Wisdom") || this.hasExactly("Mounting Fear") || this.hasExactly("Atk Res Havoc")){
					var extraDmg = Math.floor(thisEffRes * 0.2);
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from " + data.skills[this.bIndex].name + ". ";
				}
				else if(this.has("Speedtaker")){
					var extraDmg = Math.floor(thisEffSpd * (this.has("Speedtaker") * 0.05));
					extraDmg = Math.floor(extraDmg);
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from " + data.skills[this.bIndex].name + ". ";
				}
				else if(((this.hasExactly("Bestial Assault") || this.hasExactly("Bestial Agility")) && (this.transform == true || this.combatStartHp / this.maxHp >= 0.25)) || (this.hasExactly("Assault Force") && (this.initiator || this.buddy.adjacent > 0 || this.buddy.two > 0))){
					var extraDmg = Math.max(thisEffSpd, thisEffDef) * 0.2;
					extraDmg = Math.floor(extraDmg);
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from " + data.skills[this.bIndex].name + ". ";
				}
				else if(this.hasExactly("I Remember...") && (this.initiator || this.buddy.adjacent > 0 || this.buddy.two > 0)){
					var extraDmg = Math.floor(thisEffSpd * 0.2);
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from I Remember.... ";
				}
				else if(this.hasExactly("Chivalry 2")){
					var chVar = 0.15;
					if(enemy.combatStartHp / enemy.maxHp >= 0.5){
						chVar = 0.25;
					}
					var extraDmg = Math.floor(thisEffAtk * chVar);
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from " + data.skills[this.bIndex].name + ". ";
				}
				else if(this.hasExactly("Pure Dragon Wall")){
					var extraDmg = 0.2;
					if(this.toggle.b == 1 || this.toggle.b == 3){
						extraDmg = 0.3;
					}
					extraDmg = Math.floor(thisEffRes * extraDmg);
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from Pure Dragon Wall. ";
				}
				else if(this.hasExactly("Edged Scales") && (!this.initiator || this.combatStartHp / this.maxHp >= 0.25)){
					var extraDmg = Math.floor(enemyEffAtk * 0.15);
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from Edged Scales. ";
				}
				else if(this.hasExactly("Called to Serve") && this.toggle.b > 0){
					var extraDmg = this.toggle.b * 5;
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from Called to Serve. ";
				}
				
				if(this.hasExactly("Domain of Flame") && this.toggle.c == 1 && firstHit && thisEffAtk > enemyEffRes+enemy.getPhantom("Res")){
					var abDmg = Math.floor((thisEffAtk - enemyEffRes+enemy.getPhantom("Res")) * 0.3);
					flatBoost += abDmg;
					damageText += this.name + " gains " + abDmg + " damage from Domain of Flame. ";
				}
				else if(this.hasExactly("Even Atk Wave N") && thisEffAtk >= enemyEffAtk - 5){
					flatBoost += 5;
					damageText += this.name + " gains 5 damage from Even Atk Wave N. ";
				}
				else if((this.hasExactly("Quiet Strength") && (this.initiator || this.buddy.adjacent > 0 || this.buddy.two > 0)) || (this.hasExactly("Divine God Fang") && this.buddy.adjacent + this.buddy.two + this.buddy.three > 0)){
					flatBoost += 7;
					damageText += this.name + " gains 7 damage from " + data.skills[this.cIndex].name + ". ";
				}
				
				if(this.hasSlot("Dragon's Wrath","s") && !this.initiator && firstHit && thisEffAtk > enemyEffRes+enemy.getPhantom("Res")){
					var fMulti = this.hasSlot("Dragon's Wrath","s") * 0.05 + 0.05;
					fMulti = Math.floor((thisEffAtk - enemyEffRes + enemy.getPhantom("Res")) * fMulti);
					flatBoost += fMulti;
					damageText += this.name + " gains " + fMulti + " damage from " + data.skills[this.sIndex].name + ". ";
				}
				
				if(this.hasExactly("Far Trace Echo")){
					flatBoost += 3;
					damageText += this.name + " gains 3 damage from Far Trace Echo. ";
				}
				
				if(this.emblem == "Celica" || this.emblem == "Lyn" || this.emblem == "Eirika"){
					var ceVal = (data.skills[this.specialIndex].charge - this.initSkillCharge()) * 4;
					flatBoost += ceVal;
					damageText += this.name + " gains " + ceVal + " damage from Emblem (" + this.emblem + "). ";
				}
				else if(this.emblem == "Sigurd" && this.buddy.spaces > 0){
					var extraDmg = Math.min(this.buddy.spaces * 2, 8);
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from Emblem (Sigurd). ";
				}
				
				if(this.support.dof > 0 && firstHit && thisEffAtk > enemyEffRes+enemy.getPhantom("Res")){
					var abDmg = Math.floor((thisEffAtk - enemyEffRes+enemy.getPhantom("Res")) * 0.3) * this.support.dof;
					flatBoost += abDmg;
					damageText += this.name + " gains " + abDmg + " damage from ally Muspell(s). ";
				}
				if(this.support.trueDmg > 0){
					flatBoost += this.support.trueDmg;
					damageText += this.name + " gains " + this.support.trueDmg + " damage from ally Seteth(s). ";
				}
				if(this.support.flutter > 0 && this.hp / this.maxHp < 1){
					var fluVal = 10 * this.support.flutter;
					flatBoost += fluVal;
					damageText += this.name + " gains " + fluVal + " damage from ally Nephenee(s). ";
				}
				if(this.moveType == "infantry" && this.weaponType == "beast" && this.transform == true){
					//Bonus dmg now changes based on refine/unit release date
					if(data.heroes[this.heroIndex].hero_id < 782 && this.rValue < 0){
						flatBoost += 10;
						damageText += this.name + " gains 10 damage from transforming. ";
					}
					else{
						flatBoost += 7;
						damageText += this.name + " gains 7 damage from transforming. ";
					}
				}
				if(this.bonus.dominance){
					flatBoost += domiDmg;
					damageText += this.name + " gains " + domiDmg + " damage from Dominance status. ";
				}
				if(this.bonus.treachery && !this.penalty.ploy){
					flatBoost += treachDmg;
					damageText += this.name + " gains " + treachDmg + " damage from Treachery status. ";
				}
				if(enemy.penalty.exposure == true){
					flatBoost += 10;
					damageText += this.name + " gains 10 damage from " + enemy.name + " being affected by Exposure. ";
				}
				if(this.prfVal > 0 && this.hasExactly("Chaos Manifest") && this.rValue == 5 && (this.initiator || this.toggle.weapon > 1)){
					flatBoost += this.prfVal;
					damageText += this.name + " gains " + this.prfVal + " true damage. ";
				}
				if(this.hasCaptain("Fault")){
					var fVal = 0;
					var eNegate = this.checkNegate(enemy, turn);
					if(eNegate[0] == false){
						var aVal = Math.min(enemy.combatDebuffs.atk,enemy.debuffs.atk);
						if(enemy.penalty.panic){
							aVal -= Math.max(enemy.combatBuffs.atk,enemy.buffs.atk);
						}
						fVal += aVal;
					}
					if(eNegate[1] == false){
						var sVal = Math.min(enemy.combatDebuffs.spd,enemy.debuffs.spd);
						if(enemy.penalty.panic){
							sVal -= Math.max(enemy.combatBuffs.spd,enemy.buffs.spd);
						}
						fVal += sVal;
					}
					if(eNegate[2] == false){
						var dVal = Math.min(enemy.combatDebuffs.def,enemy.debuffs.def);
						if(enemy.penalty.panic){
							dVal -= Math.max(enemy.combatBuffs.def,enemy.buffs.def);
						}
						fVal += dVal;
					}
					if(eNegate[3] == false){
						var rVal = Math.min(enemy.combatDebuffs.res,enemy.debuffs.res);
						if(enemy.penalty.panic){
							rVal -= Math.max(enemy.combatBuffs.res,enemy.buffs.res);
						}
						fVal += rVal;
					}
					fVal = -Math.min(fVal,enemy.buddy.debuffs.atk + enemy.buddy.debuffs.spd + enemy.buddy.debuffs.def + enemy.buddy.debuffs.res);
					if(this.toggle.sd == 1){
						fVal = Math.floor(fVal * 0.5);
					}
					flatBoost += fVal;
					damageText += this.name + " gains " + fVal + " damage from Fault. ";
				}
				//Adaptive damage
				if(this.hasExactly("Seidr Burst") && (!enemy.has("Mystic Boost")) && (!enemy.has("Splashy Bucket")) && (!enemy.has("Light and Dark")) && !(enemy.hasExactly("Divine Naga") && enemy.rValue > 0) && !(enemy.hasExactly("Naga") && enemy.rValue == 5 && this.weaponType == "dragon") && !(enemy.hasExactly("Aureola") && (enemy.initiator || enemy.buddy.adjacent > 0 || enemy.buddy.two > 0)) && !(enemy.hasExactly("Close Ward") && data.magicalWeapons.indexOf(this.weaponType) != -1 && this.initiator) && !(enemy.hasExactly("Spirit Forest Writ") && enemy.toggle.weapon == 1) && !(enemy.hasExactly("Radiant Aureola") && (this.initiator || this.combatStartHp / this.maxHp >= 0.75)) && !(enemy.hasExactly("Rare Talent") && enemy.combatStartHp / enemy.maxHp >= 0.25)){
					relevantDef = Math.min(enemyEffDef, enemyEffRes);
					relevantTileDef = Math.min(Math.floor(enemyEffDef*enemy.dTile), Math.floor(enemyEffRes*enemy.dTile));
					relevantTileDef = Math.max(0,relevantTileDef);
				}
			}
		}
		
		//Remove didAttack if AOE didn't fire but it's AOE phase
		if(AOE && !AOEActivated){
			this.didAttack = false;
		}

		//Don't do anything else if it's just an AOE attack
		if(!AOE){

			//Check weapon advantage
			//0 is no advantage, 1 is attacker advantage, -1 is defender advantage
			var weaponAdvantage = 0;

			if((enemy.color=="green"&&this.color=="red")||(enemy.color=="red"&&this.color=="blue")||(enemy.color=="blue"&&this.color=="green")){
				weaponAdvantage = 1;
			}
			else if(enemy.color=="gray" && (this.has("Raudrraven") || this.has("Blarraven") || this.has("Gronnraven") || this.has("Naglfar") || this.hasExactly("Tactical Bolt") || this.hasExactly("Tactical Gale") || this.hasExactly("Eternal Tome") || this.hasExactly("Inscribed Tome") || this.hasExactly("Ethereal Breath") || this.hasExactly("Corvus Tome") || this.hasExactly("Tome of Order") || (this.hasExactly("Blood Tome") && (data.rangedWeapons.indexOf(enemy.weaponType) != -1 || (this.rValue > 0 && this.initiator))) || (this.hasExactly("Tome of Grado") && (enemy.combatStartHp / enemy.maxHp >= 1 || !this.initiator) && data.rangedWeapons.indexOf(enemy.weaponType) != -1) || (this.hasExactly("Dragon Bouquet") && this.combatStartHp / this.maxHp >= 0.25) || this.hasExactly("Opposing Stones") || this.hasExactly("Tome of Fury"))){
				if(!enemy.hasExactly("Duality")){
					weaponAdvantage = 1;
				}
			}
			else if((this.color=="green"&&enemy.color=="red")||(this.color=="red"&&enemy.color=="blue")||(this.color=="blue"&&enemy.color=="green")){
				weaponAdvantage = -1;
			}
			else if(this.color=="gray" && (enemy.has("Raudrraven") || enemy.has("Blarraven") || enemy.has("Gronnraven") || enemy.has("Naglfar") || enemy.hasExactly("Tactical Bolt") || enemy.hasExactly("Tactical Gale") || enemy.hasExactly("Eternal Tome") || enemy.hasExactly("Inscribed Tome") || enemy.hasExactly("Ethereal Breath") || enemy.hasExactly("Corvus Tome") || enemy.hasExactly("Tome of Order") || (enemy.hasExactly("Blood Tome") && (data.rangedWeapons.indexOf(this.weaponType) != -1 || (enemy.rValue > 0 && !this.initiator))) || (enemy.hasExactly("Tome of Grado") && (this.combatStartHp / this.maxHp >= 1 || this.initiator) && data.rangedWeapons.indexOf(this.weaponType) != -1) || (enemy.hasExactly("Dragon Bouquet") && enemy.combatStartHp / enemy.maxHp >= 0.25) || enemy.hasExactly("Opposing Stones") || enemy.hasExactly("Tome of Fury"))){
				if(!this.hasExactly("Duality")){
					weaponAdvantage = -1;
				}
			}
			else if(this.hasExactly("Duality") && (enemy.color=="red" || enemy.color=="blue" || enemy.color=="green")){
				weaponAdvantage = 1;
			}
			else if(enemy.hasExactly("Duality") && (this.color=="red" || this.color=="blue" || this.color=="green")){
				weaponAdvantage = -1;
			}

			//Extra weapon advantage is apparently limited to 0.2 more (doesn't stack)
			//Cancel Affinity makes this messy
			var extraWeaponAdvantage = 0;
			var caText = "";
			if(weaponAdvantage == 1){
				if(this.has("Triangle Adept")){
					if(!this.has("Cancel Affinity") && this.bonus.caff == false){
						extraWeaponAdvantage = 0.05 + 0.05 * this.has("Triangle Adept");
						foeAdvantage = 1;
					}
					else{
						caText = " and Cancel Affinity";
					}
				}
				if(this.has("Ruby Sword") || this.has("Sapphire Lance") || this.has("Emerald Axe") || this.hasExactly("Draconic Poleax") || this.penalty.trilemma == true || (this.hasExactly("Folkvangr") && this.rValue == 5) || this.hasExactly("Whitewing Blade") || this.hasExactly("Silverbrand") || this.hasExactly("Panther Sword") || this.hasExactly("Bull Spear") || (this.hasExactly("Tome of Order") && this.rValue == 5) || (this.hasExactly("Prayer Wheel") && this.rValue == 5 && this.combatStartHp / this.maxHp >= 0.25)){
					if(!this.has("Cancel Affinity") && this.bonus.caff == false){
						extraWeaponAdvantage = 0.2;
						foeAdvantage = 1;
					}
					else{
						caText = " and Cancel Affinity";
					}
				}
				if(enemy.has("Triangle Adept")){
					if(this.has("Cancel Affinity") == 1){
						extraWeaponAdvantage = 0;
						caText = " and Cancel Affinity";
					}
					else if(!enemy.has("Cancel Affinity") && enemy.bonus.caff == false){
						extraWeaponAdvantage = Math.max(extraWeaponAdvantage,0.05 + 0.05 * enemy.has("Triangle Adept"));
					}
					else{
						caText = " and Cancel Affinity";
					}
				}
				if(enemy.has("Ruby Sword") || enemy.has("Sapphire Lance") || enemy.has("Emerald Axe") || enemy.hasExactly("Draconic Poleax") || enemy.penalty.trilemma == true || (enemy.hasExactly("Folkvangr") && enemy.rValue == 5) || enemy.hasExactly("Whitewing Blade") || enemy.hasExactly("Silverbrand") || enemy.hasExactly("Panther Sword") || enemy.hasExactly("Bull Spear") || (enemy.hasExactly("Tome of Order") && enemy.rValue == 5) || (enemy.hasExactly("Prayer Wheel") && enemy.rValue == 5 && enemy.combatStartHp / enemy.maxHp >= 0.25)){
					if(this.has("Cancel Affinity") == 1){
						extraWeaponAdvantage = 0;
						caText = " and Cancel Affinity";
					}
					else if(!enemy.has("Cancel Affinity") && enemy.bonus.caff == false){
						extraWeaponAdvantage = 0.2;
					}
					else{
						caText = " and Cancel Affinity";
					}
				}
				if(extraWeaponAdvantage != 0){
					if(enemy.has("Cancel Affinity") == 1 || enemy.has("Cancel Affinity") == 2){
						extraWeaponAdvantage = 0;
						caText = " and Cancel Affinity";
					}
					else if(enemy.has("Cancel Affinity") == 3 || enemy.bonus.caff == true){
						extraWeaponAdvantage *= -1;
						caText = " and Cancel Affinity";
					}
				}
			}
			else if(weaponAdvantage == -1){
				if(enemy.has("Triangle Adept")){
					if(!enemy.has("Cancel Affinity") && enemy.bonus.caff == false){
						extraWeaponAdvantage = 0.05 + 0.05 * enemy.has("Triangle Adept");
						foeAdvantage = 1;
					}
					else{
						caText = " and Cancel Affinity";
					}
				}
				if(enemy.has("Ruby Sword") || enemy.has("Sapphire Lance") || enemy.has("Emerald Axe") || enemy.hasExactly("Draconic Poleax") || enemy.penalty.trilemma == true || (enemy.hasExactly("Folkvangr") && enemy.rValue == 5) || enemy.hasExactly("Whitewing Blade") || enemy.hasExactly("Silverbrand") || enemy.hasExactly("Panther Sword") || enemy.hasExactly("Bull Spear") || (enemy.hasExactly("Tome of Order") && enemy.rValue == 5) || (enemy.hasExactly("Prayer Wheel") && enemy.rValue == 5 && enemy.combatStartHp / enemy.maxHp >= 0.25)){
					if(!enemy.has("Cancel Affinity") && enemy.bonus.caff == false){
						extraWeaponAdvantage = 0.2;
						foeAdvantage = 1;
					}
					else{
						caText = " and Cancel Affinity";
					}
				}
				if(this.has("Triangle Adept")){
					if(enemy.has("Cancel Affinity") == 1){
						extraWeaponAdvantage = 0;
						caText = " and Cancel Affinity";
					}
					else if(!this.has("Cancel Affinity") && this.bonus.caff == false){
						extraWeaponAdvantage = Math.max(extraWeaponAdvantage,0.05 + 0.05 * this.has("Triangle Adept"));
					}
					else{
						caText = " and Cancel Affinity";
					}
				}
				if(this.has("Ruby Sword") || this.has("Sapphire Lance") || this.has("Emerald Axe") || this.hasExactly("Draconic Poleax") || this.penalty.trilemma == true || (this.hasExactly("Folkvangr") && this.rValue == 5) || this.hasExactly("Whitewing Blade") || this.hasExactly("Silverbrand") || this.hasExactly("Panther Sword") || this.hasExactly("Bull Spear") || (this.hasExactly("Tome of Order") && this.rValue == 5) || (this.hasExactly("Prayer Wheel") && this.rValue == 5 && this.combatStartHp / this.maxHp >= 0.25)){
					if(enemy.has("Cancel Affinity") == 1){
						extraWeaponAdvantage = 0;
						caText = " and Cancel Affinity";
					}
					else if(!this.has("Cancel Affinity") && this.bonus.caff == false){
						extraWeaponAdvantage = 0.2;
					}
					else{
						caText = " and Cancel Affinity";
					}
				}
				if(extraWeaponAdvantage != 0){
					if(this.has("Cancel Affinity") == 1 || this.has("Cancel Affinity") == 2){
						extraWeaponAdvantage = 0;
						caText = " and Cancel Affinity";
					}
					else if(this.has("Cancel Affinity") == 3 || this.bonus.caff == true){
						extraWeaponAdvantage *= -1;
						caText = " and Cancel Affinity";
					}
				}
			}
			//Duality removes all extraWeaponAdvantage
			if(this.hasExactly("Duality") || enemy.hasExactly("Duality")){
				extraWeaponAdvantage = 0;
			}

			var weaponAdvantageBonus = (0.2 + extraWeaponAdvantage) * weaponAdvantage;

			if(weaponAdvantage != 0){
				damageText += this.name + "'s attack is multiplied by " + Math.round((1+weaponAdvantageBonus)*10)/10 + " because of weapon advantage" + caText + ". ";
			}
			//Display effectivenss text
			if(effectiveBonus > 1){
				damageText += this.name + "'s attack is multiplied by " + effectiveBonus + " from weapon effectiveness. ";
			}

			//Check damage reducing specials
			var defensiveSpecialActivated = false;
			var dmgReduction = 1.0;
			var miracle = false;
			if(enemy.specialIndex!=-1 && data.skills[enemy.specialIndex].charge <= enemy.charge){
				//gotta check range
				var anyRangeCounter = false;
				if(this.hasExactly("Close Counter") || this.hasExactly("Distant Counter") || this.has("Raijinto") || this.has("Lightning Breath") || this.hasExactly("Siegfried") || this.has("Ragnell") || this.has("Gradivus") || this.has("Alondite") || this.hasExactly("Stout Tomahawk") || this.hasExactly("Leiptr") || this.hasExactly("Expiration") || this.has("Ostian Counter") || this.hasExactly("Divine Mist") || (this.hasExactly("Naga") && this.rValue == 5 && enemy.weaponType == "dragon") || this.hasExactly("Dragonbind") || this.hasExactly("Razing Breath") || this.hasExactly("Sublime Surge") || this.hasExactly("Ragnell-Alondite") || (this.hasExactly("Double Bow") && (this.buddy.adjacent == 0 || (this.rValue > 0 && this.buddy.adjacent < 2))) || this.hasExactly("Moonless Breath") || this.hasExactly("Nightmare Horn") || this.hasExactly("Purifying Breath") || (this.hasExactly("Inscribed Tome") && this.rValue == 5 && !this.initiator && (enemy.weaponType == "sword" || enemy.weaponType == "lance" || enemy.weaponType == "axe" || enemy.weaponType == "beast")) || (this.hasExactly("Vouge") && (this.combatStartHp/this.maxHp >= 0.5 || (this.rValue > 0 && this.combatStartHp/this.maxHp >= 0.25))) || (this.hasExactly("Amatsu") && ((this.rValue < 0 && this.combatStartHp/this.maxHp >= 0.5) || (this.rValue > 0 && this.combatStartHp/this.maxHp >= 0.25))) || this.hasExactly("Distant Pressure") || this.hasExactly("Close Reversal") || this.hasExactly("Eerie Scripture") || this.hasExactly("Nifl's Bite") || this.hasExactly("Distant Stance") || this.hasExactly("Carnage Amatsu") || this.hasExactly("Close Salvo") || this.hasExactly("Distant Storm") || this.hasExactly("Distant Dart") || this.hasExactly("Dist Counter (D)") || this.hasExactly("Dist Counter (M)") || (this.hasExactly("Virtuous Naga") && this.rValue == 5 && this.toggle.weapon == 1 && enemy.weaponType == "dragon") || this.hasExactly("Distant Ferocity") || this.hasExactly("Distant Reversal") || this.hasExactly("Ostia's Heart") || this.hasExactly("Distant AS Solo") || this.hasExactly("Distant DR Solo") || this.hasExactly("Wyvern Hatchet") || (this.hasExactly("Frostbite Mirror") && spCharged == true) || this.hasExactly("Realms United") || this.hasExactly("Holy Yule Blade") || ((this.hasExactly("Atk Spd Prime 4") || this.hasExactly("Atk Def Prime 4") || this.hasExactly("Spd Def Prime 4")) && Object.values(this.bonus).reduce((a, item) => a + (item === true ? 1 : 0), 0) + this.bonus.extra > 3) || this.hasExactly("Arcadian Axes") || this.hasExactly("Loving Breath") || this.hasExactly("Emblems' Miracle") || this.hasExactly("D Bonus Doubler") || this.hasExactly("C Bonus Doubler") || this.hasExactly("Hoshido's Breath") || (this.hasExactly("Obsidian Tactics") && this.toggle.a > 2) || this.hasExactly("Breezy Spear") || this.hasExactly("New Levin Sword") || (this.hasExactly("Fortifications") && this.toggle.a == 1) || (this.hasExactly("Remote Breath") && this.rValue == 5) || this.hasExactly("Dual Ice Mirrors") || this.hasExactly("Desert Spear") || this.hasExactly("Opposing Stones") || this.hasExactly("D Counter Echo") || this.hasExactly("Spear") || (this.hasExactly("Joker's Wild") && this.rValue > 0) || this.hasExactly("The Fire Emblem") || this.anyCounter){
					anyRangeCounter = true;
				}
				if(this.range == "melee" || (!this.initiator && enemy.range == "melee" && anyRangeCounter)){
					if(enemy.hasExactly("Buckler") || enemy.hasExactly("Escutcheon")){
						dmgReduction = 0.7;
						defensiveSpecialActivated = true;
					}
					else if(enemy.hasExactly("Pavise")){
						dmgReduction = 0.5;
						defensiveSpecialActivated = true;
					}
					else if(enemy.hasExactly("Frostbite Mirror")){
						dmgReduction = 0.9;
						defensiveSpecialActivated = true;
					}
				}
				else if(this.range == "ranged" || (!this.initiator && enemy.range == "ranged" && anyRangeCounter)){
					if(enemy.hasExactly("Holy Vestments") || enemy.hasExactly("Sacred Cowl") || enemy.hasExactly("Ice Mirror")){
						dmgReduction = 0.7;
						defensiveSpecialActivated = true;
					}
					else if(enemy.hasExactly("Aegis")){
						dmgReduction = 0.5;
						defensiveSpecialActivated = true;
					}
					else if(enemy.hasExactly("Ice Mirror 2") || enemy.hasExactly("Dual Ice Mirrors")){
						dmgReduction = 0.6;
						defensiveSpecialActivated = true;
					}
					else if(enemy.hasExactly("Frostbite Mirror")){
						dmgReduction = 0.7;
						defensiveSpecialActivated = true;
					}
				}
				if(enemy.hasExactly("Negating Fang")){
					dmgReduction = 0.7;
					defensiveSpecialActivated = true;
				}
				if(enemy.hasExactly("Negating Fang 2")){
					dmgReduction = 0.6;
					defensiveSpecialActivated = true;
				}
				if(enemy.hasExactly("Godlike Reflexes") && enemyEffSpd + enemy.getPhantom("Spd") >= thisEffSpd + this.getPhantom("Spd") - 4){
					dmgReduction = 0.6;
					defensiveSpecialActivated = true;
				}
				if((enemy.hasExactly("Miracle") || enemy.has("Life Unending")) && enemy.hp > 1){
					miracle = true;
				}
			}
			//disable defensive special if Lands Sword/Queensblade/etc
			if(parity || (this.hasExactly("Lands Sword") && this.combatStartHp / this.maxHp >= 0.25) || (this.hasExactly("Sisterly War Axe") && (this.initiator || this.toggle.weapon == 1) && offensiveSpecialActivated) || (this.hasExactly("Sentinel Bow") && (this.initiator || enemy.range == "ranged")) || (this.hasExactly("Crusader's Astra") && offensiveSpecialActivated && !firstHit) || (this.hasExactly("Pure Storm") && this.toggle.b > 1 && this.initiator) || (this.hasExactly("True Lunar Flash") && offensiveSpecialActivated)){
				defensiveSpecialActivated = false;
				dmgReduction = 1.0;
				miracle = false;
			}

			if(defensiveSpecialActivated){
				if(dmgReduction < 1){
					damageText += enemy.name + " multiplies damage by " + dmgReduction + " with " + data.skills[enemy.specialIndex].name + ". ";
					if(enemy.has("Hardy Fighter") || enemy.hasExactly("Shield Fighter")){
						damageText += enemy.name + " multiplies damage by " + dmgReduction + " again with " + data.skills[enemy.bIndex].name + ". ";
						dmgReduction = dmgReduction * dmgReduction;
					}
				}
				enemy.resetCharge();
				if(enemy.hasExactly("Negating Fang 2") && brave == 1){
					enemy.charge += 2;
				}
				//flat dmg reduction
				if(enemy.has("Shield Pulse") > 1 || enemy.has("Hardy Fighter") > 1){
					flatReduction += 5;
					damageText += enemy.name + " reduces 5 damage from " + data.skills[enemy.bIndex].name + ". ";
				}
				if(enemy.hasExactly("Moonlight Stone") && (this.initiator || this.combatStartHp / this.maxHp >= 0.75)){
					flatReduction += 8;
					damageText += enemy.name + " reduces 8 damage from Moonlight Stone. ";
				}
				if(enemy.hasExactly("Ice-Bound Brand") && (this.initiator || this.combatStartHp / this.maxHp >= 0.75)){
					flatReduction += 5;
					damageText += enemy.name + " reduces 5 damage from Ice-Bound Brand. ";
				}
				if(enemy.hasExactly("Shield Fighter")){
					flatReduction += 7;
					damageText += enemy.name + " reduces 7 damage from Shield Fighter. ";
				}
			}
			
			//Offensive Specials that reduce damage on next hit
			if(enemy.hasExactly("Divine Pulse") && (enemy.ice > 0 || enemy.ice < 0) && brave != 6 && (enemy.beacon[0] == -2 || enemy.beacon[0] == -4)){
				dmgReduction = 0.25;
				damageText += enemy.name + " multiplies damage by " + dmgReduction + " with " + data.skills[enemy.specialIndex].name + ". ";
				if(enemy.ice < 0){
					enemy.ice = 0;
				}
				if(enemy.beacon[0] == -2){
					enemy.beacon[0] = 0;
				}
				else{
					enemy.beacon[0] = -5;
				}
			}
			else if((enemy.hasExactly("Armored Beacon") || enemy.hasExactly("Armored Floe")) && enemy.beacon[0] >= 0 && this.range == "ranged" && (data.skills[enemy.specialIndex].charge <= enemy.charge || (this.specialIndex!=-1 && data.skills[this.specialIndex].charge <= this.charge) || enemy.sTrigger == 1 || (this.sTrigger == 1 && !AOE) || offensiveSpecialActivated)){
				dmgReduction = 0.6;
				damageText += enemy.name + " multiplies damage by " + dmgReduction + " with " + data.skills[enemy.specialIndex].name + ". ";
				enemy.beacon[0]--;
			}
			else if(enemy.hasExactly("Armored Blaze") && enemy.beacon[0] >= 0 && this.range == "melee" && (data.skills[enemy.specialIndex].charge <= enemy.charge || (this.specialIndex!=-1 && data.skills[this.specialIndex].charge <= this.charge) || enemy.sTrigger == 1 || (this.sTrigger == 1 && !AOE) || offensiveSpecialActivated)){
				dmgReduction = 0.6;
				damageText += enemy.name + " multiplies damage by " + dmgReduction + " with " + data.skills[enemy.specialIndex].name + ". ";
				enemy.beacon[0]--;
			}
			else if((enemy.hasExactly("Dragon Blast") || enemy.hasExactly("Bond Blast")) && enemy.beacon[0] == 0 && (enemy.buddy.rank != "N" || (enemy.hasExactly("Bond Blast") && enemy.toggle.special == 1)) && (enemy.buddy.adjacent > 0 || enemy.buddy.two > 0 || enemy.buddy.three > 0) && (data.skills[enemy.specialIndex].charge <= enemy.charge || (this.specialIndex!=-1 && data.skills[this.specialIndex].charge <= this.charge) || enemy.sTrigger == 1 || (this.sTrigger == 1 && !AOE) || offensiveSpecialActivated)){
				dmgReduction = 0.6;
				damageText += enemy.name + " multiplies damage by " + dmgReduction + " with " + data.skills[enemy.specialIndex].name + ". ";
				enemy.beacon[0] = -1;
			}
			else if(enemy.hasExactly("Lightless Luna") && enemy.beacon[0] >= 0 && (data.skills[enemy.specialIndex].charge <= enemy.charge || (this.specialIndex!=-1 && data.skills[this.specialIndex].charge <= this.charge) || enemy.sTrigger == 1 || (this.sTrigger == 1 && !AOE) || offensiveSpecialActivated)){
				dmgReduction = 0.6;
				damageText += enemy.name + " multiplies damage by " + dmgReduction + " with " + data.skills[enemy.specialIndex].name + ". ";
				enemy.beacon[0]--;
			}
			else if(enemy.hasExactly("Supreme Heaven") && enemy.beacon[0] >= 0 && this.range == "ranged" && (data.skills[enemy.specialIndex].charge <= enemy.charge || (this.specialIndex!=-1 && data.skills[this.specialIndex].charge <= this.charge) || enemy.sTrigger == 1 || (this.sTrigger == 1 && !AOE) || offensiveSpecialActivated)){
				dmgReduction = 0.7;
				damageText += enemy.name + " multiplies damage by " + dmgReduction + " with " + data.skills[enemy.specialIndex].name + ". ";
				enemy.beacon[0]--;
			}
			else if(enemy.hasExactly("Arms of the Three") && spCharged && allStats[23] + enemy.getPhantom("Res") > allStats[19] + this.getPhantom("Res")){
				var atVal = Math.min((allStats[23] + enemy.getPhantom("Res") - allStats[19] - this.getPhantom("Res")) * 3, 30) / 100;
				dmgReduction = 1 - atVal;
				damageText += enemy.name + " multiplies damage by " + dmgReduction + " with " + data.skills[enemy.specialIndex].name + ". ";
			}
			else if((enemy.hasExactly("Lodestar Rush") || enemy.hasExactly("Seidr Burst") || enemy.hasExactly("Brutal Shell+")) && enemy.beacon[0] == 0 && (data.skills[enemy.specialIndex].charge <= enemy.charge || (this.specialIndex!=-1 && data.skills[this.specialIndex].charge <= this.charge) || enemy.sTrigger == 1 || (this.sTrigger == 1 && !AOE) || offensiveSpecialActivated)){
				dmgReduction = 0.6;
				damageText += enemy.name + " multiplies damage by " + dmgReduction + " with " + data.skills[enemy.specialIndex].name + ". ";
				enemy.beacon[0] = -1;
			}
			else if(((enemy.hasExactly("Dragon's Roar") && enemyEffRes + enemy.getPhantom("Res") >= thisEffRes + this.getPhantom("Res") - 4) || (enemy.hasExactly("Dragon Flame") && (this.initiator || enemyEffDef >= thisEffDef - 10))) && enemy.beacon[0] >= 0 && (data.skills[enemy.specialIndex].charge <= enemy.charge || (this.specialIndex!=-1 && data.skills[this.specialIndex].charge <= this.charge) || enemy.sTrigger == 1 || (this.sTrigger == 1 && !AOE) || offensiveSpecialActivated)){
				dmgReduction = 0.6;
				damageText += enemy.name + " multiplies damage by " + dmgReduction + " with " + data.skills[enemy.specialIndex].name + ". ";
				enemy.beacon[0]--;
			}
			else if(enemy.hasExactly("Great Aether") || enemy.hasExactly("Makings of a King") || enemy.hasExactly("Sandstorm")){
				var gaVal = Math.max(0,data.skills[enemy.specialIndex].charge - enemy.charge);
				if(enemy.hasExactly("Great Aether") && followHit == true){
					gaVal = (7 - gaVal) / 10;
				}
				else{
					gaVal = (4 - gaVal) / 10;
				}
				dmgReduction = Math.round((1 - gaVal) * 100) / 100;
				damageText += enemy.name + " multiplies damage by " + dmgReduction + " with " + data.skills[enemy.specialIndex].name + ". ";
			}
			else if(enemy.hasExactly("Bane") && enemy.beacon[0] == 0 && (data.skills[enemy.specialIndex].charge <= enemy.charge || (this.specialIndex!=-1 && data.skills[this.specialIndex].charge <= this.charge) || enemy.sTrigger == 1 || (this.sTrigger == 1 && !AOE) || offensiveSpecialActivated)){
				dmgReduction = 0.7;
				damageText += enemy.name + " multiplies damage by " + dmgReduction + " with " + data.skills[enemy.specialIndex].name + ". ";
				enemy.beacon[0] = -1;
			}
			else if(enemy.hasExactly("Gust") && enemy.beacon[0] == 0 && enemyEffSpd + enemy.getPhantom("Spd") >= thisEffSpd + this.getPhantom("Spd") - 4 && (data.skills[enemy.specialIndex].charge <= enemy.charge || (this.specialIndex!=-1 && data.skills[this.specialIndex].charge <= this.charge) || enemy.sTrigger == 1 || (this.sTrigger == 1 && !AOE) || offensiveSpecialActivated)){
				dmgReduction = 0.6;
				damageText += enemy.name + " multiplies damage by " + dmgReduction + " with " + data.skills[enemy.specialIndex].name + ". ";
				enemy.beacon[0] = -1;
			}
			else if(enemy.hasExactly("Curved Shot") && enemy.beacon[0] >= 0 && hitback == true && (data.skills[enemy.specialIndex].charge <= enemy.charge || (this.specialIndex!=-1 && data.skills[this.specialIndex].charge <= this.charge) || enemy.sTrigger == 1 || (this.sTrigger == 1 && !AOE) || offensiveSpecialActivated)){
				dmgReduction = 0.6;
				damageText += enemy.name + " multiplies damage by " + dmgReduction + " with " + data.skills[enemy.specialIndex].name + ". ";
				enemy.beacon[0]--;
			}
			else if(enemy.hasExactly("Dual Ice Mirrors") && enemy.beacon[0] == 0 && defensiveSpecialActivated){
				damageText += enemy.name + " will ignore DR% on next attack with " + data.skills[enemy.specialIndex].name + ". ";
				enemy.beacon[0] = -2;
			}
			else if((enemy.hasExactly("Override") || enemy.hasExactly("Gift for Magic") || enemy.hasExactly("Crusader's Astra")) && enemy.beacon[0] == 0 && ((this.specialIndex!=-1 && data.skills[this.specialIndex].charge <= this.charge) || enemy.sTrigger == 1 || (this.sTrigger == 1 && !AOE) || offensiveSpecialActivated)){
				dmgReduction = 0.6;
				damageText += enemy.name + " multiplies damage by " + dmgReduction + " with " + data.skills[enemy.specialIndex].name + ". ";
				enemy.beacon[0] = -1;
			}
			else if(((enemy.hasExactly("Sturdy Beast") && (enemy.transform == true || enemyEffDef >= thisEffDef - 4)) || (enemy.hasExactly("Nimble Beast") && (enemy.transform == true || enemyEffSpd >= thisEffSpd - 4))) && enemy.beacon[0] >= 0 && (data.skills[enemy.specialIndex].charge <= enemy.charge || (this.specialIndex!=-1 && data.skills[this.specialIndex].charge <= this.charge) || enemy.sTrigger == 1 || (this.sTrigger == 1 && !AOE) || offensiveSpecialActivated)){
				dmgReduction = 0.6;
				damageText += enemy.name + " multiplies damage by " + dmgReduction + " with " + data.skills[enemy.specialIndex].name + ". ";
				enemy.beacon[0]--;
			}
			else if(enemy.hasExactly("Boulder") && enemy.beacon[0] == 0 && enemyEffDef >= thisEffDef - 4 && (data.skills[enemy.specialIndex].charge <= enemy.charge || (this.specialIndex!=-1 && data.skills[this.specialIndex].charge <= this.charge) || enemy.sTrigger == 1 || (this.sTrigger == 1 && !AOE) || offensiveSpecialActivated)){
				dmgReduction = 0.6;
				damageText += enemy.name + " multiplies damage by " + dmgReduction + " with " + data.skills[enemy.specialIndex].name + ". ";
				enemy.beacon[0]--;
			}
			else if(enemy.hasExactly("Life Unending 2") && firstHit){
				dmgReduction = 0.6;
				damageText += enemy.name + " multiplies damage by " + dmgReduction + " with " + data.skills[enemy.specialIndex].name + ". ";
			}
			else if(enemy.hasExactly("Aether's Path")){
				var apVal = Math.max(0,data.skills[enemy.specialIndex].charge - enemy.charge);
				if(enemy.sTrigger == 1){
					apVal = 0;
				}
				apVal = (5 - apVal) / 10;
				dmgReduction = Math.round((1 - apVal) * 100) / 100;
				damageText += enemy.name + " multiplies damage by " + dmgReduction + " with " + data.skills[enemy.specialIndex].name + ". ";
			}
			else if(enemy.hasExactly("Haze Slice") && !this.initiator){
				dmgReduction = 0.6;
				damageText += enemy.name + " multiplies damage by " + dmgReduction + " with " + data.skills[enemy.specialIndex].name + ". ";
			}
			else if((enemy.hasExactly("True Lunar Flash") || enemy.hasExactly("Twin Strike")) && enemy.beacon[0] >= 0 && (data.skills[enemy.specialIndex].charge <= enemy.charge || (this.specialIndex!=-1 && data.skills[this.specialIndex].charge <= this.charge) || enemy.sTrigger == 1 || (this.sTrigger == 1 && !AOE) || offensiveSpecialActivated)){
				dmgReduction = 0.6;
				damageText += enemy.name + " multiplies damage by " + dmgReduction + " with " + data.skills[enemy.specialIndex].name + ". ";
				enemy.beacon[0]--;
			}
			else if(enemy.hasExactly("The Fire Emblem") && enemy.toggle.special % 10 > 0){
				dmgReduction = enemy.toggle.special % 10 * 0.1;
				damageText += enemy.name + " multiplies damage by " + dmgReduction + " with " + data.skills[enemy.specialIndex].name + ". ";
			}
			if(enemy.hasExactly("Striving Sword") && enemy.beacon[0] == 0 && (enemy.buddy.adjacent > 0 || enemy.buddy.two > 0 || enemy.buddy.three > 0) && defensiveSpecialActivated){
				damageText += enemy.name + " will ignore DR% on next attack with " + data.skills[enemy.weaponIndex].name + ". ";
				enemy.beacon[0] = -2;
			}
			if(enemy.emblem == "Ike" && enemy.specialIndex != -1 && enemy.beacon[1] == 0  && this.range == "ranged" && (data.skills[enemy.specialIndex].charge <= enemy.charge || (this.specialIndex!=-1 && data.skills[this.specialIndex].charge <= this.charge) || enemy.sTrigger == 1 || (this.sTrigger == 1 && !AOE) || offensiveSpecialActivated || defensiveSpecialActivated)){
				dmgReduction = dmgReduction * 0.6;
				damageText += enemy.name + " multiplies damage by 0.6 with Emblem (Ike). ";
				enemy.beacon[1] = -1;
			}

			//Weapon mod for healers
			var weaponModifier = 1;
			if(this.weaponType == "staff"){
				//poor healers
				weaponModifier = 0.5;

				//But wait!
				if(this.has("Wrathful Staff")){
					if((this.combatStartHp / this.maxHp >= 1.5 + this.hasSlot("Wrathful Staff","b") * -0.5) || (this.combatStartHp / this.maxHp >= 1.5 + this.hasSlot("Wrathful Staff","s") * -0.5)){
						weaponModifier = 1;
					}
				}
				if(data.skills[this.weaponIndex].inheritrule != "unique" && (this.rValue == 6 || (this.rValue > 0 && this.rValue < 5))){
					weaponModifier = 1;
				}
				if((this.hasExactly("Sway Atk Res") || this.hasExactly("Sway Atk Spd")) && (this.initiator || this.buddy.adjacent + this.buddy.two + this.buddy.three > 0)){
					weaponModifier = 1;
				}
				if(this.hasExactly("Poetic Justice") || this.hasExactly("Wrathful Tempo") || this.hasExactly("Thokk") || this.hasExactly("Gjallarbru") || this.hasExactly("Caduceus Staff") || this.hasExactly("Elise's Staff") || this.hasExactly("Kia Staff") || this.hasExactly("Staff of Rausten") || this.hasExactly("Sunshade Staff") || this.hasExactly("Punishment Staff") || this.hasExactly("Diplomacy Staff") || this.hasExactly("Crimean Scepter") || this.hasExactly("Staff of Lilies") || this.hasExactly("Mystic War Staff") || this.hasExactly("Asclepius") || this.hasExactly("Kitty-Cat Parasol") || this.hasExactly("Repair") || this.hasExactly("Supreme Thokk") || this.hasExactly("Baton of Dusk") || (this.hasExactly("Holy Ground+") && this.buddy.adjacent + this.buddy.two + this.buddy.three > 0)){
					weaponModifier = 1;
				}
				if(enemy.has("Mystic Boost") || enemy.has("Splashy Bucket")){
					weaponModifier = 0.5;
				}
			}

			if(this.has("Absorb")){
				absorbPct = 0.5;
			}
			
			//Non-special damage reductions
			var dmgCut = 0; //weapons
			var deflectCut = 0; // seals
			var aCut = 0; //a skills
			var bCut = 0; //b skills
			var cCut = 0; //c skills & Vital Astra (since they can't overlap... yet)
			var xCut = 0;
			var oCut = 1; //outside help (Caduceus)
			var dCut = 0; //Dodge Status
			var diCut = 1; //Domain of Ice
			var fpCut = 1; //Fell Protection
			var hhCut = 0; //Hippity-Hop Axe
			var pCut = 0; //DR % From Duel Rules (Human Virtue 2 and Fuming Freikugel Drive)
			var niCut = 0; //DR% that cannot be nullified
			
			if(followHit == true){
				if(enemy.has("Urvan")){
					dmgCut = 0.8;
					damageText += enemy.name + " reduces damage by 0.8 from Urvan. ";
				}
				if(enemy.hasExactly("Gift of Magic") && (!this.initiator || this.range == "ranged") ){
					aCut = 0.8;
					damageText += enemy.name + " reduces damage by 0.8 from Gift of Magic. ";
				}
				if(enemy.has("Crusader's Ward") && data.rangedWeapons.indexOf(this.weaponType) != -1){
					bCut = 0.8;
					damageText += enemy.name + " reduces damage by 0.8 from Crusader's Ward. ";
				}
				if(enemy.has("Deflect")){
					var deflectLevel = 0;
					var defText = "";
					if((this.weaponType == "sword" || this.weaponType == "axe" || this.weaponType == "lance") && enemy.has("Deflect Melee")){
						deflectLevel = enemy.has("Deflect Melee");
						defText = "Melee";
					}
					else if((this.weaponType == "redtome" || this.weaponType == "bluetome" || this.weaponType == "greentome" || this.weaponType == "graytome") && enemy.has("Deflect Magic")){
						deflectLevel = enemy.has("Deflect Magic");
						defText = "Magic";
					}
					else if((this.weaponType == "bow" || this.weaponType == "dagger") && enemy.has("Deflect Missile")){
						deflectLevel = enemy.has("Deflect Missile");
						defText = "Missile";
					}
					if(deflectLevel > 0){
						if(deflectLevel == 1){
							deflectCut = 0.3;
						}
						else if(deflectLevel == 2){
							deflectCut = 0.5;
						}
						else if(deflectLevel == 3){
							deflectCut = 0.8;
						}
						damageText += enemy.name + " reduces damage by " + deflectCut + " from Deflect " + defText + " " + deflectLevel + ". ";
					}
				}
			}
			//Divine Tyrfing Reduction
			if(firstHit == true && enemy.hasExactly("Divine Tyrfing") && (this.weaponType == "redtome" || this.weaponType == "bluetome" || this.weaponType == "greentome" || this.weaponType == "graytome")){
				dmgCut = 0.5;
				damageText += enemy.name + " reduces damage by 0.5 from Divine Tyrfing. ";
			}
			//Thani Reduction
			if(firstHit == true && enemy.hasExactly("Thani") && this.range == "ranged"){
				if(enemy.rValue > 0 || (this.moveType == "armored" || this.moveType == "cavalry")){
					dmgCut = 0.3;
					damageText += enemy.name + " reduces damage by 0.3 from Thani. ";
				}
			}
			//Parthia and Brynhildr Reduction
			if(firstHit == true && (enemy.hasExactly("Parthia") || enemy.hasExactly("Brynhildr")) && enemy.rValue > 0 && (this.weaponType == "redtome" || this.weaponType == "bluetome" || this.weaponType == "greentome" || this.weaponType == "graytome")){
				dmgCut = 0.3;
				damageText += enemy.name + " reduces damage by 0.3 from " + data.skills[enemy.weaponIndex].name + ". ";
			}
			//Kagero's Dart Reduction
			if(firstHit == true && enemy.hasExactly("Kagero's Dart") && enemy.initiator && enemy.rValue == 5){
				dmgCut = 0.5;
				damageText += enemy.name + " reduces damage by 0.5 from Kagero's Dart. ";
			}
			//Refined Urvan Reduciton
			if(firstHit == true && enemy.hasExactly("Urvan") && enemy.rValue == 5){
				dmgCut = 0.4;
				damageText += enemy.name + " reduces damage by 0.4 from Urvan. ";
			}
			//Blood Tome Reduction
			if(enemy.hasExactly("Blood Tome") && (data.rangedWeapons.indexOf(this.weaponType) != -1 || (enemy.rValue > 0 && !this.initiator))){
				dmgCut = 0.5;
				damageText += enemy.name + " reduces damage by 0.5 from Blood Tome. ";
			}
			//Gilt Goblet Reduction
			if(enemy.hasExactly("Gilt Goblet") && (this.initiator || this.combatStartHp / this.maxHp == 1) && this.weaponType.indexOf("tome") != -1){
				dmgCut = 0.5;
				damageText += enemy.name + " reduces damage by 0.5 from Gilt Goblet. ";
			}
			//Black Eagle Rule Reduction
			if(enemy.hasExactly("Black Eagle Rule") && enemy.combatStartHp/enemy.maxHp >= 0.25 && !enemy.initiator && firstHit == false && brave != 6){
				dmgCut = 0.8;
				damageText += enemy.name + " reduces damage by 0.8 from Black Eagle Rule. ";
			}
			//New Foxkit Fang/Refined Loptous/Windy War Tome Reduction
			if((enemy.has("New Foxkit Fang") || (enemy.hasExactly("Loptous") && enemy.rValue > 0 && (effectiveBonus == 1 || this.has("Poison Dagger"))) || ((enemy.hasExactly("Windy War Tome") || (enemy.hasExactly("Ethereal Breath") && enemy.rValue == 5) || enemy.hasExactly("Loving Breath")) && (this.initiator || this.combatStartHp / this.maxHp >= 0.75)) || (enemy.hasExactly("Virtuous Naga") && enemy.rValue > 0 && (allStats[20] > allStats[16] || this.combatStartHp / this.maxHp >= 0.75)) || ((enemy.hasExactly("Masked Lance") || enemy.hasExactly("Aurora Breath") || enemy.hasExactly("Dark Scripture")) && enemy.rValue == 5 && enemy.combatStartHp / enemy.maxHp >= 0.25) || (enemy.hasExactly("Zephyr Breath") && enemy.rValue == 5 && (this.initiator || this.combatStartHp / this.maxHp >= 0.75)) || (enemy.hasExactly("Arch-Sage Tome") && (enemy.buddy.adjacent > 0 || enemy.buddy.two > 0 || enemy.buddy.three > 0)) || (enemy.hasExactly("Airborne Spear") && (!this.initiator || enemy.buddy.adjacent > 0 || enemy.buddy.two > 0))) && enemyEffRes + enemy.getPhantom("Res") > thisEffRes + this.getPhantom("Res")){
				var ccMult = Math.min(enemyEffRes + enemy.getPhantom("Res") - thisEffRes - this.getPhantom("Res"),10);
				dmgCut = ccMult * 0.04;
				damageText += enemy.name + " reduces damage by " + dmgCut + " from " + data.skills[enemy.weaponIndex].name + ". ";
			}
			//Spd check Reduction (up to 40%)
			if((enemy.has("Guardian Fang") || enemy.hasExactly("Nightmare Horn") || (enemy.hasExactly("Bun-Bun Baton") && enemy.rValue == 5) || ((enemy.hasExactly("Brightmare Horn") || enemy.hasExactly("Liberation") || enemy.hasExactly("Monarch Blade")) && enemy.combatStartHp / enemy.maxHp >= 0.25)) && enemy.getPhantom("Spd") + enemyEffSpd > this.getPhantom("Spd") + thisEffSpd){
				var ccMult = Math.min((enemy.getPhantom("Spd") + enemyEffSpd) - (this.getPhantom("Spd") + thisEffSpd),10);
				dmgCut = ccMult * 0.04;
				damageText += enemy.name + " reduces damage by " + dmgCut + " from " + data.skills[enemy.weaponIndex].name + ". ";
			}
			if(enemy.hasExactly("Summer Strikers") && ((enemy.rValue < 0 && !this.initiator && enemy.combatStartHp / enemy.maxHp >= 0.25 && firstHit) || (enemy.rValue > 0 && (!this.initiator || this.range == "ranged") && (firstHit || brave == 6)))){
				dmgCut = 0.75;
				damageText += enemy.name + " reduces damage by 0.75 from Summer Strikers. ";
			}
			//Genealogy Weapon reduction
			if(firstHit == true && (enemy.has("Courtly Mask") || enemy.has("Courtly Bow") || enemy.has("Courtly Candle") || enemy.has("Stout Lance") || enemy.has("Stout Axe")) && enemy.combatStartHp / enemy.maxHp >= 0.5 && thisFollowUp){
				dmgCut = 0.5;
				damageText += enemy.name + " reduces damage by 0.5 from weapon. ";
			}
			if(enemy.hasExactly("Dark Creator S") && (enemy.toggle.weapon > 10 || (enemy.rValue > 0 && enemy.toggle.weapon % 10 > 0))){
				dmgCut = ((enemy.toggle.weapon % 10) * 15) / 100;
				if(enemy.toggle.weapon > 10 && enemy.rValue > 0){
					dmgCut = ((enemy.toggle.weapon % 10) * 25) / 100;
				}
				damageText += enemy.name + " reduces damage by " + dmgCut + " from Dark Creator S. ";
			}
			//Areadbhar Reduction (can stack with CCall)
			if(enemy.hasExactly("Areadbhar") && enemy.combatStartHp / enemy.maxHp >= 0.25 && enemy.getPhantom("Spd") + enemyEffSpd > this.getPhantom("Spd") + thisEffSpd){
				var ccMult = Math.min((enemy.getPhantom("Spd") + enemyEffSpd) - (this.getPhantom("Spd") + thisEffSpd),10);
				dmgCut = ccMult * 0.04;
				damageText += enemy.name + " reduces damage by " + dmgCut + " from Areadbhar. ";
			}
			//Lilac-Jade Breath
			if(enemy.hasExactly("Lilac-Jade Breath") && (this.initiator || this.combatStartHp / this.maxHp >= 1)){
				dmgCut = 0.4;
				damageText += enemy.name + " reduces damage by " + dmgCut + " from Lilac-Jade Breath. ";
			}
			if(enemy.hasExactly("Lyngheidr") && (!this.initiator || (enemy.rValue > 0 && (enemy.buddy.adjacent > 0 || enemy.buddy.two > 0))) && (firstHit || (enemy.rValue > 0 && brave == 6))){
				dmgCut = 0.3;
				if(enemy.rValue > 0){
					dmgCut = 0.4;
				}
				damageText += enemy.name + " reduces damage by " + dmgCut + " from Lyngheidr. ";
			}
			//Hrist reduction
			if(enemy.hasExactly("Hrist") && firstHit == true && enemy.combatStartHp / enemy.maxHp < 1){
				dmgCut = 0.3;
				damageText += enemy.name + " reduces damage by 0.3 from Hrist. ";
			}
			//Loyalist Axe/Sea-Sear Lance reduction
			if((enemy.hasExactly("Loyalist Axe") || enemy.hasExactly("Sea-Sear Lance") || enemy.hasExactly("Starlight Stone")) && (this.initiator || this.combatStartHp / this.maxHp >= 0.75) && thisFollowUp && firstHit){
				dmgCut = 0.75;
				damageText += enemy.name + " reduces damage by 0.75 from " + data.skills[enemy.weaponIndex].name + ". ";
			}
			//Refined Ayra's Blade
			if(enemy.hasExactly("Ayra's Blade") && enemy.rValue == 5 && this.combatStartHp / this.maxHp >= 0.75 && firstHit){
				dmgCut = 0.2;
				damageText += enemy.name + " reduces damage by 0.2 from Ayra's Blade. ";
			}
			if(enemy.hasExactly("Hallowed Tyrfing") && ((enemy.rValue < 0 && this.combatStartHp / this.maxHp >= 0.75 && (!this.initiator || this.range == "ranged") && firstHit) || (enemy.rValue > 0 && (this.combatStartHp / this.maxHp >= 0.75 || !this.initiator) && (firstHit || brave == 6)))){
				dmgCut = 0.4;
				damageText += enemy.name + " reduces damage by 0.4 from Hallowed Tyrfing. ";
			}
			//Refined Huginn's Egg
			if(enemy.hasExactly("Huginn's Egg") && enemy.rValue == 5 && (!this.initiator || enemy.toggle.weapon > 9) && firstHit){
				dmgCut = 0.3;
				damageText += enemy.name + " reduces damage by 0.3 from Huginn's Egg. ";
			}
			//Ginnungagap's Reduction
			if(enemy.hasExactly("Ginnungagap") && enemy.combatStartHp / enemy.maxHp >= 0.25 && firstHit && (!this.initiator || (this.initiator && (this.weaponType.indexOf("tome") != -1 || this.weaponType == "staff")))){
				dmgCut = 0.4;
				damageText += enemy.name + " reduces damage by 0.4 from Ginnungagap. ";
			}
			//Binding Reginleif Reduction
			if(enemy.hasExactly("Binding Reginleif") && enemy.combatStartHp / enemy.maxHp >= 0.25 && firstHit){
				dmgCut = 0.3;
				if(enemy.rValue > 0){
					dmgCut = 0.4;
				}
				damageText += enemy.name + " reduces damage by " + dmgCut + " from Binding Reginleif. ";
			}
			if(enemy.hasExactly("Phantasm Tome") && (this.combatStartHp / this.maxHp >= 0.5 || (enemy.rValue > 0 && !this.initiator)) && firstHit){
				if(enemy.rValue < 0 && !this.initiator){
					dmgCut = 0.7;
				}
				else if(enemy.rValue > 0){
					if(!this.initiator){
						dmgCut = 0.8;
					}
					else{
						dmgCut = 0.3;
					}
				}
				damageText += enemy.name + " reduces damage by " + dmgCut + " from Phantasm Tome. ";
			}
			//Refined Ninis's Ice Lance Reduction
			if(enemy.hasExactly("Ninis's Ice Lance") && enemy.rValue == 5 && (enemy.toggle.weapon == 1 || enemy.initiator) && enemy.getPhantom("Spd") + enemyEffSpd > this.getPhantom("Spd") + thisEffSpd){
				var ccMult = Math.min((enemy.getPhantom("Spd") + enemyEffSpd) - (this.getPhantom("Spd") + thisEffSpd),10);
				dmgCut = ccMult * 0.04;
				damageText += enemy.name + " reduces damage by " + dmgCut + " from Ninis's Ice Lance. ";
			}
			//Refined Thunder Armads Reduction
			if(enemy.hasExactly("Thunder Armads") && enemy.rValue == 5 && (this.initiator || this.combatStartHp / this.maxHp >= 0.75) && firstHit){
				dmgCut = 0.4;
				damageText += enemy.name + " reduces damage by 0.4 from Thunder Armads. ";
			}
			//Carnage Amatsu
			if(enemy.hasExactly("Carnage Amatsu") && enemy.toggle.weapon == 1 && enemy.getPhantom("Spd") + enemyEffSpd > this.getPhantom("Spd") + thisEffSpd){
				var ccMult = Math.min((enemy.getPhantom("Spd") + enemyEffSpd) - (this.getPhantom("Spd") + thisEffSpd),10);
				dmgCut = ccMult * 0.04;
				damageText += enemy.name + " reduces damage by " + dmgCut + " from Carnage Amatsu. ";
			}
			if((enemy.hasExactly("Storm Sieglinde") || enemy.hasExactly("Balmung")) && enemy.rValue == 5 && enemy.combatStartHp / enemy.maxHp >= 0.25 && enemy.getPhantom("Spd") + enemyEffSpd > this.getPhantom("Spd") + thisEffSpd){
				var ccMult = Math.min((enemy.getPhantom("Spd") + enemyEffSpd) - (this.getPhantom("Spd") + thisEffSpd),10);
				dmgCut = ccMult * 0.04;
				damageText += enemy.name + " reduces damage by " + dmgCut + " from " + data.skills[enemy.weaponIndex].name + ". ";
			}
			//Refined Spirit Breath
			if(enemy.hasExactly("Spirit Breath") && enemy.rValue == 5 && enemy.toggle.weapon == 1 && !enemy.initiator && firstHit == false && brave != 6){
				dmgCut = 0.7;
				damageText += enemy.name + " reduces damage by 0.7 from Spirit Breath. ";
			}
			//Refined Draconic Rage
			if(enemy.hasExactly("Draconic Rage") && enemy.rValue > 0 && (!this.initiator || enemy.toggle.weapon == 1) && firstHit == true){
				dmgCut = 0.4;
				damageText += enemy.name + " reduces damage by 0.4 from Draconic Rage. ";
			}
			//Gerbera Axe
			if(enemy.hasExactly("Gerbera Axe") && (this.combatStartHp / this.maxHp >= 0.75 || this.initiator) && firstHit){
				dmgCut = 0.4;
				damageText += enemy.name + " reduces damage by 0.4 from Gerbera Axe. ";
			}
			//Achimenes Furl
			if(enemy.hasExactly("Achimenes Furl") && enemy.toggle.weapon > 1 && firstHit){
				dmgCut = 0.3;
				damageText += enemy.name + " reduces damage by 0.3 from Achimenes Furl. ";
			}
			//Refined Hurricane Dagger
			if(enemy.hasExactly("Hurricane Dagger") && enemy.rValue == 5 && enemy.combatStartHp / enemy.maxHp >= 0.25 && enemy.getPhantom("Spd") + enemyEffSpd > this.getPhantom("Spd") + thisEffSpd){
				var ccMult = Math.min((enemy.getPhantom("Spd") + enemyEffSpd) - (this.getPhantom("Spd") + thisEffSpd),10);
				dmgCut = ccMult * 0.03;
				damageText += enemy.name + " reduces damage by " + dmgCut + " from Hurricane Dagger. ";
			}
			if(enemy.hasExactly("Sturdy War Sword") && enemy.combatStartHp / enemy.maxHp >= 0.25 && enemy.toggle.weapon > 1 && enemy.specialIndex != -1 && data.defensiveSpecials.indexOf(data.skills[enemy.specialIndex].name) == -1 && data.gaeSpecials.indexOf(data.skills[enemy.specialIndex].name) == -1 && firstHit){
				dmgCut = Math.round(data.skills[enemy.specialIndex].charge * 10) / 100;
				damageText += enemy.name + " reduces damage by " + dmgCut + " from Sturdy War Sword. ";
			}
			//20% Def Flat DR
			if(((enemy.hasExactly("Pastel Poleaxe") || ((enemy.hasExactly("Crimson Lance") || enemy.hasExactly("Ancient Voice")) && (firstHit || brave == 6))) && enemy.combatStartHp / enemy.maxHp >= 0.25) || (enemy.hasExactly("Illuminating Horn") && (!this.initiator || enemy.toggle.weapon == 1)) || (enemy.hasExactly("Moon Gradivus") && enemy.rValue == 5 && enemy.toggle.weapon == 1) || enemy.hasExactly("Wyvern Ono") || (enemy.hasExactly("Duality Vessel") && enemy.toggle.weapon == 1) || (enemy.hasExactly("Imbued Koma") && enemy.rValue > 0 && enemy.specialIndex != -1 && (data.skills[enemy.specialIndex].charge <= enemy.charge || enemy.sTrigger == 1)) || (enemy.hasExactly("Charging Horn") && enemy.rValue == 5 && enemy.combatStartHp / enemy.maxHp >= 0.25) || (enemy.hasExactly("Mercenary Lance") && (this.initiator || this.combatStartHp / this.maxHp >= 0.75)) || (enemy.hasExactly("Tiger-Roar Axe") && enemy.rValue > 0 && (!this.initiator || enemy.buddy.adjacent > 0 || enemy.buddy.two > 0)) || ((enemy.hasExactly("Horn of Harvest") || enemy.hasExactly("Fell Slaystone")) && (this.initiator || this.combatStartHp / this.maxHp >= 0.75)) || (enemy.hasExactly("Obsidian Lance") && enemy.rValue > 0 && (this.combatStartHp / this.maxHp >= 0.75 || enemy.buddy.adjacent < 2)) || (enemy.hasExactly("Bereft Lance") && enemy.rValue > 0)){
				var tRed = Math.floor(enemyEffDef * 0.2);
				flatReduction += tRed;
				damageText += enemy.name + " reduces damage by " + tRed + " from " + data.skills[enemy.weaponIndex].name + ". ";
			}
			if((enemy.hasExactly("Dreaming Spear") && enemy.toggle.weapon == 1) || ((enemy.hasExactly("Radiant Aureola") || enemy.hasExactly("Nectar Horn") || enemy.hasExactly("Opposing Stones")) && (this.initiator || this.combatStartHp / this.maxHp >= 0.75)) || ((((enemy.hasExactly("Remote Breath") || enemy.hasExactly("Moonless Breath")) && enemy.rValue == 5) || enemy.hasExactly("Quieting Branch") || enemy.hasExactly("Fundament")) && enemy.combatStartHp / enemy.maxHp >= 0.25) || (enemy.hasExactly("Dazzling Breath") && enemy.rValue == 5 && enemy.buddy.adjacent + enemy.buddy.two + enemy.buddy.three > 0) || (enemy.hasExactly("Blessed Aureola") && enemy.buddy.rorc > 0)){
				var tRed = Math.floor(enemyEffRes * 0.2);
				flatReduction += tRed;
				damageText += enemy.name + " reduces damage by " + tRed + " from " + data.skills[enemy.weaponIndex].name + ". ";
				if(enemy.hasExactly("Quieting Branch") && offensiveSpecialActivated){
					flatReduction += tRed;
					damageText += enemy.name + " reduces damage further by " + tRed + " from " + data.skills[enemy.weaponIndex].name + ". ";
				}
			}
			if((enemy.hasExactly("Noble Lance") && enemy.rValue == 5 && (!this.initiator || this.combatStartHp / this.maxHp >= 0.75)) || (enemy.hasExactly("Spear") && enemy.combatStartHp / enemy.maxHp >= 0.25)){
				var tRed = Math.floor(enemyEffAtk * 0.1);
				flatReduction += tRed;
				damageText += enemy.name + " reduces damage by " + tRed + " from " + data.skills[enemy.weaponIndex].name + ". ";
			}
			if(enemy.hasExactly("Revealing Breath") && (this.initiator || this.combatStartHp / this.maxHp >= 0.75) && firstHit == false && brave != 6){
				var tRed = Math.floor(enemyEffRes * 0.3);
				flatReduction += tRed;
				damageText += enemy.name + " reduces damage by " + tRed + " from " + data.skills[enemy.weaponIndex].name + ". ";
			}
			if(((enemy.hasExactly("Tempest's Claw") && (!this.initiator || enemy.toggle.weapon == 1)) || (enemy.hasExactly("Revenger Lance") && enemy.combatStartHp / enemy.maxHp >= 0.25) || (enemy.hasExactly("Resolved Fang") && enemy.buddy.adjacent + enemy.buddy.two + enemy.buddy.three > 0)) && enemy.rValue == 5){
				var tRed = Math.floor(enemyEffDef * 0.15);
				flatReduction += tRed;
				damageText += enemy.name + " reduces damage by " + tRed + " from " + data.skills[enemy.weaponIndex].name + ". ";
			}
			if((((enemy.hasExactly("Silent Breath") || (enemy.hasExactly("Primordial Breath") && enemy.rValue > 0)) && (this.initiator || this.combatStartHp / this.maxHp >= 0.75)) || (enemy.hasExactly("New Year Talon") && (enemy.transform == true || this.combatStartHp / this.maxHp >= 0.75)) || ((enemy.has("Jehanna Dagger") || enemy.has("Jehanna Lance")) && enemy.buddy.adjacent + enemy.buddy.two + enemy.buddy.three > 0) || (enemy.hasExactly("Frostfire Breath") && enemy.rValue > 0 && (Object.values(enemy.bonus).reduce((a, item) => a + (item === true ? 1 : 0), 0) + enemy.bonus.extra > 0 || checkAllBuffs(enemy, this, turn))) || (enemy.hasExactly("Sparking Tome") && enemy.rValue == 5 && (!this.initiator || enemy.buddy.adjacent > 0 || enemy.buddy.two > 0)) || (enemy.hasExactly("Silesse Frost") && enemy.rValue > 0 && (!this.initiator || this.combatStartHp / this.maxHp >= 0.5))) && (firstHit || brave == 6)){
				flatReduction += 7;
				damageText += enemy.name + " reduces damage by 7 from " + data.skills[enemy.weaponIndex].name + ". ";
			}
			if(enemy.hasExactly("Zephyr Breath") && enemy.rValue == 5 && (this.initiator || this.combatStartHp / this.maxHp >= 0.75) && (firstHit || brave == 6)){
				flatReduction += 5;
				damageText += enemy.name + " reduces damage by 5 from Zephyr Breath. ";
			}
			if((enemy.hasExactly("Fair-Fight Blade") && enemy.combatStartHp / enemy.maxHp >= 0.25) || (enemy.hasExactly("Bold Kusarigama") && (!this.initiator || enemy.buddy.adjacent > 0 || enemy.buddy.two > 0))){
				var tRed = Math.floor(enemyEffDef * 0.25);
				flatReduction += tRed;
				damageText += enemy.name + " reduces damage by " + tRed + " from " + data.skills[enemy.weaponIndex].name + ". ";
			}
			if((enemy.hasExactly("Cute Paper Crane") || enemy.has("Dragon's Stone") || (enemy.hasExactly("Double Bow") && enemy.rValue == 5)) && enemy.combatStartHp / enemy.maxHp >= 0.25 && (firstHit || brave == 6)){
				var tRed = Math.floor(enemyEffSpd * 0.25);
				flatReduction += tRed;
				damageText += enemy.name + " reduces damage by " + tRed + " from " + data.skills[enemy.weaponIndex].name + ". ";
			}
			if(enemy.has("New-Sun Stone") && enemy.combatStartHp / enemy.maxHp >= 0.25 && (firstHit || brave == 6)){
				var tRed = Math.floor(enemyEffAtk* 0.15);
				flatReduction += tRed;
				damageText += enemy.name + " reduces damage by " + tRed + " from " + data.skills[enemy.weaponIndex].name + ". ";
			}
			if(enemy.hasExactly("Rinkah's Club") && enemy.rValue > 0 && (this.initiator || enemy.combatStartHp / enemy.maxHp < 1 || this.combatStartHp / this.maxHp >= 0.75) && (firstHit || brave == 6)){
				var tRed = Math.floor(enemyEffDef * 0.15);
				flatReduction += tRed;
				damageText += enemy.name + " reduces damage by " + tRed + " from Rinkah's Club. ";
			}
			if((enemy.hasExactly("Lucky Bow") && (this.initiator || this.combatStartHp / this.maxHp >= 0.75)) || (enemy.hasExactly("War-God Mjolnir") && enemy.rValue == 5 && enemy.combatStartHp / enemy.maxHp >= 0.25) || ((enemy.hasExactly("Arcane Giant Axe") || enemy.hasExactly("Arcane Fell Arts")) && (this.initiator || enemy.combatStartHp / enemy.maxHp >= 0.25))){
				var tRed = Math.floor(enemyEffAtk * 0.15);
				flatReduction += tRed;
				damageText += enemy.name + " reduces damage by " + tRed + " from " + data.skills[enemy.weaponIndex].name + ". ";
			}
			if(enemy.hasExactly("Daydream Egg") && (this.combatStartHp / this.maxHp >= 0.75 || this.checkBonPen(3,enemy,turn))){
				var tRed = Math.floor(enemyEffRes * 0.2);
				flatReduction += tRed;
				damageText += enemy.name + " reduces damage by " + tRed + " from " + data.skills[enemy.weaponIndex].name + ". ";
			}
			if(enemy.hasExactly("Forager Naginata") && enemy.combatStartHp / enemy.maxHp >= 0.25 && (firstHit || brave == 6)){
				var tRed = Math.min((enemy.buddy.adjacent + enemy.buddy.two + enemy.buddy.three) * 3 + 1, 10);
				flatReduction += tRed;
				damageText += enemy.name + " reduces damage by " + tRed + " from " + data.skills[enemy.weaponIndex].name + ". ";
			}
			if(enemy.hasExactly("Amatsu") && enemy.rValue > 0 && enemy.combatStartHp / enemy.maxHp >= 0.25 && (firstHit || brave == 6)){
				flatReduction += 7;
				damageText += enemy.name + " reduces damage by 7 from Amatsu. ";
			}
			if(enemy.hasExactly("Ereshkigal") && enemy.combatStartHp / enemy.maxHp >= 0.25){
				var tRed = Math.min((Object.values(enemy.bonus).reduce((a, item) => a + (item === true ? 1 : 0), 0) + enemy.bonus.extra) * 3, 15);
				flatReduction += tRed;
				damageText += enemy.name + " reduces damage by " + tRed + " from " + data.skills[enemy.weaponIndex].name + ". ";
			}
			if(((enemy.hasExactly("Closing Florets") || (enemy.hasExactly("Petaldream Horn") && (firstHit || brave == 6))) && enemy.combatStartHp / enemy.maxHp >= 0.25) || ((enemy.hasExactly("Sisterly Axe") || enemy.hasExactly("Swirling Lance")) && enemy.buddy.adjacent + enemy.buddy.two + enemy.buddy.three > 0) || (((enemy.hasExactly("Inner Wellspring") && enemy.rValue > 0) || enemy.hasExactly("Snaking Sword") || enemy.hasExactly("Azure Twin Edge")) && (!this.initiator || enemy.buddy.adjacent > 0 || enemy.buddy.two > 0) && (firstHit || brave == 6)) || (enemy.hasExactly("Ice-Crystal Spear") && (this.initiator || this.combatStartHp / this.maxHp >= 0.75)) || (enemy.hasExactly("Laconic Axe") && (!this.initiator || enemy.buddy.rorc > 0) && (firstHit || brave == 6))){
				var tRed = Math.floor(enemyEffSpd * 0.2);
				flatReduction += tRed;
				damageText += enemy.name + " reduces damage by " + tRed + " from " + data.skills[enemy.weaponIndex].name + ". ";
			}
			if((((enemy.hasExactly("Hoshido's Breath") || enemy.hasExactly("Arcane Blutgang") || enemy.hasExactly("Arcane Truthfire") || enemy.hasExactly("Arcane Sly Knife") || enemy.hasExactly("Red-Fist Blades") || enemy.hasExactly("Fimbulvetr Morn") || enemy.hasExactly("Rampart Bow") || enemy.hasExactly("Arcane Medusa") || enemy.hasExactly("Tome of Fury") || enemy.hasExactly("Ancient Trickery")) && enemy.combatStartHp / enemy.maxHp >= 0.25) || ((enemy.hasExactly("Ilian Frost Blade") || enemy.hasExactly("Aerial Longsword")) && (!this.initiator || enemy.buddy.adjacent > 0 || enemy.buddy.two > 0))) && (firstHit || brave == 6)){
				flatReduction += 7;
				damageText += enemy.name + " reduces damage by 7 from " + data.skills[enemy.weaponIndex].name + ". ";
			}
			if((enemy.hasExactly("Chaos Ragnell") || enemy.hasExactly("Ebon Bolverk")) && enemy.rValue == 5 && enemy.combatStartHp / enemy.maxHp >= 0.25 && (firstHit || brave == 6)){
				flatReduction += 7;
				damageText += enemy.name + " reduces damage by 7 from " + data.skills[enemy.weaponIndex].name + ". ";
			}
			if(enemy.hasExactly("Caladbolg") && enemy.combatStartHp / enemy.maxHp >= 0.25){
				var tRed = 8;
				if(offensiveSpecialActivated){
					tRed = 16;
				}
				flatReduction += tRed;
				damageText += enemy.name + " reduces damage by " + tRed + " from Caladbolg. ";
			}
			if(enemy.hasExactly("Hrimfaxi") && enemy.rValue == 5 && (this.initiator || this.combatStartHp / this.maxHp >= 0.75) && (firstHit || brave == 6)){
				var tRed = 7;
				flatReduction += tRed;
				damageText += enemy.name + " reduces damage by " + tRed + " from Hrimfaxi. ";
			}
			if(enemy.hasExactly("Order's Sentence") && enemy.rValue == 5 && (!this.initiator || this.range == "ranged") && (firstHit || brave == 6)){
				var tRed = 0;
				if(!enemy.penalty.panic){
					tRed = Math.max(enemy.combatBuffs.atk,enemy.buffs.atk) + Math.max(enemy.combatBuffs.spd,enemy.buffs.spd) + Math.max(enemy.combatBuffs.def,enemy.buffs.def) + Math.max(enemy.combatBuffs.res,enemy.buffs.res);
				}
				tRed = Math.max(tRed,enemy.buddy.buffs.atk + enemy.buddy.buffs.spd + enemy.buddy.buffs.def + enemy.buddy.buffs.res);
				tRed = Math.floor(tRed * 0.5);
				flatReduction += tRed;
				damageText += enemy.name + " reduces damage by " + tRed + " from Order's Sentence. ";
			}
			if((enemy.hasExactly("Maritime Arts") || enemy.hasExactly("Wintery Arts")) && enemy.buddy.adjacent + enemy.buddy.two + enemy.buddy.three > 0 && (firstHit || brave == 6)){
				var tRed = 5 * enemy.toggle.weapon;
				flatReduction += tRed;
				damageText += enemy.name + " reduces damage by " + tRed + " from " + data.skills[enemy.weaponIndex].name + ". ";
			}
			if(enemy.hasExactly("Sunstone's Blade") && (!this.initiator || enemy.toggle.weapon == 1)){
				var tRed = Math.floor(enemyEffDef * 0.15);
				flatReduction += tRed;
				damageText += enemy.name + " reduces damage by " + tRed + " from Sunstone's Blade. ";
			}
			if((enemy.hasExactly("Quieting Antler") && (!this.initiator || enemy.buddy.adjacent > 0 || enemy.buddy.two > 0)) || (enemy.hasExactly("Vedrfolnir's Edge") && (!this.initiator || enemy.buddy.rorc > 0) && (firstHit || brave == 6 || offensiveSpecialActivated))){
				var xVal = 0;
				if(!enemy.penalty.panic){
					xVal = Math.max(enemy.combatBuffs.atk,enemy.buffs.atk) + Math.max(enemy.combatBuffs.spd,enemy.buffs.spd) + Math.max(enemy.combatBuffs.def,enemy.buffs.def) + Math.max(enemy.combatBuffs.res,enemy.buffs.res);
				}
				xVal = Math.max(xVal,enemy.buddy.buffs.atk + enemy.buddy.buffs.spd + enemy.buddy.buffs.def + enemy.buddy.buffs.res);
				xVal = Math.floor(xVal / 2);
				flatReduction += xVal;
				damageText += enemy.name + " reduces damage by " + xVal + " from " + data.skills[enemy.weaponIndex].name + ". ";
				if(enemy.hasExactly("Vedrfolnir's Edge") && (!this.initiator || enemy.buddy.rorc > 0) && (firstHit || brave == 6) && offensiveSpecialActivated){
					flatReduction += xVal;
					damageText += enemy.name + " reduces damage further by " + xVal + " from " + data.skills[enemy.weaponIndex].name + ". ";
				}
			}
			if(enemy.hasExactly("Spear of Assal") && enemy.rValue == 5 && enemy.buddy.adjacent + enemy.buddy.two + enemy.buddy.three > 0 && (firstHit || brave == 6)){
				var tRed = 7;
				flatReduction += tRed;
				damageText += enemy.name + " reduces damage by " + tRed + " from Spear of Assal. ";
			}
			if(enemy.hasExactly("Summertime Axe") && enemy.combatStartHp / enemy.maxHp >= 0.25){
				var saVal = Math.min((Object.values(enemy.bonus).reduce((a, item) => a + (item === true ? 1 : 0), 0) + enemy.bonus.extra + Object.values(this.bonus).reduce((a, item) => a + (item === true ? 1 : 0), 0) + this.bonus.extra) * 3, 18);
				flatReduction += saVal;
				damageText += enemy.name + " reduces damage by " + saVal + " from " + data.skills[enemy.weaponIndex].name + ". ";
				if(offensiveSpecialActivated){
					flatReduction += saVal;
					damageText += enemy.name + " reduces damage further by " + saVal + " from " + data.skills[enemy.weaponIndex].name + ". ";
				}
			}
			if(enemy.hasExactly("Majestic Glitnir") && (!this.initiator || enemy.buddy.rorc > 0)){
				var tRed = Math.floor(enemyEffDef * 0.1);
				flatReduction += tRed;
				damageText += enemy.name + " reduces damage by " + tRed + " from Majestic Glitnir. ";
			}
			if(enemy.hasExactly("Grim Brokkr") && enemy.rValue == 5 && enemy.combatStartHp / enemy.maxHp >= 0.25){
				var gbVal = Math.min((Object.values(enemy.bonus).reduce((a, item) => a + (item === true ? 1 : 0), 0) + enemy.bonus.extra + Object.values(this.penalty).reduce((a, item) => a + (item === true ? 1 : 0), 0) + this.penalty.extra) * 3, 12);
				flatReduction += gbVal;
				damageText += enemy.name + " reduces damage by " + gbVal + " from " + data.skills[enemy.weaponIndex].name + ". ";
				if(offensiveSpecialActivated){
					flatReduction += gbVal;
					damageText += enemy.name + " reduces damage further by " + gbVal + " from " + data.skills[enemy.weaponIndex].name + ". ";
				}
			}
			if(enemy.hasExactly("Holytide Tyrfing") && enemy.rValue == 5 && enemy.combatStartHp / enemy.maxHp >= 0.25){
				var htVal = Math.min(enemy.buddy.spaces * 3, 12);
				if(firstHit || brave == 6){
					flatReduction += htVal;
					damageText += enemy.name + " reduces damage by " + htVal + " from " + data.skills[enemy.weaponIndex].name + ". ";
				}
				if(offensiveSpecialActivated){
					flatReduction += htVal;
					damageText += enemy.name + " reduces damage by " + htVal + " from " + data.skills[enemy.weaponIndex].name + ". ";
				}
			}
			if((enemy.hasExactly("Desert Spear") && enemy.buddy.adjacent + enemy.buddy.two + enemy.buddy.three > 0 && offensiveSpecialActivated) || (enemy.hasExactly("Springing Spear") && enemy.buddy.rorc > 0)){
				flatReduction += 10;
				damageText += enemy.name + " reduces damage by 10 from " + data.skills[enemy.weaponIndex].name + ". ";
			}
			if(enemy.hasExactly("Suave Blade") && (!this.initiator || enemy.buddy.adjacent > 0 || enemy.buddy.two > 0) && (firstHit || brave == 6)){
				var sbVal = Math.min((Object.values(enemy.bonus).reduce((a, item) => a + (item === true ? 1 : 0), 0) + enemy.bonus.extra) * 3, 15);
				flatReduction += sbVal;
				damageText += enemy.name + " reduces damage by " + sbVal + " from " + data.skills[enemy.weaponIndex].name + ". ";
			}
			if(enemy.hasExactly("Praise-Piner Axe") && (this.initiator || this.combatStartHp / this.maxHp >= 0.75)){
				var tRed = Math.floor(enemyEffDef * 0.15);
				flatReduction += tRed;
				damageText += enemy.name + " reduces damage by " + tRed + " from Praise-Piner Axe. ";
			}
			if(enemy.hasExactly("Craver's Tome") && enemy.combatStartHp / enemy.maxHp >= 0.25 && enemy.buddy.adjacent + enemy.buddy.two > 0 && enemy.getPhantom("Res") + enemyEffRes > this.getPhantom("Res") + thisEffRes){
				var tRed = Math.min(enemyEffRes - thisEffRes, 20);
				tRed = Math.max(tRed, 0);
				flatReduction += tRed;
				damageText += enemy.name + " reduces damage by " + tRed + " from Craver's Tome. ";
			}
			if(enemy.hasExactly("Stone of Delights") && enemy.buddy.adjacent + enemy.buddy.two + enemy.buddy.three > 0){
				var tRed = Math.min(enemy.maxHp - this.combatStartHp, 16);
				tRed = Math.max(tRed, 8);
				flatReduction += tRed;
				damageText += enemy.name + " reduces damage by " + tRed + " from Stone of Delights. ";
			}
			if(enemy.hasExactly("Aureola") && enemy.rValue > 0 && (!this.initiator || enemy.buddy.adjacent > 0 || enemy.buddy.two > 0) && (firstHit || brave == 6)){
				var tRed = 0;
				if(!enemy.penalty.panic){
					tRed = Math.max(enemy.combatBuffs.atk,enemy.buffs.atk) + Math.max(enemy.combatBuffs.spd,enemy.buffs.spd) + Math.max(enemy.combatBuffs.def,enemy.buffs.def) + Math.max(enemy.combatBuffs.res,enemy.buffs.res);
				}
				tRed = Math.max(tRed,enemy.buddy.buffs.atk + enemy.buddy.buffs.spd + enemy.buddy.buffs.def + enemy.buddy.buffs.res);
				tRed = Math.floor(tRed * 0.4);
				flatReduction += tRed;
				damageText += enemy.name + " reduces damage by " + tRed + " from Aureola. ";
			}
			if((enemy.hasExactly("Enticing Dose") || enemy.hasExactly("New Year Fang")) && (enemy.transform == true || enemy.combatStartHp / enemy.maxHp >= 0.25)){
				var tRed = Math.max(this.maxHp - this.hp, 10);
				tRed = Math.min(tRed, 20);
				flatReduction += tRed;
				damageText += enemy.name + " reduces damage by " + tRed + " from " + data.skills[enemy.weaponIndex].name + ". ";
				if(offensiveSpecialActivated){
					flatReduction += tRed;
					damageText += enemy.name + " reduces damage further by " + tRed + " from " + data.skills[enemy.weaponIndex].name + ". ";
				}
			}
			if((enemy.hasExactly("Fellowship Blade") || (enemy.hasExactly("Sword of Peace") && (firstHit || brave == 6))) && enemy.buddy.adjacent + enemy.buddy.two + enemy.buddy.three > 0){
				var xVal = 0;
				if(!enemy.penalty.panic){
					xVal = Math.max(enemy.combatBuffs.atk,enemy.buffs.atk) + Math.max(enemy.combatBuffs.spd,enemy.buffs.spd) + Math.max(enemy.combatBuffs.def,enemy.buffs.def) + Math.max(enemy.combatBuffs.res,enemy.buffs.res);
				}
				xVal = Math.max(xVal,enemy.buddy.buffs.atk + enemy.buddy.buffs.spd + enemy.buddy.buffs.def + enemy.buddy.buffs.res);
				xVal = Math.floor(xVal * 0.5);
				flatReduction += xVal;
				damageText += enemy.name + " reduces damage by  " + xVal + " from " + data.skills[enemy.weaponIndex].name + ". ";
				if(enemy.hasExactly("Sword of Peace") && offensiveSpecialActivated){
					flatReduction += xVal;
					damageText += enemy.name + " reduces damage further by " + xVal + " from " + data.skills[enemy.weaponIndex].name + ". ";
				}
			}
			if(enemy.hasExactly("Icy Ravager") && (this.initiator || this.combatStartHp / this.maxHp >= 0.75)){
				var tRed = enemy.toggle.weapon * 3 + 10;
				flatReduction += tRed;
				damageText += enemy.name + " reduces damage by " + tRed + " from Icy Ravager. ";
			}
			if(enemy.hasExactly("Indignant Bow") && enemy.rValue == 5 && enemy.buddy.adjacent + enemy.buddy.two + enemy.buddy.three > 0){
				flatReduction += 10;
				damageText += enemy.name + " reduces damage by 10 from Indignant Bow. ";
				if(offensiveSpecialActivated){
					flatReduction += 10;
					damageText += enemy.name + " reduces damage further by 10 from Indignant Bow. ";
				}
			}
			if(enemy.hasExactly("Joker's Wild") && enemy.rValue == 5 && enemy.buddy.adjacent + enemy.buddy.two + enemy.buddy.three > 0 && (firstHit || brave == 6)){
				var tRed = Math.floor(Math.max(enemyEffDef, enemyEffRes) * 0.2);
				flatReduction += tRed;
				damageText += enemy.name + " reduces damage by  " + tRed + " from Joker's Wild. ";
			}
			if(enemy.hasExactly("Swirling Scimitar") && enemy.buddy.adjacent + enemy.buddy.two + enemy.buddy.three > 0 && (firstHit || brave == 6)){
				var tRed = Math.floor(enemyEffSpd * 0.25);
				flatReduction += tRed;
				damageText += enemy.name + " reduces damage by " + tRed + " from " + data.skills[enemy.weaponIndex].name + ". ";
			}
			if(enemy.hasExactly("Sword of Isaach") && enemy.combatStartHp / enemy.maxHp >= 0.25 && (firstHit || brave == 6)){
				var tRed = Math.min((Object.values(this.penalty).reduce((a, item) => a + (item === true ? 1 : 0), 0) + this.penalty.extra + Object.values(enemy.bonus).reduce((a, item) => a + (item === true ? 1 : 0), 0) + enemy.bonus.extra) * 3, 15);
				flatReduction += tRed;
				damageText += enemy.name + " reduces damage by " + tRed + " from " + data.skills[enemy.weaponIndex].name + ". ";
				if(offensiveSpecialActivated){
					flatReduction += tRed;
					damageText += enemy.name + " reduces damage further by " + tRed + " from " + data.skills[enemy.weaponIndex].name + ". ";
				}
			}
			if(enemy.hasExactly("Horn of Opening") && enemy.rValue > 0 && enemy.buddy.adjacent + enemy.buddy.two + enemy.buddy.three > 0){
				var hoVar = Math.min((enemy.buddy.adjacent + enemy.buddy.two + enemy.buddy.three) * 0.1, 0.3);
				var tRed = Math.floor(enemyEffDef * hoVar);
				flatReduction += tRed;
				damageText += enemy.name + " reduces damage by " + tRed + " from " + data.skills[enemy.weaponIndex].name + ". ";
				if(offensiveSpecialActivated){
					flatReduction += tRed;
					damageText += enemy.name + " reduces damage further by " + tRed + " from " + data.skills[enemy.weaponIndex].name + ". ";
				}
			}
			if((enemy.hasExactly("Eagle's Heart") && (!this.initiator || enemy.buddy.adjacent < 2)) || (enemy.hasExactly("Lion's Heart") && (!this.initiator || enemy.buddy.adjacent > 0 || enemy.buddy.two > 0) && (firstHit || brave == 6))){
				var tRed = Math.min((Object.values(enemy.bonus).reduce((a, item) => a + (item === true ? 1 : 0), 0) + enemy.bonus.extra + Object.values(this.penalty).reduce((a, item) => a + (item === true ? 1 : 0), 0) + this.penalty.extra) * 3, 15);
				flatReduction += tRed;
				damageText += enemy.name + " reduces damage by " + tRed + " from " + data.skills[enemy.weaponIndex].name + ". ";
				if(offensiveSpecialActivated){
					flatReduction += tRed;
					damageText += enemy.name + " reduces damage further by " + tRed + " from " + data.skills[enemy.weaponIndex].name + ". ";
				}
			}
			if(enemy.hasExactly("Devoted Breath") && (this.initiator || this.combatStartHp / this.maxHp >= 0.75)){
				var tRed = Math.min((enemy.buddy.adjacent + enemy.buddy.two + enemy.buddy.three) * 5, 15);
				flatReduction += tRed;
				damageText += enemy.name + " reduces damage by " + tRed + " from " + data.skills[enemy.weaponIndex].name + ". ";
			}
			if(enemy.hasExactly("True-Bond Bow") && (!this.initiator || enemy.buddy.adjacent > 0 || enemy.buddy.two > 0) && (firstHit || brave == 6)){
				var tRed = Math.min((enemy.talent.atk + enemy.talent.spd) * 2, 30);
				flatReduction += tRed;
				damageText += enemy.name + " reduces damage by " + tRed + " from " + data.skills[enemy.weaponIndex].name + ". ";
			}
			if(enemy.hasExactly("Taciturn Axe") && enemy.buddy.adjacent + enemy.buddy.two + enemy.buddy.three > 0){
				var tRed = Math.floor(enemyEffDef * (0.2 + (enemy.toggle.weapon * 0.1)));
				flatReduction += tRed;
				damageText += enemy.name + " reduces damage by " + tRed + " from " + data.skills[enemy.weaponIndex].name + ". ";
			}
			if(enemy.hasExactly("Duskstone") && enemy.combatStartHp / enemy.maxHp >= 0.25){
				var tRed = Math.min((enemy.buddy.adjacent + enemy.buddy.two + enemy.buddy.three) * 5, 15);
				flatReduction += tRed;
				damageText += enemy.name + " reduces damage by " + tRed + " from " + data.skills[enemy.weaponIndex].name + ". ";
			}
			if(enemy.hasExactly("Sword of Dusk") && enemy.combatStartHp / enemy.maxHp >= 0.25){
				var tRed = Math.floor(enemyEffDef * 0.15);
				if(this.combatStartHp / this.maxHp >= 0.5){
					tRed = Math.floor(enemyEffDef * 0.25);
				}
				flatReduction += tRed;
				damageText += enemy.name + " reduces damage by " + tRed + " from " + data.skills[enemy.weaponIndex].name + ". ";
			}
			if(enemy.hasExactly("Ancient Betrayal") && enemy.combatStartHp / enemy.maxHp >= 0.25){
				var tRed = enemy.toggle.weapon * 5 + 10;
				flatReduction += tRed;
				damageText += enemy.name + " reduces damage by " + tRed + " from " + data.skills[enemy.weaponIndex].name + ". ";
			}
			if(enemy.hasExactly("Jaws of Closure") && enemy.combatStartHp / enemy.maxHp >= 0.25 && (firstHit || brave == 6)){
				var tRed = (Math.min(this.buddy.adjacent + this.buddy.two + this.buddy.three, 3)) * 6 + 6;
				flatReduction += tRed;
				damageText += enemy.name + " reduces damage by " + tRed + " from " + data.skills[enemy.weaponIndex].name + ". ";
			}
	
			if((enemy.hasExactly("Atk Spd Excel") || enemy.hasExactly("Atk Def Excel")) && enemy.buddy.spaces > 0){
				if(!this.initiator){
					var tRed = Math.min(enemy.buddy.spaces * 3, 12);
					flatReduction += tRed;
					damageText += enemy.name + " reduces damage by " + tRed + " from " + data.skills[enemy.aIndex].name + ". ";
				}
				if(offensiveSpecialActivated){
					var tRed = Math.min(enemy.buddy.spaces * 3, 12);
					flatReduction += tRed;
					damageText += enemy.name + " reduces damage further by " + tRed + " from " + data.skills[enemy.aIndex].name + ". ";
				}
			}
			if(enemy.hasExactly("Realms United") && (this.initiator || this.combatStartHp / this.maxHp >= 0.75) && (firstHit || brave == 6)){
				flatReduction += 7;
				damageText += enemy.name + " reduces damage by 7 from Realms United. ";
			}
			if(enemy.hasExactly("Fortifications") && !this.initiator && offensiveSpecialActivated){
				flatReduction += 10;
				damageText += enemy.name + " reduces damage by 10 from Fortifications. ";
			}
			if(enemy.hasExactly("Protective") && enemy.combatStartHp / enemy.maxHp >= 0.25 && (this.emblem != "none" || enemy.getPhantom("Res") + enemyEffRes >= this.getPhantom("Res") + thisEffRes + 5) && (firstHit || brave == 6)){
				var tRed = Math.floor(thisEffAtk * 0.15);
				flatReduction += tRed;
				damageText += enemy.name + " reduces damage by " + tRed + " from " + data.skills[enemy.aIndex].name + ". ";
			}
			if(enemy.hasExactly("Nihility's Undoing") && (enemy.transform == true || this.combatStartHp / this.maxHp >= 0.75)){
				var tRed = Math.min(enemy.buddy.spaces * 4, 12);
				flatReduction += tRed;
				damageText += enemy.name + " reduces damage by " + tRed + " from " + data.skills[enemy.aIndex].name + ". ";
				if(offensiveSpecialActivated){
					flatReduction += tRed;
					damageText += enemy.name + " reduces damage further by " + tRed + " from " + data.skills[enemy.aIndex].name + ". ";
				}
			}
			if(enemy.has("Blue Skies") && (!this.initiator || enemy.buddy.adjacent > 0 || enemy.buddy.two > 0) && (firstHit || brave == 6)){
				var tRed = enemy.buddy.rorc * 2;
				if(enemy.has("Blue Skies") == 1){
					tRed = enemy.buddy.rorc;
				}
				else if(enemy.has("Blue Skies") == 4){
					tRed = enemy.buddy.rorc * 2 + 2;
				}
				tRed = Math.min(tRed, enemy.has("Blue Skies") * 2);
				flatReduction += tRed;
				damageText += enemy.name + " reduces damage by " + tRed + " from " + data.skills[enemy.aIndex].name + ". ";
			}
			if(enemy.hasExactly("New Opening") && (enemy.transform == true || this.combatStartHp / this.maxHp >= 0.75) && (firstHit || brave == 6)){
				var tRed = Math.min(enemy.buddy.spaces * 4, 12);
				flatReduction += tRed;
				damageText += enemy.name + " reduces damage by " + tRed + " from " + data.skills[enemy.aIndex].name + ". ";
				if(offensiveSpecialActivated){
					flatReduction += tRed;
					damageText += enemy.name + " reduces damage further by " + tRed + " from " + data.skills[enemy.aIndex].name + ". ";
				}
			}
			
			if(enemy.hasExactly("Wyvern Rift") && enemyEffSpd + enemyEffDef >= thisEffSpd + thisEffDef - 10 && (firstHit || brave == 6)){
				var tRed = Math.min(allStats[22] - 35,7);
				tRed = Math.max(tRed,0);
				flatReduction += tRed;
				damageText += enemy.name + " reduces damage by  " + tRed + " from " + data.skills[enemy.bIndex].name + ". ";
			}
			if(enemy.hasExactly("Pegasus Rift") && enemyEffSpd + enemyEffRes >= thisEffSpd + thisEffRes - 10 && (firstHit || brave == 6)){
				var tRed = Math.min(allStats[23] - 30,10);
				tRed = Math.max(tRed,0);
				flatReduction += tRed;
				damageText += enemy.name + " reduces damage by  " + tRed + " from " + data.skills[enemy.bIndex].name + ". ";
			}
			if(enemy.hasExactly("Under the Sun") && enemy.combatStartHp / enemy.maxHp >= 0.25 && (firstHit || brave == 6)){
				var tRed = Math.floor(enemyEffSpd * 0.25);
				flatReduction += tRed;
				damageText += enemy.name + " reduces damage by " + tRed + " from " + data.skills[enemy.bIndex].name + ". ";
			}
			if(enemy.hasExactly("Believe in Love") || enemy.hasExactly("Faithful Loyalty 2")){
				var xVal = 0;
				if(!enemy.penalty.panic){
					xVal = Math.max(enemy.combatBuffs.atk,enemy.buffs.atk) + Math.max(enemy.combatBuffs.spd,enemy.buffs.spd) + Math.max(enemy.combatBuffs.def,enemy.buffs.def) + Math.max(enemy.combatBuffs.res,enemy.buffs.res);
				}
				xVal = Math.max(xVal,enemy.buddy.buffs.atk + enemy.buddy.buffs.spd + enemy.buddy.buffs.def + enemy.buddy.buffs.res);
				if(this.moveType == "cavalry" || this.moveType == "armored"){
					flatReduction += xVal;
					damageText += enemy.name + " reduces damage by  " + xVal + " from " + data.skills[enemy.bIndex].name + ". ";
				}
				else if(firstHit || brave == 6){
					xVal = Math.floor(xVal * 0.4);
					flatReduction += xVal;
					damageText += enemy.name + " reduces damage by  " + xVal + " from " + data.skills[enemy.bIndex].name + ". ";
				}
			}
			if((enemy.has("Laguz Friend") || enemy.hasExactly("Laguz Loyalty")) && enemy.specialIndex != -1 && data.gaeSpecials.indexOf(data.skills[enemy.specialIndex].name) == -1 && (data.defensiveSpecials.indexOf(data.skills[enemy.specialIndex].name) != -1 || data.skills[enemy.specialIndex].charge - enemy.initSkillCharge() >= 3)){
				var tRed = Math.max(enemyEffDef, enemyEffRes) * (enemy.has("Laguz Friend") * 0.05);
				if(enemy.hasExactly("Laguz Loyalty")){
					tRed = enemyEffSpd * 0.2;
				}
				tRed = Math.floor(tRed);
				flatReduction += tRed;
				damageText += enemy.name + " reduces damage by  " + tRed + " from " + data.skills[enemy.bIndex].name + ". ";
			}
			if(enemy.hasExactly("Ice Prince's Seal") && enemy.combatStartHp / enemy.maxHp >= 0.25){
				var tRed = Math.floor(enemyEffDef * 0.2);
				flatReduction += tRed;
				damageText += enemy.name + " reduces damage by " + tRed + " from " + data.skills[enemy.bIndex].name + ". ";
			}
			if(enemy.hasExactly("Clever Fighter") && enemyEffSpd + enemy.getPhantom("Spd") >= thisEffSpd + this.getPhantom("Spd") - 10 && (firstHit || brave == 6)){
				flatReduction += 10;
				damageText += enemy.name + " reduces damage by 10 from " + data.skills[enemy.bIndex].name + ". ";
			}
			if(enemy.hasExactly("Fallen Star 2") && (!this.initiator || enemy.bonus.dStar) && (firstHit || brave == 6)){
				var fsVal = Math.min((Object.values(enemy.bonus).reduce((a, item) => a + (item === true ? 1 : 0), 0) + enemy.bonus.extra + Object.values(this.penalty).reduce((a, item) => a + (item === true ? 1 : 0), 0) + this.penalty.extra) * 3, 15);
				flatReduction += fsVal;
				damageText += enemy.name + " reduces damage by " + fsVal + " from " + data.skills[enemy.bIndex].name + ". ";
			}
			if(enemy.hasExactly("According to Plan") && enemy.combatStartHp / enemy.maxHp >= 0.25 && (firstHit || brave == 6)){
				var apVal = Math.min((Object.values(enemy.bonus).reduce((a, item) => a + (item === true ? 1 : 0), 0) + enemy.bonus.extra + Object.values(this.penalty).reduce((a, item) => a + (item === true ? 1 : 0), 0) + this.penalty.extra) * 3, 15);
				flatReduction += apVal;
				damageText += enemy.name + " reduces damage by " + apVal + " from " + data.skills[enemy.bIndex].name + ". ";
			}
			if(enemy.hasExactly("Lone Wolf") && (enemy.combatStartHp / enemy.maxHp >= 0.25 || enemy.buddy.adjacent < 2)){
				var tRed = Math.floor(enemyEffSpd * 0.2);
				flatReduction += tRed;
				damageText += enemy.name + " reduces damage by " + tRed + " from " + data.skills[enemy.bIndex].name + ". ";
				if(offensiveSpecialActivated){
					flatReduction += tRed;
					damageText += enemy.name + " reduces damage further by " + tRed + " from " + data.skills[enemy.bIndex].name + ". ";
				}
			}
			if(enemy.hasExactly("Reopening") && enemy.combatStartHp / enemy.maxHp >= 0.25){
				var tRed = Math.floor(enemyEffDef * 0.2);
				if(enemyFollowUp || eBrave == 1 || eBrave == 2){
					tRed = Math.floor(enemyEffDef * 0.1);
				}
				flatReduction += tRed;
				damageText += enemy.name + " reduces damage by " + tRed + " from " + data.skills[enemy.bIndex].name + ". ";
			}
			if((enemy.hasExactly("AD Spiked Wall") || enemy.hasExactly("SR Spiked Wall") || enemy.hasExactly("Font of Wisdom") || enemy.hasExactly("AS Spiked Wall")) && (firstHit || brave == 6)){
				flatReduction += 7;
				damageText += enemy.name + " reduces damage by 7 from " + data.skills[enemy.bIndex].name + ". ";
			}
			if(enemy.hasExactly("Shadow Slide") && enemy.buddy.adjacent + enemy.buddy.two + enemy.buddy.three > 0 && (firstHit || brave == 6)){
				flatReduction += 7;
				damageText += enemy.name + " reduces damage by 7 from Shadow Slide. ";
			}
			if((enemy.hasExactly("Slick Fighter 4") || enemy.hasExactly("Wily Fighter 4")) && (this.initiator || enemy.combatStartHp / enemy.maxHp >= 0.25)){
				var tRed = Math.floor(enemyEffDef * 0.2);
				flatReduction += tRed;
				damageText += enemy.name + " reduces damage by " + tRed + " from " + data.skills[enemy.bIndex].name + ". ";
			}
			if(enemy.hasExactly("Chivalry 2")){
				var chVar = 0.15;
				if(this.combatStartHp / this.maxHp >= 0.5){
					chVar = 0.25;
				}
				var tRed = Math.floor(enemyEffAtk * chVar);
				flatReduction += tRed;
				damageText += enemy.name + " reduces damage by " + tRed + " from " + data.skills[enemy.bIndex].name + ". ";
			}
			if(enemy.hasExactly("Pure Starfall") && (!this.initiator || enemy.bonus.dStar == true) && (firstHit || brave == 6)){
				var tRed = Math.floor(enemyEffSpd * 0.2);
				flatReduction += tRed;
				damageText += enemy.name + " reduces damage by " + tRed + " from " + data.skills[enemy.bIndex].name + ". ";
			}
			if(enemy.hasExactly("Pure Dragon Wall")){
				var tRed = 0.2;
				if(enemy.toggle.b == 1 || enemy.toggle.b == 3){
					tRed = 0.3;
				}
				tRed = Math.floor(enemyEffRes * tRed);
				flatReduction += tRed;
				damageText += enemy.name + " reduces damage by " + tRed + " from " + data.skills[enemy.bIndex].name + ". ";
			}
			if(enemy.hasExactly("Edged Scales") && (this.initiator || enemy.combatStartHp / enemy.maxHp >= 0.25) && (firstHit || brave == 6)){
				flatReduction += 10;
				damageText += enemy.name + " reduces damage by 10 from Edged Scales. ";
			}
			
			if(enemy.hasExactly("Divine Talon") && (enemy.transform == true || this.combatStartHp / this.maxHp >= 0.75) && enemy.buddy.spaces > 0){
				var tRed = Math.min(enemy.buddy.spaces * 4, 12);
				flatReduction += tRed;
				damageText += enemy.name + " reduces damage by " + tRed + " from " + data.skills[enemy.cIndex].name + ". ";
				if(offensiveSpecialActivated){
					flatReduction += tRed;
					damageText += enemy.name + " reduces damage further by " + tRed + " from " + data.skills[enemy.cIndex].name + ". ";
				}
			}
			if(enemy.has("Briar F Save") && this.range == "ranged" && (firstHit || brave == 6)){
				flatReduction += 5;
				damageText += enemy.name + " reduces damage by 5 from " + data.skills[enemy.cIndex].name + ". ";
			}
			if((enemy.hasExactly("Quiet Strength") || enemy.hasExactly("Fell Majesty")) && (!this.initiator || enemy.buddy.adjacent > 0 || enemy.buddy.two > 0) && (firstHit || brave == 6)){
				flatReduction += 7;
				damageText += enemy.name + " reduces damage by 7 from " + data.skills[enemy.cIndex].name + ". ";
			}
			if(((enemy.hasExactly("Holy Ground+") && (firstHit || brave == 6)) || enemy.hasExactly("Divine God Fang")) && enemy.buddy.adjacent + enemy.buddy.two + enemy.buddy.three > 0){
				flatReduction += 7;
				damageText += enemy.name + " reduces damage by 7 from " + data.skills[enemy.cIndex].name + ". ";
			}
			if(enemy.hasExactly("Love for All!") && enemy.buddy.adjacent + enemy.buddy.two + enemy.buddy.three > 0 && (firstHit || brave == 6)){
				var tRed = Math.min((enemy.buddy.adjacent + enemy.buddy.two + enemy.buddy.three) * 7, 14);
				flatReduction += tRed;
				damageText += enemy.name + " reduces damage by " + tRed + " from " + data.skills[enemy.cIndex].name + ". ";
			}
			if(enemy.bonus.nectar == 2){
				flatReduction += 10;
				damageText += enemy.name + " reduces damage by 10 from [Divine Nectar] Bonus. ";
			}
			if(enemy.bonus.fWitness && (firstHit || brave == 6)){
				flatReduction += 7;
				damageText += enemy.name + " reduces damage by 7 from [Future Witness] Bonus. ";
			}
			if(enemy.bonus.fEmblem && (firstHit || brave == 6)){
				flatReduction += 10;
				damageText += enemy.name + " reduces damage by 10 from [Fire Emblem] Bonus. ";
			}
			if(enemy.support.trueFirstDR > 0 && (firstHit || brave == 6)){
				flatReduction += enemy.support.trueFirstDR;
				damageText += enemy.name + " reduces damage by " + enemy.support.trueFirstDR + " from ally Seteth(s). ";
			}
			if(enemy.support.rsd > 0 && offensiveSpecialActivated){
				flatReduction += enemy.support.rsd;
				damageText += enemy.name + " reduces damage by " + enemy.support.rsd  + " from Reduce Special Damage by 10 Support. ";
			}
			if(enemy.vein == 1 && offensiveSpecialActivated){
				flatReduction += 10;
				damageText += enemy.name + " reduces damage by 10 from Divine Vein (Stone). ";
			}
			if(this.emblem == "Marth" && offensiveSpecialActivated && brave > 0){
				flatReduction += 8;
				damageText += this.name + " reduces Special damage by 8 from Emblem (Marth). ";
			}
			if(enemy.hasExactly("Demonic Breath") && enemy.rValue == 5 && (this.initiator || this.combatStartHp / this.maxHp >= 0.75) && thisFollowUp && firstHit){
				dmgCut = 0.7;
				damageText += enemy.name + " reduces damage by 0.7 from Demonic Breath. ";
			}
			if(enemy.hasExactly("Imhullu") && enemy.rValue == 5 && enemy.combatStartHp / enemy.maxHp >= 0.25 && this.weaponType.indexOf("tome") == -1){
				dmgCut = 0.3;
				damageText += enemy.name + " reduces damage by 0.3 from Imhullu. ";
			}
			if(enemy.hasExactly("Eldhrimnir") && enemy.rValue == 5 && (this.initiator || this.combatStartHp / this.maxHp >= 0.75) && firstHit && enemy.getPhantom("Res") + enemyEffRes > this.getPhantom("Res") + thisEffRes){
				dmgCut = 0.3;
				damageText += enemy.name + " reduces damage by 0.3 from Eldhrimnir. ";
			}
			if(enemy.hasExactly("Fell Breath") && enemy.rValue == 5 && (!this.initiator || enemy.toggle.weapon == 1) && firstHit){
				dmgCut = 0.3;
				damageText += enemy.name + " reduces damage by 0.3 from Fell Breath. ";
			}
			if(enemy.hasExactly("Godly Breath") && (!this.initiator || enemy.toggle.weapon == 1)){
				dmgCut = 0.3;
				damageText += enemy.name + " reduces damage by 0.3 from Godly Breath. ";
			}
			if(enemy.hasExactly("Saehrimnir") && enemy.rValue == 5 && enemy.toggle.weapon == 1 && enemyEffRes + enemy.getPhantom("Res") - thisEffRes - this.getPhantom("Res") >= 1 && firstHit){
				dmgCut = 0.3;
				damageText += enemy.name + " reduces damage by 0.3 from Saehrimnir. ";
			}
			if((enemy.hasExactly("Regal Sunshade") || enemy.hasExactly("Arcane Devourer") || enemy.hasExactly("Dead-Fang Axe") || enemy.hasExactly("Vassal-Saint Steel") || enemy.hasExactly("Seafoam Splitter") || enemy.hasExactly("Fujin Uchiwa") || enemy.hasExactly("Troubling Blade")) && enemy.combatStartHp / enemy.maxHp >= 0.25 && firstHit){
				dmgCut = 0.4;
				damageText += enemy.name + " reduces damage by 0.4 from " + data.skills[enemy.weaponIndex].name + ". ";
			}
			if(enemy.hasExactly("Tri-Edge Lance") && (!this.initiator || enemy.buddy.adjacent > 0 || enemy.buddy.two > 0) && firstHit){
				dmgCut = 0.4;
				damageText += enemy.name + " reduces damage by 0.4 from Tri-Edge Lance. ";
			}
			if(enemy.hasExactly("Wanderer Blade") && enemy.rValue == 5 && enemy.combatStartHp / enemy.maxHp >= 0.25 && enemy.getPhantom("Spd") + enemyEffSpd > this.getPhantom("Spd") + thisEffSpd){
				var ccMult = Math.min((enemy.getPhantom("Spd") + enemyEffSpd) - (this.getPhantom("Spd") + thisEffSpd),10);
				dmgCut = ccMult * 0.04;
				damageText += enemy.name + " reduces damage by " + dmgCut + " from Wanderer Blade. ";
			}
			if(enemy.hasExactly("Divine Breath") && enemy.rValue == 5 && enemy.toggle.weapon > 0 && firstHit){
				dmgCut = 0.25;
				damageText += enemy.name + " reduces damage by 0.25 from Divine Breath. ";
			}
			if((enemy.hasExactly("Freikugel") || enemy.hasExactly("Sublime Surge")) && enemy.rValue == 5 && enemy.combatStartHp / enemy.maxHp >= 0.25 && firstHit){
				dmgCut = 0.4;
				damageText += enemy.name + " reduces damage by 0.4 from " + data.skills[enemy.weaponIndex].name + ". ";
			}
			if(enemy.hasExactly("Lion King Fang") && enemy.rValue > 0 && !enemy.initiator && firstHit == false && brave != 6){
				dmgCut = 0.7;
				damageText += enemy.name + " reduces damage by 0.7 from Lion King Fang. ";
			}
			if(enemy.hasExactly("Geirdriful") && (!this.initiator || enemy.buddy.adjacent > 0 || enemy.buddy.two > 0) && (firstHit || (enemy.rValue > 0 && brave == 6))){
				dmgCut = 0.4;
				damageText += enemy.name + " reduces damage by 0.4 from Geirdriful. ";
			}
			if(enemy.hasExactly("Wind Parthia") && enemy.rValue == 5 && enemy.combatStartHp / enemy.maxHp >= 0.25 && (enemy.toggle.weapon > 1 || checkAllBuffs(enemy, this, turn)) && firstHit){
				dmgCut = 0.3;
				damageText += enemy.name + " reduces damage by 0.3 from Wind Parthia. ";
			}
			if((enemy.hasExactly("Crimson Blades") || (enemy.hasExactly("Crimson War-Axe") && this.combatStartHp / this.maxHp >= 0.75)) && enemy.combatStartHp / enemy.maxHp >= 0.4 && firstHit){
				dmgCut = 0.4;
				damageText += enemy.name + " reduces damage by 0.4 from " + data.skills[enemy.weaponIndex].name + ". ";
			}
			if(enemy.hasExactly("Fuming Freikugel") && enemy.toggle.weapon == 1 && firstHit){
				dmgCut = 0.4;
				damageText += enemy.name + " reduces damage by 0.4 from Fuming Freikugel. ";
			}
			if((enemy.hasExactly("Blade of Favors") || enemy.hasExactly("Coyote's Lance") || enemy.hasExactly("Heidr")) && (!this.initiator || enemy.toggle.weapon > 1) && firstHit){
				dmgCut = 0.4;
				if(enemy.hasExactly("Heidr")){
					dmgCut = 0.3;
				}
				damageText += enemy.name + " reduces damage by " + dmgCut + " from " + data.skills[enemy.weaponIndex].name + ". ";
			}
			if(enemy.hasExactly("Conjurer Curios") && enemy.rValue > 0 && (turn % 2 == 1 || this.combatStartHp / this.maxHp < 1) && firstHit){
				var cRed = 0.3;
				if(thisFollowUp){
					cRed = 0.6;
				}
				dmgCut = cRed;
				damageText += enemy.name + " reduces damage by " + cRed + " from Conjurer Curios. ";
			}
			if(enemy.hasExactly("Hunting Blade") && enemy.rValue == 5 && enemy.combatStartHp / enemy.maxHp >= 0.25 && !this.initiator && this.combatStartHp / this.maxHp >= 1 && firstHit){
				dmgCut = 0.6;
				damageText += enemy.name + " reduces damage by 0.6 from Hunting Blade. ";
			}
			if(enemy.hasExactly("Savage Breath") && enemy.rValue == 5 && enemy.combatStartHp / enemy.maxHp >= 0.25 && firstHit && enemy.toggle.weapon > -1 && enemy.toggle.weapon < 3){
				var sbRed = Math.round((0.3 - (enemy.toggle.weapon * 0.1)) * 100) / 100;
				dmgCut = sbRed;
				damageText += enemy.name + " reduces damage by " + sbRed + " from Savage Breath. ";
			}
			if(enemy.hasExactly("Aurgelmir") && (!this.initiator || enemy.toggle.weapon == 1) && firstHit){
				dmgCut = 0.4;
				damageText += enemy.name + " reduces damage by 0.4 from Aurgelmir. ";
			}
			if(enemy.hasExactly("Solemn Axe") && enemy.combatStartHp / enemy.maxHp >= 0.25 && enemy.specialIndex != -1 && data.defensiveSpecials.indexOf(data.skills[enemy.specialIndex].name) == -1 && data.gaeSpecials.indexOf(data.skills[enemy.specialIndex].name) == -1 && this.combatStartHp / this.maxHp >= 0.2 && firstHit){
				dmgCut = 0.4;
				damageText += enemy.name + " reduces damage by 0.4 from Solemn Axe. ";
			}
			if(enemy.hasExactly("Heralding Horn") && (this.initiator || this.combatStartHp / this.maxHp >= 0.75) && enemy.toggle.weapon > 1 && firstHit){
				dmgCut = 0.4;
				damageText += enemy.name + " reduces damage by 0.4 from Heralding Horn. ";
			}
			if(enemy.hasExactly("Fang of Finality") && enemy.toggle.weapon > 9){
				var sVar = Math.round((enemy.toggle.weapon - 10 + 1) * 0.2 * 100) / 100;
				dmgCut = sVar;
				damageText += enemy.name + " reduces damage by " + sVar + " from Fang of Finality. ";
			}
			if(enemy.hasExactly("Keen Rabbit Fang") && (!this.initiator || enemy.toggle.weapon == 1) && firstHit){
				dmgCut = 0.4;
				damageText += enemy.name + " reduces damage by 0.4 from Keen Rabbit Fang. ";
			}
			if(enemy.hasExactly("Sable Lance") && enemy.rValue == 5 && enemy.combatStartHp / enemy.maxHp >= 0.25 && firstHit){
				dmgCut = 0.3;
				damageText += enemy.name + " reduces damage by 0.3 from Sable Lance. ";
			}
			if((enemy.hasExactly("Snow's Grace") || enemy.hasExactly("Vouge")) && enemy.rValue == 5 && (this.initiator || this.combatStartHp / this.maxHp >= 0.75) && firstHit){
				dmgCut = 0.3;
				damageText += enemy.name + " reduces damage by 0.3 from " + data.skills[enemy.weaponIndex].name + ". ";
			}
			if(enemy.hasExactly("Cunning Bow") && enemy.rValue > 0 && !this.initiator && firstHit){
				dmgCut = enemy.combineBonPen(this,turn,"buff","debuff") * 3 / 100;
				dmgCut = Math.min(0.6, dmgCut);
				if(dmgCut > 0){
					damageText += enemy.name + " reduces damage by " + dmgCut + " from Cunning Bow. ";
				}
			}
			if(enemy.hasExactly("Child's Compass") && (enemy.ice > 0 || enemy.ice < 0) && brave != 6 && firstHit){
				dmgCut = 0.5;
				damageText += enemy.name + " reduces damage by 0.5 from Child's Compass. ";
				if(enemy.ice < 0){
					enemy.ice = 0;
				}
			}
			if(enemy.hasExactly("Joyous Tome") && enemy.toggle.weapon > 0){
				dmgCut = Math.round((enemy.toggle.weapon * 15) * 0.01 * 100) / 100;
				damageText += enemy.name + " reduces damage by " + dmgCut + " from Joyous Tome. ";
			}
			if(((enemy.hasExactly("Ravager") && enemy.combatStartHp/enemy.maxHp >= 0.25 && !enemy.initiator) || (enemy.hasExactly("New War Axe") && enemy.buddy.adjacent + enemy.buddy.two + enemy.buddy.three > 0)) && firstHit == false && brave != 6){
				dmgCut = 0.8;
				damageText += enemy.name + " reduces damage by 0.8 from " + data.skills[enemy.weaponIndex].name + ". ";
			}
			if(enemy.hasExactly("Command Lance") && enemy.toggle.weapon > 9 && firstHit){
				dmgCut = 0.4;
				damageText += enemy.name + " reduces damage by 0.4 from Command Lance. ";
			}
			if(enemy.hasExactly("Dawnsweet Box") && enemy.combatStartHp / enemy.maxHp >= 0.25 && enemy.getPhantom("Spd") + enemyEffSpd + 4 >= this.getPhantom("Spd") + thisEffSpd && firstHit){
				dmgCut = 0.3;
				damageText += enemy.name + " reduces damage by 0.3 from Dawnsweet Box. ";
			}
			if(enemy.hasExactly("Duskbloom Bow") && !this.initiator && enemyEffRes + enemy.getPhantom("Res") - thisEffRes - this.getPhantom("Res") >= 7 && firstHit){
				dmgCut = 0.3;
				damageText += enemy.name + " reduces damage by 0.3 from Duskbloom Bow. ";
			}
			if((enemy.hasExactly("Queensblade") || enemy.hasExactly("Valiant War Axe") || enemy.hasExactly("Lone-Wolf Blade") || enemy.hasExactly("Dream Horn") || enemy.hasExactly("Vallastone") || ((enemy.hasExactly("Mirage Axe") || enemy.hasExactly("Primordial Breath") || enemy.hasExactly("Petrify")) && enemy.rValue == 5) || enemy.hasExactly("Scarlet Spear")) && enemy.combatStartHp / enemy.maxHp >= 0.25){
				dmgCut = 0.3;
				damageText += enemy.name + " reduces damage by 0.3 from " + data.skills[enemy.weaponIndex].name + ". ";
			}
			if((enemy.hasExactly("Quieting Claw")) && enemy.combatStartHp / enemy.maxHp >= 0.25){
				dmgCut = 0.4;
				damageText += enemy.name + " reduces damage by 0.4 from " + data.skills[enemy.weaponIndex].name + ". ";
			}
			if((enemy.hasExactly("Queenslance") || enemy.hasExactly("Fiery War Sword") || enemy.hasExactly("Chon'sin Sprig")) && (!this.initiator || enemy.toggle.weapon == 1 || enemy.toggle.weapon == 3) && firstHit){
				dmgCut = 0.4;
				damageText += enemy.name + " reduces damage by 0.4 from " + data.skills[enemy.weaponIndex].name + ". ";
			}
			if(enemy.hasExactly("Bow of Repose") && enemy.combatStartHp / enemy.maxHp < 1 && enemy.toggle.weapon != 0 && enemy.toggle.weapon != 10 && firstHit){
				dmgCut = 0.3;
				damageText += enemy.name + " reduces damage by 0.3 from Bow of Repose. ";
			}
			if((enemy.has("Bunny's Egg") || enemy.has("Hare's Lance") || enemy.hasExactly("Deliverer's Brand") || enemy.hasExactly("Heired Forseti") || enemy.hasExactly("Arcane Euphoria") || enemy.hasExactly("Flower of Caring") || enemy.has("Clever Dagger") || enemy.hasExactly("Lightburst Tome")) && enemy.combatStartHp / enemy.maxHp >= 0.25 && firstHit){
				var wDmg = 0.4;
				if(enemy.has("Bunny's Egg") || enemy.hasExactly("Heired Forseti") || enemy.hasExactly("Arcane Euphoria") || enemy.has("Clever Dagger") || enemy.hasExactly("Lightburst Tome")){
					wDmg = 0.3;
				}
				dmgCut = wDmg;
				damageText += enemy.name + " reduces damage by " + wDmg + " from " + data.skills[enemy.weaponIndex].name + ". ";
			}
			if(enemy.hasExactly("Creator Sword") && enemy.rValue == 5 && enemy.combatStartHp / enemy.maxHp >= 0.25 && firstHit){
				dmgCut = 0.3;
				damageText += enemy.name + " reduces damage by 0.3 from Creator Sword. ";
			}
			if(enemy.hasExactly("Sol Lance") && enemy.rValue == 5 && enemy.toggle.weapon == 1 && enemy.combatStartHp / enemy.maxHp >= 0.5 && firstHit){
				dmgCut = 0.3;
				damageText += enemy.name + " reduces damage by 0.3 from Sol Lance. ";
			}
			if((enemy.hasExactly("Frelian Lance") || enemy.hasExactly("Frelian Blade")) && (this.initiator || this.combatStartHp / this.maxHp >= 0.75) && firstHit){
				dmgCut = 0.4;
				damageText += enemy.name + " reduces damage by 0.4 from " + data.skills[enemy.weaponIndex].name + ". ";
			}
			if((enemy.hasExactly("Arcane Nastrond") || enemy.hasExactly("Abyssal Blade"))&& (!this.initiator || enemy.toggle.weapon == 1) && firstHit){
				dmgCut = 0.3;
				damageText += enemy.name + " reduces damage by 0.3 from " + data.skills[enemy.weaponIndex].name + ". ";
			}
			if(enemy.hasExactly("Gusty War Bow") && enemy.toggle.weapon > 1 && firstHit){
				if(this.weaponType == "beast" || ((this.moveType == "cavalry" || this.moveType == "flying") && this.range == "ranged")){
					dmgCut = 0.6;
					damageText += enemy.name + " reduces damage by 0.6 from Gusty War Bow. ";
				}
				else{
					dmgCut = 0.3;
					damageText += enemy.name + " reduces damage by 0.3 from Gusty War Bow. ";
				}
			}
			if(enemy.hasExactly("Freeblade's Edge") && (this.initiator || this.combatStartHp / this.maxHp >= 0.75)){
				dmgCut = 0.3;
				damageText += enemy.name + " reduces damage by 0.3 from Freeblade's Edge. ";
			}
			if((enemy.hasExactly("Sokkvabekkr") || enemy.hasExactly("Levin Dagger")) && enemy.rValue == 5 && enemy.combatStartHp / enemy.maxHp >= 0.25 && firstHit){
				dmgCut = 0.3;
				damageText += enemy.name + " reduces damage by 0.3 from " + data.skills[enemy.weaponIndex].name + ". ";
			}
			if(enemy.hasExactly("Pupil's Tome") && (!this.initiator || this.range == "ranged") && firstHit){
				dmgCut = 0.3;
				damageText += enemy.name + " reduces damage by 0.3 from Pupil's Tome. ";
			}
			if(enemy.hasExactly("Valbar's Lance") && enemy.toggle.weapon == 1 && this.initiator && firstHit == false && brave != 6){
				dmgCut = 0.6;
				damageText += enemy.name + " reduces damage by 0.6 from Valbar's Lance. ";
			}
			if(enemy.hasExactly("Aymr") && enemy.rValue > 0 && (enemy.toggle.weapon == 1 || this.initiator) && firstHit){
				dmgCut = 0.3;
				damageText += enemy.name + " reduces damage by 0.3 from Aymr. ";
			}
			if(enemy.hasExactly("Twin Divinestone") && enemy.combatStartHp / enemy.maxHp >= 0.25 && enemy.getPhantom("Res") + enemyEffRes > this.getPhantom("Res") + thisEffRes){
				var ccMult = Math.min(enemyEffRes - thisEffRes,10);
				dmgCut = 4 * ccMult * 0.01;
				damageText += enemy.name + " reduces damage by " + dmgCut + " from Twin Divinestone. ";
			}
			if(enemy.hasExactly("Guardian's Bow") && enemy.rValue > 0 && (!this.initiator || allStats[21] + enemy.getPhantom("Spd") >= allStats[17] + this.getPhantom("Spd") - 7) && firstHit){
				dmgCut = 0.3;
				damageText += enemy.name + " reduces damage by 0.3 from Guardian's Bow. ";
			}
			if(enemy.hasExactly("Thorn Lance") && enemy.rValue > 0 && (allStats[20] > allStats[16] || enemy.combatStartHp / enemy.maxHp >= 0.25)){
				var tlCut = (enemyEffAtk - thisEffAtk) * 2 * 0.01;
				tlCut = Math.max(tlCut, 0);
				tlCut = Math.min(tlCut, 0.4);
				dmgCut = tlCut;
				damageText += enemy.name + " reduces damage by " + tlCut + " from Thorn Lance. ";
			}
			if(enemy.hasExactly("Desert-Tiger Axe") && enemy.rValue == 5 && enemy.toggle.weapon == 1 && firstHit){
				dmgCut = 0.3;
				damageText += enemy.name + " reduces damage by 0.3 from " + data.skills[enemy.weaponIndex].name + ". ";
			}
			if(enemy.hasExactly("Venin Edge") && enemy.rValue == 5 && enemy.buddy.adjacent < 2 && firstHit){
				dmgCut = 0.3;
				damageText += enemy.name + " reduces damage by 0.3 from " + data.skills[enemy.weaponIndex].name + ". ";
			}
			if(enemy.hasExactly("Randgridr") && enemy.rValue == 5 && (enemy.toggle.weapon == 3 || ((!this.initiator || enemy.toggle.weapon == 1) && enemy.toggle.weapon == 2)) && firstHit){
				dmgCut = 0.3;
				damageText += enemy.name + " reduces damage by 0.3 from Randgridr. ";
			}
			if(enemy.hasExactly("Void Tome") && enemy.rValue == 5 && (allStats[18] >= 35 || allStats[19] >= 35 || enemy.toggle.weapon > 1)){
				var vVal = Math.max(allStats[18],allStats[19]);
				dmgCut = Math.min(vVal,50) / 100;
				damageText += enemy.name + " reduces damage by " + dmgCut + " from Void Tome. ";
			}
			if(enemy.hasExactly("Sparkling Sun") && enemy.toggle.weapon == 1 && thisFollowUp && firstHit){
				dmgCut = 0.75;
				damageText += enemy.name + " reduces damage by 0.75 from Sparkling Sun. ";
			}
			if(enemy.hasExactly("Virtuous Tyrfing") && enemy.rValue == 5 && (!this.initiator || enemy.toggle.weapon == 1)){
				dmgCut = 0.4;
				if(this.weaponType.indexOf("tome") != -1 || this.weaponType == "staff"){
					dmgCut = 0.8;
				}
				damageText += enemy.name + " reduces damage by " + dmgCut + " from Virtuous Tyrfing. ";
			}
			if(enemy.hasExactly("Western Axe") && enemy.toggle.weapon == 1 && firstHit){
				dmgCut = 0.3;
				damageText += enemy.name + " reduces damage by 0.3 from Western Axe. ";
			}
			if((enemy.hasExactly("Dragon's Fist") || ((enemy.hasExactly("Genesis Falchion") || enemy.hasExactly("Spear of Shadow") || enemy.hasExactly("Blade of Shadow") || enemy.hasExactly("Plegian War Axe")) && enemy.rValue == 5) || enemy.hasExactly("World-Tree Tail") || enemy.hasExactly("Axe of Adoration") || enemy.hasExactly("Flingster Spear") || enemy.hasExactly("Arcane Fellstone") || enemy.hasExactly("Dead-Wolf Blade") || enemy.hasExactly("Love of Nerthuz") || enemy.hasExactly("Wild Wind Sword") || enemy.hasExactly("Dvergr Wayfinder") || enemy.hasExactly("Heavenly Icicle")) && enemy.combatStartHp / enemy.maxHp >= 0.25 && (firstHit || brave == 6)){
				dmgCut = 0.4;
				damageText += enemy.name + " reduces damage by 0.4 from " + data.skills[enemy.weaponIndex].name + ". ";
			}
			if(enemy.hasExactly("Hel's Reaper") && enemy.rValue == 5 && (enemy.combatStartHp / enemy.maxHp >= 0.25 || enemy.toggle.weapon == 1) && firstHit){
				dmgCut = 0.4;
				damageText += enemy.name + " reduces damage by 0.4 from Hel's Reaper. ";
			}
			if(((enemy.hasExactly("Mirage Falchion") && enemy.rValue == 5) || enemy.hasExactly("Heired Yewfelle") || enemy.hasExactly("Sacaen-Wolf Bow")) && (!this.initiator || enemy.buddy.adjacent > 0 || enemy.buddy.two > 0) && firstHit){
				dmgCut = 0.3;
				damageText += enemy.name + " reduces damage by 0.3 from " + data.skills[enemy.weaponIndex].name + ". ";
			}
			if(enemy.hasExactly("Brightwind Fans") && enemy.combatStartHp / enemy.maxHp >= 0.25 && !this.initiator && firstHit){
				dmgCut = 0.5;
				damageText += enemy.name + " reduces damage by 0.5 from Brightwind Fans. ";
			}
			if(enemy.hasExactly("Hyperion Lance") && enemy.rValue == 5 && enemy.combatStartHp / enemy.maxHp >= 0.25){
				dmgCut = 0.2;
				if(enemy.toggle.weapon == 1){
					dmgCut = 0.4;
				}
				damageText += enemy.name + " reduces damage by " + dmgCut + " from Hyperion Lance. ";
			}
			if(enemy.hasExactly("Wildcat Dagger") && enemy.rValue == 5 && (!this.initiator || this.combatStartHp / this.maxHp >= 0.75) && firstHit){
				dmgCut = 0.3;
				damageText += enemy.name + " reduces damage by 0.3 from " + data.skills[enemy.weaponIndex].name + ". ";
			}
			if(enemy.hasExactly("Guarding Lance") && (!this.initiator || enemy.buddy.adjacent > 0 || enemy.buddy.two > 0) && firstHit){
				dmgCut = 0.4;
				damageText += enemy.name + " reduces damage by 0.4 from Guarding Lance. ";
			}
			if(enemy.hasExactly("Gondul") && (!this.initiator || this.range == "ranged") && (firstHit || brave == 6)){
				dmgCut = 0.3;
				damageText += enemy.name + " reduces damage by 0.3 from Gondul. ";
			}
			if(((enemy.hasExactly("Incipit Kvasir") && enemy.combatStartHp / enemy.maxHp >= 0.25) || (enemy.hasExactly("Faded Paper Fan") && (!this.initiator || enemy.buddy.adjacent > 0 || enemy.buddy.two > 0))) && enemy.toggle.weapon == 1 && (firstHit || brave == 6)){
				dmgCut = 0.7;
				damageText += enemy.name + " reduces damage by 0.7 from " + data.skills[enemy.weaponIndex].name + ". ";
			}
			if(enemy.hasExactly("Quietus Gullveig") && !this.initiator && firstHit){
				dmgCut = 0.7;
				damageText += enemy.name + " reduces damage by 0.7 from Quietus Gullveig. ";
			}
			if(enemy.hasExactly("Silent Yule Knife") && enemy.combatStartHp / enemy.maxHp >= 0.25 && !this.initiator && (firstHit || brave == 6)){
				dmgCut = Math.round(0.3 * enemy.toggle.weapon * 100) / 100;
				damageText += enemy.name + " reduces damage by " + dmgCut + " from Silent Yule Knife. ";
			}
			if(enemy.hasExactly("Bewitching Tome") && (!this.initiator || this.range == "ranged") && firstHit){
				dmgCut = 0.3;
				damageText += enemy.name + " reduces damage by 0.3 from Bewitching Tome. ";
			}
			if(enemy.hasExactly("Studied Forblaze") && enemy.rValue == 5 && (!this.initiator || enemy.buddy.adjacent > 0 || enemy.buddy.two > 0) && firstHit){
				dmgCut = 0.3;
				damageText += enemy.name + " reduces damage by 0.3 from Studied Forblaze. ";
			}
			if(enemy.hasExactly("Mirage Rod") && enemy.rValue > 0 && enemy.combatStartHp/enemy.maxHp >= 0.25 && firstHit == false && brave != 6){
				dmgCut = 0.75;
				damageText += enemy.name + " reduces damage by 0.75 from Mirage Rod. ";
			}
			if(enemy.hasExactly("Stoutheart Lance") && enemy.rValue == 5 && (!this.initiator || enemy.buddy.adjacent > 0 || enemy.buddy.two > 0) && firstHit){
				dmgCut = 0.4;
				damageText += enemy.name + " reduces damage by 0.4 from Stoutheart Lance. ";
			}
			if((enemy.hasExactly("Monarch's Stone") || enemy.hasExactly("Hero-King Sword") || (enemy.hasExactly("Feather Sword") && enemy.rValue == 5) || (enemy.hasExactly("Crusher") && enemy.rValue > 0)) && enemy.combatStartHp / enemy.maxHp >= 0.25 && (firstHit || brave == 6)){
				dmgCut = 0.4;
				damageText += enemy.name + " reduces damage by 0.4 from " + data.skills[enemy.weaponIndex].name + ". ";
			}
			if(((enemy.hasExactly("Gurgurant") && enemy.rValue == 5) || enemy.hasExactly("Righteous Lance")) && (this.initiator || this.combatStartHp / this.maxHp >= 0.75)){
				dmgCut = 0.3;
				damageText += enemy.name + " reduces damage by 0.3 from " + data.skills[enemy.weaponIndex].name + ". ";
			}
			if(((enemy.hasExactly("Rinkah's Club") && enemy.rValue == 5) || enemy.hasExactly("Lance of Grado")) && (enemy.buddy.adjacent > 0 || enemy.buddy.two > 0 || enemy.buddy.three > 0) && (firstHit || brave == 6)){
				dmgCut = 0.4;
				damageText += enemy.name + " reduces damage by 0.4 from " + data.skills[enemy.weaponIndex].name + ". ";
			}
			if(enemy.hasExactly("Icebound Tome") && (!this.initiator || this.range == "ranged")){
				dmgCut = (Math.min(enemy.buddy.spaces,5) * 10 + 20) / 100;
				damageText += enemy.name + " reduces damage by " + dmgCut + " from " + data.skills[enemy.weaponIndex].name + ". ";
			}
			if(enemy.hasExactly("Penitent Lance") && enemy.combatStartHp / enemy.maxHp >= 0.25 && enemy.bonus.extra + Object.values(enemy.bonus).reduce((a, item) => a + (item === true ? 1 : 0), 0) >= 3 && (firstHit || brave == 6)){
				dmgCut = 0.4;
				if(thisFollowUp){
					dmgCut = 0.8;
				}
				damageText += enemy.name + " reduces damage by " + dmgCut + " from " + data.skills[enemy.weaponIndex].name + ". ";
			}
			if(enemy.hasExactly("Skinfaxi") && enemy.rValue == 5 && (enemy.buddy.adjacent > 0 || enemy.buddy.two > 0 || !this.initiator) && (firstHit || brave == 6)){
				dmgCut = 0.4;
				damageText += enemy.name + " reduces damage by 0.4 from " + data.skills[enemy.weaponIndex].name + ". ";
			}
			if(enemy.hasExactly("Hippity-Hop Axe") && (enemy.buddy.adjacent > 0 || enemy.buddy.two > 0 || enemy.buddy.three > 0) && (firstHit || brave == 6)){
				dmgCut = enemy.combatStartHp / 100;
				dmgCut = Math.min(dmgCut,0.6);
				damageText += enemy.name + " reduces damage by " + dmgCut + " from " + data.skills[enemy.weaponIndex].name + ". ";
			}
			if((enemy.hasExactly("Pure-Wing Spear") || (enemy.hasExactly("Caduceus Staff") && enemy.rValue > 0)) && (enemy.buddy.adjacent > 0 || enemy.buddy.two > 0 || enemy.buddy.three > 0)){
				dmgCut = 0.3;
				damageText += enemy.name + " reduces damage by 0.3 from " + data.skills[enemy.weaponIndex].name + ". ";
			}
			if((enemy.hasExactly("Tender Excalibur") || enemy.hasExactly("Thief's Honesty") || enemy.hasExactly("Arcane Tempest") || (enemy.hasExactly("Professorial Text") && enemy.rValue == 5) || enemy.hasExactly("Nidavellir Ballista") || enemy.hasExactly("Dual Sword")) && enemy.combatStartHp / enemy.maxHp >= 0.25 && (firstHit || brave == 6)){
				dmgCut = 0.3;
				damageText += enemy.name + " reduces damage by 0.3 from " + data.skills[enemy.weaponIndex].name + ". ";
			}
			if(enemy.hasExactly("Bride's Fang") && enemy.rValue > 0 && (!this.initiator || this.combatStartHp / this.maxHp >= 0.75) && (firstHit || brave == 6)){
				dmgCut = 0.4;
				damageText += enemy.name + " reduces damage by 0.4 from " + data.skills[enemy.weaponIndex].name + ". ";
			}
			if((enemy.hasExactly("Fell War Tome") || enemy.hasExactly("Draconic Pacts")) && (!this.initiator || enemy.buddy.adjacent > 0 || enemy.buddy.two > 0) && (firstHit || brave == 6)){
				dmgCut = 0.3;
				damageText += enemy.name + " reduces damage by 0.3 from " + data.skills[enemy.weaponIndex].name + ". ";
			}
			if(enemy.hasExactly("Heavy War Axe") && (!this.initiator || enemy.buddy.adjacent > 0 || enemy.buddy.two > 0)){
				dmgCut = 0.3;
				damageText += enemy.name + " reduces damage by 0.3 from Heavy War Axe. ";
			}
			if(enemy.hasExactly("Amatsu") && enemy.rValue == 5 && (this.initiator || this.combatStartHp / this.maxHp >= 0.75) && (firstHit || brave == 6)){
				dmgCut = 0.4;
				damageText += enemy.name + " reduces damage by 0.4 from " + data.skills[enemy.weaponIndex].name + ". ";
			}
			if(enemy.hasExactly("Flame Lance") && enemy.rValue == 5 && (!this.initiator || enemy.buddy.adjacent < 2) && firstHit){
				dmgCut = 0.3;
				damageText += enemy.name + " reduces damage by 0.3 from Flame Lance. ";
			}
			if(enemy.hasExactly("Fell Child's Might") && (!this.initiator || this.range == "ranged")){
				dmgCut = 0.3;
				damageText += enemy.name + " reduces damage by 0.3 from Fell Child's Might. ";
			}
			if((enemy.hasExactly("Wildflower Edge") || enemy.has("Dragonbloom") || enemy.has("Harp Bow")) && (!this.initiator || enemy.buddy.adjacent > 0 || enemy.buddy.two > 0) && (firstHit || brave == 6)){
				dmgCut = 0.4;
				if(enemy.has("Harp Bow")){
					dmgCut = 0.3;
				}
				if(enemy.toggle.weapon == 1){
					dmgCut = dmgCut * 2;
				}
				damageText += enemy.name + " reduces damage by " + dmgCut + " from " + data.skills[enemy.weaponIndex].name + ". ";
			}
			if(enemy.hasExactly("Prince's Lance") && (!this.initiator || enemy.buddy.adjacent > 0 || enemy.buddy.two > 0)){
				dmgCut = 0.4;
				damageText += enemy.name + " reduces damage by 0.4 from Prince's Lance. ";
			}
			if(enemy.hasExactly("Golden Sunlight") && !this.initiator && (firstHit || brave == 6)){
				dmgCut = 0.7;
				damageText += enemy.name + " reduces damage by 0.7 from Golden Sunlight. ";
			}
			if(enemy.hasExactly("Order's Sentence") && enemy.rValue > 0 && (enemy.combatStartHp / enemy.maxHp >= 0.25 || enemy.checkBonPen(1, this, turn)) && (firstHit || brave == 6)){
				dmgCut = 0.3;
				damageText += enemy.name + " reduces damage by 0.3 from Order's Sentence. ";
			}
			if(enemy.hasExactly("Sun's Percussors") && enemy.rValue == 5 && !this.initiator && (firstHit || brave == 6)){
				dmgCut = 0.5;
				damageText += enemy.name + " reduces damage by 0.5 from Sun's Percussors. ";
			}
			if(enemy.hasExactly("Tiger-Eye Axe") && enemy.combatStartHp/enemy.maxHp >= 0.25 && firstHit){
				dmgCut = 0.3;
				damageText += enemy.name + " reduces damage by 0.3 from Tiger-Eye Axe. ";
			}
			if(enemy.hasExactly("Professorial Guide") && enemy.rValue > 0 && (!this.initiator || enemy.buddy.rorc > 0) && (firstHit || brave == 6)){
				dmgCut = 0.3;
				damageText += enemy.name + " reduces damage by 0.3 from Professorial Guide. ";
			}
			if(enemy.hasExactly("Ice-Tribe Axe") && (!this.initiator || enemy.toggle.weapon == 1) && (firstHit || brave == 6)){
				dmgCut = 0.4;
				damageText += enemy.name + " reduces damage by 0.4 from Ice-Tribe Axe. ";
			}
			if(enemy.hasExactly("Sentinel Bow") && (!this.initiator || this.range == "ranged") && (firstHit || brave == 6)){
				dmgCut = 0.7;
				damageText += enemy.name + " reduces damage by 0.7 from Sentinel Bow. ";
			}
			if(enemy.hasExactly("Convoy Dagger") && enemy.rValue == 5 && (this.initiator || this.combatStartHp / this.maxHp >= 0.75)){
				dmgCut = 0.4;
				damageText += enemy.name + " reduces damage by 0.4 from " + data.skills[enemy.weaponIndex].name + ". ";
			}
			
			//A Skill Reductions
			if(enemy.hasExactly("Ashera's Chosen+") && (enemy.toggle.a == 1 || this.combatStartHp / this.maxHp >= 0.75) && enemy.getPhantom("Res") + enemyEffRes > this.getPhantom("Res") + thisEffRes){
				var ccMult = Math.min(enemyEffRes - thisEffRes,10);
				aCut = 4 * ccMult * 0.01;
				damageText += enemy.name + " reduces damage by " + aCut + " from Ashera's Chosen+. ";
			}
			else if((enemy.hasExactly("Remote Sparrow") || enemy.hasExactly("Remote Mirror") || enemy.hasExactly("Remote Sturdy")) && !this.initiator && firstHit){
				aCut = 0.3;
				damageText += enemy.name + " reduces damage by 0.3 from " + data.skills[enemy.aIndex].name + ". ";
			}
			else if(enemy.hasExactly("Nightmare") && (this.combatStartHp / this.maxHp >= 0.75 || this.initiator) && firstHit){
				aCut = 0.3;
				damageText += enemy.name + " reduces damage by 0.3 from Nightmare. ";
			}
			else if(enemy.hasExactly("Thunder's Fist") && enemy.combatStartHp/enemy.maxHp >= 0.25 && !this.initiator && firstHit){
				aCut = 0.5;
				damageText += enemy.name + " reduces damage by 0.5 from " + data.skills[enemy.aIndex].name + ". ";
			}
			else if(enemy.hasExactly("Emblems' Miracle") && (enemy.buddy.adjacent > 0 || enemy.buddy.two > 0 || enemy.buddy.three > 0) && (firstHit || brave == 6)){
				aCut = 0.4;
				damageText += enemy.name + " reduces damage by 0.4 from " + data.skills[enemy.aIndex].name + ". ";
			}
			else if(enemy.hasExactly("Leaden Regrets") && (enemy.transform == true || this.initiator) && firstHit == false && brave != 6){
				aCut = 0.8;
				damageText += enemy.name + " reduces damage by 0.8 from " + data.skills[enemy.aIndex].name + ". ";
			}
			else if(enemy.hasExactly("Swift Ice") && (!this.initiator || enemy.buddy.adjacent > 0 || enemy.buddy.two > 0) && (firstHit || brave == 6)){
				aCut = 0.3;
				damageText += enemy.name + " reduces damage by 0.3 from " + data.skills[enemy.aIndex].name + ". ";
			}
			else if(enemy.hasExactly("Beyond Reason") && (this.combatStartHp / this.maxHp >= 0.75 || this.initiator) && (firstHit || brave == 6)){
				aCut = 0.4;
				if(thisFollowUp){
					aCut = 0.8;
				}
				damageText += enemy.name + " reduces damage by " + aCut + " from Beyond Reason. ";
			}
			//New Cavalry Beast Transformed reduction will use aCut for now as it doesn't overlap with any A skills
			if(enemy.weaponIndex != -1 && (data.skills[enemy.weaponIndex].skill_id > 3666 || (data.skills[enemy.weaponIndex].skill_id == 2418 && enemy.rValue > 0)) && enemy.moveType == "cavalry" && enemy.weaponType == "beast" && enemy.transform == true && enemy.prfVal > 1 && firstHit){
				aCut = 0.3;
				damageText += enemy.name + " reduces damage by 0.3 from being transformed. ";
			}
			
			//B Skill Reductions
			//Close Call Reduction
			if((enemy.has("Close Call") || enemy.has("Repel") || enemy.has("Spurn") || enemy.has("Frenzy") || enemy.has("Velocity") || enemy.has("Beast Sense") || enemy.hasExactly("Buffer 4")) && enemy.getPhantom("Spd") + enemyEffSpd > this.getPhantom("Spd") + thisEffSpd){
				var ccMult = Math.min((enemy.getPhantom("Spd") + enemyEffSpd) - (this.getPhantom("Spd") + thisEffSpd),10);
				if(enemy.has("Close Call")){
					bCut = Math.round((enemy.has("Close Call") + 1) * ccMult * 0.01 * 100) / 100;
					damageText += enemy.name + " reduces damage by " + bCut + " from Close Call. ";
				}
				else if(enemy.has("Repel")){
					bCut = Math.round((enemy.has("Repel") + 1) * ccMult * 0.01 * 100) / 100;
					damageText += enemy.name + " reduces damage by " + bCut + " from Repel. ";
				}
				else if(enemy.has("Spurn")){
					bCut = Math.round((enemy.has("Spurn") + 1) * ccMult * 0.01 * 100) / 100;
					damageText += enemy.name + " reduces damage by " + bCut + " from Spurn. ";
				}
				else if(enemy.has("Frenzy")){
					bCut = Math.round((enemy.has("Frenzy") + 1) * ccMult * 0.01 * 100) / 100;
					damageText += enemy.name + " reduces damage by " + bCut + " from Frenzy. ";
				}
				else if(enemy.has("Velocity")){
					bCut = Math.round((enemy.has("Velocity") + 1) * ccMult * 0.01 * 100) / 100;
					damageText += enemy.name + " reduces damage by " + bCut + " from Velocity. ";
				}
				else if(enemy.has("Beast Sense")){
					bCut = Math.round(enemy.has("Beast Sense") * ccMult * 0.01 * 100) / 100;
					damageText += enemy.name + " reduces damage by " + bCut + " from Beast Sense. ";
				}
				else if(enemy.hasExactly("Buffer 4")){
					bCut = Math.round(5 * ccMult * 0.01 * 100) / 100;
					damageText += enemy.name + " reduces damage by " + bCut + " from Buffer 4. ";
				}
			}
			//Guard Bearing Reduction
			else if((enemy.hasExactly("Guard Bearing 1") || enemy.hasExactly("Guard Bearing 2") || enemy.hasExactly("Guard Bearing 3")) && enemy.toggle.b == 1 && this.initiator && firstHit && !galeused){
				bCut = enemy.has("Guard Bearing") * 0.1 + 0.2;
				damageText += enemy.name + " reduces damage by " + bCut.toFixed(1) + " from " + data.skills[enemy.bIndex].name + ". ";
			}
			else if(enemy.hasExactly("Guard Bearing 4")){
				bCut = 0.3;
				if(enemy.toggle.b == 1 && this.initiator && !galeused){
					bCut = 0.6;
				}
				damageText += enemy.name + " reduces damage by " + bCut.toFixed(1) + " from Guard Bearing 4. ";
			}
			//Blue Lion Rule Reduction
			else if(enemy.hasExactly("Blue Lion Rule") && enemyEffDef > thisEffDef){
				var ccMult = Math.min(enemyEffDef - thisEffDef,10);
				bCut = 4 * ccMult * 0.01;
				damageText += enemy.name + " reduces damage by " + bCut + " from Blue Lion Rule. ";
			}
			//Dragon Wall (and variants) Reduction
			else if((enemy.has("Dragon Wall") || enemy.hasExactly("New Divinity")) && enemy.getPhantom("Res") + enemyEffRes > this.getPhantom("Res") + thisEffRes){
				var ccMult = Math.min((enemy.getPhantom("Res") + enemyEffRes) - (this.getPhantom("Res") + thisEffRes),10);
				var ccVar = 4;
				if(enemy.hasExactly("True Dragon Wall") || enemy.hasExactly("Pure Dragon Wall")){
					if(enemy.toggle.b == 1 || enemy.toggle.b == 3){
						ccVar = 6;
					}
				}
				else if(enemy.hasExactly("High Dragon Wall")){
					ccVar = 4;
				}
				else if(enemy.has("Dragon Wall")){
					ccVar = enemy.has("Dragon Wall") + 1;
				}
				bCut = ccVar * ccMult * 0.01;
				damageText += enemy.name + " reduces damage by " + bCut + " from " + data.skills[enemy.bIndex].name + ". ";
			}
			//Fallen Star reduction
			else if(firstHit == true && (enemy.bonus.fStar || (enemy.hasExactly("Fallen Star") && enemy.initiator))){
				bCut = 0.8;
				damageText += enemy.name + " reduces damage by 0.8 from Fallen Star. ";
			}
			//Armored Wall reduction
			else if(enemy.hasExactly("Armored Wall") && enemy.toggle.b == 1 && enemy.combatStartHp / enemy.maxHp >= 0.25 && enemy.transform && firstHit && !galeused){
				bCut = 0.4;
				damageText += enemy.name + " reduces damage by 0.4 from Armored Wall. ";
			}
			//Bushido 2
			else if(enemy.hasExactly("Bushido 2") && enemy.getPhantom("Spd") + enemyEffSpd > this.getPhantom("Spd") + thisEffSpd){
				var ccMult = Math.min((enemy.getPhantom("Spd") + enemyEffSpd) - (this.getPhantom("Spd") + thisEffSpd),10);
				bCut = 4 * ccMult * 0.01;
				damageText += enemy.name + " reduces damage by " + bCut + " from Bushido 2. ";
			}
			else if(enemy.has("Moon-Twin Wing") && enemy.combatStartHp / enemy.maxHp >= 0.25 && enemy.getPhantom("Spd") + enemyEffSpd > this.getPhantom("Spd") + thisEffSpd){
				var ccMult = Math.min((enemy.getPhantom("Spd") + enemyEffSpd) - (this.getPhantom("Spd") + thisEffSpd),10);
				bCut = ccMult * 0.04;
				if(enemy.hasExactly("Moon-Twin Wing+")){
					bCut = ccMult * 0.05;
				}
				damageText += enemy.name + " reduces damage by " + bCut + " from " + data.skills[enemy.bIndex].name + ". ";
			}
			else if((enemy.hasExactly("Prescience") && (!this.initiator || this.range == "ranged") && firstHit) || enemy.hasExactly("Prescience 2")){
				bCut = 0.3;
				damageText += enemy.name + " reduces damage by 0.3 from " + data.skills[enemy.bIndex].name + ". ";
			}
			//Dragon's Wrath Reduction
			else if(((enemy.hasSlot("Dragon's Wrath","b") && this.initiator) || enemy.hasExactly("Dragon's Wrath 4")) && firstHit){
				bCut = enemy.hasSlot("Dragon's Wrath","b") * 0.05 + 0.05;
				damageText += enemy.name + " reduces damage by " + bCut + " from " + data.skills[enemy.bIndex].name + ". ";
			}
			else if(enemy.hasExactly("Divine Recreation") && this.combatStartHp / this.maxHp >= 0.5 && firstHit){
				bCut = 0.3;
				damageText += enemy.name + " reduces damage by 0.3 from Divine Recreation. ";
			}
			//Savvy Fighter
			else if(enemy.has("Savvy Fighter") && this.initiator){
				if(firstHit || (enemy.hasExactly("Savvy Fighter 4") && brave == 6)){
					var sBoost = enemy.has("Savvy Fighter") * -2 + 2;
					if(enemy.hasExactly("Savvy Fighter 4")){
						sBoost = -10;
					}
					if(enemy.getPhantom("Spd") + enemyEffSpd >= this.getPhantom("Spd") + thisEffSpd + sBoost){
						bCut = Math.round(enemy.has("Savvy Fighter") * 10) / 100;
						damageText += enemy.name + " reduces damage by " + bCut + " from Savvy Fighter. ";
					}
				}
			}
			//Assured Rebirth
			else if(enemy.has("Assured Rebirth") && (enemy.toggle.b > 0 || enemy.getPhantom("Res") + enemyEffRes > this.getPhantom("Res") + thisEffRes)){
				var ccAlly = enemy.toggle.b * 20 * 0.01;
				var ccRes = Math.min((enemy.getPhantom("Res") + enemyEffRes) - (this.getPhantom("Res") + thisEffRes),10);
				ccRes = Math.max(ccRes, 0) * 4 * 0.01;
				bCut = Math.min(ccAlly + ccRes, 0.6);
				damageText += enemy.name + " reduces damage by " + bCut + " from Assured Rebirth. ";
			}
			//Flow Flight
			else if((enemy.hasExactly("Flow Flight 3") || (enemy.hasExactly("Flow Flight 2") && enemy.combatStartHp / enemy.maxHp >= 0.5) || (enemy.hasExactly("Flow Flight 1") && enemy.combatStartHp / enemy.maxHp >= 1)) && !this.initiator && enemy.getPhantom("Spd") + enemyEffSpd >= this.getPhantom("Spd") + thisEffSpd - 10){
				var dMod = (enemy.has("Flow Flight") * 2 + 1) * 0.1;
				dMod = Math.max(Math.floor((enemyEffDef - thisEffDef) * dMod),0);
				dMod = Math.min(dMod,enemy.has("Flow Flight") * 2 + 1);
				flatReduction += dMod;
				damageText += enemy.name + " reduces damage by " + dMod + " from " + data.skills[enemy.bIndex].name + ". ";
			}
			else if((enemy.hasExactly("Flow Feather 3") || (enemy.hasExactly("Flow Feather 2") && enemy.combatStartHp / enemy.maxHp >= 0.5) || (enemy.hasExactly("Flow Feather 1") && enemy.combatStartHp / enemy.maxHp >= 1)) && !this.initiator && enemy.getPhantom("Spd") + enemyEffSpd >= this.getPhantom("Spd") + thisEffSpd - 10){
				var dMod = (enemy.has("Flow Feather") * 2 + 1) * 0.1;
				dMod = Math.max(Math.floor((enemyEffRes + enemy.getPhantom("Res") - thisEffRes - this.getPhantom("Res")) * dMod),0);
				dMod = Math.min(dMod,enemy.has("Flow Feather") * 2 + 1);
				flatReduction += dMod;
				damageText += enemy.name + " reduces damage by " + dMod + " from " + data.skills[enemy.bIndex].name + ". ";
			}
			else if(enemy.hasExactly("Chivalry")){
				bCut = Math.round(this.combatStartHp / this.maxHp * 0.5 * 100) / 100;
				damageText += enemy.name + " reduces damage by " + bCut + " from Chivalry. ";
			}
			else if(enemy.hasExactly("Chivalry 2")){
				bCut = 0.5;
				damageText += enemy.name + " reduces damage by 0.5 from Chivalry 2. ";
			}
			else if(enemy.hasExactly("Quick Riposte 4") && enemy.combatStartHp / enemy.maxHp >= 0.25 && this.initiator && firstHit){
				bCut = 0.25;
				damageText += enemy.name + " reduces damage by 0.25 from Quick Riposte 4. ";
			}
			else if(enemy.hasExactly("Guard 4") && enemy.combatStartHp / enemy.maxHp >= 0.25 && firstHit){
				bCut = 0.3;
				damageText += enemy.name + " reduces damage by 0.3 from Guard 4. ";
			}
			else if(enemy.hasExactly("Fruit of Life") && enemy.combatStartHp / enemy.maxHp >= 0.25 && firstHit){
				bCut = 0.4;
				damageText += enemy.name + " reduces damage by 0.4 from Fruit of Life. ";
			}
			else if(enemy.hasExactly("Brash Assault 4") && !this.initiator && (enemy.combatStartHp / enemy.maxHp < 1 || this.combatStartHp / this.maxHp >= 1) && firstHit){
				bCut = 0.3;
				damageText += enemy.name + " reduces damage by 0.3 from Brash Assault 4. ";
			}
			else if(enemy.hasExactly("Null C-Disrupt 4") && firstHit){
				bCut = 0.3;
				damageText += enemy.name + " reduces damage by 0.3 from Null C-Disrupt 4. ";
			}
			else if(enemy.has("Counter Roar") && (firstHit || brave == 6)){
				if(enemy.hasExactly("Counter Roar 4")){
					bCut = 0.3;
				}
				else if(brave != 6){
					bCut = enemy.has("Counter Roar") * 0.1;
				}
				damageText += enemy.name + " reduces damage by " + bCut + " from " + data.skills[enemy.bIndex].name + ". ";
			}
			else if(enemy.hasExactly("Gold Unwinding") && enemy.combatStartHp / enemy.maxHp >= 0.5 && !this.initiator && firstHit){
				bCut = 0.6;
				damageText += enemy.name + " reduces damage by 0.6 from Gold Unwinding. ";
			}
			else if((enemy.hasExactly("Gambit 1") || enemy.hasExactly("Gambit 2") || enemy.hasExactly("Gambit 3") || enemy.hasExactly("Gambit 4")) && enemy.specialIndex != -1 && !enemy.hasExactly("Galeforce")){
				var ccMult = Math.min(enemy.hasSlot("Gambit","b") * 3 + 1,10);
				var ccSp = Math.min(data.skills[enemy.specialIndex].charge - enemy.initSkillCharge(),5);
				bCut = Math.round(ccSp * ccMult * 0.01 * 100) / 100;
				damageText += enemy.name + " reduces damage by " + bCut + " from " + data.skills[enemy.bIndex].name + ". ";
			}
			else if(enemy.has("Magic Gambit") && enemy.specialIndex != -1){
				var ccMult = Math.min(enemy.hasSlot("Magic Gambit","b") * 3 + 1,10);
				var ccSp = Math.min(data.skills[enemy.specialIndex].charge - enemy.initSkillCharge() - 1,4);
				bCut = Math.round(ccSp * ccMult * 0.01 * 100) / 100;
				damageText += enemy.name + " reduces damage by " + bCut + " from " + data.skills[enemy.bIndex].name + ". ";
			}
			else if(enemy.hasExactly("Deep Star") && (!this.initiator || enemy.buddy.adjacent > 0 || enemy.buddy.two > 0) && (firstHit || brave == 6)){
				bCut = 0.3;
				if(!this.initiator){
					bCut = 0.8;
				}
				damageText += enemy.name + " reduces damage by " + bCut + " from Deep Star. ";
			}
			else if(enemy.hasExactly("Fallen Star 2") && !this.initiator && (firstHit || brave == 6)){
				bCut = 0.8;
				damageText += enemy.name + " reduces damage by " + bCut + " from Fallen Star 2. ";
			}
			else if(enemy.hasExactly("Flow Refresh 4") && !this.initiator && firstHit){
				bCut = 0.4;
				damageText += enemy.name + " reduces damage by 0.4 from Flow Refresh 4. ";
			}
			else if(enemy.hasExactly("Atrocity 2") && this.combatStartHp / this.maxHp >= 0.4 && firstHit){
				bCut = 0.4;
				damageText += enemy.name + " reduces damage by 0.4 from Atrocity 2. ";
			}
			else if(enemy.hasExactly("Barbarity") && this.combatStartHp / this.maxHp >= 0.25 && (firstHit || brave == 6)){
				bCut = 0.4;
				damageText += enemy.name + " reduces damage by 0.4 from Barbarity. ";
			}
			else if((enemy.hasExactly("Weaving Fighter") || enemy.hasExactly("Canny Fighter")) && enemy.combatStartHp / enemy.maxHp >= 0.25){
				bCut = 0.4;
				if(thisFollowUp && (firstHit || brave == 6)){
					bCut = 0.8;
				}
				damageText += enemy.name + " reduces damage by " + bCut + " from " + data.skills[enemy.bIndex].name + ". ";
			}
			else if((enemy.hasExactly("Atk Def Bulwark 4") || enemy.hasExactly("Spd Res Bulwark 4") || enemy.hasExactly("Atk Spd Bulwark 4")) && (firstHit || brave == 6)){
				bCut = 0.4;
				damageText += enemy.name + " reduces damage by " + bCut + " from " + data.skills[enemy.bIndex].name + ". ";
			}
			else if(enemy.hasExactly("Potent 2") || enemy.hasExactly("Potent 3") || enemy.hasExactly("Potent 4")){
				bCut = (enemy.hasSlot("Potent","b") - 1) / 10;
				damageText += enemy.name + " reduces damage by " + bCut + " from " + data.skills[enemy.bIndex].name + ". ";
			}
			else if(enemy.hasExactly("Believe in Love") && enemy.getPhantom("Spd") + enemyEffSpd > this.getPhantom("Spd") + thisEffSpd){				
				var ccMult = Math.min((enemy.getPhantom("Spd") + enemyEffSpd) - (this.getPhantom("Spd") + thisEffSpd),10);
				bCut = 5 * ccMult * 0.01;
				damageText += enemy.name + " reduces damage by " + bCut + " from " + data.skills[enemy.bIndex].name + ". ";
			}
			else if(enemy.hasExactly("Divine Recreation 2") && (!this.initiator || this.combatStartHp / this.maxHp >= 0.5) && (firstHit || brave == 6)){
				bCut = 0.5;
				damageText += enemy.name + " reduces damage by 0.5 from Divine Recreation 2. ";
			}
			else if(enemy.hasExactly("Pure Starfall") && !this.initiator && (firstHit || brave == 6)){
				bCut = 0.8;
				damageText += enemy.name + " reduces damage by " + bCut + " from Pure Starfall. ";
			}
	
			//C Skill Reductions
			if(enemy.hasExactly("Domain of Ice") && enemy.toggle.c == 1 && firstHit){
				cCut = 0.3;
				damageText += enemy.name + " reduces damage by 0.3 from Domain of Ice. ";
			}
			else if(enemy.hasExactly("Woeful Upheaval") && firstHit){
				var cPer = Math.max(enemyEffAtk - thisEffAtk,0) + (this.maxHp - this.combatStartHp);
				cPer = Math.min(cPer * 0.03,0.3);
				cCut = cPer;
				damageText += enemy.name + " reduces damage by " + cPer + " from Woeful Upheaval. ";
			}
			else if(enemy.hasExactly("All Together!") && enemy.toggle.c > 0 && firstHit){
				var atPer = 0.2 * enemy.toggle.c;
				cCut = atPer;
				damageText += enemy.name + " reduces damage by " + atPer + " from All Together!. ";
			}
			else if(enemy.hasExactly("Fell Protection") && (!this.initiator || enemy.buddy.adjacent > 0 || enemy.buddy.two > 0) && enemyEffRes + enemy.getPhantom("Res") >= thisEffRes + this.getPhantom("Res") + 5){
				cCut = 0.3;
				damageText += enemy.name + " reduces damage by 0.3 from Fell Protection. ";
			}
			else if(enemy.hasExactly("Future-Sighted") && (enemy.buddy.adjacent > 0 || enemy.buddy.two > 0 || enemy.buddy.three > 0) && firstHit){
				cCut = 0.3;
				damageText += enemy.name + " reduces damage by 0.3 from Future-Sighted. ";
			}
			else if((enemy.hasExactly("Dragon Monarch") || enemy.hasExactly("Wings of Light+")) && enemy.toggle.c == 1){
				cCut = 0.3;
				damageText += enemy.name + " reduces damage by 0.3 from " + data.skills[enemy.cIndex].name + ". ";
			}
			else if(enemy.hasExactly("Forever Yours") && (!this.initiator || enemy.buddy.adjacent + enemy.buddy.two + enemy.buddy.three > 0)){
				cCut = 0.4;
				damageText += enemy.name + " reduces damage by 0.4 from Forever Yours. ";
			}
			else if(enemy.hasExactly("Connected World") && enemy.buddy.adjacent + enemy.buddy.two + enemy.buddy.three > 0){
				cCut = 0.4;
				damageText += enemy.name + " reduces damage by 0.4 from Connected World. ";
			}
			else if(enemy.hasExactly("Holy Ground+") && enemy.buddy.adjacent + enemy.buddy.two + enemy.buddy.three > 0){
				cCut = 0.3;
				damageText += enemy.name + " reduces damage by 0.3 from Holy Ground+. ";
			}
			//use C Skill variable for now as they cannot stack
			//Special Skills Reductions
			if(enemy.hasExactly("Vital Astra") && spCharged && enemy.getPhantom("Spd") + enemyEffSpd > this.getPhantom("Spd") + thisEffSpd){
				var ccMult = Math.min((enemy.getPhantom("Spd") + enemyEffSpd) - (this.getPhantom("Spd") + thisEffSpd),10);
				cCut = 3 * ccMult * 0.01;
				damageText += enemy.name + " reduces damage by " + cCut + " from Vital Astra. ";
			}
			//Deep Star Bonus
			if(enemy.bonus.dStar && this.initiator && (firstHit || brave == 6)){
				cCut = 0.8;
				damageText += enemy.name + " reduces damage by 0.8 from Deep Star Bonus. ";
			}
			
			//S skill reductions
			if(enemy.hasSlot("Dragon's Wrath","s") && this.initiator && firstHit){
				deflectCut = enemy.hasSlot("Dragon's Wrath","s") * 0.05 + 0.05;
				damageText += enemy.name + " reduces damage by " + deflectCut + " from " + data.skills[enemy.sIndex].name + ". ";
			}
			
			//X Skill Reductions
			if(enemy.hasExactly("Fleeting Echo") && !this.initiator && firstHit){
				xCut = 0.3;
				damageText += enemy.name + " reduces damage by 0.3 from " + data.skills[enemy.xIndex].name + ". ";
			}
			else if(enemy.hasExactly("Guard Echo") && enemy.combatStartHp / enemy.maxHp >= 0.25 && this.initiator && (firstHit || brave == 6)){
				xCut = 0.2;
				damageText += enemy.name + " reduces damage by 0.2 from Guard Echo. ";
			}
			
			//Dodge Status
			if(enemy.bonus.dodge && enemy.getPhantom("Spd") + enemyEffSpd > this.getPhantom("Spd") + thisEffSpd){
				var ccMult = Math.min((enemy.getPhantom("Spd") + enemyEffSpd) - (this.getPhantom("Spd") + thisEffSpd),10);
				dCut = 4 * ccMult * 0.01;
				damageText += enemy.name + " reduces damage by " + dCut + " from Dodge Status. ";
			}
			//Future Sight Status
			if(enemy.bonus.fSight && !this.initiator && firstHit){
				if(dCut > 0){
					dCut = 1 - Math.round((1 - dCut) * 0.6 * 100) / 100;
				}
				else{
					dCut = 0.4;
				}
				damageText += enemy.name + " reduces damage by 0.4 from Future Sight Status. "
			}
			
			//DR % (Human Virtue 2, Chaos Manifest) and Freikugel 20% DR
			if(((enemy.prfVal > 0 && (enemy.hasExactly("Human Virtue 2") || (enemy.hasExactly("Chaos Manifest") && enemy.rValue > 0 && !this.initiator))) || enemy.support.freikugel == true) && firstHit){
				var drTVal = enemy.prfVal;
				if(enemy.hasExactly("Chaos Manifest") && enemy.rValue > 0 && !this.initiator){
					drTVal = drTVal * 2;
				}
				if(drTVal > 0 && enemy.support.freikugel == true){
					pCut = Math.round((1 - (1 - drTVal / 100) * 0.8) * 100) / 100;
				}
				else if(drTVal > 0){
					pCut = drTVal / 100;
				}
				else if(enemy.support.freikugel == true){
					pCut = 0.2;
				}
				drTVal = pCut * 100;
				damageText += enemy.name + " reduces damage by " + drTVal + "%. ";
			}
			
			//outside help reduction
			if(enemy.support.caduceus > 0){
				oCut = Math.round(Math.pow(0.7,enemy.support.caduceus) * 100);
				var oText = 100 - oCut;
				oCut = oCut / 100;
				oText = oText / 100;
				damageText += enemy.name + " reduces damage by " + oText + " from ally's 30% DR support. ";
			}
			if(enemy.support.doi > 0 && firstHit){
				diCut = Math.round(Math.pow(0.7,enemy.support.doi) * 100);
				var oText = 100 - diCut;
				diCut = diCut / 100;
				oText = oText / 100;
				damageText += enemy.name + " reduces damage by " + oText + " from ally Nifl(s) being within 2 spaces. ";
			}
			if(enemy.support.hippity > 0){
				hhCut = enemy.support.hippity / 100;
				damageText += enemy.name + " reduces damage by " + hhCut + " from ally support. ";
			}
			
			//% DR that cannot be nullified
			if((enemy.hasExactly("Dragon Fang Shot") || enemy.hasExactly("Requiem Prayer") || enemy.hasExactly("Dragon Fang Fire")) && enemyEffRes + enemy.getPhantom("Res") > thisEffRes + this.getPhantom("Res")){
				var dsVal = Math.max(2 - enemy.charge, 0);
				dsVal = Math.min(dsVal, 2);
				var ccMult = Math.min((enemy.getPhantom("Res") + enemyEffRes) - (this.getPhantom("Res") + thisEffRes),10);
				niCut = (4 - dsVal) * ccMult * 0.01;
				damageText += enemy.name + " reduces damage by " + niCut + " from " + data.skills[enemy.specialIndex].name + ". ";
			}

			//% DR Ignore
			if((offensiveSpecialActivated && (this.hasExactly("Twin Blades") || this.hasExactly("Arms of the Three") || this.hasExactly("Deadeye") || this.hasExactly("Sublime Heaven") || this.hasExactly("Sublime Heaven 2") || this.hasExactly("Supreme Heaven") || ((this.hasExactly("Bow of Frelia") || this.hasExactly("Lioness Blade") || this.hasExactly("Fell Wyrmscale") || this.hasExactly("Exalt's Tactics") || this.hasExactly("Dvergr Wayfinder") || this.hasExactly("Hungry Cat Fang") || ((this.hasExactly("Gate-Anchor Axe") || this.hasExactly("War-God Mjolnir")) && this.rValue == 5)) && this.combatStartHp / this.maxHp >= 0.25) || this.hasExactly("Lethality") || this.hasExactly("Bane") || this.hasExactly("Lunar Flash 2") || this.hasExactly("Enclosure") || (this.hasExactly("Thunderer Tome") && (this.combatStartHp / this.maxHp < 1 || turn < 4)) || this.hasExactly("Special Spiral 4") || (this.hasExactly("Sisterly War Axe") && (this.initiator || this.toggle.weapon == 1)) || (this.hasExactly("Creator Sword") && this.rValue == 5) || (this.hasExactly("Deadly Balance+") && (this.combatStartHp / this.maxHp >= 0.25 || this.toggle.b == 1)) || ((this.hasExactly("Mareeta's Sword") || this.hasExactly("Bride's Fang") || this.hasExactly("Chaos Ragnell") || this.hasExactly("Professorial Guide") || this.hasExactly("Inner Wellspring")) && this.rValue == 5 && this.combatStartHp / this.maxHp >= 0.25) || (((this.hasExactly("Deliverer's Brand") && this.combatStartHp / this.maxHp >= 0.25) || (this.hasExactly("Fell War Tome") && (this.initiator || this.buddy.adjacent > 0 || this.buddy.two > 0))) && this.specialIndex != -1 && data.skills[this.specialIndex].charge - this.initSkillCharge() >= 3) || (this.hasExactly("Dragon Blast") && this.buddy.rank != "N") || (this.hasExactly("Bond Blast") && (this.buddy.rank != "N" || this.toggle.special == 1)) || (this.hasExactly("Striving Sword") && (this.buddy.adjacent > 0 || this.buddy.two > 0 || this.buddy.three > 0)) || this.hasExactly("No Quarter") || (((this.hasExactly("Winds of Change") && this.rValue == 5) || (this.hasExactly("Auto-Lofnheidr") && this.rValue > 0) || this.has("Snaking Bow")) && (this.initiator ||  this.buddy.adjacent > 0 || this.buddy.two > 0)) || (this.hasExactly("Righteous Lance") && (!this.initiator || enemy.combatStartHp / enemy.maxHp >= 0.75)) || this.hasExactly("Sacred Wind") || (this.has("Laguz Friend") && this.specialIndex != -1 && data.skills[this.specialIndex].charge - this.initSkillCharge() >= 3) || (this.hasExactly("Corrupted Dragon") && this.toggle.c == 1) || this.hasExactly("Fierce Beast") || (this.hasExactly("Majestic Glitnir") && (this.initiator || this.buddy.rorc > 0)) || this.hasExactly("Requiem Prayer") || (this.hasExactly("Just Bow") && (this.initiator || this.buddy.rorc > 0)) || this.hasExactly("Yggdrasill's Alter") || (this.hasExactly("Moonless Breath") && this.rValue > 0 && this.buddy.adjacent + this.buddy.two + this.buddy.three > 0) || this.hasExactly("Crusader's Astra") || this.hasExactly("Frost Moon") || this.hasExactly("True Lunar Flash") || this.support.ignore)) || ((this.hasExactly("Lands Sword") || this.hasExactly("Fair-Fight Blade")) && this.combatStartHp / this.maxHp >= 0.25) || (this.hasExactly("Bold Kusarigama") && (this.initiator || this.buddy.adjacent > 0 || this.buddy.two > 0)) || (enemy.hasExactly("Fair-Fight Blade") && enemy.combatStartHp / enemy.maxHp >= 0.25) || (enemy.hasExactly("Bold Kusarigama") && (!this.initiator || enemy.buddy.adjacent > 0 || enemy.buddy.two > 0)) || (this.hasExactly("Striving Sword") && (this.buddy.adjacent > 0 || this.buddy.two > 0 || this.buddy.three > 0) && this.beacon[0] == -2) || (this.hasExactly("Obsession") && this.combatStartHp / this.maxHp >= 0.25 && !firstHit) || (this.has("Laguz Friend") && this.specialIndex != -1 && data.defensiveSpecials.indexOf(data.skills[this.specialIndex].name) != -1 && this.sTrigger == 1) || (this.hasExactly("Dual Ice Mirrors") && this.beacon[0] == -2) || enemy.penalty.spoils){
				dmgCut = 0;
				deflectCut = 0;
				aCut = 0;
				bCut = 0;
				cCut = 0;
				xCut = 0;
				oCut = 1;
				dCut = 0;
				pCut = 0;
				hhCut = 0;
				diCut = 1;
				fpCut = 1;
				damageText += this.name + " disables non-Special skills that reduce damage. ";
				if((this.hasExactly("Striving Sword") || this.hasExactly("Dual Ice Mirrors")) && this.beacon[0] == -2){
					this.beacon[0] = 0;
				}
			}
			//Reduction of damage reduction
			if((this.hasExactly("Thjalfi") && this.toggle.weapon == 1) || (this.hasExactly("Adroit War Tome") && this.combatStartHp / this.maxHp >= 0.25 && thisEffRes + this.getPhantom("Res") - enemyEffRes - enemy.getPhantom("Res") >= 10) || ((this.hasExactly("Breath of Flame") || this.hasExactly("Celestial Globe")) && (this.initiator || this.toggle.weapon == 1)) || (this.hasExactly("Noble Lance") && this.rValue == 5 && (this.initiator || enemy.combatStartHp / enemy.maxHp >= 0.75)) || ((this.hasExactly("Soul of Zofia 2") || this.hasExactly("Sun-Twin Wing+") || this.hasExactly("Moon-Twin Wing+") || this.hasExactly("Vedrfolnir's Wing") || this.hasExactly("Protective") || this.hasExactly("Gift of Guidance")) && this.combatStartHp / this.maxHp >= 0.25) || this.hasExactly("Phys Null Follow") || this.hasExactly("Mag Null Follow") || this.hasExactly("Impenetrable Void") || ((this.hasExactly("Phantasm Tome") || this.hasExactly("Holy Yewfelle") || this.hasExactly("Failnaught") || this.hasExactly("Holytide Tyrfing") || this.hasExactly("Remote Breath") || this.hasExactly("New Dawn") || this.hasExactly("Ebon Bolverk")) && this.rValue == 5 && this.combatStartHp / this.maxHp >= 0.25) || (this.hasExactly("Bun-Bun Baton") && this.rValue == 5 && (!this.initiator || enemy.combatStartHp / enemy.maxHp >= 0.75)) || (this.hasExactly("Payday Pouch") && (this.initiator || ((this.buddy.adjacent > 0 || this.buddy.two > 0) && this.toggle.weapon > 1)) && Object.values(this.bonus).reduce((a, item) => a + (item === true ? 1 : 0), 0) + this.bonus.extra >= 3) || this.hasExactly("Atk Res Tempo 4") || this.hasExactly("Spd Def Tempo 4") || this.hasExactly("Spd Res Tempo 4") || ((this.hasExactly("Areadbhar") || this.hasExactly("Joyful Vows") || this.hasExactly("Frostfire Breath") || this.hasExactly("Wing-Lifted Spear")) && this.rValue == 5 && (this.initiator || this.buddy.adjacent > 0 || this.buddy.two > 0)) || ((this.hasExactly("Faded Paper Fan") || this.hasExactly("Yune's Protection") || this.hasExactly("Ilian Frost Blade") || this.has("Ice Dagger") || this.has("Ice Dragonstone") || this.hasExactly("Holy-War Spear") || this.hasExactly("Ylisse Ninja Bow") || this.hasExactly("Swift Ice") || this.hasExactly("Assault Force") || this.hasExactly("Pure Atrocity") || this.hasExactly("Trained to Kill") || this.hasExactly("Quiet Strength")) && (this.initiator || this.buddy.adjacent > 0 || this.buddy.two > 0)) || (this.hasExactly("Radiant Scrolls") && (this.initiator || this.buddy.adjacent > 0 || this.buddy.two > 0)) || (this.hasExactly("Silent Yule Knife") && this.combatStartHp / this.maxHp >= 0.25 && this.initiator) || ((this.hasExactly("Black Yule Lance") || this.hasExactly("Hero-King Sword") || this.hasExactly("Tender Vessel") || this.hasExactly("Axe of Adoration") || this.hasExactly("Divine One's Arts") || this.hasExactly("Sky-Hopper Egg") || this.hasExactly("Perspicacious") || this.hasExactly("Caladbolg") || this.hasExactly("Quieting Claw") || this.hasExactly("New Year Treats") || this.hasExactly("Tome of Dusk") || this.hasExactly("Ancient Majesty")) && this.combatStartHp / this.maxHp >= 0.25) || (this.hasExactly("Darkling Dragon") && (this.buddy.adjacent > 0 || this.buddy.two > 0)) || ((this.hasExactly("Pure-Wing Spear") || this.hasExactly("Sisterly Axe") || this.hasExactly("Shadow Slide") || this.hasExactly("Twinkling Anima") || this.hasExactly("Lady's Bow") || this.hasExactly("Swirling Lance") || this.hasExactly("Open Retainer+") || (this.hasExactly("Twin Star Axe") && this.rValue == 5) || this.hasExactly("Sword of Peace")) && this.buddy.adjacent + this.buddy.two + this.buddy.three > 0) || this.bonus.rotten || this.support.persp > 0 || ((enemy.has("Laguz Friend") || enemy.hasExactly("Laguz Loyalty")) && enemy.specialIndex != -1 && data.gaeSpecials.indexOf(data.skills[enemy.specialIndex].name) == -1 && (data.defensiveSpecials.indexOf(data.skills[enemy.specialIndex].name) != -1 || data.skills[enemy.specialIndex].charge - enemy.initSkillCharge() >= 3)) || this.has("Beast Assault") || ((this.hasExactly("Dragon Fang Shot") || this.hasExactly("Dragon Fang Fire")) && (offensiveSpecialActivated || data.skills[this.specialIndex].charge <= this.charge)) || ((this.support.nlove > 0 || (this.hasExactly("Love of Nerthuz") && this.combatStartHp / this.maxHp >= 0.25)) && offensiveSpecialActivated) || (this.hasExactly("Golden Sunlight") && (this.initiator || enemy.combatStartHp / enemy.maxHp >= 0.75)) || this.hasExactly("Resonance 2") || this.hasExactly("Resonance 3") || this.hasExactly("Resonance 4") || this.hasExactly("AR Far Resound") || (this.hasExactly("Starpoint Lance") && this.rValue > 0) || (this.hasExactly("Obsidian Tactics") && this.toggle.a > 4) || (this.hasExactly("Sun's Percussors") && this.rValue > 0 && (allStats[17] + this.getPhantom("Spd") >= allStats[21] + enemy.getPhantom("Spd") - 5 || enemy.combatStartHp / enemy.maxHp >= 0.75)) || (this.hasExactly("New Levin Sword") && (enemy.combatStartHp / enemy.maxHp >= 0.75 || this.buddy.adjacent < 2)) || (this.hasExactly("The Inexhaustible") && (this.initiator || this.checkBonPen(1,enemy,turn))) || (this.hasExactly("Divine Recreation 2") && (this.initiator || enemy.combatStartHp / enemy.maxHp >= 0.5)) || (this.hasExactly("Ice-Tribe Axe") && (this.initiator || this.toggle.weapon == 1)) || (this.hasExactly("Sentinel Bow") && (this.initiator || enemy.range == "ranged")) || ((this.hasExactly("Dragon's Scales") || this.hasExactly("Brutal Ferocity")) && (!this.initiator || this.combatStartHp / this.maxHp >= 0.25)) || (this.hasExactly("Sky-Pirate Claw") && this.rValue > 0 && (this.transform == true || this.toggle.weapon == 1)) || (this.hasExactly("Gift for Magic") && this.sTrigger == 1) || (this.hasExactly("Enticing Dose") && (this.transform == true || this.combatStartHp / this.maxHp >= 0.25)) || ((this.hasExactly("Oath of Ostia") || this.hasExactly("Devoted Breath")) && (!this.initiator || enemy.combatStartHp / enemy.maxHp >= 0.75)) || this.hasExactly("Font of Wisdom") || (this.hasExactly("Leaden Regrets") && (this.transform == true || !this.initiator)) || (this.hasExactly("Bestial Assault") && (this.transform == true || this.combatStartHp / this.maxHp >= 0.25)) || this.hasExactly("Tempo Echo") || (this.hasExactly("Pure Storm") && (this.initiator || this.buddy.adjacent < 2)) || (this.hasExactly("Pure Starfall") && (this.initiator || this.bonus.dStar == true)) || (this.hasExactly("Nihility's Undoing") && (this.transform == true || enemy.combatStartHp / enemy.maxHp >= 0.75)) || this.hasExactly("Mounting Fear") || (this.hasExactly("Tailwind Shuriken") && this.rValue == 5) || this.hasExactly("Jaws of Closure") || this.support.sunper > 0 || enemy.vein == 5){
				var rVar = 1;
				var yVal = 0;
				var skillNames = "";
				//weapons
				if((this.hasExactly("Thjalfi") && this.toggle.weapon == 1) || (this.hasExactly("Adroit War Tome") && this.combatStartHp / this.maxHp >= 0.25 && thisEffRes + this.getPhantom("Res") - enemyEffRes - enemy.getPhantom("Res") >= 10) || ((this.hasExactly("Breath of Flame") || this.hasExactly("Celestial Globe")) && (this.initiator || this.toggle.weapon == 1)) || (this.hasExactly("Noble Lance") && this.rValue == 5 && (this.initiator || enemy.combatStartHp / enemy.maxHp >= 0.75)) || ((this.hasExactly("Phantasm Tome") || this.hasExactly("Holy Yewfelle") || this.hasExactly("Failnaught") || this.hasExactly("Holytide Tyrfing") || this.hasExactly("Remote Breath") || this.hasExactly("New Dawn") || this.hasExactly("Ebon Bolverk")) && this.rValue == 5 && this.combatStartHp / this.maxHp >= 0.25) || (((this.hasExactly("Bun-Bun Baton") && this.rValue == 5) || this.hasExactly("Devoted Breath")) && (!this.initiator || enemy.combatStartHp / enemy.maxHp >= 0.75)) || (this.hasExactly("Payday Pouch") && (this.initiator || ((this.buddy.adjacent > 0 || this.buddy.two > 0) && this.toggle.weapon > 1)) && Object.values(this.bonus).reduce((a, item) => a + (item === true ? 1 : 0), 0) + this.bonus.extra >= 3) || ((this.hasExactly("Areadbhar") || this.hasExactly("Joyful Vows") || this.hasExactly("Frostfire Breath") || this.hasExactly("Wing-Lifted Spear")) && this.rValue == 5 && (this.initiator || this.buddy.adjacent > 0 || this.buddy.two > 0)) || ((this.hasExactly("Faded Paper Fan") || this.hasExactly("Ilian Frost Blade") || this.has("Ice Dagger") || this.has("Ice Dragonstone") || this.hasExactly("Holy-War Spear") || this.hasExactly("Ylisse Ninja Bow")) && (this.initiator || this.buddy.adjacent > 0 || this.buddy.two > 0)) || ((this.hasExactly("Hero-King Sword") || this.hasExactly("Tender Vessel") || this.hasExactly("Divine One's Arts") || this.hasExactly("Sky-Hopper Egg") || this.hasExactly("Perspicacious") || this.hasExactly("Caladbolg") || this.hasExactly("Quieting Claw") || this.hasExactly("New Year Treats") || this.hasExactly("Tome of Dusk") || this.hasExactly("Ancient Majesty")) && this.combatStartHp / this.maxHp >= 0.25) || ((this.hasExactly("Pure-Wing Spear") || this.hasExactly("Sisterly Axe") || this.hasExactly("Lady's Bow") || this.hasExactly("Swirling Lance") || (this.hasExactly("Twin Star Axe") && this.rValue == 5) || this.hasExactly("Sword of Peace")) && this.buddy.adjacent + this.buddy.two + this.buddy.three > 0) || (this.hasExactly("Golden Sunlight") && (this.initiator || enemy.combatStartHp / enemy.maxHp >= 0.75)) || (this.hasExactly("Sun's Percussors") && this.rValue > 0 && (allStats[17] + this.getPhantom("Spd") >= allStats[21] + enemy.getPhantom("Spd") - 5 || enemy.combatStartHp / enemy.maxHp >= 0.75)) || (this.hasExactly("New Levin Sword") && (enemy.combatStartHp / enemy.maxHp >= 0.75 || this.buddy.adjacent < 2)) || (this.hasExactly("The Inexhaustible") && (this.initiator || this.checkBonPen(1,enemy,turn))) || (this.hasExactly("Ice-Tribe Axe") && (this.initiator || this.toggle.weapon == 1)) || (this.hasExactly("Sentinel Bow") && (this.initiator || enemy.range == "ranged")) || (this.hasExactly("Sky-Pirate Claw") && this.rValue > 0 && (this.transform == true || this.toggle.weapon == 1)) || (this.hasExactly("Enticing Dose") && (this.transform == true || this.combatStartHp / this.maxHp >= 0.25)) || (this.hasExactly("Tailwind Shuriken") && this.rValue == 5) || this.hasExactly("Jaws of Closure")){
					skillNames = data.skills[this.weaponIndex].name;
					rVar = rVar * 2;
				}
				else if(this.hasExactly("Radiant Scrolls") && (this.initiator || this.buddy.adjacent > 0 || this.buddy.two > 0)){
					skillNames = data.skills[this.weaponIndex].name;
					var eNegate = this.checkNegate(enemy, turn);
					if(eNegate[0] == false){
						var aVal = Math.min(enemy.combatDebuffs.atk,enemy.debuffs.atk);
						if(enemy.penalty.panic){
							aVal -= Math.max(enemy.combatBuffs.atk,enemy.buffs.atk);
						}
						yVal += aVal;
					}
					if(eNegate[1] == false){
						var sVal = Math.min(enemy.combatDebuffs.spd,enemy.debuffs.spd);
						if(enemy.penalty.panic){
							sVal -= Math.max(enemy.combatBuffs.spd,enemy.buffs.spd);
						}
						yVal += sVal;
					}
					if(eNegate[2] == false){
						var dVal = Math.min(enemy.combatDebuffs.def,enemy.debuffs.def);
						if(enemy.penalty.panic){
							dVal -= Math.max(enemy.combatBuffs.def,enemy.buffs.def);
						}
						yVal += dVal;
					}
					if(eNegate[3] == false){
						var rVal = Math.min(enemy.combatDebuffs.res,enemy.debuffs.res);
						if(enemy.penalty.panic){
							rVal -= Math.max(enemy.combatBuffs.res,enemy.buffs.res);
						}
						yVal += rVal;
					}
					yVal = Math.min(yVal,enemy.buddy.debuffs.atk + enemy.buddy.debuffs.spd + enemy.buddy.debuffs.def + enemy.buddy.debuffs.res);
					yVal = Math.min(yVal * -0.04,1);
				}
				else if(this.hasExactly("Silent Yule Knife") && this.combatStartHp / this.maxHp >= 0.25 && this.initiator){
					skillNames = data.skills[this.weaponIndex].name;
					yVal = 0.3 * this.toggle.weapon;
				}
				else if(this.hasExactly("Black Yule Lance") && this.combatStartHp / this.maxHp >= 0.25){
					skillNames = data.skills[this.weaponIndex].name;
					yVal = 1 - (0.3 * this.buddy.adjacent);
					yVal = Math.max(0,yVal);
				}
				else if(this.hasExactly("Axe of Adoration") && this.combatStartHp / this.maxHp >= 0.25){
					skillNames = data.skills[this.weaponIndex].name;
					yVal = 0.3;
					if(allStats[22] > allStats[23]){
						yVal = 0.7;
					}
				}
				else if(this.hasExactly("Love of Nerthuz") && this.combatStartHp / this.maxHp >= 0.25 && offensiveSpecialActivated){
					skillNames = data.skills[this.weaponIndex].name;
					yVal = Math.min((data.skills[this.specialIndex].charge - this.initSkillCharge()) * 0.3 + 0.1, 1);
				}
				else if(this.hasExactly("Starpoint Lance") && this.rValue > 0){
					skillNames = data.skills[this.weaponIndex].name;
					yVal = 0.4;
					if(this.toggle.weapon == 1 || this.toggle.weapon == 3){
						yVal = 0.8;
					}
				}
				//a skills
				if((this.hasExactly("Obsidian Tactics") && this.toggle.a > 4) || (this.hasExactly("Oath of Ostia") && (!this.initiator || enemy.combatStartHp / enemy.maxHp >= 0.75)) || (this.hasExactly("Leaden Regrets") && (this.transform == true || !this.initiator)) || ((this.hasExactly("Swift Ice") || this.hasExactly("Trained to Kill")) && (this.initiator || this.buddy.adjacent > 0 || this.buddy.two > 0)) || ((this.hasExactly("Protective") || this.hasExactly("Gift of Guidance")) && this.combatStartHp / this.maxHp >= 0.25) || (this.hasExactly("Nihility's Undoing") && (this.transform == true || enemy.combatStartHp / enemy.maxHp >= 0.75))){
					if(skillNames != ""){
						skillNames += " & ";
					}
					skillNames = data.skills[this.aIndex].name;
					rVar = rVar * 2;
				}
				//b skills
				if(this.hasExactly("Phys Null Follow") || this.hasExactly("Mag Null Follow") || ((this.hasExactly("Soul of Zofia 2") || this.hasExactly("Sun-Twin Wing+") || this.hasExactly("Moon-Twin Wing+") || this.hasExactly("Vedrfolnir's Wing")) && this.combatStartHp / this.maxHp >= 0.25) || this.hasExactly("Atk Res Tempo 4") || this.hasExactly("Spd Def Tempo 4") || this.hasExactly("Spd Res Tempo 4") || ((this.hasExactly("Yune's Protection") || this.hasExactly("Assault Force") || this.hasExactly("Pure Atrocity")) && (this.initiator || this.buddy.adjacent > 0 || this.buddy.two > 0)) || (this.hasExactly("Shadow Slide") && this.buddy.adjacent + this.buddy.two + this.buddy.three > 0) || (this.hasExactly("Divine Recreation 2") && (this.initiator || enemy.combatStartHp / enemy.maxHp >= 0.5)) || ((this.hasExactly("Dragon's Scales") || this.hasExactly("Brutal Ferocity")) && (!this.initiator || this.combatStartHp / this.maxHp >= 0.25)) || this.hasExactly("Font of Wisdom") || (this.hasExactly("Bestial Assault") && (this.transform == true || this.combatStartHp / this.maxHp >= 0.25)) || (this.hasExactly("Pure Storm") && (this.initiator || this.buddy.adjacent < 2)) || (this.hasExactly("Pure Starfall") && (this.initiator || this.bonus.dStar == true)) || this.hasExactly("Mounting Fear")){
					if(skillNames != ""){
						skillNames += " & ";
					}
					skillNames += data.skills[this.bIndex].name;
					rVar = rVar * 2;
				}
				else if(this.has("Beast Assault")){
					if(skillNames != ""){
						skillNames += " & ";
					}
					skillNames += data.skills[this.bIndex].name;
					yVal = 1 - ((1 - yVal) * (0.9 - (this.has("Beast Assault") * 0.1)));
				}
				else if(this.hasExactly("Resonance 2") || this.hasExactly("Resonance 3") || this.hasExactly("Resonance 4") || this.hasExactly("AR Far Resound")){
					if(skillNames != ""){
						skillNames += " & ";
					}
					skillNames += data.skills[this.bIndex].name;
					var rhVal = Math.min(this.combatStartHp - this.hp, 6);
					rhVal = Math.max(rhVal, 3);
					if(this.hasExactly("AR Far Resound")){
						yVal = rhVal * 10 / 100;
					}
					else{
						yVal = rhVal * (((parseInt(data.skills[this.bIndex].name.charAt(data.skills[this.bIndex].name.length-1)) - 1) * 3) + 1) / 100;
					}
				}
				//c skills
				if(this.hasExactly("Impenetrable Void") || (this.hasExactly("Darkling Dragon") && (this.buddy.adjacent > 0 || this.buddy.two > 0)) || ((this.hasExactly("Twinkling Anima") || this.hasExactly("Open Retainer+")) && this.buddy.adjacent + this.buddy.two + this.buddy.three > 0) || (this.hasExactly("Quiet Strength") && (this.initiator || this.buddy.adjacent > 0 || this.buddy.two > 0))){
					if(skillNames != ""){
						skillNames += " & ";
					}
					skillNames += data.skills[this.cIndex].name;
					rVar = rVar * 2;
				}
				//specials
				if(((this.hasExactly("Dragon Fang Shot") || this.hasExactly("Dragon Fang Fire")) && (offensiveSpecialActivated || data.skills[this.specialIndex].charge <= this.charge)) || (this.hasExactly("Gift for Magic") && this.sTrigger == 1)){
					if(skillNames != ""){
						skillNames += " & ";
					}
					skillNames += data.skills[this.specialIndex].name;
					rVar = rVar * 2;
				}
				//x skills
				if(this.hasExactly("Tempo Echo")){
					if(skillNames != ""){
						skillNames += " & ";
					}
					skillNames += data.skills[this.xIndex].name;
					rVar = rVar * 2;
				}
				//misc
				if(this.bonus.rotten){
					if(skillNames != ""){
						skillNames += " & ";
					}
					skillNames += "Reduce DR% by 50% Status";
					rVar = rVar * 2;
				}
				if((enemy.has("Laguz Friend") || enemy.hasExactly("Laguz Loyalty")) && enemy.specialIndex != -1 && data.gaeSpecials.indexOf(data.skills[enemy.specialIndex].name) == -1 && (data.defensiveSpecials.indexOf(data.skills[enemy.specialIndex].name) != -1 || data.skills[enemy.specialIndex].charge - enemy.initSkillCharge() >= 3)){
					if(skillNames != ""){
						skillNames += " & ";
					}
					skillNames += "Enemy's " + data.skills[enemy.bIndex].name;
					rVar = rVar * 2;
				}
				if(this.support.persp > 0){
					if(skillNames != ""){
						skillNames += " & ";
					}
					skillNames += "Reduce DR% by 30% Support";
					yVal = 1 - ((1 - yVal) * (Math.pow(0.7,this.support.persp)));
				}
				if(this.support.sunper > 0){
					if(skillNames != ""){
						skillNames += " & ";
					}
					skillNames += "Reduce DR% by 50% Support";
					yVal = 1 - ((1 - yVal) * (Math.pow(0.5,this.support.sunper)));
				}
				if(this.support.nlove > 0 && offensiveSpecialActivated){
					if(skillNames != ""){
						skillNames += " & ";
					}
					skillNames += "Reduce DR% by CD*30+10% Support";
					yVal = 1 - ((1 - yVal) * (Math.pow(1 - ((data.skills[this.specialIndex].charge - this.initSkillCharge()) * 0.3 + 0.1),this.support.nlove)));
				}
				if(enemy.vein == 5){
					if(skillNames != ""){
						skillNames += " & ";
					}
					skillNames += "Divine Vein (Water)";
					rVar = rVar * 2;
				}
				//Variable DR% ignore %
				if(yVal > 0){
					//if Spoil Rotten is on
					if(rVar > 1){
						yVal = 1 - (Math.round((1 - yVal) * (1 / rVar) * 100) / 100);
					}
					var rText = Math.round(yVal * 100);
					var rCad = 1 - (0.3 - Math.floor(0.3 * yVal * 100) / 100);
					dmgCut = dmgCut - Math.floor(dmgCut * yVal * 100) / 100;
					deflectCut = deflectCut - Math.floor(deflectCut * yVal * 100) / 100;
					aCut = aCut - Math.floor(aCut * yVal * 100) / 100;
					bCut = bCut - Math.floor(bCut * yVal * 100) / 100;
					cCut = cCut - Math.floor(cCut * yVal * 100) / 100;
					xCut = xCut - Math.floor(xCut * yVal * 100) / 100;
					dCut = dCut - Math.floor(dCut * yVal * 100) / 100;
					pCut = pCut - Math.floor(pCut * yVal * 100) / 100;
					hhCut = hhCut - Math.floor(hhCut * yVal * 100) / 100;
					oCut = Math.round(Math.pow(rCad,enemy.support.caduceus) * 100) / 100;
					diCut = Math.round(Math.pow(rCad,enemy.support.doi) * 100) / 100;
				}
				else if(rVar > 1){
					var rText = 100 - (1 / rVar * 100);
					var rCad = 1 - (0.3 / rVar);
					dmgCut = dmgCut / rVar;
					deflectCut = deflectCut / rVar;
					aCut = aCut / rVar;
					bCut = bCut / rVar;
					cCut = cCut / rVar;
					xCut = xCut / rVar;
					dCut = dCut / rVar;
					pCut = pCut / rVar;
					hhCut = hhCut / rVar;
					oCut = Math.round(Math.pow(rCad,enemy.support.caduceus) * 100) / 100;
					diCut = Math.round(Math.pow(rCad,enemy.support.doi) * 100) / 100;
				}
				if(rText > 0){
					damageText += this.name + " reduces " + enemy.name + "'s reduction value by " + rText + "% from " + skillNames + ". ";
				}
			}
			//Normal attack flat damage boost.  Only happens if special wasn't used
			if(!offensiveSpecialActivated){
				//Light Brand/Shining Bow Mechanic
				if((this.hasExactly("Light Brand") || this.has("Shining Bow") || this.hasExactly("Niles's Bow") || this.hasExactly("Spy-Song Bow")) && enemyEffDef >= enemyEffRes + 5){
					flatBoost += 7;
					damageText += this.name + " gains 7 damage from Weapon. ";
				}
				//Vassal's Blade/Giga Excalibur/Raven King Beak/Red-Hot Ducks Mechanic
				if((this.hasExactly("Vassal's Blade") && this.rValue < 0) || (this.hasExactly("Giga Excalibur") && this.rValue < 0) || (this.hasExactly("Raven King Beak") && this.rValue < 0) || this.has("Red-Hot Ducks") || (this.hasExactly("Resolute Blade") && this.rValue == 5) || this.has("Guardian Fang") || (this.hasExactly("Refreshed Fang") && enemy.combatStartHp / enemy.maxHp >= 0.75)){
					var thisPhantomSpd = this.getPhantom("Spd") + thisEffSpd;
					var enemyPhantomSpd = enemy.getPhantom("Spd") + enemyEffSpd;
					var spdDmg = 0;				
					if(thisPhantomSpd > enemyPhantomSpd){
						spdDmg = ((thisPhantomSpd - enemyPhantomSpd) * 0.7 | 0);
						spdDmg = Math.min(spdDmg,7);
						flatBoost += spdDmg;
						damageText += this.name + " gains " + spdDmg + " damage from weapon. ";
					}
				}
				//Luna Arc
				if(this.hasExactly("Luna Arc") && (this.initiator || (this.rValue > 0 && this.toggle.weapon == 1))){
					var lunaDmg = Math.floor(enemyEffDef * 0.25);
					flatBoost += lunaDmg;
					damageText += this.name + " gains " + lunaDmg + " damage from Luna Arc. ";
				}
				//Astra Blade/Vengeful Lance
				if((this.hasExactly("Astra Blade") || (this.hasExactly("Vengeful Lance") && this.toggle.weapon == 1 && !thisFollowUp)) && thisEffAtk > enemyEffDef){
					var abDmg = Math.floor((thisEffAtk - enemyEffDef) * 0.5);
					flatBoost += abDmg;
					damageText += this.name + " gains " + abDmg + " damage from " + data.skills[this.weaponIndex].name + ". ";
				}
				if((this.hasExactly("Golden Naginata") && this.rValue == 5 && this.combatStartHp / this.maxHp >= 0.7) || (this.hasExactly("Stoutheart Lance") && this.combatStartHp / this.maxHp >= 0.75) || (this.hasExactly("Just Bow") && (this.initiator || this.buddy.rorc > 0))){
					flatBoost += 7;
					damageText += this.name + " gains 7 damage from " + data.skills[this.weaponIndex].name + ". ";
				}
				if(this.hasExactly("Saintly Seraphim") && (this.initiator || (this.rValue > 0 && this.toggle.weapon > 0))){
					var saintDmg = Math.floor(enemyEffRes * 0.25);
					flatBoost += saintDmg;
					damageText += this.name + " gains " + saintDmg + " damage from Saintly Seraphim. ";
				}
				//New Foxkit Fang
				if(this.has("New Foxkit Fang") && thisEffRes + this.getPhantom("Res") > enemyEffRes + enemy.getPhantom("Res")){
					var resDmg = ((thisEffRes + this.getPhantom("Res") - enemyEffRes - enemy.getPhantom("Res")) * 0.7 | 0);
					resDmg = Math.min(resDmg,7);
					flatBoost += resDmg;
					damageText += this.name + " gains " + resDmg + " damage from New Foxkit Fang. ";
				}
				//Candied Dagger
				if(this.hasExactly("Candied Dagger")){
					if(this.initiator){
						var candyDmg = Math.floor(thisEffSpd * 0.1);
						flatBoost += candyDmg;
						damageText += this.name + " gains " + candyDmg + " damage from initiating with Candied Dagger. ";
					}
					//Refined
					if(this.rValue == 5 && enemy.combatStartHp / enemy.maxHp >= 1){
						flatBoost += 7;
						damageText += this.name + " gains 7 damage from Candied Dagger. ";
					}
				}
				if(this.hasExactly("Levin Dagger") && (enemy.checkBonPen(3,this,turn) || (this.rValue > 0 && this.checkBonPen(1,enemy,turn)))){
					var levinDmg = Math.floor(thisEffRes * 0.2);
					flatBoost += levinDmg;
					damageText += this.name + " gains " + levinDmg + " damage from Levin Dagger. ";
				}
				if(this.hasExactly("Resolved Fang") && (enemy.combatStartHp / enemy.maxHp >= 0.75 || (this.rValue > 0 && !this.initiator))){
					if(this.rValue < 0){
						var defDmg = 0;
						if(thisEffDef > enemyEffDef){
							defDmg = ((thisEffDef - enemyEffDef) * 0.7 | 0);
							defDmg = Math.min(defDmg,7);
							flatBoost += defDmg;
							damageText += this.name + " gains " + defDmg + " damage from Resolved Fang. ";
						}
					}
					else{
						var extraDmg = Math.floor(thisEffDef * 0.2);
						flatBoost += extraDmg;
						damageText += this.name + " gains " + extraDmg + " damage from Resolved Fang. ";
					}
				}
				if((this.hasExactly("Giga Excalibur") && this.rValue > 0) || (this.hasExactly("Hades O") && this.rValue == 5 && (this.initiator || enemy.range == "ranged")) || this.hasExactly("Breezy Spear") || (this.hasExactly("The Inexhaustible") && (this.initiator || this.checkBonPen(1,enemy,turn))) || (this.hasExactly("Ice-Tribe Axe") && (this.initiator || this.toggle.weapon == 1)) || (this.hasExactly("Full Rabbit Fang") && (this.transform == true || this.toggle.weapon > 1)) || ((this.hasExactly("Snowman Staff") || this.hasExactly("Swirling Lance") || (this.hasExactly("Joker's Wild") && this.rValue > 0) || (this.hasExactly("Silesse Frost") && this.rValue == 5)) && this.buddy.adjacent + this.buddy.two + this.buddy.three > 0) || (this.hasExactly("Laconic Axe") && (this.initiator || this.buddy.rorc > 0))){
					var spdDmg = Math.floor(thisEffSpd * 0.2);
					flatBoost += spdDmg;
					damageText += this.name + " gains " + spdDmg + " damage from " + data.skills[this.weaponIndex].name + ". ";
				}
				//Luin and Rose-Quartz Bow
				if((this.hasExactly("Rose-Quartz Bow") || this.hasExactly("Celestial Globe") || this.hasExactly("Abyssal Blade") || this.hasExactly("The Cycle's Turn")) && (this.initiator || this.toggle.weapon == 1)){
					var spdDmg = Math.floor(thisEffSpd * 0.2);
					flatBoost += spdDmg;
					damageText += this.name + " gains " + spdDmg + " damage from " + data.skills[this.weaponIndex].name + ". ";
				}
				if((this.hasExactly("Wildflower Edge") || this.hasExactly("Caring Magic") || this.hasExactly("Snaking Sword") || ((this.hasExactly("Starpoint Lance") || this.hasExactly("Thunderbrand") || this.hasExactly("Sparking Tome")) && this.rValue == 5) || (this.hasExactly("Grafcalibur") && this.rValue > 0) || this.hasExactly("Luin") || this.hasExactly("Azure Twin Edge")) && (this.initiator || this.buddy.adjacent > 0 || this.buddy.two > 0)){
					var spdDmg = Math.floor(thisEffSpd * 0.2);
					flatBoost += spdDmg;
					damageText += this.name + " gains " + spdDmg + " damage from " + data.skills[this.weaponIndex].name + ". ";
				}
				//Blade of Renais
				if(this.hasExactly("Blade of Renais") && (this.initiator || this.toggle.weapon > 1) && (this.toggle.weapon % 2 == 1 || checkAllBuffs(this, enemy, turn))){
					var renaisDmg = Math.floor(enemyEffDef * 0.2);
					flatBoost += renaisDmg;
					damageText += this.name + " gains " + renaisDmg + " damage from Blade of Renais. ";
				}
				if((this.hasExactly("Vassal's Blade") || this.hasExactly("Mirage Longbow")) && this.rValue > 0 && (this.initiator || this.buddy.adjacent > 0 || this.buddy.two > 0)){
					var spdDmg = Math.floor(thisEffSpd * 0.15);
					flatBoost += spdDmg;
					damageText += this.name + " gains " + spdDmg + " damage from " + data.skills[this.weaponIndex].name + ". ";
				}
				if((this.hasExactly("Fair-Fury Axe") && (this.initiator || this.toggle.weapon == 1)) || ((this.hasExactly("Arcane Giant Axe") || this.hasExactly("Arcane Fell Arts")) && (!this.initiator || this.combatStartHp / this.maxHp >= 0.25))){
					var atkDmg = Math.floor(thisEffAtk * 0.15);
					flatBoost += atkDmg;
					damageText += this.name + " gains " + atkDmg + " damage from " + data.skills[this.weaponIndex].name + ". ";
				}
				//Refined Swift Mulagir
				if(this.hasExactly("Swift Mulagir") && this.rValue == 5 && (enemy.combatStartHp / enemy.maxHp >= 0.75 || this.initiator)){
					var spdDmg = Math.floor(thisEffSpd * 0.15);
					flatBoost += spdDmg;
					damageText += this.name + " gains " + spdDmg + " damage from Swift Mulagir ";
				}
				if(((this.hasExactly("Sagittae") && allStats[16] < allStats[20]) || (this.hasExactly("Kia Staff") && this.buddy.adjacent + this.buddy.two + this.buddy.three > 0)) && this.rValue > 0){
					var sagDmg = Math.floor(enemyEffAtk * 0.15);
					flatBoost += sagDmg;
					damageText += this.name + " gains " + sagDmg + " damage from " + data.skills[this.weaponIndex].name + ". ";
				}
				//Refined Kaze's Needle
				if(this.hasExactly("Kaze's Needle") && this.rValue == 5 && this.combatStartHp / this.maxHp >= 0.25 && this.getPhantom("Spd") + thisEffSpd > enemy.getPhantom("Spd") + enemyEffSpd){
					flatBoost += 5;
					damageText += this.name + " gains 5 damage from Kaze's Needle. ";
				}
				//Ninja Training Weapons
				if((this.has("Ninja Yumi") || this.has("Ninja Naginata") || this.has("Shuriken Cleaver")) && this.initiator && this.getPhantom("Spd") + thisEffSpd > enemy.getPhantom("Spd") + enemyEffSpd){
					var nDmg = Math.floor((this.getPhantom("Spd") + thisEffSpd - enemy.getPhantom("Spd") - enemyEffSpd) * 0.5);
					nDmg = Math.min(4,nDmg);
					flatBoost += nDmg;
					damageText += this.name + " gains " + nDmg + " damage from " + data.skills[this.weaponIndex].name + ". ";
				}
				if(this.hasExactly("Ninjutsu Scrolls") && this.initiator && this.getPhantom("Spd") + thisEffSpd > enemy.getPhantom("Spd") + enemyEffSpd){
					var nDmg = Math.floor((this.getPhantom("Spd") + thisEffSpd - enemy.getPhantom("Spd") - enemyEffSpd) * 0.7);
					nDmg = Math.min(7,nDmg);
					flatBoost += nDmg;
					damageText += this.name + " gains " + nDmg + " damage from " + data.skills[this.weaponIndex].name + ". ";
				}
				//Inviolable Axe
				if(this.hasExactly("Inviolable Axe") && (this.initiator || this.toggle.weapon == 1)){
					flatBoost += 7;
					damageText += this.name + " gains 7 damage from Inviolable Axe. ";
				}
				//Sparkling Fang
				if(this.hasExactly("Sparkling Fang") && enemy.combatStartHp / enemy.maxHp >= 0.75 && this.getPhantom("Spd") + thisEffSpd > enemy.getPhantom("Spd") + enemyEffSpd){
					flatBoost += 5;
					damageText += this.name + " gains 5 damage from Sparkling Fang. ";
				}
				//Polished Fang
				if(this.hasExactly("Polished Fang") && enemy.combatStartHp / enemy.maxHp >= 0.75 && thisEffDef > enemyEffDef){
					flatBoost += 5;
					damageText += this.name + " gains 5 damage from Polished Fang. ";
				}
				//Ancient Codex
				if(this.hasExactly("Ancient Codex") && this.toggle.weapon == 1){
					rDmg = Math.max(thisEffRes, enemyEffRes);
					rDmg = Math.floor(rDmg * 0.2);
					flatBoost += rDmg;
					damageText += this.name + " gains " + rDmg + " damage from " + data.skills[this.weaponIndex].name + ". ";
				}
				if(((this.hasExactly("Blade of Jehanna") && this.toggle.weapon == 0) || this.hasExactly("Firelight Lance") || this.hasExactly("Ancient Majesty") || (this.hasExactly("Exotic Fruit Juice") && this.rValue > 0) || (this.hasExactly("Plegian War Axe") && this.rValue == 5)) && this.combatStartHp / this.maxHp >= 0.25){
					var blaDmg = Math.floor(enemyEffAtk * 0.15);
					flatBoost += blaDmg;
					damageText += this.name + " gains " + blaDmg + " damage from " + data.skills[this.weaponIndex].name + ". ";
				}
				if((this.hasExactly("Book of Dreams") || this.hasExactly("Whitedown Spear") || this.hasExactly("Hallowed Tyrfing") || this.hasExactly("Sky-Pirate Claw")) && this.rValue == 5 && this.combatStartHp / this.maxHp >= 0.25){
					var extraDmg = Math.floor(thisEffAtk * 0.15);
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from " + data.skills[this.weaponIndex].name + ". ";
				}
				if(this.hasExactly("Hurricane Dagger") && this.rValue == 5 && this.combatStartHp / this.maxHp >= 0.25 && this.getPhantom("Spd") + thisEffSpd > enemy.getPhantom("Spd") + enemyEffSpd){
					flatBoost += 5;
					damageText += this.name + " gains 5 damage from Hurricane Dagger. ";
				}
				if(((this.hasExactly("Pastel Poleaxe") || ((this.hasExactly("Gate-Anchor Axe") || this.hasExactly("Auto-Lofnheidr") || this.hasExactly("Obsidian Lance")) && this.rValue == 5) || this.hasExactly("Ancient Voice")) && this.combatStartHp / this.maxHp >= 0.25) || (this.hasExactly("Illuminating Horn") && (this.initiator || this.toggle.weapon == 1)) || (this.hasExactly("Moon Gradivus") && this.rValue == 5 && this.toggle.weapon == 1) || this.hasExactly("Wyvern Ono") || ((this.hasExactly("Crimson Lance") || this.hasExactly("Horn of Opening")) && this.rValue == 5 && (!this.initiator || enemy.combatStartHp / enemy.maxHp >= 0.75)) || ((this.hasExactly("Horn of Harvest") || this.hasExactly("Fell Slaystone")) && (!this.initiator || enemy.combatStartHp / enemy.maxHp >= 0.75)) || (this.hasExactly("Proud Spear") && (this.initiator || enemy.combatStartHp / enemy.maxHp >= 0.75))){
					var extraDmg = Math.floor(thisEffDef * 0.2);
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from " + data.skills[this.weaponIndex].name + ". ";
				}
				if((this.has("Carrot-Tip Bow") || this.has("Carrot-Tip Spear")) && (enemy.combatStartHp / enemy.maxHp >= 0.75 || this.toggle.weapon == 1) && firstHit){
					var extraDmg = -Math.min(enemy.debuffs.atk,enemy.combatDebuffs.atk) - Math.min(enemy.debuffs.def,enemy.combatDebuffs.def)
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from " + data.skills[this.weaponIndex].name + ". ";
				}
				if(this.hasExactly("Azure Lance") && (this.initiator || this.toggle.weapon == 1 || this.toggle.weapon == 3)){
					flatBoost += 7;
					damageText += this.name + " gains 7 damage from Azure Lance. ";
				}
				if(this.hasExactly("Quick Mulagir") && this.rValue == 5 && this.combatStartHp / this.maxHp >= 0.25 && firstHit){
					var extraDmg = Math.floor(thisEffSpd * 0.15);
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from Quick Mulagir. ";
				}
				if(this.hasExactly("Sylgr") && this.rValue > 0 && (thisEffSpd + this.getPhantom("Spd") > enemyEffSpd + enemy.getPhantom("Spd") || enemy.combatStartHp / enemy.maxHp >= 0.75)){
					var spdDmg = Math.floor(thisEffSpd * 0.15);
					flatBoost += spdDmg;
					damageText += this.name + " gains " + spdDmg + " damage from Sylgr. ";
				}
				if(this.hasExactly("Large War Axe") && turn % 2 == 1 && firstHit){
					var atkDmg = Math.floor(thisEffAtk * 0.15);
					flatBoost += atkDmg;
					damageText += this.name + " gains " + atkDmg + " damage from Large War Axe. ";
				}
				if(this.hasExactly("Ruinous Frost") && (!this.initiator || enemy.combatStartHp / enemy.maxHp >= 0.75) && firstHit){
					var extraDmg = Math.floor(enemyEffRes * 0.4);
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from Ruinous Frost. ";
				}
				if(this.hasExactly("Fell Breath") && this.rValue == 5 && (this.initiator || this.toggle.weapon == 1) && firstHit && thisEffAtk > enemyEffRes + enemy.getPhantom("Res")){
					var fbDmg = Math.floor((thisEffAtk - enemyEffRes) * 0.3);
					flatBoost += fbDmg;
					damageText += this.name + " gains " + fbDmg + " damage from Fell Breath. ";
				}
				if(this.hasExactly("True-Love Roses") && (this.initiator || this.toggle.weapon == 1)){
					var extraDmg = Math.floor(thisEffRes * 0.1);
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from True-Love Roses. ";
				}
				if(this.hasExactly("Raven King Beak") && this.rValue > 0 && (this.initiator || enemy.combatStartHp / enemy.maxHp >= 0.75)){
					var spdDmg = Math.floor(thisEffSpd * 0.15);
					flatBoost += spdDmg;
					damageText += this.name + " gains " + spdDmg + " damage from Raven King Beak. ";
				}
				if(this.has("Covert Cat Fang") && this.rValue == 5 && this.combatStartHp / this.maxHp >= 0.25 && this.toggle.weapon > 0){
					var extraDmg = this.toggle.weapon * 5;
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from Covert Cat Fang. ";
				}
				if(this.hasExactly("New-Height Bow") && this.toggle.weapon == 1){
					var spdDmg = Math.floor(thisEffSpd * 0.15);
					flatBoost += spdDmg;
					damageText += this.name + " gains " + spdDmg + " damage from New-Height Bow. ";
				}
				if(this.has("Taguel Fang") && this.rValue == 5 && this.combatStartHp / this.maxHp >= 0.25 && thisEffSpd + this.getPhantom("Spd") - enemyEffSpd - enemy.getPhantom("Spd") >= 5){
					flatBoost += 7;
					damageText += this.name + " gains 7 damage from Taguel Fang. ";
				}
				if((this.hasExactly("Mila's Testament") || (this.hasExactly("Meisterbogen") && this.rValue == 5)) && (this.initiator || this.toggle.weapon == 1)){
					var eaDmg = Math.floor(enemyEffAtk * 0.1);
					flatBoost += eaDmg;
					damageText += this.name + " gains " + eaDmg + " damage from " + data.skills[this.weaponIndex].name + ". ";
				}
				if((this.hasExactly("Tri-Edge Lance") || this.hasExactly("Gentle Fell Egg")) && (this.initiator || this.buddy.adjacent > 0 || this.buddy.two > 0)){
					var extraDmg = Math.floor(thisEffRes * 0.2);
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from " + data.skills[this.weaponIndex].name + ". ";
				}
				if(this.hasExactly("Divine Breath") && this.rValue == 5 && this.toggle.weapon > 0 && firstHit && thisEffAtk > enemyEffRes + enemy.getPhantom("Res")){
					var dbDmg = Math.floor((thisEffAtk - enemyEffRes) * 0.25);
					flatBoost += dbDmg;
					damageText += this.name + " gains " + dbDmg + " damage from Divine Breath. ";
				}
				if(this.hasExactly("Freikugel") && this.toggle.weapon == 1 && this.rValue > 0){
					var spdDmg = Math.floor(thisEffSpd * 0.1);
					flatBoost += spdDmg;
					damageText += this.name + " gains " + spdDmg + " damage from Freikugel. ";
				}
				if(this.hasExactly("Lofty Leaflet") && enemy.combatStartHp / enemy.maxHp >= 0.5){
					var spdDmg = Math.floor(thisEffSpd * 0.15);
					flatBoost += spdDmg;
					damageText += this.name + " gains " + spdDmg + " damage from Lofty Leaflet. ";
				}
				if(this.hasExactly("Shadowy Quill") && (this.initiator || this.toggle.weapon == 1)){
					var shadowDmg = [0,0,0,0];
					var nCheck = this.checkNegate(enemy,turn);
					for(var i = 0; i < 4; i++){
						if(allStats[14][i] == false){
							shadowDmg[i] = Math.max(this.buffs[data.buffStats[i]],this.combatBuffs[data.buffStats[i]]);
						}
						if(nCheck[i] == false){
							var negDmg = -Math.min(enemy.debuffs[data.buffStats[i]],enemy.combatDebuffs[data.buffStats[i]]);
							shadowDmg[i] = Math.max(shadowDmg[i],negDmg);
						}
					}
					var qDmg = shadowDmg[0] + shadowDmg[1] + shadowDmg[2] + shadowDmg[3];
					flatBoost += qDmg;
					damageText += this.name + " gains " + qDmg + " damage from Shadowy Quill. ";
				}
				if(this.hasExactly("Holytide Tyrfing") && this.buddy.spaces > 0){
					var extraDmg = Math.floor(enemyEffDef * 0.1 * Math.min(this.buddy.spaces,4));
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from " + data.skills[this.weaponIndex].name + ". ";
				}
				if(this.has("Bunny Fang") && this.rValue == 5 && enemy.combatStartHp / enemy.maxHp >= 0.5){
					var spdDmg = Math.floor(thisEffSpd * 0.1);
					flatBoost += spdDmg;
					damageText += this.name + " gains " + spdDmg + " damage from Bunny Fang. ";
				}
				if((this.hasExactly("Arcane Grima") || this.hasExactly("Knightly Manner") || this.hasExactly("Arcane Euphoria") || this.hasExactly("Diva-Pair Parasol") || this.hasExactly("Arcane Blutgang") || this.hasExactly("Arcane Truthfire") || (this.hasExactly("War-God Mjolnir") && this.rValue > 0) || this.hasExactly("Arcane Sly Knife") || this.hasExactly("Arcane Medusa")) && this.combatStartHp / this.maxHp >= 0.25){
					var atkDmg = Math.floor(thisEffAtk * 0.15);
					flatBoost += atkDmg;
					damageText += this.name + " gains " + atkDmg + " damage from " + data.skills[this.weaponIndex].name + ". ";
				}
				if(this.hasExactly("Rite of Souls") && (this.initiator || this.toggle.weapon > 1)){
					var extraDmg = Math.floor(thisEffRes * 0.2);
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from Rite of Souls. ";
				}
				if(this.hasExactly("Ardent Durandal") && this.rValue == 5 && (this.initiator || this.toggle.weapon == 1)){
					var extraDmg = Math.floor(enemyEffDef * 0.15);
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from Ardent Durandal. ";
				}
				if((this.hasExactly("Snide Bow") || (this.hasExactly("Inner Wellspring") && this.rValue == 5)) && this.combatStartHp / this.maxHp >= 0.25){
					flatBoost += 7;
					damageText += this.name + " gains 7 damage from " + data.skills[this.weaponIndex].name + ". ";
				}
				if(this.hasExactly("Savage Breath") && this.rValue == 5 && this.combatStartHp / this.maxHp >= 0.25 && thisEffAtk > enemyEffRes+enemy.getPhantom("Res") && firstHit && this.toggle.weapon > -1 && this.toggle.weapon < 3){
					var sbDmg = Math.floor((thisEffAtk - enemyEffRes+enemy.getPhantom("Res")) * (0.3 - (this.toggle.weapon * 0.1)));
					flatBoost += sbDmg;
					damageText += this.name + " gains " + sbDmg + " damage from Savage Breath. ";
				}
				if(this.hasExactly("Seidr") && (this.initiator || this.toggle.weapon == 1)){
					var extraDmg = Math.floor(thisEffRes * 0.2);
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from Seidr. ";
				}
				if(this.hasExactly("Fang of Finality") && (this.initiator || this.toggle.weapon > 9)){
					var sVar = this.toggle.weapon;
					if(sVar > 9){
						sVar = sVar - 10;
					}
					sVar = (sVar + 1) * 0.1;
					var extraDmg = Math.floor(thisEffSpd * sVar);
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from Fang of Finality. ";
				}
				if(this.hasExactly("Joyous Tome") && this.toggle.weapon > 0){
					var extraDmg = this.toggle.weapon * 5;
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from Joyous Tome. ";
				}
				if((this.hasExactly("Dreaming Spear") && this.toggle.weapon == 1) || ((this.hasExactly("Radiant Aureola") || ((this.hasExactly("Banshee TH") || this.hasExactly("Dazzling Breath") || this.hasExactly("Indignant Bow")) && this.rValue > 0) || this.hasExactly("Dark Monograph")) && (!this.initiator || enemy.combatStartHp / enemy.maxHp >= 0.75))){
					var extraDmg = Math.floor(thisEffRes * 0.2);
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from " + data.skills[this.weaponIndex].name + ". ";
				}
				if((this.hasExactly("Monarch Blade") || ((this.hasExactly("Prized Lance") || this.hasExactly("Larcei's Edge") || this.hasExactly("Apotheosis Spear")) && this.rValue == 5)) && this.combatStartHp / this.maxHp >= 0.25){
					var spdDmg = Math.floor(thisEffSpd * 0.15);
					flatBoost += spdDmg;
					damageText += this.name + " gains " + spdDmg + " damage from " + data.skills[this.weaponIndex].name + ". ";
				}
				if(((this.hasExactly("Noble Lance") && (this.initiator || enemy.combatStartHp / enemy.maxHp >= 0.75)) || (this.hasExactly("Tiger-Eye Axe") && (this.checkBonPen(1,enemy,turn) || enemy.checkBonPen(3,this.turn)))) && this.rValue == 5){
					var extraDmg = Math.floor(thisEffAtk * 0.1);
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from " + data.skills[this.weaponIndex].name + ". ";
				}
				if(this.hasExactly("Duskbloom Bow") && (this.initiator || this.toggle.weapon > 1) && thisEffRes + this.getPhantom("Res") - enemyEffRes - enemy.getPhantom("Res") >= 4){
					var extraDmg = Math.floor(thisEffRes * 0.2);
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from Duskbloom Bow. ";
				}
				if((this.has("Petalfall Blade") || this.has("Petalfall Vase") || this.has("Null Blade") || this.has("Null Spear")) && this.combatStartHp / this.maxHp >= 0.25 && thisEffSpd + this.getPhantom("Spd") > enemyEffSpd + enemy.getPhantom("Spd")){
					flatBoost += 5;
					damageText += this.name + " gains 5 damage from " + data.skills[this.weaponIndex].name + ". ";
				}
				if((this.hasExactly("Queensblade") || this.hasExactly("Arcane Luin") || this.hasExactly("Fujin-Raijin Yumi") || this.hasExactly("Teatime's Edge") || this.hasExactly("Aptitude Arrows") || ((this.hasExactly("Phantasm Tome") || this.hasExactly("Lyngheidr") || this.hasExactly("Spear of Shadow") || this.hasExactly("Blade of Shadow") || this.hasExactly("Professorial Guide") || this.hasExactly("Talregan Axe") || this.hasExactly("Survivalist Bow") || this.hasExactly("Tome of Storms") || this.hasExactly("Aerial Longsword") || this.hasExactly("Tailwind Shuriken")) && this.rValue == 5) || this.hasExactly("Flower of Tribute") || this.hasExactly("Monarch's Stone") || this.hasExactly("Sky-Hopper Egg") || this.hasExactly("Dead-Crow Tome") || this.hasExactly("Closing Florets") || this.hasExactly("United Bouquet") || this.hasExactly("Thief's Honesty") || this.hasExactly("Nidavellir Ballista") || this.hasExactly("Dvergr Wayfinder") || this.hasExactly("Red-Fist Blades") || this.hasExactly("Hidden Blade") || this.hasExactly("Petaldream Horn") || this.hasExactly("Baton of Dusk") || this.hasExactly("Ancient Trickery")) && this.combatStartHp / this.maxHp >= 0.25){
					var extraDmg = Math.floor(thisEffSpd * 0.2);
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from " + data.skills[this.weaponIndex].name + ". ";
				}
				if(this.hasExactly("Victorious Axe") && this.rValue == 5 && (this.initiator || this.toggle.weapon > 1)){
					var extraDmg = Math.floor(thisEffAtk * 0.1);
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from Victorious Axe. ";
				}
				if(this.hasExactly("Gusty War Bow") && this.toggle.weapon > 1 && (this.sTrigger == 1 || (this.specialIndex!=-1 && data.skills[this.specialIndex].charge <= this.charge))){
					flatBoost += 7;
					damageText += this.name + " gains 7 damage from Gusty War Bow. ";
				}
				if(this.hasExactly("Asclepius") && this.combatStartHp / this.maxHp >= 0.25){
					var asDmg = 0;
					var nCheck = this.checkNegate(enemy,turn);
					for(var i = 0; i < 4; i++){
						if(nCheck[i] == false){
							asDmg += -Math.min(enemy.debuffs[data.buffStats[i]],enemy.combatDebuffs[data.buffStats[i]]);
						}
					}
					flatBoost += asDmg;
					damageText += this.name + " gains " + asDmg + " damage from Asclepius. ";
				}
				if(((this.hasExactly("Freeblade's Edge") && this.rValue == 5) || this.hasExactly("Heired Gungnir")) && this.combatStartHp / this.maxHp >= 0.25){
					var extraDmg = Math.floor(thisEffDef * 0.15);
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from " + data.skills[this.weaponIndex].name + ". ";
				}
				if(this.hasExactly("Sokkvabekkr") && this.rValue > 0 && this.toggle.weapon == 1 && (this.sTrigger == 1 || (this.specialIndex !=- 1 && data.skills[this.specialIndex].charge <= this.charge))){
					flatBoost += 5;
					damageText += this.name + " gains 5 damage from Sokkvabekkr. ";
				}
				if(this.hasExactly("Aymr") && this.rValue == 5 && (this.toggle.weapon == 1 || enemy.combatStartHp / enemy.maxHp >= 0.75)){
					var extraDmg = Math.floor(thisEffAtk * 0.15);
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from Aymr. ";
				}
				if((this.hasExactly("Silent Breath") || (this.hasExactly("Brutal Breath") && this.rValue == 5)) && (!this.initiator || enemy.combatStartHp / enemy.maxHp >= 0.75)){
					var extraDmg = Math.floor(thisEffSpd * 0.2);
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from " + data.skills[this.weaponIndex].name + ". ";
				}
				if((this.hasExactly("Dead-Fang Axe") || this.hasExactly("Spear")) && this.combatStartHp / this.maxHp >= 0.25){
					var extraDmg = Math.floor(thisEffAtk * 0.1);
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from  " + data.skills[this.weaponIndex].name + ". ";
				}
				if((this.hasExactly("Heartbroker Bow") || (this.hasExactly("Brilliant Rapier") && this.rValue == 5) || this.has("Dragonbloom") || this.has("Harp Bow")) && (this.initiator || this.buddy.adjacent > 0 || this.buddy.two > 0)){
					var extraDmg = Math.floor(thisEffSpd * 0.15);
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from " + data.skills[this.weaponIndex].name + ". ";
				}
				if((((this.hasExactly("Guardian's Bow") || this.hasExactly("Mareeta's Sword")) && this.rValue == 5) || this.hasExactly("Violdrake Bow")) && this.combatStartHp / this.maxHp >= 0.25){
					var spdDmg = Math.floor(thisEffSpd * 0.1);
					flatBoost += spdDmg;
					damageText += this.name + " gains " + spdDmg + " damage from " + data.skills[this.weaponIndex].name + ". ";
				}
				if((this.hasExactly("Ilian Merc Lance") && this.toggle.weapon > 1) || (this.hasExactly("Salvage") && (this.initiator || this.buddy.adjacent > 0 || this.buddy.two > 0))){
					var blaDmg = Math.floor(enemyEffAtk * 0.15);
					flatBoost += blaDmg;
					damageText += this.name + " gains " + blaDmg + " damage from " + data.skills[this.weaponIndex].name + ". ";
				}
				if(this.hasExactly("Heidr") && (this.initiator || this.toggle.weapon > 1)){
					var extraDmg = Math.floor(thisEffAtk * 0.15);
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from Heidr. ";
				}
				if(this.hasExactly("Surfer's Spire") || this.hasExactly("Surfer's Spade")){
					var spdDmg = Math.floor(thisEffSpd * 0.2);
					flatBoost += spdDmg;
					damageText += this.name + " gains " + spdDmg + " damage from " + data.skills[this.weaponIndex].name + ". ";
				}
				if(this.hasExactly("Father's-Son Axe") && this.rValue == 5 && (this.initiator || this.toggle.weapon == 1)){
					var extraDmg = Math.floor(this.combatStartHp * 0.15);
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from Father's-Son Axe. ";
				}
				if(this.hasExactly("Void Tome") && this.rValue == 5 && allStats[20] >= 50){
					var extraDmg = Math.floor(allStats[20] * 0.15);
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from Void Tome. ";
				}
				if(this.hasExactly("Divine Draught") && this.combatStartHp / this.maxHp >= 0.25 && this.toggle.weapon == 2 && this.initiator){
					var extraDmg = Math.max(thisEffAtk, enemyEffAtk) * 0.15;
					extraDmg = Math.floor(extraDmg);
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from Divine Draught. ";
				}
				if((this.hasExactly("Fair-Fight Blade") && this.combatStartHp / this.maxHp >= 0.25) || (this.hasExactly("Bold Kusarigama") && (this.initiator || this.buddy.adjacent > 0 || this.buddy.two > 0))){
					var extraDmg = Math.floor(thisEffDef * 0.25);
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from " + data.skills[this.weaponIndex].name + ". ";
				}
				if(this.hasExactly("Tome of Luxuries") && this.combatStartHp / this.maxHp >= 0.25){
					var extraDmg = Math.floor(thisEffRes * 0.15);
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from " + data.skills[this.weaponIndex].name + ". ";
				}
				if(this.hasExactly("Arcane Nihility") && this.combatStartHp / this.maxHp >= 0.25){
					var extraDmg = Math.floor(thisEffSpd * 0.15);
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from Arcane Nihility. ";
				}
				if(this.hasExactly("Virtuous Tyrfing") && this.rValue > 0 && (this.combatStartHp / this.maxHp < 1 || !this.initiator || enemy.combatStartHp / enemy.maxHp >= 0.75)){
					var extraDmg = Math.floor(thisEffAtk * 0.15);
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from Virtuous Tyrfing. ";
				}
				if(this.hasExactly("Hel's Reaper") && this.rValue == 5 && (this.combatStartHp / this.maxHp >= 0.25 || this.toggle.weapon == 1)){
					var spdDmg = Math.floor(thisEffSpd * 0.2);
					flatBoost += spdDmg;
					damageText += this.name + " gains " + spdDmg + " damage from Hel's Reaper. ";
				}
				if(this.hasExactly("Wildcat Dagger") && this.rValue == 5 && (this.initiator || enemy.combatStartHp / enemy.maxHp >= 0.75)){
					var extraDmg = Math.floor(thisEffSpd * 0.1);
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from Wildcat Dagger. ";
				}
				if(this.hasExactly("Obscurite") && (this.initiator || ((this.buddy.adjacent > 0 || this.buddy.two > 0) && this.toggle.weapon > 1))){
					var extraDmg = Math.floor(thisEffRes * 0.2);
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from Obscurite. ";
				}
				if((this.hasExactly("Earthly Gae Bolg") && this.rValue > 0 && (enemy.moveType != "flying" || this.combatStartHp / this.maxHp >= 0.5)) || (this.hasExactly("Majestic Glitnir") && (this.initiator || this.buddy.rorc > 0))){
					var extraDmg = Math.floor(thisEffDef * 0.1);
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from " + data.skills[this.weaponIndex].name + ". ";
				}
				if((this.hasExactly("Radiant Scrolls") && (this.initiator || this.buddy.adjacent > 0 || this.buddy.two > 0)) || (this.hasExactly("Petrify") && this.rValue == 5 && this.combatStartHp / this.maxHp >= 0.25)){
					var yVal = 0;
					var eNegate = this.checkNegate(enemy, turn);
					if(eNegate[0] == false){
						var aVal = Math.min(enemy.combatDebuffs.atk,enemy.debuffs.atk);
						if(enemy.penalty.panic){
							aVal -= Math.max(enemy.combatBuffs.atk,enemy.buffs.atk);
						}
						yVal += aVal;
					}
					if(eNegate[1] == false){
						var sVal = Math.min(enemy.combatDebuffs.spd,enemy.debuffs.spd);
						if(enemy.penalty.panic){
							sVal -= Math.max(enemy.combatBuffs.spd,enemy.buffs.spd);
						}
						yVal += sVal;
					}
					if(eNegate[2] == false){
						var dVal = Math.min(enemy.combatDebuffs.def,enemy.debuffs.def);
						if(enemy.penalty.panic){
							dVal -= Math.max(enemy.combatBuffs.def,enemy.buffs.def);
						}
						yVal += dVal;
					}
					if(eNegate[3] == false){
						var rVal = Math.min(enemy.combatDebuffs.res,enemy.debuffs.res);
						if(enemy.penalty.panic){
							rVal -= Math.max(enemy.combatBuffs.res,enemy.buffs.res);
						}
						yVal += rVal;
					}
					yVal = -Math.min(yVal,enemy.buddy.debuffs.atk + enemy.buddy.debuffs.spd + enemy.buddy.debuffs.def + enemy.buddy.debuffs.res);
					flatBoost += yVal;
					damageText += this.name + " gains " + yVal + " damage from " + data.skills[this.weaponIndex].name + ". ";;
				}
				if(this.hasExactly("Grimleal Text") && this.combatStartHp / this.maxHp >= 0.25){
					var extraDmg = (Object.values(enemy.penalty).reduce((a, item) => a + (item === true ? 1 : 0), 0) + enemy.penalty.extra) * 4;
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from Grimleal Text. ";
				}
				if((this.hasExactly("Goddess Temari") && this.combatStartHp / this.maxHp >= 0.25 && (turn > 2 || this.toggle.weapon == 1)) || (this.hasExactly("Aureola") && this.rValue > 0 && (this.initiator || this.buddy.adjacent > 0 || this.buddy.two > 0))){
					var xVal = 0;
					if(!this.penalty.panic){
						xVal = Math.max(this.combatBuffs.atk,this.buffs.atk) + Math.max(this.combatBuffs.spd,this.buffs.spd) + Math.max(this.combatBuffs.def,this.buffs.def) + Math.max(this.combatBuffs.res,this.buffs.res);
					}
					xVal = Math.max(xVal,this.buddy.buffs.atk + this.buddy.buffs.spd + this.buddy.buffs.def + this.buddy.buffs.res);
					flatBoost += xVal;
					damageText += this.name + " gains " + xVal + " damage from " + data.skills[this.weaponIndex].name + ". ";
				}
				if(this.hasExactly("Studied Forblaze") && this.rValue == 5 && (this.initiator || this.buddy.adjacent > 0 || this.buddy.two > 0)){
					var extraDmg = Math.floor(thisEffRes * 0.15);
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from " + data.skills[this.weaponIndex].name + ". ";
				}
				if(((this.hasExactly("Mirage Rod") && this.rValue == 5) || this.hasExactly("Lucky Bow")) && (enemy.combatStartHp / enemy.maxHp >= 0.75 || !this.initiator)){
					var extraDmg = Math.floor(thisEffAtk * 0.15);
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from " + data.skills[this.weaponIndex].name + ". ";
				}
				if(this.hasExactly("Winds of Change") && this.rValue > 0 && (this.combatStartHp / this.maxHp >= 0.5 || checkAllBuffs(this, enemy, turn) || Object.values(this.bonus).reduce((a, item) => a + (item === true ? 1 : 0), 0) + this.bonus.extra > 0)){
					var extraDmg = Math.floor(thisEffSpd * 0.15);
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from " + data.skills[this.weaponIndex].name + ". ";
				}
				if(this.hasExactly("Constant Dagger") && this.rValue > 0 && (this.initiator || this.buddy.adjacent > 0 || this.buddy.two > 0)){
					var extraDmg = Math.floor(thisEffSpd * 0.1);
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from " + data.skills[this.weaponIndex].name + ". ";
				}
				if(this.hasExactly("Thief") && this.combatStartHp / this.maxHp >= 0.25){
					var extraDmg = (Object.values(this.bonus).reduce((a, item) => a + (item === true ? 1 : 0), 0) + this.bonus.extra) * 5;
					extraDmg = Math.min(extraDmg,20);
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from Thief. ";
				}
				if(this.hasExactly("Blade of Sands") && (this.initiator || this.buddy.adjacent > 0 || this.buddy.two > 0)){
					var extraDmg = Math.floor(thisEffSpd * 0.2);
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from " + data.skills[this.weaponIndex].name + ". ";
				}
				if((this.has("Nabata Beacon") || this.has("Nabata Lance") || this.has("Snaking Bow") || this.has("Hexblade Sword") || (this.hasExactly("Skinfaxi") && this.rValue == 5)) && (this.initiator || this.buddy.adjacent > 0 || this.buddy.two > 0)){
					var extraDmg = Math.floor(thisEffAtk * 0.1);
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from " + data.skills[this.weaponIndex].name + ". ";
				}
				if(this.hasExactly("Sandglass Bow") && (this.initiator || this.buddy.adjacent > 0 || this.buddy.two > 0)){
					var extraDmg = Math.floor(thisEffAtk * 0.15);
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from " + data.skills[this.weaponIndex].name + ". ";
				}
				if(this.hasExactly("Arcane Charmer") && this.combatStartHp / this.maxHp >= 0.25){
					flatBoost += 7;
					damageText += this.name + " gains 7 damage from " + data.skills[this.weaponIndex].name + ". ";
				}
				if(this.hasExactly("Aurora Breath") && this.rValue == 5 && this.combatStartHp / this.maxHp >= 0.25 && firstHit){
					var extraDmg = Math.floor(enemyEffRes * 0.15);
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from Aurora Breath. ";
				}
				if(this.hasExactly("Crusher") && this.rValue == 5 && (this.initiator || this.buddy.adjacent > 0 || this.buddy.two > 0) && (enemy.combatDebuffs.spd < 0 || enemy.debuffs.spd < 0 || enemy.combatDebuffs.def < 0 || enemy.debuffs.def < 0 || enemy.combatDebuffs.res < 0 || enemy.debuffs.res < 0 || (enemy.penalty.panic && (enemy.combatBuffs.spd > 0 || enemy.buffs.spd > 0 || enemy.combatBuffs.def > 0 || enemy.buffs.def > 0 || enemy.combatBuffs.res > 0 || enemy.buffs.res > 0)))){
					var extraDmg = Math.floor(thisEffAtk * 0.15);
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from Crusher. ";
				}
				if((((this.hasExactly("Dark Scripture") || this.hasExactly("Craver's Tome") || this.hasExactly("New Dawn")) && this.rValue == 5) || this.hasExactly("Supreme Thokk") || this.hasExactly("New Year Treats") || this.hasExactly("Fimbulvetr Morn") || this.hasExactly("Tome of Fury") || this.hasExactly("Tome of Dusk") || this.hasExactly("Fundament")) && this.combatStartHp / this.maxHp >= 0.25){
					var extraDmg = Math.floor(thisEffRes * 0.2);
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from " + data.skills[this.weaponIndex].name + ". ";
				}
				if(this.hasExactly("Astral Breath") && this.rValue == 5 && this.combatStartHp / this.maxHp >= 0.25){
					var xVal = 0;
					if(!this.penalty.panic){
						xVal = Math.max(this.combatBuffs.atk,this.buffs.atk) + Math.max(this.combatBuffs.spd,this.buffs.spd) + Math.max(this.combatBuffs.def,this.buffs.def) + Math.max(this.combatBuffs.res,this.buffs.res);
					}
					xVal = Math.max(xVal,this.buddy.buffs.atk + this.buddy.buffs.spd + this.buddy.buffs.def + this.buddy.buffs.res);
					flatBoost += xVal;
					damageText += this.name + " gains " + xVal + " damage from Astral Breath. ";
				}
				if((this.hasExactly("Exalt's War Staff") || this.hasExactly("Staff of Yngvi") || (this.hasExactly("Staff of the Saint") && this.rValue > 0) || this.hasExactly("Prior's Tome")) && this.buddy.adjacent + this.buddy.two + this.buddy.three > 0){
					var extraDmg = Math.floor(thisEffRes * 0.2);
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from " + data.skills[this.weaponIndex].name + ". ";
				}
				if(this.hasExactly("Heavy War Axe") && (this.initiator || this.buddy.adjacent > 0 || this.buddy.two > 0)){
					var extraDmg = Math.floor(thisEffDef * 0.2);
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from Heavy War Axe. ";
				}
				if(this.hasExactly("Professorial Text") && this.rValue > 0 && (this.initiator || this.toggle.weapon > 0)){
					flatBoost += 7;
					damageText += this.name + " gains 7 damage from Professorial Text. ";
				}
				if((this.hasExactly("Blood Tome") && this.rValue > 0 && (this.initiator || enemy.range == "ranged")) || (this.hasExactly("Blessed Aureola") && this.buddy.rorc > 0)){
					var extraDmg = Math.floor(thisEffRes * 0.2);
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from " + data.skills[this.weaponIndex].name + ". ";
				}
				if(this.hasExactly("Ereshkigal") && this.combatStartHp / this.maxHp >= 0.25){
					var extraDmg = Math.min((Object.values(this.bonus).reduce((a, item) => a + (item === true ? 1 : 0), 0) + this.bonus.extra) * 5, 25);
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from Ereshkigal. ";
				}
				if(this.hasExactly("Silver of Dawn") && this.combatStartHp / this.maxHp >= 0.25){
					var extraDmg = this.toggle.weapon * 5;
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from Silver of Dawn. ";
				}
				if(this.hasExactly("Golden Sunlight") && (this.initiator || enemy.combatStartHp / enemy.maxHp >= 0.75)){
					var extraDmg = Math.floor(thisEffSpd * 0.2);
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from Golden Sunlight. ";
				}
				if((this.hasExactly("Maritime Arts") || this.hasExactly("Wintery Arts")) && this.buddy.adjacent + this.buddy.two + this.buddy.three > 0){
					var extraDmg = 5 * this.toggle.weapon;
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from " + data.skills[this.weaponIndex].name + ". ";
				}
				if(this.hasExactly("Wild Wind Sword") && this.combatStartHp / this.maxHp >= 0.25){
					var extraDmg = Math.floor(this.combineBonPen(enemy,turn,"debuff",false) * 1.5);
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from Wild Wind Sword. ";
				}
				if(((this.hasExactly("Quieting Antler") || this.hasExactly("Delivering Antler")) && (this.initiator || this.buddy.adjacent > 0 || this.buddy.two > 0)) || (this.hasExactly("Vedrfolnir's Edge") && (this.initiator || this.buddy.rorc > 0))){
					var xVal = 0;
					if(!this.penalty.panic){
						xVal = Math.max(this.combatBuffs.atk,this.buffs.atk) + Math.max(this.combatBuffs.spd,this.buffs.spd) + Math.max(this.combatBuffs.def,this.buffs.def) + Math.max(this.combatBuffs.res,this.buffs.res);
					}
					xVal = Math.max(xVal,this.buddy.buffs.atk + this.buddy.buffs.spd + this.buddy.buffs.def + this.buddy.buffs.res);
					flatBoost += xVal;
					damageText += this.name + " gains " + xVal + " damage from " + data.skills[this.weaponIndex].name + ". ";
				}
				if(((this.hasExactly("Spear of Assal") && this.rValue == 5) || this.hasExactly("Lady's Bow")) && this.buddy.adjacent + this.buddy.two + this.buddy.three > 0){
					flatBoost += 7;
					damageText += this.name + " gains 7 damage from " + data.skills[this.weaponIndex].name + ". ";
				}
				if(this.hasExactly("Sun's Percussors") && this.rValue == 5 && (this.initiator || this.buddy.adjacent + this.buddy.two + this.buddy.three > 0)){
					var extraDmg = Math.floor(thisEffSpd * 0.15);
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from Sun's Percussors. ";
				}
				if(this.hasExactly("Summertime Axe") && this.combatStartHp / this.maxHp >= 0.25){
					var extraDmg = Math.min((Object.values(this.bonus).reduce((a, item) => a + (item === true ? 1 : 0), 0) + this.bonus.extra + Object.values(enemy.bonus).reduce((a, item) => a + (item === true ? 1 : 0), 0) + enemy.bonus.extra) * 5, 30);
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from Summertime Axe. ";
				}
				if((this.has("Juicy Bucketful") || this.has("Stall-Game Bow") || this.has("Raudrcrab")) && this.combatStartHp / this.maxHp >= 0.25){
					var extraDmg = Math.min((Object.values(this.bonus).reduce((a, item) => a + (item === true ? 1 : 0), 0) + this.bonus.extra + Object.values(enemy.bonus).reduce((a, item) => a + (item === true ? 1 : 0), 0) + enemy.bonus.extra) * 5, 25);
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from " + data.skills[this.weaponIndex].name + ". ";
				}
				if(this.hasExactly("Berserker Axe") && (!this.initiator || enemy.combatStartHp / enemy.maxHp >= 0.75)){
					var extraDmg = Math.min(this.maxHp - this.hp, 30);
					extraDmg += Math.floor(thisEffAtk * 0.15);
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from " + data.skills[this.weaponIndex].name + ". ";
				}
				if(this.hasExactly("Grim Brokkr") && this.rValue > 0 && (this.initiator || this.buddy.adjacent < 2)){
					var extraDmg = Math.floor(thisEffAtk * 0.15);
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from Grim Brokkr. ";
				}
				if(this.hasExactly("Geirdriful") && this.rValue == 5 && this.combatStartHp / this.maxHp >= 0.25){
					var extraDmg = Math.min((Object.values(this.bonus).reduce((a, item) => a + (item === true ? 1 : 0), 0) + this.bonus.extra) * 4, 16);
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from Geirdriful. ";
				}
				if(this.hasExactly("Holy-War Spear") && (this.initiator || this.buddy.adjacent > 0 || this.buddy.two > 0)){
					var extraDmg = Math.floor(thisEffDef * 0.2);
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from Holy-War Spear. ";
				}
				if(this.hasExactly("Stone of Delights") && this.buddy.adjacent + this.buddy.two + this.buddy.three > 0){
					var extraDmg = Math.min(this.maxHp - enemy.combatStartHp, 16);
					extraDmg = Math.max(extraDmg, 8);
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from Stone of Delights. ";
				}
				if((this.hasExactly("Quieting Claw") && this.combatStartHp / this.maxHp >= 0.25) || (this.hasExactly("New Year Talon") && (this.transform == true || enemy.combatStartHp / enemy.maxHp >= 0.75)) || (this.hasExactly("Axe of Dusk") && (this.initiator || enemy.combatStartHp / enemy.maxHp >= 0.75))){
					var extraDmg = (Object.values(enemy.penalty).reduce((a, item) => a + (item === true ? 1 : 0), 0) + enemy.penalty.extra + Object.values(enemy.bonus).reduce((a, item) => a + (item === true ? 1 : 0), 0) + enemy.bonus.extra) * 3;
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from " + data.skills[this.weaponIndex].name + ". ";
				}
				if(this.hasExactly("Heavenly Icicle") && this.rValue == 5 && (this.initiator || this.buddy.adjacent + this.buddy.two + this.buddy.three > 0)){
					var extraDmg = Math.min((this.buddy.adjacent + this.buddy.two + this.buddy.three + enemy.buddy.adjacent + enemy.buddy.two + enemy.buddy.three + 1) * 4, 16);
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from Heavenly Icicle. ";
				}
				if(this.hasExactly("Scroll of Teas") && (this.initiator || this.buddy.adjacent + this.buddy.two + this.buddy.three > 0)){
					var extraDmg = this.toggle.weapon * 6;
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from Scroll of Teas. ";
				}
				if((this.hasExactly("Ylisse Ninja Bow") || this.hasExactly("Divine Yewfelle")) && (this.initiator || this.buddy.adjacent > 0 || this.buddy.two > 0)){
					var extraDmg = Math.min((Object.values(enemy.penalty).reduce((a, item) => a + (item === true ? 1 : 0), 0) + enemy.penalty.extra + Object.values(this.bonus).reduce((a, item) => a + (item === true ? 1 : 0), 0) + this.bonus.extra) * 5, 25);
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from " + data.skills[this.weaponIndex].name + ". ";
				}
				if((this.hasExactly("Enticing Dose") || this.hasExactly("New Year Fang")) && (this.transform == true || this.combatStartHp / this.maxHp >= 0.25)){
					var extraDmg = Math.floor(enemy.maxHp * 0.3);
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from " + data.skills[this.weaponIndex].name + ". ";
				}
				if((this.hasExactly("Fellowship Blade") || this.hasExactly("Sword of Peace")) && this.buddy.adjacent + this.buddy.two + this.buddy.three > 0){
					var xVal = 0;
					if(!this.penalty.panic){
						xVal = Math.max(this.combatBuffs.atk,this.buffs.atk) + Math.max(this.combatBuffs.spd,this.buffs.spd) + Math.max(this.combatBuffs.def,this.buffs.def) + Math.max(this.combatBuffs.res,this.buffs.res);
					}
					xVal = Math.max(xVal,this.buddy.buffs.atk + this.buddy.buffs.spd + this.buddy.buffs.def + this.buddy.buffs.res);
					flatBoost += xVal;
					damageText += this.name + " gains " + xVal + " damage from " + data.skills[this.weaponIndex].name + ". ";
				}
				if((this.hasExactly("Odr of Creation") || (this.hasExactly("Wing-Lifted Spear") && this.rValue > 0)) && (this.initiator || this.buddy.adjacent > 0 || this.buddy.two > 0)){
					var extraDmg = Math.min((Object.values(enemy.bonus).reduce((a, item) => a + (item === true ? 1 : 0), 0) + enemy.bonus.extra + Object.values(this.bonus).reduce((a, item) => a + (item === true ? 1 : 0), 0) + this.bonus.extra) * 5, 25);
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from " + data.skills[this.weaponIndex].name + ". ";
				}
				if(this.hasExactly("Icy Ravager") && (!this.initiator || enemy.combatStartHp / enemy.maxHp >= 0.75)){
					var extraDmg = this.toggle.weapon * 3 + 10;
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from Icy Ravager. ";
				}
				if(this.hasExactly("Goddess Axe") && this.rValue == 5 && (this.initiator || this.buddy.adjacent > 0 || this.buddy.two > 0)){
					var extraDmg = Math.floor(thisEffDef * 0.15);
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from Goddess Axe. ";
				}
				if(this.hasExactly("Rampart Bow") && this.combatStartHp / this.maxHp >= 0.25){
					var extraDmg = Math.max(this.toggle.weapon * 8, 8);
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from Rampart Bow. ";
				}
				if(this.hasExactly("Sword of Isaach") && this.combatStartHp / this.maxHp >= 0.25){
					var extraDmg = Math.min((Object.values(enemy.penalty).reduce((a, item) => a + (item === true ? 1 : 0), 0) + enemy.penalty.extra + Object.values(this.bonus).reduce((a, item) => a + (item === true ? 1 : 0), 0) + this.bonus.extra) * 5, 25);
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from Sword of Isaach. ";
				}
				if(this.hasExactly("Ebon Bolverk") && this.rValue > 0 && (this.initiator || this.buddy.adjacent > 0 || this.buddy.two > 0)){
					var extraDmg = Math.min((Object.values(this.bonus).reduce((a, item) => a + (item === true ? 1 : 0), 0) + this.bonus.extra + Object.values(enemy.bonus).reduce((a, item) => a + (item === true ? 1 : 0), 0) + enemy.bonus.extra) * 5, 25);
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from Ebon Bolverk. ";
				}
				if((this.hasExactly("Eagle's Heart") && (this.initiator || this.buddy.adjacent < 2)) || ((this.hasExactly("Lion's Heart") || this.hasExactly("Deer's Heart") || this.has("Devoted Cup")) && (this.initiator || this.buddy.adjacent > 0 || this.buddy.two > 0))){
					var extraDmg = Math.min((Object.values(this.bonus).reduce((a, item) => a + (item === true ? 1 : 0), 0) + this.bonus.extra + Object.values(enemy.penalty).reduce((a, item) => a + (item === true ? 1 : 0), 0) + enemy.penalty.extra) * 5, 25);
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from " + data.skills[this.weaponIndex].name + ". ";
				}
				if(this.hasExactly("Devoted Breath") && (!this.initiator || enemy.combatStartHp / enemy.maxHp >= 0.75)){
					var extraDmg = Math.min((this.buddy.adjacent + this.buddy.two + this.buddy.three) * 5, 15);
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from Devoted Breath. ";
				}
				if((this.has("Spring-Air Egg") || this.has("Spring-Air Axe")) && this.combatStartHp / this.maxHp >= 0.25){
					var extraDmg = Math.min((enemy.buddy.adjacent + enemy.buddy.two + enemy.buddy.three + 1) * 5, 20);
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from " + data.skills[this.weaponIndex].name + ". ";
				}
				if(this.hasExactly("Springing Spear") && this.buddy.rorc > 0){
					flatBoost += 10;
					damageText += this.name + " gains 10 damage from " + data.skills[this.weaponIndex].name + ". ";
				}
				if(this.hasExactly("True-Bond Bow") && (this.initiator || this.buddy.adjacent > 0 || this.buddy.two > 0)){
					var extraDmg = Math.min((this.talent.atk + this.talent.spd) * 2, 30);
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from True-Bond Bow. ";
				}
				if(this.hasExactly("Taciturn Axe") && this.buddy.adjacent + this.buddy.two + this.buddy.three > 0){
					var extraDmg = Math.floor(thisEffDef * (0.2 + (this.toggle.weapon * 0.1)));
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from Taciturn Axe. ";
				}
				if(this.hasExactly("Duskstone") && this.combatStartHp / this.maxHp >= 0.25){
					var extraDmg = Math.min((this.buddy.adjacent + this.buddy.two + this.buddy.three) * 5, 15);
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from " + data.skills[this.weaponIndex].name + ". ";
				}
				if(this.hasExactly("Sword of Dusk") && this.combatStartHp / this.maxHp >= 0.25){
					var extraDmg = Math.floor(thisEffDef * 0.15);
					if(enemy.combatStartHp / enemy.maxHp >= 0.5){
						extraDmg = Math.floor(thisEffDef * 0.25);
					}
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from " + data.skills[this.weaponIndex].name + ". ";
				}
				if(this.hasExactly("Ancient Betrayal") && this.combatStartHp / this.maxHp >= 0.25){
					var extraDmg = this.toggle.weapon * 5 + 10;
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from " + data.skills[this.weaponIndex].name + ". ";
				}
				if(this.hasExactly("Jaws of Closure") && this.combatStartHp / this.maxHp >= 0.25){
					var extraDmg = (Math.min(enemy.buddy.adjacent + enemy.buddy.two + enemy.buddy.three, 3)) * 8 + 8;
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from " + data.skills[this.weaponIndex].name + ". ";
				}
				
				if(this.hasExactly("Godlike Reflexes") && thisEffSpd + this.getPhantom("Spd") >= enemyEffSpd + enemy.getPhantom("Spd") - 4 && (this.sTrigger == 1 || data.skills[this.specialIndex].charge <= this.charge)){
					var spdDmg = Math.floor(thisEffSpd * 0.15);
					flatBoost += spdDmg;
					damageText += this.name + " gains " + spdDmg + " damage from Godlike Reflexes. ";
				}
				
				if(this.hasExactly("Flashing Blade 4") && (thisEffSpd+this.getPhantom("Spd")) - (enemyEffSpd+enemy.getPhantom("Spd")) >= 1){
					flatBoost += 5;
					damageText += this.name + " gains 5 damage from Flashing Blade 4. ";
				}
				if(this.hasExactly("Heavy Blade 4") && thisEffAtk > enemyEffAtk){
					flatBoost += 5;
					damageText += this.name + " gains 5 damage from Heavy Blade 4. ";
				}
				if(this.hasExactly("Scendscale")){
					var scenDmg = Math.floor(thisEffAtk * 0.25);
					flatBoost += scenDmg;
					damageText += this.name + " gains " + scenDmg + " damage from Scendscale. ";
				}
				if(this.hasExactly("Verdict of Sacae") && this.toggle.a > 0 && (this.sTrigger == 1 || (this.specialIndex!=-1 && data.skills[this.specialIndex].charge <= this.charge))){
					flatBoost += 5;
					damageText += this.name + " gains 5 damage from Verdict of Sacae. ";
				}
				if((this.has("Atk Res Finish") || this.has("Atk Spd Finish") || this.has("Spd Res Finish") || this.has("Def Res Finish") || this.has("Atk Def Finish") || this.has("Spd Def Finish")) && this.buddy.adjacent + this.buddy.two + this.buddy.three > 0 && (this.sTrigger == 1 || (this.specialIndex != -1 && data.skills[this.specialIndex].charge <= this.charge))){
					var finishDmg = 0;
					var finishText = "";
					if(this.hasSlot("Atk Res Finish","a")){
						finishDmg = this.hasSlot("Atk Res Finish","a") * 2 - 1;
						if(this.hasExactly("Atk Res Finish 4")){
							finishDmg = 5;
						}
						finishText = data.skills[this.aIndex].name;
					}
					else if(this.hasSlot("Atk Spd Finish","a")){
						finishDmg = this.hasSlot("Atk Spd Finish","a") * 2 - 1;
						if(this.hasExactly("Atk Spd Finish 4")){
							finishDmg = 5;
						}
						finishText = data.skills[this.aIndex].name;
					}
					else if(this.has("Def Res Finish")){
						finishDmg = this.has("Def Res Finish") * 2 - 1;
						if(this.hasExactly("Def Res Finish 4")){
							finishDmg = 5;
						}
						finishText = data.skills[this.aIndex].name;
					}
					else if(this.hasSlot("Atk Def Finish","a")){
						finishDmg = this.hasSlot("Atk Def Finish","a") * 2 - 1;
						if(this.hasExactly("Atk Def Finish 4")){
							finishDmg = 5;
						}
						finishText = data.skills[this.aIndex].name;
					}
					else if(this.hasSlot("Spd Res Finish","a")){
						finishDmg = this.hasSlot("Spd Res Finish","a") * 2 - 1;
						if(this.hasExactly("Spd Res Finish 4")){
							finishDmg = 5;
						}
						finishText = data.skills[this.aIndex].name;
					}
					else if(this.hasSlot("Spd Def Finish","a")){
						finishDmg = this.hasSlot("Spd Def Finish","a") * 2 - 1;
						if(this.hasExactly("Spd Def Finish 4")){
							finishDmg = 5;
						}
						finishText = data.skills[this.aIndex].name;
					}
					if(this.hasSlot("Atk Def Finish","s")){
						finishDmg += this.hasSlot("Atk Def Finish","s") * 2 - 1;
						if(finishText != ""){
							finishText += " and ";
						}
						finishText += data.skills[this.sIndex].name;
					}
					else if(this.hasSlot("Spd Res Finish","s")){
						finishDmg += this.hasSlot("Spd Res Finish","s") * 2 - 1;
						if(finishText != ""){
							finishText += " and ";
						}
						finishText += data.skills[this.sIndex].name;
					}
					else if(this.hasSlot("Atk Res Finish","s")){
						finishDmg += this.hasSlot("Atk Res Finish","s") * 2 - 1;
						if(finishText != ""){
							finishText += " and ";
						}
						finishText += data.skills[this.sIndex].name;
					}
					else if(this.hasSlot("Atk Spd Finish","s")){
						finishDmg += this.hasSlot("Atk Spd Finish","s") * 2 - 1;
						if(finishText != ""){
							finishText += " and ";
						}
						finishText += data.skills[this.sIndex].name;
					}
					flatBoost += finishDmg;
					damageText += this.name + " gains " + finishDmg + " damage from " + finishText + ". ";
				}
				if(this.hasExactly("Ashera's Chosen+") && (this.toggle.a == 1 || enemy.combatStartHp / enemy.maxHp >= 0.75) && this.getPhantom("Res") + thisEffRes > enemy.getPhantom("Res") + enemyEffRes){
					var diffDmg = Math.floor((thisEffRes - enemyEffRes) * 0.7);
					diffDmg = Math.min(diffDmg, 7);
					flatBoost += diffDmg;
					damageText += this.name + " gains " + diffDmg + " damage from Ashera's Chosen+. ";
				}
				if(this.hasExactly("Mastermind") && (this.initiator || this.buddy.adjacent > 0 || this.buddy.two > 0)){
					var xVal = 0;
					if(!this.penalty.panic){
						xVal = Math.max(this.combatBuffs.atk,this.buffs.atk) + Math.max(this.combatBuffs.spd,this.buffs.spd) + Math.max(this.combatBuffs.def,this.buffs.def) + Math.max(this.combatBuffs.res,this.buffs.res);
					}
					xVal = Math.max(xVal,this.buddy.buffs.atk + this.buddy.buffs.spd + this.buddy.buffs.def + this.buddy.buffs.res);
					xVal = Math.floor(xVal * 0.8);
					var yVal = 0;
					var eNegate = this.checkNegate(enemy, turn);
					if(eNegate[0] == false){
						var aVal = Math.min(enemy.combatDebuffs.atk,enemy.debuffs.atk);
						if(enemy.penalty.panic){
							aVal -= Math.max(enemy.combatBuffs.atk,enemy.buffs.atk);
						}
						yVal += aVal;
					}
					if(eNegate[1] == false){
						var sVal = Math.min(enemy.combatDebuffs.spd,enemy.debuffs.spd);
						if(enemy.penalty.panic){
							sVal -= Math.max(enemy.combatBuffs.spd,enemy.buffs.spd);
						}
						yVal += sVal;
					}
					if(eNegate[2] == false){
						var dVal = Math.min(enemy.combatDebuffs.def,enemy.debuffs.def);
						if(enemy.penalty.panic){
							dVal -= Math.max(enemy.combatBuffs.def,enemy.buffs.def);
						}
						yVal += dVal;
					}
					if(eNegate[3] == false){
						var rVal = Math.min(enemy.combatDebuffs.res,enemy.debuffs.res);
						if(enemy.penalty.panic){
							rVal -= Math.max(enemy.combatBuffs.res,enemy.buffs.res);
						}
						yVal += rVal;
					}
					yVal = Math.min(yVal,enemy.buddy.debuffs.atk + enemy.buddy.debuffs.spd + enemy.buddy.debuffs.def + enemy.buddy.debuffs.res);
					yVal = Math.floor(yVal * -0.8);
					flatBoost = flatBoost + xVal + yVal;
					damageText += this.name + " gains " + xVal + "+" + yVal + " damage from Mastermind. ";
				}
				if((this.hasExactly("Thunder's Fist") || this.hasExactly("Fell Wyrmscale")) && this.combatStartHp / this.maxHp >= 0.25){
					var extraDmg = Math.floor(thisEffAtk * 0.15);
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from " + data.skills[this.aIndex].name + ". ";
				}
				if((this.hasExactly("Sly Swift Sparrow") || this.hasExactly("Sly Mirror") || this.hasExactly("Sly Sturdy Blow")) && this.initiator && ((Object.values(this.bonus).reduce((a, item) => a + (item === true ? 1 : 0), 0) + this.bonus.extra) > 1 || (Object.values(enemy.penalty).reduce((a, item) => a + (item === true ? 1 : 0), 0) + enemy.penalty.extra) > 1)){
					flatBoost += 5;
					damageText += this.name + " gains 5 damage from " + data.skills[this.aIndex].name + ". ";
				}
				if(this.has("Blue Skies") && (this.initiator || this.buddy.adjacent > 0 || this.buddy.two > 0)){
					var extraDmg = this.buddy.rorc * 2;
					if(this.has("Blue Skies") == 1){
						extraDmg = this.buddy.rorc;
					}
					else if(this.has("Blue Skies") == 4){
						extraDmg = this.buddy.rorc * 2 + 2;
					}
					extraDmg = Math.min(extraDmg, this.has("Blue Skies") * 2);
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from " + data.skills[this.aIndex].name + ". ";
				}
				if(this.hasExactly("Trample") && (this.initiator || enemy.combatStartHp / enemy.maxHp >= 0.75) && (this.toggle.a == 1 || enemy.moveType == "infantry" || enemy.moveType == "armored")){
					flatBoost += 5;
					damageText += this.name + " gains 5 damage from " + data.skills[this.aIndex].name + ". ";
				}
				if(this.hasExactly("New Opening") && (this.transform == true || enemy.combatStartHp / enemy.maxHp >= 0.75)){
					var extraDmg = Math.min(this.buddy.spaces * 4, 12);
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from " + data.skills[this.aIndex].name + ". ";
				}
				
				if((this.hasExactly("Atrocity") && enemy.combatStartHp / enemy.maxHp >= 0.5) || (this.hasExactly("Atrocity 2") && enemy.combatStartHp / enemy.maxHp >= 0.4) || (this.hasExactly("Pure Atrocity") && (this.initiator || this.buddy.adjacent > 0 || this.buddy.two > 0))){
					var atroDmg = Math.floor(thisEffAtk * 0.25);
					flatBoost += atroDmg;
					damageText += this.name + " gains " + atroDmg + " damage from " + data.skills[this.bIndex].name + ". ";
				}
				if(this.hasExactly("Bushido 2") || this.hasExactly("SR Far Trace 4") || this.hasExactly("AR Far Trace 4") || this.hasExactly("SD Near Trace 4") || this.hasExactly("SR Near Trace 4") || this.hasExactly("SD Far Trace 4") || this.hasExactly("AR Near Trace 4")){
					flatBoost += 7;
					damageText += this.name + " gains 7 damage from " + data.skills[this.bIndex].name + ". ";
				}
				if(((this.hasSlot("Dragon's Wrath","b") && !this.initiator) || this.hasExactly("Dragon's Wrath 4")) && firstHit && thisEffAtk > enemyEffRes+enemy.getPhantom("Res")){
					var fMulti = this.hasSlot("Dragon's Wrath","b") * 0.05 + 0.05;
					fMulti = Math.floor((thisEffAtk - enemyEffRes + enemy.getPhantom("Res")) * fMulti);
					flatBoost += fMulti;
					damageText += this.name + " gains " + fMulti + " damage from " + data.skills[this.bIndex].name + ". ";
				}
				if(this.hasExactly("Lunar Brace 2")){
					var extraDmg = Math.floor(enemyEffDef * 0.15);
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from Lunar Brace 2. ";
				}
				if((this.hasExactly("Flow Flight 3") || (this.hasExactly("Flow Flight 2") && this.combatStartHp / this.maxHp >= 0.5) || (this.hasExactly("Flow Flight 1") && this.combatStartHp / this.maxHp >= 1)) && this.initiator && this.getPhantom("Spd") + thisEffSpd >= enemy.getPhantom("Spd") + enemyEffSpd - 10){
					var dMod = (this.has("Flow Flight") * 2 + 1) * 0.1;
					dMod = Math.max(Math.floor((thisEffDef - enemyEffDef) * dMod),0);
					dMod = Math.min(dMod,this.has("Flow Flight") * 2 + 1);
					flatBoost += dMod;
					damageText += this.name + " gains " + dMod + " damage from " + data.skills[this.bIndex].name + ". ";
				}
				if((this.hasExactly("Flow Feather 3") || (this.hasExactly("Flow Feather 2") && this.combatStartHp / this.maxHp >= 0.5) || (this.hasExactly("Flow Feather 1") && this.combatStartHp / this.maxHp >= 1)) && this.initiator && this.getPhantom("Spd") + thisEffSpd >= enemy.getPhantom("Spd") + enemyEffSpd - 10){
					var dMod = (this.has("Flow Feather") * 2 + 1) * 0.1;
					dMod = Math.max(Math.floor((thisEffRes + this.getPhantom("Res") - enemyEffRes - enemy.getPhantom("Res")) * dMod),0);
					dMod = Math.min(dMod,this.has("Flow Feather") * 2 + 1);
					flatBoost += dMod;
					damageText += this.name + " gains " + dMod + " damage from " + data.skills[this.bIndex].name + ". ";
				}
				if(this.hasExactly("Hodr's Zeal")){
					var scenDmg = Math.floor(thisEffAtk * 0.2);
					flatBoost += scenDmg;
					damageText += this.name + " gains " + scenDmg + " damage from Hodr's Zeal. ";
				}
				if(this.hasExactly("Poetic Justice")){
					var extraDmg = Math.floor(enemyEffAtk * 0.15);
					if(enemy.has("Mystic Boost") || enemy.has("Splashy Bucket")){
						extraDmg = Math.floor(extraDmg * 0.5);
					}
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from Poetic Justice. ";
				}
				if(this.hasExactly("Gambit 4") && this.specialIndex != -1 && !this.hasExactly("Galeforce")){
					var extraDmg = (data.skills[this.specialIndex].charge - this.initSkillCharge() - 2) * 5;
					extraDmg = Math.min(extraDmg,15);
					extraDmg = Math.max(extraDmg,0);
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from Gambit 4. ";
				}
				if(this.hasExactly("Magic Gambit 4") && this.specialIndex != -1){
					var extraDmg = (data.skills[this.specialIndex].charge - this.initSkillCharge() - 2) * 4;
					extraDmg = Math.min(extraDmg,12);
					extraDmg = Math.max(extraDmg,0);
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from Magic Gambit 4. ";
				}
				if(this.hasExactly("Occultist's Strike") && this.initiator){
					var extraDmg = Math.floor(enemyEffRes * 0.2);
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from Occultist's Strike. ";
				}
				if(this.hasExactly("Assassin's Strike") && this.initiator){
					var extraDmg = Math.floor(enemyEffDef * 0.2);
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from Assassin's Strike. ";
				}
				if(this.hasExactly("Beast Agility 4") && this.getPhantom("Spd") + thisEffSpd > enemy.getPhantom("Spd") + enemyEffSpd){
					var extraDmg = Math.floor(thisEffSpd * 0.1);
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from Beast Agility 4. ";
				}
				if(this.hasExactly("Raging Tempest") && this.buddy.adjacent < 2){
					var extraDmg = Math.floor(thisEffAtk * 0.15);
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from Raging Tempest. ";
				}
				if(this.hasExactly("Barbarity") && enemy.combatStartHp / enemy.maxHp >= 0.25){
					var extraDmg = Math.floor(thisEffAtk * 0.25);
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from Barbarity. ";
				}
				if(this.hasExactly("Wyvern Rift") && thisEffSpd + thisEffDef >= enemyEffSpd + enemyEffDef - 10){
					var extraDmg = Math.min(allStats[18] - 35,7);
					extraDmg = Math.max(extraDmg,0);
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from " + data.skills[this.bIndex].name + ". ";
				}
				if(this.hasExactly("Pegasus Rift") && thisEffSpd + thisEffRes >= enemyEffSpd + enemyEffRes - 10){
					var extraDmg = Math.min(allStats[19] - 30,10);
					extraDmg = Math.max(extraDmg,0);
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from " + data.skills[this.bIndex].name + ". ";
				}
				if((this.hasExactly("Sun-Twin Wing+") || this.hasExactly("Under the Sun") || this.hasExactly("Dark Perfume") || this.hasExactly("Tut-Tut")) && this.combatStartHp / this.maxHp >= 0.25){
					var extraDmg = Math.floor(thisEffSpd * 0.2);
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from " + data.skills[this.bIndex].name + ". ";
				}
				if(this.hasExactly("Atk Spd Link 4") && this.toggle.b > 1){
					var xVal = 0;
					if(!this.penalty.panic){
						xVal = Math.max(this.combatBuffs.atk,this.buffs.atk) + Math.max(this.combatBuffs.spd,this.buffs.spd);
					}
					xVal = Math.max(xVal,this.buddy.buffs.atk + this.buddy.buffs.spd);
					flatBoost += xVal;
					damageText += this.name + " gains " + xVal + " damage from Atk Spd Link 4. ";
				}
				if(this.hasExactly("Spd Def Link 4") && this.toggle.b > 1){
					var xVal = 0;
					if(!this.penalty.panic){
						xVal = Math.max(this.combatBuffs.def,this.buffs.def) + Math.max(this.combatBuffs.spd,this.buffs.spd);
					}
					xVal = Math.max(xVal,this.buddy.buffs.def + this.buddy.buffs.spd);
					flatBoost += xVal;
					damageText += this.name + " gains " + xVal + " damage from Spd Def Link 4. ";
				}
				if((this.hasExactly("Ice Prince's Seal") && this.combatStartHp / this.maxHp >= 0.25) || (this.hasExactly("Pure Storm") && (this.initiator || this.buddy.adjacent < 2))){
					var extraDmg = Math.floor(thisEffDef * 0.2);
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from " + data.skills[this.bIndex].name + ". ";
				}
				if(this.hasExactly("Resonance 1") || this.hasExactly("Resonance 2") || this.hasExactly("Resonance 3") || this.hasExactly("Resonance 4") || this.hasExactly("AR Far Resound")){
					var extraDmg = (this.combatStartHp - this.hp) * 2;
					extraDmg = Math.min(extraDmg, 12);
					extraDmg = Math.max(extraDmg, 6);
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from " + data.skills[this.bIndex].name + ". ";
				}
				if(this.hasExactly("Moon-Twin Wing+") && this.combatStartHp / this.maxHp >= 0.25){
					var extraDmg = Math.floor(thisEffAtk * 0.1);
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from Moon-Twin Wing+. ";
				}
				if(this.hasExactly("Moonlit Bangle Q")){
					var extraDmg = Math.floor(enemyEffDef * 0.25);
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from Moonlit Bangle Q. ";
				}
				if(this.hasExactly("Fallen Star 2") && (this.initiator || this.bonus.dStar)){
					var extraDmg = Math.min((Object.values(this.bonus).reduce((a, item) => a + (item === true ? 1 : 0), 0) + this.bonus.extra + Object.values(enemy.penalty).reduce((a, item) => a + (item === true ? 1 : 0), 0) + enemy.penalty.extra) * 5, 25);
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from Fallen Star 2. ";
				}
				if(this.hasExactly("According to Plan") && this.combatStartHp / this.maxHp >= 0.25){
					var extraDmg = Math.min((Object.values(this.bonus).reduce((a, item) => a + (item === true ? 1 : 0), 0) + this.bonus.extra + Object.values(enemy.penalty).reduce((a, item) => a + (item === true ? 1 : 0), 0) + enemy.penalty.extra) * 5, 25);
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from According to Plan. ";
				}
				if((this.hasExactly("Lone Wolf") && (this.combatStartHp / this.maxHp >= 0.25 || this.buddy.adjacent < 2)) || (this.hasExactly("Pure Starfall") && (this.initiator || this.bonus.dStar == true))){
					var extraDmg = Math.floor(thisEffSpd * 0.2);
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from " + data.skills[this.bIndex].name + ". ";
				}
				if(this.hasExactly("Reopening") && this.combatStartHp / this.maxHp >= 0.25){
					var extraDmg = Math.floor(thisEffDef * 0.2);
					if(thisFollowUp || brave == 1 || brave == 2){
						extraDmg = Math.floor(thisEffDef * 0.1);
					}
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from Reopening. ";
				}
				if(this.hasExactly("Shadow Slide") && this.buddy.adjacent + this.buddy.two + this.buddy.three > 0){
					var extraDmg = Math.floor(thisEffSpd * 0.2);
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from Shadow Slide. ";
				}
				if(this.hasSlot("Momentum","b") && this.buddy.spaces > 0){
					var extraDmg = this.buddy.spaces * this.hasSlot("Momentum","b");
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from " + data.skills[this.bIndex].name + ". ";
				}
				if(this.hasExactly("Spd Res Discord") || this.hasExactly("Atk Res Discord") || this.hasExactly("Def Res Discord")){
					var extraDmg = Math.floor(thisEffRes * 0.15);
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from " + data.skills[this.bIndex].name + ". ";
				}
				if(this.hasExactly("AD Spiked Wall")){
					var extraDmg = Math.max(thisEffDef, thisEffRes) * 0.15;
					extraDmg = Math.floor(extraDmg);
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from " + data.skills[this.bIndex].name + ". ";
				}
				if(this.hasExactly("SR Spiked Wall")){
					var extraDmg = Math.max(thisEffSpd, thisEffRes) * 0.15;
					extraDmg = Math.floor(extraDmg);
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from " + data.skills[this.bIndex].name + ". ";
				}
				if(this.hasExactly("AS Spiked Wall")){
					var extraDmg = Math.floor(thisEffSpd * 0.15);
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from " + data.skills[this.bIndex].name + ". ";
				}
				if((this.hasExactly("Slick Fighter 4") || this.hasExactly("Wily Fighter 4")) && (!this.initiator || this.combatStartHp / this.maxHp >= 0.25)){
					var extraDmg = Math.floor(thisEffDef * 0.2);
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from " + data.skills[this.bIndex].name + ". ";
				}
				if(this.hasExactly("Yggdrasill's Alter") || this.hasExactly("Font of Wisdom") || this.hasExactly("Mounting Fear") || this.hasExactly("Atk Res Havoc")){
					var extraDmg = Math.floor(thisEffRes * 0.2);
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from " + data.skills[this.bIndex].name + ". ";
				}
				if(this.has("Speedtaker")){
					var extraDmg = Math.floor(thisEffSpd * (this.has("Speedtaker") * 0.05));
					extraDmg = Math.floor(extraDmg);
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from " + data.skills[this.bIndex].name + ". ";
				}
				if(((this.hasExactly("Bestial Assault") || this.hasExactly("Bestial Agility")) && (this.transform == true || this.combatStartHp / this.maxHp >= 0.25)) || (this.hasExactly("Assault Force") && (this.initiator || this.buddy.adjacent > 0 || this.buddy.two > 0))){
					var extraDmg = Math.max(thisEffSpd, thisEffDef) * 0.2;
					extraDmg = Math.floor(extraDmg);
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from " + data.skills[this.bIndex].name + ". ";
				}
				if(this.hasExactly("I Remember...") && (this.initiator || this.buddy.adjacent > 0 || this.buddy.two > 0)){
					var extraDmg = Math.floor(thisEffSpd * 0.2);
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from I Remember.... ";
				}
				if(this.hasExactly("Laguz Loyalty") && this.specialIndex != -1 && (data.skills[this.specialIndex].charge - this.initSkillCharge() >= 3 || data.defensiveSpecials.indexOf(data.skills[this.specialIndex].name) != -1) && !this.initiator){
					flatBoost += 7;
					damageText += this.name + " gains 7 damage from " + data.skills[this.bIndex].name + ". ";
				}
				if(this.hasExactly("Chivalry 2")){
					var chVar = 0.15;
					if(enemy.combatStartHp / enemy.maxHp >= 0.5){
						chVar = 0.25;
					}
					var extraDmg = Math.floor(thisEffAtk * chVar);
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from " + data.skills[this.bIndex].name + ". ";
				}
				if(this.hasExactly("Pure Dragon Wall")){
					var extraDmg = 0.2;
					if(this.toggle.b == 1 || this.toggle.b == 3){
						extraDmg = 0.3;
					}
					extraDmg = Math.floor(thisEffRes * extraDmg);
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from Pure Dragon Wall. ";
				}
				if(this.hasExactly("Edged Scales") && (!this.initiator || this.combatStartHp / this.maxHp >= 0.25)){
					var extraDmg = Math.floor(enemyEffAtk * 0.15);
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from Edged Scales. ";
				}
				if(this.hasExactly("Called to Serve") && this.toggle.b > 0){
					var extraDmg = this.toggle.b * 5;
					flatBoost += extraDmg;
					damageText += this.name + " gains " + extraDmg + " damage from Called to Serve. ";
				}
				
				if(this.hasExactly("Domain of Flame") && this.toggle.c == 1 && firstHit && thisEffAtk > enemyEffRes+enemy.getPhantom("Res")){
					var abDmg = Math.floor((thisEffAtk - enemyEffRes + enemy.getPhantom("Res")) * 0.3);
					flatBoost += abDmg;
					damageText += this.name + " gains " + abDmg + " damage from Domain of Flame. ";
				}
				if(this.hasExactly("Even Atk Wave N") && thisEffAtk >= enemyEffAtk - 5){
					flatBoost += 5;
					damageText += this.name + " gains 5 damage from Even Atk Wave N. ";
				}
				if((this.hasExactly("Quiet Strength") && (this.initiator || this.buddy.adjacent > 0 || this.buddy.two > 0)) || (this.hasExactly("Divine God Fang") && this.buddy.adjacent + this.buddy.two + this.buddy.three > 0)){
					flatBoost += 7;
					damageText += this.name + " gains 7 damage from " + data.skills[this.cIndex].name + ". ";
				}
				
				if(this.hasSlot("Dragon's Wrath","s") && !this.initiator && firstHit && thisEffAtk > enemyEffRes+enemy.getPhantom("Res")){
					var fMulti = this.hasSlot("Dragon's Wrath","s") * 0.05 + 0.05;
					fMulti = Math.floor((thisEffAtk - enemyEffRes + enemy.getPhantom("Res")) * fMulti);
					flatBoost += fMulti;
					damageText += this.name + " gains " + fMulti + " damage from " + data.skills[this.sIndex].name + ". ";
				}
				
				if(this.hasExactly("Far Trace Echo")){
					flatBoost += 3;
					damageText += this.name + " gains 3 damage from Far Trace Echo. ";
				}
				
				if(this.support.dof > 0 && firstHit && thisEffAtk > enemyEffRes){
					var abDmg = Math.floor((thisEffAtk - enemyEffRes) * 0.3) * this.support.dof;
					flatBoost += abDmg;
					damageText += this.name + " gains " + abDmg + " damage from ally Muspell(s). ";
				}
				if(this.support.trueDmg > 0){
					flatBoost += this.support.trueDmg;
					damageText += this.name + " gains " + this.support.trueDmg + " damage from ally Seteth(s). ";
				}
				if(this.bonus.dominance){
					flatBoost += domiDmg;
					damageText += this.name + " gains " + domiDmg + " damage from Dominance status. ";
				}
				if(this.bonus.treachery && !this.penalty.ploy){
					flatBoost += treachDmg;
					damageText += this.name + " gains " + treachDmg + " damage from Treachery status. ";
				}
				if(enemy.penalty.exposure == true){
					flatBoost += 10;
					damageText += this.name + " gains 10 damage from " + enemy.name + " being affected by Exposure. ";
				}
				if(this.prfVal > 0 && this.hasExactly("Chaos Manifest") && this.rValue == 5 && (this.initiator || this.toggle.weapon > 1)){
					flatBoost += this.prfVal;
					damageText += this.name + " gains " + this.prfVal + " true damage. ";
				}
				if(this.hasCaptain("Fault")){
					var fVal = 0;
					var eNegate = this.checkNegate(enemy, turn);
					if(eNegate[0] == false){
						var aVal = Math.min(enemy.combatDebuffs.atk,enemy.debuffs.atk);
						if(enemy.penalty.panic){
							aVal -= Math.max(enemy.combatBuffs.atk,enemy.buffs.atk);
						}
						fVal += aVal;
					}
					if(eNegate[1] == false){
						var sVal = Math.min(enemy.combatDebuffs.spd,enemy.debuffs.spd);
						if(enemy.penalty.panic){
							sVal -= Math.max(enemy.combatBuffs.spd,enemy.buffs.spd);
						}
						fVal += sVal;
					}
					if(eNegate[2] == false){
						var dVal = Math.min(enemy.combatDebuffs.def,enemy.debuffs.def);
						if(enemy.penalty.panic){
							dVal -= Math.max(enemy.combatBuffs.def,enemy.buffs.def);
						}
						fVal += dVal;
					}
					if(eNegate[3] == false){
						var rVal = Math.min(enemy.combatDebuffs.res,enemy.debuffs.res);
						if(enemy.penalty.panic){
							rVal -= Math.max(enemy.combatBuffs.res,enemy.buffs.res);
						}
						fVal += rVal;
					}
					fVal = -Math.min(fVal,enemy.buddy.debuffs.atk + enemy.buddy.debuffs.spd + enemy.buddy.debuffs.def + enemy.buddy.debuffs.res);
					if(this.toggle.sd == 1){
						fVal = Math.floor(fVal * 0.5);
					}
					flatBoost += fVal;
					damageText += this.name + " gains " + fVal + " damage from Fault. ";
				}
			}
			
			//Damage calculation from http://feheroes.wiki/Damage_Calculation
			//use bitwise or to truncate properly
			//Doing calculation in steps to see the formula more clearly
			
			var icedmg = 0;
			var thisicedmg = 0;
			var enemyicedmg = 0;
			//drTrigger for combined total damage reduced
			var drTrigger = false;
			//add damage text if Ice Mirror/Negating Fang/Ginnungagap has a value stored, then reset it
			if(this.ice > 0){
				var chVal = false;
				damageText += this.name + " adds " + this.ice + " dmg to attack from";
				if(this.hasExactly("Ginnungagap") || this.hasExactly("Aurgelmir") || this.hasExactly("Western Axe") || this.hasExactly("Brightwind Fans") || this.hasExactly("Vouge") || this.hasExactly("Rinkah's Club") || this.hasExactly("Lightburst Tome") || this.hasExactly("Flame Lance") || this.hasExactly("Caladbolg") || this.hasExactly("Double Bow") || this.hasExactly("Tiger-Eye Axe") || this.hasExactly("Sentinel Bow") || this.hasExactly("War-God Mjolnir") || this.hasExactly("Swirling Scimitar") || this.has("Jehanna Dagger") || this.has("Jehanna Lance")){
					damageText += " " + data.skills[this.weaponIndex].name;
					chVal = true;
				}
				if(this.has("Divine Recreation") || this.hasExactly("Fruit of Life") || this.hasExactly("Brash Assault 4") || this.hasExactly("Spurn 4") || this.has("Counter Roar") || this.has("Laguz Friend") || this.hasExactly("Under the Sun")){
					if(chVal == true){
						damageText += ",";
					}
					damageText += " " + data.skills[this.bIndex].name;
					chVal = true;
				}
				if(this.has("Briar F Save")){
					if(chVal == true){
						damageText += ",";
					}
					damageText += " " + data.skills[this.cIndex].name;
					chVal = true;
				}
				if(this.hasExactly("Negating Fang") || this.hasExactly("Negating Fang 2") || this.hasExactly("Ice Mirror") || this.hasExactly("Ice Mirror 2") || this.hasExactly("Divine Pulse") || this.hasExactly("Frostbite Mirror") || this.hasExactly("Dual Ice Mirrors") || this.hasExactly("Life Unending 2")){
					if(chVal == true){
						damageText += ",";
					}
					damageText += " " + data.skills[this.specialIndex].name;
				}
				damageText += ". ";
				icedmg = this.ice;
				this.ice = 0;
				if(this.hasExactly("Divine Pulse")){
					this.ice = -1;
				}
			}
			//remove def tile value if parity
			if(parity){
				relevantTileDef = 0;
			}
			var rawDmg = (thisEffAtk*effectiveBonus | 0) + ((thisEffAtk*effectiveBonus | 0)*weaponAdvantageBonus | 0) + (dmgBoost | 0);
			if((this.hasExactly("Sandstorm") || (this.hasExactly("Ancient Voice") && this.buddy.adjacent + this.buddy.two + this.buddy.three > 0)) && offensiveSpecialActivated){
				rawDmg = (Math.floor(thisEffDef*1.5)*effectiveBonus | 0) + ((Math.floor(thisEffDef*1.5)*effectiveBonus | 0)*weaponAdvantageBonus | 0) + (dmgBoost | 0);
			}
			else if(this.hasExactly("Indignant Bow") && this.rValue > 0 && (!this.initiator || enemy.combatStartHp / enemy.maxHp >= 0.75) && offensiveSpecialActivated){
				rawDmg = (Math.floor(thisEffRes*1.5)*effectiveBonus | 0) + ((Math.floor(thisEffRes*1.5)*effectiveBonus | 0)*weaponAdvantageBonus | 0) + (dmgBoost | 0);
			}
			var reduceDmg = relevantDef + (relevantDef*enemyDefModifier | 0) + relevantTileDef;
			var dmg = (rawDmg - reduceDmg)*weaponModifier | 0;
			dmg = (dmg*dmgMultiplier | 0);
			//set damage to 0 if it's negative value
			dmg = Math.max(dmg, 0);
			dmg += flatBoost + icedmg;
			//variable used to check dmg < ice mirror boost
			var normaldmg = dmg;
			//Defensive multipliers.  Special,Skill,Seal all stack.
			var defmod = 1 - (dmgReduction) * (1-dmgCut) * (1-deflectCut) * (1-aCut) * (1-bCut) * (1-cCut) * (1-xCut) * (1-dCut) * (1-pCut) * (1-hhCut) * (1-niCut) * diCut * oCut * fpCut;
			//Tally Ice Mirror reduction values
			if(((enemy.hasExactly("Ice Mirror") || enemy.hasExactly("Frostbite Mirror") || enemy.hasExactly("Dual Ice Mirrors")) && defensiveSpecialActivated == true) || (enemy.hasExactly("Ginnungagap") && enemy.combatStartHp / enemy.maxHp >= 0.25 && (!this.initiator || (this.initiator && (this.weaponType.indexOf("tome") != -1 || this.weaponType == "staff")))) || (enemy.hasExactly("Divine Recreation") && this.combatStartHp / this.maxHp >= 0.5) || (enemy.hasExactly("Aurgelmir") && (!this.initiator || enemy.toggle.weapon == 1)) || ((enemy.hasExactly("Fruit of Life") || enemy.hasExactly("Under the Sun")) && enemy.combatStartHp / enemy.maxHp >= 0.25) || (enemy.hasExactly("Western Axe") && enemy.toggle.weapon == 1) || (enemy.hasExactly("Brightwind Fans") && enemy.combatStartHp / enemy.maxHp >= 0.25 && !this.initiator) || (enemy.hasExactly("Vouge") && enemy.rValue == 5 && (this.initiator || this.combatStartHp / this.maxHp >= 0.75)) || (((enemy.hasExactly("Rinkah's Club") && enemy.rValue == 5 && firstHit) || enemy.hasExactly("Swirling Scimitar") || enemy.has("Jehanna Dagger") || enemy.has("Jehanna Lance")) && (enemy.buddy.adjacent > 0 || enemy.buddy.two > 0 || enemy.buddy.three > 0) && firstHit) || ((enemy.hasExactly("Lightburst Tome") || (enemy.hasExactly("Caladbolg") && firstHit) || ((enemy.hasExactly("Double Bow") || enemy.hasExactly("War-God Mjolnir")) && enemy.rValue == 5 && firstHit)) && enemy.combatStartHp / enemy.maxHp >= 0.25) || (enemy.hasExactly("Divine Recreation 2") && (!this.initiator || this.combatStartHp / this.maxHp >= 0.5) && firstHit) || (enemy.hasExactly("Sentinel Bow") && (!this.initiator || this.range == "ranged") && firstHit) || (enemy.hasExactly("Life Unending 2") && firstHit)){
				if(enemy.hasExactly("Dual Ice Mirrors") && defensiveSpecialActivated == true){
					var diDmg = Math.max((dmg*(defmod) | 0) + (flatReduction | 0), Math.floor(enemyEffRes * 0.4));
					enemyicedmg += diDmg;
				}
				else{
					enemyicedmg += (dmg*(defmod) | 0) + (flatReduction | 0);
				}
				drTrigger = true;
			}
			else if((enemy.hasExactly("Flame Lance") && enemy.rValue == 5 && (!this.initiator || enemy.buddy.adjacent < 2)) || (enemy.hasExactly("Tiger-Eye Axe") && enemy.combatStartHp / enemy.maxHp >= 0.25)){
				enemyicedmg += (normaldmg * 0.3 | 0);
			}
			else if(enemy.hasExactly("Negating Fang") && defensiveSpecialActivated == true){
				enemyicedmg += (enemyEffAtk * 0.3 | 0);
			}
			else if(enemy.hasExactly("Negating Fang 2") && defensiveSpecialActivated == true){
				enemyicedmg += (enemyEffAtk * 0.4 | 0);
			}
			else if(enemy.hasExactly("Ice Mirror 2") && defensiveSpecialActivated == true){
				enemyicedmg += (enemyEffRes * 0.4 | 0);
			}
			else if(enemy.hasExactly("Spurn 4") && defensiveSpecialActivated == true){
				enemyicedmg += 5;
			}
			if(enemy.hasExactly("Brash Assault 4") && !this.initiator && (enemy.combatStartHp / enemy.maxHp < 1 || this.combatStartHp / this.maxHp >= 1)){
				enemyicedmg += (normaldmg * 0.3 | 0);
			}
			if(enemy.has("Counter Roar")){
				var crDmg = enemy.has("Counter Roar") * 0.1;
				crDmg = Math.min(crDmg, 0.3);
				enemyicedmg += (normaldmg * crDmg | 0);
			}
			if(enemy.has("Laguz Friend") && enemy.specialIndex != -1 && data.defensiveSpecials.indexOf(data.skills[enemy.specialIndex].name) != -1 && defensiveSpecialActivated){
				var lfDmg = Math.max(enemyEffDef, enemyEffRes) * (enemy.has("Laguz Friend") * 0.05);
				enemyicedmg += Math.floor(lfDmg);
			}
			if(enemy.has("Briar F Save") && this.range == "ranged"){
				enemyicedmg += (normaldmg * 0.4 | 0);
			}
			//this side reduction storage
			if(this.hasExactly("Divine Pulse") && offensiveSpecialActivated == true){
				thisicedmg += (thisEffSpd * 0.2 | 0);
			}
			else if(this.hasExactly("Child's Compass") && offensiveSpecialActivated == true){
				thisicedmg += 1;
			}
			//Bane-style skills check
			if(((this.hasExactly("Bane") && offensiveSpecialActivated == true) || (this.hasExactly("Mounting Fear") && firstHit)) && dmg < enemy.hp - 1){
				dmg = enemy.hp - 1;
			}
			dmg = dmg - (dmg*(defmod) | 0);
			//Flat reduction
			dmg = dmg - (flatReduction | 0);
			//toggle potent value to 1 for calculations
			if(potent == 0){
				potent = 1;
			}
			dmg = Math.floor(potent*dmg);
			dmg = Math.max(dmg,0);
			if(enemy.has("Embla's Ward")){
				dmg = 0;
			}
			//Check for Dire Thunder, if dmg is less than total reduction, floor value to dmg
			if(enemyicedmg > 0){
				if(enemyicedmg > normaldmg && (enemy.hasExactly("Ice Mirror") || enemy.hasExactly("Ginnungagap") || enemy.hasExactly("Aurgelmir") || enemy.has("Divine Recreation") || enemy.hasExactly("Fruit of Life") || enemy.hasExactly("Frostbite Mirror") || enemy.hasExactly("Western Axe") || enemy.hasExactly("Brightwind Fans") || enemy.hasExactly("Vouge") || enemy.hasExactly("Rinkah's Club") || enemy.hasExactly("Lightburst Tome") || enemy.hasExactly("Caladbolg") || enemy.hasExactly("Under the Sun") || enemy.hasExactly("Double Bow") || enemy.hasExactly("Sentinel Bow") || enemy.hasExactly("War-God Mjolnir") || enemy.hasExactly("Life Unending 2") || enemy.hasExactly("Swirling Scimitar") || enemy.has("Jehanna Dagger") || enemy.has("Jehanna Lance"))){
					enemy.ice = normaldmg;
				}
				else{
					if(enemy.has("Counter Roar") && enemyicedmg > 0){
						enemy.ice = Math.max(enemyicedmg,enemy.ice);
					}
					else if(enemy.hasExactly("Negating Fang 2") && enemyicedmg > 0){
						enemy.ice += enemyicedmg;
					}
					else{
						enemy.ice = enemyicedmg;
					}
				}
			}
			if(thisicedmg > 0){
				if(this.hasExactly("Child's Compass")){
					thisicedmg = -1;
				}
				this.ice = thisicedmg;
			}
			if((enemy.has("Shield Pulse") > 1 || enemy.has("Hardy Fighter") > 1) && miracle && dmg-5 >= enemy.hp){
				dmg = Math.max(dmg-5,0);
				damageText += enemy.name + " reduces 5 damage from " + data.skills[this.bIndex].name + ". ";
			}
			else if(enemy.hasExactly("Shield Fighter") && miracle && dmg-7 >= enemy.hp){
				dmg = Math.max(dmg-7,0);
				damageText += enemy.name + " reduces 7 damage from " + data.skills[this.bIndex].name + ". ";
			}
			
			damageText += this.name + " attacks " + enemy.name + " for <span class=\"bold\">" + dmg + "</span> damage.<br>";
			if(dmg >= enemy.hp){
				if(!enemy.penalty.nullArise || miracle){
					if(enemy.hasExactly("Tyrfing") && enemy.rValue > 0 && enemy.combatStartHp/enemy.maxHp >= 0.5 && enemy.arise == false){
						dmg = enemy.hp - 1;
						enemy.arise = true;
						damageText += enemy.name + " survives with 1HP with Tyrfing.<br>";
					}
					else if(enemy.hasExactly("Hel's Reaper") && enemy.hp > 1 && enemy.arise == false && (data.magicalWeapons.indexOf(this.weaponType) == -1 || this.weaponType == "dragon")){
						dmg = enemy.hp - 1;
						enemy.arise = true;
						damageText += enemy.name + " survives with 1HP with Hel's Reaper.<br>";
					}
					else if(enemy.hasExactly("Bow of Twelve") && (enemy.initiator || (enemy.combatStartHp / enemy.maxHp >= 0.75 && this.range == "ranged" && this.attackType == "magical")) && enemy.hp > 1 && enemy.arise == false){
						dmg = enemy.hp - 1;
						enemy.arise = true;
						damageText += enemy.name + " survives with 1HP with Bow of Twelve.<br>";
					}
					else if(enemy.hasExactly("Mila's Testament") && (!this.initiator || enemy.toggle.weapon == 1) && enemy.hp/enemy.maxHp >= 0.25 && enemy.arise == false){
						dmg = enemy.hp - 1;
						enemy.arise = true;
						damageText += enemy.name + " survives with 1HP with Mila's Testament.<br>";
					}
					else if(((enemy.hasExactly("Everliving Domain") && enemy.toggle.c == 1) || enemy.support.everliving == true) && enemy.hp/enemy.maxHp >= 0.75 && enemy.arise == false){
						if(drTrigger == true){
							enemy.ice += dmg - enemy.hp + 1;
						}
						dmg = enemy.hp - 1;
						enemy.arise = true;
						damageText += enemy.name + " survives with 1HP with Everliving Domain.<br>";
					}
					else if(enemy.hasExactly("Holytide Tyrfing") && enemy.buddy.spaces > 0 && enemy.combatStartHp/enemy.maxHp >= 0.25 && enemy.hp > 1 && enemy.arise == false){
						dmg = enemy.hp - 1;
						enemy.arise = true;
						damageText += enemy.name + " survives with 1HP with Holytide Tyrfing.<br>";
					}
					else if(enemy.hasExactly("Everliving Ymir") && (!this.initiator || this.range == "ranged") && enemy.hp/enemy.maxHp >= 0.25 && enemy.hp > 1 && enemy.arise == false){
						dmg = enemy.hp - 1;
						enemy.arise = true;
						damageText += enemy.name + " survives with 1HP with Everliving Ymir.<br>";
					}
					else if(enemy.hasExactly("Circlet of Balance") && ((data.skills[enemy.specialIndex].charge <= enemy.charge || (this.specialIndex!=-1 && data.skills[this.specialIndex].charge <= this.charge)) || (enemy.sTrigger == 1 || (this.sTrigger == 1 && !AOE) || offensiveSpecialActivated)) && (!this.initiator || this.range == "ranged") && enemy.hp > 1 && enemy.arise == false){
						dmg = enemy.hp - 1;
						enemy.arise = true;
						damageText += enemy.name + " survives with 1HP with Circlet of Balance.<br>";
					}
					else if(enemy.hasExactly("Virtuous Tyrfing") && enemy.rValue == 5 && this.initiator && enemy.toggle.weapon == 1 && enemy.hp/enemy.maxHp >= 0.5 && enemy.arise == false){
						dmg = enemy.hp - 1;
						enemy.arise = true;
						damageText += enemy.name + " survives with 1HP with Virtuous Tyrfing.<br>";
					}
					else if(enemy.hasExactly("Emblems' Miracle") && enemy.buddy.adjacent + enemy.buddy.two + enemy.buddy.three > 2 && this.initiator && enemy.hp > 1 && enemy.arise == false){
						dmg = enemy.hp - 1;
						enemy.arise = true;
						damageText += enemy.name + " survives with 1HP with Emblems' Miracle.<br>";
					}
					else if((enemy.hasExactly("Praise-Piner Axe") || enemy.hasExactly("Devoted Breath")) && (this.initiator || this.combatStartHp / this.maxHp >= 0.75) && enemy.hp > 1 && enemy.arise == false){
						dmg = enemy.hp - 1;
						enemy.arise = true;
						damageText += enemy.name + " survives with 1HP with " + data.skills[enemy.weaponIndex].name + ".<br>";
					}
					else if(enemy.hasExactly("Light of Etruria") && this.initiator && enemy.hp > 1 && enemy.arise == false){
						dmg = enemy.hp - 1;
						enemy.arise = true;
						damageText += enemy.name + " survives with 1HP with Light of Etruria.<br>";
					}
					else if(enemy.hasExactly("I Remember...") && (!this.initiator || enemy.buddy.adjacent > 0 || enemy.buddy.two > 0) && enemy.hp > 1 && enemy.arise == false){
						dmg = enemy.hp - 1;
						enemy.arise = true;
						damageText += enemy.name + " survives with 1HP with I Remember....<br>";
					}
					else if(enemy.support.revive == true && enemy.hp > 1 && enemy.arise == false){
						if(drTrigger == true){
							enemy.ice += dmg - enemy.hp + 1;
						}
						dmg = enemy.hp - 1;
						enemy.arise = true;
						damageText += enemy.name + " survives with 1HP with Sacrifice Staff support.<br>";
					}
					else if(enemy.support.devotion == true && this.initiator && enemy.hp > 1 && enemy.arise == false){
						dmg = enemy.hp - 1;
						enemy.arise = true;
						damageText += enemy.name + " survives with 1HP with Devoted Breath support.<br>";
					}
					else if(miracle){
						if(drTrigger == true){
							enemy.ice += dmg - enemy.hp + 1;
						}
						dmg = enemy.hp - 1;
						defensiveSpecialActivated = true;
						enemy.resetCharge();
						damageText += enemy.name + " survives with 1 HP with " + data.skills[enemy.specialIndex].name + ".<br>";
						if(enemy.has("Laguz Friend")){
							var lfDmg = Math.max(enemyEffDef, enemyEffRes) * (enemy.has("Laguz Friend") * 0.05);
							enemy.ice += Math.floor(lfDmg);
						}
					}
					else{
						enemy.overkill = dmg - enemy.hp;
						dmg = Math.min(dmg,enemy.hp);
					}
				}
				else{
					enemy.overkill = dmg - enemy.hp;
					dmg = Math.min(dmg,enemy.hp);
				}
			}
			enemy.hp -= dmg;

			//add absorbed hp
			var absorbHp = dmg*absorbPct | 0;
			if(this.hasExactly("Sol Lance")){
				var slVal = 10;
				if(this.rValue > 0){
					slVal = 14;
				}
				absorbHp += slVal;
			}
			else if(this.has("Tannenbit") || this.has("Bellringer") || this.has("Minty Cane")){
				absorbHp += 5;
			}
			else if(this.hasExactly("Runeaxe")){
				absorbHp += 7;
			}
			else if(this.hasExactly("Beloved Zofia") && this.rValue == 5 && (enemy.combatStartHp / enemy.maxHp < 1 || this.combatStartHp / this.maxHp < 1)){
				absorbHp += 7;
			}
			else if(this.hasExactly("Wind Parthia") && (this.initiator || this.toggle.weapon == 1 || this.toggle.weapon == 3) && offensiveSpecialActivated){
				absorbHp += (this.maxHp/2 | 0);
			}
			else if(this.hasExactly("Moonless Breath") && (this.buddy.adjacent + this.buddy.two > 0 || (this.rValue > 0 && this.buddy.adjacent + this.buddy.two + this.buddy.three > 0)) && offensiveSpecialActivated){
				if(this.rValue > 0){
					absorbHp += (this.maxHp * 0.5 | 0);
				}
				else{
					absorbHp += (this.maxHp * 0.3 | 0);
				}
			}
			else if((this.hasExactly("Garm") || this.hasExactly("Wolf Queen Fang") || this.hasExactly("Spear of Shadow") || this.hasExactly("Blade of Shadow")) && this.rValue == 5 && this.combatStartHp / this.maxHp >= 0.25){
				absorbHp += 7;
			}
			else if(this.hasExactly("Spy-Song Bow") && this.rValue == 5 && this.toggle.weapon == 1){
				absorbHp += 5;
			}
			else if((this.has("Unity Blooms") || this.has("Amity Blooms") || this.has("Pact Blooms")) && this.toggle.weapon == 1){
				absorbHp += 4;
			}
			else if(this.hasExactly("Icy Fimbulvetr") && this.combatStartHp / this.maxHp >= 0.25 && this.toggle.weapon == 1){
				absorbHp += 5;
			}
			else if(this.hasExactly("Berserk Armads") && this.rValue == 5 && (!this.initiator || enemy.combatStartHp / enemy.maxHp >= 1) && offensiveSpecialActivated){
				absorbHp += (this.maxHp * 0.3 | 0);
			}
			else if(this.hasExactly("Blade of Renais") && (this.initiator || this.toggle.weapon > 1) && (this.toggle.weapon % 2 == 1 || checkAllBuffs(this, enemy, turn))){
				absorbHp += Math.floor(enemyEffDef * 0.2);
			}
			else if(this.hasExactly("Gradivus") && this.rValue == 5 && (!this.initiator || enemy.combatStartHp / enemy.maxHp >= 1)){
				absorbHp += 7;
			}
			else if(this.hasExactly("Genesis Falchion") && (this.initiator || this.buddy.adjacent > 0 || this.buddy.two > 0) && this.toggle.weapon > 1){
				absorbHp += 5;
				if(this.rValue > 0){
					absorbHp += 2;
				}
			}
			else if(this.hasExactly("Moonstrike Breath") && this.toggle.weapon == 1 && offensiveSpecialActivated){
				absorbHp += (this.maxHp * 0.3 | 0);
			}
			else if(this.hasExactly("Achimenes Furl") && this.toggle.weapon > 2){
				absorbHp += 5;
			}
			else if(this.hasExactly("Flower Hauteclere") && this.rValue == 5 && this.toggle.weapon > 0){
				absorbHp += 7;
			}
			else if(this.hasExactly("Starlight Stone") && (!this.initiator || enemy.combatStartHp / enemy.maxHp >= 0.75)){
				absorbHp += 7;
			}
			else if((this.hasExactly("Arcane Downfall") || (this.hasExactly("Ethereal Breath") && this.rValue > 0)) && this.combatStartHp / this.maxHp >= 0.25){
				absorbHp += 7;
			}
			else if(this.hasExactly("Dawnsweet Box") && this.combatStartHp / this.maxHp >= 0.25 && this.getPhantom("Spd") + thisEffSpd >= enemy.getPhantom("Spd") + enemyEffSpd){
				absorbHp += 7;
			}
			else if(this.hasExactly("Sokkvabekkr") && this.rValue > 0 && this.toggle.weapon == 1 && (this.sTrigger == 1 || offensiveSpecialActivated || defensiveSpecialActivated || (this.specialIndex != -1 && data.skills[this.specialIndex].charge <= this.charge))){
				absorbHp += 7;
			}
			else if(this.hasExactly("Fair-Fight Blade") && this.combatStartHp / this.maxHp >= 0.25 && !this.initiator && offensiveSpecialActivated){
				absorbHp += 10;
			}
			else if(this.hasExactly("Virtuous Tyrfing") && ((this.combatStartHp / this.maxHp < 1 || !this.initiator) || (this.rValue > 0 && enemy.combatStartHp / enemy.maxHp >= 0.75))){
				absorbHp += 7;
				if(this.rValue > 0){
					absorbHp++;
				}
			}
			else if(this.hasExactly("Rinkah's Club") && this.rValue == 5 && (this.buddy.adjacent > 0 || this.buddy.two > 0 || this.buddy.three > 0)){
				absorbHp += 7;
			}
			else if(this.hasExactly("Icebound Tome") && (this.initiator || enemy.range == "ranged") && !firstHit){
				absorbHp += 7;
			}
			else if((this.hasExactly("Pure-Wing Spear") || this.hasExactly("Sisterly Axe")) && (this.buddy.adjacent > 0 || this.buddy.two > 0 || this.buddy.three > 0)){
				absorbHp += 7;
				if(enemy.moveType == "cavalry" || enemy.moveType == "armored"){
					absorbHp += 7;
				}
			}
			else if(this.hasExactly("New War Axe") && this.buddy.adjacent + this.buddy.two + this.buddy.three > 0 && this.hp / this.maxHp < 0.7 && this.specialIndex != -1 && offensiveSpecialActivated){
				absorbHp += Math.floor(thisEffDef * ((data.skills[this.specialIndex].charge - this.initSkillCharge()) * 10 + 10) / 100);
			}
			else if(this.hasExactly("Forager Naginata") && this.combatStartHp / this.maxHp >= 0.25){
				absorbHp += Math.min((this.buddy.adjacent + this.buddy.two + this.buddy.three) * 3 + 1, 10);
			}
			else if(this.hasExactly("United Bouquet") && this.combatStartHp / this.maxHp >= 0.25 && this.prfVal > 0){
				absorbHp += Math.min(this.prfVal * 3, 12);
			}
			else if(this.hasExactly("Prince's Lance") && (this.initiator || this.buddy.adjacent > 0 || this.buddy.two > 0) && offensiveSpecialActivated){
				absorbHp += (this.maxHp * Math.min((data.skills[this.specialIndex].charge - this.initSkillCharge()) * 0.2 + 0.1, 1) | 0);
			}
			else if(this.hasExactly("Double Bow") && this.rValue > 0 && this.buddy.adjacent < 2){
				absorbHp += 7;
			}
			else if(this.hasExactly("Ice-Crystal Spear") && (!this.initiator || enemy.combatStartHp / enemy.maxHp >= 0.75)){
				absorbHp += 7;
			}
			
			if((((this.hasExactly("Surge Sparrow") || this.hasExactly("Sturdy Surge")) && this.initiator) || (this.hasExactly("Power of Nihility") && this.toggle.a == 1)) && offensiveSpecialActivated ){
				this.initSkillCharge();
				var recHP = data.skills[this.specialIndex].charge - this.initSkillCharge();
				recHP = Math.min(recHP * 0.2 + 0.1, 1);
				absorbHp += Math.floor(recHP * this.maxHp);
			}
			else if((((this.hasExactly("Atk Res Finish 4") || this.hasExactly("Atk Spd Finish 4") || this.hasExactly("Spd Res Finish 4") || this.hasExactly("Def Res Finish 4") || this.hasExactly("Atk Def Finish 4") || this.hasExactly("Spd Def Finish 4")) && this.buddy.adjacent + this.buddy.two + this.buddy.three > 0) || (this.hasExactly("Verdict of Sacae") && this.toggle.a > 0)) && (this.sTrigger == 1 || offensiveSpecialActivated || defensiveSpecialActivated || (this.specialIndex != -1 && data.skills[this.specialIndex].charge <= this.charge))){
				absorbHp += 7;
			}
			else if(this.hasExactly("Ostia's Heart") && (enemy.combatStartHp / enemy.maxHp >= 0.75 || !this.initiator)){
				absorbHp += 7;
			}
			
			if(this.hasExactly("Special Fighter 4") && this.combatStartHp / this.maxHp >= 0.4 && offensiveSpecialActivated){
				absorbHp += (dmg * 0.3 | 0);
			}
			else if((this.hasExactly("Sunlight Bangle") && this.toggle.b > 0) || (this.hasExactly("Sunlit Bangle D") && this.combatStartHp / this.maxHp >= 0.25)){
				absorbHp += 7;
			}
			
			if(this.hasExactly("Even Atk Wave N") && thisEffAtk >= enemyEffAtk - 5){
				absorbHp += 5;
			}
			else if((this.has("Twin N Save") && enemy.range == "melee") || (this.has("Twin F Save") && enemy.range == "ranged")){
				absorbHp += 7;
			}
			else if(this.hasExactly("Open Retainer+") && this.buddy.adjacent + this.buddy.two + this.buddy.three > 0){
				absorbHp += 7;
			}
			
			if(this.hasExactly("Flare") && offensiveSpecialActivated && this.hp / this.maxHp < 0.7){
				absorbHp += (this.maxHp * 0.3 | 0);
			}
			else if(this.hasExactly("Aether's Path") && offensiveSpecialActivated){
				absorbHp += (this.maxHp * 0.5 | 0);
			}
			else if(this.hasExactly("Dragon Flame") && offensiveSpecialActivated){
				absorbHp += (this.maxHp * 0.3 | 0);
			}
			
			if(this.bonus.divinely > 0){
				absorbHp += this.bonus.divinely * 4;
			}
			
			if(this.support.achimenes > 0){
				absorbHp += this.support.achimenes;
			}
			
			if(absorbHp > 0){
				damageText += this.tallyHeal(enemy, absorbHp, offensiveSpecialActivated);
			}

			//Special charge does not increase if special was used on this attack
			if(!offensiveSpecialActivated){
				var heavyBlade = 0;
				var chargeUp = 0;
				if(this.has("Heavy Blade")){
					var cHb = this.hasGreatest("Heavy Blade");
					heavyBlade = cHb[0]*-2 + 7;
					if(heavyBlade < 0){//Heavy Blade 4 will make this value go -1
						heavyBlade = 1;
					}
				}
				if((this.hasExactly("Blazing Durandal") && this.rValue < 0) || this.hasExactly("Gladiator's Blade") || (this.support.infantryRush == true && this.moveType == "infantry")){
					heavyBlade = 1;
				}

				if(heavyBlade && thisEffAtk - enemyEffAtk >= heavyBlade){
					chargeUp = 1;				}
				//Ayra's Blade and Flashing Blade charge edit
				if(speedBlade){
					chargeUp = 1;
				}
				//Royal Sword Check
				if(this.hasExactly("Royal Sword") && this.toggle.weapon == 1){
					chargeUp = 1;
				}
				if(this.hasExactly("Royal Sword") && this.rValue > 0 && this.initiator){
					chargeUp = 1;
				}
				//Storm Sieglinde Check
				if(this.hasExactly("Storm Sieglinde")){
					if(this.toggle.weapon == 1 || (this.rValue > 0 && this.initiator)){
						chargeUp = 1;
					}
				}
				//Blazing Durandal/Soleil's Shine Refined
				if(((this.hasExactly("Blazing Durandal") && this.rValue > 0) || (this.hasExactly("Soleil's Shine") && this.rValue == 5)) && this.initiator){
					chargeUp = 1;
				}
				if(this.hasExactly("Tanngrisnir") && (checkAllBuffs(this, enemy, turn) || this.toggle.weapon == 1 || (this.rValue > 0 && (this.combatStartHp / this.maxHp >= 0.5 || this.toggle.weapon == 3)))){
					chargeUp = 1;
				}
				//Refined Sneering Axe Check
				if(this.hasExactly("Sneering Axe") && this.rValue == 5 && enemy.combatStartHp / enemy.maxHp >= 0.75){
					chargeUp = 1;
				}
				//Primordial Breath
				if(this.hasExactly("Primordial Breath") && (!this.initiator || enemy.combatStartHp / enemy.maxHp == 1 || (this.rValue > 0 && enemy.combatStartHp / enemy.maxHp >= 0.75))){
					chargeUp = 1;
				}
				if(this.hasExactly("Renewed Fang") && this.toggle.weapon == 1){
					chargeUp = 1;
				}
				if((this.hasExactly("Awoken Breath") || (this.hasExactly("Kia Staff") && this.rValue > 0)) && this.buddy.adjacent + this.buddy.two + this.buddy.three > 0){
					chargeUp = 1;
				}
				//Felicia's Plate check
				if(this.hasExactly("Felicia's Plate") && this.rValue == 5 && (enemy.weaponType == "redtome" || enemy.weaponType == "bluetome" || enemy.weaponType == "greentome" || enemy.weaponType == "graytome")){
					chargeUp = 1;
				}
				//Special Refined PRFs that requires HP >= 25%
				if((this.hasExactly("Flame Siegmund") || this.hasExactly("Draconic Rage") || this.hasExactly("Hawk King Claw") || this.has("Brazen Cat Fang") || (this.hasExactly("Whitedown Spear") && this.toggle.weapon == 1) || this.hasExactly("Hawk King Claw") || this.hasExactly("Constant Dagger") || this.hasExactly("Dark Creator S") || this.hasExactly("Craver's Tome")) && this.rValue == 5 && this.combatStartHp / this.maxHp >= 0.25){
					chargeUp = 1;
				}
				if((this.hasExactly("Fireman's Hook") || (this.hasExactly("Dark Spikes T") && this.rValue == 5) || this.hasExactly("Chon'sin Sprig")) && (this.initiator || this.toggle.weapon == 1)){
					chargeUp = 1;
				}
				//Refined Kaze's Needle check
				if(this.hasExactly("Kaze's Needle") && this.rValue == 5 && this.combatStartHp / this.maxHp >= 0.25 && this.getPhantom("Spd") + thisEffSpd > enemy.getPhantom("Spd") + enemyEffSpd){
					chargeUp = 1;
				}
				if(this.hasExactly("Lioness Blade") && this.combatStartHp / this.maxHp >= 0.25 && enemy.combatStartHp / enemy.maxHp >= 0.75){
					chargeUp = 1;
				}
				//Refined Summer's Breath has a 2nd condition
				if(this.hasExactly("Summer's Breath") && this.rValue > 0 && enemy.combatStartHp / enemy.maxHp >= 0.75){
					chargeUp = 1;
				}
				if((this.hasExactly("Headsman Glitnir") || this.hasExactly("Arcane Downfall") || this.hasExactly("Horn of the Land") || this.hasExactly("Arcane Devourer") || this.hasExactly("Seafoam Splitter") || this.hasExactly("Fujin Uchiwa") || this.hasExactly("Arcane Caliburnus") || this.hasExactly("Arcane Void") || this.hasExactly("Troubling Blade") || this.hasExactly("Incipit Kvasir") || this.hasExactly("World-Tree Tail") || this.hasExactly("Arcane Thunder") || this.hasExactly("Axe of Adoration") || this.hasExactly("Arcane Charmer") || this.hasExactly("Perspicacious") || this.hasExactly("Arcane Fellstone") || this.has("Small Spade") || this.hasExactly("Heavenly Wings") || this.has("Helping Dagger") || this.hasExactly("Hidden Blade")) && this.combatStartHp / this.maxHp >= 0.25){
					chargeUp = 1;
				}
				if(this.hasExactly("Raven King Beak") && this.rValue == 5 && (this.transform == true || enemy.combatStartHp / enemy.maxHp >= 0.75) && this.getPhantom("Spd") + thisEffSpd - enemy.getPhantom("Spd") - enemyEffSpd >= 1){
					chargeUp = 1;
				}
				if((this.hasExactly("Dragonbind") || this.hasExactly("Thracia Kinglance")) && this.rValue == 5 && this.combatStartHp / this.maxHp >= 0.25){
					chargeUp = 1;
				}
				if(this.hasExactly("Wanderer Blade") && enemy.combatStartHp / enemy.maxHp >= 0.75 && this.getPhantom("Spd") + thisEffSpd > enemy.getPhantom("Spd") + enemyEffSpd){
					chargeUp = 1;
				}
				if((this.hasExactly("Moonlight Stone") || this.hasExactly("Loving Breath") || this.hasExactly("Nectar Horn") || this.hasExactly("Mercenary Lance") || this.hasExactly("Dark Monograph") || (this.hasExactly("Staff of the Saint") && this.rValue == 5)) && (!this.initiator || enemy.combatStartHp / enemy.maxHp >= 0.75)){
					chargeUp = 1;
				}
				if(this.hasExactly("Geirdriful") && (this.initiator || this.buddy.adjacent > 0 || this.buddy.two > 0) && Object.values(this.bonus).reduce((a, item) => a + (item === true ? 1 : 0), 0) + this.bonus.extra > 0){
					chargeUp = 1;
				}
				if((this.hasExactly("Crimson Blades") || (this.hasExactly("Crimson War-Axe") && enemy.combatStartHp / enemy.maxHp >= 0.75)) && this.combatStartHp / this.maxHp >= 0.2){
					chargeUp = 1;
				}
				if((this.hasExactly("Inseverable Spear") || this.hasExactly("Dusk-Dawn Staff")) && (this.initiator || this.toggle.weapon == 1)){
					chargeUp = 1;
				}
				if(this.hasExactly("Asura Blades") && this.getPhantom("Spd") + thisEffSpd > enemy.getPhantom("Spd") + enemyEffSpd){
					chargeUp = 1;
				}
				if(this.hasExactly("Keen Rabbit Fang") && (this.initiator || this.toggle.weapon == 1) && this.getPhantom("Spd") + thisEffSpd > enemy.getPhantom("Spd") + enemyEffSpd){
					chargeUp = 1;
				}
				if((this.hasExactly("Wolfskin Fang") || this.hasExactly("Ragnell-Alondite") || this.hasExactly("Valbar's Lance") || this.hasExactly("Western Axe") || this.hasExactly("Amatsu") || this.hasExactly("Hrimfaxi") || this.hasExactly("Wyvern Lance")) && (!this.initiator || enemy.combatStartHp / enemy.maxHp >= 0.75) && this.rValue == 5){
					chargeUp = 1;
				}
				if(this.hasExactly("Arcane Qiang") && this.combatStartHp / this.maxHp >= 0.25 && this.toggle.weapon == 1){
					chargeUp = 1;
				}
				if(this.hasExactly("Ravager") && this.combatStartHp / this.maxHp >= 0.25 && this.transform == true){
					chargeUp = 1;
				}
				if(this.hasExactly("Aymr") && this.rValue == 5 && (this.toggle.weapon == 1 || enemy.combatStartHp / enemy.maxHp >= 0.75)){
					chargeUp = 1;
				}
				if((this.hasExactly("Blade Royale") || this.hasExactly("Ilian Frost Blade") || this.hasExactly("Aerial Longsword") || ((this.hasExactly("Thief's Honesty") || this.hasExactly("Goddess Axe")) && this.rValue == 5) || (this.hasExactly("Talregan Axe") && this.rValue > 0) || this.hasExactly("Fell Majesty")) && (this.initiator || this.buddy.adjacent > 0 || this.buddy.two > 0)){
					chargeUp = 1;
				}
				if(this.hasExactly("Rinkah's Club") && this.rValue > 0 && (!this.initiator || this.combatStartHp / this.maxHp < 1 || enemy.combatStartHp / enemy.maxHp >= 0.75)){
					chargeUp = 1;
				}
				if(((this.hasExactly("Persecution Bow") && this.rValue == 5) || this.hasExactly("Axe of Dusk")) && (this.initiator || enemy.combatStartHp / enemy.maxHp >= 0.75)){
					chargeUp = 1;
				}
				if(this.hasExactly("Fell Child's Might") && (this.initiator || enemy.range == "ranged")){
					chargeUp = 1;
				}
				if(this.hasExactly("Arcane Fell Arts") && (!this.initiator || this.combatStartHp / this.maxHp >= 0.25)){
					chargeUp = 1;
				}
				
				//Steady breath CD increase when unit attacks but wasn't initiator
				if((this.hasExactly("Steady Breath") || this.hasExactly("Warding Breath") || this.hasExactly("Summer's Breath") || this.hasExactly("Fierce Breath") || this.hasExactly("Darting Breath")) && this.initiator == false){
					chargeUp = 1;
				}
				if(this.hasExactly("Dragonhide") && (enemy.combatStartHp / enemy.maxHp >= 0.75 || !this.initiator)){
					chargeUp = 1;
				}
				else if(this.hasExactly("Flash Sparrow") && this.initiator && this.getPhantom("Spd") + thisEffSpd >= enemy.getPhantom("Spd") + enemyEffSpd - 5){
					chargeUp = 1;
				}
				else if(this.hasExactly("Power of Nihility") && this.toggle.a == 1){
					chargeUp = 1;
				}
				else if(this.hasExactly("Atk Spd Wild") && (this.buddy.adjacent < 2 || this.transform == true)){
					chargeUp = 1;
				}
				else if(this.hasExactly("Divine Toxin") && (this.transform == true || !this.initiator)){
					chargeUp = 1;
				}
				else if(this.hasExactly("Nihility's Undoing") && (this.transform == true || enemy.combatStartHp / enemy.maxHp >= 0.75)){
					chargeUp = 1;
				}
				if(this.has("Bold Fighter") && this.initiator){
					if((this.combatStartHp / this.maxHp >= 1.5 + this.hasSlot("Bold Fighter","b") * -0.5) || (this.combatStartHp / this.maxHp >= 1.5 + this.hasSlot("Bold Fighter","s") * -0.5)){
						chargeUp = 1;
					}
				}
				else if(this.has("Vengeful Fighter") && this.initiator == false){
					if((this.combatStartHp/this.maxHp >= 1.1 - 0.2 * this.has("Vengeful Fighter")) || (this.hasExactly("Vengeful Fighter 4") && this.combatStartHp/this.maxHp >= 0.25)){
						chargeUp = 1;
					}
				}
				else if(this.has("Special Fighter")){
					if((this.combatStartHp/this.maxHp >= 1.1 - 0.2 * this.hasSlot("Special Fighter","b") && !this.hasExactly("Special Fighter 4")) || (this.hasExactly("Special Fighter 4") && this.combatStartHp/this.maxHp >= 0.4) || (this.combatStartHp/this.maxHp >= 1.1 - 0.2 * this.hasSlot("Special Fighter","s"))){
						chargeUp = 1;
					}
				}
				else if(this.hasExactly("Armored Wall") && this.combatStartHp / this.maxHp >= 0.25){
					chargeUp = 1;
				}
				if((this.hasExactly("Bern's New Way") || this.hasExactly("Wings of Light+")) && this.toggle.c == 1){
					chargeUp = 1;
				}
				else if(this.hasExactly("Divine God Fang") && this.buddy.adjacent + this.buddy.two + this.buddy.three > 0){
					chargeUp = 1;
				}
				//infBreath now charges no matter what.  Up to user to pick the right scenario.
				if(this.support.infantryBreath || this.has("Worldbreaker") || this.bonus.breathB){
					chargeUp = 1;
				}
				if(chargeUp == 1 && !enemy.support.nullGuard && !enemy.support.nullFGuard && !enemy.hasExactly("Creator Sword") && !(enemy.hasExactly("Ayra's Blade") && enemy.rValue > 0) && !(enemy.hasExactly("Spendy Scimitar") && (!this.initiator || enemy.toggle.weapon == 1) && enemy.dragonflower > 1) && !(enemy.moveType == "infantry" && enemy.weaponType == "beast" && enemy.transform == true && (data.heroes[enemy.heroIndex].hero_id > 782 || enemy.rValue > 0)) && !enemy.has("Spd Def Tempo") && !enemy.has("Atk Res Tempo") && !enemy.has("Spd Res Tempo") && !enemy.hasExactly("Wrathful Tempo") && !((enemy.hasExactly("Thunder's Mjolnir") || enemy.hasExactly("Deliverer's Brand") || enemy.hasExactly("Corsair Cleaver") || enemy.hasExactly("Arcane Thrima") || enemy.hasExactly("Dual Sword") || ((enemy.hasExactly("Airborne Spear") || enemy.hasExactly("Professorial Text")) && enemy.rValue == 5)) && enemy.combatStartHp / enemy.maxHp >= 0.25) && !(enemy.hasExactly("Guide's Hourglass") && (!this.initiator || enemy.toggle.weapon == 1)) && !(enemy.hasExactly("Scepter of Love") && enemy.rValue == 5 && (!this.initiator || enemy.toggle.weapon > 1)) && !(((enemy.hasExactly("Areadbhar") && enemy.rValue == 5) || enemy.has("Giant Shuriken")) && (!this.initiator || enemy.buddy.adjacent > 0 || enemy.buddy.two > 0)) && !(enemy.hasExactly("Balmung") && enemy.rValue > 0 && (this.initiator || this.combatStartHp / this.maxHp >= 0.75)) && !((enemy.hasExactly("Hippity-Hop Axe") || enemy.hasExactly("New War Axe")) && (enemy.buddy.adjacent > 0 || enemy.buddy.two > 0 || enemy.buddy.three > 0)) && !((enemy.hasExactly("Spear of Shadow") || enemy.hasExactly("Blade of Shadow")) && enemy.rValue > 0 && (this.initiator || this.combatStartHp / this.maxHp >= 0.75)) && !(enemy.hasCaptain("Flash of Steel") && (enemy.toggle.sd == 0 || enemy.isFeuded(this) == false)) && !(enemy.hasExactly("Forever Yours") && (!this.initiator || enemy.buddy.adjacent + enemy.buddy.two + enemy.buddy.three > 0)) && !((enemy.hasExactly("Odd Def Wave 4") || (enemy.has("Tropical Conch") && enemy.combatStartHp / enemy.maxHp >= 0.25)) && enemyEffDef >= thisEffDef - 5) && !(enemy.hasExactly("Professorial Guide") && (!this.initiator || (enemy.rValue < 0 && enemy.buddy.adjacent + enemy.buddy.two > 0) || (enemy.rValue > 0 && enemy.buddy.rorc > 0))) && !(enemy.hasExactly("Obsidian Lance") && enemy.rValue == 5) && !enemy.hasExactly("Tempo Echo") && !(enemy.hasExactly("Sparking Tome") && enemy.rValue > 0 && (!this.initiator || this.combatStartHp / this.maxHp >= 0.5)) && !enemy.has("Spring-Air Egg") && !enemy.has("Spring-Air Axe") && !enemy.hasExactly("Sword of Dusk")){
					this.charge++;
				}
				
				if(!this.support.nullGuard && !this.support.nullUGuard && !this.hasExactly("Creator Sword") && !(this.hasExactly("Ayra's Blade") && this.rValue > 0) && !(this.hasExactly("Spendy Scimitar") && (this.initiator || this.toggle.weapon == 1) && this.dragonflower > 1) && !(this.hasExactly("Holy Yewfelle") && (enemy.combatStartHp / enemy.maxHp >= 0.75 || this.initiator)) && !(this.hasExactly("Moonlight Bangle") || this.hasExactly("Moonlit Bangle F")) && !this.hasExactly("Solar Brace 2") && !(this.hasExactly("Whirling Grace") && this.combatStartHp / this.maxHp >= 0.25 && this.getPhantom("Spd") + thisEffSpd > enemy.getPhantom("Spd") + enemyEffSpd) && !(this.hasExactly("Fireman's Hook") && (this.initiator || this.toggle.weapon == 1)) && !(this.moveType == "infantry" && this.weaponType == "beast" && this.transform == true && (data.heroes[this.heroIndex].hero_id > 782 || this.rValue > 0)) && !this.has("Spd Def Tempo") && !this.has("Atk Res Tempo") && !this.has("Spd Res Tempo") && !this.hasExactly("Wrathful Tempo") && !this.hasExactly("AD Spiked Wall") && !this.hasExactly("SR Spiked Wall") && !this.hasExactly("AS Spiked Wall") && !((this.hasExactly("Thunder's Mjolnir") || this.hasExactly("Deliverer's Brand") || this.hasExactly("Brightwind Fans") || this.hasExactly("Silent Yule Knife") || this.hasExactly("Holy Yule Blade") || this.hasExactly("Emblem Ragnell") || this.hasExactly("Spoil Rotten") || this.hasExactly("Sunlit Bangle D") || this.hasExactly("Caladbolg") || this.hasExactly("Under the Sun") || this.hasExactly("Summertime Axe") || this.hasExactly("Exalt's Tactics") || this.hasExactly("Hungry Cat Fang") || this.hasExactly("Arcane Blutgang") || this.hasExactly("Dark Perfume") || this.hasExactly("New Year Treats") || ((this.hasExactly("Primordial Breath") || this.hasExactly("Airborne Spear") || this.hasExactly("Professorial Text") || this.hasExactly("Failnaught") || this.hasExactly("Inner Wellspring") || this.hasExactly("Sky-Pirate Claw") || this.hasExactly("Luin")) && this.rValue == 5)) && this.combatStartHp / this.maxHp >= 0.25) && !(this.hasExactly("Dragonbind") && this.rValue == 5 && this.combatStartHp / this.maxHp >= 0.25) && !(this.hasExactly("Shadow Sword") && this.rValue == 5 && enemy.combatStartHp / enemy.maxHp >= 0.75) && !(this.hasExactly("Mila's Testament") && (this.initiator || this.toggle.weapon == 1)) && !((this.hasExactly("Luna Arc") || this.hasExactly("Mareeta's Sword")) && this.rValue == 5 && this.combatStartHp / this.maxHp >= 0.25) && !(this.hasExactly("Wind Parthia") && this.rValue == 5 && this.combatStartHp / this.maxHp >= 0.25) && !this.hasExactly("Sirius+") && !this.has("Velocity") && !(this.hasExactly("Deep-Blue Bow") && this.rValue > 0 && (this.initiator || enemy.combatStartHp / enemy.maxHp >= 0.75)) && !(this.hasExactly("Hunting Blade") && this.rValue == 5 && this.combatStartHp / this.maxHp >= 0.25 && this.initiator && enemy.combatStartHp / enemy.maxHp >= 1) && !this.hasExactly("Enclosure") && !(this.hasExactly("Enclosing Claw") && this.combatStartHp / this.maxHp >= 0.25) && !(this.hasExactly("Meisterbogen") && this.rValue == 5 && (this.initiator || this.toggle.weapon == 1)) && !(this.hasExactly("Guide's Hourglass") && (this.initiator || this.toggle.weapon == 1)) && !(this.hasCaptain("Flash of Steel") && (this.toggle.sd == 0 || this.isFeuded(enemy) == false)) && !(this.hasExactly("Bow of Repose") && this.combatStartHp / this.maxHp < 1 && this.toggle.weapon != 0 && this.toggle.weapon != 10 && this.toggle.weapon != 1 && this.toggle.weapon != 11) && !(this.hasExactly("Total War Tome") && this.combatStartHp / this.maxHp >= 0.25 && this.toggle.weapon == 1) && !(this.hasExactly("Fruit of Life") && this.combatStartHp / this.maxHp >= 0.25 && this.toggle.b == 1) && !(this.hasExactly("Revenger Lance") && this.rValue == 5 && this.combatStartHp / this.maxHp >= 0.25) && !(this.hasExactly("Scepter of Love") && this.rValue == 5 && (this.initiator || this.toggle.weapon > 1)) && !(this.hasExactly("Sacrifice Staff") && (this.initiator || this.toggle.weapon == 1)) && !(this.hasExactly("Guardian's Bow") && this.rValue == 5 && this.combatStartHp / this.maxHp >= 0.25) && !(this.hasExactly("Vassal-Saint Steel") && this.combatStartHp / this.maxHp >= 0.25 && this.getPhantom("Spd") + thisEffSpd >= enemy.getPhantom("Spd") + enemyEffSpd + 5) && !(this.hasExactly("Partnership Bow") && this.combatStartHp / this.maxHp >= 0.25 && ((this.toggle.weapon > 0 && this.toggle.weapon < 5) || (this.toggle.weapon > 10 && this.toggle.weapon < 15))) && !(this.hasExactly("Prized Lance") && this.rValue == 5 && this.combatStartHp / this.maxHp >= 0.25) && !(this.hasExactly("Desert-Tiger Axe") && this.rValue == 5 && this.toggle.weapon == 1) && !(this.hasExactly("Fair-Fight Blade") && !this.initiator && this.combatStartHp / this.maxHp >= 0.25) && !(this.hasExactly("Get Behind Me") && (this.initiator || this.toggle.b == 1)) && !(this.hasExactly("Binding Necklace+") && (!this.initiator || this.toggle.b == 1)) && !(this.hasExactly("Teatime's Edge") && this.combatStartHp / this.maxHp >= 0.25) && !(this.hasExactly("Rare Talent") && this.combatStartHp / this.maxHp >= 0.25 && this.getPhantom("Res") + thisEffRes > enemy.getPhantom("Res") + enemyEffRes) && !(this.hasExactly("Genesis Falchion") && this.rValue > 0 && (this.initiator || this.buddy.adjacent > 0 || this.buddy.two > 0) && this.toggle.weapon > 0) && !(this.hasExactly("Phantasm Tome") && this.rValue == 5 && this.combatStartHp / this.maxHp >= 0.25) && !((this.hasExactly("Heired Yewfelle") || this.hasExactly("Fell War Tome") || this.hasExactly("Draconic Pacts") || this.hasExactly("Ylisse Ninja Bow") || this.has("Giant Shuriken") || this.hasExactly("Odr of Creation") || this.hasExactly("Deer's Heart") || this.hasExactly("Salvage")) && (this.initiator || this.buddy.adjacent > 0 || this.buddy.two > 0)) && !((this.hasExactly("Absolute Amiti") || this.hasExactly("Glittering Anima") || this.hasExactly("Twinkling Anima") || this.hasExactly("Hippity-Hop Axe") || this.hasExactly("New War Axe") || this.hasExactly("Maritime Arts") || (this.hasExactly("Indignant Bow") && this.rValue == 5)) && (this.buddy.adjacent > 0 || this.buddy.two > 0 || this.buddy.three > 0)) && !(this.hasExactly("Larcei's Edge") && this.rValue > 0 && (allStats[17] + this.getPhantom("Spd") > allStats[21] + enemy.getPhantom("Spd") || enemy.combatStartHp / enemy.maxHp >= 0.75)) && !(this.hasExactly("Bun-Bun Baton") && this.rValue > 0 && this.combatStartHp / this.maxHp >= 0.25) && !(this.hasExactly("Wildcat Dagger") && this.combatStartHp / this.maxHp >= 0.25) && !this.hasExactly("Beyond Witchery") && !((this.hasExactly("Areadbhar") || this.hasExactly("Bow of Frelia")) && this.rValue == 5 && (this.initiator || this.buddy.adjacent > 0 || this.buddy.two > 0)) && !((this.hasExactly("Corsair Cleaver") || this.hasExactly("Arcane Thrima") || this.hasExactly("Dual Sword")) && this.combatStartHp / this.maxHp >= 0.25) && !this.hasExactly("Light Is Time") && !this.hasExactly("Time Is Light") && !this.hasExactly("Time and Light") && !((((this.hasExactly("Balmung") || this.hasExactly("Spear of Shadow") || this.hasExactly("Blade of Shadow")) && this.rValue > 0) || (this.hasExactly("Aureola") && this.rValue == 5) || this.hasExactly("Icy Ravager")) && (!this.initiator || enemy.combatStartHp / enemy.maxHp >= 0.75)) && !(this.hasExactly("Sacaen-Wolf Bow") && this.rValue == 5 && this.combatStartHp / this.maxHp >= 0.25) && !(this.hasExactly("Winds of Change") && this.rValue == 5 && (this.initiator || this.buddy.adjacent > 0 || this.buddy.two > 0)) && !((this.hasExactly("Dragon Monarch") || this.hasExactly("Corrupted Dragon")) && this.toggle.c == 1) && !this.hasExactly("Lodestar Rush") && !(this.hasExactly("Icebound Tome") && (this.initiator || enemy.range == "ranged")) && !(this.hasExactly("Flingster Spear") && this.combatStartHp / this.maxHp >= 0.25 && this.bonus.breathB) && !(this.hasExactly("Summer Strikers") && this.rValue > 0 && (this.initiator || enemy.range == "ranged")) && !(this.hasExactly("Dead-Crow Tome") && this.combatStartHp / this.maxHp >= 1) && !(this.hasExactly("Forever Yours") && (this.initiator || this.buddy.adjacent + this.buddy.two + this.buddy.three > 0)) && !(this.hasExactly("Chaos Ragnell") && this.rValue > 0) && !((this.hasExactly("Odd Def Wave 4") || (this.has("Tropical Conch") && this.combatStartHp / this.maxHp >= 0.25)) && thisEffDef >= enemyEffDef - 5) && !(this.hasExactly("Double Bow") && this.rValue > 0 && this.buddy.adjacent < 2) && !this.hasExactly("Moonlit Bangle Q") && !(this.hasExactly("Sun's Percussors") && this.rValue > 0 && (allStats[17] + this.getPhantom("Spd") >= allStats[21] + enemy.getPhantom("Spd") - 5 || enemy.combatStartHp / enemy.maxHp >= 0.75)) && !(this.support.flutter > 0 && this.specialIndex != -1 && data.defensiveSpecials.indexOf(data.skills[this.specialIndex].name) == -1 && data.gaeSpecials.indexOf(data.skills[this.specialIndex].name) == -1 && !AOE) && !(this.hasExactly("New Levin Sword") && (enemy.combatStartHp / enemy.maxHp >= 0.75 || this.buddy.adjacent < 2)) && !(this.hasExactly("Paranoia") && this.combatStartHp / this.maxHp < 1) && !(this.hasExactly("Professorial Guide") && (this.initiator || (this.rValue < 0 && this.buddy.adjacent + this.buddy.two > 0) || (this.rValue > 0 && this.buddy.rorc > 0))) && !((this.hasExactly("Just Bow") || this.hasExactly("Vedrfolnir's Edge")) && (this.initiator || this.buddy.rorc > 0)) && !(this.hasExactly("Divine Talon") && (this.transform == true || enemy.combatStartHp / enemy.maxHp >= 0.75)) && !(this.hasExactly("Brutal Ferocity") && (!this.initiator || this.combatStartHp / this.maxHp >= 0.25)) && !(this.hasExactly("Divine Toxin") && (this.transform == true || !this.initiator)) && !this.hasExactly("Full Disarm") && !this.hasExactly("Speedtaker 4") && !this.hasExactly("Prescience 2") && !this.hasExactly("Tempo Echo") && !this.hasExactly("Aether's Path") && !(this.hasExactly("Laconic Axe") && (this.initiator || this.buddy.rorc > 0)) && !this.hasExactly("Pure Dragon Wall") && !(this.hasExactly("Sparking Tome") && this.rValue > 0 && (this.initiator || enemy.combatStartHp / enemy.maxHp >= 0.5)) && !this.hasExactly("Twin Strike") && !(this.hasExactly("New Opening") && (this.transform == true || enemy.combatStartHp / enemy.maxHp >= 0.75))){
					var guard = 0;
					if(enemy.hasExactly("Guard 1") || enemy.hasExactly("Guard 2") || enemy.hasExactly("Guard 3") || enemy.hasExactly("Guard 4") || enemy.hasExactly("Guard Echo") || enemy.hasExactly("Reopening")){
						var guardval = 0;
						if(enemy.hasExactly("Guard 3")){
							guardval = 3;
						}
						else if(enemy.hasExactly("Guard 2")){
							guardval = 2;
						}
						else if(enemy.hasExactly("Guard 1")){
							guardval = 1;
						}
						guard = 1.1 - guardval * 0.1;
						if(enemy.hasExactly("Guard 4") || enemy.hasExactly("Guard Echo") || enemy.hasExactly("Reopening")){
							guard = 0.25;
						}
						if(enemy.combatStartHp / enemy.maxHp >= guard){
							this.charge--;
						}
					}
					else if(enemy.has("Flow Guard") && !this.initiator){
						if((enemy.has("Flow Guard") == 1 && enemy.combatStartHp/enemy.maxHp >= 1) || (enemy.has("Flow Guard") == 2 && enemy.combatStartHp/enemy.maxHp >= 0.5) || enemy.has("Flow Guard") >= 3){
							this.charge--;
						}
					}
					else if((enemy.hasExactly("Seal Res 4") || enemy.hasExactly("Seal Spd Res 3") || enemy.hasExactly("Seal Def Res 3") || enemy.hasExactly("Seal Atk Res 3")) && (this.combatDebuffs.res < 0 || this.debuffs.res < 0 || (this.penalty.panic && (this.combatBuffs.res > 0 || this.buffs.res > 0)))){
						this.charge--;
					}
					else if((enemy.hasExactly("Seal Def 4") || enemy.hasExactly("Seal Def Res 3") || enemy.hasExactly("Seal Spd Def 3")) && (this.combatDebuffs.def < 0 || this.debuffs.def < 0 || (this.penalty.panic && (this.combatBuffs.def > 0 || this.buffs.def > 0)))){
						this.charge--;
					}
					else if((enemy.hasExactly("Seal Spd 4") || enemy.hasExactly("Seal Spd Res 3") || enemy.hasExactly("Seal Spd Def 3")) && (this.combatDebuffs.spd < 0 || this.debuffs.spd < 0 || (this.penalty.panic && (this.combatBuffs.spd > 0 || this.buffs.spd > 0)))){
						this.charge--;
					}
					else if((enemy.hasExactly("Seal Atk 4") || enemy.hasExactly("Seal Atk Res 3")) && (this.combatDebuffs.atk < 0 || this.debuffs.atk < 0 || (this.penalty.panic && (this.combatBuffs.atk > 0 || this.buffs.atk > 0)))){
						this.charge--;
					}
					//Might need to change this in the future when Guard becomes a seal
					else if(enemy.has("Special Fighter")){
						if((enemy.combatStartHp/enemy.maxHp >= 1.1 - 0.2 * enemy.hasSlot("Special Fighter","b") && !enemy.hasExactly("Special Fighter 4")) || (enemy.hasExactly("Special Fighter 4") && enemy.combatStartHp/enemy.maxHp >= 0.4) || (enemy.combatStartHp/enemy.maxHp >= 1.1 - 0.2 * enemy.hasSlot("Special Fighter","s"))){
							this.charge--;
						}
					}
					else if(enemy.has("Crafty Fighter")){
						if(enemy.combatStartHp/enemy.maxHp >= 1 - 0.25 * enemy.has("Crafty Fighter") && this.initiator){
							this.charge--;
						}
					}
					//HP >= 25%
					else if((enemy.hasExactly("Armored Wall") || enemy.hasExactly("Headsman Glitnir") || enemy.hasExactly("Arcane Eljudnir") || enemy.hasExactly("Warrior's Sword") || enemy.hasExactly("Self-Improver") || enemy.hasExactly("Monarch Blade") || enemy.hasExactly("Ravager") || enemy.hasExactly("Valiant War Axe") || enemy.hasExactly("Flame Battleaxe") || enemy.has("New-Sun Stone") || enemy.hasExactly("Monarch's Stone") || enemy.hasExactly("Dead-Wolf Blade") || enemy.hasExactly("Diva-Pair Parasol") || enemy.has("Anchor Axe") || enemy.hasExactly("Fimbulvetr Morn") || enemy.hasExactly("Gift of Guidance")) && enemy.combatStartHp / enemy.maxHp >= 0.25){
						this.charge--;
					}
					else if((enemy.hasExactly("Steady Stance 4") || enemy.hasExactly("Warding Stance 4") || enemy.hasExactly("Mirror Stance 3") || enemy.hasExactly("Steady Posture 3") || enemy.hasExactly("Sturdy Stance 3") || enemy.hasExactly("Bracing Stance 3") || enemy.hasExactly("Kestrel Stance 3") || enemy.hasExactly("Swift Stance 3")) && this.initiator){
						this.charge--;
					}
					else if(this.penalty.cdguard || enemy.support.sGuard){
						this.charge--;
					}
					else if(enemy.has("Bottled Juice") || enemy.has("Devilish Bow") || enemy.has("Hack-O-Lantern") || enemy.has("Guard Sword") || enemy.has("Guard Lance") || enemy.has("Guard Axe") || ((enemy.has("Candy Cane") || enemy.has("Reindeer Bow") || enemy.hasExactly("Duality Vessel")) && enemy.toggle.weapon == 1) || ((enemy.hasExactly("Hoarfrost Knife") || enemy.hasExactly("Tempest's Claw")) && enemy.rValue == 5 && (enemy.initiator || enemy.toggle.weapon == 1)) || ((enemy.hasExactly("Gurgurant") || enemy.hasExactly("Aurora Breath")) && enemy.rValue > 0) || enemy.hasExactly("Wyvern Lance") || enemy.hasExactly("Pulse Smog") || enemy.hasExactly("Petaldream Horn")){
						this.charge--;
					}
					else if(enemy.hasExactly("Beruka's Axe") && enemy.rValue == 5 && enemy.combatStartHp/enemy.maxHp >= 0.5){
						this.charge--;
					}
					//Blazing Durandal Refined
					else if(enemy.hasExactly("Blazing Durandal") && enemy.rValue > 0 && enemy.initiator){
						this.charge--;
					}
					else if(enemy.hasExactly("Prized Lance") && (this.combatStartHp / this.maxHp >= 1 || (enemy.rValue > 0 && (!this.initiator || this.combatStartHp / this.maxHp >= 0.75)))){
						this.charge--;
					}
					else if(enemy.hasExactly("Dragoon Axe") && ((enemy.rValue < 0 && this.combatStartHp / this.maxHp >= 1) || (enemy.rValue > 0 && (this.initiator || this.combatStartHp / this.maxHp >= 0.75)))){
						this.charge--;
					}
					//Corvus Tome
					else if(enemy.hasExactly("Corvus Tome") && this.atk + this.buffs.atk + this.debuffs.atk >= enemy.atk + enemy.buffs.atk + enemy.debuffs.atk + 3 && enemy.rValue == 5){
						this.charge--;
					}
					else if(enemy.hasExactly("Brutal Breath") && (enemy.rValue > 0 || enemy.buddy.adjacent + enemy.buddy.two < 2)){
						this.charge--;
					}
					//Crimson Axe Refined
					else if(enemy.hasExactly("Crimson Axe") && enemy.rValue == 5 && (!enemy.initiator || this.combatStartHp / this.maxHp == 1)){
						this.charge--;
					}
					//Refined Cursed Lance
					else if(enemy.hasExactly("Cursed Lance") && enemy.rValue == 5 && (enemy.combatStartHp / enemy.maxHp < 1 || enemy.toggle.weapon == 1)){
						this.charge--;
					}
					//Refined Arden's Blade
					else if(enemy.hasExactly("Arden's Blade") && enemy.rValue == 5 && enemy.combatStartHp / enemy.maxHp >= 0.5){
						this.charge--;
					}
					//Refined Audhulma
					else if(enemy.hasExactly("Audhulma") && enemy.rValue == 5 && (this.initiator || this.combatStartHp / this.maxHp == 1)){
						this.charge--;
					}
					//Tome and Axe of Despair
					else if((enemy.hasExactly("Tome of Despair") || enemy.hasExactly("Axe of Despair")) && enemy.combatStartHp / enemy.maxHp >= 0.25 && enemy.combineBonPen(this,turn,"buff","debuff") >= 15){
						this.charge--;
					}
					else if((enemy.hasExactly("Expiration") || enemy.hasExactly("Sagittae") || enemy.hasExactly("Blood Tome") || enemy.hasExactly("Dark Creator S") || enemy.hasExactly("Proud Spear")) && enemy.rValue == 5 && enemy.combatStartHp / enemy.maxHp >= 0.25){
						this.charge--;
					}
					//Enemy initiates or Enemy HP >= 75%
					else if((enemy.has("Lantern Breath") || enemy.has("Spider Plush") || enemy.hasExactly("Moonlight Stone") || enemy.hasExactly("Starlight Stone") || enemy.has("Gronndeer") || enemy.has("Raudrdeer") || enemy.has("Blardeer") || enemy.has("Hvitrdeer") || enemy.hasExactly("Revealing Breath") || enemy.hasExactly("Freeblade's Edge") || enemy.hasExactly("Radiant Aureola") || enemy.hasExactly("Ice-Bound Brand") || enemy.hasExactly("Thracia Kinglance") || enemy.hasExactly("Hyperion Lance") || enemy.hasExactly("Fell Slaystone")) && (this.initiator || this.combatStartHp / this.maxHp >= 0.75)){
						this.charge--;
					}
					else if(enemy.hasExactly("Dazzling Breath") && (this.initiator || this.combatStartHp / this.maxHp >= 0.75) && (enemy.rValue > 0 || enemy.buddy.adjacent + enemy.buddy.two > 0)){
						this.charge--;
					}
					//Initiator or weapon toggle
					else if((enemy.hasExactly("Nidavellir Sprig") || enemy.hasExactly("Caring Conch")) && (!this.initiator || enemy.toggle.weapon == 1)){
						this.charge--;
					}
					//Refined Lyfjaberg
					else if(enemy.hasExactly("Lyfjaberg") && enemy.rValue > 0 && enemy.combatStartHp / enemy.maxHp >= 0.25 && (!this.initiator || enemyEffSpd + enemy.getPhantom("Spd") > thisEffSpd + this.getPhantom("Spd"))){
						this.charge--;
					}
					else if((enemy.hasExactly("Breath of Blight") || enemy.hasExactly("Tiger-Roar Axe") || enemy.hasExactly("Aureola")) && enemy.rValue == 5 && (this.combatStartHp / this.maxHp >= 0.75 || this.initiator)){
						this.charge--;
					}
					//Refined Foxkit Fang
					else if((enemy.hasExactly("Foxkit Fang") || enemy.hasExactly("Foxkit Fang 2")) && enemy.rValue == 5 && (!this.initiator || enemy.toggle.weapon == 1) && enemyEffRes + enemy.getPhantom("Res") - thisEffRes - this.getPhantom("Res") >= 1){
						this.charge--;
					}
					else if(enemy.hasExactly("Icy Maltet") && enemy.dragonflower > 4 && (this.initiator || this.combatStartHp / this.maxHp >= 0.75)){
						this.charge--;
					}
					else if(enemy.has("Kitsune Fang") && enemy.rValue == 5 && enemy.toggle.weapon == 2){
						this.charge--;
					}
					else if(enemy.has("Taguel Fang") && enemy.toggle.weapon == 1 && enemy.rValue > 0 && this.weaponType != "dragon" && this.weaponType != "beast"){
						this.charge--;
					}
					else if(((enemy.hasExactly("Flower Hauteclere") && enemy.rValue == 5) || (enemy.hasExactly("Charging Horn") && enemy.rValue > 0)) && enemy.toggle.weapon > 1){
						this.charge--;
					}
					else if(enemy.hasExactly("Firelight Lance") && enemy.combatStartHp / enemy.maxHp >= 0.25 && enemyEffSpd + enemy.getPhantom("Spd") >= thisEffSpd + this.getPhantom("Spd") - 4){
						this.charge--;
					}
					else if(enemy.has("Brazen Cat Fang") && enemy.rValue == 5 && enemy.combatStartHp / enemy.maxHp >= 0.25 && enemy.transform == true){
						this.charge--;
					}
					else if(enemy.hasExactly("Enclosing Claw") && enemy.combatStartHp / enemy.maxHp >= 0.25 && enemy.buddy.erorc > 1){
						this.charge--;
					}
					else if((enemy.hasExactly("Dreaming Spear") || enemy.has("Protection Bow") || enemy.has("Protection Pike") || (enemy.has("Volunteer Bow") && enemy.rValue == 5) || (enemy.hasExactly("Imbued Koma") && enemy.rValue == 5)) && enemy.toggle.weapon == 1){
						this.charge--;
					}
					else if(enemy.hasExactly("Deadly Balance+") && (enemy.combatStartHp / enemy.maxHp >= 0.25 || enemy.toggle.b == 1)){
						this.charge--;
					}
					else if((enemy.hasExactly("Fireflood Boost 3") || enemy.hasExactly("Earthfire Boost 3") || enemy.hasExactly("Earthwind Boost 3") || enemy.hasExactly("Firestorm Boost 3") || enemy.hasExactly("Deluge Boost 3")) && enemy.combatStartHp / enemy.maxHp >= 0.5 && (enemy.buddy.adjacent > 0 || enemy.buddy.two > 0) && enemy.buddy.hpCondition){
						this.charge--;
					}
					else if(enemy.hasExactly("Dream Deliverer") && enemy.toggle.c > 1){
						this.charge--;
					}
					else if((enemy.has("Protection Edge") || enemy.hasExactly("Striving Sword") || enemy.hasExactly("Divine Nectar") || enemy.hasExactly("Fellowship Blade") || (enemy.hasExactly("Caduceus Staff") && enemy.rValue > 0)) && (enemy.buddy.adjacent > 0 || enemy.buddy.two > 0 || enemy.buddy.three > 0)){
						this.charge--;
					}
					else if(enemy.hasExactly("Mending Heart") && (!this.initiator || enemy.buddy.adjacent > 0 || enemy.buddy.two > 0)){
						this.charge--;
					}
					//initiate or within 2 spaces w/ during combat toggle
					else if((enemy.hasExactly("Worldly Lance")) && (!this.initiator || ((enemy.buddy.adjacent > 0 || enemy.buddy.two > 0) && enemy.toggle.weapon > 1))){
						this.charge--;
					}
					else if(enemy.hasExactly("Order's Sentence") && enemy.rValue == 5 && (!this.initiator || this.range == "ranged")){
						this.charge--;
					}
					else if(enemy.hasExactly("Darkling Dragon") && (enemy.buddy.adjacent > 0 || enemy.buddy.two > 0)){
						this.charge--;
					}
					else if(this.vein == 3){
						this.charge--;
					}
				}
				this.charge++;
			}

			if(!defensiveSpecialActivated){
				if(!enemy.support.nullGuard && !enemy.support.nullUGuard && !enemy.hasExactly("Creator Sword") && !(enemy.hasExactly("Ayra's Blade") && enemy.rValue > 0) && !(enemy.hasExactly("Spendy Scimitar") && (!this.initiator || enemy.toggle.weapon == 1) && enemy.dragonflower > 1) && !(enemy.hasExactly("Holy Yewfelle") && (this.combatStartHp / this.maxHp >= 0.75 || !this.initiator)) && !(enemy.hasExactly("Moonlight Bangle") || enemy.hasExactly("Moonlit Bangle F")) && !enemy.hasExactly("Solar Brace 2") && !(enemy.hasExactly("Whirling Grace") && enemy.combatStartHp / enemy.maxHp >= 0.25 && this.getPhantom("Spd") + thisEffSpd < enemy.getPhantom("Spd") + enemyEffSpd) && !(enemy.hasExactly("Fireman's Hook") && (!this.initiator || enemy.toggle.weapon == 1)) && !(enemy.moveType == "infantry" && enemy.weaponType == "beast" && enemy.transform == true && (data.heroes[enemy.heroIndex].hero_id > 782 || enemy.rValue > 0)) && !enemy.has("Spd Def Tempo") && !enemy.has("Atk Res Tempo") && !enemy.has("Spd Res Tempo") && !enemy.hasExactly("Wrathful Tempo") && !enemy.hasExactly("AD Spiked Wall") && !enemy.hasExactly("SR Spiked Wall") && !enemy.hasExactly("AS Spiked Wall") && !((enemy.hasExactly("Thunder's Mjolnir") || enemy.hasExactly("Deliverer's Brand") || enemy.hasExactly("Brightwind Fans") || enemy.hasExactly("Silent Yule Knife") || enemy.hasExactly("Holy Yule Blade") || enemy.hasExactly("Emblem Ragnell") || enemy.hasExactly("Spoil Rotten") || enemy.hasExactly("Sunlit Bangle D") || enemy.hasExactly("Caladbolg") || enemy.hasExactly("Under the Sun") || enemy.hasExactly("Summertime Axe") || enemy.hasExactly("Exalt's Tactics") || enemy.hasExactly("Hungry Cat Fang") || enemy.hasExactly("Arcane Blutgang") || enemy.hasExactly("Dark Perfume") || enemy.hasExactly("New Year Treats") || ((enemy.hasExactly("Primordial Breath") || enemy.hasExactly("Airborne Spear") || enemy.hasExactly("Professorial Text") || enemy.hasExactly("Failnaught") || enemy.hasExactly("Inner Wellspring") || enemy.hasExactly("Sky-Pirate Claw") || enemy.hasExactly("Luin")) && enemy.rValue == 5)) && enemy.combatStartHp / enemy.maxHp >= 0.25) && !(enemy.hasExactly("Dragonbind") && enemy.rValue == 5 && enemy.combatStartHp / enemy.maxHp >= 0.25) && !(enemy.hasExactly("Shadow Sword") && enemy.rValue == 5 && this.combatStartHp / this.maxHp >= 0.75) && !(enemy.hasExactly("Mila's Testament") && (!this.initiator || enemy.toggle.weapon == 1)) && !((enemy.hasExactly("Luna Arc") || enemy.hasExactly("Mareeta's Sword")) && enemy.rValue == 5 && enemy.combatStartHp / enemy.maxHp >= 0.25) && !(enemy.hasExactly("Wind Parthia") && enemy.rValue == 5 && enemy.combatStartHp / enemy.maxHp >= 0.25) && !enemy.hasExactly("Sirius+") && !enemy.has("Velocity") && !(enemy.hasExactly("Deep-Blue Bow") && enemy.rValue > 0 && (!this.initiator || this.combatStartHp / this.maxHp >= 0.75)) && !(enemy.hasExactly("Hunting Blade") && enemy.rValue == 5 && enemy.combatStartHp / enemy.maxHp >= 0.25 && !this.initiator && this.combatStartHp / this.maxHp >= 1) && !enemy.hasExactly("Enclosure") && !(enemy.hasExactly("Enclosing Claw") && enemy.combatStartHp / enemy.maxHp >= 0.25) && !(enemy.hasExactly("Meisterbogen") && enemy.rValue == 5 && (!this.initiator || enemy.toggle.weapon == 1)) && !(enemy.hasExactly("Guide's Hourglass") && (!this.initiator || enemy.toggle.weapon == 1)) && !(enemy.hasCaptain("Flash of Steel") && (enemy.toggle.sd == 0 || enemy.isFeuded(this) == false)) && !(enemy.hasExactly("Bow of Repose") && enemy.combatStartHp / enemy.maxHp < 1 && enemy.toggle.weapon != 0 && enemy.toggle.weapon != 10 && enemy.toggle.weapon != 1 && enemy.toggle.weapon != 11) && !(enemy.hasExactly("Total War Tome") && enemy.combatStartHp / enemy.maxHp >= 0.25 && enemy.toggle.weapon == 1) && !(enemy.hasExactly("Fruit of Life") && enemy.combatStartHp / enemy.maxHp >= 0.25 && enemy.toggle.b == 1) && !(enemy.hasExactly("Revenger Lance") && enemy.rValue == 5 && enemy.combatStartHp / enemy.maxHp >= 0.25) && !(enemy.hasExactly("Scepter of Love") && enemy.rValue == 5 && (!this.initiator || enemy.toggle.weapon > 1)) && !(enemy.hasExactly("Sacrifice Staff") && (!this.initiator || enemy.toggle.weapon == 1)) && !(enemy.hasExactly("Guardian's Bow") && enemy.rValue == 5 && enemy.combatStartHp / enemy.maxHp >= 0.25) && !(enemy.hasExactly("Vassal-Saint Steel") && enemy.combatStartHp / enemy.maxHp >= 0.25 && enemy.getPhantom("Spd") + enemyEffSpd >= this.getPhantom("Spd") + thisEffSpd + 5) && !(enemy.hasExactly("Partnership Bow") && enemy.combatStartHp / enemy.maxHp >= 0.25 && ((enemy.toggle.weapon > 0 && enemy.toggle.weapon < 5) || (enemy.toggle.weapon > 10 && enemy.toggle.weapon < 15))) && !(enemy.hasExactly("Prized Lance") && enemy.rValue == 5 && enemy.combatStartHp / enemy.maxHp >= 0.25) && !(enemy.hasExactly("Desert-Tiger Axe") && enemy.rValue == 5 && enemy.toggle.weapon == 1) && !(enemy.hasExactly("Fair-Fight Blade") && this.initiator && enemy.combatStartHp / enemy.maxHp >= 0.25) && !(enemy.hasExactly("Get Behind Me") && (!this.initiator || enemy.toggle.b == 1)) && !(enemy.hasExactly("Binding Necklace+") && (this.initiator || enemy.toggle.b == 1)) && !(enemy.hasExactly("Teatime's Edge") && enemy.combatStartHp / enemy.maxHp >= 0.25) && !(enemy.hasExactly("Rare Talent") && enemy.combatStartHp / enemy.maxHp >= 0.25 && enemy.getPhantom("Res") + enemyEffRes > this.getPhantom("Res") + thisEffRes) && !(enemy.hasExactly("Genesis Falchion") && enemy.rValue > 0 && (!this.initiator || enemy.buddy.adjacent > 0 || enemy.buddy.two > 0) && enemy.toggle.weapon > 0) && !(enemy.hasExactly("Phantasm Tome") && enemy.rValue == 5 && enemy.combatStartHp / enemy.maxHp >= 0.25) && !((enemy.hasExactly("Heired Yewfelle") || enemy.hasExactly("Fell War Tome") || enemy.hasExactly("Draconic Pacts") || enemy.hasExactly("Ylisse Ninja Bow") || enemy.has("Giant Shuriken") || enemy.hasExactly("Odr of Creation") || enemy.hasExactly("Deer's Heart") || enemy.hasExactly("Salvage")) && (!this.initiator || enemy.buddy.adjacent > 0 || enemy.buddy.two > 0)) && !((enemy.hasExactly("Absolute Amiti") || enemy.hasExactly("Glittering Anima") || enemy.hasExactly("Twinkling Anima") || enemy.hasExactly("Hippity-Hop Axe") || enemy.hasExactly("New War Axe") || enemy.hasExactly("Maritime Arts") || (enemy.hasExactly("Indignant Bow") && enemy.rValue == 5)) && (enemy.buddy.adjacent > 0 || enemy.buddy.two > 0 || enemy.buddy.three > 0)) && !(enemy.hasExactly("Larcei's Edge") && enemy.rValue > 0 && (allStats[21] + enemy.getPhantom("Spd") > allStats[17] + this.getPhantom("Spd") || this.combatStartHp / this.maxHp >= 0.75)) && !(enemy.hasExactly("Bun-Bun Baton") && enemy.rValue > 0 && enemy.combatStartHp / enemy.maxHp >= 0.25) && !(enemy.hasExactly("Wildcat Dagger") && enemy.combatStartHp / enemy.maxHp >= 0.25) && !enemy.hasExactly("Beyond Witchery") && !((enemy.hasExactly("Areadbhar") || enemy.hasExactly("Bow of Frelia")) && enemy.rValue == 5 && (!this.initiator || enemy.buddy.adjacent > 0 || enemy.buddy.two > 0)) && !((enemy.hasExactly("Corsair Cleaver") || enemy.hasExactly("Arcane Thrima") || enemy.hasExactly("Dual Sword")) && enemy.combatStartHp / enemy.maxHp >= 0.25) && !enemy.hasExactly("Light Is Time") && !enemy.hasExactly("Time Is Light") && !enemy.hasExactly("Time and Light") && !((((enemy.hasExactly("Balmung") || enemy.hasExactly("Spear of Shadow") || enemy.hasExactly("Blade of Shadow")) && enemy.rValue > 0) || (enemy.hasExactly("Aureola") && enemy.rValue == 5) || enemy.hasExactly("Icy Ravager")) && (this.initiator || this.combatStartHp / this.maxHp >= 0.75)) && !(enemy.hasExactly("Sacaen-Wolf Bow") && enemy.rValue == 5 && enemy.combatStartHp / enemy.maxHp >= 0.25) && !(enemy.hasExactly("Winds of Change") && enemy.rValue == 5 && (!this.initiator || enemy.buddy.adjacent > 0 || enemy.buddy.two > 0)) && !((enemy.hasExactly("Dragon Monarch") || enemy.hasExactly("Corrupted Dragon")) && enemy.toggle.c == 1) && !enemy.hasExactly("Lodestar Rush") && !(enemy.hasExactly("Icebound Tome") && (!this.initiator || this.range == "ranged")) && !(enemy.hasExactly("Flingster Spear") && enemy.combatStartHp / enemy.maxHp >= 0.25 && enemy.bonus.breathB) && !(enemy.hasExactly("Summer Strikers") && enemy.rValue > 0 && (!this.initiator || this.range == "ranged")) && !(enemy.hasExactly("Dead-Crow Tome") && enemy.combatStartHp / enemy.maxHp >= 1) && !(enemy.hasExactly("Forever Yours") && (!this.initiator || enemy.buddy.adjacent + enemy.buddy.two + enemy.buddy.three > 0)) && !(enemy.hasExactly("Chaos Ragnell") && enemy.rValue > 0) && !((enemy.hasExactly("Odd Def Wave 4") || (enemy.has("Tropical Conch") && enemy.combatStartHp / enemy.maxHp >= 0.25)) && enemyEffDef >= thisEffDef - 5) && !(enemy.hasExactly("Double Bow") && enemy.rValue > 0 && enemy.buddy.adjacent < 2) && !enemy.hasExactly("Moonlit Bangle Q") && !(enemy.hasExactly("Sun's Percussors") && enemy.rValue > 0 && (allStats[21] + enemy.getPhantom("Spd") >= allStats[17] + this.getPhantom("Spd") - 5 || this.combatStartHp / this.maxHp >= 0.75))  && !(enemy.support.flutter > 0 && enemy.specialIndex != -1 && data.defensiveSpecials.indexOf(data.skills[enemy.specialIndex].name) == -1 && data.gaeSpecials.indexOf(data.skills[enemy.specialIndex].name) == -1 && !AOE) && !(enemy.hasExactly("New Levin Sword") && (this.combatStartHp / this.maxHp >= 0.75 || enemy.buddy.adjacent < 2)) && !(enemy.hasExactly("Paranoia") && enemy.combatStartHp / enemy.maxHp < 1) && !(enemy.hasExactly("Professorial Guide") && (!this.initiator || (enemy.rValue < 0 && enemy.buddy.adjacent + enemy.buddy.two > 0) || (enemy.rValue > 0 && enemy.buddy.rorc > 0))) && !((enemy.hasExactly("Just Bow") || enemy.hasExactly("Vedrfolnir's Edge")) && (!this.initiator || enemy.buddy.rorc > 0)) && !(enemy.hasExactly("Divine Talon") && (enemy.transform == true || this.combatStartHp / this.maxHp >= 0.75)) && !(enemy.hasExactly("Brutal Ferocity") && (this.initiator || enemy.combatStartHp / enemy.maxHp >= 0.25)) && !(enemy.hasExactly("Divine Toxin") && (enemy.transform == true || this.initiator)) && !enemy.hasExactly("Full Disarm") && !enemy.hasExactly("Speedtaker 4") && !enemy.hasExactly("Prescience 2") && !enemy.hasExactly("Tempo Echo") && !enemy.hasExactly("Aether's Path") && !(enemy.hasExactly("Laconic Axe") && (!this.initiator || enemy.buddy.rorc > 0)) && !enemy.hasExactly("Pure Dragon Wall") && !(enemy.hasExactly("Sparking Tome") && enemy.rValue > 0 && (!this.initiator || this.combatStartHp / this.maxHp >= 0.5)) && !enemy.hasExactly("Twin Strike") && !(enemy.hasExactly("New Opening") && (enemy.transform == true || this.combatStartHp / this.maxHp >= 0.75))){
					var guard = 0;
					if(this.hasExactly("Guard 1") || this.hasExactly("Guard 2") || this.hasExactly("Guard 3") || this.hasExactly("Guard 4") || this.hasExactly("Guard Echo") || this.hasExactly("Reopening")){
						var guardval = 0;
						if(this.hasExactly("Guard 3")){
							guardval = 3;
						}
						else if(this.hasExactly("Guard 2")){
							guardval = 2;
						}
						else if(this.hasExactly("Guard 1")){
							guardval = 1;
						}
						guard = 1.1 - guardval * 0.1;
						if(this.hasExactly("Guard 4") || this.hasExactly("Guard Echo") || this.hasExactly("Reopening")){
							guard = 0.25;
						}
						if(this.combatStartHp / this.maxHp >= guard){
							enemy.charge--;
						}
					}
					else if(this.has("Flow Guard") && this.initiator){
						if((this.has("Flow Guard") == 1 && this.combatStartHp/this.maxHp >= 1) || (this.has("Flow Guard") == 2 && this.combatStartHp/this.maxHp >= 0.5) || this.has("Flow Guard") >= 3){
							enemy.charge--;
						}
					}
					else if((this.hasExactly("Seal Res 4") || this.hasExactly("Seal Spd Res 3") || this.hasExactly("Seal Def Res 3") || this.hasExactly("Seal Atk Res 3")) && (enemy.combatDebuffs.res < 0 || enemy.debuffs.res < 0 || (enemy.penalty.panic && (enemy.combatBuffs.res > 0 || enemy.buffs.res > 0)))){
						enemy.charge--;
					}
					else if((this.hasExactly("Seal Def 4") || this.hasExactly("Seal Def Res 3") || this.hasExactly("Seal Spd Def 3")) && (enemy.combatDebuffs.def < 0 || enemy.debuffs.def < 0 || (enemy.penalty.panic && (enemy.combatBuffs.def > 0 || enemy.buffs.def > 0)))){
						enemy.charge--;
					}
					else if((this.hasExactly("Seal Spd 4") || this.hasExactly("Seal Spd Res 3") || this.hasExactly("Seal Spd Def 3")) && (enemy.combatDebuffs.spd < 0 || enemy.debuffs.spd < 0 || (enemy.penalty.panic && (enemy.combatBuffs.spd > 0 || enemy.buffs.spd > 0)))){
						enemy.charge--;
					}
					else if((this.hasExactly("Seal Atk 4") || this.hasExactly("Seal Atk Res 3")) && (enemy.combatDebuffs.atk < 0 || enemy.debuffs.atk < 0 || (enemy.penalty.panic && (enemy.combatBuffs.atk > 0 || enemy.buffs.atk > 0)))){
						enemy.charge--;
					}
					//Might need to change this in the future when Guard becomes a seal
					else if(this.has("Special Fighter")){
						if((this.combatStartHp/this.maxHp >= 1.1 - 0.2 * this.hasSlot("Special Fighter","b") && !this.hasExactly("Special Fighter 4")) || (this.hasExactly("Special Fighter 4") && this.combatStartHp/this.maxHp >= 0.4) || (this.combatStartHp/this.maxHp >= 1.1 - 0.2 * this.hasSlot("Special Fighter","s") )){
							enemy.charge--;
						}
					}
					else if(this.has("Crafty Fighter")){
						if(this.combatStartHp/this.maxHp >= 1 - 0.25 * this.has("Crafty Fighter") && !this.initiator){
							enemy.charge--;
						}
					}
					//HP >= 25%
					else if((this.hasExactly("Armored Wall") || this.hasExactly("Headsman Glitnir") || this.hasExactly("Arcane Eljudnir") || this.hasExactly("Warrior's Sword") || this.hasExactly("Self-Improver") || this.hasExactly("Monarch Blade") || this.hasExactly("Ravager") || this.hasExactly("Valiant War Axe") || this.hasExactly("Flame Battleaxe") || this.has("New-Sun Stone") || this.hasExactly("Monarch's Stone") || this.hasExactly("Dead-Wolf Blade") || this.hasExactly("Diva-Pair Parasol") || this.has("Anchor Axe") || this.hasExactly("Fimbulvetr Morn") || this.hasExactly("Gift of Guidance")) && this.combatStartHp / this.maxHp >= 0.25){
						enemy.charge--;
					}
					else if((this.hasExactly("Steady Stance 4") || this.hasExactly("Warding Stance 4") || this.hasExactly("Mirror Stance 3") || this.hasExactly("Steady Posture 3") || this.hasExactly("Sturdy Stance 3") || this.hasExactly("Bracing Stance 3") || this.hasExactly("Kestrel Stance 3") || this.hasExactly("Swift Stance 3")) && this.initiator == false){
						enemy.charge--;
					}
					else if(enemy.penalty.cdguard || this.support.sGuard){
						enemy.charge--;
					}
					else if(this.has("Bottled Juice") || this.has("Devilish Bow") || this.has("Hack-O-Lantern") || this.has("Guard Sword") || this.has("Guard Lance") || this.has("Guard Axe") || ((this.has("Candy Cane") || this.has("Reindeer Bow") || this.hasExactly("Duality Vessel")) && this.toggle.weapon == 1) || ((this.hasExactly("Hoarfrost Knife") || this.hasExactly("Tempest's Claw")) && this.rValue == 5 && (this.initiator || this.toggle.weapon == 1)) || ((this.hasExactly("Gurgurant") || this.hasExactly("Aurora Breath")) && this.rValue > 0) || this.hasExactly("Wyvern Lance") || this.hasExactly("Pulse Smog") || this.hasExactly("Petaldream Horn")){
						enemy.charge--;
					}
					else if(this.hasExactly("Beruka's Axe") && this.rValue == 5 && this.combatStartHp/this.maxHp >= 0.5){
						enemy.charge--;
					}
					//Blazing Durandal Refined
					else if(this.hasExactly("Blazing Durandal") && this.rValue > 0 && this.initiator){
						enemy.charge--;
					}
					else if(this.hasExactly("Prized Lance") && (enemy.combatStartHp / enemy.maxHp >= 1 || (this.rValue > 0 && (this.initiator || enemy.combatStartHp / enemy.maxHp >= 0.75)))){
						enemy.charge--;
					}
					else if(this.hasExactly("Dragoon Axe") && ((this.rValue < 0 && enemy.combatStartHp / enemy.maxHp >= 1) || (this.rValue > 0 && (!this.initiator || enemy.combatStartHp / enemy.maxHp >= 0.75)))){
						enemy.charge--;
					}
					//Corvus Tome
					else if(this.hasExactly("Corvus Tome") && enemy.atk + enemy.buffs.atk + enemy.debuffs.atk >= this.atk + this.buffs.atk + this.debuffs.atk + 3 && this.rValue == 5){
						enemy.charge--;
					}
					else if(this.hasExactly("Brutal Breath") && (this.rValue > 0 || this.buddy.adjacent + this.buddy.two < 2)){
						enemy.charge--;
					}
					//Crimson Axe Refined
					else if(this.hasExactly("Crimson Axe") && this.rValue == 5 && (!this.initiator || enemy.combatStartHp / enemy.maxHp == 1)){
						enemy.charge--;
					}
					//Refined Cursed Lance
					else if(this.hasExactly("Cursed Lance") && this.rValue == 5 && (this.combatStartHp / this.maxHp < 1 || this.toggle.weapon == 1)){
						enemy.charge--;
					}
					//Refined Arden's Blade
					else if(this.hasExactly("Arden's Blade") && this.rValue == 5 && this.combatStartHp / this.maxHp >= 0.5){
						enemy.charge--;
					}
					//Refined Audhulma
					else if(this.hasExactly("Audhulma") && this.rValue == 5 && (enemy.initiator || enemy.combatStartHp / enemy.maxHp == 1)){
						enemy.charge--;
					}
					//Tome and Axe of Despair
					else if((this.hasExactly("Tome of Despair") || this.hasExactly("Axe of Despair")) && this.combatStartHp / this.maxHp >= 0.25 && this.combineBonPen(enemy,turn,"buff","debuff") >= 15){
						enemy.charge--;
					}
					else if((this.hasExactly("Expiration") || this.hasExactly("Sagittae") || this.hasExactly("Blood Tome") || this.hasExactly("Dark Creator S") || this.hasExactly("Proud Spear")) && this.rValue == 5 && this.combatStartHp / this.maxHp >= 0.25){
						enemy.charge--;
					}
					//Enemy initiates or Enemy HP >= 75%
					else if((this.has("Lantern Breath") || this.has("Spider Plush") || this.hasExactly("Moonlight Stone") || this.hasExactly("Starlight Stone") || this.has("Gronndeer") || this.has("Raudrdeer") || this.has("Blardeer") || this.has("Hvitrdeer") || this.hasExactly("Revealing Breath") || this.hasExactly("Freeblade's Edge") || this.hasExactly("Radiant Aureola") || this.hasExactly("Ice-Bound Brand") || this.hasExactly("Thracia Kinglance") || this.hasExactly("Hyperion Lance") || this.hasExactly("Fell Slaystone")) && (!this.initiator || enemy.combatStartHp / enemy.maxHp >= 0.75)){
						enemy.charge--;
					}
					else if(this.hasExactly("Dazzling Breath") && (!this.initiator || enemy.combatStartHp / enemy.maxHp >= 0.75) && (this.rValue > 0 || this.buddy.adjacent + this.buddy.two > 0)){
						enemy.charge--;
					}
					//Initiator or toggle weapon
					else if((this.hasExactly("Nidavellir Sprig") || this.hasExactly("Caring Conch")) && (this.initiator || this.toggle.weapon == 1)){
						enemy.charge--;
					}
					//Refined Lyfjaberg
					else if(this.hasExactly("Lyfjaberg") && this.rValue > 0 && this.combatStartHp / this.maxHp >= 0.25 && (this.initiator || thisEffSpd + this.getPhantom("Spd") > enemyEffSpd + enemy.getPhantom("Spd"))){
						enemy.charge--;
					}
					else if((this.hasExactly("Breath of Blight") || this.hasExactly("Tiger-Roar Axe") || this.hasExactly("Aureola")) && this.rValue == 5 && (enemy.combatStartHp / enemy.maxHp >= 0.75 || !this.initiator)){
						enemy.charge--;
					}
					//Refined Foxkit Fang
					else if((this.hasExactly("Foxkit Fang") || this.hasExactly("Foxkit Fang 2")) && this.rValue == 5 && (this.initiator || this.toggle.weapon == 1) && thisEffRes + this.getPhantom("Res") - enemyEffRes - enemy.getPhantom("Res") >= 1){
						enemy.charge--;
					}
					else if(this.hasExactly("Icy Maltet") && (!this.initiator || enemy.combatStartHp / enemy.maxHp >= 0.75) && this.dragonflower > 4){
						enemy.charge--;
					}
					else if(this.has("Kitsune Fang") && this.rValue == 5 && this.toggle.weapon == 2){
						enemy.charge--;
					}
					else if(this.has("Taguel Fang") && this.toggle.weapon == 1 && this.rValue > 0 && enemy.weaponType != "dragon" && enemy.weaponType != "beast"){
						enemy.charge--;
					}
					else if(((this.hasExactly("Flower Hauteclere") && this.rValue == 5) || (this.hasExactly("Charging Horn") && this.rValue > 0)) && this.toggle.weapon > 1){
						enemy.charge--;
					}
					else if(this.hasExactly("Firelight Lance") && this.combatStartHp / this.maxHp >= 0.25 && thisEffSpd + this.getPhantom("Spd") >= enemyEffSpd + enemy.getPhantom("Spd") - 4){
						enemy.charge--;
					}
					else if(this.has("Brazen Cat Fang") && this.rValue == 5 && this.combatStartHp / this.maxHp >= 0.25 && this.transform == true){
						enemy.charge--;
					}
					else if(this.hasExactly("Enclosing Claw") && this.combatStartHp / this.maxHp >= 0.25 && this.buddy.erorc > 1){
						enemy.charge--;
					}
					else if((this.hasExactly("Dreaming Spear") || this.has("Protection Bow") || this.has("Protection Pike") || (this.has("Volunteer Bow") && this.rValue == 5) || (this.hasExactly("Imbued Koma") && this.rValue == 5)) && this.toggle.weapon == 1){
						enemy.charge--;
					}
					else if(this.hasExactly("Deadly Balance+") && (this.combatStartHp / this.maxHp >= 0.25 || this.toggle.b == 1)){
						enemy.charge--;
					}
					else if((this.hasExactly("Fireflood Boost 3") || this.hasExactly("Earthfire Boost 3") || this.hasExactly("Earthwind Boost 3") || this.hasExactly("Firestorm Boost 3") || this.hasExactly("Deluge Boost 3")) && this.combatStartHp / this.maxHp >= 0.5 && (this.buddy.adjacent > 0 || this.buddy.two > 0) && this.buddy.hpCondition){
						enemy.charge--;
					}
					else if(this.hasExactly("Dream Deliverer") && this.toggle.c > 1){
						enemy.charge--;
					}
					else if(this.hasExactly("Mending Heart") && (this.initiator || this.buddy.adjacent > 0 || this.buddy.two > 0)){
						enemy.charge--;
					}
					else if((this.has("Protection Edge") || this.hasExactly("Striving Sword") || this.hasExactly("Divine Nectar") || this.hasExactly("Fellowship Blade") || (this.hasExactly("Caduceus Staff") && this.rValue > 0)) && (this.buddy.adjacent > 0 || this.buddy.two > 0 || this.buddy.three > 0)){
						enemy.charge--;
					}
					//initiate or within 2 spaces w/ during combat toggle
					else if((this.hasExactly("Worldly Lance")) && (this.initiator || ((this.buddy.adjacent > 0 || this.buddy.two > 0) && this.toggle.weapon > 1))){
						enemy.charge--;
					}
					else if(this.hasExactly("Order's Sentence") && this.rValue == 5 && (this.initiator || enemy.range == "ranged")){
						enemy.charge--;
					}
					else if(this.hasExactly("Darkling Dragon") && (this.buddy.adjacent > 0 || this.buddy.two > 0)){
						enemy.charge--;
					}
					else if(enemy.vein == 3){
						enemy.charge--;
					}
				}
				
				var chargeUp = 0;
				//Steady Breath mechanic
				if((enemy.hasExactly("Steady Breath") || enemy.hasExactly("Warding Breath") || enemy.hasExactly("Summer's Breath") || enemy.hasExactly("Fierce Breath") || enemy.hasExactly("Darting Breath")) && enemy.initiator == false){
					chargeUp = 1;
				}
				//Refined Summer's Breath has a 2nd condition
				if(enemy.hasExactly("Summer's Breath") && enemy.rValue > 0 && this.combatStartHp / this.maxHp >= 0.75){
					chargeUp = 1;
				}
				if((enemy.hasExactly("Dragonhide") || enemy.hasExactly("Loving Breath") || enemy.hasExactly("Nectar Horn") || enemy.hasExactly("Mercenary Lance") || enemy.hasExactly("Dark Monograph") || (enemy.hasExactly("Staff of the Saint") && enemy.rValue == 5)) && (this.combatStartHp / this.maxHp >= 0.75 || this.initiator)){
					chargeUp = 1;
				}
				else if(enemy.hasExactly("Flash Sparrow") && !this.initiator && enemy.getPhantom("Spd") + enemyEffSpd >= this.getPhantom("Spd") + thisEffSpd - 5){
					chargeUp = 1;
				}
				else if(enemy.hasExactly("Power of Nihility") && enemy.toggle.a == 1){
					chargeUp = 1;
				}
				else if(enemy.hasExactly("Atk Spd Wild") && (enemy.buddy.adjacent < 2 || enemy.transform == true)){
					chargeUp = 1;
				}
				else if(enemy.hasExactly("Divine Toxin") && (enemy.transform == true || this.initiator)){
					chargeUp = 1;
				}
				else if(enemy.hasExactly("Nihility's Undoing") && (enemy.transform == true || this.combatStartHp / this.maxHp >= 0.75)){
					chargeUp = 1;
				}
				if(enemy.has("Special Fighter")){
					if((enemy.combatStartHp/enemy.maxHp >= 1.1 - 0.2 * enemy.hasSlot("Special Fighter","b") && !enemy.hasExactly("Special Fighter 4")) || (enemy.hasExactly("Special Fighter 4") && enemy.combatStartHp/enemy.maxHp >= 0.4) || (enemy.combatStartHp/enemy.maxHp >= 1.1 - 0.2 * enemy.hasSlot("Special Fighter","s"))){
						chargeUp = 1;
					}
				}
				else if(enemy.hasExactly("Vengeful Fighter 4") && enemy.combatStartHp/enemy.maxHp >= 0.25 && this.initiator){
					chargeUp = 1;
				}
				else if(enemy.hasExactly("Armored Wall") && enemy.combatStartHp / enemy.maxHp >= 0.25){
					chargeUp = 1;
				}
				//Deadly Balance
				else if(enemy.hasExactly("Deadly Balance") && (enemy.combatStartHp / enemy.maxHp >= 0.5 || enemy.toggle.b == 1)){
					chargeUp = 1;
				}
				else if(enemy.hasExactly("Deadly Balance+") && (enemy.combatStartHp / enemy.maxHp >= 0.25 || enemy.toggle.b == 1)){
					chargeUp = 1;
				}
				//Felicia's Plate check
				if(enemy.hasExactly("Felicia's Plate") && enemy.rValue == 5 && (this.weaponType == "redtome" || this.weaponType == "bluetome" || this.weaponType == "greentome" || this.weaponType == "graytome")){
					chargeUp = 1;
				}
				else if(enemy.hasExactly("Missiletain") || enemy.hasExactly("Moon Gradivus") || (enemy.hasExactly("Dragonscale") && (this.combatStartHp / this.maxHp == 1 || this.initiator)) || (enemy.hasExactly("Polished Fang") && this.combatStartHp / this.maxHp >= 0.75 && thisEffDef < enemyEffDef)){
					chargeUp = 1;
				}
				else if(((enemy.hasExactly("Blazing Durandal") && enemy.rValue > 0) || (enemy.hasExactly("Soleil's Shine") && enemy.rValue == 5)) && enemy.initiator){
					chargeUp = 1;
				}
				else if(enemy.hasExactly("Rinkah's Club") && (this.initiator || enemy.combatStartHp / enemy.maxHp < 1 || (enemy.rValue > 0 && this.combatStartHp / this.maxHp >= 0.75))){
					chargeUp = 1;
				}
				else if(enemy.hasExactly("Weighted Lance") && enemy.rValue == 5 && enemy.combatStartHp / enemy.maxHp >= 0.5){
					chargeUp = 1;
				}
				else if((enemy.has("Pledged Blade") || enemy.has("Huge Fan")) && enemy.toggle.weapon == 1){
					chargeUp = 1;
				}
				else if((enemy.has("Spirited Spear") || enemy.has("Spirited Axe") || enemy.has("Spirited Sword")) && (enemy.toggle.weapon == 1 || checkAllBuffs(enemy, this, turn))){
					chargeUp = 1;
				}
				else if(enemy.hasExactly("Eternal Breath") && enemy.rValue == 5 && (enemy.toggle.weapon == 2 || enemy.toggle.weapon == 3 || checkAllBuffs(enemy, this, turn))){
					chargeUp = 1;
				}	
				else if(enemy.has("Renewed Fang") && enemy.toggle.weapon == 1){
					chargeUp = 1;
				}
				else if((enemy.has("Awoken Breath") || (enemy.hasExactly("Kia Staff") && enemy.rValue > 0)) && enemy.buddy.adjacent + enemy.buddy.two + enemy.buddy.three > 0){
					chargeUp = 1;
				}
				else if((enemy.hasExactly("Flame Siegmund") || enemy.hasExactly("Draconic Rage") || enemy.hasExactly("Hawk King Claw") || enemy.has("Brazen Cat Fang") || enemy.hasExactly("Constant Dagger") || enemy.hasExactly("Dark Creator S") || enemy.hasExactly("Craver's Tome")) && enemy.rValue == 5 && enemy.combatStartHp / enemy.maxHp >= 0.25){
					chargeUp = 1;
				}
				else if(enemy.hasExactly("Kaze's Needle") && enemy.rValue == 5 && enemy.combatStartHp / enemy.maxHp >= 0.25 && this.getPhantom("Spd") + thisEffSpd < enemy.getPhantom("Spd") + enemyEffSpd){
					chargeUp = 1;
				}
				else if((enemy.hasExactly("Fireman's Hook") || enemy.hasExactly("Chon'sin Sprig")) && (!this.initiator || enemy.toggle.weapon == 1)){
					chargeUp = 1;
				}
				else if(enemy.hasExactly("Lioness Blade") && enemy.combatStartHp / enemy.maxHp >= 0.25 && this.combatStartHp / this.maxHp >= 0.75){
					chargeUp = 1;
				}
				else if(enemy.hasExactly("Storm Sieglinde") && enemy.rValue > 0 && (!this.initiator || enemy.toggle.weapon == 1)){
					chargeUp = 1;
				}
				else if((enemy.hasExactly("Headsman Glitnir") || enemy.hasExactly("Arcane Downfall") || enemy.hasExactly("Horn of the Land") || enemy.hasExactly("Arcane Devourer") || enemy.hasExactly("Seafoam Splitter") || enemy.hasExactly("Fujin Uchiwa") || enemy.hasExactly("Arcane Caliburnus") || enemy.hasExactly("Arcane Void") || enemy.hasExactly("Troubling Blade") || enemy.hasExactly("Incipit Kvasir") || enemy.hasExactly("World-Tree Tail") || enemy.hasExactly("Arcane Thunder") || enemy.hasExactly("Axe of Adoration") || enemy.hasExactly("Arcane Charmer") || enemy.hasExactly("Perspicacious") || enemy.hasExactly("Arcane Fellstone") || enemy.has("Small Spade") || enemy.hasExactly("Heavenly Wings") || enemy.has("Helping Dagger") || enemy.hasExactly("Hidden Blade")) && enemy.combatStartHp / enemy.maxHp >= 0.25){
					chargeUp = 1;
				}
				else if((enemy.hasExactly("Dragonbind") || enemy.hasExactly("Thracia Kinglance") || (enemy.hasExactly("Whitedown Spear") && enemy.toggle.weapon == 1)) && enemy.rValue == 5 && enemy.combatStartHp / enemy.maxHp >= 0.25){
					chargeUp = 1;
				}
				else if(enemy.hasExactly("Wanderer Blade") && this.combatStartHp / this.maxHp >= 0.75 && enemy.getPhantom("Spd") + enemyEffSpd > this.getPhantom("Spd") + thisEffSpd){
					chargeUp = 1;
				}
				else if(enemy.hasExactly("Geirdriful") && (!this.initiator || enemy.buddy.adjacent > 0 || enemy.buddy.two > 0) && Object.values(enemy.bonus).reduce((a, item) => a + (item === true ? 1 : 0), 0) + enemy.bonus.extra > 0){
					chargeUp = 1;
				}
				else if((enemy.hasExactly("Crimson Blades") || (enemy.hasExactly("Crimson War-Axe") && this.combatStartHp / this.maxHp >= 0.75)) && enemy.combatStartHp / enemy.maxHp >= 0.2){
					chargeUp = 1;
				}
				else if(enemy.hasExactly("Tanngrisnir") && enemy.rValue > 0 && (enemy.combatStartHp / enemy.maxHp >= 0.5 || checkAllBuffs(enemy, this, turn) || enemy.toggle.weapon == 1 || enemy.toggle.weapon == 3)){
					chargeUp = 1;
				}
				else if((enemy.hasExactly("Inseverable Spear") || enemy.hasExactly("Dusk-Dawn Staff")) && (!this.initiator || enemy.toggle.weapon == 1)){
					chargeUp = 1;
				}
				else if(enemy.hasExactly("Asura Blades") && enemy.getPhantom("Spd") + enemyEffSpd > this.getPhantom("Spd") + thisEffSpd){
					chargeUp = 1;
				}
				else if(enemy.hasExactly("Keen Rabbit Fang") && (!this.initiator || enemy.toggle.weapon == 1) && enemy.getPhantom("Spd") + enemyEffSpd > this.getPhantom("Spd") + thisEffSpd){
					chargeUp = 1;
				}
				else if((enemy.hasExactly("Ragnell-Alondite") || enemy.hasExactly("Valbar's Lance") || enemy.hasExactly("Western Axe") || enemy.hasExactly("Amatsu") || enemy.hasExactly("Hrimfaxi") || enemy.hasExactly("Wyvern Lance")) && (this.initiator || this.combatStartHp / this.maxHp >= 0.75) && enemy.rValue == 5){
					chargeUp = 1;
				}
				else if(enemy.hasExactly("Arcane Qiang") && enemy.combatStartHp / enemy.maxHp >= 0.25 && enemy.toggle.weapon == 1){
					chargeUp = 1;
				}
				else if(enemy.hasExactly("Ravager") && enemy.combatStartHp / enemy.maxHp >= 0.25 && enemy.transform == true){
					chargeUp = 1;
				}
				else if(enemy.hasExactly("Aymr") && enemy.rValue == 5 && (enemy.toggle.weapon == 1 || this.combatStartHp / this.maxHp >= 0.75)){
					chargeUp = 1;
				}
				else if((enemy.hasExactly("Blade Royale") || enemy.hasExactly("Ilian Frost Blade") || enemy.hasExactly("Aerial Longsword") || ((enemy.hasExactly("Thief's Honesty") || enemy.hasExactly("Goddess Axe")) && enemy.rValue == 5) || (enemy.hasExactly("Talregan Axe") && enemy.rValue > 0) || enemy.hasExactly("Fell Majesty")) && (!this.initiator || enemy.buddy.adjacent > 0 || enemy.buddy.two > 0)){
					chargeUp = 1;
				}
				else if(((enemy.hasExactly("Persecution Bow") && enemy.rValue == 5) || enemy.hasExactly("Axe of Dusk")) && (!this.initiator || this.combatStartHp / this.maxHp >= 0.75)){
					chargeUp = 1;
				}
				else if(enemy.hasExactly("Fell Child's Might") && (!this.initiator || this.range == "ranged")){
					chargeUp = 1;
				}
				if((enemy.hasExactly("Bern's New Way") || enemy.hasExactly("Wings of Light+")) && enemy.toggle.c == 1){
					chargeUp = 1;
				}
				else if(enemy.hasExactly("Divine God Fang") && enemy.buddy.adjacent + enemy.buddy.two + enemy.buddy.three > 0){
					chargeUp = 1;
				}
				if(enemy.hasExactly("Arcane Fell Arts") && (this.initiator || enemy.combatStartHp / enemy.maxHp >= 0.25)){
					chargeUp = 1;
				}
				//infBreath now charges no matter what.  Up to user to pick the right scenario.
				if(enemy.support.infantryBreath || enemy.has("Worldbreaker") || enemy.bonus.breathB){
					chargeUp = 1;
				}
				if(chargeUp == 1 && !this.support.nullGuard && !this.support.nullFGuard && !this.hasExactly("Creator Sword") && !(this.hasExactly("Ayra's Blade") && this.rValue > 0) && !(this.hasExactly("Spendy Scimitar") && (this.initiator || this.toggle.weapon == 1) && this.dragonflower > 1) && !(this.moveType == "infantry" && this.weaponType == "beast" && this.transform == true && (data.heroes[this.heroIndex].hero_id > 782 || this.rValue > 0)) && !this.has("Spd Def Tempo") && !this.has("Atk Res Tempo") && !this.has("Spd Res Tempo") && !this.hasExactly("Wrathful Tempo") && !((this.hasExactly("Thunder's Mjolnir") || this.hasExactly("Deliverer's Brand") || this.hasExactly("Corsair Cleaver") || this.hasExactly("Arcane Thrima") || this.hasExactly("Dual Sword") || ((this.hasExactly("Airborne Spear") || this.hasExactly("Professorial Text")) && this.rValue == 5)) && this.combatStartHp / this.maxHp >= 0.25) && !(this.hasExactly("Guide's Hourglass") && (this.initiator || this.toggle.weapon == 1)) && !(this.hasExactly("Scepter of Love") && this.rValue == 5 && (this.initiator || this.toggle.weapon > 1)) && !(((this.hasExactly("Areadbhar") && this.rValue == 5) || this.has("Giant Shuriken")) && (this.initiator || this.buddy.adjacent > 0 || this.buddy.two > 0)) && !(this.hasExactly("Balmung") && this.rValue > 0 && (!this.initiator || enemy.combatStartHp / enemy.maxHp >= 0.75)) && !((this.hasExactly("Hippity-Hop Axe") || this.hasExactly("New War Axe")) && (this.buddy.adjacent > 0 || this.buddy.two > 0 || this.buddy.three > 0)) && !((this.hasExactly("Spear of Shadow") || this.hasExactly("Blade of Shadow")) && this.rValue > 0 && (!this.initiator || enemy.combatStartHp / enemy.maxHp >= 0.75)) && !(this.hasCaptain("Flash of Steel") && (this.toggle.sd == 0 || this.isFeuded(enemy) == false)) && !(this.hasExactly("Forever Yours") && (this.initiator || this.buddy.adjacent + this.buddy.two + this.buddy.three > 0)) && !((this.hasExactly("Odd Def Wave 4") || (this.has("Tropical Conch") && this.combatStartHp / this.maxHp >= 0.25)) && thisEffDef >= enemyEffDef - 5) && !(this.hasExactly("Professorial Guide") && (this.initiator || (this.rValue < 0 && this.buddy.adjacent + this.buddy.two > 0) || (this.rValue > 0 && this.buddy.rorc > 0))) && !(this.hasExactly("Obsidian Lance") && this.rValue == 5) && !this.hasExactly("Tempo Echo") && !(this.hasExactly("Sparking Tome") && this.rValue > 0 && (this.initiator || enemy.combatStartHp / enemy.maxHp >= 0.5)) && !this.has("Spring-Air Egg") && !this.has("Spring-Air Axe") && !this.hasExactly("Sword of Dusk")){
					enemy.charge++;
				}
				enemy.charge++;
			}
			//Increment signal that in combat special or AOE has been used
			if(offensiveSpecialActivated){
				this.sTrigger = 1;
			}
			if(defensiveSpecialActivated){
				enemy.sTrigger = 1;
			}
			
			//determine current CD
			var thisCurrentCharge = "-";
			var enemyCurrentCharge = "-";
			if(this.specialIndex != -1){
				thisCurrentCharge = Math.max(data.skills[this.specialIndex].charge-this.charge, 0);
			}
			if(enemy.specialIndex != -1){
				enemyCurrentCharge = Math.max(data.skills[enemy.specialIndex].charge-enemy.charge, 0);
			}
			
			//show hp
			//Make sure challenger is first and in blue
			if(this.challenger){
				damageText += this.name + " <span class=\"blue\">" + this.hp + "</span> (" + thisCurrentCharge + ") : " + enemy.name + " <span class=\"red\">" + enemy.hp + "</span> (" + enemyCurrentCharge + ")<br>";
			}
			else{
				damageText += enemy.name + " <span class=\"blue\">" + enemy.hp + "</span> (" + enemyCurrentCharge + ") : " + this.name + " <span class=\"red\">" + this.hp + "</span> (" + thisCurrentCharge + ")<br>";
			}


			//do damage again if brave weapon
			if((brave == 1 || brave == 2) && enemy.hp > 0){
				damageText += this.name + " attacks twice with weapon.<br>";
				damageText += this.doDamage(enemy,brave+5,false,true,false,speedBlade,galeused,thisFollowUp,enemyFollowUp,turn,spCharged,1,eBrave,hitback);
			}
		}
		return damageText;
	};

	//represents a full round of combat
	this.attack = function(enemy,turn,galeused,rstorm,dturn){
		
		var roundText = "";//Common theme: text is returned by helper functions, so the functions are called by adding them to roundText
		//check if initiator has a weapon equipped
		if(this.weaponIndex != -1){
			
			var firstTurn = (turn - options.startTurn == 0);
			this.initiator = true;
			enemy.initiator = false;
			enemy.didAttack = false;
			var tCharge = false;
			var eCharge = false;
			var enemyFirst = false;
			var enemyVFirst = false;
			var parity = false;
			if(this.hasExactly("Queensblade") || enemy.hasExactly("Queensblade") || this.hasExactly("Breezy Spear") || enemy.hasExactly("Breezy Spear")){
				parity = true;
			}
	
			//Get relevant defense for simplified text output
			var relevantDefType = "def";
			if(enemy.attackType=="magical"){
				relevantDefType = "res";
			}
			
			//Check for Raging Storm or Galeforce activation
			var galecheck = false;
			if(galeused || rstorm > 0 || dturn > 0){
				galecheck = true;
			}
			
			//Don't do any buff crap if it's the second move of a turn (galeforce, etc.)
			if(!galeused && rstorm == 0 && dturn == 0){
				//reset skill based buffs
				this.combatBuffs = {"atk":0,"spd":0,"def":0,"res":0};
				//Check if Dream Deliverer is active to disable False Start
				if((this.hasExactly("Dream Deliverer") && (this.toggle.c == 1 || this.toggle.c == 3)) || this.support.dream == true){
					this.penalty.fStart = false;
					roundText += this.name + " disables all start of turn [Penalty] with Dream Deliverer.<br>";
				}
				if((enemy.hasExactly("Dream Deliverer") && (enemy.toggle.c == 1 || enemy.toggle.c == 3)) || enemy.support.dream == true){
					enemy.penalty.fStart = false;
					roundText += enemy.name + " disables all start of turn [Penalty] with Dream Deliverer.<br>";
				}
				//The following skills are all start of turn skills (affected by False Start)
				if(!this.penalty.fStart){
					//Check self buffs
					roundText += this.selfBuff(turn);
					//if fatal wasn't inflicted, check for turn-start heals
					if(!this.penalty.fatal || this.bonus.nectar > 0){
						roundText += this.renew(turn);
					}
					//check all start of turn debuff skills, don't check if Dream Deliverer is active
					if(!(enemy.hasExactly("Dream Deliverer") && (enemy.toggle.c == 1 || enemy.toggle.c == 3)) && enemy.support.dream == false){
						roundText += this.chill(enemy,turn);
						roundText += this.combined(enemy,turn);
						if(enemy.hasExactly("Silver of Dawn") || enemy.ephase.reverse){
							if(enemy.combatDebuffs.atk < 0){
								enemy.combatBuffs.atk = Math.max(enemy.combatBuffs.atk,-enemy.combatDebuffs.atk);
								enemy.combatDebuffs.atk = 0;
							}
							if(enemy.combatDebuffs.spd < 0){
								enemy.combatBuffs.spd = Math.max(enemy.combatBuffs.spd,-enemy.combatDebuffs.spd);
								enemy.combatDebuffs.spd = 0;
							}
							if(enemy.combatDebuffs.def < 0){
								enemy.combatBuffs.def = Math.max(enemy.combatBuffs.def,-enemy.combatDebuffs.def);
								enemy.combatDebuffs.def = 0;
							}
							if(enemy.combatDebuffs.res < 0){
								enemy.combatBuffs.res = Math.max(enemy.combatBuffs.res,-enemy.combatDebuffs.res);
								enemy.combatDebuffs.res = 0;
							}
							roundText += enemy.name + " coverts penalties into bonuses.<br>";
						}
						else if(enemy.hasExactly("Scroll of Teas") || enemy.ephase.reverse){
							if(enemy.combatDebuffs.atk < 0){
								enemy.combatDebuffs.atk = 0;
							}
							if(enemy.combatDebuffs.spd < 0){
								enemy.combatDebuffs.spd = 0;
							}
							if(enemy.combatDebuffs.def < 0){
								enemy.combatDebuffs.def = 0;
							}
							if(enemy.combatDebuffs.res < 0){
								enemy.combatDebuffs.res = 0;
							}
							roundText += enemy.name + " neutralizes penalties.<br>";
						}
						var etKey = Object.keys(enemy.ephase).filter(a => enemy.ephase[a] === true);
						etKey = etKey.filter(a => a !== "reverse");
						for(var i = 0; i < etKey.length; i++){
							if(enemy.penalty[etKey[i]] == true){
								enemy.penalty[etKey[i]] = false;
								roundText += enemy.name + " neutralizes selected [Penalty].<br>";
							}
						}
					}
					//apply pre-combat damage (ie. Sinmara)
					if(enemy.bonus.enGarde == false && !(enemy.hasExactly("Shadow Breath") && options.threatenRule=="Summ. Duels")){
						roundText += this.splash(enemy,turn);
					}
					//apply CD reductions
					roundText += this.pulse(enemy,turn);
					//apply Wrath-type CD reductions (must go after)
					roundText += this.wrath();
				}
				//EP turn-start heal (must go after splash to prevent overflow)
				if(!enemy.penalty.fatal || enemy.bonus.nectar > 0){
					roundText += enemy.renewEP(turn);
				}
				//The following is a triggered debuffed, not affected by False Start
				roundText += this.feint(enemy,turn);
				//Quieting Antler buff booster
				if((this.hasExactly("Quieting Antler") || this.hasExactly("Delivering Antler")) && !this.penalty.panic && this.toggle.weapon == 1){
					if(this.combatBuffs.atk > 0){
						this.combatBuffs.atk = Math.min(this.combatBuffs.atk + 3, 10);
					}
					if(this.combatBuffs.spd > 0){
						this.combatBuffs.spd = Math.min(this.combatBuffs.spd + 3, 10);
					}
					if(this.combatBuffs.def > 0){
						this.combatBuffs.def = Math.min(this.combatBuffs.def + 3, 10);
					}
					if(this.combatBuffs.res > 0){
						this.combatBuffs.res = Math.min(this.combatBuffs.res + 3, 10);
					}
				}
				
				//trigger enemy side start of turn skills if it's set to Both (for Summoner Duels)
				//will mirror initiator
				if(options.threatenRule=="Summ. Duels"){
					enemy.combatBuffs = {"atk":0,"spd":0,"def":0,"res":0};
					if(!enemy.penalty.fStart){
						roundText += enemy.selfBuff(turn);
						if(!enemy.penalty.fatal || enemy.bonus.nectar > 0){
							roundText += enemy.renew(turn);
						}
						if(!(this.hasExactly("Dream Deliverer") && (this.toggle.c == 1 || this.toggle.c == 3)) && this.support.dream == false){
							roundText += enemy.chill(this,turn);
							roundText += enemy.combined(this,turn);
							if(this.hasExactly("Silver of Dawn") || this.ephase.reverse){
								if(this.combatDebuffs.atk < 0){
									this.combatBuffs.atk = Math.max(this.combatBuffs.atk,-this.combatDebuffs.atk);
									this.combatDebuffs.atk = 0;
								}
								if(this.combatDebuffs.spd < 0){
									this.combatBuffs.spd = Math.max(this.combatBuffs.spd,-this.combatDebuffs.spd);
									this.combatDebuffs.spd = 0;
								}
								if(this.combatDebuffs.def < 0){
									this.combatBuffs.def = Math.max(this.combatBuffs.def,-this.combatDebuffs.def);
									this.combatDebuffs.def = 0;
								}
								if(this.combatDebuffs.res < 0){
									this.combatBuffs.res = Math.max(this.combatBuffs.res,-this.combatDebuffs.res);
									this.combatDebuffs.res = 0;
								}
								roundText += this.name + " coverts penalties into bonuses.<br>";
							}
							else if(this.hasExactly("Scroll of Teas") || this.ephase.reverse){
								if(this.combatDebuffs.atk < 0){
									this.combatDebuffs.atk = 0;
								}
								if(this.combatDebuffs.spd < 0){
									this.combatDebuffs.spd = 0;
								}
								if(this.combatDebuffs.def < 0){
									this.combatDebuffs.def = 0;
								}
								if(this.combatDebuffs.res < 0){
									this.combatDebuffs.res = 0;
								}
								roundText += this.name + " neutralizes penalties.<br>";
							}
							var etKey = Object.keys(this.ephase).filter(a => this.ephase[a] === true);
							etKey = etKey.filter(a => a !== "reverse");
							for(var i = 0; i < etKey.length; i++){
								if(this.penalty[etKey[i]] == true){
									this.penalty[etKey[i]] = false;
									roundText += this.name + " neutralizes selected [Penalty].<br>";
								}
							}
						}
						if(this.bonus.enGarde == false && !this.hasExactly("Shadow Breath")){
							roundText += enemy.splash(this,turn);
						}
						roundText += enemy.pulse(this,turn);
						roundText += enemy.wrath();
					}
					if(!this.penalty.fatal || this.bonus.nectar > 0){
						roundText += this.renewEP(turn);
					}
					roundText += enemy.feint(this,turn);
					//Quieting Antler buff booster
					if((enemy.hasExactly("Quieting Antler") || enemy.hasExactly("Delivering Antler")) && !enemy.penalty.panic && enemy.toggle.weapon == 1){
						if(enemy.combatBuffs.atk > 0){
							enemy.combatBuffs.atk = Math.min(enemy.combatBuffs.atk + 3, 10);
						}
						if(enemy.combatBuffs.spd > 0){
							enemy.combatBuffs.spd = Math.min(enemy.combatBuffs.spd + 3, 10);
						}
						if(enemy.combatBuffs.def > 0){
							enemy.combatBuffs.def = Math.min(enemy.combatBuffs.def + 3, 10);
						}
						if(enemy.combatBuffs.res > 0){
							enemy.combatBuffs.res = Math.min(enemy.combatBuffs.res + 3, 10);
						}
					}
				}
				else if(options.threatenRule=="Normal" && !enemy.penalty.fStart && !(this.hasExactly("Dream Deliverer") && (this.toggle.c == 1 || this.toggle.c == 3)) && this.support.dream == false){
					roundText += enemy.combined(this,turn);
				}
				//Remove Dream Deliverer from both sides
				this.support.dream = false;
				enemy.support.dream = false;
				//Divine Deceit Check
				if(((this.hasExactly("Divine Deceit") && this.toggle.c == 1)  || enemy.penalty.deceit) && Object.values(enemy.bonus).reduce((a, item) => a + (item === true ? 1 : 0), 0) + enemy.bonus.extra > 2){
					enemy.bonus = {"divineFang":false,"bDoubler":false,"nullArmor":false,"nullDragon":false,"nullFlying":false,"nullPanic":false,"autoD":false,"stopD":false,"dominance":false,"despacito":false,"vantage":false,"dodge":false,"nfus":false,"caff":false,"fStar":false,"dStar":false,"dull":false,"gStrat":false,"enGarde":false,"breathB":false,"treachery":false,"penDoubler":false,"starlight":false,"nPenalty":false,"resoB":false,"resoS":false,"triAtk":false,"bexblade":false,"spectrum":false,"extra":0,"incited":false,"fSight":false,"rotten":false,"essence":false,"nectar":0,"paranoia":false,"anathema":false,"fWitness":false,"dosage":false,"empathy":0,"divinely":0,"preempt":false,"pfollow":false,"sdiff":false,"dHex":false,"fEmblem":false};
					roundText += enemy.name + " is affected by Divine Deceit and all [Bonus] effects have been neutralized.<br>";
					enemy.penalty.deceit = false;
				}
				if(((enemy.hasExactly("Divine Deceit") && enemy.toggle.c == 1) || this.penalty.deceit) && Object.values(this.bonus).reduce((a, item) => a + (item === true ? 1 : 0), 0) + this.bonus.extra > 2){
					this.bonus = {"divineFang":false,"bDoubler":false,"nullArmor":false,"nullDragon":false,"nullFlying":false,"nullPanic":false,"autoD":false,"stopD":false,"dominance":false,"despacito":false,"vantage":false,"dodge":false,"nfus":false,"caff":false,"fStar":false,"dStar":false,"dull":false,"gStrat":false,"enGarde":false,"breathB":false,"treachery":false,"penDoubler":false,"starlight":false,"nPenalty":false,"resoB":false,"resoS":false,"triAtk":false,"bexblade":false,"spectrum":false,"extra":0,"incited":false,"fSight":false,"rotten":false,"essence":false,"nectar":0,"paranoia":false,"anathema":false,"fWitness":false,"dosage":false,"empathy":0,"divinely":0,"preempt":false,"pfollow":false,"sdiff":false,"dHex":false,"fEmblem":false};
					roundText += this.name + " is affected by Divine Deceit and all [Bonus] effects have been neutralized.<br>";
					this.penalty.deceit = false;
				}
				//Remove Panic if Null is active
				if(this.bonus.nullPanic){
					this.penalty.panic = false;
				}
				if(enemy.bonus.nullPanic){
					enemy.penalty.panic = false;
				}
				//Text alerts for status
				//Trilemma
				if(this.penalty.trilemma == true){
					roundText += this.name + " is affected by Trilemma debuff.<br>";
				}
				if(enemy.penalty.trilemma == true){
					roundText += enemy.name + " is affected by Trilemma debuff.<br>";
				}
				//Panic
				if(this.penalty.panic == true){
					roundText += this.name + " is affected by Panic.<br>";
				}
				if(enemy.penalty.panic == true){
					roundText += enemy.name + " is affected by Panic.<br>";
				}
				//Guard
				if(this.penalty.cdguard == true){
					roundText += this.name + " is affected by Guard.<br>";
				}
				if(enemy.penalty.cdguard == true){
					roundText += enemy.name + " is affected by Guard.<br>";
				}
				//Fatal
				if(this.penalty.fatal == true){
					roundText += this.name + " is affected by Deep Wounds.<br>";
				}
				if(enemy.penalty.fatal == true){
					roundText += enemy.name + " is affected by Deep Wounds.<br>";
				}
				//False Start
				if(this.penalty.fStart == true){
					roundText += this.name + " is affected by False Start.  All start of turn skills are disabled.<br>";
				}
				if(enemy.penalty.fStart == true){
					roundText += enemy.name + " is affected by False Start.  All start of turn skills are disabled.<br>";
				}
				//Exposure
				if(this.penalty.exposure == true){
					roundText += this.name + " is affected by Exposure and will take +10 Damage.<br>";
				}
				if(enemy.penalty.exposure == true){
					roundText += enemy.name + " is affected by Exposure and will take +10 Damage.<br>";
				}
				if(this.penalty.ploy == true){
					roundText += this.name + " is affected by Ploy and Bonus Doubler/Treachery/Grand Strategy have been neutralized.<br>";
				}
				if(enemy.penalty.ploy == true){
					roundText += enemy.name + " is affected by Ploy and Bonus Doubler/Treachery/Grand Strategy have been neutralized.<br>";
				}
				if(this.penalty.schism == true){
					roundText += this.name + " is affected by Schism and Triangle Attack/Dual Strike/Pathfinder have been neutralized.<br>";
				}
				if(enemy.penalty.schism == true){
					roundText += enemy.name + " is affected by Schism and Triangle Attack/Dual Strike/Pathfinder have been neutralized.<br>";
				}
				if(this.penalty.spoils == true){
					roundText += this.name + " is affected by Share Spoils.<br>";
				}
				if(enemy.penalty.spoils == true){
					roundText += enemy.name + " is affected by Share Spoils.<br>";
				}
				if(this.penalty.frozen == true){
					roundText += this.name + " is affected by Frozen.<br>";
				}
				if(enemy.penalty.frozen == true){
					roundText += enemy.name + " is affected by Frozen.<br>";
				}
				
				//Defense Tile
				if(this.dTile > 0){
					roundText += this.name + " is on a defense tile, boosting def/res by 0.3.<br>";
				}
				if(enemy.dTile > 0){
					roundText += enemy.name + " is on a defense tile, boosting def/res by 0.3.<br>";
				}
				//Infantry Rush
				if(this.support.infantryRush == true){
					roundText += this.name + " is affected by Infantry Rush 3.<br>";
				}
				if(enemy.support.infantryRush == true){
					roundText += enemy.name + " is affected by Infantry Rush 3.<br>";
				}
				//Infantry Flash
				if(this.support.infantryFlash == true){
					roundText += this.name + " is affected by Infantry Flash 3.<br>";
				}
				if(enemy.support.infantryFlash == true){
					roundText += enemy.name + " is affected by Infantry Flash 3.<br>";
				}
				//Infantry Breath
				if(this.support.infantryBreath == true){
					roundText += this.name + " is affected by CD +1 effect.<br>";
				}
				if(enemy.support.infantryBreath == true){
					roundText += enemy.name + " is affected by CD +1 effect.<br>";
				}
				//Divine Fang
				if(this.bonus.divineFang == true){
					roundText += this.name + " is affected by Divine Fang.<br>";
				}
				if(enemy.bonus.divineFang == true){
					roundText += enemy.name + " is affected by Divine Fang.<br>";
				}
				//Hexblade
				if(this.support.hexblade == true){
					roundText += this.name + " is affected by Hexblade.<br>";
				}
				if(enemy.support.hexblade == true){
					roundText += enemy.name + " is affected by Hexblade.<br>";
				}
				//Bonus Doubler
				if(this.bonus.bDoubler == true){
					roundText += this.name + " is affected by Bonus Doubler.<br>";
				}
				if(enemy.bonus.bDoubler == true){
					roundText += enemy.name + " is affected by Bonus Doubler.<br>";
				}
				//Debuff Doubler
				if(this.bonus.penDoubler == true){
					roundText += this.name + " is affected by Foe Penalty Doubler.<br>";
				}
				if(enemy.bonus.penDoubler == true){
					roundText += enemy.name + " is affected by Foe Penalty Doubler.<br>";
				}
				//Triangle Attack
				if(this.bonus.triAtk == true){
					roundText += this.name + " is affected by Triangle Attack/Dual Strike.<br>";
				}
				//Cancel Affinity
				if(this.bonus.caff == true){
					roundText += this.name + " is affected by Cancel Affinity.<br>";
				}
				if(enemy.bonus.caff == true){
					roundText += enemy.name + " is affected by Cancel Affinity.<br>";
				}
				//Tempo
				if(this.support.nullGuard == true){
					roundText += this.name + " is affected by Tempo.<br>";
				}
				if(enemy.support.nullGuard == true){
					roundText += enemy.name + " is affected by Tempo.<br>";
				}
				if(this.support.nullUGuard == true){
					roundText += this.name + " is affected by User Tempo.<br>";
				}
				if(enemy.support.nullUGuard == true){
					roundText += enemy.name + " is affected by User Tempo.<br>";
				}
				if(this.support.nullFGuard == true){
					roundText += enemy.name + " is affected by Foe Tempo.<br>";
				}
				if(enemy.support.nullFGuard == true){
					roundText += this.name + " is affected by Foe Tempo.<br>";
				}
				//Null Penalty
				if(this.support.nullPenalty == true){
					roundText += this.name + " is affected by Null Penalty.<br>";
				}
				if(enemy.support.nullPenalty == true){
					roundText += enemy.name + " is affected by Null Penalty.<br>";
				}
				//Ignore DR%
				if(this.support.ignore == true){
					roundText += this.name + " is affected by Ignore non-Special DR%.<br>";
				}
				if(enemy.support.ignore == true){
					roundText += enemy.name + " is affected by Ignore non-Special DR%.<br>";
				}
				//Check combat start special is ready
				if(enemy.specialIndex != -1 && data.skills[enemy.specialIndex].charge <= enemy.charge){
					eCharge = true;
				}
				if(this.specialIndex != -1 && data.skills[this.specialIndex].charge <= this.charge){
					tCharge = true;
				}				
				
				if(enemy.isFeuded(this)){
					enemy.support.infantryRush = false;
					enemy.support.infantryFlash = false;
					enemy.support.infantryBreath = false;
					enemy.support.hexblade = false;
					enemy.support.caduceus = 0;
					enemy.support.nullFU = false;
					enemy.support.nullOFU = false;
					enemy.support.nullGuard = false;
					enemy.support.nullUGuard = false;
					enemy.support.nullFGuard = false;
					enemy.support.nullPenalty = false;
					enemy.support.nullPenAtk = false;
					enemy.support.nullPenSpd = false;
					enemy.support.nullPenDef = false;
					enemy.support.nullPenRes = false;
					enemy.support.nullCD = false;
					enemy.support.everliving = false;
					enemy.support.achimenes = false;
					enemy.support.freikugel = false;
					enemy.support.revive = false;
					enemy.support.ignore = false;
					enemy.support.lullAtk = false;
					enemy.support.lullSpd = false;
					enemy.support.lullDef = false;
					enemy.support.lullRes = false;
					enemy.support.brAtk = false;
					enemy.support.dfu = 0;
					enemy.support.sGuard = false;
					enemy.support.bol = false;
					enemy.support.doi = 0;
					enemy.support.dof = 0;
					enemy.support.hg = 0;
					enemy.support.fellProtect = 0;
					enemy.support.fellSuccess = 0;
					enemy.support.hippity = 0;
					enemy.support.crux = 0;
					enemy.support.persp = 0;
					enemy.support.rdw = 0;
					enemy.support.rsd = 0;
					enemy.support.tPulse = 0;
					enemy.support.hini = 0;
					enemy.support.cnlove = 0;
					enemy.support.nlove = 0;
					enemy.support.diva = 0;
					enemy.support.trueDmg = 0;
					enemy.support.trueFirstDR = 0;
					enemy.support.sunper = 0;
					enemy.support.flutter = 0;
					enemy.support.baura = 0;
					enemy.support.devotion = false;
					enemy.support.petal = false;
					roundText += "All of " + enemy.name + "'s ally skills have been disabled.<br>";
				}
				if(this.isFeuded(enemy)){
					this.support.infantryRush = false;
					this.support.infantryFlash = false;
					this.support.infantryBreath = false;
					this.support.hexblade = false;
					this.support.caduceus = 0;
					this.support.nullFU = false;
					this.support.nullOFU = false;
					this.support.nullGuard = false;
					this.support.nullUGuard = false;
					this.support.nullFGuard = false;
					this.support.nullPenalty = false;
					this.support.nullPenAtk = false;
					this.support.nullPenSpd = false;
					this.support.nullPenDef = false;
					this.support.nullPenRes = false;
					this.support.nullCD = false;
					this.support.everliving = false;
					this.support.achimenes = false;
					this.support.freikugel = false;
					this.support.revive = false;
					this.support.ignore = false;
					this.support.lullAtk = false;
					this.support.lullSpd = false;
					this.support.lullDef = false;
					this.support.lullRes = false;
					this.support.brAtk = false;
					this.support.dfu = 0;
					this.support.sGuard = false;
					this.support.bol = false;
					this.support.doi = 0;
					this.support.dof = 0;
					this.support.hg = 0;
					this.support.fellProtect = 0;
					this.support.fellSuccess = 0;
					this.support.hippity = 0;
					this.support.crux = 0;
					this.support.persp = 0;
					this.support.rdw = 0;
					this.support.rsd = 0;
					this.support.tPulse = 0;
					this.support.hini = 0;
					this.support.cnlove = 0;
					this.support.nlove = 0;
					this.support.diva = 0;
					this.support.trueDmg = 0;
					this.support.trueFirstDR = 0;
					this.support.sunper = 0;
					this.support.flutter = 0;
					this.support.baura = 0;
					this.support.devotion = false;
					this.support.petal = false;
					roundText += "All of " + this.name + "'s ally skills have been disabled.<br>";
				}
			}
			
			//Do AOE damage.  Happens first before skills with hp reqs are calced
			if(!parity || !(enemy.hasExactly("Sentinel Bow") && this.range == "ranged")){
				roundText += this.doDamage(enemy,false,true,false,false,false,false,false,false,turn,eCharge,1,false,false);
			}
	
			//Set after renewal
			this.combatStartHp = this.hp;
			enemy.combatStartHp = enemy.hp;
			
			//Set fatal/null miracle status if Fatal Smoke is equipped, as it works during combat
			if(this.has("Fatal Smoke") || (this.hasExactly("Flamelick Breath") && this.combatStartHp/this.maxHp >= 0.25) || this.has("Serpentine Staff") || this.has("Incurable")){
				enemy.penalty.fatal = true;
				if(this.hasExactly("Fatal Smoke 4")){
					enemy.penalty.nullArise = true;
				}
			}
			if(enemy.has("Fatal Smoke") > 2|| (enemy.hasExactly("Flamelick Breath") && enemy.combatStartHp/enemy.maxHp >= 0.25) || enemy.has("Serpentine Staff") || enemy.has("Incurable")){
				this.penalty.fatal = true;
				if(enemy.hasExactly("Fatal Smoke 4")){
					this.penalty.nullArise = true;
				}
			}
			if(this.hasExactly("Black Yule Lance") && this.combatStartHp / this.maxHp >= 0.25 && (enemy.color == "red" || enemy.vein == 2)){
				enemy.penalty.nullArise = true;
			}
			if(enemy.hasExactly("Black Yule Lance") && enemy.combatStartHp / enemy.maxHp >= 0.25 && (this.color == "red" || this.vein == 2)){
				this.penalty.nullArise = true;
			}
			if(this.penalty.nullArise == true){
				roundText += this.name + " is affected by Null Miracle and all non-Special Miracle effects have been neutralized.<br>";
			}
			if(enemy.penalty.nullArise == true){
				roundText += enemy.name + " is affected by Null Miracle and all non-Special Miracle effects have been neutralized.<br>";
			}
			
			if(this.specialIndex != -1){
				this.combatStartCD = data.skills[this.specialIndex].charge - this.charge;
			}
			if(enemy.specialIndex != -1){
				enemy.combatStartCD = data.skills[enemy.specialIndex].charge - enemy.charge;
			}
			
			//Check combat effects
			this.combatSpur = {"atk":0,"spd":0,"def":0,"res":0};
			enemy.combatSpur = {"atk":0,"spd":0,"def":0,"res":0};
	
			roundText += this.startCombatSpur(enemy,turn,galecheck);
			roundText += enemy.startCombatSpur(this,turn,galecheck);
			var allStats = getEffStats(this, enemy, turn);
			var thisEffAtk = allStats[0];
			var enemyEffAtk = allStats[4];
			var thisEffSpd = allStats[1];
			var enemyEffSpd = allStats[5];
			var thisEffDef = allStats[2];
			var enemyEffDef = allStats[6];
			var thisEffRes = allStats[3];
			var enemyEffRes = allStats[7];
			var bladeCheck = allStats[8];
			var cleanCheck = allStats[9];
			roundText += allStats[10];			
			
			//Unrefined Guardian's Bow <- Goes after everything because IS screwed up and now you gotta check both in-combat stats and pre-combat stats
			var gbCheck = false;
			if(this.hasExactly("Guardian's Bow") && this.rValue < 0){
				if(thisEffSpd + this.getPhantom("Spd") > enemyEffSpd + enemy.getPhantom("Spd") || allStats[17] + this.getPhantom("Spd") > allStats[21] + enemy.getPhantom("Spd")){
					enemy.combatSpur.atk -= 5;
					enemy.combatSpur.spd -= 5;
					enemy.combatSpur.def -= 5;
					roundText += this.name + " has activated Guardian's Bow. Effect on " + enemy.name + ": -5 to atk/spd/def.<br>";
					gbCheck = true;
				}
			}
			if(enemy.hasExactly("Guardian's Bow") && enemy.rValue < 0 && !gbCheck){
				if(thisEffSpd + this.getPhantom("Spd") < enemyEffSpd + enemy.getPhantom("Spd") || allStats[17] + this.getPhantom("Spd") < allStats[21] + enemy.getPhantom("Spd")){
					this.combatSpur.atk -= 5;
					this.combatSpur.spd -= 5;
					this.combatSpur.def -= 5;
					roundText += enemy.name + " has activated Guardian's Bow. Effect on " + this.name + ": -5 to atk/spd/def.<br>";
				}
			}
	
			//check for any-distance counterattack
			var anyRangeCounter = false;
			if(enemy.has("Close Counter") || enemy.has("Distant Counter") || enemy.has("Raijinto") || enemy.has("Lightning Breath") || enemy.has("Ragnell") || enemy.hasExactly("Siegfried") || enemy.has("Gradivus") || enemy.has("Alondite") || enemy.hasExactly("Stout Tomahawk") || enemy.hasExactly("Leiptr") || enemy.hasExactly("Expiration") || enemy.has("Ostian Counter") || enemy.hasExactly("Divine Mist") || (enemy.hasExactly("Naga") && enemy.rValue == 5 && this.weaponType == "dragon") || enemy.hasExactly("Dragonbind") || enemy.hasExactly("Razing Breath") || enemy.hasExactly("Sublime Surge") || enemy.hasExactly("Ragnell-Alondite") || (enemy.hasExactly("Double Bow") && (enemy.buddy.adjacent == 0 || (enemy.rValue > 0 && enemy.buddy.adjacent < 2))) || enemy.hasExactly("Moonless Breath") || enemy.hasExactly("Nightmare Horn") || enemy.hasExactly("Purifying Breath") || (enemy.hasExactly("Inscribed Tome") && enemy.rValue == 5 && (this.weaponType == "sword" || this.weaponType == "lance" || this.weaponType == "axe" || this.weaponType == "beast")) || (enemy.hasExactly("Vouge") && (enemy.combatStartHp/enemy.maxHp >= 0.5 || (enemy.rValue > 0 && enemy.combatStartHp/enemy.maxHp >= 0.25))) || (enemy.hasExactly("Amatsu") && ((enemy.rValue < 0 && enemy.combatStartHp/enemy.maxHp >= 0.5) || (enemy.rValue > 0 && enemy.combatStartHp/enemy.maxHp >= 0.25))) || enemy.hasExactly("Distant Pressure") || enemy.hasExactly("Close Reversal") || enemy.hasExactly("Eerie Scripture") || enemy.hasExactly("Nifl's Bite") || enemy.hasExactly("Distant Stance") || enemy.hasExactly("Carnage Amatsu") || enemy.hasExactly("Close Salvo") || enemy.hasExactly("Distant Storm") || enemy.hasExactly("Distant Dart") || enemy.hasExactly("Dist Counter (D)") || enemy.hasExactly("Dist Counter (M)") || (enemy.hasExactly("Virtuous Naga") && enemy.rValue == 5 && enemy.toggle.weapon == 1 && this.weaponType == "dragon") || enemy.hasExactly("Distant Ferocity") || enemy.hasExactly("Distant Reversal") || enemy.hasExactly("Ostia's Heart") || enemy.hasExactly("Distant AS Solo") || enemy.hasExactly("Distant DR Solo") || enemy.hasExactly("Wyvern Hatchet") || (enemy.hasExactly("Frostbite Mirror") && eCharge == true) || enemy.hasExactly("Realms United") || enemy.hasExactly("Holy Yule Blade") || ((enemy.hasExactly("Atk Spd Prime 4") || enemy.hasExactly("Atk Def Prime 4") || enemy.hasExactly("Spd Def Prime 4")) && Object.values(enemy.bonus).reduce((a, item) => a + (item === true ? 1 : 0), 0) + enemy.bonus.extra > 3) || enemy.hasExactly("Arcadian Axes") || enemy.hasExactly("Loving Breath") || enemy.hasExactly("Emblems' Miracle") || enemy.hasExactly("D Bonus Doubler") || enemy.hasExactly("C Bonus Doubler") || enemy.hasExactly("Hoshido's Breath") || (enemy.hasExactly("Obsidian Tactics") && enemy.toggle.a > 2) || enemy.hasExactly("Breezy Spear") || enemy.hasExactly("New Levin Sword") || (enemy.hasExactly("Fortifications") && enemy.toggle.a == 1) || (enemy.hasExactly("Remote Breath") && enemy.rValue == 5) || enemy.hasExactly("Dual Ice Mirrors") || enemy.hasExactly("Desert Spear") || enemy.hasExactly("Opposing Stones") || enemy.hasExactly("D Counter Echo") || enemy.hasExactly("Spear") || (enemy.hasExactly("Joker's Wild") && enemy.rValue > 0) || enemy.hasExactly("The Fire Emblem") || enemy.anyCounter){
				anyRangeCounter = true;
			}
	
			//check for vantage before beginning combat
			var vantage = false;
			if(enemy.bonus.vantage || (enemy.bonus.paranoia && enemy.combatStartHp / enemy.maxHp < 1 && (enemy.range == this.range || Object.values(this.penalty).reduce((a, item) => a + (item === true ? 1 : 0), 0) + this.penalty.extra >= 3) && !(((enemy.has("Near Save") || enemy.has("Twin N Save") || enemy.hasExactly("Lower Ground")) && enemy.toggle.c == 1 && this.range == "melee") || ((((enemy.has("Far Save") || enemy.has("Twin F Save") || enemy.hasExactly("With Everyone 2") || enemy.hasExactly("Woeful Upheaval") || enemy.hasExactly("Higher Ground")) && enemy.toggle.c == 1) || (enemy.hasExactly("Darkling Dragon") && enemy.toggle.c > 1)) && this.range == "ranged")))){
				vantage = true;
			}
			if(enemy.has("Vantage")){
				if(enemy.hp/enemy.maxHp <= .25 * enemy.has("Vantage")){
					vantage = true;
				}
			}
			else if(enemy.has("Spd Preempt")){
				var spdCoeff = (enemy.has("Spd Preempt") * -2) + 7;
				if(this.range == "ranged" && enemyEffSpd + enemy.getPhantom("Spd") >= thisEffSpd + this.getPhantom("Spd") + spdCoeff){
					vantage = true;
				}
			}
			else if(enemy.hasExactly("Shield of Hope") && enemy.toggle.b > 1){
				vantage = true;
			}
			
			if((this.hasExactly("Sunlight Bangle") && this.toggle.b > 0) || (this.hasExactly("Sunlit Bangle D") && this.combatStartHp / this.maxHp >= 0.25)){
				vantage = true;
			}
			
			if((this.moveType == "cavalry" || this.moveType == "armored") && enemy.has("Faithful Loyalty")){
				vantage = true;
			}
			else if(this.combatStartHp / this.maxHp < 1 && enemy.hasExactly("Athame")){
				vantage = true;
			}
			else if(enemy.hp/enemy.maxHp <= 0.75 && enemy.hasExactly("Rapier")){
				vantage = true;
			}
			else if(enemy.hasExactly("Feather Sword") && ((this.weaponType == "sword" || this.weaponType == "lance" || this.weaponType == "axe" || (this.weaponType == "bow" && this.color == "gray") || this.moveType == "armored") || enemy.hp/enemy.maxHp <= .75 || (enemy.rValue > 0 && enemy.hp/enemy.maxHp <= .9))){
				vantage = true;
			}
			else if(enemy.hasExactly("Genesis Falchion") && (enemy.buddy.adjacent > 0 || enemy.buddy.two > 0) && enemy.toggle.weapon == 3){
				vantage = true;
			}
			else if(enemy.hasExactly("Flowery Scroll") && enemyEffRes + enemy.getPhantom("Res") > thisEffRes + this.getPhantom("Res")){
				vantage = true;
			}
			else if(enemy.hasExactly("Tanngrisnir") && enemy.rValue == 5 && enemy.toggle.weapon > 1 && this.range == "ranged" && enemyEffSpd + enemy.getPhantom("Spd") > thisEffSpd + this.getPhantom("Spd")){
				vantage = true;
				enemyVFirst = true;
			}
			else if(enemy.hasExactly("Captain's Sword") && enemy.hp/enemy.maxHp >= 0.25 && enemyEffSpd + enemy.getPhantom("Spd") > thisEffSpd + this.getPhantom("Spd")){
				vantage = true;
			}
			else if(enemy.hp/enemy.maxHp <= 0.8 && enemy.hasExactly("Brilliant Rapier")){
				vantage = true;
			}
			else if(enemy.hasExactly("Moonlit Bangle Q") && enemyEffSpd + enemy.getPhantom("Spd") >= thisEffSpd + this.getPhantom("Spd") - 4){
				vantage = true;
			}
			else if(enemy.hasExactly("Blessed Aureola") && enemy.buddy.rorc > 0 && (this.weaponType == "redtome" || this.weaponType == "bluetome" || this.weaponType == "greentome" || this.weaponType == "graytome")){
				vantage = true;
			}
			
			if(this.hasExactly("Great Aether")){
				vantage = true;
				enemyVFirst = true;
			}
			
	
			//check for desperation before beginning combat
			var desperation = false;
			if(this.bonus.despacito || (this.bonus.paranoia && this.combatStartHp / this.maxHp < 1) || (this.hasCaptain("Flash of Steel") && this.toggle.sd == 0)){
				desperation = true;
			}
			if(this.hasExactly("Trample")){
				desperation = true;
			}
			if(this.has("Desperation") && !this.hasExactly("Flow Desperation")){
				if(this.hasSlot("Desperation","b") == 4 && (this.combatStartHp / this.maxHp < 1 || this.toggle.b == 1)){
					desperation = true;
				}
				else if(this.hp/this.maxHp <= .25 * this.hasSlot("Desperation","b") && this.hasSlot("Desperation","b") != 4){
					desperation = true;
				}
				if(this.hp/this.maxHp <= .25 * this.hasSlot("Desperation","s")){
					desperation = true;
				}
			}
			else if(this.has("Killing Intent") && (enemy.combatStartHp / enemy.maxHp < 1 || this.toggle.b > 0)){
				desperation = true;
			}
			else if(this.has("Daring Fighter")){
				if(this.hp/this.maxHp <= .2 * this.has("Daring Fighter") + .2){
					desperation = true;
				}
			}
			else if((this.hasExactly("Soul of Zofia") && this.hp/this.maxHp <= .75) || this.hasExactly("Soul of Zofia 2")){
				desperation = true;
			}
			else if(this.has("Dive-Bomb")){
				if(this.combatStartHp/this.maxHp >= 1 - 0.1 * ((this.has("Dive-Bomb") - 1)) && enemy.combatStartHp/enemy.maxHp >= 1 - 0.1 * ((this.has("Dive-Bomb") - 1))){
					desperation = true;
				}
			}
			else if(this.has("Frenzy")){
				if(this.hp/this.maxHp <= .2 * this.has("Frenzy") - .1){
					desperation = true;
				}
			}
			else if((this.has("Yngvi Ascendant") || this.hasExactly("Hodr's Zeal") || this.hasExactly("Enclosing Dark")) && this.initiator){
				desperation = true;
			}
			else if(this.hasExactly("Flow Desperation") && (this.combatStartHp / this.maxHp <= 0.75 || this.toggle.b == 1)){
				desperation = true;
			}
			else if(this.hasExactly("Aerial Maneuvers") && this.combatStartHp / this.maxHp >= 0.5 && enemy.combatStartHp / enemy.maxHp >= 0.5){
				desperation = true;
			}
			if(this.hasExactly("Active Lookout")){
				desperation = true;
			}
			if(this.has("Sol Katti")){
				if(this.rValue > 0 && this.hp/this.maxHp <= .75){
					desperation = true;
				}
				else if(this.hp/this.maxHp <= .5){
					desperation = true;
				}
			}
			else if((this.has("Starfish") || this.has("Fishie Bow") || this.has("Juicy Wave") || (this.hasExactly("Concealed Blade") && this.rValue == 5)) && this.hp/this.maxHp <= .75){
				desperation = true;
			}
			else if((this.hasExactly("Worldsea Wave") || this.hasExactly("Shadow Sword") || this.hasExactly("Forseti")) && this.rValue > 0 && this.initiator && this.hp/this.maxHp >= .25){
				desperation = true;
			}
			else if((this.hasExactly("Forseti") || this.hasExactly("Shadow Sword") || this.hasExactly("Worldsea Wave")) && this.initiator && this.hp/this.maxHp >= .5){
				desperation = true;
			}
			else if(this.hasExactly("Mirage Feather") && this.toggle.weapon == 1){
				desperation = true;
			}
			else if(this.hasExactly("Persecution Bow") && (this.combatStartHp / this.maxHp < 1 || Object.values(this.penalty).reduce((a, item) => a + (item === true ? 1 : 0), 0) + this.penalty.extra > 0)){
				desperation = true;
			}
			else if(this.hasExactly("Dark Spikes T") && this.hp / this.maxHp < 1 && this.initiator){
				desperation = true;
			}
			else if((this.hasExactly("Talregan Axe") || this.hasExactly("Caring Magic") || this.hasExactly("Scroll of Curses")) && this.initiator){
				desperation = true;
			}
			else if(this.hasExactly("Thunderbrand") && enemy.combatStartHp / enemy.maxHp >= 0.5 && this.initiator){
				desperation = true;
			}
			else if(this.hasExactly("Crossbones Claw") && this.toggle.weapon == 1 && this.initiator && this.transform == true){
				desperation = true;
			}
			else if(this.hasExactly("New Dawn") && this.initiator && ((this.rValue < 0 && this.combatStartHp / this.maxHp <= 0.5) || this.rValue > 0)){
				desperation = true;
			}
			else if((this.hasExactly("Keen Coyote Bow") || this.hasExactly("Arcane Darkbow") || this.hasExactly("Hero-King Sword")) && this.combatStartHp / this.maxHp >= 0.25 && this.initiator){
				desperation = true;
			}
			else if(this.hasExactly("Sweet Yule Log") && this.combatStartHp / this.maxHp >= 0.25 && this.initiator && thisEffSpd+this.getPhantom("Spd")-enemyEffSpd-enemy.getPhantom("Spd") <= 9){
				desperation = true;
			}
			else if(this.hasExactly("Bow of Verdane") && this.rValue == 5 && this.combatStartHp / this.maxHp >= 0.25 && this.initiator && thisEffSpd + this.getPhantom("Spd") - enemyEffSpd - enemy.getPhantom("Spd") >= 7){
				desperation = true;
			}
			if(enemy.hasExactly("Urvan") && enemy.rValue == 5 && this.initiator){
				desperation = true;
			}
			if(enemy.hasExactly("Gift of Magic") && this.range == "ranged" && this.initiator){//follow up check unneeded since desperation does nothing anyway if no follow up
				desperation = true;
			}
			if(this.initiator && enemy.hasExactly("Holy War's End") && enemy.hp / enemy.maxHp >= .5){
				enemyFirst = true;
			}
			if((enemy.hasExactly("Hero-King Sword") && enemy.combatStartHp / enemy.maxHp >= 0.25) || (enemy.hasExactly("Shield of Hope") && enemy.toggle.b == 4)){
				if(vantage){
					enemyVFirst = true;
				}
				else{
					enemyFirst = true;
				}
			}
			if(enemy.hasExactly("Great Aether")){
				desperation = true;
			}
			
			//check for hardy bearing
			if(this.has("Hardy Bearing") || this.has("Dusk Uchiwa") || this.has("Cloud Maiougi") || this.has("Sky Maiougi") || this.hasExactly("Dawn Suzu") || this.has("Dragonslasher") || this.has("Caltrop Dagger") || this.has("Armorpin Dagger") || (this.hasExactly("Studied Forblaze") && this.combatStartHp / this.maxHp >= 0.25) || this.hasExactly("Thief's Honesty") || this.hasExactly("Gift for Magic") || (this.hasExactly("Ancient Voice") && this.buddy.adjacent + this.buddy.two + this.buddy.three > 0 && thisEffDef >= enemyEffDef + 5)){
				var bearing = this.has("Hardy Bearing");
				desperation = false;
				if(bearing == 1 && this.hp == this.maxHp){
					vantage = false;
					enemyFirst = false;
					enemyVFirst = false;
				}
				else if(bearing == 2 && this.hp >= this.maxHp/2){
					vantage = false;
					enemyFirst = false;
					enemyVFirst = false;
				}
				else if(bearing == 3 || this.has("Dusk Uchiwa") || this.has("Cloud Maiougi") || this.has("Sky Maiougi") || this.hasExactly("Dawn Suzu") || this.has("Dragonslasher") || this.has("Caltrop Dagger") || this.has("Armorpin Dagger") || (this.hasExactly("Studied Forblaze") && this.combatStartHp / this.maxHp >= 0.25) || this.hasExactly("Thief's Honesty") || this.hasExactly("Gift for Magic") || (this.hasExactly("Ancient Voice") && this.buddy.adjacent + this.buddy.two + this.buddy.three > 0 && thisEffDef >= enemyEffDef + 5)){
					vantage = false;
					enemyFirst = false;
					enemyVFirst = false;
				}
			}
			if(parity || enemy.has("Hardy Bearing") || enemy.has("Dusk Uchiwa") || enemy.has("Cloud Maiougi") || enemy.has("Sky Maiougi") || enemy.hasExactly("Dawn Suzu") || enemy.has("Dragonslasher") || enemy.has("Caltrop Dagger") || enemy.has("Armorpin Dagger") || (enemy.hasExactly("Studied Forblaze") && enemy.combatStartHp / enemy.maxHp >= 0.25) || enemy.hasExactly("Thief's Honesty") || enemy.hasExactly("Gift for Magic") || (enemy.hasExactly("Ancient Voice") && enemy.buddy.adjacent + enemy.buddy.two + enemy.buddy.three > 0 && enemyEffDef >= thisEffDef + 5)){
				var bearing = enemy.has("Hardy Bearing");
				vantage = false;
				enemyFirst = false;
				enemyVFirst = false;
				if(bearing == 1 && enemy.hp == enemy.maxHp){
					desperation = false;	
				}
				else if(bearing == 2 && enemy.hp >= enemy.maxHp/2){
					desperation = false;	
				}
				else if(parity || bearing == 3 || enemy.has("Dusk Uchiwa") || enemy.has("Cloud Maiougi") || enemy.has("Sky Maiougi") || enemy.hasExactly("Dawn Suzu") || enemy.has("Dragonslasher") || enemy.has("Caltrop Dagger") || enemy.has("Armorpin Dagger") || (enemy.hasExactly("Studied Forblaze") && enemy.combatStartHp / enemy.maxHp >= 0.25) || enemy.hasExactly("Thief's Honesty") || enemy.hasExactly("Gift for Magic") || (enemy.hasExactly("Ancient Voice") && enemy.buddy.adjacent + enemy.buddy.two + enemy.buddy.three > 0 && enemyEffDef >= thisEffDef + 5)){
					desperation = false;	
				}
			}
			
			//Variables to determine whether this/enemy auto follow or get prevented from follow up
			var preventEnemyFollow = 0;
			var preventThisFollow = 0;
			var enemyAutoFollow = 0;
			var thisAutoFollow = 0;
						
			//Check for Deny Follow-Up status
			if(this.bonus.stopD == true){
				preventEnemyFollow++;
			}
			if(enemy.bonus.stopD == true){
				preventThisFollow++;
			}
			//Check for Auto Follow-Up status (only when initiating)
			if(this.bonus.autoD == true){
				thisAutoFollow++;
			}
			//Support dfu
			if(this.support.dfu > 0){
				preventEnemyFollow += this.support.dfu;
			}
			if(enemy.support.dfu > 0){
				preventThisFollow += enemy.support.dfu;
			}
			//Crux
			if(this.support.crux > 0){
				for(var i = 0; i < this.support.crux; i++){
					thisAutoFollow++;
				}
			}
			if(enemy.support.crux > 0){
				for(var i = 0; i < enemy.support.crux; i++){
					enemyAutoFollow++;
				}
			}
	
			//Check for quick riposte
			//Each instance of QR stacks			
			//EP B Slot
			if(enemy.bIndex > -1){
				if(data.skills[enemy.bIndex].name.indexOf("Quick Riposte") != -1){
					if(enemy.hasExactly("Quick Riposte 4") && enemy.combatStartHp / enemy.maxHp >= 0.25){
						enemyAutoFollow++;
					}
					else if(enemy.hp/enemy.maxHp >= 1 - 0.1 * data.skills[enemy.bIndex].name.slice(-1)){
						enemyAutoFollow++;
					}
				}
				else if(enemy.has("Vengeful Fighter")){
					if(enemy.hasExactly("Vengeful Fighter 4") && enemy.hp/enemy.maxHp >= 0.25){
						enemyAutoFollow++;
						preventThisFollow++;
					}
					else if(enemy.hp/enemy.maxHp >= 1.1 - 0.2 * enemy.has("Vengeful Fighter")){
						enemyAutoFollow++;
					}
				}
				else if(enemy.has("Crafty Fighter")){
					if(enemy.hp/enemy.maxHp >= 1 - 0.25 * enemy.has("Crafty Fighter")){
						enemyAutoFollow++;
					}
				}
				else if(this.initiator && enemy.hasExactly("Holy War's End") && enemy.hp / enemy.maxHp >= .5){
					enemyAutoFollow++;
				}
				else if(enemy.hasExactly("Blue Lion Rule") && enemyEffDef > thisEffDef){
					enemyAutoFollow++;
				}
				else if(enemy.has("Dragon's Ire")){
					if(enemy.hp/enemy.maxHp >= 1.25 - 0.25 * enemy.has("Dragon's Ire")){
						enemyAutoFollow++;
					}
				}
				else if(enemy.hasExactly("Slick Fighter 4") || enemy.hasExactly("Wily Fighter 4")){
					enemyAutoFollow++;
				}
				else if(enemy.hasSlot("Slick Fighter","b")){
					if(enemy.hp/enemy.maxHp >= 1 - 0.25 * enemy.hasSlot("Slick Fighter","b")){
						enemyAutoFollow++;
					}
				}
				else if(enemy.hasSlot("Wily Fighter","b")){
					if(enemy.hp/enemy.maxHp >= 1 - 0.25 * enemy.hasSlot("Wily Fighter","b")){
						enemyAutoFollow++;
					}
				}
			}
			//EP S Slot
			if(enemy.sIndex > -1){
				if(data.skills[enemy.sIndex].name.indexOf("Quick Riposte") != -1){
					if(enemy.hp/enemy.maxHp >= 1 - 0.1 * data.skills[enemy.sIndex].name.slice(-1)){
						enemyAutoFollow++;
					}
				}
				else if(enemy.hasSlot("Wily Fighter","s")){
					if(enemy.hp/enemy.maxHp >= 1 - 0.25 * enemy.hasSlot("Wily Fighter","s")){
						enemyAutoFollow++;
					}
				}
				else if(enemy.hasSlot("Slick Fighter","s")){
					if(enemy.hp/enemy.maxHp >= 1 - 0.25 * enemy.hasSlot("Slick Fighter","s")){
						enemyAutoFollow++;
					}
				}
			}
			//Weapon Slot
			if(enemy.hasExactly("Armads") && enemy.hp/enemy.maxHp >= .8){
				enemyAutoFollow++;
			}
			if((enemy.hasExactly("Binding Blade") || enemy.hasExactly("Bow of Devotion")) && enemy.rValue == 5 && enemy.hp/enemy.maxHp >= .5){
				enemyAutoFollow++;
			}
			if(enemy.hasExactly("Maltet")){
				if(enemy.rValue < 0 && enemy.hp/enemy.maxHp >= .5){
					enemyAutoFollow++;
				}
				else if(enemy.rValue > 0 && enemy.hp/enemy.maxHp >= .25){
					enemyAutoFollow++;
				}
			}
			if((enemy.hasExactly("Maltet") || enemy.hasExactly("Obsidian Lance")) && enemy.rValue == 5){
				preventThisFollow++;
			}
			if(((this.hasExactly("Maltet") && enemy.combatStartHp / enemy.maxHp == 1) || this.hasExactly("Obsidian Lance")) && this.rValue == 5){
				preventEnemyFollow++;
			}
			//Check for Follow-Up Ring
			if(this.has("Follow-Up Ring") && this.hp/this.maxHp >= .5){
				thisAutoFollow++;
			}
			if(enemy.has("Follow-Up Ring") && enemy.hp/enemy.maxHp >= .5){
				enemyAutoFollow++;
			}
			//Siegmund's refined ability
			if(this.initiator && this.hasExactly("Siegmund") && this.rValue == 5 && this.hp/this.maxHp >= 0.9){
				thisAutoFollow++;
			}
			if(this.initiator && this.hasSlot("Bold Fighter","b")){
				if(this.hp / this.maxHp >= 1.5 + this.hasSlot("Bold Fighter","b") * -0.5){
					thisAutoFollow++;
				}
			}
			if(this.initiator && this.hasSlot("Bold Fighter","s")){
				if(this.hp / this.maxHp >= 1.5 + this.hasSlot("Bold Fighter","s") * -0.5){
					thisAutoFollow++;
				}
			}
			//Weapons that double with toggle trigger
			if(((this.hasExactly("Flame Siegmund") && this.rValue < 0) || this.hasExactly("Garm") || this.hasExactly("Sokkvabekkr") || this.hasExactly("Thjalfi") || this.hasExactly("Spirit Forest Writ") || (this.hasExactly("Virtuous Naga") && this.rValue == 5) || this.hasExactly("Duality Vessel") || this.hasExactly("Dreaming Spear") || (this.hasExactly("Pupil's Tome") && this.rValue == 5) || this.hasExactly("Sparkling Sun")) && this.toggle.weapon == 1){
				thisAutoFollow++;
			}
			if(((enemy.hasExactly("Flame Siegmund") && enemy.rValue < 0) || enemy.hasExactly("Garm")|| enemy.hasExactly("Sokkvabekkr") || enemy.hasExactly("Thjalfi") || enemy.hasExactly("Spirit Forest Writ") || (enemy.hasExactly("Virtuous Naga") && enemy.rValue == 5) || enemy.hasExactly("Duality Vessel") || enemy.hasExactly("Dreaming Spear") || (enemy.hasExactly("Pupil's Tome") && enemy.rValue == 5) || enemy.hasExactly("Sparkling Sun")) && enemy.toggle.weapon == 1){
				enemyAutoFollow++;
			}
			//Spirit Breath
			if(this.initiator && this.hasExactly("Spirit Breath") && this.rValue < 0 && thisEffDef - enemyEffDef >= 5){
				thisAutoFollow++;
			}
			//Gjoll
			if(this.hasExactly("Gjoll") && (this.toggle.weapon == 1 || this.toggle.weapon == 3)){
				thisAutoFollow++;
				preventEnemyFollow++;
			}
			if(enemy.hasExactly("Gjoll") && (enemy.toggle.weapon == 1 || enemy.toggle.weapon == 3)){
				enemyAutoFollow++;
				preventThisFollow++;
			}
			//Skills that prevent double when initiated
			if(this.initiator && (this.hasExactly("Sturdy Impact") || this.hasExactly("Mirror Impact") || this.hasExactly("Steady Impact") || this.hasExactly("Swift Impact") || ((this.hasExactly("Blazing Durandal") || this.hasExactly("Hewn Lance") || this.hasExactly("Meisterschwert")) && this.rValue == 5))){
				preventEnemyFollow++;
			}
			//Hawk King Claw
			if(this.hasExactly("Hawk King Claw") && ((this.rValue < 0 && enemy.hp/enemy.maxHp == 1 && this.initiator) || (this.rValue > 0 && (this.transform == true || enemy.hp/enemy.maxHp >= 0.75)))){
				thisAutoFollow++;
			}
			if(this.hasExactly("Fell Breath") && (enemy.hp/enemy.maxHp < 1 || (this.rValue > 0 && allStats[16] > allStats[20]))){
				preventEnemyFollow++;
			}
			if(enemy.hasExactly("Fell Breath") && (this.hp/this.maxHp < 1 || (enemy.rValue > 0 && allStats[20] > allStats[16]))){
				preventThisFollow++;
			}
			//Cavalry Beast Weapon
			if(this.moveType == "cavalry" && this.weaponType == "beast" && this.transform == true && this.initiator && data.skills[this.weaponIndex].skill_id < 3667){
				preventEnemyFollow++;
			}			
			//Kriemhild
			if(enemy.hasExactly("Kriemhild") && enemy.toggle.weapon == 1 && ((enemy.rValue < 0 && this.range == "ranged") || enemy.rValue > 0)){
				preventThisFollow++;
			}
			if(this.hasExactly("Mirage Axe") && (this.buddy.adjacent > 0 || this.buddy.two > 0 || (this.rValue > 0 && this.buddy.three > 0))){
				preventEnemyFollow++;
			}
			if(enemy.hasExactly("Mirage Axe") && (enemy.buddy.adjacent > 0 || enemy.buddy.two > 0 || (enemy.rValue > 0 && enemy.buddy.three > 0))){
				preventThisFollow++;
			}
			//Scythe of Sariel
			if(this.hasExactly("Scythe of Sariel") && (this.toggle.weapon == 1 || checkAllBuffs(enemy, this, turn) || (this.rValue > 0 && enemy.combatStartHp / enemy.maxHp >= 0.75))){
				preventEnemyFollow++;
			}
			if(enemy.hasExactly("Scythe of Sariel") && (enemy.toggle.weapon == 1 || checkAllBuffs(this, enemy, turn) || (enemy.rValue > 0 && this.combatStartHp / this.maxHp >= 0.75))){
				preventThisFollow++;
			}
			if(this.hasExactly("Noble Lance") && ((this.rValue < 0 && ((enemy.combatStartHp/enemy.maxHp == 1 && this.combatStartHp/this.maxHp == 1) || (enemy.combatStartHp/enemy.maxHp < 1 && this.combatStartHp/this.maxHp < 1))) || (this.rValue > 0 && (this.combatStartHp/this.maxHp < 1 || enemy.combatStartHp/enemy.maxHp >= 0.75)))){
				thisAutoFollow++;
			}
			if(enemy.hasExactly("Noble Lance") && ((enemy.rValue < 0 && ((enemy.combatStartHp/enemy.maxHp == 1 && this.combatStartHp/this.maxHp == 1) || (enemy.combatStartHp/enemy.maxHp < 1 && this.combatStartHp/this.maxHp < 1))) || (enemy.rValue > 0 && (enemy.combatStartHp/enemy.maxHp < 1 || this.combatStartHp/this.maxHp >= 0.75)))){
				enemyAutoFollow++;
			}
			//Meisterbogen
			if(this.initiator && this.hasExactly("Meisterbogen") && this.challenger){
				preventEnemyFollow++;
			}
			//Imbued Koma
			if(this.specialIndex != -1 && data.skills[this.specialIndex].charge <= this.charge && this.hasExactly("Imbued Koma")){
				preventEnemyFollow++;
			}
			if(enemy.specialIndex != -1 && data.skills[enemy.specialIndex].charge <= enemy.charge && enemy.hasExactly("Imbued Koma")){
				preventThisFollow++;
			}
			//Budding Bow/Melee Bouquet/Instant Lance
			if((this.has("Budding Bow") || this.has("Melee Bouquet") || this.has("Instant Lance") || this.has("Instant Axe") || this.has("Instant Bow") || this.has("Instant Sword")) && this.initiator){
				preventEnemyFollow++;
			}
			//Thorn Lance
			if(this.hasExactly("Thorn Lance") && (allStats[16] > allStats[20] || (this.rValue > 0 && this.combatStartHp / this.maxHp >= 0.25))){
				preventEnemyFollow++;
			}
			if(enemy.hasExactly("Thorn Lance") && (allStats[20] > allStats[16] || (enemy.rValue > 0 && enemy.combatStartHp / enemy.maxHp >= 0.25))){
				preventThisFollow++;
			}
			//Zephyr Breath
			if(this.hasExactly("Zephyr Breath") && (this.toggle.weapon == 1 || checkAllBuffs(this, enemy, turn))){
				preventEnemyFollow++;
			}
			if(enemy.hasExactly("Zephyr Breath") && (enemy.toggle.weapon == 1 || checkAllBuffs(enemy, this, turn))){
				preventThisFollow++;
			}
			//Void Tome
			if(this.hasExactly("Void Tome") && (allStats[21] >= 35 || this.toggle.weapon == 1 || this.toggle.weapon == 3)){
				thisAutoFollow++;
			}
			if(enemy.hasExactly("Void Tome") && (allStats[17] >= 35 || enemy.toggle.weapon == 1 || enemy.toggle.weapon == 3)){
				enemyAutoFollow++;
			}
			if(this.hasExactly("Whitedown Spear") && ((this.rValue < 0 && this.initiator && (this.toggle.weapon == 1 || this.toggle.weapon == 3)) || (this.rValue > 0 && (this.initiator || this.buddy.adjacent > 0 || this.buddy.two > 0 || this.buddy.three > 0)))){
				thisAutoFollow++;
			}
			//Raging Storm
			if(this.hasExactly("Raging Storm") && this.toggle.b == 1 && (enemy.weaponType == "dragon" || enemy.weaponType == "beast")){
				thisAutoFollow++;
			}
			if(enemy.hasExactly("Raging Storm") && enemy.toggle.b == 1 && (this.weaponType == "dragon" || this.weaponType == "beast")){
				enemyAutoFollow++;
			}
			//Refined Bow of Beauty
			if(this.initiator && this.hasExactly("Bow of Beauty") && this.rValue == 5 && this.hp / this.maxHp >= .5){
				preventEnemyFollow++;
			}
			if(this.hasExactly("Dark Scripture") && ((this.rValue < 0 && this.buddy.adjacent == 0 && enemy.dragonEff(this) == false) || (this.rValue > 0 && (!this.initiator || this.buddy.adjacent == 0)))){
				thisAutoFollow++;
			}
			if(enemy.hasExactly("Dark Scripture") && ((enemy.rValue < 0 && enemy.buddy.adjacent == 0 && this.dragonEff(enemy) == false) || (enemy.rValue > 0 && (this.initiator || enemy.buddy.adjacent == 0)))){
				enemyAutoFollow++;
			}
			if(this.hasExactly("Joyful Vows") && (this.checkBonPen(1,enemy,turn) || (this.rValue > 0 && enemy.checkBonPen(3,this,turn)))){
				if(this.rValue < 0 && this.initiator){
					preventEnemyFollow++;
				}
				else if(this.rValue > 0){
					preventEnemyFollow++;
					thisAutoFollow++;
				}
			}
			if(enemy.hasExactly("Joyful Vows") && enemy.rValue > 0 && (enemy.checkBonPen(1,this,turn) || this.checkBonPen(3,enemy,turn))){
				preventThisFollow++;
				enemyAutoFollow++;
			}
			//Dark Spikes T
			if(this.hasExactly("Dark Spikes T") && this.hp / this.maxHp < 1 && this.initiator){
				thisAutoFollow++;
			}
			if(this.hasExactly("Black Eagle Rule") && this.hp/this.maxHp >= 0.25){
				thisAutoFollow++;
			}
			if(enemy.hasExactly("Black Eagle Rule") && enemy.hp/enemy.maxHp >= 0.25){
				enemyAutoFollow++;
			}
			//Special Refined with Enemy HP >= 50%
			if((this.hasExactly("Divine Tyrfing") || (this.has("Bunny Fang") && this.transform == true)) && this.rValue == 5 && enemy.combatStartHp / enemy.maxHp >= 0.5){
				thisAutoFollow++;
			}
			if((enemy.hasExactly("Divine Tyrfing") || (enemy.has("Bunny Fang") && enemy.transform == true)) && enemy.rValue == 5 && this.combatStartHp / this.maxHp >= 0.5){
				enemyAutoFollow++;
			}
			//Refined Thani
			if(this.hasExactly("Thani") && this.rValue == 5 && this.combatStartHp / this.maxHp >= 0.5){
				thisAutoFollow++;
			}
			if(enemy.hasExactly("Thani") && enemy.rValue == 5 && enemy.combatStartHp / enemy.maxHp >= 0.5){
				enemyAutoFollow++;
			}
			if(this.hasExactly("Tiger-Roar Axe") && (this.initiator || this.buddy.adjacent > 0 || this.buddy.two > 0) && (enemy.hp/enemy.maxHp >= 1 || this.rValue > 0)){
				thisAutoFollow++;
			}
			if(enemy.hasExactly("Tiger-Roar Axe") && (enemy.buddy.adjacent > 0 || enemy.buddy.two > 0) && (this.hp/this.maxHp >= 1 || enemy.rValue > 0)){
				enemyAutoFollow++;
			}
			//Sealed Falchion
			if((this.hasExactly("Sealed Falchion") || this.hasExactly("Siegfried")) && this.rValue == 5 && enemy.combatStartHp / enemy.maxHp >= 0.75){
				preventEnemyFollow++;
			}
			if((enemy.hasExactly("Sealed Falchion") || enemy.hasExactly("Siegfried")) && enemy.rValue == 5 && this.combatStartHp / this.maxHp >= 0.75){
				preventThisFollow++;
			}
			if(this.hasExactly("Aurora Breath") && (this.initiator || this.rValue > 0)){
				thisAutoFollow++;
				if(this.rValue > 0){
					preventEnemyFollow++;
				}
			}
			if(enemy.hasExactly("Aurora Breath") && (this.initiator || enemy.rValue > 0)){
				preventThisFollow++;
				if(enemy.rValue > 0){
					enemyAutoFollow++;
				}
			}
			//Refined Naglfar
			if(enemy.hasExactly("Naglfar") && enemy.rValue == 5 && enemy.combatStartHp / enemy.maxHp >= 0.7){
				enemyAutoFollow++;
			}
			//Icy Fimbulvetr
			if(this.hasExactly("Icy Fimbulvetr") && this.combatStartHp / this.maxHp >= 0.25 && this.toggle.weapon == 1){
				thisAutoFollow++;
			}
			if(enemy.hasExactly("Icy Fimbulvetr") && enemy.combatStartHp / enemy.maxHp >= 0.25 && enemy.toggle.weapon == 1){
				enemyAutoFollow++;
			}
			if(this.hasExactly("Hallowed Tyrfing") && (enemy.combatStartHp / enemy.maxHp >= 0.75 || (this.rValue > 0 && this.initiator))){
				thisAutoFollow++;
			}
			if(enemy.hasExactly("Hallowed Tyrfing") && (this.combatStartHp / this.maxHp >= 0.75 || (enemy.rValue > 0 && !this.initiator))){
				enemyAutoFollow++;
			}
			//Tome and Axe of Despair
			if((this.hasExactly("Tome of Despair") || this.hasExactly("Axe of Despair")) && this.combatStartHp / this.maxHp >= 0.25 && this.combineBonPen(enemy,turn,"buff","debuff") >= 5){
				preventEnemyFollow++;
				if(this.combineBonPen(enemy,turn,"buff","debuff") >= 10){
					thisAutoFollow++;
				}
			}
			if((enemy.hasExactly("Tome of Despair") || enemy.hasExactly("Axe of Despair")) && enemy.combatStartHp / enemy.maxHp >= 0.25 && enemy.combineBonPen(this,turn,"buff","debuff") >= 5){
				preventThisFollow++;
				if(enemy.combineBonPen(this,turn,"buff","debuff") >= 10){
					enemyAutoFollow++;
				}
			}
			if(this.hasExactly("Twin-Crest Power") && this.combatStartHp / this.maxHp >= 0.25){
				preventThisFollow++;
				preventEnemyFollow++;
			}
			if(enemy.hasExactly("Twin-Crest Power") && enemy.combatStartHp / enemy.maxHp >= 0.25){
				preventThisFollow++;
				preventEnemyFollow++;
			}
			//initiates or toggle on (within 2 spaces, not adjacent, etc.)
			if((this.hasExactly("Raydream Horn") || this.hasExactly("Godly Breath") || this.has("Coral Saber") || this.has("Seahorse Axe") || this.has("Pursual Lance") || this.has("Pursual Axe") || this.hasExactly("Illuminating Horn") || this.hasExactly("Seidr") || this.hasExactly("Aurgelmir") || this.hasExactly("Arcane Nastrond") || this.hasExactly("Sunstone's Blade")) && (this.initiator || this.toggle.weapon == 1)){
				thisAutoFollow++;
			}
			if((enemy.hasExactly("Raydream Horn") || enemy.hasExactly("Godly Breath") || enemy.has("Coral Saber") || enemy.has("Seahorse Axe") || enemy.has("Pursual Lance") || enemy.has("Pursual Axe") || enemy.hasExactly("Illuminating Horn") || enemy.hasExactly("Seidr") || enemy.hasExactly("Aurgelmir") || enemy.hasExactly("Arcane Nastrond") || enemy.hasExactly("Sunstone's Blade")) && (!this.initiator || enemy.toggle.weapon == 1)){
				enemyAutoFollow++;
			}
			if((this.hasExactly("Charging Horn") && this.toggle.weapon == 3) || (this.hasExactly("Gurgurant") && this.rValue > 0)){
				preventEnemyFollow++;
			}
			if((enemy.hasExactly("Charging Horn") && enemy.toggle.weapon == 3) || (enemy.hasExactly("Gurgurant") && enemy.rValue > 0)){
				preventThisFollow++;
			}
			//Refined Flame Siegmund
			if(this.hasExactly("Flame Siegmund") && this.rValue > 0 && (this.initiator || this.toggle.weapon == 1)){
				thisAutoFollow++;
			}
			if(enemy.hasExactly("Flame Siegmund") && enemy.rValue > 0 && (enemy.initiator || enemy.toggle.weapon == 1)){
				enemyAutoFollow++;
			}
			//Refined Light of Dawn
			if(this.hasExactly("Light of Dawn") && this.rValue == 5 && (this.initiator || this.toggle.weapon == 2 || this.toggle.weapon == 3)){
				thisAutoFollow++;
			}
			if(enemy.hasExactly("Light of Dawn") && enemy.rValue == 5 && (enemy.initiator || enemy.toggle.weapon == 2 || enemy.toggle.weapon == 3)){
				enemyAutoFollow++;
			}
			//Guaranteed Follow-Up when initiating or toggle is on
			if((this.hasExactly("Destiny's Bow") || this.hasExactly("Breath of Flame")) && (this.initiator || this.toggle.weapon == 1)){
				thisAutoFollow++;
			}
			if((enemy.hasExactly("Destiny's Bow") || enemy.hasExactly("Breath of Flame")) && enemy.toggle.weapon == 1){
				enemyAutoFollow++;
			}
			//Dazzling and Serenity Breath (prevent double when initiated on or Enemy HP >= 75%
			if((this.hasExactly("Dazzling Breath") || this.has("Serenity Breath") || (this.hasExactly("Wizened Breath") && this.rValue == 5)) && (!this.initiator || enemy.combatStartHp / enemy.maxHp >= 0.75)){
				preventEnemyFollow++;
			}
			if((enemy.hasExactly("Dazzling Breath") || enemy.has("Serenity Breath") || (enemy.hasExactly("Wizened Breath") && enemy.rValue == 5)) && (this.initiator || this.combatStartHp / this.maxHp >= 0.75)){
				preventThisFollow++;
			}
			//Witch Breath
			if(this.hasExactly("Witch Breath")){
				if(enemy.combatStartHp / enemy.maxHp >= 0.5){
					thisAutoFollow++;
				}
				if(this.combatStartHp / this.maxHp >= 0.5){
					preventEnemyFollow++;
				}
			}
			if(enemy.hasExactly("Witch Breath")){
				if(this.combatStartHp / this.maxHp >= 0.5){
					enemyAutoFollow++;
				}
				if(enemy.combatStartHp / enemy.maxHp >= 0.5){
					preventThisFollow++;
				}
			}
			//Refined Byleistr
			if(this.hasExactly("Byleistr") && this.rValue == 5 && (this.initiator || this.toggle.weapon > 1)){
				preventEnemyFollow++;
			}
			if(enemy.hasExactly("Byleistr") && enemy.rValue == 5 && (!this.initiator || enemy.toggle.weapon > 1)){
				preventThisFollow++;
			}
			//HP >= 25% GFU check for weapons
			if((this.hasExactly("Holy Gradivus") || this.hasExactly("War-God Mjolnir") || this.hasExactly("Dragon Bouquet") || this.hasExactly("Everliving Breath") || ((this.hasExactly("Scythe of Sariel") || this.hasExactly("Sacaen-Wolf Bow") || this.hasExactly("Flower of Joy") || this.hasExactly("Flower of Sorrow") || this.hasExactly("Freeblade's Edge") || this.hasExactly("Thracia Kinglance") || this.hasExactly("Flower of Ease") || this.hasExactly("Flower of Plenty") || this.hasExactly("Hyperion Lance") || this.hasExactly("Blood Tome") || this.hasExactly("Banshee TH") || this.hasExactly("Fimbulvetr Morn") || this.hasExactly("Dark Monograph") || this.hasExactly("Bereft Lance")) && this.rValue == 5) || this.hasExactly("Total War Tome") || this.hasExactly("Dream Horn") || this.hasExactly("Knightly Manner") || this.hasExactly("Arcane Euphoria") || this.hasExactly("Heired Gungnir") || this.hasExactly("Arcane Caliburnus") || this.hasExactly("Arcane Void") || this.hasExactly("Corsair Cleaver") || this.hasExactly("Grimleal Text") || (this.hasExactly("Mirage Rod") && this.rValue > 0) || this.hasExactly("Repair") || this.hasExactly("Arcane Charmer") || this.hasExactly("Penitent Lance") || this.hasExactly("Supreme Thokk") || this.hasExactly("Craver's Tome") || this.hasExactly("Fundament")) && this.combatStartHp / this.maxHp >= 0.25){
				thisAutoFollow++;
			}
			if((enemy.hasExactly("Holy Gradivus") || enemy.hasExactly("War-God Mjolnir") || enemy.hasExactly("Dragon Bouquet") || enemy.hasExactly("Everliving Breath") || ((enemy.hasExactly("Scythe of Sariel") || enemy.hasExactly("Sacaen-Wolf Bow") || enemy.hasExactly("Flower of Joy") || enemy.hasExactly("Flower of Sorrow") || enemy.hasExactly("Freeblade's Edge") || enemy.hasExactly("Thracia Kinglance") || enemy.hasExactly("Flower of Ease") || enemy.hasExactly("Flower of Plenty") || enemy.hasExactly("Hyperion Lance") || enemy.hasExactly("Blood Tome") || enemy.hasExactly("Banshee TH") || enemy.hasExactly("Fimbulvetr Morn") || enemy.hasExactly("Dark Monograph") || enemy.hasExactly("Bereft Lance")) && enemy.rValue == 5) || enemy.hasExactly("Total War Tome") || enemy.hasExactly("Dream Horn") || enemy.hasExactly("Knightly Manner") || enemy.hasExactly("Arcane Euphoria") || enemy.hasExactly("Heired Gungnir") || enemy.hasExactly("Arcane Caliburnus") || enemy.hasExactly("Arcane Void") || enemy.hasExactly("Corsair Cleaver") || enemy.hasExactly("Grimleal Text") || (enemy.hasExactly("Mirage Rod") && enemy.rValue > 0) || enemy.hasExactly("Repair") || enemy.hasExactly("Arcane Charmer") || enemy.hasExactly("Penitent Lance") || enemy.hasExactly("Supreme Thokk") || enemy.hasExactly("Craver's Tome") || enemy.hasExactly("Fundament")) && enemy.combatStartHp / enemy.maxHp >= 0.25){
				enemyAutoFollow++;
			}
			//Horn of Opening
			if(this.hasExactly("Horn of Opening") && (this.buddy.adjacent + this.buddy.two + this.buddy.three > 1 || (this.rValue > 0 && this.buddy.adjacent + this.buddy.two + this.buddy.three > 0))){
				thisAutoFollow++;
				if(this.buddy.adjacent + this.buddy.two + this.buddy.three > 2 || this.rValue > 0){
					preventEnemyFollow++;
				}
			}
			if(enemy.hasExactly("Horn of Opening") && enemy.buddy.adjacent + enemy.buddy.two + enemy.buddy.three > 1){
				enemyAutoFollow++;
				if(enemy.buddy.adjacent + enemy.buddy.two + enemy.buddy.three > 2){
					preventThisFollow++;
				}
			}
			//Refined Spirit Breath
			if(this.hasExactly("Spirit Breath") && this.rValue > 0 && (thisEffDef > enemyEffDef || enemy.combatStartHp / enemy.maxHp >= 0.75)){
				thisAutoFollow++;
			}
			if(enemy.hasExactly("Spirit Breath") && enemy.rValue > 0 && (thisEffDef < enemyEffDef || this.combatStartHp / this.maxHp >= 0.75)){
				enemyAutoFollow++;
			}
			if((this.hasExactly("Sworn Lance") || this.hasExactly("Sol Lance")) && this.rValue == 5 && this.toggle.weapon == 1){
				preventEnemyFollow++;
			}
			if((enemy.hasExactly("Sworn Lance") || enemy.hasExactly("Sol Lance")) && enemy.rValue == 5 && enemy.toggle.weapon == 1){
				preventThisFollow++;
			}
			//Bow of Verdane
			if(this.hasExactly("Bow of Verdane") && this.rValue == 5 && this.combatStartHp / this.maxHp >= 0.25 && this.initiator && thisEffSpd + this.getPhantom("Spd") - enemyEffSpd - enemy.getPhantom("Spd") >= 3){
				thisAutoFollow++;
			}
			if(enemy.hasExactly("Bow of Verdane") && enemy.rValue == 5 && enemy.combatStartHp / enemy.maxHp >= 0.25 && !this.initiator && enemyEffSpd + enemy.getPhantom("Spd") - thisEffSpd - this.getPhantom("Spd") >= 3){
				enemyAutoFollow++;
			}
			//Lyfjaberg
			if(this.hasExactly("Lyfjaberg") && ((this.rValue < 0 && this.combatStartHp / this.maxHp >= 0.5) || (this.rValue > 0 && this.combatStartHp / this.maxHp >= 0.25))){
				preventEnemyFollow++;
			}
			if(enemy.hasExactly("Lyfjaberg") && enemy.rValue > 0 && enemy.combatStartHp / enemy.maxHp >= 0.25 && enemyEffSpd + enemy.getPhantom("Spd") > thisEffSpd + this.getPhantom("Spd")){
				preventThisFollow++;
			}
			//Dew Dragonstone
			if(this.hasExactly("Dew Dragonstone") && this.toggle.weapon == 1){
				preventEnemyFollow++;
			}
			if(enemy.hasExactly("Dew Dragonstone") && enemy.toggle.weapon == 1){
				preventThisFollow++;
			}
			//Adroit War Tome
			if(this.hasExactly("Adroit War Tome") && this.combatStartHp / this.maxHp >= 0.25 && thisEffRes + this.getPhantom("Res") - enemyEffRes - enemy.getPhantom("Res") >= 1){
				thisAutoFollow++;
			}
			if(enemy.hasExactly("Adroit War Tome") && enemy.combatStartHp / enemy.maxHp >= 0.25 && enemyEffRes + enemy.getPhantom("Res") - thisEffRes - this.getPhantom("Res") >= 1){
				enemyAutoFollow++;
			}
			//Windy War Tome
			if(this.hasExactly("Windy War Tome") && (!this.initiator || enemy.combatStartHp / enemy.maxHp >= 0.75) && thisEffRes + this.getPhantom("Res") >= enemyEffRes + enemy.getPhantom("Res") + 5){
				preventEnemyFollow++;
			}
			if(enemy.hasExactly("Windy War Tome") && (this.initiator || this.combatStartHp / this.maxHp >= 0.75) && enemyEffRes + enemy.getPhantom("Res") >= thisEffRes + this.getPhantom("Res") + 5){
				preventThisFollow++;
			}
			if(this.hasExactly("Shadow Breath") && (!this.initiator || enemy.combatStartHp / enemy.maxHp >= 0.75)){
				preventEnemyFollow++;
			}
			if(enemy.hasExactly("Shadow Breath") && (this.initiator || this.combatStartHp / this.maxHp >= 0.75)){
				preventThisFollow++;
			}
			if((this.hasExactly("Great Flame") && thisEffDef - enemyEffDef >= 5) || (this.hasExactly("Great Flame") && thisEffDef - enemyEffDef >= 1 && this.rValue > 0) || (this.hasExactly("Thunder Armads") && this.toggle.weapon == 1)){
				preventEnemyFollow++;
			}
			if((enemy.hasExactly("Great Flame") && enemyEffDef - thisEffDef >= 5) || (enemy.hasExactly("Great Flame") && enemyEffDef - thisEffDef >= 1 && enemy.rValue > 0) || (enemy.hasExactly("Thunder Armads") && enemy.toggle.weapon == 1)){
				preventThisFollow++;
			}
			if(this.hasExactly("Brynhildr") && this.rValue == 5 && thisEffDef - enemyEffDef >= 1 && enemy.range == "ranged"){
				preventEnemyFollow++;
			}
			if(enemy.hasExactly("Brynhildr") && enemy.rValue == 5 && enemyEffDef - thisEffDef >= 1 && this.range == "ranged"){
				preventThisFollow++;
			}
			if(this.hasExactly("Ruinous Frost") && (!this.initiator || enemy.combatStartHp / enemy.maxHp >= 0.75)){
				preventEnemyFollow++;
				preventThisFollow++;
			}
			if(enemy.hasExactly("Ruinous Frost") && (this.initiator || this.combatStartHp / this.maxHp >= 0.75)){
				preventThisFollow++;
				preventEnemyFollow++;
			}
			if(this.hasExactly("Saehrimnir") && this.rValue == 5 && this.toggle.weapon == 1 && thisEffRes + this.getPhantom("Res") - enemyEffRes - enemy.getPhantom("Res") >= 7){
				preventEnemyFollow++;
			}
			if(enemy.hasExactly("Saehrimnir") && enemy.rValue == 5 && enemy.toggle.weapon == 1 && enemy.combatStartHp / enemy.maxHp >= 0.25 && enemyEffRes + enemy.getPhantom("Res") - thisEffRes - this.getPhantom("Res") >= 7){
				preventThisFollow++;
			}
			if((((this.hasExactly("Kriemhild") || this.hasExactly("Earthly Gae Bolg") || this.hasExactly("Flame Battleaxe") || this.hasExactly("Crimson Lance")) && this.rValue == 5) || (this.hasExactly("Resolved Fang") && this.rValue > 0) || this.hasExactly("Revealing Breath") || this.hasExactly("Wyvern Hatchet") || this.hasExactly("Berserker Axe") || this.hasExactly("Devoted Breath")) && (!this.initiator || enemy.combatStartHp / enemy.maxHp >= 0.75)){
				thisAutoFollow++;
			}
			if((((enemy.hasExactly("Kriemhild") || enemy.hasExactly("Earthly Gae Bolg") || enemy.hasExactly("Flame Battleaxe") || enemy.hasExactly("Crimson Lance")) && enemy.rValue == 5) || (enemy.hasExactly("Resolved Fang") && enemy.rValue > 0) || enemy.hasExactly("Revealing Breath") || enemy.hasExactly("Wyvern Hatchet") || enemy.hasExactly("Berserker Axe") || enemy.hasExactly("Devoted Breath")) && (this.initiator || this.combatStartHp / this.maxHp >= 0.75)){
				enemyAutoFollow++;
			}
			if((this.hasExactly("Kormt") || this.hasExactly("Breaker Lance") || this.hasExactly("Arcane Grima") || this.hasExactly("Arcane Eclipse")) && this.combatStartHp / this.maxHp >= 0.25){
				thisAutoFollow++;
			}
			if((enemy.hasExactly("Kormt") || enemy.hasExactly("Breaker Lance") || enemy.hasExactly("Arcane Grima") || enemy.hasExactly("Arcane Eclipse")) && enemy.combatStartHp / enemy.maxHp >= 0.25){
				enemyAutoFollow++;
			}
			if(this.hasExactly("Morph Fimbulvetr") && this.toggle.weapon == 1){
				preventEnemyFollow++;
			}
			if(enemy.hasExactly("Morph Fimbulvetr") && enemy.toggle.weapon == 1){
				preventThisFollow++;
			}
			if(this.hasExactly("Moonlight Drop") && (this.initiator || this.toggle.weapon == 1) && thisEffRes+this.getPhantom("Res") >= enemyEffRes-enemy.getPhantom("Res") + 5 && thisEffRes+this.getPhantom("Res") <= enemyEffRes-enemy.getPhantom("Res") + 14){
				thisAutoFollow++;
			}
			if(enemy.hasExactly("Moonlight Drop") && (!this.initiator || enemy.toggle.weapon == 1) && enemyEffRes+enemy.getPhantom("Res") >= thisEffRes-this.getPhantom("Res") + 5 && enemyEffRes+enemy.getPhantom("Res") <= thisEffRes-this.getPhantom("Res") + 14){
				enemyAutoFollow++;
			}
			//HP >= 25% deny follow up
			if((this.hasExactly("Heartbeat Lance") || this.hasExactly("Fiery Fang") || this.hasExactly("Ghostly Lanterns") || this.hasExactly("Arcane Downfall") || this.has("Peppy Bow") || this.has("Peppy Cane") || this.hasExactly("Master's Tactics") || this.has("Halting Bow") || this.hasExactly("Crimson Lance") || (this.hasExactly("Dark Scripture") && this.rValue == 5)) && this.combatStartHp / this.maxHp >= 0.25){
				preventEnemyFollow++;
			}
			if((enemy.hasExactly("Heartbeat Lance") || enemy.hasExactly("Fiery Fang") || enemy.hasExactly("Ghostly Lanterns") || enemy.hasExactly("Arcane Downfall") || enemy.has("Peppy Bow") || enemy.has("Peppy Cane") || enemy.hasExactly("Master's Tactics") || enemy.has("Halting Bow") || enemy.hasExactly("Crimson Lance") || (enemy.hasExactly("Dark Scripture") && enemy.rValue == 5)) && enemy.combatStartHp / enemy.maxHp >= 0.25){
				preventThisFollow++;
			}
			if(this.has("Taguel Fang") && this.rValue == 5 && this.combatStartHp / this.maxHp >= 0.25 && thisEffSpd + this.getPhantom("Spd") - enemyEffSpd - enemy.getPhantom("Spd") >= 1){
				thisAutoFollow++;
			}
			if(enemy.has("Taguel Fang") && enemy.rValue == 5 && enemy.combatStartHp / enemy.maxHp >= 0.25 && enemyEffSpd + enemy.getPhantom("Spd") - thisEffSpd - this.getPhantom("Spd") >= 1){
				enemyAutoFollow++;
			}
			if(this.hasExactly("Lion King Fang") && this.rValue == 5 && this.combatStartHp / this.maxHp >= 0.25){
				thisAutoFollow++;
			}
			if(enemy.hasExactly("Lion King Fang") && enemy.rValue == 5 && enemy.combatStartHp / enemy.maxHp >= 0.25){
				enemyAutoFollow++;
			}
			if(this.hasExactly("New Divinity") && this.combatStartHp / this.maxHp >= 0.4){
				preventEnemyFollow++;
			}
			if(enemy.hasExactly("New Divinity") && enemy.combatStartHp / enemy.maxHp >= 0.4){
				preventThisFollow++;
			}
			if((this.hasExactly("Arcane Eljudnir") || this.hasExactly("Arcane Qiang") || (this.hasExactly("Lucky Bow") && this.rValue == 5)) && this.combatStartHp / this.maxHp >= 0.25){
				thisAutoFollow++;
				preventEnemyFollow++;
			}
			if((enemy.hasExactly("Arcane Eljudnir") || enemy.hasExactly("Arcane Qiang") || (enemy.hasExactly("Lucky Bow") && enemy.rValue == 5)) && enemy.combatStartHp / enemy.maxHp >= 0.25){
				enemyAutoFollow++;
				preventThisFollow++;
			}
			if(this.hasExactly("Razing Breath") && this.rValue == 5 && this.combatStartHp / this.maxHp >= 0.25 && (this.toggle.weapon == 1 || checkAllBuffs(this, enemy, dturn))){
				thisAutoFollow++;
			}
			if(enemy.hasExactly("Razing Breath") && enemy.rValue == 5 && enemy.combatStartHp / enemy.maxHp >= 0.25 && (enemy.toggle.weapon == 1 || checkAllBuffs(enemy, this, dturn))){
				preventThisFollow++;
			}
			if(this.hasExactly("Rite of Souls") && (this.initiator || this.toggle.weapon > 1)){
				preventEnemyFollow++;
			}
			if(enemy.hasExactly("Rite of Souls") && (!this.initiator || enemy.toggle.weapon > 1)){
				preventThisFollow++;
			}
			if(this.hasExactly("Chaos Manifest") && (this.toggle.weapon == 1 || (this.rValue > 0 && (enemy.combatStartHp / enemy.maxHp >= 0.75 || this.toggle.weapon == 3)))){
				thisAutoFollow++;
			}
			if(enemy.hasExactly("Chaos Manifest") && (enemy.toggle.weapon == 1 || (enemy.rValue > 0 && (this.combatStartHp / this.maxHp >= 0.75 || enemy.toggle.weapon == 3)))){
				enemyAutoFollow++;
			}
			if(this.hasExactly("Oracle's Breath") && ((this.rValue < 0 && this.toggle.weapon == 1) || (this.rValue > 0 && (this.toggle.weapon == 1 || this.toggle.weapon == 3 || this.combatStartHp / this.maxHp >= 0.5)))){
				preventEnemyFollow++;
			}
			if(enemy.hasExactly("Oracle's Breath") && ((enemy.rValue < 0 && enemy.toggle.weapon == 1) || (enemy.rValue > 0 && (enemy.toggle.weapon == 1 || enemy.toggle.weapon == 3 || enemy.combatStartHp / enemy.maxHp >= 0.5)))){
				preventThisFollow++;
			}
			if(this.hasExactly("Retainer's Report") && (enemy.combatStartHp / enemy.maxHp >= 0.75 || this.toggle.weapon == 1 || this.toggle.weapon == 3)){
				thisAutoFollow++;
			}
			if(enemy.hasExactly("Retainer's Report") && (this.combatStartHp / this.maxHp >= 0.75 || enemy.toggle.weapon == 1 || enemy.toggle.weapon == 3)){
				enemyAutoFollow++;
			}
			if(this.hasExactly("Reginleif") && (this.toggle.weapon == 1 || thisEffAtk > enemyEffAtk)){
				thisAutoFollow++;
			}
			if(enemy.hasExactly("Reginleif") && (enemy.toggle.weapon == 1 || enemyEffAtk > thisEffAtk)){
				enemyAutoFollow++;
			}
			if(this.hasExactly("Reginleif") && this.rValue == 5 && this.combatStartHp / this.maxHp >= 0.25 && this.toggle.weapon == 1){
				preventEnemyFollow++;
			}
			if(enemy.hasExactly("Reginleif") && enemy.rValue == 5 && enemy.combatStartHp / enemy.maxHp >= 0.25 && enemy.toggle.weapon == 1){
				preventThisFollow++;
			}
			if(this.hasExactly("Heralding Horn") && (!this.initiator || enemy.combatStartHp / enemy.maxHp >= 0.75) && this.toggle.weapon > 2){
				preventEnemyFollow++;
			}
			if(enemy.hasExactly("Heralding Horn") && (this.initiator || this.combatStartHp / this.maxHp >= 0.75) && enemy.toggle.weapon > 2){
				preventThisFollow++;
			}
			if(this.hasExactly("Duskbloom Bow") && (this.initiator || this.toggle.weapon > 1) && thisEffRes + this.getPhantom("Res") - enemyEffRes - enemy.getPhantom("Res") >= 1){
				thisAutoFollow++;
			}
			if(enemy.hasExactly("Duskbloom Bow") && (!this.initiator || enemy.toggle.weapon > 1) && enemyEffRes + enemy.getPhantom("Res") - thisEffRes - this.getPhantom("Res") >= 1){
				enemyAutoFollow++;
			}
			if(this.hasExactly("Queenslance") && ((this.initiator && this.toggle.weapon > 1) || this.toggle.weapon == 3)){
				preventEnemyFollow++;
			}
			if(enemy.hasExactly("Queenslance") && ((!this.initiator && enemy.toggle.weapon > 1) || enemy.toggle.weapon == 3)){
				preventThisFollow++;
			}
			if(this.hasExactly("Revenger Lance") && (this.initiator || this.toggle.weapon == 1) && enemy.combatStartHp / enemy.maxHp >= 0.75){
				thisAutoFollow++;
			}
			if(enemy.hasExactly("Revenger Lance") && (!this.initiator || enemy.toggle.weapon == 1) && this.combatStartHp / this.maxHp >= 0.75){
				enemyAutoFollow++;
			}
			if(this.hasExactly("Aymr") && (this.toggle.weapon == 1 || (this.rValue > 0 && !this.initiator))){
				preventEnemyFollow++;
			}
			if(enemy.hasExactly("Aymr") && (enemy.toggle.weapon == 1 || (enemy.rValue > 0 && this.initiator))){
				preventThisFollow++;
			}
			if(this.hasExactly("Twin Divinestone") && this.combatStartHp / this.maxHp >= 0.25 && thisEffRes + this.getPhantom("Res") > enemyEffRes - enemy.getPhantom("Res")){
				thisAutoFollow++;
			}
			if(enemy.hasExactly("Twin Divinestone") && enemy.combatStartHp / enemy.maxHp >= 0.25 && thisEffRes + this.getPhantom("Res") < enemyEffRes - enemy.getPhantom("Res")){
				enemyAutoFollow++;
			}
			if(this.hasExactly("Fimbulvetr") && this.rValue == 5 && (this.toggle.weapon == 3 || this.toggle.weapon == 5)){
				thisAutoFollow++;
			}
			if(enemy.hasExactly("Fimbulvetr") && enemy.rValue == 5 && (enemy.toggle.weapon == 3 || enemy.toggle.weapon == 5)){
				enemyAutoFollow++;
			}
			if(this.hasExactly("Randgridr") && this.rValue == 5 && (this.toggle.weapon == 3 || ((this.initiator || this.toggle.weapon == 1) && this.toggle.weapon == 2))){
				thisAutoFollow++;
			}
			if(enemy.hasExactly("Randgridr") && enemy.rValue == 5 && (enemy.toggle.weapon == 3 || ((!this.initiator || enemy.toggle.weapon == 1) && enemy.toggle.weapon == 2))){
				enemyAutoFollow++;
			}
			if(this.hasExactly("Eagle's Egg") && this.rValue > 0 && (this.toggle.weapon == 1 || this.toggle.weapon == 4 || this.toggle.weapon == 5 || this.toggle.weapon == 7 || this.initiator)){
				thisAutoFollow++;
			}
			if(enemy.hasExactly("Eagle's Egg") && enemy.rValue > 0 && (enemy.toggle.weapon == 1 || enemy.toggle.weapon == 4 || enemy.toggle.weapon == 5 || enemy.toggle.weapon == 7 || !this.initiator)){
				enemyAutoFollow++;
			}
			//GFU on initiate or ally within 2 Spaces
			if((((this.hasExactly("Mirage Falchion") || this.hasExactly("Studied Forblaze") || this.hasExactly("Crusher") || this.hasExactly("Caduceus Staff") || this.hasExactly("Tome of Fury")) && this.rValue == 5) || this.hasExactly("Kitty-Cat Parasol") || this.hasExactly("Heavy War Axe") || this.hasExactly("Plegian War Axe") || this.has("Ice Dagger") || this.has("Ice Dragonstone") || this.hasExactly("Auto-Lofnheidr") || this.hasExactly("Delivering Antler") || this.hasExactly("New Dawn") || this.hasExactly("Gentle Fell Egg")) && (this.initiator || this.buddy.adjacent > 0 || this.buddy.two > 0)){
				thisAutoFollow++;
			}
			if((((enemy.hasExactly("Mirage Falchion") || enemy.hasExactly("Studied Forblaze") || enemy.hasExactly("Crusher") || enemy.hasExactly("Caduceus Staff") || enemy.hasExactly("Tome of Fury")) && enemy.rValue == 5) || enemy.hasExactly("Kitty-Cat Parasol") || enemy.hasExactly("Heavy War Axe") || enemy.hasExactly("Plegian War Axe") || enemy.has("Ice Dagger") || enemy.has("Ice Dragonstone") || enemy.hasExactly("Auto-Lofnheidr") || enemy.hasExactly("Delivering Antler") || enemy.hasExactly("New Dawn") || enemy.hasExactly("Gentle Fell Egg")) && (enemy.buddy.adjacent > 0 || enemy.buddy.two > 0)){
				enemyAutoFollow++;
			}
			//GFU on initiate or ally within 2 Spaces w/ during combat toggle
			if((this.hasExactly("Worldly Lance") || this.hasExactly("Obscurite")) && (this.initiator || ((this.buddy.adjacent > 0 || this.buddy.two > 0) && this.toggle.weapon > 1))){
				thisAutoFollow++;
			}
			if((enemy.hasExactly("Worldly Lance") || enemy.hasExactly("Obscurite")) && (enemy.buddy.adjacent > 0 || enemy.buddy.two > 0) && enemy.toggle.weapon > 1){
				enemyAutoFollow++;
			}
			if(this.hasExactly("Stoutheart Lance") && this.combatStartHp / this.maxHp >= 0.5){
				thisAutoFollow++;
			}
			if(enemy.hasExactly("Stoutheart Lance") && enemy.combatStartHp / enemy.maxHp >= 0.5){
				enemyAutoFollow++;
			}
			if(((this.hasExactly("Stoutheart Lance") && this.rValue == 5) || (this.hasExactly("Auto-Lofnheidr") && this.rValue > 0)) && (this.initiator || this.buddy.adjacent > 0 || this.buddy.two > 0)){
				preventEnemyFollow++;
			}
			if(((enemy.hasExactly("Stoutheart Lance") && enemy.rValue == 5) || (enemy.hasExactly("Auto-Lofnheidr") && enemy.rValue > 0)) && (!this.initiator || enemy.buddy.adjacent > 0 || enemy.buddy.two > 0)){
				preventThisFollow++;
			}
			if(this.hasExactly("Persecution Bow") && this.rValue > 0 && (this.combatStartHp / this.maxHp < 1 || Object.values(this.penalty).reduce((a, item) => a + (item === true ? 1 : 0), 0) + this.penalty.extra > 0)){
				thisAutoFollow++;
			}
			if(enemy.hasExactly("Persecution Bow") && enemy.rValue > 0 && (enemy.combatStartHp / enemy.maxHp < 1 || Object.values(enemy.penalty).reduce((a, item) => a + (item === true ? 1 : 0), 0) + enemy.penalty.extra > 0)){
				enemyAutoFollow++;
			}
			if(this.has("Carrot Bow") && (!this.initiator || enemy.combatStartHp / enemy.maxHp >= 0.75) && enemy.penalty.discord){
				thisAutoFollow++;
				preventEnemyFollow++;
			}
			if(enemy.has("Carrot Bow") && (this.initiator || this.combatStartHp / this.maxHp >= 0.75) && this.penalty.discord){
				enemyAutoFollow++;
				preventThisFollow++;
			}
			if((this.hasExactly("Exalt's War Staff") || this.hasExactly("Remote Breath") || this.hasExactly("Prior's Tome")) && this.buddy.adjacent + this.buddy.two + this.buddy.three > 0){
				thisAutoFollow++;
			}
			if((enemy.hasExactly("Exalt's War Staff") || enemy.hasExactly("Remote Breath") || enemy.hasExactly("Prior's Tome")) && enemy.buddy.adjacent + enemy.buddy.two + enemy.buddy.three > 0){
				enemyAutoFollow++;
			}
			if(this.hasExactly("Wyvern Lance") || this.hasExactly("Heavenly Icicle") || ((this.hasExactly("Goddess Axe") || this.hasExactly("Twin Star Axe")) && this.rValue > 0) || (this.hasExactly("Luin") && this.rValue == 5)){
				thisAutoFollow++;
			}
			if(enemy.hasExactly("Wyvern Lance") || enemy.hasExactly("Heavenly Icicle") || ((enemy.hasExactly("Goddess Axe") || enemy.hasExactly("Twin Star Axe")) && enemy.rValue > 0) || (enemy.hasExactly("Luin") && enemy.rValue == 5)){
				enemyAutoFollow++;
			}
			if(this.hasExactly("Heavenly Icicle")){
				preventEnemyFollow++;
			}
			if(enemy.hasExactly("Heavenly Icicle")){
				preventThisFollow++;
			}
			if(this.hasExactly("Tiger-Eye Axe") && this.rValue == 5 && (this.checkBonPen(1,enemy,turn) || enemy.checkBonPen(3,this.turn))){
				thisAutoFollow++;
			}
			if(enemy.hasExactly("Tiger-Eye Axe") && enemy.rValue == 5 && (enemy.checkBonPen(1,this,turn) || this.checkBonPen(3,enemy.turn))){
				enemyAutoFollow++;
			}
			if((this.hasExactly("Grim Brokkr") && (this.initiator || this.buddy.adjacent == 0 || (this.rValue > 0 && this.buddy.adjacent < 2))) || (this.hasExactly("Petrify") && this.rValue > 0 && (this.initiator || this.buddy.adjacent < 2))){
				thisAutoFollow++;
			}
			if((enemy.hasExactly("Grim Brokkr") && (!this.initiator || enemy.buddy.adjacent == 0 || (enemy.rValue > 0 && enemy.buddy.adjacent < 2))) || (enemy.hasExactly("Petrify") && enemy.rValue > 0 && (!this.initiator || enemy.buddy.adjacent < 2))){
				enemyAutoFollow++;
			}
			if(this.hasExactly("Gate-Anchor Axe") && (this.buddy.adjacent == 0 || (this.rValue > 0 && (this.initiator || this.buddy.adjacent < 2)))){
				thisAutoFollow++;
			}
			if(enemy.hasExactly("Gate-Anchor Axe") && (enemy.buddy.adjacent == 0 || (enemy.rValue > 0 && (!this.initiator || enemy.buddy.adjacent < 2)))){
				enemyAutoFollow++;
			}
			if(this.hasExactly("Sky-Pirate Claw") && (this.buddy.adjacent == 0 || (this.rValue > 0 && (this.transform == true || this.toggle.weapon == 1)))){
				thisAutoFollow++;
			}
			if(enemy.hasExactly("Sky-Pirate Claw") && (enemy.buddy.adjacent == 0 || (enemy.rValue > 0 && (enemy.transform == true || enemy.toggle.weapon == 1)))){
				enemyAutoFollow++;
			}
			if(this.hasExactly("Obsidian Lance") && (this.buddy.adjacent == 0 || (this.rValue > 0 && (enemy.combatStartHp / enemy.maxHp >= 0.75 || this.buddy.adjacent < 2)))){
				thisAutoFollow++;
			}
			if(enemy.hasExactly("Obsidian Lance") && (enemy.buddy.adjacent == 0 || (enemy.rValue > 0 && (this.combatStartHp / this.maxHp >= 0.75 || enemy.buddy.adjacent < 2)))){
				enemyAutoFollow++;
			}
			if(this.hasExactly("Convoy Dagger") && this.buddy.adjacent + this.buddy.two + this.buddy.three > 0){
				preventEnemyFollow++;
			}
			if(enemy.hasExactly("Convoy Dagger") && enemy.buddy.adjacent + enemy.buddy.two + enemy.buddy.three > 0){
				preventThisFollow++;
			}
			if(this.hasExactly("Springing Spear") && this.buddy.rorc > 0){
				preventEnemyFollow++;
			}
			if(enemy.hasExactly("Springing Spear") && enemy.buddy.rorc > 0){
				preventThisFollow++;
			}
			if(this.hasExactly("Victorious Axe") && (this.toggle.weapon == 1 || (this.rValue > 0 && (this.combatStartHp / this.maxHp >= 0.25 || this.toggle.weapon == 3)))){
				thisAutoFollow++;
			}
			if(enemy.hasExactly("Victorious Axe") && (enemy.toggle.weapon == 1 || (enemy.rValue > 0 && (enemy.combatStartHp / enemy.maxHp >= 0.25 || enemy.toggle.weapon == 3)))){
				enemyAutoFollow++;
			}
			if(this.hasExactly("Mystic War Staff") && this.toggle.weapon > 1){
				thisAutoFollow++;
			}
			if(enemy.hasExactly("Mystic War Staff") && enemy.toggle.weapon > 1){
				enemyAutoFollow++;
			}
			if((this.hasExactly("Tailwind Shuriken") && this.rValue == 5) || this.hasExactly("Proud Spear") || this.hasExactly("Sword of Dusk")){
				thisAutoFollow++;
			}
			if((enemy.hasExactly("Tailwind Shuriken") && enemy.rValue == 5) || enemy.hasExactly("Sword of Dusk")){
				enemyAutoFollow++;
			}
			if(enemy.hasExactly("Proud Spear") && this.combatStartHp / this.maxHp >= 0.75){
				enemyAutoFollow++;
			}
			
			//A Slot
			if((this.hasExactly("Duality") || this.hasExactly("Part of the Plan") || this.hasExactly("Obsession")) && this.combatStartHp / this.maxHp >= 0.25){
				thisAutoFollow++;
				if(this.hasExactly("Obsession")){
					preventEnemyFollow++;
				}
			}
			if((enemy.hasExactly("Duality") || enemy.hasExactly("Part of the Plan") || enemy.hasExactly("Obsession")) && enemy.combatStartHp / enemy.maxHp >= 0.25){
				enemyAutoFollow++;
				if(enemy.hasExactly("Obsession")){
					preventThisFollow++;
				}
			}
			if(this.hasExactly("Gift of Magic") && (this.initiator || enemy.range == "ranged")){
				thisAutoFollow++;
			}
			if(enemy.hasExactly("Gift of Magic") && (!this.initiator || this.range == "ranged")){
				enemyAutoFollow++;
			}
			if((this.hasExactly("Sly Swift Sparrow") || this.hasExactly("Sly Mirror") || this.hasExactly("Sly Sturdy Blow")) && this.initiator){
				thisAutoFollow++;
			}
			
			//B Slot
			if(this.has("Wary Fighter")){
				if(this.hp/this.maxHp >= 1.1 - 0.2 * this.has("Wary Fighter")){
					preventThisFollow++;
					preventEnemyFollow++;
				}
			}
			if(enemy.has("Wary Fighter")){
				if(enemy.hp/enemy.maxHp >= 1.1 - 0.2 * enemy.has("Wary Fighter")){
					preventThisFollow++;
					preventEnemyFollow++;
				}
			}
			//Binding Shield Check
			if((this.has("Binding Shield") && enemy.weaponType == "dragon") || (this.hasExactly("Binding Shield 2") && thisEffSpd+this.getPhantom("Spd") >= enemyEffSpd+enemy.getPhantom("Spd")+5)){
				thisAutoFollow++;
				preventEnemyFollow++;
			}
			if((enemy.has("Binding Shield") && this.weaponType == "dragon") || (enemy.hasExactly("Binding Shield 2") && enemyEffSpd+enemy.getPhantom("Spd") >= thisEffSpd+this.getPhantom("Spd")+5)){
				enemyAutoFollow++;
				preventThisFollow++;
			}
			//Odd Follow Up
			if(this.has("Odd Follow-Up") && turn % 2 == 1){
				if(this.hasExactly("Odd Follow-Up 3") || (this.hasExactly("Odd Follow-Up 2") && this.hp/this.maxHp >= 0.5) || (this.hasExactly("Odd Follow-Up 1") && this.hp/this.maxHp == 1)){
					thisAutoFollow++;
					preventEnemyFollow++;
				}
			}
			if(enemy.has("Odd Follow-Up") && turn % 2 == 1){
				if(enemy.hasExactly("Odd Follow-Up 3") || (enemy.hasExactly("Odd Follow-Up 2") && enemy.hp/enemy.maxHp >= 0.5) || (enemy.hasExactly("Odd Follow-Up 1") && enemy.hp/enemy.maxHp == 1)){
					enemyAutoFollow++;
					preventThisFollow++;
				}
			}
			//Even Follow Up
			if(this.has("Even Follow-Up") && turn % 2 == 0){
				if(this.hasExactly("Even Follow-Up 3") || (this.hasExactly("Even Follow-Up 2") && this.hp/this.maxHp >= 0.5) || (this.hasExactly("Even Follow-Up 1") && this.hp/this.maxHp == 1)){
					thisAutoFollow++;
					preventEnemyFollow++;
				}
			}
			if(enemy.has("Even Follow-Up") && turn % 2 == 0){
				if(enemy.hasExactly("Even Follow-Up 3") || (enemy.hasExactly("Even Follow-Up 2") && enemy.hp/enemy.maxHp >= 0.5) || (enemy.hasExactly("Even Follow-Up 1") && enemy.hp/enemy.maxHp == 1)){
					enemyAutoFollow++;
					preventThisFollow++;
				}
			}
			if(this.hasExactly("Assured Rebirth") && thisEffRes + this.getPhantom("Res") > enemyEffRes + enemy.getPhantom("Res")){
				thisAutoFollow++;
			}
			if(enemy.hasExactly("Assured Rebirth") && enemyEffRes + enemy.getPhantom("Res") > thisEffRes + this.getPhantom("Res")){
				enemyAutoFollow++;
			}
			if((this.hasExactly("Dragon's Ire 4") || this.hasExactly("Holy War's End 2") || this.hasExactly("Ice Prince's Seal") || this.hasExactly("Dragon's Scales") || this.hasExactly("Brutal Ferocity") || this.hasExactly("Slick Fighter 4") || this.hasExactly("Wily Fighter 4")) && this.combatStartHp / this.maxHp >= 0.25){
				thisAutoFollow++;
				if(this.hasExactly("Holy War's End 2")){
					preventEnemyFollow++;
				}
			}
			if((enemy.hasExactly("Holy War's End 2") || enemy.hasExactly("Ice Prince's Seal")) && enemy.combatStartHp / enemy.maxHp >= 0.25){
				enemyAutoFollow++;
				if(enemy.hasExactly("Holy War's End 2")){
					preventThisFollow++;
				}
			}
			if(enemy.hasExactly("Dragon's Scales") || enemy.hasExactly("Brutal Ferocity") || enemy.hasExactly("Yggdrasill's Alter")){
				enemyAutoFollow++;
			}
			if(this.hasExactly("Yggdrasill's Alter")){
				thisAutoFollow++;
			}
			if(this.hasExactly("Pegasus Flight 4") && allStats[17] + this.getPhantom("Spd") >= allStats[21] + enemy.getPhantom("Spd") - 10 && allStats[17] + this.getPhantom("Spd") + allStats[19] + this.getPhantom("Res") > allStats[21] + enemy.getPhantom("Spd") + allStats[23] + enemy.getPhantom("Res")){
				preventEnemyFollow++;
			}
			if(enemy.hasExactly("Pegasus Flight 4") && allStats[21] + enemy.getPhantom("Spd") >= allStats[17] + this.getPhantom("Spd") - 10 && allStats[17] + this.getPhantom("Spd") + allStats[19] + this.getPhantom("Res") < allStats[21] + enemy.getPhantom("Spd") + allStats[23] + enemy.getPhantom("Res")){
				preventThisFollow++;
			}
			if(this.has("Beast Follow-Up") || this.hasExactly("Divine Strength")){
				if(this.hasExactly("Beast Follow-Up 3") || (this.hasExactly("Beast Follow-Up 2") && this.combatStartHp/this.maxHp >= 0.5) || (this.hasExactly("Beast Follow-Up 1") && this.combatStartHp/this.maxHp == 1) || this.hasExactly("Divine Strength")){
					thisAutoFollow++;
				}
			}
			if(enemy.has("Beast Follow-Up") || enemy.hasExactly("Divine Strength")){
				if(enemy.hasExactly("Beast Follow-Up 3") || (enemy.hasExactly("Beast Follow-Up 2") && enemy.combatStartHp/enemy.maxHp >= 0.5) || (this.hasExactly("Beast Follow-Up 1") && enemy.combatStartHp/enemy.maxHp == 1) || this.hasExactly("Divine Strength")){
					enemyAutoFollow++;
				}
			}
			if(this.hasExactly("Raging Storm 2") && (this.combatStartHp / this.maxHp >= 0.25 || this.toggle.b == 1)){
				thisAutoFollow++;
			}
			if(enemy.hasExactly("Raging Storm 2") && (enemy.combatStartHp / enemy.maxHp >= 0.25 || enemy.toggle.b == 1)){
				enemyAutoFollow++;
			}
			if(this.hasExactly("Brash Assault 4") && this.initiator && (this.combatStartHp / this.maxHp < 1 || enemy.combatStartHp / enemy.maxHp >= 1)){
				thisAutoFollow++;
			}
			
			if(this.hasCaptain("Storm of Blows") && (this.toggle.sd == 0 || this.isFeuded(enemy) == false)){
				thisAutoFollow++;
			}
			if(enemy.hasCaptain("Storm of Blows") && (enemy.toggle.sd == 0 || enemy.isFeuded(this) == false)){
				enemyAutoFollow++;
			}
			if((this.hasExactly("Weaving Fighter") || this.hasExactly("Canny Fighter")) && this.combatStartHp / this.maxHp >= 0.25){
				preventThisFollow++;
				preventEnemyFollow++;
			}
			if((enemy.hasExactly("Weaving Fighter") || enemy.hasExactly("Canny Fighter")) && enemy.combatStartHp / enemy.maxHp >= 0.25){
				preventThisFollow++;
				preventEnemyFollow++;
			}
			if((this.hasExactly("Wyvern Rift") && thisEffSpd + thisEffDef >= enemyEffSpd + enemyEffDef - 10) || (this.hasExactly("Pegasus Rift") && thisEffSpd + thisEffRes >= enemyEffSpd + enemyEffRes - 10)){
				thisAutoFollow++;
				preventEnemyFollow++;
			}
			if((enemy.hasExactly("Wyvern Rift") && enemyEffSpd + enemyEffDef >= thisEffSpd + thisEffDef - 10) || (enemy.hasExactly("Pegasus Rift") && enemyEffSpd + enemyEffRes >= thisEffSpd + thisEffRes - 10)){
				enemyAutoFollow++;
				preventThisFollow++;
			}
			if(this.hasSlot("Momentum","b") && this.buddy.spaces > 0){
				thisAutoFollow++;
			}
			if(enemy.hasSlot("Momentum","b") && enemy.buddy.spaces > 0){
				enemyAutoFollow++;
			}
			
			//C Slot
			if(this.hasExactly("Future-Sighted") && (this.buddy.adjacent > 0 || this.buddy.two > 0 || this.buddy.three > 0)){
				thisAutoFollow++;
			}
			if(enemy.hasExactly("Future-Sighted") && (enemy.buddy.adjacent > 0 || enemy.buddy.two > 0 || enemy.buddy.three > 0)){
				enemyAutoFollow++;
			}
			if(this.hasExactly("Spd Res Crux") || this.hasExactly("Atk Res Crux") || this.hasExactly("Spd Def Crux")){
				thisAutoFollow++;
			}
			if(enemy.hasExactly("Spd Res Crux") || enemy.hasExactly("Atk Res Crux") || enemy.hasExactly("Spd Def Crux")){
				enemyAutoFollow++;
			}
			
			//check for brave
			//brave will be passed to this.doDamage
			var brave = 0;
			var counterBrave = 0;
			if(this.has("Brave Sword") || this.has("Brave Lance") || this.has("Brave Axe") || this.has("Brave Bow") || this.hasExactly("Dire Thunder") || this.hasExactly("Amiti") || (this.hasExactly("Falchion") && this.name == "Alm" && this.rValue == 5 && this.hp/this.maxHp == 1) || this.hasExactly("Meisterschwert") || this.hasExactly("Cherche's Axe") || this.hasExactly("Wolfskin Fang") || this.hasExactly("Argent Bow") || this.hasExactly("Rowdy Sword") || (this.has("Whitewing") && this.rValue == 5 && this.toggle.weapon == 1) || (this.has("Bull Blade") && this.rValue == 5 && this.toggle.weapon >= 10) || (this.has("Panther Lance") && this.rValue == 5 && this.toggle.weapon >= 10) || this.hasExactly("Mogprasir") || this.hasExactly("Vafprudnir") || this.hasExactly("Meisterbogen") || this.hasExactly("Renowned Bow") || this.hasExactly("Ragnell-Alondite") || this.hasExactly("Cordelia's Lance") || (this.hasExactly("Laslow's Blade") && this.rValue == 5 && this.toggle.weapon == 1) || (this.hasExactly("Whitedown Spear") && ((this.rValue < 0 && this.toggle.weapon > 1) || (this.rValue > 0 && this.toggle.weapon == 1))) || this.hasExactly("Hewn Lance") || this.hasExactly("Twin Star Axe") || this.has("Ninja Yari") || this.has("Ninja Katana") || this.hasExactly("Tailwind Shuriken") || this.has("Ninja Masakari") || this.hasExactly("Arden's Blade") || this.hasExactly("Goddess Axe") || (this.hasExactly("Silesse Frost") && (this.toggle.weapon == 1 || this.toggle.weapon == 3)) || (this.hasExactly("Laconic Axe") && this.toggle.weapon == 1) || (this.hasExactly("Gullinkambi Egg") && enemy.combatStartHp / enemy.maxHp >= 0.75 && this.toggle.weapon == 1) || this.hasExactly("Ladyblade") || this.hasExactly("Loyalty Spear") || (this.hasExactly("Mermaid Bow") && this.combatStartHp / this.maxHp >= 0.25 && (thisEffSpd+this.getPhantom("Spd")) > (enemyEffSpd+enemy.getPhantom("Spd")) && ((enemy.color=="green" && this.color=="red") || (enemy.color=="red" && this.color=="blue") || (enemy.color=="blue" && this.color=="green"))) || this.hasExactly("Nabata Kunai") || this.has("Ninja Yumi") || this.has("Ninja Naginata") || this.has("Shuriken Cleaver") || this.hasExactly("Ninjutsu Scrolls") || (this.hasExactly("Sweet Yule Log") && this.combatStartHp / this.maxHp >= 0.25 && this.initiator && thisEffSpd+this.getPhantom("Spd")-enemyEffSpd-enemy.getPhantom("Spd") > 9) || (this.hasExactly("Thunder's Mjolnir") && this.combatStartHp / this.maxHp >= 0.25 && this.initiator && thisEffSpd+this.getPhantom("Spd") >= enemyEffSpd+enemy.getPhantom("Spd") + 10) || (this.hasExactly("Unyielding Oar") && this.combatStartHp / this.maxHp >= 0.25 && (checkAllBuffs(enemy, this, turn) || this.toggle.weapon == 1 || thisEffSpd+this.getPhantom("Spd") >= enemyEffSpd+enemy.getPhantom("Spd") + 10)) || (this.hasExactly("Moonlight Drop") && thisEffRes+this.getPhantom("Res") >= enemyEffRes+enemy.getPhantom("Res") + 15) || (this.hasExactly("Frozen Delight") && this.combineBonPen(enemy,turn,"buff","debuff") >= 12) || (this.hasExactly("Regal Sunshade") && this.combatStartHp / this.maxHp >= 0.25 && this.toggle.weapon == 1) || (this.has("Whitecap Bow") && this.combatStartHp / this.maxHp >= 0.25 && thisEffSpd+this.getPhantom("Spd") >= enemyEffSpd+enemy.getPhantom("Spd") + 10) || this.hasExactly("Tempest's Claw") || this.hasExactly("Crimson Blades") || this.hasExactly("Flowery Scroll") || this.hasExactly("Wyvern Ono") || this.has("Wyvern Yumi") || this.hasExactly("Flamefrost Bow") || this.has("Wyvern Katana") || this.hasExactly("Asura Blades") || (this.hasExactly("Heralding Horn") && (!this.initiator || enemy.combatStartHp / enemy.maxHp >= 0.75) && this.toggle.weapon > 0 && (enemy.color == "red" || !this.initiator)) || this.hasExactly("Surfer's Spire") || this.hasExactly("Surfer's Spade") || (this.hasExactly("Sunlight Bangle") && this.toggle.b > 0) || this.hasExactly("Father's-Son Axe") || (this.hasExactly("Divine Draught") && this.combatStartHp / this.maxHp >= 0.25 && (this.toggle.weapon == 2 || (this.toggle.weapon == 1 && this.initiator))) || this.hasExactly("Dragon's Fist") || this.hasExactly("Absolute Amiti") || this.hasExactly("Scarlet Spear") || this.hasExactly("Spy's Shuriken") || this.has("Kumo Yumi") || this.hasExactly("Radiant Scrolls") || this.has("Kumo Naginata") || this.hasExactly("Troubling Blade") || (this.hasExactly("Goddess Temari") && this.combatStartHp / this.maxHp >= 0.25 && (turn > 3 || this.toggle.weapon == 1) && thisEffRes+this.getPhantom("Res") >= enemyEffRes+enemy.getPhantom("Res") + 5) || this.hasExactly("Blade Royale") || this.hasExactly("Arcadian Axes") || this.hasExactly("Divine One's Arts") || (this.hasExactly("Flingster Spear") && this.combatStartHp / this.maxHp >= 0.25 && this.bonus.breathB) || (this.hasExactly("Fell Child's Might") && (this.initiator || enemy.range == "ranged") && thisEffRes+this.getPhantom("Res") >= enemyEffRes+enemy.getPhantom("Res") + 10) || this.hasExactly("Maritime Arts") || this.hasExactly("The Inexhaustible") || this.hasExactly("Dual Sword") || this.hasExactly("Scroll of Curses") || this.hasExactly("Scroll of Teas") || this.hasExactly("Bold Kusarigama") || this.hasExactly("Ylisse Ninja Bow") || this.has("Giant Shuriken") || this.hasExactly("Red-Fist Blades") || this.hasExactly("Wintery Arts") || this.hasExactly("Nova") || (this.hasExactly("Gentle Fell Egg") && thisEffRes+this.getPhantom("Res") >= enemyEffRes+enemy.getPhantom("Res") + 10)){
				brave = 1;
			}
			//A skill
			if((this.hasExactly("Rare Talent") && this.combatStartHp / this.maxHp >= 0.25 && thisEffRes+this.getPhantom("Res") >= enemyEffRes+enemy.getPhantom("Res") + 10) || (this.hasExactly("Thunder's Fist") && this.combatStartHp / this.maxHp >= 0.25 && this.initiator && this.toggle.a == 1) || (this.hasExactly("Trained to Kill") && this.initiator && this.toggle.a == 1)){
				brave = 1;
			}
			//B skill
			if((this.hasExactly("Double Lion") && this.hp/this.maxHp == 1) || (this.hasExactly("Sunlit Bangle D") && this.combatStartHp / this.maxHp >= 0.25)){
				brave = 1;
			}
			//Special
			if(this.hasExactly("Twin Strike")){
				brave = 1;
			}
			//Support Brave
			if((this.bonus.triAtk && !this.penalty.schism) || this.support.brAtk || (this.emblem == "Eirika" && this.range == "melee" && this.specialIndex != -1 && data.AOESpecials.indexOf(data.skills[this.specialIndex].name) == -1 && data.AOEMultiSpecials.indexOf(data.skills[this.specialIndex].name) == -1)){
				brave = 1;
			}
			if(enemy.support.brAtk || (enemy.emblem == "Eirika" && enemy.range == "melee" && enemy.specialIndex != -1 && data.AOESpecials.indexOf(data.skills[enemy.specialIndex].name) == -1 && data.AOEMultiSpecials.indexOf(data.skills[enemy.specialIndex].name) == -1)){
				counterBrave = 1;
			}
			if(enemy.has("Meisterschwert") || enemy.hasExactly("Wolfskin Fang") || ((enemy.hasExactly("Panther Sword") || enemy.hasExactly("Bull Spear")) && enemy.rValue == 5 && enemy.toggle.weapon == 1) || enemy.has("Meisterbogen") || enemy.hasExactly("Ragnell-Alondite") || (enemy.hasExactly("Laslow's Blade") && enemy.rValue == 5 && enemy.toggle.weapon == 1) || enemy.hasExactly("Twin Star Axe") || enemy.hasExactly("Arden's Blade") || enemy.hasExactly("Goddess Axe") || enemy.hasExactly("Ladyblade") || enemy.hasExactly("Loyalty Spear") || (enemy.has("Festive Siegmund") && enemy.rValue == 5 && enemy.combatStartHp / enemy.maxHp >= 0.25 && enemyEffAtk > thisEffAtk) || (enemy.hasExactly("Unyielding Oar") && enemy.combatStartHp / enemy.maxHp >= 0.25 && (checkAllBuffs(this, enemy, turn) || enemy.toggle.weapon == 1 || enemyEffSpd+enemy.getPhantom("Spd") >= thisEffSpd-this.getPhantom("Spd") + 10)) || (enemy.hasExactly("Regal Sunshade") && enemy.combatStartHp / enemy.maxHp >= 0.25 && enemy.toggle.weapon == 1) || enemy.hasExactly("Tempest's Claw") || enemy.hasExactly("Crimson Blades") || enemy.hasExactly("Flowery Scroll") || enemy.hasExactly("Wyvern Ono") || enemy.has("Wyvern Yumi") || enemy.hasExactly("Flamefrost Bow") || enemy.has("Wyvern Katana") || enemy.hasExactly("Asura Blades") || (enemy.hasExactly("Heralding Horn") && (this.initiator || this.combatStartHp / this.maxHp >= 0.75) && enemy.toggle.weapon > 0 && (this.color == "red" || this.initiator)) || enemy.hasExactly("Surfer's Spire") || enemy.hasExactly("Surfer's Spade") || (enemy.hasExactly("Sunlight Bangle") && enemy.toggle.b > 0) || enemy.hasExactly("Father's-Son Axe") || (enemy.hasExactly("Divine Draught") && enemy.combatStartHp / enemy.maxHp >= 0.25 && enemy.toggle.weapon == 2) || (enemy.hasExactly("Holy War's End 2") && enemy.combatStartHp / enemy.maxHp >= 0.25) || (enemy.hasExactly("Rare Talent") && enemy.combatStartHp / enemy.maxHp >= 0.25 && enemyEffRes+enemy.getPhantom("Res") >= thisEffRes+this.getPhantom("Res") + 10 && this.range == "ranged") || enemy.hasExactly("Dragon's Fist") || enemy.hasExactly("Absolute Amiti") || enemy.hasExactly("Scarlet Spear") || enemy.hasExactly("Radiant Scrolls") || enemy.hasExactly("Troubling Blade") || (enemy.hasExactly("Whitedown Spear") && enemy.rValue > 0 && enemy.toggle.weapon == 1) || enemy.hasExactly("Arcadian Axes") || (enemy.hasExactly("Sunlit Bangle D") && enemy.combatStartHp / enemy.maxHp >= 0.25) || enemy.hasExactly("Divine One's Arts") || (enemy.hasExactly("Flingster Spear") && enemy.combatStartHp / enemy.maxHp >= 0.25 && enemy.bonus.breathB) || (enemy.hasExactly("Fell Child's Might") && (!this.initiator || this.range == "ranged") && enemyEffRes+enemy.getPhantom("Res") >= thisEffRes+this.getPhantom("Res") + 10) || enemy.hasExactly("Maritime Arts") || enemy.hasExactly("The Inexhaustible") || enemy.hasExactly("Dual Sword") || enemy.hasExactly("Scroll of Teas") || enemy.hasExactly("Bold Kusarigama") || enemy.hasExactly("Ylisse Ninja Bow") || enemy.hasExactly("Red-Fist Blades") || enemy.hasExactly("Wintery Arts") || (enemy.hasExactly("Laconic Axe") && enemy.toggle.weapon == 1) || (enemy.hasExactly("Gentle Fell Egg") && enemy.buddy.adjacent + enemy.buddy.two > 0 && enemyEffRes+enemy.getPhantom("Res") >= thisEffRes+this.getPhantom("Res") + 10) || enemy.hasExactly("Twin Strike") || (enemy.hasExactly("Silesse Frost") && enemy.rValue > 0 && this.combatStartHp / this.maxHp >= 0.5 && (enemy.toggle.weapon == 1 || enemy.toggle.weapon == 3))){
				counterBrave = 1;
			}
	
			//check for breaker skills
			//Need to rdo this code to avoid repeating twice...
			var thisBreakLevel = 2; // hp threshold
			if(this.weaponType=="sword" && enemy.has("Swordbreaker")){
				thisBreakLevel = 1.1 - enemy.has("Swordbreaker") * 0.2;
			}
			else if(this.weaponType=="lance" && enemy.has("Lancebreaker")){
				thisBreakLevel = 1.1 - enemy.has("Lancebreaker") * 0.2;
			}
			else if(this.weaponType=="axe" && enemy.has("Axebreaker")){
				thisBreakLevel = 1.1 - enemy.has("Axebreaker") * 0.2;
			}
			else if(this.weaponType=="redtome" && enemy.has("R Tomebreaker")){
				thisBreakLevel = 1.1 - enemy.has("R Tomebreaker") * 0.2;
			}
			else if(this.weaponType=="bluetome" && enemy.has("B Tomebreaker")){
				thisBreakLevel = 1.1 - enemy.has("B Tomebreaker") * 0.2;
			}
			else if(this.weaponType=="greentome" && enemy.has("G Tomebreaker")){
				thisBreakLevel = 1.1 - enemy.has("G Tomebreaker") * 0.2;
			}
			else if(this.weaponType=="bow" && this.color=="gray" && enemy.has("Bowbreaker")){
				thisBreakLevel = 1.1 - enemy.has("Bowbreaker") * 0.2;
			}
			else if(this.weaponType=="dagger" && this.color=="gray" && enemy.has("Daggerbreaker")){
				thisBreakLevel = 1.1 - enemy.has("Daggerbreaker") * 0.2;
			}
			if(this.weaponType=="dagger" && this.color=="gray" && enemy.has("Assassin's Bow")){
				preventThisFollow++;
				enemyAutoFollow++;
			}
			var enemyBreakLevel = 2; // hp threshold
			if(enemy.weaponType=="sword" && this.has("Swordbreaker")){
				enemyBreakLevel = 1.1 - this.has("Swordbreaker") * 0.2;
			}
			else if(enemy.weaponType=="lance" && this.has("Lancebreaker")){
				enemyBreakLevel = 1.1 - this.has("Lancebreaker") * 0.2;
			}
			else if(enemy.weaponType=="axe" && this.has("Axebreaker")){
				enemyBreakLevel = 1.1 - this.has("Axebreaker") * 0.2;
			}
			else if(enemy.weaponType=="redtome" && this.has("R Tomebreaker")){
				enemyBreakLevel = 1.1 - this.has("R Tomebreaker") * 0.2;
			}
			else if(enemy.weaponType=="bluetome" && this.has("B Tomebreaker")){
				enemyBreakLevel = 1.1 - this.has("B Tomebreaker") * 0.2;
			}
			else if(enemy.weaponType=="greentome" && this.has("G Tomebreaker")){
				enemyBreakLevel = 1.1 - this.has("G Tomebreaker") * 0.2;
			}
			else if(enemy.weaponType=="bow" && enemy.color=="gray" && this.has("Bowbreaker")){
				enemyBreakLevel = 1.1 - this.has("Bowbreaker") * 0.2;
			}
			else if(enemy.weaponType=="dagger" && enemy.color=="gray" && this.has("Daggerbreaker")){
				enemyBreakLevel = 1.1 - this.has("Daggerbreaker") * 0.2;
			}
			if(enemy.weaponType=="dagger" && enemy.color=="gray" && this.has("Assassin's Bow")){
				preventEnemyFollow++;
				thisAutoFollow++;
			}
	
			if(enemy.hp / enemy.maxHp >= thisBreakLevel){
				preventThisFollow++;
				enemyAutoFollow++;
			}
			if(this.hp / this.maxHp >= enemyBreakLevel){
				preventEnemyFollow++;
				thisAutoFollow++;
			}
	
			//Check for sweep weapons
			var firesweep = false;
			if(this.has("Firesweep") || this.hasExactly("Steady Lance") || this.hasExactly("Soleil's Shine")){
				firesweep = true;
			}
			else if(this.hasExactly("Deathly Dagger") && this.rValue == 5){
				if(enemy.weaponType == "redtome" || enemy.weaponType == "bluetome" || enemy.weaponType == "greentome" || enemy.weaponType == "graytome"){
					firesweep = true;
				}
			}
			else if(this.hasExactly("Constant Dagger") && ((this.rValue < 0 && this.toggle.weapon == 1 && this.initiator) || (this.rValue > 0 && (this.initiator || this.buddy.adjacent > 0 || this.buddy.two > 0) && (this.toggle.weapon == 1 || thisEffSpd+this.getPhantom("Spd") > enemyEffSpd+enemy.getPhantom("Spd"))))){
				firesweep = true;
			}
			else if(this.hasExactly("Mirage Longbow") && ((this.rValue < 0 && thisEffSpd+this.getPhantom("Spd") > enemyEffSpd+enemy.getPhantom("Spd")) || this.rValue > 0)){
				firesweep = true;
			}
			else if(this.hasExactly("Sniper's Bow") && this.rValue == 5 && this.combatStartHp / this.maxHp >= 0.5 && this.toggle.weapon == 1){
				firesweep = true;
			}
			else if(this.hasExactly("Survivalist Bow") && ((enemy.combatStartHp / enemy.maxHp >= 0.8 && this.buddy.adjacent == 0) || (this.rValue > 0 && enemy.combatStartHp / enemy.maxHp >= 0.5 && (this.initiator || this.buddy.adjacent < 2)))){
				firesweep = true;
			}
			else if(this.hasExactly("Luin") && (thisEffSpd+this.getPhantom("Spd") > enemyEffSpd+enemy.getPhantom("Spd") + 5 || (this.rValue > 0 && thisEffSpd+this.getPhantom("Spd") >= enemyEffSpd+enemy.getPhantom("Spd") - 7))){
				firesweep = true;
			}
			else if(this.hasExactly("Dracofalchion") && this.rValue == 5 && this.combatStartHp / this.maxHp >= 0.25 && data.physicalWeapons.indexOf(enemy.weaponType) != -1 && thisEffSpd+this.getPhantom("Spd") > enemyEffSpd-enemy.getPhantom("Spd")){
				firesweep = true;
			}
			else if(this.hasExactly("Blade of Jehanna") && this.toggle.weapon == 1){
				firesweep = true;
			}
			else if(this.hasExactly("Bright-Shell Egg") && (checkAllBuffs(this, enemy, turn) || this.toggle.weapon > 1) && this.combineBonPen(enemy,turn,"buff","debuff") >= 18){
				firesweep = true;
			}
			else if((this.hasExactly("Quick Mulagir") || this.hasExactly("Chilled Breath")) && (this.initiator || this.toggle.weapon == 1) && thisEffSpd + this.getPhantom("Spd") >= enemyEffSpd + enemy.getPhantom("Spd") + 5){
				firesweep = true;
			}
			else if(this.hasExactly("Adroit War Tome") && this.combatStartHp / this.maxHp >= 0.25 && thisEffRes + this.getPhantom("Res") - enemyEffRes - enemy.getPhantom("Res") >= 5 && data.physicalWeapons.indexOf(enemy.weaponType) != -1){
				firesweep = true;
			}
			else if(this.hasExactly("Imhullu") && this.rValue == 5 && this.combatStartHp / this.maxHp >= 0.25 && enemy.weaponType.indexOf("tome") == -1){
				firesweep = true;
			}
			else if(this.hasExactly("Luna Arc") && this.rValue == 5 && this.combatStartHp / this.maxHp >= 0.25 && thisEffSpd + this.getPhantom("Spd") - enemyEffSpd - enemy.getPhantom("Spd") >= 5 && data.physicalWeapons.indexOf(enemy.weaponType) != -1){
				firesweep = true;
			}
			else if(this.hasExactly("Soothing Scent") && this.combatStartHp / this.maxHp >= 0.25 && thisEffSpd + this.getPhantom("Spd") > enemyEffSpd + enemy.getPhantom("Spd")){
				firesweep = true;
			}
			else if(this.hasExactly("Faithful Breath") && this.combatStartHp / this.maxHp >= 0.4 && this.initiator && (enemy.color == "blue" || this.toggle.weapon == 1)){
				firesweep = true;
			}
			else if(this.hasExactly("Deep-Blue Bow") && this.rValue == 5 && this.combatStartHp / this.maxHp >= 0.25 && thisEffSpd + this.getPhantom("Spd") - enemyEffSpd - enemy.getPhantom("Spd") >= 5 && enemy.range == "melee"){
				firesweep = true;
			}
			else if(this.hasExactly("Enclosing Dark") && (this.initiator || this.toggle.weapon > 9) && (this.toggle.weapon == 2 || this.toggle.weapon == 12)){
				firesweep = true;
			}
			else if(this.hasExactly("Fujin-Raijin Yumi") && this.combatStartHp / this.maxHp >= 0.25 && (thisEffSpd + this.getPhantom("Spd") > enemyEffSpd - enemy.getPhantom("Spd") || enemy.color == "green")){
				firesweep = true;
			}
			else if(this.hasExactly("Eagle's Egg") && this.rValue == 5 && this.combatStartHp / this.maxHp >= 0.25 && (this.toggle.weapon == 3 || this.toggle.weapon == 5 || this.toggle.weapon == 6 || this.toggle.weapon == 7)){
				firesweep = true;
			}
			else if(this.hasExactly("Knightly Manner") && this.combatStartHp / this.maxHp >= 0.25 && enemy.weaponType != "bow" && enemy.weaponType != "dagger"){
				firesweep = true;
			}
			else if(this.hasExactly("Gray Illusion") && (this.initiator || enemy.combatStartHp / enemy.maxHp >= 0.75) && thisEffRes + this.getPhantom("Res") > enemyEffRes + enemy.getPhantom("Res")){
				firesweep = true;
			}
			else if(this.hasExactly("Fluttering Fan") && this.buddy.rorc > 0 && thisEffSpd + this.getPhantom("Spd") > enemyEffSpd + enemy.getPhantom("Spd")){
				firesweep = true;
			}
			else if(this.hasExactly("Tome of Storms") && this.rValue > 0 && (this.initiator || enemy.combatStartHp / enemy.maxHp >= 0.75) && thisEffSpd+this.getPhantom("Spd") > enemyEffSpd+enemy.getPhantom("Spd")){
				firesweep = true;
			}
			//enemy weapon sweep check
			if(enemy.has("Firesweep") || enemy.hasExactly("Steady Lance") || enemy.hasExactly("Soleil's Shine")){
				firesweep = true;
			}
			//check for A skill sweeps
			var aSweep = false;
			if(this.hasExactly("Laws of Sacae 2") && (this.initiator || this.toggle.weapon == 1) && thisEffSpd+this.getPhantom("Spd") > enemyEffSpd+enemy.getPhantom("Spd")+5 && enemy.range == "melee"){
				aSweep = true;
			}
			//check for B skill sweeps
			var windsweep = 0;
			if(this.has("Windsweep")){
				windsweep = this.has("Windsweep")*-2 + 7;
				preventThisFollow++;
			}
			var watersweep = 0;
			if(this.has("Watersweep")){
				watersweep = this.has("Watersweep")*-2 + 7;
				preventThisFollow++;
			}
			var bSweep = false;
			if(this.hasExactly("Sacae's Blessing")){
				if(enemy.weaponType == "sword" || enemy.weaponType == "lance" || enemy.weaponType == "axe"){
					bSweep = true;
				}
			}
			else if(this.hasExactly("Murderous Lion") && this.toggle.b == 1){
				bSweep = true;
			}
			
			var enemyCanCounter = false;
			var thisFollowUp = false;
			var enemyFollowUp = false;
				
			var thisOutspeeds = false;
			var enemyOutspeeds = false;
			var thisSpeedBlade = false;
			var enemySpeedBlade = false;
			var thisPotent = 0;
			var enemyPotent = 0;
			var thisSpeedDiff = 5;
			var enemySpeedDiff = 5;
			if((this.hasExactly("Fair-Fight Blade") && this.combatStartHp / this.maxHp >= 0.25) || (this.hasExactly("Bold Kusarigama") && (this.initiator || this.buddy.adjacent > 0 || this.buddy.two > 0))){
				thisSpeedDiff += 20;
				enemySpeedDiff += 20;
			}
			if((enemy.hasExactly("Fair-Fight Blade") && enemy.combatStartHp / enemy.maxHp >= 0.25) || (enemy.hasExactly("Bold Kusarigama") && (!this.initiator || enemy.buddy.adjacent > 0 || enemy.buddy.two > 0))){
				thisSpeedDiff += 20;
				enemySpeedDiff += 20;
			}
			if(this.hasExactly("Sandstorm") && thisEffDef > enemyEffDef){
				var ssVal = Math.min(thisEffDef - enemyEffDef, 10);
				thisSpeedDiff += ssVal;
				enemySpeedDiff -= ssVal;
			}
			else if(this.hasExactly("Crimson Lance") && this.combatStartHp / this.maxHp >= 0.25 && thisEffDef > enemyEffDef){
				var clVal = (thisEffDef - enemyEffDef) * 2;
				thisSpeedDiff += clVal;
			}
			if(enemy.hasExactly("Sandstorm") && enemyEffDef > thisEffDef){
				var ssVal = Math.min(enemyEffDef - thisEffDef, 10);
				enemySpeedDiff += ssVal;
				thisSpeedDiff -= ssVal;
			}
			else if(enemy.hasExactly("Crimson Lance") && enemy.combatStartHp / enemy.maxHp >= 0.25 && enemyEffDef > thisEffDef){
				var clVal = (enemyEffDef - thisEffDef) * 2;
				enemySpeedDiff += clVal;
			}
			if((this.hasExactly("Wyvern Rift") && thisEffSpd + thisEffDef >= enemyEffSpd + enemyEffDef - 10) || (this.hasExactly("Pegasus Rift") && thisEffSpd + thisEffRes >= enemyEffSpd + enemyEffRes - 10)){
				thisSpeedDiff += 20;
			}
			else if(this.hasExactly("Clever Fighter") || (this.hasExactly("Edged Scales") && (!this.initiator || this.combatStartHp / this.maxHp >= 0.25))){
				thisSpeedDiff += 10;
			}
			if((enemy.hasExactly("Wyvern Rift") && enemyEffSpd + enemyEffDef >= thisEffSpd + thisEffDef - 10) || (enemy.hasExactly("Pegasus Rift") && enemyEffSpd + enemyEffRes >= thisEffSpd + thisEffRes - 10)){
				enemySpeedDiff += 20;
			}
			else if(enemy.hasExactly("Clever Fighter") || (enemy.hasExactly("Edged Scales") && (this.initiator || enemy.combatStartHp / enemy.maxHp >= 0.25))){
				enemySpeedDiff += 10;
			}
			else if(enemy.hasExactly("Laguz Loyalty") && enemy.specialIndex != -1 && (data.skills[enemy.specialIndex].charge - enemy.initSkillCharge() >= 3 || data.defensiveSpecials.indexOf(data.skills[enemy.specialIndex].name) != -1)){
				thisSpeedDiff -= 10;
			}
			if(this.bonus.sdiff){
				thisSpeedDiff += 10;
			}
			if(enemy.bonus.sdiff){
				enemySpeedDiff += 10;
			}
			if(enemy.penalty.frozen){
				thisSpeedDiff += 10;
				enemySpeedDiff -= 10;
				if(thisEffDef > enemyEffDef){
					thisSpeedDiff += (thisEffDef - enemyEffDef) * 2;
					enemySpeedDiff -= (thisEffDef - enemyEffDef) * 2;
				}
			}
			if(this.penalty.frozen){
				enemySpeedDiff += 10;
				thisSpeedDiff -= 10;
				if(enemyEffDef > thisEffDef){
					enemySpeedDiff += (enemyEffDef - thisEffDef) * 2;
					thisSpeedDiff -= (enemyEffDef - thisEffDef) * 2;
				}
			}
			if(thisEffSpd - enemyEffSpd >= enemySpeedDiff){
				thisOutspeeds = true;
			}
			else if(enemyEffSpd - thisEffSpd >= thisSpeedDiff){
				enemyOutspeeds = true;
			}
			
			if(enemy.weaponIndex != -1 && !firesweep && !aSweep && !bSweep && !(windsweep && data.physicalWeapons.indexOf(enemy.weaponType) != -1 && thisEffSpd+this.getPhantom("Spd")-enemyEffSpd-enemy.getPhantom("Spd") >= windsweep) && !(watersweep && data.magicalWeapons.indexOf(enemy.weaponType) != -1 && thisEffSpd+this.getPhantom("Spd")-enemyEffSpd-enemy.getPhantom("Spd") >= watersweep)){
				if(this.range==enemy.range || anyRangeCounter){
					enemyCanCounter = true;
				}
			}
			
			//Ayra's Blade type speed cd check
			if((this.hasExactly("Ayra's Blade") && this.rValue < 0)|| this.has("Flashing Blade") || ((this.hasExactly("Wing Sword") || this.hasExactly("Rhomphaia") || this.hasExactly("Niles's Bow")) && this.rValue == 5) || (this.hasExactly("Sparkling Fang") && enemy.combatStartHp / enemy.maxHp >= 0.75) || (this.support.infantryFlash == true && this.moveType == "infantry")){
				var sdiff = 0;
				if((this.hasExactly("Ayra's Blade") && this.rValue < 0) || this.hasExactly("Wing Sword") || this.hasExactly("Rhomphaia") || this.hasExactly("Niles's Bow") || (this.hasExactly("Sparkling Fang") && enemy.combatStartHp / enemy.maxHp >= 0.75) || (this.support.infantryFlash == true && this.moveType == "infantry")){
					sdiff = 1;
				}
				else if(this.has("Flashing Blade")){
					var sdValue = this.hasGreatest("Flashing Blade");
					sdiff = Math.abs(sdValue[0]*-2 + 7);
				}
				if((thisEffSpd+this.getPhantom("Spd")) - (enemyEffSpd+enemy.getPhantom("Spd")) >= sdiff){
					thisSpeedBlade = true;
				}
			}
			if((enemy.hasExactly("Ayra's Blade") && this.rValue < 0) || enemy.has("Flashing Blade") || ((enemy.hasExactly("Wing Sword") || enemy.hasExactly("Rhomphaia") || enemy.hasExactly("Niles's Bow")) && enemy.rValue == 5) || (enemy.hasExactly("Sparkling Fang") && this.combatStartHp / this.maxHp >= 0.75) || (enemy.support.infantryFlash == true && enemy.moveType == "infantry")){
				var sdiff = 0;
				if((enemy.hasExactly("Ayra's Blade") && this.rValue < 0) || enemy.hasExactly("Wing Sword") || enemy.hasExactly("Rhomphaia") || enemy.hasExactly("Niles's Bow") || (enemy.hasExactly("Sparkling Fang") && this.combatStartHp / this.maxHp >= 0.75) || (enemy.support.infantryFlash == true && enemy.moveType == "infantry")){
					sdiff = 1;
				}
				else if(enemy.has("Flashing Blade")){
					var sdValue = enemy.hasGreatest("Flashing Blade");
					sdiff = Math.abs(sdValue[0]*-2 + 7);
				}
				if((enemyEffSpd+enemy.getPhantom("Spd")) - (thisEffSpd+this.getPhantom("Spd")) >= sdiff){
					enemySpeedBlade = true;
				}
			}
	
			//TODO: refactor these ifs and above ifs
			if((this.has("Dazzling Staff") || this.hasExactly("Dazzling Shift") || this.hasExactly("Dazzle Far Trace") || this.hasExactly("Dazzling Discord")) && enemyCanCounter && !enemy.hasExactly("Mystic Boost 4")){
				if((this.combatStartHp / this.maxHp >= 1.5 + this.has("Dazzling Staff") * -0.5) || this.hasExactly("Dazzling Shift") || this.hasExactly("Dazzle Far Trace") || this.hasExactly("Dazzling Discord")){
					roundText += this.name + " prevents " + enemy.name + " from counterattacking with " + data.skills[this.bIndex].name + ".<br>";
					enemyCanCounter = false;
				}
			}
			if(this.weaponIndex > -1 && !enemy.hasExactly("Mystic Boost 4")){
				if(data.skills[this.weaponIndex].inheritrule != "unique" && this.weaponType == "staff" && (this.rValue == 7 || this.rValue > 10) && enemyCanCounter){
					roundText += this.name + " prevents " + enemy.name + " from counterattacking with Dazzling Staff Refinement.<br>";
					enemyCanCounter = false;
				}
				else if((this.hasExactly("Hlidskjalf") || this.hasExactly("Sanngridr") || this.hasExactly("Elena's Staff") || this.hasExactly("Springtime Staff") || this.hasExactly("Staff of the Saint") || this.hasExactly("Doting Staff") || this.hasExactly("Dusk-Dawn Staff") || this.hasExactly("Sacrifice Staff") || this.hasExactly("Thief") || this.hasExactly("Exalt's War Staff") || this.hasExactly("Snowman Staff") || this.hasExactly("Staff of Yngvi") || this.hasExactly("Salvage")) && enemyCanCounter){
					roundText += this.name + " prevents " + enemy.name + " from counterattacking with " + data.skills[this.weaponIndex].name + ".<br>";
					enemyCanCounter = false;
				}
			}
			if(((this.has("Binding Shield") && enemy.weaponType == "dragon") || (this.hasExactly("Binding Shield 2") && thisEffSpd+this.getPhantom("Spd") >= enemyEffSpd+enemy.getPhantom("Spd")+5)) && enemyCanCounter){
				enemyCanCounter = false;
				roundText += this.name + " prevents " + enemy.name + " from counterattacking with " + data.skills[this.bIndex].name + ".<br>";
			}
			if(this.hasExactly("Nidhogg") && this.rValue == 5 && (enemy.weaponType == "dragon" || enemy.weaponType.indexOf("tome") != -1) && enemyCanCounter){
				enemyCanCounter = false;
				roundText += this.name + " prevents " + enemy.name + " from counterattacking with Nidhogg.<br>";
			}
			if(this.hasExactly("Atk Spd Tidings") && enemyCanCounter){
				enemyCanCounter = false;
				roundText += this.name + " prevents " + enemy.name + " from counterattacking with " + data.skills[this.aIndex].name + ".<br>";
			}
			if(enemy.penalty.lit && enemyCanCounter){
				roundText += enemy.name + " cannot counterattack due to no counter debuff.<br>";
				enemyCanCounter = false;
			}
			
			//Check for Null C-Disrupt
			if(enemy.has("Null C-Disrupt") && !enemyCanCounter && (this.range == enemy.range || anyRangeCounter)){
				var ncdVal = 0;
				if(enemy.hasExactly("Null C-Disrupt 1") || enemy.hasExactly("Null C-Disrupt 2") || enemy.hasExactly("Null C-Disrupt 3")){
					ncdVal = enemy.has("Null C-Disrupt");
				}
				if((enemy.hasExactly("Null C-Disrupt 4") || enemy.hasExactly("Null C-Disrupt E") || (enemy.combatStartHp / enemy.maxHp >= 1.5 + ncdVal * -0.5))){
					enemyCanCounter = true;
					roundText += enemy.name + " can now counterattack with Null C-Disrupt.<br>";
				}
			}
			if(enemy.hasExactly("Nifl's Bite") && !enemyCanCounter && enemy.toggle.weapon == 1 && this.range == "ranged"){
				enemyCanCounter = true;
				roundText += enemy.name + " can now counterattack with Nifl's Bite.<br>";
			}
			else if(enemy.hasExactly("Brilliant Starlight") && enemy.combatStartHp / enemy.maxHp >= 0.25 && !enemyCanCounter && (this.range == "ranged" || anyRangeCounter)){
				enemyCanCounter = true;
				roundText += enemy.name + " can now counterattack with Brilliant Starlight.<br>";
			}
			else if((enemy.hasExactly("Ice-Bound Brand") || enemy.hasExactly("Ice-Crystal Spear")) && !enemyCanCounter && this.range == "ranged" && anyRangeCounter){
				enemyCanCounter = true;
				roundText += enemy.name + " can now counterattack with " + data.skills[this.weaponIndex].name + ".<br>";
			}
			else if(enemy.hasExactly("Virtuous Tyrfing") && !enemyCanCounter && (this.range==enemy.range || anyRangeCounter) && enemy.rValue > 0 && (enemy.combatStartHp / enemy.maxHp < 1 || this.initiator || this.combatStartHp / this.maxHp >= 0.75)){
				enemyCanCounter = true;
				roundText += enemy.name + " can now counterattack with Virtuous Tyrfing.<br>";
			}
			else if(enemy.hasExactly("Holy Yule Blade") && enemy.combatStartHp / enemy.maxHp >= 0.25 && !enemyCanCounter && this.range == "ranged"){
				enemyCanCounter = true;
				roundText += enemy.name + " can now counterattack with Holy Yule Blade.<br>";
			}
			else if(enemy.hasExactly("Emblem Ragnell") && enemy.combatStartHp / enemy.maxHp >= 0.25 && !enemyCanCounter && (this.range==enemy.range || anyRangeCounter)){
				enemyCanCounter = true;
				roundText += enemy.name + " can now counterattack with Emblem Ragnell.<br>";
			}
			else if(enemy.hasExactly("Aether's Path") && !enemyCanCounter && (this.range==enemy.range || anyRangeCounter)){
				enemyCanCounter = true;
				roundText += enemy.name + " can now counterattack with Aether's Path.<br>";
			}
			else if(enemy.hasExactly("Shield of Hope") && enemy.toggle.b > 2 && !enemyCanCounter && (this.range==enemy.range || anyRangeCounter)){
				enemyCanCounter = true;
				roundText += enemy.name + " can now counterattack with Shield of Hope.<br>";
			}
			if(parity && !enemyCanCounter && (this.range==enemy.range || anyRangeCounter)){
				enemyCanCounter = true;
				roundText += enemy.name + " can now counterattack.<br>";
			}
			if(enemy.support.nullCD && !enemyCanCounter && (this.range==enemy.range || anyRangeCounter)){
				enemyCanCounter = true;
				roundText += enemy.name + " can now counterattack with Null C-Disrupt Support.<br>";
			}
			
			//ELyn/Astra Storm/Wind Sword Style Check (comes after NCD check since NCD can't stop it)
			if(!(enemy.moveType == "armored" && enemy.range == "ranged") && !anyRangeCounter && (this.style == 1 || this.style == 2) && this.tstyle == true){
				enemyCanCounter = false;
				roundText += enemy.name + " cannot counterattack due to Style.<br>";
			}
			else if(!(enemy.moveType == "armored" && enemy.range == "melee") && !anyRangeCounter && this.style == 3 && this.tstyle == true){
				enemyCanCounter = false;
				roundText += enemy.name + " cannot counterattack due to Style.<br>";
			}
			
			//Check for brash assault
			if(this.hasSlot("Brash Assault","b") && enemyCanCounter == true){
				if((this.hp/this.maxHp <= 0.2 + (this.hasSlot("Brash Assault","b") * 0.1)) || (this.hasSlot("Brash Assault","b") == 4 && (this.combatStartHp / this.maxHp < 1 || enemy.combatStartHp / enemy.maxHp >= 1))){
					thisAutoFollow++;
				}
			}
			if(this.hasSlot("Brash Assault","s") && enemyCanCounter == true){
				if(this.hp/this.maxHp <= 0.2 + (this.hasSlot("Brash Assault","s") * 0.1)){
					thisAutoFollow++;
				}
			}
			//Weapon (Sol Katti)
			if((this.has("Sol Katti") && this.rValue == 5) && enemyCanCounter == true){
				if(this.hp/this.maxHp <= 0.75){
					thisAutoFollow++;
				}
			}
			//Hoarfrost Knife
			if(this.hasExactly("Hoarfrost Knife") && enemyCanCounter == true && this.initiator){
				if(this.rValue > 0 || (this.rValue < 0 && enemy.range == "melee")){
					thisAutoFollow++;
				}
			}
			if(this.hasExactly("Headsman Glitnir") && this.combatStartHp / this.maxHp >= 0.25  && (!this.initiator || enemyCanCounter == true)){
				thisAutoFollow++;
			}
			if(enemy.hasExactly("Headsman Glitnir") && enemy.combatStartHp / enemy.maxHp >= 0.25  && this.initiator){
				enemyAutoFollow++;
			}
			//NFU checks
			//a skills
			if((this.hasExactly("Swift Ice") || this.hasExactly("Trained to Kill")) && (this.initiator || this.buddy.adjacent > 0 || this.buddy.two > 0)){
				enemyAutoFollow = 0;
				preventThisFollow = 0;
				roundText += this.name + " has applied " + data.skills[this.aIndex].name + " and disables follow-up denial and enemy auto follow-up.<br>";
			}
			if((enemy.hasExactly("Swift Ice") || enemy.hasExactly("Trained to Kill")) && (!this.initiator || enemy.buddy.adjacent > 0 || enemy.buddy.two > 0)){
				thisAutoFollow = 0;
				preventEnemyFollow = 0;
				roundText += enemy.name + " has applied " + data.skills[enemy.aIndex].name + " and disables follow-up denial and enemy auto follow-up.<br>";
			}
			if(this.hasExactly("Perfect Atk Spd") && (this.combatStartHp / this.maxHp >= 0.25 || this.buddy.adjacent + this.buddy.two + this.buddy.three > 0) && thisEffSpd + this.getPhantom("Spd") > enemyEffSpd + enemy.getPhantom("Spd")){
				enemyAutoFollow = 0;
				preventThisFollow = 0;
				roundText += this.name + " has applied " + data.skills[this.aIndex].name + " and disables follow-up denial and enemy auto follow-up.<br>";
			}
			if(enemy.hasExactly("Perfect Atk Spd") && (enemy.combatStartHp / enemy.maxHp >= 0.25 || enemy.buddy.adjacent + enemy.buddy.two + enemy.buddy.three > 0) && thisEffSpd + this.getPhantom("Spd") < enemyEffSpd + enemy.getPhantom("Spd")){
				thisAutoFollow = 0;
				preventEnemyFollow = 0;
				roundText += enemy.name + " has applied " + data.skills[enemy.aIndex].name + " and disables follow-up denial and enemy auto follow-up.<br>";
			}
			//Null Follow Up/Soul of Zofia Mechanic
			if(((this.hasSlot("Null Follow Up 1","b") || this.hasSlot("Null Follow Up 1","s")) && this.hp/this.maxHp == 1) || ((this.hasSlot("Null Follow Up 2","b") || this.hasSlot("Null Follow Up 2","s")) && this.hp/this.maxHp >= .5) || this.hasSlot("Null Follow Up 3","b") || this.hasSlot("Null Follow Up 3","s") || this.has("Soul of Zofia") || ((this.has("Sun-Twin Wing") || this.hasExactly("Tut-Tut")) && this.hp / this.maxHp >= 0.25) || this.hasExactly("Lunar Brace 2") || this.hasExactly("Phys Null Follow") || this.hasExactly("Mag Null Follow") || (this.hasExactly("Absolute Closure") && this.transform == true) || this.hasExactly("Clever Fighter") || (this.hasExactly("Heavenly Wings") && this.combatStartHp / this.maxHp >= 0.25) || (this.hasExactly("Pure Atrocity") && (this.initiator || this.buddy.adjacent > 0 || this.buddy.two > 0)) || this.hasExactly("Shield of Hope")){
				enemyAutoFollow = 0;
				preventThisFollow = 0;
				var nfText = "";
				if(this.hasSlot("Null Follow Up","s")){
					nfText = data.skills[this.sIndex].name;
				}
				else if(this.hasExactly("Absolute Closure") && this.transform == true){
					nfText = data.skills[this.cIndex].name;
				}
				else{
					nfText = data.skills[this.bIndex].name;
				}
				roundText += this.name + " has applied " + nfText + " and disables follow-up denial and enemy auto follow-up.<br>";
			}
			if(((enemy.hasSlot("Null Follow Up 1","b") || enemy.hasSlot("Null Follow Up 1","s")) && enemy.hp/enemy.maxHp == 1) || ((enemy.hasSlot("Null Follow Up 2","b") || enemy.hasSlot("Null Follow Up 2","s")) && enemy.hp/enemy.maxHp >= .5) || enemy.hasSlot("Null Follow Up 3","b") || enemy.hasSlot("Null Follow Up 3","s") || enemy.has("Soul of Zofia") || ((enemy.has("Sun-Twin Wing") || enemy.hasExactly("Tut-Tut")) && enemy.hp / enemy.maxHp >= 0.25) || enemy.hasExactly("Lunar Brace 2") || enemy.hasExactly("Phys Null Follow") || enemy.hasExactly("Mag Null Follow") || (enemy.hasExactly("Absolute Closure") && enemy.transform == true) || enemy.hasExactly("Clever Fighter") || (enemy.hasExactly("Heavenly Wings") && enemy.combatStartHp / enemy.maxHp >= 0.25) || (enemy.hasExactly("Pure Atrocity") && (!this.initiator || enemy.buddy.adjacent > 0 || enemy.buddy.two > 0)) || enemy.hasExactly("Shield of Hope")){
				thisAutoFollow = 0;
				preventEnemyFollow = 0;
				var nfText = "";
				if(enemy.hasSlot("Null Follow Up","s")){
					nfText = data.skills[enemy.sIndex].name;
				}
				else if(enemy.hasExactly("Absolute Closure") && enemy.transform == true){
					nfText = data.skills[enemy.cIndex].name;
				}
				else{
					nfText = data.skills[enemy.bIndex].name;
				}
				roundText += enemy.name + " has applied " + nfText + " and disables follow-up denial and enemy auto follow-up.<br>";
			}
			
			//Daring Fighter/Courtly Fan/Mjolnir
			if(((this.has("Daring Fighter") || this.has("Courtly Fan")) && this.initiator) || (this.hasExactly("Mjolnir") && (this.initiator || this.toggle.weapon == 1) && this.rValue == 5)){
				preventThisFollow = 0;
				roundText += this.name + " disables follow-up denial.<br>";
			}
			//Flow B
			if((((this.has("Flow Refresh") == 1 || this.has("Flow Guard") == 1 || this.has("Flow Flight") == 1 || this.has("Flow Force") == 1 || this.has("Flow Feather") == 1 || this.has("Flow N Trace") == 1) && this.hp / this.maxHp >= 1) || ((this.has("Flow Refresh") == 2 || this.has("Flow Guard") == 2 || this.has("Flow Flight") == 2 || this.has("Flow Force") == 2 || this.has("Flow Feather") == 2 || this.has("Flow N Trace") == 2) && this.hp / this.maxHp >= 0.5) || (this.has("Flow Refresh") >= 3) || (this.has("Flow Guard") >= 3) || (this.has("Flow Flight") == 3) || (this.has("Flow Force") == 3) || (this.has("Flow Feather") == 3) || (this.has("Flow N Trace") == 3) || (this.hasExactly("Flow Desperation"))) && this.initiator){
				preventThisFollow = 0;
				var flowText = "";
				if(this.hasExactly("Flow Guard 4")){
					enemyAutoFollow = 0;
					flowText = " and enemy auto follow-up";
				}
				roundText += this.name + " disables follow-up denial" + flowText + ".<br>";
			}
			//Dragon's Ire
			if(enemy.has("Dragon's Ire") && this.initiator){
				if(enemy.hp/enemy.maxHp >= 1.25 - 0.25 * enemy.has("Dragon's Ire")){
					preventEnemyFollow = 0;
					roundText += enemy.name + " disables follow-up denial.<br>";
				}
			}
			if(this.has("Hardy Fighter")){
				enemyAutoFollow = 0;
				roundText += this.name + " disables auto follow-up on " + enemy.name + ".<br>";
			}
			if(enemy.has("Hardy Fighter")){
				thisAutoFollow = 0;
				roundText += enemy.name + " disables auto follow-up on " + this.name + ".<br>";
			}
			if(this.has("Savvy Fighter") && !this.initiator){
				enemyAutoFollow = 0;
				preventThisFollow = 0;
				roundText += this.name + " has applied " + data.skills[this.bIndex].name + " on " + enemy.name + ".<br>";
			}
			if(enemy.has("Savvy Fighter") && this.initiator){
				thisAutoFollow = 0;
				preventEnemyFollow = 0;
				roundText += enemy.name + " has applied " + data.skills[enemy.bIndex].name + " on " + this.name + ".<br>";
			}
			if(this.has("Faithful Loyalty")){
				preventThisFollow = 0;
				if(this.hasExactly("Faithful Loyalty 2")){
					enemyAutoFollow = 0;
				}
			}
			if(enemy.has("Faithful Loyalty")){
				preventEnemyFollow = 0;
				if(enemy.hasExactly("Faithful Loyalty 2")){
					thisAutoFollow = 0;
				}
			}
			if(this.has("Beast Agility") || (this.hasExactly("Bestial Agility") && (this.transform == true || this.combatStartHp / this.maxHp >= 0.25))){
				var baVal = 19 - (this.has("Beast Agility") * 6);
				baVal = Math.max(baVal,1);
				if(this.hasExactly("Bestial Agility")){
					baVal = 1;
				}
				if(this.getPhantom("Spd") + thisEffSpd >= enemy.getPhantom("Spd") + enemyEffSpd + baVal){
					preventThisFollow = 0;
					if(this.hasExactly("Beast Agility 4") || this.hasExactly("Bestial Agility")){
						enemyAutoFollow = 0;
					}
				}
			}
			if(enemy.has("Beast Agility") || (enemy.hasExactly("Bestial Agility") && (enemy.transform == true || enemy.combatStartHp / enemy.maxHp >= 0.25))){
				var baVal = 19 - (enemy.has("Beast Agility") * 6);
				baVal = Math.max(baVal,1);
				if(enemy.hasExactly("Bestial Agility")){
					baVal = 1;
				}
				if(enemy.getPhantom("Spd") + enemyEffSpd >= this.getPhantom("Spd") + thisEffSpd + baVal){
					preventEnemyFollow = 0;
					if(enemy.hasExactly("Beast Agility 4") || enemy.hasExactly("Bestial Agility")){
						thisAutoFollow = 0;
					}
				}
			}
			if(this.hasExactly("Raging Storm 2") && (this.combatStartHp / this.maxHp >= 0.25 || this.toggle.b == 1) && (enemy.weaponType == "dragon" || enemy.weaponType == "beast")){
				preventThisFollow = 0;
				roundText += this.name + " has applied Raging Storm 2 and disables follow-up denial.<br>";
			}
			if(enemy.hasExactly("Raging Storm 2") && (enemy.combatStartHp / enemy.maxHp >= 0.25 || enemy.toggle.b == 1) && (this.weaponType == "dragon" || this.weaponType == "beast")){
				preventEnemyFollow = 0;
				roundText += enemy.name + " has applied Raging Storm 2 and disables follow-up denial.<br>";
			}
			if(this.hasExactly("Spoil Rotten") && this.combatStartHp / this.maxHp >= 0.25){
				preventThisFollow = 0;
				roundText += this.name + " has applied Spoil Rotten and disables follow-up denial.<br>";
			}
			if(enemy.hasExactly("Spoil Rotten") && enemy.combatStartHp / enemy.maxHp >= 0.25){
				preventEnemyFollow = 0;
				roundText += enemy.name + " has applied Spoil Rotten and disables follow-up denial.<br>";
			}
			
			if((this.hasExactly("Divine Talon") && (this.transform == true || enemy.combatStartHp / enemy.maxHp >= 0.75))){
				enemyAutoFollow = 0;
				preventThisFollow = 0;
				roundText += this.name + " has applied " + data.skills[this.cIndex].name + " and disables follow-up denial and enemy auto follow-up.<br>";
			}
			if((enemy.hasExactly("Divine Talon") && (enemy.transform == true || this.combatStartHp / this.maxHp >= 0.75))){
				thisAutoFollow = 0;
				preventEnemyFollow = 0;
				roundText += enemy.name + " has applied " + data.skills[enemy.cIndex].name + " and disables follow-up denial and enemy auto follow-up.<br>";
			}
			
			if(this.hasExactly("Creator Sword") || (this.hasExactly("Mareeta's Sword") && (this.toggle.weapon == 1 || (this.rValue > 0 && this.initiator))) || this.hasExactly("Bun-Bun Baton") || (this.hasExactly("Winds of Change") && (this.combatStartHp / this.maxHp >= 0.5 || checkAllBuffs(this, enemy, turn) || (this.rValue > 0 && Object.values(this.bonus).reduce((a, item) => a + (item === true ? 1 : 0), 0) + this.bonus.extra > 0))) || (this.hasExactly("Sun's Percussors") && (allStats[17] + this.getPhantom("Spd") > allStats[21] + enemy.getPhantom("Spd") || enemy.combatStartHp / enemy.maxHp == 1 || (this.rValue > 0 && (allStats[17] + this.getPhantom("Spd") >= allStats[21] + enemy.getPhantom("Spd") - 5 || enemy.combatStartHp / enemy.maxHp >= 0.75)))) || (this.hasExactly("Tome of Storms") && (enemy.combatStartHp / enemy.maxHp >= 0.75 || (this.rValue > 0 && this.initiator))) || ((this.hasExactly("Failnaught") || this.hasExactly("Hungry Cat Fang")) && this.combatStartHp / this.maxHp >= 0.25) || (this.hasExactly("Raijinto") && this.rValue == 5 && (this.initiator || this.toggle.weapon == 1)) || (this.hasExactly("Vassal's Blade") && this.rValue == 5 && enemy.combatStartHp / enemy.maxHp >= 0.75) || (this.hasExactly("Professorial Text") && (this.initiator || this.toggle.weapon > 0) && thisEffSpd + this.getPhantom("Spd") > enemyEffSpd + enemy.getPhantom("Spd")) || ((this.hasExactly("Niu") || this.hasExactly("Nightmare Horn") || this.hasExactly("Lyngheidr") || this.hasExactly("Astral Breath")) && this.rValue == 5 && this.combatStartHp / this.maxHp >= 0.25) || (this.hasExactly("Solemn Axe") && this.combatStartHp / this.maxHp >= 0.25 && this.specialIndex != -1 && data.defensiveSpecials.indexOf(data.skills[this.specialIndex].name) == -1 && data.gaeSpecials.indexOf(data.skills[this.specialIndex].name) == -1 && enemy.combatStartHp / enemy.maxHp >= 0.6) || (this.hasExactly("Sable Lance") && this.rValue > 0 && (this.initiator || this.toggle.weapon > 9)) || ((this.has("Petalfall Blade") || this.has("Petalfall Vase") || this.has("Null Blade") || this.has("Null Spear")) && this.combatStartHp / this.maxHp >= 0.25 && thisEffSpd + this.getPhantom("Spd") > enemyEffSpd + enemy.getPhantom("Spd")) || ((this.hasExactly("Arcane Luin") || this.hasExactly("Arcane Devourer")) && this.combatStartHp / this.maxHp >= 0.25 && thisEffSpd + this.getPhantom("Spd") > enemyEffSpd + enemy.getPhantom("Spd")) || (this.hasExactly("Prized Lance") && this.rValue == 5 && this.combatStartHp / this.maxHp >= 0.25) || (((this.hasExactly("Dragoon Axe") && this.rValue == 5) || (this.hasExactly("Staff of the Saint") && this.rValue > 0) || this.hasExactly("Snowman Staff")) && this.buddy.adjacent + this.buddy.two + this.buddy.three > 0) || (this.hasExactly("Feather Sword") && this.rValue > 0 && (!this.initiator || enemy.combatStartHp / enemy.maxHp >= 0.75)) || (this.hasExactly("Exotic Fruit Juice") && this.rValue == 5 && (this.initiator || enemy.combatStartHp / enemy.maxHp >= 0.75)) || (this.hasExactly("Odd Spd Wave 4") && thisEffSpd+this.getPhantom("Spd") >= enemyEffSpd+enemy.getPhantom("Spd")-5) || (this.hasExactly("Starpoint Lance") && this.rValue > 0) || this.hasExactly("Yngvi Ascendant+") || (this.hasExactly("Ice-Crystal Spear") && (!this.initiator || enemy.combatStartHp / enemy.maxHp >= 0.75)) || (this.hasExactly("Sentinel Bow") && (this.initiator || enemy.range == "ranged")) || ((this.hasExactly("Suave Blade") || this.hasExactly("Azure Twin Edge")) && (this.initiator || this.buddy.adjacent > 0 || this.buddy.two > 0)) || (this.hasExactly("Full Rabbit Fang") && (this.transform == true || this.toggle.weapon > 1)) || (this.hasExactly("Frostfire Breath") && this.rValue > 0 && (Object.values(this.bonus).reduce((a, item) => a + (item === true ? 1 : 0), 0) + this.bonus.extra > 0 || checkAllBuffs(this, enemy, turn))) || (this.hasExactly("Silesse Frost") && this.rValue > 0 && (this.initiator || enemy.combatStartHp / enemy.maxHp >= 0.5))){
				enemyAutoFollow = 0;
				preventThisFollow = 0;
				roundText += this.name + " has applied " + data.skills[this.weaponIndex].name + " and disables follow-up denial and enemy auto follow-up.<br>";
			}
			if(enemy.hasExactly("Creator Sword") || (enemy.hasExactly("Mareeta's Sword") && (enemy.toggle.weapon == 1 || (enemy.rValue > 0 && !this.initiator))) || enemy.hasExactly("Bun-Bun Baton") || (enemy.hasExactly("Winds of Change") && (enemy.combatStartHp / enemy.maxHp >= 0.5 || checkAllBuffs(enemy, this, turn) || (enemy.rValue > 0 && Object.values(enemy.bonus).reduce((a, item) => a + (item === true ? 1 : 0), 0) + enemy.bonus.extra > 0))) || (enemy.hasExactly("Sun's Percussors") && (allStats[21] + enemy.getPhantom("Spd") > allStats[17] + this.getPhantom("Spd") || this.combatStartHp / this.maxHp == 1 || (enemy.rValue > 0 && (allStats[21] + enemy.getPhantom("Spd") >= allStats[17] + this.getPhantom("Spd") - 5 || this.combatStartHp / this.maxHp >= 0.75)))) || (enemy.hasExactly("Tome of Storms") && (this.combatStartHp / this.maxHp >= 0.75 || (enemy.rValue > 0 && !this.initiator))) || ((enemy.hasExactly("Failnaught") || enemy.hasExactly("Hungry Cat Fang")) && enemy.combatStartHp / enemy.maxHp >= 0.25) || (enemy.hasExactly("Raijinto") && enemy.rValue == 5 && (!this.initiator || enemy.toggle.weapon == 1)) || (enemy.hasExactly("Vassal's Blade") && enemy.rValue == 5 && this.combatStartHp / this.maxHp >= 0.75) || (enemy.hasExactly("Professorial Text") && (!this.initiator || enemy.toggle.weapon > 0) && enemyEffSpd + enemy.getPhantom("Spd") > thisEffSpd + this.getPhantom("Spd")) || ((enemy.hasExactly("Niu") || enemy.hasExactly("Nightmare Horn") || enemy.hasExactly("Lyngheidr") || enemy.hasExactly("Astral Breath")) && enemy.rValue == 5 && enemy.combatStartHp / enemy.maxHp >= 0.25) || (enemy.hasExactly("Solemn Axe") && enemy.combatStartHp / enemy.maxHp >= 0.25 && enemy.specialIndex != -1 && data.defensiveSpecials.indexOf(data.skills[enemy.specialIndex].name) == -1 && data.gaeSpecials.indexOf(data.skills[enemy.specialIndex].name) == -1 && this.combatStartHp / this.maxHp >= 0.6) || (enemy.hasExactly("Sable Lance") && enemy.rValue > 0 && (!this.initiator || enemy.toggle.weapon > 9)) || ((enemy.has("Petalfall Blade") || enemy.has("Petalfall Vase") || enemy.has("Null Blade") || enemy.has("Null Spear")) && enemy.combatStartHp / enemy.maxHp >= 0.25 && enemyEffSpd + enemy.getPhantom("Spd") > thisEffSpd + this.getPhantom("Spd")) || ((enemy.hasExactly("Arcane Luin") || enemy.hasExactly("Arcane Devourer")) && enemy.combatStartHp / enemy.maxHp >= 0.25 && enemyEffSpd + enemy.getPhantom("Spd") > thisEffSpd + this.getPhantom("Spd")) || (enemy.hasExactly("Prized Lance") && enemy.rValue == 5 && enemy.combatStartHp / enemy.maxHp >= 0.25) || (((enemy.hasExactly("Dragoon Axe") && enemy.rValue == 5) || (enemy.hasExactly("Staff of the Saint") && enemy.rValue > 0) || enemy.hasExactly("Snowman Staff")) && enemy.buddy.adjacent + enemy.buddy.two + enemy.buddy.three > 0) || (enemy.hasExactly("Feather Sword") && enemy.rValue > 0 && (this.initiator || this.combatStartHp / this.maxHp >= 0.75)) || (enemy.hasExactly("Exotic Fruit Juice") && enemy.rValue == 5 && (!this.initiator || this.combatStartHp / this.maxHp >= 0.75)) || (enemy.hasExactly("Odd Spd Wave 4") && enemyEffSpd+enemy.getPhantom("Spd") >= thisEffSpd+this.getPhantom("Spd")-5) || (enemy.hasExactly("Starpoint Lance") && enemy.rValue > 0) || enemy.hasExactly("Yngvi Ascendant+") || (enemy.hasExactly("Ice-Crystal Spear") && (this.initiator || this.combatStartHp / this.maxHp >= 0.75)) || (enemy.hasExactly("Sentinel Bow") && (!this.initiator || this.range == "ranged")) || ((enemy.hasExactly("Suave Blade") || enemy.hasExactly("Azure Twin Edge")) && (!this.initiator || enemy.buddy.adjacent > 0 || enemy.buddy.two > 0)) || (enemy.hasExactly("Full Rabbit Fang") && (enemy.transform == true || enemy.toggle.weapon > 1)) || (enemy.hasExactly("Frostfire Breath") && enemy.rValue > 0 && (Object.values(enemy.bonus).reduce((a, item) => a + (item === true ? 1 : 0), 0) + enemy.bonus.extra > 0 || checkAllBuffs(enemy, this, turn))) || (enemy.hasExactly("Silesse Frost") && enemy.rValue > 0 && (!this.initiator || this.combatStartHp / this.maxHp >= 0.5))){
				thisAutoFollow = 0;
				preventEnemyFollow = 0;
				roundText += enemy.name + " has applied " + data.skills[enemy.weaponIndex].name + " and disables follow-up denial and enemy auto follow-up.<br>";
			}
			//Ifingr/Refined Great Flame
			if((this.hasExactly("Ifingr") || (this.hasExactly("Great Flame") && this.rValue == 5 && this.combatStartHp / this.maxHp >= 0.25)) && this.toggle.weapon == 1){
				enemyAutoFollow = 0;
				roundText += this.name + " has applied " + data.skills[this.weaponIndex].name + " and disables enemy auto follow-up.<br>";
			}
			if((enemy.hasExactly("Ifingr") || (enemy.hasExactly("Great Flame") && enemy.rValue == 5 && enemy.combatStartHp / enemy.maxHp >= 0.25)) && enemy.toggle.weapon == 1){
				thisAutoFollow = 0;
				roundText += enemy.name + " has applied " + data.skills[enemy.weaponIndex].name + " and disables enemy auto follow-up.<br>";
			}
			//Pegasus Carrot check
			if(((enemy.color=="green" && this.color=="red") || (enemy.color=="red" && this.color=="blue") || (enemy.color=="blue" && this.color=="green") || (enemy.color=="gray" && (this.has("Raudrraven") || this.has("Blarraven") || this.has("Gronnraven") || this.has("Naglfar") || this.hasExactly("Tactical Bolt") || this.hasExactly("Tactical Gale") || this.hasExactly("Eternal Tome") || this.hasExactly("Tome of Fury")))) && this.has("Pegasus Carrot")){
				preventThisFollow = 0;
			}
			if(((this.color=="green" && enemy.color=="red") || (this.color=="red" && enemy.color=="blue") || (this.color=="blue" && enemy.color=="green") || (this.color=="gray" && (enemy.has("Raudrraven") || enemy.has("Blarraven") || enemy.has("Gronnraven") || enemy.has("Naglfar") || enemy.hasExactly("Tactical Bolt") || enemy.hasExactly("Tactical Gale") || enemy.hasExactly("Eternal Tome") || enemy.hasExactly("Tome of Fury")))) && enemy.has("Pegasus Carrot")){
				preventEnemyFollow = 0;
			}
			//Refined toggle check for PFU
			if((this.hasExactly("Garm") || this.hasExactly("Ifingr")) && this.rValue > 0 && this.toggle.weapon == 1){
				preventThisFollow = 0;
				roundText += this.name + " has applied " + data.skills[this.weaponIndex].name + " and disables follow-up denial.<br>";
			}
			if((enemy.hasExactly("Garm") || enemy.hasExactly("Ifingr")) && enemy.rValue > 0 && enemy.toggle.weapon == 1){
				preventEnemyFollow = 0;
				roundText += enemy.name + " has applied " + data.skills[enemy.weaponIndex].name + " and disables follow-up denial.<br>";
			}
			if(this.hasExactly("Thunderbrand") && enemy.combatStartHp / enemy.maxHp >= 0.5){
				preventThisFollow = 0;
				var tbText = "";
				if(this.rValue > 0){
					enemyAutoFollow = 0;
					tbText = " and enemy auto follow-up";
				}
				roundText += this.name + " has applied Thunderbrand and disables follow-up denial" + tbText + ".<br>";
			}
			if(enemy.hasExactly("Thunderbrand") && this.combatStartHp / this.maxHp >= 0.5){
				preventEnemyFollow = 0;
				var tbText = "";
				if(enemy.rValue > 0){
					thisAutoFollow = 0;
					tbText = " and enemy auto follow-up";
				}
				roundText += enemy.name + " has applied Thunderbrand and disables follow-up denial" + tbText + ".<br>";
			}
			//NFU > Spd check
			if((this.support.nullFU || this.bonus.nfus || ((this.hasExactly("Arcane Nihility") || this.hasExactly("Arcane Thrima") || this.has("Dragon's Stone") || this.hasExactly("Arcane Thunder") || this.hasExactly("Arcane Fellstone") || this.hasExactly("Arcane Tempest")) && this.combatStartHp / this.maxHp >= 0.25) || this.hasExactly("Inevitable Death+") || (this.hasCaptain("Adroit Captain") && (this.toggle.sd == 0 || this.isFeuded(enemy) == false)) || (this.hasExactly("Edged Scales") && (!this.initiator || this.combatStartHp / this.maxHp >= 0.25))) && thisEffSpd + this.getPhantom("Spd") > enemyEffSpd + enemy.getPhantom("Spd")){
				enemyAutoFollow = 0;
				preventThisFollow = 0;
				roundText += this.name + " disables follow-up denial and enemy auto follow-up.<br>";
			}
			if((enemy.support.nullFU || enemy.bonus.nfus || ((enemy.hasExactly("Arcane Nihility") || enemy.hasExactly("Arcane Thrima") || enemy.has("Dragon's Stone") || enemy.hasExactly("Arcane Thunder") || enemy.hasExactly("Arcane Fellstone") || enemy.hasExactly("Arcane Tempest")) && enemy.combatStartHp / enemy.maxHp >= 0.25) || enemy.hasExactly("Inevitable Death+") || (enemy.hasCaptain("Adroit Captain") && (enemy.toggle.sd == 0 || enemy.isFeuded(this) == false)) || (enemy.hasExactly("Edged Scales") && (this.initiator || enemy.combatStartHp / enemy.maxHp >= 0.25))) && enemyEffSpd + enemy.getPhantom("Spd") > thisEffSpd + this.getPhantom("Spd")){
				thisAutoFollow = 0;
				preventEnemyFollow = 0;
				roundText += enemy.name + " disables follow-up denial and enemy auto follow-up.<br>";
			}
			//OFU > Spd Check
			if(this.support.nullOFU && thisEffSpd + this.getPhantom("Spd") > enemyEffSpd + enemy.getPhantom("Spd")){
				preventThisFollow = 0;
				roundText += this.name + " disables follow-up denial.<br>";
			}
			if(enemy.support.nullOFU && enemyEffSpd + enemy.getPhantom("Spd") > thisEffSpd + this.getPhantom("Spd")){
				preventEnemyFollow = 0;
				roundText += enemy.name + " disables follow-up denial.<br>";
			}
			//Brightmare Horn check
			if(this.hasExactly("Brightmare Horn") && this.combatStartHp / this.maxHp >= 0.25 && this.transform == true){
				preventThisFollow = 0;
				roundText += this.name + " has applied Brightmare Horn and disables follow-up denial.<br>";
			}
			if(enemy.hasExactly("Brightmare Horn") && enemy.combatStartHp / enemy.maxHp >= 0.25 && enemy.transform == true){
				preventEnemyFollow = 0;
				roundText += enemy.name + " has applied Brightmare Horn and disables follow-up denial.<br>";
			}
			//Yngvi Ascendant
			if(this.hasExactly("Yngvi Ascendant")){
				preventThisFollow = 0;
				roundText += this.name + " has applied Yngvi Ascendant and disables follow-up denial.<br>";
			}
			if(enemy.hasExactly("Yngvi Ascendant")){
				preventEnemyFollow = 0;
				roundText += enemy.name + " has applied Yngvi Ascendant and disables follow-up denial.<br>";
			}
			//Crossbones Claw
			if(this.hasExactly("Crossbones Claw") && this.toggle.weapon == 1){
				preventThisFollow = 0;
				roundText += this.name + " has applied Crossbones Claw and disables follow-up denial.<br>";
			}
			if(enemy.hasExactly("Crossbones Claw") && enemy.toggle.weapon == 1){
				preventEnemyFollow = 0;
				roundText += enemy.name + " has applied Crossbones Claw and disables follow-up denial.<br>";
			}
			//Genesis Falchion
			if(this.hasExactly("Genesis Falchion") && (this.initiator || this.buddy.adjacent > 0 || this.buddy.two > 0) && this.toggle.weapon > 0){
				enemyAutoFollow = 0;
				preventThisFollow = 0;
				roundText += this.name + " has applied Genesis Falchion and disables follow-up denial and enemy auto follow-up.<br>";
			}
			if(enemy.hasExactly("Genesis Falchion") && (enemy.initiator || enemy.buddy.adjacent > 0 || enemy.buddy.two > 0) && enemy.toggle.weapon > 0){
				thisAutoFollow = 0;
				preventEnemyFollow = 0;
				roundText += enemy.name + " has applied Genesis Falchion and disables follow-up denial and enemy auto follow-up.<br>";
			}
			if(this.hasExactly("Packleader Tome") && this.combatStartHp / this.maxHp >= 0.25 && this.initiator){
				preventThisFollow = 0;
				roundText += this.name + " has applied " + data.skills[this.weaponIndex].name + " and disables follow-up denial.<br>";
			}
			//Refined Dracofalchion
			if(this.hasExactly("Dracofalchion") && this.rValue == 5 && this.combatStartHp / this.maxHp >= 0.25 && data.physicalWeapons.indexOf(enemy.weaponType) != -1 && thisEffSpd+this.getPhantom("Spd") > enemyEffSpd-enemy.getPhantom("Spd")){
				preventThisFollow = 0;
				roundText += this.name + " has applied Dracofalchion and disables follow-up denial.<br>";
			}
			if(enemy.hasExactly("Dracofalchion") && enemy.rValue == 5 && enemy.combatStartHp / enemy.maxHp >= 0.25 && data.physicalWeapons.indexOf(this.weaponType) != -1 && thisEffSpd+this.getPhantom("Spd") < enemyEffSpd-enemy.getPhantom("Spd")){
				preventEnemyFollow = 0;
				roundText += enemy.name + " has applied Dracofalchion and disables follow-up denial.<br>";
			}
			//Refined Ninis's Ice Lance
			if(this.hasExactly("Ninis's Ice Lance") && this.rValue > 0 && (this.initiator || this.toggle.weapon == 1)){
				preventThisFollow = 0;
				roundText += this.name + " has applied Ninis's Ice Lance and disables follow-up denial.<br>";
			}
			if(enemy.hasExactly("Ninis's Ice Lance") && enemy.rValue > 0 && enemy.toggle.weapon == 1){
				preventEnemyFollow = 0;
				roundText += enemy.name + " has applied Ninis's Ice Lance and disables follow-up denial.<br>";
			}
			//HP >= 25% NFU
			if((this.hasExactly("Whirling Grace") || this.hasExactly("Ascending Blade") || this.hasExactly("Prodigy Polearm") || ((this.has("Guardian Fang") || this.has("New Foxkit Fang") || this.hasExactly("Summer Strikers") || this.hasExactly("Kia Staff")) && this.rValue == 5) || this.hasExactly("Horn of the Land") || this.hasExactly("Vallastone") || this.hasExactly("Twin-Sky Wing") || this.hasExactly("Incipit Kvasir") || this.hasExactly("Cute Paper Crane") || this.hasExactly("Tender Excalibur") || (this.hasExactly("Flame Lance") && this.rValue > 0) || this.hasExactly("United Bouquet") || this.hasExactly("Love of Nerthuz") || (this.has("Sea Tambourine") && thisEffSpd+this.getPhantom("Spd") >= enemyEffSpd+enemy.getPhantom("Spd")-5) || this.hasExactly("Wild Wind Sword") || this.hasExactly("Baton of Dusk")) && this.combatStartHp / this.maxHp >= 0.25){
				enemyAutoFollow = 0;
				preventThisFollow = 0;
				roundText += this.name + " has applied " + data.skills[this.weaponIndex].name + " and disables follow-up denial and enemy auto follow-up.<br>";
			}
			if((enemy.hasExactly("Whirling Grace") || enemy.hasExactly("Ascending Blade") || enemy.hasExactly("Prodigy Polearm") || ((enemy.has("Guardian Fang") || enemy.has("New Foxkit Fang") || enemy.hasExactly("Summer Strikers") || enemy.hasExactly("Kia Staff")) && enemy.rValue == 5) || enemy.hasExactly("Horn of the Land") || enemy.hasExactly("Vallastone") || enemy.hasExactly("Twin-Sky Wing") || enemy.hasExactly("Incipit Kvasir") || enemy.hasExactly("Cute Paper Crane") || enemy.hasExactly("Tender Excalibur") || enemy.hasExactly("United Bouquet") || enemy.hasExactly("Love of Nerthuz") || (enemy.has("Sea Tambourine") && enemyEffSpd+enemy.getPhantom("Spd") >= thisEffSpd+this.getPhantom("Spd")-5) || enemy.hasExactly("Wild Wind Sword") || enemy.hasExactly("Baton of Dusk")) && enemy.combatStartHp / enemy.maxHp >= 0.25){
				thisAutoFollow = 0;
				preventEnemyFollow = 0;
				roundText += enemy.name + " has applied " + data.skills[enemy.weaponIndex].name + " and disables follow-up denial and enemy auto follow-up.<br>";
			}
			//Initiator or within 2 spaces, disable follow-up denial
			if((this.hasExactly("Agnea's Arrow") || this.hasExactly("Caring Conch") || this.hasExactly("Dusk-Dawn Staff") || this.hasExactly("Abyssal Blade") || this.hasExactly("Heartbroker Bow") || this.hasExactly("Baked Treats") || (this.has("Teatime Set") && thisEffSpd+this.getPhantom("Spd") > enemyEffSpd+enemy.getPhantom("Spd")) || (this.hasExactly("Mirage Feather") && this.rValue > 0)) && (this.initiator || this.buddy.adjacent > 0 || this.buddy.two > 0)){
				preventThisFollow = 0;
				roundText += this.name + " has applied " + data.skills[this.weaponIndex].name + " and disables follow-up denial.<br>";
			}
			if((enemy.hasExactly("Agnea's Arrow") || enemy.hasExactly("Caring Conch") || enemy.hasExactly("Dusk-Dawn Staff") || enemy.hasExactly("Heartbroker Bow") || enemy.hasExactly("Baked Treats") || (enemy.has("Teatime Set") && thisEffSpd+this.getPhantom("Spd") < enemyEffSpd+enemy.getPhantom("Spd")) || (enemy.hasExactly("Mirage Feather") && enemy.rValue > 0)) && (enemy.buddy.adjacent > 0 || enemy.buddy.two > 0)){
				preventEnemyFollow = 0;
				roundText += enemy.name + " has applied " + data.skills[enemy.weaponIndex].name + " and disables follow-up denial.<br>";
			}
			//Initiator or Not Adjacent, disable follow-up denial
			if((this.hasExactly("Nidavellir Sprig") || this.hasExactly("Keen Rabbit Fang")) && (this.initiator || this.buddy.adjacent == 0)){
				preventThisFollow = 0;
				roundText += this.name + " has applied " + data.skills[this.weaponIndex].name + " and disables follow-up denial.<br>";
			}
			if((enemy.hasExactly("Nidavellir Sprig") || enemy.hasExactly("Keen Rabbit Fang")) && enemy.buddy.adjacent == 0){
				preventEnemyFollow = 0;
				roundText += enemy.name + " has applied " + data.skills[this.weaponIndex].name + " and disables follow-up denial.<br>";
			}
			//Flame of Muspell
			if(this.hasExactly("Flame of Muspell") && (this.toggle.weapon == 1 || checkAllBuffs(this, enemy, turn))){
				var cValue = (allStats[16]-this.atk) + (allStats[17]-this.spd) + (allStats[18]-this.def) + (allStats[19]-this.res) + (allStats[20]-enemy.atk) + (allStats[21]-enemy.spd) + (allStats[22]-enemy.def) + (allStats[23]-enemy.res);
				if(cValue >= 10){
					preventThisFollow = 0;
					roundText += this.name + " has applied Flame of Muspell and disables follow-up denial.<br>";
				}
			}
			if(enemy.hasExactly("Flame of Muspell") && (enemy.toggle.weapon == 1 || checkAllBuffs(enemy, this, turn))){
				var cValue = (allStats[16]-this.atk) + (allStats[17]-this.spd) + (allStats[18]-this.def) + (allStats[19]-this.res) + (allStats[20]-enemy.atk) + (allStats[21]-enemy.spd) + (allStats[22]-enemy.def) + (allStats[23]-enemy.res);
				if(cValue >= 10){
					preventEnemyFollow = 0;
					roundText += enemy.name + " has applied Flame of Muspell and disables follow-up denial.<br>";
				}
			}
			if((this.has("Vicious Dagger") || this.hasExactly("Disarm Trap 4")) && this.initiator){
				preventThisFollow = 0;
				roundText += this.name + " has disabled follow-up denial.<br>";
			}
			//Initiator or weapon toggle NFU
			if((this.hasExactly("Royal Hatari Fang") || this.hasExactly("Chilled Breath") || this.hasExactly("Fiery War Sword") || this.hasExactly("The Cycle's Turn")) && (this.initiator || this.toggle.weapon == 1)){
				enemyAutoFollow = 0;
				preventThisFollow = 0;
				roundText += this.name + " has applied " + data.skills[this.weaponIndex].name + " and disables follow-up denial and enemy auto follow-up.<br>";
			}
			if((enemy.hasExactly("Royal Hatari Fang") || enemy.hasExactly("Chilled Breath") || enemy.hasExactly("Fiery War Sword") || enemy.hasExactly("The Cycle's Turn")) && enemy.toggle.weapon == 1){
				thisAutoFollow = 0;
				preventEnemyFollow = 0;
				roundText += enemy.name + " has applied " + data.skills[this.weaponIndex].name + " and disables follow-up denial and enemy auto follow-up.<br>";
			}
			//Piercing Tribute
			if(this.has("Piercing Tribute") && (enemy.combatStartHp / enemy.maxHp >= 0.75 || !this.initiator)){
				enemyAutoFollow = 0;
				roundText += this.name + " disables auto follow-up on " + enemy.name + ".<br>";
			}
			if(enemy.has("Piercing Tribute") && (this.combatStartHp / this.maxHp >= 0.75 || this.initiator)){
				thisAutoFollow = 0;
				roundText += enemy.name + " disables auto follow-up on " + this.name + ".<br>";
			}
			//Bright-Shell Egg
			if(this.hasExactly("Bright-Shell Egg") && (checkAllBuffs(this, enemy, turn) || this.toggle.weapon > 1) && this.combineBonPen(enemy,turn,"buff","debuff") >= 6){
				preventThisFollow = 0;
				roundText += this.name + " has applied " + data.skills[this.weaponIndex].name + " and disables follow-up denial.<br>";
			}
			if(enemy.hasExactly("Bright-Shell Egg") && (checkAllBuffs(enemy, this, turn) || enemy.toggle.weapon == 1 || enemy.toggle.weapon == 3) && enemy.combineBonPen(this,turn,"buff","debuff") >= 6){
				preventEnemyFollow = 0;
				roundText += enemy.name + " has applied " + data.skills[this.weaponIndex].name + " and disables follow-up denial.<br>";
			}
			//HP >= 25% disable denial
			if((this.hasExactly("Lands Sword") || this.hasExactly("Kindling Taiko") || (this.hasExactly("Hunting Blade") && this.rValue == 5) || this.hasExactly("Crow's Crystal") || this.hasExactly("Fujin-Raijin Yumi") || this.hasExactly("Arcane Darkbow") || (this.hasExactly("Binding Reginleif") && (this.initiator || this.rValue > 0)) || this.hasExactly("Silent Yule Knife") || this.hasExactly("Flingster Spear") || this.hasExactly("Dead-Crow Tome")) && this.combatStartHp / this.maxHp >= 0.25){
				preventThisFollow = 0;
				roundText += this.name + " has applied " + data.skills[this.weaponIndex].name + " and disables follow-up denial.<br>";
			}
			if((enemy.hasExactly("Lands Sword") || enemy.hasExactly("Kindling Taiko") || (enemy.hasExactly("Hunting Blade") && enemy.rValue == 5) || enemy.hasExactly("Crow's Crystal") || enemy.hasExactly("Fujin-Raijin Yumi") || enemy.hasExactly("Arcane Darkbow") || (enemy.hasExactly("Binding Reginleif") && enemy.rValue > 0) || enemy.hasExactly("Silent Yule Knife") || enemy.hasExactly("Flingster Spear") || enemy.hasExactly("Dead-Crow Tome")) && enemy.combatStartHp / enemy.maxHp >= 0.25){
				preventEnemyFollow = 0;
				roundText += enemy.name + " has applied " + data.skills[enemy.weaponIndex].name + " and disables follow-up denial.<br>";
			}
			if((this.hasExactly("Foxkit Fang") || this.hasExactly("Foxkit Fang 2")) && this.rValue == 5 && (this.initiator || this.toggle.weapon == 1) && thisEffRes + this.getPhantom("Res") - enemyEffRes - enemy.getPhantom("Res") >= 5){
				preventThisFollow = 0;
				roundText += this.name + " has applied Foxkit Fang and disables follow-up denial.<br>";
			}
			if((enemy.hasExactly("Foxkit Fang") || enemy.hasExactly("Foxkit Fang 2")) && enemy.rValue == 5 && (!this.initiator || enemy.toggle.weapon == 1) && enemyEffRes + enemy.getPhantom("Res") - thisEffRes - this.getPhantom("Res") >= 5){
				preventEnemyFollow = 0;
				roundText += enemy.name + " has applied Foxkit Fang and disables follow-up denial.<br>";
			}
			if(this.hasExactly("Sturdy War Sword") && this.combatStartHp / this.maxHp >= 0.25 && this.toggle.weapon == 3 && this.specialIndex != -1 && data.defensiveSpecials.indexOf(data.skills[this.specialIndex].name) == -1 && data.gaeSpecials.indexOf(data.skills[this.specialIndex].name) == -1){
				enemyAutoFollow = 0;
				preventThisFollow = 0;
				roundText += this.name + " has applied Sturdy War Sword and disables follow-up denial and enemy auto follow-up.<br>";
			}
			if(enemy.hasExactly("Sturdy War Sword") && enemy.combatStartHp / enemy.maxHp >= 0.25 && enemy.toggle.weapon == 3 && enemy.specialIndex != -1 && data.defensiveSpecials.indexOf(data.skills[enemy.specialIndex].name) == -1 && data.gaeSpecials.indexOf(data.skills[enemy.specialIndex].name) == -1){
				thisAutoFollow = 0;
				preventEnemyFollow = 0;
				roundText += enemy.name + " has applied Sturdy War Sword and disables follow-up denial and enemy auto follow-up.<br>";
			}
			if(this.hasExactly("Eldhrimnir") && this.rValue == 5 && (!this.initiator || enemy.combatStartHp / enemy.maxHp >= 0.75)){
				enemyAutoFollow = 0;
				roundText += this.name + " has applied Eldhrimnir and disables enemy auto follow-up.<br>";
			}
			if(enemy.hasExactly("Eldhrimnir") && enemy.rValue == 5 && (this.initiator || this.combatStartHp / this.maxHp >= 0.75)){
				thisAutoFollow = 0;
				roundText += enemy.name + " has applied Eldhrimnir and disables enemy auto follow-up.<br>";
			}
			if(this.hasExactly("Raven King Beak") && this.rValue == 5 && (this.transform == true || enemy.combatStartHp / enemy.maxHp >= 0.75) && this.getPhantom("Spd") + thisEffSpd - enemy.getPhantom("Spd") - enemyEffSpd >= 6){
				preventThisFollow = 0;
				roundText += this.name + " has applied Raven King Beak and disables follow-up denial.<br>";
			}
			if(enemy.hasExactly("Raven King Beak") && enemy.rValue == 5 && (enemy.transform == true || this.combatStartHp / this.maxHp >= 0.75) && enemy.getPhantom("Spd") + enemyEffSpd - this.getPhantom("Spd") - thisEffSpd >= 6){
				preventEnemyFollow = 0;
				roundText += enemy.name + " has applied Raven King Beak and disables follow-up denial.<br>";
			}
			if((this.has("Covert Cat Fang") || this.hasExactly("Wind Parthia")) && this.rValue == 5 && this.combatStartHp / this.maxHp >= 0.25){
				preventThisFollow = 0;
				roundText += this.name + " has applied " + data.skills[this.weaponIndex].name + " and disables follow-up denial.<br>";
			}
			if((enemy.has("Covert Cat Fang") || enemy.hasExactly("Wind Parthia")) && enemy.rValue == 5 && enemy.combatStartHp / enemy.maxHp >= 0.25){
				preventEnemyFollow = 0;
				roundText += enemy.name + " has applied " + data.skills[enemy.weaponIndex].name + " and disables follow-up denial.<br>";
			}
			if(this.hasExactly("Worldsea Wave") && this.rValue == 5 && this.initiator && this.getPhantom("Spd") + thisEffSpd - enemy.getPhantom("Spd") - enemyEffSpd >= 10){
				preventThisFollow = 0;
				roundText += this.name + " has applied Worldsea Wave and disables follow-up denial.<br>";
			}
			if(this.hasExactly("Faithful Breath") && this.combatStartHp / this.maxHp >= 0.4 && this.initiator){
				preventThisFollow = 0;
				roundText += this.name + " has applied Faithful Breath and disables follow-up denial.<br>";
			}
			if(this.has("Brazen Cat Fang") && this.rValue > 0 && (this.initiator || this.toggle.weapon == 1)){
				preventThisFollow = 0;
				roundText += this.name + " has applied Brazen Cat Fang and disables follow-up denial.<br>";
			}
			if(this.hasExactly("Deep-Blue Bow") && this.rValue > 0 && (this.initiator || enemy.combatStartHp / enemy.maxHp >= 0.75)){
				preventThisFollow = 0;
				roundText += this.name + " has applied Deep-Blue Bow and disables follow-up denial.<br>";
			}
			if(this.hasExactly("Ghostly Lanterns") && this.combatStartHp / this.maxHp >= 0.25){
				enemyAutoFollow = 0;
				roundText += this.name + " has applied Ghostly Lanterns and disables enemy auto follow-up.<br>";
			}
			if(enemy.hasExactly("Ghostly Lanterns") && enemy.combatStartHp / enemy.maxHp >= 0.25){
				thisAutoFollow = 0;
				roundText += enemy.name + " has applied Ghostly Lanterns and disables enemy auto follow-up.<br>";
			}
			if(this.hasExactly("Everliving Ymir") && (this.initiator || enemy.range == "ranged")){
				preventThisFollow = 0;
				roundText += this.name + " has applied Everliving Ymir and disables follow-up denial.<br>";
			}
			if(enemy.hasExactly("Everliving Ymir") && (!this.initiator || this.range == "ranged")){
				preventEnemyFollow = 0;
				roundText += enemy.name + " has applied Everliving Ymir and disables follow-up denial.<br>";
			}
			if(this.hasExactly("Enclosing Dark") && (this.initiator || this.toggle.weapon > 9)){
				preventThisFollow = 0;
				roundText += this.name + " has applied Enclosing Dark and disables follow-up denial.<br>";
			}
			if(enemy.hasExactly("Enclosing Dark") && (!this.initiator || enemy.toggle.weapon > 9)){
				preventEnemyFollow = 0;
				roundText += enemy.name + " has applied Enclosing Dark and disables follow-up denial.<br>";
			}
			if(this.hasExactly("Enclosing Claw") && this.combatStartHp / this.maxHp >= 0.25 && this.buddy.erorc > 1){
				enemyAutoFollow = 0;
				roundText += this.name + " has applied Enclosing Claw and disables enemy auto follow-up.<br>";
			}
			if(enemy.hasExactly("Enclosing Claw") && enemy.combatStartHp / enemy.maxHp >= 0.25 && enemy.buddy.erorc > 1){
				thisAutoFollow = 0;
				roundText += enemy.name + " has applied Enclosing Claw and disables enemy auto follow-up.<br>";
			}
			if(this.hasExactly("Fang of Finality") && (this.initiator || this.toggle.weapon > 9)){
				preventThisFollow = 0;
				roundText += this.name + " has applied Fang of Finality and disables follow-up denial.<br>";
			}
			if(enemy.hasExactly("Fang of Finality") && (!this.initiator || enemy.toggle.weapon > 9)){
				preventEnemyFollow = 0;
				roundText += enemy.name + " has applied Fang of Finality and disables follow-up denial.<br>";
			}
			if(this.hasExactly("Snow's Grace") && this.rValue == 5 && (!this.initiator || enemy.combatStartHp / enemy.maxHp >= 0.75)){
				enemyAutoFollow = 0;
				roundText += this.name + " has applied Snow's Grace and disables enemy auto follow-up.<br>";
			}
			if(enemy.hasExactly("Snow's Grace") && enemy.rValue == 5 && (this.initiator || this.combatStartHp / this.maxHp >= 0.75)){
				thisAutoFollow = 0;
				roundText += enemy.name + " has applied Snow's Grace and disables enemy auto follow-up.<br>";
			}
			if(this.hasExactly("Cunning Bow") && this.rValue > 0 && this.initiator && this.combineBonPen(enemy,turn,"buff","debuff") >= 10){
				preventThisFollow = 0;
				roundText += this.name + " has applied Cunning Bow and disables follow-up denial.<br>";
			}
			if(this.hasExactly("Duskbloom Bow") && this.initiator && thisEffRes + this.getPhantom("Res") - enemyEffRes - enemy.getPhantom("Res") >= 7){
				preventThisFollow = 0;
				roundText += this.name + " has applied Duskbloom Bow and disables follow-up denial.<br>";
			}
			if(this.hasExactly("Bow of Repose") && this.combatStartHp / this.maxHp < 1 && this.toggle.weapon != 0 && this.toggle.weapon != 10 && this.toggle.weapon != 1 && this.toggle.weapon != 11){
				preventThisFollow = 0;
				roundText += this.name + " has applied Bow of Repose and disables follow-up denial.<br>";
			}
			if(enemy.hasExactly("Bow of Repose") && enemy.combatStartHp / enemy.maxHp < 1 && enemy.toggle.weapon != 0 && enemy.toggle.weapon != 10 && enemy.toggle.weapon != 1 && enemy.toggle.weapon != 11){
				preventEnemyFollow = 0;
				roundText += enemy.name + " has applied Bow of Repose and disables follow-up denial.<br>";
			}
			if(this.hasExactly("Frelian Blade") && (!this.initiator || enemy.combatStartHp / enemy.maxHp >= 0.75)){
				preventThisFollow = 0;
				roundText += this.name + " has applied Frelian Blade and disables follow-up denial.<br>";
			}
			if(enemy.hasExactly("Frelian Blade") && (this.initiator || this.combatStartHp / this.maxHp >= 0.75)){
				preventEnemyFollow = 0;
				roundText += enemy.name + " has applied Frelian Blade and disables follow-up denial.<br>";
			}
			if(this.hasExactly("Partnership Bow") && this.combatStartHp / this.maxHp >= 0.25 && ((this.toggle.weapon > 0 && this.toggle.weapon < 5) || (this.toggle.weapon > 10 && this.toggle.weapon < 15))){
				preventThisFollow = 0;
				roundText += this.name + " has applied Partnership Bow and disables follow-up denial.<br>";
			}
			if(enemy.hasExactly("Partnership Bow") && enemy.combatStartHp / enemy.maxHp >= 0.25 && ((enemy.toggle.weapon > 0 && enemy.toggle.weapon < 5) || (enemy.toggle.weapon > 10 && enemy.toggle.weapon < 15))){
				preventEnemyFollow = 0;
				roundText += this.name + " has applied Partnership Bow and disables follow-up denial.<br>";
			}
			//Deny enemy followups when initiating or ally within 2 Spaces
			if((this.hasExactly("Binding Reginleif") && this.rValue == 5) && (this.initiator || this.buddy.adjacent > 0 || this.buddy.two > 0)){
				enemyAutoFollow = 0;
				roundText += this.name + " has applied " + data.skills[this.weaponIndex].name + " and disables enemy auto follow-up.<br>";
			}
			if((enemy.hasExactly("Binding Reginleif") && enemy.rValue == 5) && (enemy.buddy.adjacent > 0 || enemy.buddy.two > 0)){
				thisAutoFollow = 0;
				roundText += enemy.name + " has applied " + data.skills[enemy.weaponIndex].name + " and disables enemy auto follow-up.<br>";
			}
			if((this.hasExactly("Fair-Fight Blade") && this.combatStartHp / this.maxHp >= 0.25) || (enemy.hasExactly("Fair-Fight Blade") && enemy.combatStartHp / enemy.maxHp >= 0.25) || (this.hasExactly("Bold Kusarigama") && (this.initiator || this.buddy.adjacent > 0 || this.buddy.two > 0)) || (enemy.hasExactly("Bold Kusarigama") && (!this.initiator || enemy.buddy.adjacent > 0 || enemy.buddy.two > 0))){
				preventThisFollow = 0;
				preventEnemyFollow = 0;
				thisAutoFollow = 0;
				enemyAutoFollow = 0;
				roundText += "All follow-up effects have been disabled.<br>";
			}
			//NFU when initiating/2 spaces
			if((this.hasExactly("Guarding Lance") || this.hasExactly("Blade of Sands") || this.hasExactly("Airborne Spear") || this.hasExactly("Salvage")) && (this.initiator || this.buddy.adjacent > 0 || this.buddy.two > 0)){
				enemyAutoFollow = 0;
				preventThisFollow = 0;
				roundText += this.name + " has applied " + data.skills[this.weaponIndex].name + " and disables follow-up denial and enemy auto follow-up.<br>";
			}
			if((enemy.hasExactly("Guarding Lance") || enemy.hasExactly("Blade of Sands") || enemy.hasExactly("Airborne Spear") || enemy.hasExactly("Salvage")) && (enemy.buddy.adjacent > 0 || enemy.buddy.two > 0)){
				thisAutoFollow = 0;
				preventEnemyFollow = 0;
				roundText += enemy.name + " has applied " + data.skills[enemy.weaponIndex].name + " and disables follow-up denial and enemy auto follow-up.<br>";
			}
			if(this.hasExactly("Quietus Gullveig")){
				enemyAutoFollow = 0;
				preventThisFollow = 0;
				roundText += this.name + " has applied " + data.skills[this.weaponIndex].name + " and disables follow-up denial and enemy auto follow-up.<br>";
			}
			if(enemy.hasExactly("Quietus Gullveig") && this.combatStartHp / this.maxHp >= 0.75){
				thisAutoFollow = 0;
				preventEnemyFollow = 0;
				roundText += enemy.name + " has applied " + data.skills[enemy.weaponIndex].name + " and disables follow-up denial and enemy auto follow-up.<br>";
			}
			if(parity){
				preventThisFollow = 0;
				preventEnemyFollow = 0;
				thisAutoFollow = 0;
				enemyAutoFollow = 0;
				roundText += "All follow-up effects have been disabled.<br>";
			}
			//Tally up effects.  If Follow > Prevent, Auto-Double.  If Follow < Prevent, Deny Double.  If 0, Spd check
			if(thisAutoFollow - preventThisFollow > 0 || (thisAutoFollow - preventThisFollow == 0 && thisOutspeeds)){
				thisFollowUp = true;
			}
			if(enemyCanCounter && (enemyAutoFollow - preventEnemyFollow > 0 || (enemyAutoFollow - preventEnemyFollow == 0 && enemyOutspeeds))){
				enemyFollowUp = true;
			}
			
			if(thisAutoFollow - preventThisFollow > 0){
				roundText += this.name + " can make an automatic follow-up attack.<br>";
			}
			else if(thisAutoFollow - preventThisFollow < 0){
				roundText += this.name + " is prevented from making a follow-up attack.<br>";
			}
	
			if(enemyCanCounter){ //Don't show this text if the enemy can't counter anyway
				if(enemyAutoFollow - preventEnemyFollow > 0){
					roundText += enemy.name + " can make an automatic follow-up attack.<br>";
				}
				else if(enemyAutoFollow - preventEnemyFollow < 0){
					roundText += enemy.name + " is prevented from making a follow-up attack.<br>";
				}
			}
			//Potent Check
			var thisPotentEnemy = thisEffSpd - enemyEffSpd - enemySpeedDiff + 5;
			var enemyPotentThis = enemyEffSpd - thisEffSpd - thisSpeedDiff + 5;
			if(this.hasExactly("Thunderbrand") && this.rValue == 5 && (this.initiator || this.buddy.adjacent > 0 || this.buddy.two > 0) && thisPotentEnemy >= -20){
				if(thisFollowUp || brave == 1){
					thisPotent = 0.4;
				}
				else{
					thisPotent = 0.8;
				}
			}
			else if(this.hasExactly("Lady's Bow") && this.buddy.adjacent + this.buddy.two + this.buddy.three > 0 && thisPotentEnemy >= -20){
				if(thisFollowUp || brave == 1){
					thisPotent = 0.4;
				}
				else{
					thisPotent = 0.8;
				}
			}
			else if(this.hasExactly("Sparking Tome") && this.rValue > 0 && (this.initiator || enemy.combatStartHp / enemy.maxHp >= 0.5) && thisPotentEnemy >= -20){
				if(thisFollowUp || brave == 1){
					thisPotent = 0.4;
				}
				else{
					thisPotent = 0.8;
				}
			}
			else if(this.hasExactly("Axe of Dusk") && (this.initiator || enemy.combatStartHp / enemy.maxHp >= 0.75) && thisPotentEnemy >= -20){
				if(thisFollowUp || brave == 1){
					thisPotent = 0.4;
				}
				else{
					thisPotent = 0.8;
				}
			}
			if(enemy.hasExactly("Thunderbrand") && enemy.rValue == 5 && (!this.initiator || enemy.buddy.adjacent > 0 || enemy.buddy.two > 0) && enemyPotentThis >= -20){
				if(enemyFollowUp || counterBrave == 1){
					enemyPotent = 0.4;
				}
				else{
					enemyPotent = 0.8;
				}
			}
			else if(enemy.hasExactly("Lady's Bow") && enemy.buddy.adjacent + enemy.buddy.two + enemy.buddy.three > 0 && enemyPotentThis >= -20){
				if(enemyFollowUp || counterBrave == 1){
					enemyPotent = 0.4;
				}
				else{
					enemyPotent = 0.8;
				}
			}
			else if(enemy.hasExactly("Sparking Tome") && enemy.rValue > 0 && (!this.initiator || this.combatStartHp / this.maxHp >= 0.5) && enemyPotentThis >= -20){
				if(enemyFollowUp || counterBrave == 1){
					enemyPotent = 0.4;
				}
				else{
					enemyPotent = 0.8;
				}
			}
			else if(enemy.hasExactly("Axe of Dusk") && (!this.initiator || this.combatStartHp / this.maxHp >= 0.75)  && enemyPotentThis >= -20){
				if(enemyFollowUp || counterBrave == 1){
					enemyPotent = 0.4;
				}
				else{
					enemyPotent = 0.8;
				}
			}
			if(this.hasExactly("Obsession") && this.combatStartHp / this.maxHp >= 0.25 && thisPotentEnemy >= -20){
				if(thisFollowUp || brave == 1){
					thisPotent = 0.4;
				}
				else{
					thisPotent = 0.8;
				}
			}
			if(enemy.hasExactly("Obsession") && enemy.combatStartHp / enemy.maxHp >= 0.25 && enemyPotentThis >= -20){
				if(enemyFollowUp || counterBrave == 1){
					enemyPotent = 0.4;
				}
				else{
					enemyPotent = 0.8;
				}
			}
			if(this.hasSlot("Potent","b") && thisPotentEnemy >= -20){
				if(thisFollowUp || brave == 1){
					thisPotent = this.hasSlot("Potent","b") / 10;
					if(this.hasExactly("Potent Disarm")){
						thisPotent = 0.4;
					}
				}
				else{
					thisPotent = this.hasSlot("Potent","b") / 10 + 0.4;
					if(this.hasExactly("Potent Disarm")){
						thisPotent = 0.8;
					}
				}
			}
			else if((this.hasExactly("Yngvi Ascendant+") || (this.hasExactly("Shield of Hope") && this.toggle.b > 0)) && thisPotentEnemy >= -5){
				thisPotent = 1;
			}
			
			if(enemy.hasSlot("Potent","b") && enemyPotentThis >= -20){
				if(enemyFollowUp || counterBrave == 1){
					enemyPotent = enemy.hasSlot("Potent","b") / 10;
					if(enemy.hasExactly("Potent Disarm")){
						enemyPotent = 0.4;
					}
				}
				else{
					enemyPotent = enemy.hasSlot("Potent","b") / 10 + 0.4;
					if(enemy.hasExactly("Potent Disarm")){
						enemyPotent = 0.8;
					}
				}
			}
			else if((enemy.hasExactly("Yngvi Ascendant+") || (enemy.hasExactly("Shield of Hope") && enemy.toggle.b > 0)) && enemyPotentThis >= -5){
				enemyPotent = 1;
			}
			if(this.bonus.pfollow && thisPotentEnemy >= -20){
				if(thisFollowUp || brave == 1){
					thisPotent = 0.4;
				}
				else{
					thisPotent = 0.8;
				}
			}
			if(enemy.bonus.pfollow && enemyPotentThis >= -20){
				if(enemyFollowUp || counterBrave == 1){
					enemyPotent = 0.4;
				}
				else{
					enemyPotent = 0.8;
				}
			}
			if(this.hasCaptain("Decisive") && thisPotentEnemy >= -25){
				if(thisFollowUp || brave == 1){
					thisPotent = 0.5;
				}
				else{
					thisPotent = 1;
				}
			}
			if(enemy.hasCaptain("Decisive") && enemyPotentEnemy >= -25){
				if(enemyFollowUp || counterBrave == 1){
					enemyPotent = 0.5;
				}
				else{
					enemyPotent = 1;
				}
			}
			
			//Precombat Chip Damage
			var tPreChip = 0;
			var ePreChip = 0;
			var epText = "from";
			var tpText = "from";
			var tAtt = false;
			var eAtt = false;
			var tDesp = false;
			var eDesp = false;
			if(this.vein == 2){
				tPreChip += 7;
				tpText += " Divine Vein (Flame)";
			}
			if(enemy.vein == 2){
				ePreChip += 7;
				epText += " Divine Vein (Flame)";
			}
			if(this.hasExactly("Flower of Tribute") && this.toggle.weapon == 1){
				ePreChip += 5;
				if(epText != "from"){
					epText += ",";
				}
				epText += " Flower of Tribute";
			}
			else if(this.hasExactly("Bewitching Tome")){
				var epcVal = Math.floor(enemyEffAtk * 0.2);
				if(thisEffSpd + this.getPhantom("Spd") > enemyEffSpd + enemy.getPhantom("Spd") || enemy.color == "blue"){
					epcVal = Math.floor(enemyEffAtk * 0.4);
				}
				ePreChip += epcVal;
				if(epText != "from"){
					epText += ",";
				}
				epText += " Bewitching Tome";
			}
			else if(this.has("Devoted Basket") && this.combatStartHp / this.maxHp >= 0.25){
				var epcVal = Math.floor(enemyEffAtk * 0.15);
				if(thisEffSpd + this.getPhantom("Spd") > enemyEffSpd + enemy.getPhantom("Spd") || enemy.color == "green"){
					epcVal = Math.floor(enemyEffAtk * 0.3);
				}
				ePreChip += epcVal;
				if(epText != "from"){
					epText += ",";
				}
				epText += " " + data.skills[this.weaponIndex].name;
			}
			else if(this.has("Axe of Devotion") && this.combatStartHp / this.maxHp >= 0.25){
				var epcVal = Math.floor(enemyEffAtk * 0.15);
				if(thisEffDef > enemyEffDef || enemy.color == "blue"){
					epcVal = Math.floor(enemyEffAtk * 0.3);
				}
				ePreChip += epcVal;
				if(epText != "from"){
					epText += ",";
				}
				epText += " " + data.skills[this.weaponIndex].name;
			}
			else if(this.hasExactly("Tender Vessel") && this.combatStartHp / this.maxHp >= 0.25){
				var epcVal = Math.floor(enemyEffAtk * 0.2);
				if(thisEffRes + this.getPhantom("Res") > enemyEffRes + enemy.getPhantom("Res") || enemy.color == "blue"){
					epcVal = Math.floor(enemyEffAtk * 0.4);
				}
				ePreChip += epcVal;
				if(epText != "from"){
					epText += ",";
				}
				epText += " Tender Vessel";
			}
			else if(this.hasExactly("Fell War Tome")){
				ePreChip += 7;
				if(epText != "from"){
					epText += ",";
				}
				epText += " Fell War Tome";
			}
			if(enemy.hasExactly("Flower of Tribute") && enemy.toggle.weapon == 1){
				tPreChip += 5;
				if(tpText != "from"){
					tpText += ",";
				}
				tpText += " Flower of Tribute";
			}
			else if(enemy.hasExactly("Bewitching Tome") && this.range == "ranged"){
				var tpcVal = Math.floor(thisEffAtk * 0.2);
				if(enemyEffSpd + enemy.getPhantom("Spd") > thisEffSpd + this.getPhantom("Spd") || this.color == "blue"){
					tpcVal = Math.floor(thisEffAtk * 0.4);
				}
				tPreChip += tpcVal;
				if(tpText != "from"){
					tpText += ",";
				}
				tpText += " Bewitching Tome";
			}
			else if(enemy.has("Devoted Basket") && enemy.combatStartHp / enemy.maxHp >= 0.25 && enemyCanCounter){
				var tpcVal = Math.floor(thisEffAtk * 0.15);
				if(enemyEffSpd + enemy.getPhantom("Spd") > thisEffSpd + this.getPhantom("Spd") || this.color == "green"){
					tpcVal = Math.floor(thisEffAtk * 0.3);
				}
				tPreChip += tpcVal;
				if(tpText != "from"){
					tpText += ",";
				}
				tpText += " " + data.skills[enemy.weaponIndex].name;
			}
			else if(enemy.has("Axe of Devotion") && enemy.combatStartHp / enemy.maxHp >= 0.25 && enemyCanCounter){
				var tpcVal = Math.floor(thisEffAtk * 0.15);
				if(enemyEffDef > thisEffDef || this.color == "blue"){
					tpcVal = Math.floor(thisEffAtk * 0.3);
				}
				tPreChip += tpcVal;
				if(tpText != "from"){
					tpText += ",";
				}
				tpText += " " + data.skills[enemy.weaponIndex].name;
			}
			else if(enemy.hasExactly("Tender Vessel") && enemy.combatStartHp / enemy.maxHp >= 0.25 && enemyCanCounter){
				var tpcVal = Math.floor(thisEffAtk * 0.2);
				if(enemyEffRes + enemy.getPhantom("Res") > thisEffRes + this.getPhantom("Res") || this.color == "blue"){
					tpcVal = Math.floor(thisEffAtk * 0.4);
				}
				tPreChip += tpcVal;
				if(tpText != "from"){
					tpText += ",";
				}
				tpText += " Tender Vessel";
			}
			else if(enemy.hasExactly("Fell War Tome") && (enemy.buddy.adjacent > 0 || enemy.buddy.two > 0) && enemyCanCounter){
				tPreChip += 7;
				if(tpText != "from"){
					tpText += ",";
				}
				tpText += " Fell War Tome";
			}
			if(this.hasExactly("Flared Sparrow") || this.hasExactly("Flared Mirror")){
				ePreChip += 7;
				if(epText != "from"){
					epText += ",";
				}
				epText += " " + data.skills[this.aIndex].name;
			}
			if(this.hasExactly("Occultist's Strike") || this.hasExactly("Assassin's Strike")){
				ePreChip += 7;
				if(epText != "from"){
					epText += ",";
				}
				epText += " " + data.skills[this.bIndex].name;
			}
			if(this.hasExactly("Resonance 4") || this.hasExactly("Resonance 3") || this.hasExactly("Resonance 2") || this.hasExactly("Resonance 1") || this.hasExactly("AR Far Resound")){
				var tMax = this.maxHp;
				if(this.challenger){
					if(challenger[options.challengerSelected].abonus == true){
						tMax -= 10;
					}
					for(var i = 0; i < challenger[options.challengerSelected].blessing.length; i++){
						if(challenger[options.challengerSelected].blessing[i] > 0 && challenger[options.challengerSelected].blessing[i] < 6){
							tMax -= 3;
						}
						else if(challenger[options.challengerSelected].blessing[i] > 5 && challenger[options.challengerSelected].blessing[i] < 10){
							tMax -= 5;
						}
					}
				}
				else{
					if(enemies.cl.list[options.customEnemySelected].abonus == true){
						tMax -= 10;
					}
					for(var i = 0; i < enemies.cl.list[options.customEnemySelected].blessing.length; i++){
						if(enemies.cl.list[options.customEnemySelected].blessing[i] > 0 && enemies.cl.list[options.customEnemySelected].blessing[i] < 6){
							tMax -= 3;
						}
						else if(enemies.cl.list[options.customEnemySelected].blessing[i] > 5 && enemies.cl.list[options.customEnemySelected].blessing[i] < 10){
							tMax -= 5;
						}
					}
				}
				tPreChip += Math.floor((tMax -20) * 0.2);
				if(tpText != "from"){
					tpText += ",";
				}
				tpText += " " + data.skills[this.bIndex].name;
			}
			if(enemy.hasExactly("Resonance 4") || enemy.hasExactly("Resonance 3") || enemy.hasExactly("Resonance 2") || enemy.hasExactly("Resonance 1") || enemy.hasExactly("AR Far Resound")){
				var eMax = enemy.maxHp;
				if(enemy.challenger){
					if(challenger[options.challengerSelected].abonus == true){
						eMax -= 10;
					}
					for(var i = 0; i < challenger[options.challengerSelected].blessing.length; i++){
						if(challenger[options.challengerSelected].blessing[i] > 0 && challenger[options.challengerSelected].blessing[i] < 6){
							eMax -= 3;
						}
						else if(challenger[options.challengerSelected].blessing[i] > 5 && challenger[options.challengerSelected].blessing[i] < 10){
							eMax -= 5;
						}
					}
				}
				else{
					if(enemies.cl.list[options.customEnemySelected].abonus == true){
						eMax -= 10;
					}
					for(var i = 0; i < enemies.cl.list[options.customEnemySelected].blessing.length; i++){
						if(enemies.cl.list[options.customEnemySelected].blessing[i] > 0 && enemies.cl.list[options.customEnemySelected].blessing[i] < 6){
							eMax -= 3;
						}
						else if(enemies.cl.list[options.customEnemySelected].blessing[i] > 5 && enemies.cl.list[options.customEnemySelected].blessing[i] < 10){
							eMax -= 5;
						}
					}
				}
				ePreChip += Math.floor((eMax -20) * 0.2);
				if(epText != "from"){
					epText += ",";
				}
				epText += " " + data.skills[enemy.bIndex].name;
			}
			if(enemy.penalty.chip > 0){
				ePreChip += enemy.penalty.chip;
				if(epText != "from"){
					epText += ",";
				}
				epText += " Combat Start Damage";
			}
			if(this.penalty.chip > 0){
				tPreChip += this.penalty.chip;
				if(epText != "from"){
					tpText += ",";
				}
				tpText += " Combat Start Damage";
			}
			//Enticing Dose goes last as it does not stack
			if((this.hasExactly("Enticing Dose") || this.hasExactly("New Year Fang")) && (this.transform == true || this.combatStartHp / this.maxHp >= 0.25)){
				var epcVal = Math.floor(enemy.maxHp * 0.25);
				ePreChip = Math.max(ePreChip, epcVal);
				if(epText != "from"){
					epText += ",";
				}
				epText += " " + data.skills[this.weaponIndex].name;
			}
			if((enemy.hasExactly("Enticing Dose") || enemy.hasExactly("New Year Fang")) && (enemy.transform == true || enemy.combatStartHp / enemy.maxHp >= 0.25) && enemyCanCounter){
				var tpcVal = Math.floor(this.maxHp * 0.25);
				tPreChip = Math.max(tPreChip, tpcVal);
				if(tpText != "from"){
					tpText += ",";
				}
				tpText += " " + data.skills[enemy.weaponIndex].name;
			}
			if(this.hp <= tPreChip){
				this.hp = 1;
			}
			else{
				this.hp = this.hp - tPreChip;
			}
			if(enemy.hp <= ePreChip){
				enemy.hp = 1;
			}
			else{
				enemy.hp = enemy.hp - ePreChip;
			}
			if(tPreChip > 0){
				roundText += "As combat begins, " + this.name + " takes " + tPreChip + " damage " + tpText + ".<br>";
			}
			if(ePreChip > 0){
				roundText += "As combat begins, " + enemy.name + " takes " + ePreChip + " damage " + epText + ".<br>";
			}
			
			//Precombat Heal
			var tHeal = 0;
			if((this.hasExactly("Resolved Fang") && this.rValue == 5 && this.buddy.adjacent + this.buddy.two + this.buddy.three > 0) || (this.hasExactly("Horn of Harvest") && (!this.initiator || enemy.combatStartHp / enemy.maxHp >= 0.75)) || (this.hasExactly("Breath of Life 4") && this.buddy.adjacent + this.buddy.two > 0) || this.support.bol){
				tHeal = Math.floor(this.maxHp * 0.2);
				if(thisEffDef > enemyEffDef){
					tHeal += (thisEffDef - enemyEffDef) * 4;
					tHeal = Math.min(tHeal, Math.floor(this.maxHp * 0.4));
					if(tPreChip > 0){
						tHeal += tPreChip;
					}
				}
			}
			if(this.bonus.nectar > 0){
				tHeal = Math.max(tHeal, 20);
			}
			if(tHeal > 0){
				roundText += "Before combat begins, " + this.tallyHeal(enemy, tHeal, false);
			}
			var eHeal = 0;
			if((enemy.hasExactly("Resolved Fang") && enemy.rValue == 5 && enemy.buddy.adjacent + enemy.buddy.two + enemy.buddy.three > 0) || (enemy.hasExactly("Horn of Harvest") && (this.initiator || this.combatStartHp / this.maxHp >= 0.75)) || (enemy.hasExactly("Breath of Life 4") && enemy.buddy.adjacent + enemy.buddy.two > 0)|| enemy.support.bol){
				eHeal = Math.floor(enemy.maxHp * 0.2);
				if(enemyEffDef > thisEffDef){
					eHeal += (enemyEffDef - thisEffDef) * 4;
					eHeal = Math.min(eHeal, Math.floor(enemy.maxHp * 0.4));
					if(ePreChip > 0){
						eHeal += ePreChip;
					}
				}
			}
			if(enemy.bonus.nectar > 0){
				eHeal = Math.max(eHeal, 20);
			}
			if(eHeal > 0){
				roundText += "Before combat begins, " + enemy.tallyHeal(this, eHeal, false);
			}
			
			//Twin Save trigger modifier
			if((this.has("Twin N Save") && enemy.range == "melee") || (this.has("Twin F Save") && enemy.range == "ranged") || (this.hasExactly("New Year Fang") && (this.transform == true || this.combatStartHp / this.maxHp >= 0.25))){
				this.beacon[0]++;
			}
			if((enemy.has("Twin N Save") && this.range == "melee") || (enemy.has("Twin F Save") && this.range == "ranged") || (enemy.hasExactly("New Year Fang") && (enemy.transform == true || enemy.combatStartHp / enemy.maxHp >= 0.25))){
				enemy.beacon[0]++;
			}
			
			//Do vantage damage
			//Enemy attacks
			if(vantage && enemyCanCounter){
				roundText += enemy.name + " counterattacks first.<br>";
				roundText += enemy.doDamage(this,counterBrave,false,false,true,enemySpeedBlade,galecheck,enemyFollowUp,thisFollowUp,turn,tCharge,0,brave,true);
				counterBrave = counterBrave * 2;
				eAtt = true;
				enemy.strikes++;
				if(counterBrave > 0){
					enemy.strikes++;
				}
			}
			//Enemy attacks again if enemyVFirst is active (Marths)
			if(this.hp > 0 && enemy.hp > 0 && vantage && enemyCanCounter && (enemyFollowUp || enemyPotent > 0) && enemyVFirst){
				eDesp = true;
				roundText += enemy.name + " attacks again immediately.<br>";
				if(enemyFollowUp){
					roundText += enemy.doDamage(this,counterBrave,false,true,false,enemySpeedBlade,galecheck,enemyFollowUp,thisFollowUp,turn,tCharge,0,brave,true);
					enemy.strikes++;
					if(counterBrave > 0){
						enemy.strikes++;
					}
				}
				//Potent turn
				if(enemyPotent > 0 && this.hp > 0 && enemy.hp > 0){
					//Lodestar check
					if(((enemy.hasExactly("Lodestar Rush") || enemy.hasExactly("Astra Storm")) && (data.skills[enemy.specialIndex].charge <= enemy.charge || enemy.sTrigger == 1)) || (enemy.hasExactly("Sword of Isaach") && enemy.combatStartHp / enemy.maxHp >= 0.25)){
						enemyPotent = 1;
					}
					var pText = enemyPotent * 100;
					roundText += enemy.name + " activates [Potent Follow " + pText + "%].<br>";
					roundText += enemy.doDamage(this,0,false,true,false,enemySpeedBlade,galecheck,enemyFollowUp,thisFollowUp,turn,tCharge,enemyPotent,brave,true);
					enemy.strikes++;
				}
			}
	
			//This attacks
			if(this.hp > 0){
				roundText += this.doDamage(enemy,brave,false,false,true,thisSpeedBlade,galecheck,thisFollowUp,enemyFollowUp,turn,eCharge,0,counterBrave,enemyCanCounter);
				brave = brave * 2;
				tAtt = true;
				eAtt = false;
				this.strikes++;
				if(brave > 0){
					this.strikes++;
				}
			}
	
			//Do desperation, this attacks again
			if(this.hp > 0 && enemy.hp > 0 && desperation && (thisFollowUp || thisPotent > 0)){
				tDesp = true;
				roundText += this.name + " attacks again immediately.<br>";
				if(thisFollowUp){
					roundText += this.doDamage(enemy,brave,false,true,false,thisSpeedBlade,galecheck,thisFollowUp,enemyFollowUp,turn,eCharge,0,counterBrave,enemyCanCounter);
					this.strikes++;
					if(brave > 0){
						this.strikes++;
					}
				}
				//Potent turn
				if(thisPotent > 0 && this.hp > 0 && enemy.hp > 0){
					//Lodestar check
					if(((this.hasExactly("Lodestar Rush") || this.hasExactly("Astra Storm")) && (data.skills[this.specialIndex].charge <= this.charge || this.sTrigger == 1)) || (this.hasExactly("Sword of Isaach") && this.combatStartHp / this.maxHp >= 0.25)){
						thisPotent = 1;
					}
					var pText = thisPotent * 100;
					roundText += this.name + " activates [Potent Follow " + pText + "%].<br>";
					roundText += this.doDamage(enemy,0,false,true,false,thisSpeedBlade,galecheck,thisFollowUp,enemyFollowUp,turn,eCharge,thisPotent,counterBrave,enemyCanCounter);
					this.strikes++;
				}
			}
			
			//Enemy attacks, either vantage follow-up or first attack
			if(enemy.hp > 0 && this.hp > 0 && enemyCanCounter && (!vantage || (vantage && (enemyFollowUp || enemyPotent > 0))) && !enemyVFirst){
				if(!vantage){
					roundText += enemy.doDamage(this,counterBrave,false,false,true,enemySpeedBlade,galecheck,enemyFollowUp,thisFollowUp,turn,tCharge,0,brave,true);
					counterBrave = counterBrave * 2;
					eAtt = true;
					tAtt = false;
					enemy.strikes++;
					if(counterBrave > 0){
						enemy.strikes++;
					}
				}
				else{
					if(enemyFollowUp){
						roundText += enemy.doDamage(this,counterBrave,false,eAtt,false,enemySpeedBlade,galecheck,enemyFollowUp,thisFollowUp,turn,tCharge,0,brave,true);
						enemy.strikes++;
						if(counterBrave > 0){
							enemy.strikes++;
						}
					}
					//Potent turn
					if(enemyPotent > 0 && this.hp > 0 && enemy.hp > 0){
						//Lodestar check
						if(((enemy.hasExactly("Lodestar Rush") || enemy.hasExactly("Astra Storm")) && (data.skills[enemy.specialIndex].charge <= enemy.charge || enemy.sTrigger == 1)) || (enemy.hasExactly("Sword of Isaach") && enemy.combatStartHp / enemy.maxHp >= 0.25)){
							enemyPotent = 1;
						}
						var pText = enemyPotent * 100;
						roundText += enemy.name + " activates [Potent Follow " + pText + "%].<br>";
						roundText += enemy.doDamage(this,0,false,eAtt,false,enemySpeedBlade,galecheck,enemyFollowUp,thisFollowUp,turn,tCharge,enemyPotent,brave,true);
						enemy.strikes++;
					}
				}
			}
			//Enemy attacks again if enemyFirst is active (Holy War's End)
			if(this.hp > 0 && enemy.hp > 0 && !vantage && enemyCanCounter && (enemyFollowUp || enemyPotent > 0) && enemyFirst){
				eDesp = true;
				if(enemyFollowUp){
					roundText += enemy.doDamage(this,counterBrave,false,true,false,enemySpeedBlade,galecheck,enemyFollowUp,thisFollowUp,turn,tCharge,0,brave,true);
					enemy.strikes++;
					if(counterBrave > 0){
						enemy.strikes++;
					}
				}
				//Potent turn
				if(enemyPotent > 0 && this.hp > 0 && enemy.hp > 0){
					//Lodestar check
					if(((enemy.hasExactly("Lodestar Rush") || enemy.hasExactly("Astra Storm")) && (data.skills[enemy.specialIndex].charge <= enemy.charge || enemy.sTrigger == 1)) || (enemy.hasExactly("Sword of Isaach") && enemy.combatStartHp / enemy.maxHp >= 0.25)){
						enemyPotent = 1;
					}
					var pText = enemyPotent * 100;
					roundText += enemy.name + " activates [Potent Follow " + pText + "%].<br>";
					roundText += enemy.doDamage(this,0,false,true,false,enemySpeedBlade,galecheck,enemyFollowUp,thisFollowUp,turn,tCharge,enemyPotent,brave,true);
					enemy.strikes++;
				}
			}
	
			//Don't do this attack if already did desperation
			//or if broken
			//This attacks again (Follow up or Potent)
			if(this.hp > 0 && enemy.hp > 0 && (thisFollowUp || thisPotent > 0) && !tDesp){
				if(thisFollowUp){
					roundText += this.doDamage(enemy,brave,false,tAtt,false,thisSpeedBlade,galecheck,thisFollowUp,enemyFollowUp,turn,eCharge,0,counterBrave,enemyCanCounter);
					this.strikes++;
					if(brave > 0){
						this.strikes++;
					}
				}
				//Potent turn
				if(thisPotent > 0 && this.hp > 0 && enemy.hp > 0){
					//Lodestar check
					if(((this.hasExactly("Lodestar Rush") || this.hasExactly("Astra Storm")) && (data.skills[this.specialIndex].charge <= this.charge || this.sTrigger == 1)) || (this.hasExactly("Sword of Isaach") && this.combatStartHp / this.maxHp >= 0.25)){
						thisPotent = 1;
					}
					var pText = thisPotent * 100;
					roundText += this.name + " activates [Potent Follow " + pText + "%].<br>";
					roundText += this.doDamage(enemy,0,false,tAtt,false,thisSpeedBlade,galecheck,thisFollowUp,enemyFollowUp,turn,eCharge,thisPotent,counterBrave,enemyCanCounter);
					this.strikes++;
				}
				eAtt = false;
			}
	
			//Don't do this if enemyFirst/enemyVFirst
			//Enemy attacks, non-vantage follow-up
			if(this.hp > 0 && enemy.hp > 0 && !vantage && enemyCanCounter && (enemyFollowUp || enemyPotent > 0) && !eDesp){
				if(enemyFollowUp){
					roundText += enemy.doDamage(this,counterBrave,false,eAtt,false,enemySpeedBlade,galecheck,enemyFollowUp,thisFollowUp,turn,tCharge,0,brave,true);
					enemy.strikes++;
					if(counterBrave > 0){
						enemy.strikes++;
					}
				}
				//Potent turn
				if(enemyPotent > 0 && this.hp > 0 && enemy.hp > 0){
					//Lodestar check
					if(((enemy.hasExactly("Lodestar Rush") || enemy.hasExactly("Astra Storm")) && (data.skills[enemy.specialIndex].charge <= enemy.charge || enemy.sTrigger == 1)) || (enemy.hasExactly("Sword of Isaach") && enemy.combatStartHp / enemy.maxHp >= 0.25)){
						enemyPotent = 1;
					}
					var pText = enemyPotent * 100;
					roundText += enemy.name + " activates [Potent Follow " + pText + "%].<br>";
					roundText += enemy.doDamage(this,0,false,eAtt,false,enemySpeedBlade,galecheck,enemyFollowUp,thisFollowUp,turn,tCharge,enemyPotent,brave,true);
					enemy.strikes++;
				}
			}
			
			//Remove debuffs - action done
			if(this.bonus.gStrat == false){
				this.combatDebuffs = {"atk":0,"spd":0,"def":0,"res":0};
				this.debuffs = {"atk":0,"spd":0,"def":0,"res":0};
			}
			this.penalty.lit = false;
			this.penalty.trilemma = false;
			this.penalty.panic = false;
			this.penalty.cdguard = false;
			//engaged on enemy, Fallen Star is now disabled
			enemy.bonus.fStar = false;
			enemy.bonus.dStar = false;
			//reset ice mirror/divine pulse build up post combat
			this.ice = 0;
			enemy.ice = 0;
			this.beacon = [0,0];
			enemy.beacon = [0,0];
			//reset range check (ie. Golden Dagger)
			this.anyCounter = false;
			//set charges to max value of special if over
			if(this.specialIndex > -1 && data.skills[this.specialIndex].charge < this.charge){
				this.charge = data.skills[this.specialIndex].charge;
			}
			if(enemy.specialIndex > -1 && data.skills[enemy.specialIndex].charge < enemy.charge){
				enemy.charge = data.skills[enemy.specialIndex].charge;
			}
			//remove any Pre-charge since first combat is now done
			this.precharge = 0;
			enemy.precharge = 0;
			var bClear = false;
			//remove all bonus if Essence + Dosage
			if(enemy.bonus.essence && this.bonus.dosage && enemyCanCounter){
				if(this.bonus.essence && enemy.bonus.dosage){
					bClear = true;
				}
				enemy.bonus = {"divineFang":false,"bDoubler":false,"nullArmor":false,"nullDragon":false,"nullFlying":false,"nullPanic":false,"autoD":false,"stopD":false,"dominance":false,"despacito":false,"vantage":false,"dodge":false,"nfus":false,"caff":false,"fStar":false,"dStar":false,"dull":false,"gStrat":false,"enGarde":false,"breathB":false,"treachery":false,"penDoubler":false,"starlight":false,"nPenalty":false,"resoB":false,"resoS":false,"triAtk":false,"bexblade":false,"spectrum":false,"extra":0,"incited":false,"fSight":false,"rotten":false,"essence":false,"nectar":0,"paranoia":false,"anathema":false,"fWitness":false,"dosage":false,"empathy":0,"divinely":0,"preempt":false,"pfollow":false,"sdiff":false,"dHex":false,"fEmblem":false};
				roundText += this.name + " neutralizes all [Bonus] on " + enemy.name + " from activating [Dosage].<br>";
			}
			if((this.bonus.essence && enemy.bonus.dosage) || bClear){
				this.bonus = {"divineFang":false,"bDoubler":false,"nullArmor":false,"nullDragon":false,"nullFlying":false,"nullPanic":false,"autoD":false,"stopD":false,"dominance":false,"despacito":false,"vantage":false,"dodge":false,"nfus":false,"caff":false,"fStar":false,"dStar":false,"dull":false,"gStrat":false,"enGarde":false,"breathB":false,"treachery":false,"penDoubler":false,"starlight":false,"nPenalty":false,"resoB":false,"resoS":false,"triAtk":false,"bexblade":false,"spectrum":false,"extra":0,"incited":false,"fSight":false,"rotten":false,"essence":false,"nectar":0,"paranoia":false,"anathema":false,"fWitness":false,"dosage":false,"empathy":0,"divinely":0,"preempt":false,"pfollow":false,"sdiff":false,"dHex":false,"fEmblem":false};
				roundText += enemy.name + " neutralizes all [Bonus] on " + this.name + " from activating [Dosage].<br>";
			}
			
			//Do stuff if this isn't dead
			if(this.hp > 0){
				roundText += this.postCombatHPAdjust(galecheck,enemy);
				this.arise = false;
				roundText += this.postCombatBuff();
				if(this.hasExactly("Makings of a King") && this.sTrigger == 1){
					this.talent.atk += 4;
					this.talent.atk = Math.min(this.talent.atk, 20);
					this.talent.def += 4;
					this.talent.def = Math.min(this.talent.def, 20);
					this.talent.res += 4;
					this.talent.res = Math.min(this.talent.res, 20);
					roundText += this.name + " activates Makings of a King and gains +4 atk/def/res [Great Talent].<br>";
				}
				if(this.has("Speedtaker")){
					var sMax = this.has("Speedtaker") * 5;
					this.talent.spd += this.has("Speedtaker");
					this.talent.spd = Math.min(this.talent.spd, sMax);
					roundText += this.name + " activates " + data.skills[this.bIndex].name + " and gains +" + this.has("Speedtaker") + " spd [Great Talent].<br>";
				}
				roundText += enemy.seal(this);
				this.penalty.fatal = false;
				this.penalty.fStart = false;
				this.penalty.exposure = false;
				this.penalty.feud = false;
				this.penalty.schism = false;
				this.penalty.nullArise = false;
				this.penalty.tGrip = false;
				this.penalty.hush = false;
				this.penalty.spoils = false;
				this.penalty.frozen = false;
				//check for max CD goes first
				if(this.charge - this.initSkillCharge() == 0){
					if(this.hasExactly("Time's Pulse 4") || this.hasExactly("Time Pulse Edge") || this.hasExactly("Time Pulse Helm")){
						this.charge += 1;
						roundText += this.name + " gains +1 CD from " + data.skills[this.cIndex].name + " after combat.<br>";
					}
					else if(this.hasExactly("Connected World") && this.buddy.adjacent + this.buddy.two + this.buddy.three > 0){
						this.charge += 1;
						roundText += this.name + " gains +1 CD from Connected World after combat.<br>";
					}
					if((this.hasExactly("Vassal-Saint Steel") || this.hasExactly("Hoshido's Breath") || this.hasExactly("Hungry Cat Fang") || this.hasExactly("Duskstone")) && this.combatStartHp / this.maxHp >= 0.25){
						this.charge += 1;
						roundText += this.name + " gains +1 CD from " + data.skills[this.weaponIndex].name + " after combat.<br>";
					}
					else if(this.hasExactly("Larcei's Edge") && this.rValue == 5 && this.combatStartHp / this.maxHp >= 0.25){
						this.charge += 1;
						roundText += this.name + " gains +1 CD from Larcei's Edge after combat.<br>";
					}
					else if(this.hasExactly("Majestic Glitnir")){
						this.charge += 1;
						roundText += this.name + " gains +1 CD from Majestic Glitnir after combat.<br>";
					}
					else if(this.hasExactly("Stone of Delights") && this.buddy.adjacent + this.buddy.two + this.buddy.three > 0){
						this.charge += 1;
						roundText += this.name + " gains +1 CD from Stone of Delights after combat.<br>";
					}
					else if((this.hasExactly("Opposing Stones") || this.hasExactly("Icy Ravager")) && (!this.initiator || enemy.combatStartHp / enemy.maxHp >= 0.75)){
						this.charge += 1;
						roundText += this.name + " gains +1 CD from " + data.skills[this.weaponIndex].name + " after combat.<br>";
					}
					if(this.hasExactly("Time Pulse Echo")){
						this.charge += 1;
						roundText += this.name + " gains +1 CD from Time Pulse Echo after combat.<br>";
					}
					if(this.support.tPulse > 0){
						this.charge += this.support.tPulse;
						roundText += this.name + " gains +" + this.support.tPulse + " CD from Time's Pulse Support after combat.<br>";
					}
				}
				if(this.hasExactly("Dark Mystletainn") && this.sTrigger == 1){
					this.charge += 2;
					roundText += this.name + " gains +2 CD from Dark Mystletainn after combat.<br>";
				}
				else if(this.has("Bunny Fang") && (this.hp/this.maxHp <= 0.75 || (this.rValue > 0 && this.hp/this.maxHp <= 0.9))){
					this.charge += 2;
					roundText += this.name + " gains +2 CD from Bunny Fang after combat.<br>";
				}
				else if(this.hasExactly("Bride's Fang") && this.sTrigger == 1 && (enemy.combatStartHp/enemy.maxHp >= 0.75 || (this.rValue > 0 && this.initiator))){
					if(this.rValue < 0 && this.didAttack){
						this.charge += 1;
						roundText += this.name + " gains +1 CD from Bride's Fang after combat.<br>";
					}
					else if(this.rValue > 0){
						this.charge += 2;
						roundText += this.name + " gains +2 CD from Bride's Fang after combat.<br>";
					}
				}
				else if(this.hasExactly("Royal Sword") && this.rValue == 5 && this.combatStartHp / this.maxHp >= 0.25){
					this.charge += 1;
					roundText += this.name + " gains +1 CD from Royal Sword after combat.<br>";
				}
				else if((this.has("Spendthrift Bow") || (this.hasExactly("Lucky Bow") && (!this.initiator || enemy.combatStartHp/enemy.maxHp >= 0.75))) && this.didAttack){
					this.charge -= 2;
					roundText += this.name + " loses -2 CD from " + data.skills[this.weaponIndex].name + " after combat.<br>";
				}
				else if(this.hasExactly("Peshkatz") && this.rValue == 5 && this.combatStartHp / this.maxHp >= 0.25){
					this.charge += 1;
					roundText += this.name + " gains +1 CD from Peshkatz after combat.<br>";
				}
				else if((this.hasExactly("Ascending Blade") || this.hasExactly("Firelight Lance")) && this.combatStartHp / this.maxHp >= 0.25){
					this.charge += 1;
					roundText += this.name + " gains +1 CD from " + data.skills[this.weaponIndex].name + " after combat.<br>";
				}
				else if(this.hasExactly("Inner Wellspring") && (this.initiator || this.buddy.adjacent > 0 || this.buddy.two > 0) && this.sTrigger == 1){
					this.charge += 1;
					roundText += this.name + " gains +1 CD from Inner Wellspring after combat.<br>";
				}
				else if(this.hasExactly("Wary Rabbit Fang") && (this.initiator || this.toggle.weapon == 1) && this.hp / this.maxHp <= 0.9){
					this.charge += 2;
					roundText += this.name + " gains +2 CD from Wary Rabbit Fang after combat.<br>";
				}
				else if(this.hasExactly("Lone-Wolf Blade") && this.combatStartHp / this.maxHp >= 0.25){
					if(this.charge - this.initSkillCharge() == 0){
						this.charge += 2;
						roundText += this.name + " gains +2 CD from Lone-Wolf Blade after combat.<br>";
					}
					else if(this.charge - this.initSkillCharge() == 1){
						this.charge += 1;
						roundText += this.name + " gains +1 CD from Lone-Wolf Blade after combat.<br>";
					}
				}
				else if(this.hasExactly("Striving Sword") && (this.buddy.adjacent > 0 || this.buddy.two > 0 || this.buddy.three > 0) && this.sTrigger == 1){
					this.charge += 2;
					roundText += this.name + " gains +2 CD from Striving Sword after combat.<br>";
				}
				else if(this.hasExactly("Full Rabbit Fang") && (this.transform == true || this.toggle.weapon > 1) && this.hp / this.maxHp <= 0.9){
					this.charge += 2;
					roundText += this.name + " gains +2 CD from Full Rabbit Fang after combat.<br>";
				}
				if(this.has("Special Spiral") && this.sTrigger == 1){
					var ssCharge = 0;
					if(this.has("Special Spiral") == 1 && this.initiator){
						ssCharge = 1;
					}
					else if(this.has("Special Spiral") == 2){
						ssCharge = 1;
					}
					else if(this.has("Special Spiral") > 2){
						ssCharge = 2;
					}
					this.charge += ssCharge;
					roundText += this.name + " gains +" + ssCharge + " CD from " + data.skills[this.bIndex].name + " after combat.<br>";
				}
				else if(this.hasExactly("Deadly Balance+") && this.sTrigger == 1){
					this.charge += 2;
					roundText += this.name + " gains +2 CD from Deadly Balance+ after combat.<br>";
				}
				if(enemy.hp > 0){
					if(enemy.hasExactly("Peshkatz") && enemy.rValue == 5 && enemy.combatStartHp / enemy.maxHp >= 0.25){
						this.charge -= 1;
						roundText += enemy.name + " inflicts CD +1 with Peshkatz to " + this.name + " after combat.<br>";
					}
					if(this.hasExactly("Athame") && this.rValue == 5 && this.didAttack){
						enemy.penalty.exposure = true;
						roundText += this.name + " inflicts " + enemy.name + " with Exposure Status.<br>";
					}
					if(this.hasExactly("Wildflower Edge")){
						enemy.penalty.spoils = true;
						roundText += this.name + " inflicts " + enemy.name + " with Share Spoils Status.<br>";
					}
					if((enemy.hasExactly("Atrocity") && this.combatStartHp / this.maxHp >= 0.5) || (enemy.hasExactly("Atrocity 2") && this.combatStartHp / this.maxHp >= 0.4)){
						this.charge -= 1;
						var aText = "";
						if(enemy.hasExactly("Atrocity 2") && this.combatStartHp / this.maxHp >= 0.4){
							this.penalty.cdguard = true;
							aText = " and Guard status";
						}
						roundText += enemy.name + " inflicts CD +1" + aText + " with " + data.skills[enemy.bIndex].name + " to " + this.name + " after combat.<br>";
					}
					else if(enemy.hasExactly("Barbarity") && this.combatStartHp / this.maxHp >= 0.25){
						enemy.bonus.vantage = true;
						enemy.bonus.dodge = true;
						roundText += enemy.name + " gains [Vantage] & [Dodge] Bonus from Barbarity.<br>";
					}
					if(enemy.hasExactly("Pulse Smoke 3") && this.charge - this.initSkillCharge() > 0){
						this.charge -= 1;
						roundText += enemy.name + " inflicts CD +1 with Pulse Smoke 3 to " + this.name + " after combat.<br>";
					}
					if(enemy.hasExactly("Pulse Smog")){
						var psText = "-7 atk, [Guard]";
						if(this.charge - this.initSkillCharge() > 0){
							this.charge -= 1;
							psText += ", and CD +1";
						}
						this.combatDebuffs.atk = Math.min(-7,this.combatDebuffs.atk);
						this.penalty.cdguard = true;
						roundText += enemy.name + " inflicts " + psText + " with Pulse Smog to " + this.name + " after combat.<br>";
					}
					//Not CD related, but enemy has to be alive for this to trigger
					if(enemy.hasExactly("Panic Smoke 3") || enemy.hasExactly("Panic Smoke 4") || (enemy.hasExactly("Incipit Kvasir") && enemy.combatStartHp / enemy.maxHp >= 0.25 && enemy.didAttack)){
						this.penalty.panic = true;
						roundText += enemy.name + " panics " + this.name + ".<br>";
						if(enemy.hasExactly("Panic Smoke 4")){
							this.combatDebuffs.atk = Math.min(-3,this.combatDebuffs.atk);
							this.combatDebuffs.spd = Math.min(-3,this.combatDebuffs.spd);
							this.combatDebuffs.def = Math.min(-3,this.combatDebuffs.def);
							this.combatDebuffs.res = Math.min(-3,this.combatDebuffs.res);
							enemy.bonus.penDoubler = true;
							roundText += enemy.name + " inflicts -3 atk/spd/def/res to " + this.name + " and gains Foe Penalty Doubler Bonus from Panic Smoke 4.<br>";
						}
					}
					if(enemy.has("Fatal Smoke") > 2 || (enemy.hasExactly("Flamelick Breath") && enemy.combatStartHp / enemy.maxHp >= 0.25) || enemy.has("Serpentine Staff") || enemy.has("Incurable")){
						this.penalty.fatal = true;
						var fText = "";
						if(enemy.hasExactly("Fatal Smoke 4")){
							this.penalty.nullArise = true;
							fText = " and Null Miracle";
						}
						roundText += enemy.name + " inflicts " + this.name + " with Deep Wounds" + fText + " Status.<br>";
					}
					if(this.hasExactly("Spd Smoke 4")){
						enemy.combatDebuffs.spd = Math.min(-7,enemy.combatDebuffs.spd);
						roundText += this.name + " inflicts -7 spd to " + enemy.name + " from Spd Smoke 4.<br>";
					}
					if(this.hasExactly("Atk Smoke 4")){
						enemy.combatDebuffs.atk = Math.min(-7,enemy.combatDebuffs.atk);
						roundText += this.name + " inflicts -7 atk to " + enemy.name + " from Atk Smoke 4.<br>";
					}
					if(this.hasExactly("Def Res Smoke 3")){
						enemy.combatDebuffs.def = Math.min(-7,enemy.combatDebuffs.def);
						enemy.combatDebuffs.res = Math.min(-7,enemy.combatDebuffs.res);
						roundText += this.name + " inflicts -7 def and res to " + enemy.name + " from Def Res Smoke 3.<br>";
					}
					if(this.hasExactly("Light's Restraint") && this.sTrigger == 1){
						enemy.charge -= 1;
						enemy.penalty.cdguard = true;
						roundText += this.name + " inflicts CD +1 and Guard status with Light's Restraint to " + enemy.name + " after combat.<br>";
					}
					if(this.hasExactly("Holy Panic") && this.sTrigger == 1){
						enemy.combatDebuffs.atk = Math.min(-6,enemy.combatDebuffs.atk);
						enemy.combatDebuffs.spd = Math.min(-6,enemy.combatDebuffs.spd);
						enemy.penalty.panic = true;
						roundText += this.name + " inflicts -6 atk & spd and Panic status with Holy Panic to " + enemy.name + " after combat.<br>";
					}
					if(this.hasExactly("Flared Sparrow") || this.hasExactly("Flared Mirror") || (this.hasExactly("Black Yule Lance") && this.combatStartHp / this.maxHp >= 0.25) || this.hasExactly("Fell War Tome")){
						enemy.vein = 2;
						roundText += this.name + " applies Divine Vein (Flame) on " + enemy.name + "'s space after combat.<br>";
					}
					if(this.hasExactly("Mending Heart")){
						enemy.vein = 3;
						roundText += this.name + " applies Divine Vein (Green) on " + enemy.name + "'s space after combat.<br>";
					}
					if(this.hasExactly("Deadly Miasma") || this.hasExactly("Pure Atrocity")){
						enemy.vein = 4;
						roundText += this.name + " applies Divine Vein (Haze) on " + enemy.name + "'s space after combat.<br>";
					}
					if((this.hasExactly("Dragon Fang Shot") || this.hasExactly("Dragon Fang Fire")) && this.sTrigger == 1){
						enemy.vein = 5;
						roundText += this.name + " applies Divine Vein (Water) on " + enemy.name + "'s space after combat.<br>";
					}
					if(enemy.hasExactly("Great Aether") && enemy.sTrigger == 1 && this.charge - this.initSkillCharge() > 0){
						this.charge -= 1;
						roundText += enemy.name + " inflicts CD +1 with Great Aether to " + this.name + " after combat.<br>";
					}
				}
				this.charge = Math.max(0,this.charge);
				if(this.specialIndex != -1 && data.skills[this.specialIndex].charge <= this.charge){
					this.charge = data.skills[this.specialIndex].charge;
				}
				var tlCheck = this.sTrigger;
				this.sTrigger = 0;
				if(enemy.didAttack){
					if(enemy.hasExactly("Panic") || enemy.hasExactly("Panic+") || enemy.has("Legion's Axe") || enemy.hasExactly("Sneering Axe") || (enemy.hasExactly("Monstrous Bow+") && enemy.rValue > 0) || (enemy.hasExactly("Spectral Tome+") && enemy.rValue > 0) || (enemy.hasExactly("Elena's Staff") && enemy.rValue == 5) || (enemy.hasExactly("Tiger Spirit") && enemy.combatStartHp / this.maxHp >= 0.25)){
						this.penalty.panic = true;
						roundText += enemy.name + " panics " + this.name + ".<br>";
					}
					if(enemy.has("Candlelight") || enemy.hasExactly("Flash") || enemy.hasExactly("Flash+") || enemy.hasExactly("Doting Staff") || enemy.hasExactly("Venin Edge") || (enemy.hasExactly("Obsessive Curse") && enemy.rValue == 5) || (enemy.hasExactly("Frostbite Breath") && enemy.combatStartHp / enemy.maxHp >= 0.25) || enemy.hasExactly("Dusk-Dawn Staff") || (enemy.hasExactly("Flower of Ease") && enemy.rValue == 5 && enemy.combatStartHp / enemy.maxHp >= 0.25) || (enemy.hasExactly("Faded Paper Fan") && (enemy.buddy.adjacent > 0 || enemy.buddy.two > 0)) || (enemy.hasExactly("Glitter of Light") && enemy.sTrigger == 1)){
						this.penalty.lit = true;
						roundText += enemy.name + " inflicts " + this.name + " with an inability to make counterattacks.<br>";
					}
					if(enemy.has("Trilemma") || enemy.hasExactly("Punishment Staff")){
						this.penalty.trilemma = true;
						roundText += enemy.name + " inflicts " + this.name + " with Triangle Adept Status.<br>";
					}
					if(enemy.has("Witchy Wand") || enemy.has("Melancholy") || enemy.hasExactly("Staff of Lilies")){
						this.penalty.cdguard = true;
						this.resetCharge();
						roundText += enemy.name + " inflicts " + this.name + " with Guard Status.<br>";
					}
					if(enemy.hasExactly("Caring Conch")){
						this.penalty.cdguard = true;
						roundText += enemy.name + " inflicts " + this.name + " with Guard Status.<br>";
					}
					if(enemy.hasExactly("Venin Edge") && enemy.rValue == 5 && enemy.buddy.adjacent < 2){
						this.penalty.discord = true;
						roundText += enemy.name + " inflicts " + this.name + " with Discord Status.<br>";
					}
					if(enemy.bonus.essence && !this.bonus.dosage){
						var bKey = Object.keys(this.bonus).filter(a => this.bonus[a] === true);
						for(var i = 0; i < bKey.length; i++){
							this.bonus[bKey[i]] = false;
							enemy.bonus[bKey[i]] = true;
						}
					}
				}
				if(this.hasExactly("Fallen Star") && this.initiator){
					this.bonus.fStar = true;
					roundText += this.name + " gains Fallen Star Status.<br>";
				}
				if((this.hasExactly("Deep Star") || this.hasExactly("Fallen Star 2") || this.hasExactly("Pure Starfall")) && this.initiator){
					this.bonus.dStar = true;
					var psText = "";
					if(this.hasExactly("Pure Starfall")){
						this.bonus.vantage = true;
						psText = " and Vantage";
					}
					roundText += this.name + " gains Deep Star" + psText + " Status.<br>";
				}
				if(this.has("Faithful Loyalty")){
					this.bonus.vantage = true;
					roundText += this.name + " gains Vantage Status.<br>";
				}
				if(this.hasExactly("Spd Smoke 4")){
					this.combatBuffs.spd = Math.max(6,this.combatBuffs.spd);
					this.bonus.dodge = true;
					roundText += this.name + " gains +6 spd and Dodge Status from Spd Smoke 4.<br>";
				}
				if(this.hasExactly("Atk Smoke 4")){
					this.combatBuffs.def = Math.max(6,this.combatBuffs.def);
					this.combatBuffs.res = Math.max(6,this.combatBuffs.res);
					this.bonus.stopD = true;
					roundText += this.name + " gains +6 def/res and Deny Follow-Up Status from Atk Smoke 4.<br>";
				}
				if(this.hasExactly("Def Res Smoke 3")){
					this.combatBuffs.atk = Math.max(6,this.combatBuffs.atk);
					roundText += this.name + " gains +6 atk from Def Res Smoke 3.<br>";
				}
				if(this.hasExactly("Vallastone") || this.hasExactly("Dragon Monarch") || this.hasExactly("Corrupted Dragon") || this.hasExactly("Fortifications") || this.hasExactly("Oath of Ostia") || (this.hasExactly("Taciturn Axe") && this.rValue == 5)){
					this.vein = 1;
					roundText += this.name + " applies Divine Vein (Stone) after combat.<br>";
				}
				if(this.hasExactly("Holy-Knight 2") && tlCheck == 1){
					this.bonus.fSight = true;
					roundText += this.name + " gains 1T 40% DR Status.<br>";
				}
			}
			//Do stuff if enemy isn't dead
			if(enemy.hp > 0){
				if(enemy.hasExactly("Makings of a King") && enemy.sTrigger == 1){
					enemy.talent.atk += 4;
					enemy.talent.atk = Math.min(enemy.talent.atk, 20);
					enemy.talent.def += 4;
					enemy.talent.def = Math.min(enemy.talent.def, 20);
					enemy.talent.res += 4;
					enemy.talent.res = Math.min(enemy.talent.res, 20);
					roundText += enemy.name + " activates Makings of a King and gains +4 atk/def/res [Great Talent].<br>";
				}
				if(enemy.has("Speedtaker") && enemy.didAttack){
					var sMax = enemy.has("Speedtaker") * 5;
					enemy.talent.spd += enemy.has("Speedtaker");
					enemy.talent.spd = Math.min(enemy.talent.spd, sMax);
					roundText += enemy.name + " activates " + data.skills[enemy.bIndex].name + " and gains +" + enemy.has("Speedtaker") + " spd [Great Talent].<br>";
				}
				//check for max CD goes first
				if(enemy.charge - enemy.initSkillCharge() == 0){
					if(enemy.hasExactly("Time's Pulse 4") || enemy.hasExactly("Time Pulse Edge") || enemy.hasExactly("Time Pulse Helm")){
						enemy.charge += 1;
						roundText += enemy.name + " gains +1 CD from " + data.skills[enemy.cIndex].name + " after combat.<br>";
					}
					else if(enemy.hasExactly("Connected World") && enemy.buddy.adjacent + enemy.buddy.two + enemy.buddy.three > 0){
						enemy.charge += 1;
						roundText += enemy.name + " gains +1 CD from Connected World after combat.<br>";
					}
					if((enemy.hasExactly("Vassal-Saint Steel") || enemy.hasExactly("Hoshido's Breath") || enemy.hasExactly("Hungry Cat Fang") || enemy.hasExactly("Duskstone")) && enemy.combatStartHp / enemy.maxHp >= 0.25){
						enemy.charge += 1;
						roundText += enemy.name + " gains +1 CD from " + data.skills[enemy.weaponIndex].name + " after combat.<br>";
					}
					else if(enemy.hasExactly("Larcei's Edge") && enemy.rValue == 5 && enemy.combatStartHp / enemy.maxHp >= 0.25){
						enemy.charge += 1;
						roundText += enemy.name + " gains +1 CD from Larcei's Edge after combat.<br>";
					}
					else if(enemy.hasExactly("Majestic Glitnir") && enemy.buddy.rorc > 0){
						enemy.charge += 1;
						roundText += enemy.name + " gains +1 CD from Majestic Glitnir after combat.<br>";
					}
					else if(enemy.hasExactly("Stone of Delights") && enemy.buddy.adjacent + enemy.buddy.two + enemy.buddy.three > 0){
						enemy.charge += 1;
						roundText += enemy.name + " gains +1 CD from Stone of Delights after combat.<br>";
					}
					else if((enemy.hasExactly("Opposing Stones") || enemy.hasExactly("Icy Ravager")) && (this.initiator || this.combatStartHp / this.maxHp >= 0.75)){
						enemy.charge += 1;
						roundText += enemy.name + " gains +1 CD from " + data.skills[enemy.weaponIndex].name + " after combat.<br>";
					}
					if(enemy.hasExactly("Time Pulse Echo")){
						enemy.charge += 1;
						roundText += enemy.name + " gains +1 CD from Time Pulse Echo after combat.<br>";
					}
					if(enemy.support.tPulse > 0){
						enemy.charge += enemy.support.tPulse;
						roundText += enemy.name + " gains +" + enemy.support.tPulse + " CD from Time's Pulse Support after combat.<br>";
					}
				}
				if(enemy.hasExactly("Dark Mystletainn") && enemy.sTrigger == 1){
					enemy.charge += 2;
					roundText += enemy.name + " gains +2 CD from Dark Mystletainn after combat.<br>";
				}
				else if(enemy.has("Bunny Fang") && (enemy.hp/enemy.maxHp <= 0.75 || (enemy.rValue > 0 && enemy.hp/enemy.maxHp <= 0.9))){
					enemy.charge += 2;
					roundText += enemy.name + " gains +2 CD from Bunny Fang after combat.<br>";
				}
				else if(enemy.hasExactly("Bride's Fang") && enemy.sTrigger == 1 && (this.combatStartHp/this.maxHp >= 0.75 || (enemy.rValue > 0 && !this.initiator))){
					if(enemy.rValue < 0 && enemy.didAttack){
						enemy.charge += 1;
						roundText += enemy.name + " gains +1 CD from Bride's Fang after combat.<br>";
					}
					else if(enemy.rValue > 0){
						enemy.charge += 2;
						roundText += enemy.name + " gains +2 CD from Bride's Fang after combat.<br>";
					}
				}
				else if(enemy.hasExactly("Royal Sword") && enemy.rValue == 5 && enemy.combatStartHp / enemy.maxHp >= 0.25){
					enemy.charge += 1;
					roundText += enemy.name + " gains +1 CD from Royal Sword after combat.<br>";
				}
				else if((enemy.has("Spendthrift Bow") || (enemy.hasExactly("Lucky Bow") && (this.initiator || this.combatStartHp/this.maxHp >= 0.75))) && enemy.didAttack){
					enemy.charge -= 2;
					roundText += enemy.name + " loses -2 CD from " + data.skills[enemy.weaponIndex].name + " after combat.<br>";
				}
				else if(enemy.hasExactly("Peshkatz") && enemy.rValue == 5 && enemy.combatStartHp / enemy.maxHp >= 0.25){
					enemy.charge += 1;
					roundText += enemy.name + " gains +1 CD from Peshkatz after combat.<br>";
				}
				else if((enemy.hasExactly("Ascending Blade") || enemy.hasExactly("Firelight Lance")) && enemy.combatStartHp / enemy.maxHp >= 0.25){
					enemy.charge += 1;
					roundText += enemy.name + " gains +1 CD from " + data.skills[enemy.weaponIndex].name + " after combat.<br>";
				}
				else if(enemy.hasExactly("Inner Wellspring") && (!this.initiator || enemy.buddy.adjacent > 0 || enemy.buddy.two > 0) && enemy.sTrigger == 1){
					enemy.charge += 1;
					roundText += enemy.name + " gains +1 CD from Inner Wellspring after combat.<br>";
				}
				else if(enemy.hasExactly("Wary Rabbit Fang") && (!this.initiator || enemy.toggle.weapon == 1) && enemy.hp / enemy.maxHp <= 0.9){
					enemy.charge += 2;
					roundText += enemy.name + " gains +2 CD from Wary Rabbit Fang after combat.<br>";
				}
				else if(enemy.hasExactly("Lone-Wolf Blade") && enemy.combatStartHp / enemy.maxHp >= 0.25){
					if(enemy.charge - enemy.initSkillCharge() == 0){
						enemy.charge += 2;
						roundText += enemy.name + " gains +2 CD from Lone-Wolf Blade after combat.<br>";
					}
					else if(enemy.charge - enemy.initSkillCharge() == 1){
						enemy.charge += 1;
						roundText += enemy.name + " gains +1 CD from Lone-Wolf Blade after combat.<br>";
					}
				}
				else if(enemy.hasExactly("Striving Sword") && (enemy.buddy.adjacent > 0 || enemy.buddy.two > 0 || enemy.buddy.three > 0) && enemy.sTrigger == 1){
					enemy.charge += 2;
					roundText += enemy.name + " gains +2 CD from Striving Sword after combat.<br>";
				}
				else if(enemy.hasExactly("Full Rabbit Fang") && (enemy.transform == true || enemy.toggle.weapon > 1) && enemy.hp / enemy.maxHp <= 0.9){
					enemy.charge += 2;
					roundText += enemy.name + " gains +2 CD from Full Rabbit Fang after combat.<br>";
				}
				if(enemy.has("Special Spiral") && enemy.sTrigger == 1){
					var ssCharge = 0;
					if(enemy.has("Special Spiral") == 1 && enemy.initiator){
						ssCharge = 1;
					}
					else if(enemy.has("Special Spiral") == 2){
						ssCharge = 1;
					}
					else if(enemy.has("Special Spiral") > 2){
						ssCharge = 2;
					}
					enemy.charge += ssCharge;
					roundText += enemy.name + " gains +" + ssCharge + " CD from " + data.skills[enemy.bIndex].name + " after combat.<br>";
				}
				else if(enemy.hasExactly("Deadly Balance+") && enemy.sTrigger == 1){
					enemy.charge += 2;
					roundText += enemy.name + " gains +2 CD from Deadly Balance+ after combat.<br>";
				}
				if(this.hp > 0){
					if(this.hasExactly("Peshkatz") && this.rValue == 5 && this.combatStartHp / this.maxHp >= 0.25){
						enemy.charge -= 1;
						roundText += this.name + " inflicts CD +1 with Peshkatz to " + enemy.name + " after combat.<br>";
					}
					if((this.hasExactly("Atrocity") && enemy.combatStartHp / enemy.maxHp >= 0.5) || (this.hasExactly("Atrocity 2") && enemy.combatStartHp / enemy.maxHp >= 0.4)){
						enemy.charge -= 1;
						var aText = "";
						if(this.hasExactly("Atrocity 2") && enemy.combatStartHp / enemy.maxHp >= 0.4){
							enemy.penalty.cdguard = true;
							aText = " and Guard status";
						}
						roundText += this.name + " inflicts CD +1" + aText + " with " + data.skills[this.bIndex].name + " to " + enemy.name + " after combat.<br>";
					}
					else if(this.hasExactly("Barbarity") && enemy.combatStartHp / enemy.maxHp >= 0.25){
						this.bonus.vantage = true;
						this.bonus.dodge = true;
						roundText += this.name + " gains [Vantage] & [Dodge] Bonus from Barbarity.<br>";
					}
					if(this.has("Pulse Smoke") && enemy.charge - enemy.initSkillCharge() > 0){
						enemy.charge -= 1;
						roundText += this.name + " inflicts CD +1 with " + data.skills[this.cIndex].name + " to " + enemy.name + " after combat.<br>";
					}
					if(this.hasExactly("Pulse Smog")){
						var psText = "-7 atk, [Guard]";
						if(enemy.charge - enemy.initSkillCharge() > 0){
							enemy.charge -= 1;
							psText += ", and CD +1";
						}
						enemy.combatDebuffs.atk = Math.min(-7,enemy.combatDebuffs.atk);
						enemy.penalty.cdguard = true;
						roundText += this.name + " inflicts " + psText + " with Pulse Smog to " + enemy.name + " after combat.<br>";
					}
					//Not CD related, but this has to be alive for this to trigger
					if(this.hasExactly("Panic Smoke 3") || this.hasExactly("Panic Smoke 4") || (this.initiator && (this.hasExactly("Panic Smoke 1") || this.hasExactly("Panic Smoke 2"))) || (this.hasExactly("Incipit Kvasir") && this.combatStartHp / this.maxHp >= 0.25 && this.didAttack)){
						enemy.penalty.panic = true;
						roundText += this.name + " panics " + enemy.name + ".<br>";
						if(this.hasExactly("Panic Smoke 4")){
							enemy.combatDebuffs.atk = Math.min(-3,enemy.combatDebuffs.atk);
							enemy.combatDebuffs.spd = Math.min(-3,enemy.combatDebuffs.spd);
							enemy.combatDebuffs.def = Math.min(-3,enemy.combatDebuffs.def);
							enemy.combatDebuffs.res = Math.min(-3,enemy.combatDebuffs.res);
							this.bonus.penDoubler = true;
							roundText += this.name + " inflicts -3 atk/spd/def/res to " + enemy.name + " and gains Foe Penalty Doubler Bonus from Panic Smoke 4.<br>";
						}
					}
					if(this.has("Fatal Smoke") > 2 || (this.initiator && (this.hasExactly("Fatal Smoke 1") || this.hasExactly("Fatal Smoke 2"))) || (this.hasExactly("Flamelick Breath") && this.combatStartHp / this.maxHp >= 0.25) || this.has("Serpentine Staff") || this.has("Incurable")){
						enemy.penalty.fatal = true;
						var fText = "";
						if(this.hasExactly("Fatal Smoke 4")){
							enemy.penalty.nullArise = true;
							fText = " and Null Miracle";
						}
						roundText += this.name + " inflicts " + enemy.name + " with Deep Wounds" + fText + " Status.<br>";
					}
					if(enemy.hasExactly("Spd Smoke 4")){
						this.combatDebuffs.spd = Math.min(-7,this.combatDebuffs.spd);
						roundText += enemy.name + " inflicts -7 spd to " + this.name + " from Spd Smoke 4.<br>";
					}
					if(enemy.hasExactly("Atk Smoke 4")){
						this.combatDebuffs.atk = Math.min(-7,this.combatDebuffs.atk);
						roundText += enemy.name + " inflicts -7 atk to " + this.name + " from Atk Smoke 4.<br>";
					}
					if(enemy.hasExactly("Def Res Smoke 3")){
						this.combatDebuffs.def = Math.min(-7,this.combatDebuffs.def);
						this.combatDebuffs.res = Math.min(-7,this.combatDebuffs.res);
						roundText += enemy.name + " inflicts -7 def and res to " + this.name + " from Def Res Smoke 3.<br>";
					}
					if(enemy.hasExactly("Light's Restraint") && enemy.sTrigger == 1){
						this.charge -= 1;
						this.penalty.cdguard = true;
						roundText += enemy.name + " inflicts CD +1 and Guard status with Light's Restraint to " + this.name + " after combat.<br>";
					}
					if(enemy.hasExactly("Holy Panic") && enemy.sTrigger == 1){
						this.combatDebuffs.atk = Math.min(-6,this.combatDebuffs.atk);
						this.combatDebuffs.spd = Math.min(-6,this.combatDebuffs.spd);
						this.penalty.panic = true;
						roundText += enemy.name + " inflicts -6 atk & spd and Panic status with Holy Panic to " + this.name + " after combat.<br>";
					}
					if(enemy.hasExactly("Holy-Knight 2") && enemy.sTrigger == 1){
						enemy.bonus.fSight = true;
						roundText += enemy.name + " gains 1T 40% DR Status.<br>";
					}
					if((enemy.hasExactly("Dragon Fang Shot") || enemy.hasExactly("Dragon Fang Fire")) && enemy.sTrigger == 1){
						this.vein = 5;
						roundText += enemy.name + " applies Divine Vein (Water) on " + this.name + "'s space after combat.<br>";
					}
					if(enemy.hasExactly("Pure Atrocity")){
						this.vein = 4;
						roundText += enemy.name + " applies Divine Vein (Haze) on " + this.name + "'s space after combat.<br>";
					}
					if(this.hasExactly("Great Aether") && tlCheck == 1 && enemy.charge - enemy.initSkillCharge() > 0){
						enemy.charge -= 1;
						roundText += this.name + " inflicts CD +1 with Great Aether to " + enemy.name + " after combat.<br>";
					}
				}
				enemy.charge = Math.max(0,enemy.charge);
				if(enemy.specialIndex != -1 && data.skills[enemy.specialIndex].charge <= enemy.charge){
					enemy.charge = data.skills[enemy.specialIndex].charge;
				}
				roundText += enemy.postCombatHPAdjust(galecheck,this,tlCheck);
				enemy.arise = false;
				roundText += enemy.postCombatBuff();
				roundText += this.seal(enemy);
				enemy.sTrigger = 0;
				if(this.didAttack){
					if(this.hasExactly("Panic") || this.hasExactly("Panic+") || this.has("Legion's Axe") || this.hasExactly("Sneering Axe") || (this.hasExactly("Monstrous Bow+") && this.rValue > 0) || (this.hasExactly("Spectral Tome+") && this.rValue > 0) || (this.hasExactly("Elena's Staff") && this.rValue == 5) || (this.hasExactly("Tiger Spirit") && this.combatStartHp / this.maxHp >= 0.25)){
						enemy.penalty.panic = true;
						roundText += this.name + " panics " + enemy.name + ".<br>";
					}
					if(this.has("Candlelight") || this.hasExactly("Flash") || this.hasExactly("Flash+") || this.hasExactly("Doting Staff") || this.hasExactly("Venin Edge") || (this.hasExactly("Obsessive Curse") && this.rValue == 5) || (this.hasExactly("Frostbite Breath") && this.combatStartHp / this.maxHp >= 0.25)|| this.hasExactly("Dusk-Dawn Staff") || (this.hasExactly("Flower of Ease") && this.rValue == 5 && this.combatStartHp / this.maxHp >= 0.25) || this.hasExactly("Faded Paper Fan") || (this.hasExactly("Glitter of Light") && tlCheck == 1)){
						enemy.penalty.lit = true;
						roundText += this.name + " inflicts " + enemy.name + " with an inability to make counterattacks.<br>";
					}
					if(this.has("Trilemma") || this.hasExactly("Punishment Staff")){
						enemy.penalty.trilemma = true;
						roundText += this.name + " inflicts " + enemy.name + " with Triangle Adept Status.<br>";
					}
					if(this.has("Witchy Wand") || this.has("Melancholy") || this.hasExactly("Staff of Lilies")){
						enemy.penalty.cdguard = true;
						enemy.resetCharge();
						roundText += this.name + " inflicts " + enemy.name + " with Guard Status.<br>";
					}
					if(this.hasExactly("Caring Conch")){
						enemy.penalty.cdguard = true;
						roundText += this.name + " inflicts " + enemy.name + " with Guard Status.<br>";
					}
					if(this.hasExactly("Venin Edge") && this.rValue == 5 && this.buddy.adjacent < 2){
						enemy.penalty.discord = true;
						roundText += this.name + " inflicts " + enemy.name + " with Discord Status.<br>";
					}
					if(this.bonus.essence && !enemy.bonus.dosage){
						var bKey = Object.keys(enemy.bonus).filter(a => enemy.bonus[a] === true);
						for(var i = 0; i < bKey.length; i++){
							enemy.bonus[bKey[i]] = false;
							this.bonus[bKey[i]] = true;
						}
					}
				}
				if(enemy.has("Faithful Loyalty")){
					enemy.bonus.vantage = true;
					roundText += enemy.name + " gains Vantage Status.<br>";
				}
				if(enemy.hasExactly("Spd Smoke 4")){
					enemy.combatBuffs.spd = Math.max(6,enemy.combatBuffs.spd);
					enemy.bonus.dodge = true;
					roundText += enemy.name + " gains +6 spd and Dodge Status from Spd Smoke 4.<br>";
				}
				if(enemy.hasExactly("Atk Smoke 4")){
					enemy.combatBuffs.def = Math.max(6,enemy.combatBuffs.def);
					enemy.combatBuffs.res = Math.max(6,enemy.combatBuffs.res);
					enemy.bonus.stopD = true;
					roundText += enemy.name + " gains +6 def/res and Deny Follow-Up Status from Atk Smoke 4.<br>";
				}
				if(enemy.hasExactly("Def Res Smoke 3")){
					enemy.combatBuffs.atk = Math.max(6,enemy.combatBuffs.atk);
					roundText += enemy.name + " gains +6 atk from Def Res Smoke 3.<br>";
				}
			}
			
			//After everything has been calced, if both are alive, check for Gae and RStorm and Dances
			if(this.hp > 0 && enemy.hp > 0){
				//Time Is Light has highest priority
				if((this.hasExactly("Time Is Light") || this.hasExactly("Time and Light")) && tlCheck == 1 && options.useGaleforce && !galeused && this.hp > 0 && enemy.hp > 0){
					roundText += this.name + " initiates again with " + data.skills[this.specialIndex].name + "!<br>";
					this.resetCharge();
					roundText += this.attack(enemy,turn,true,rstorm,dturn);
				}
				//Raging Storm/Twin-Crest Power/Victorious Axe comes before Galeforce
				else if((((this.hasExactly("Raging Storm") || this.hasExactly("Raging Storm 2") || this.hasExactly("Gold Unwinding") || this.hasExactly("Lone Wolf")) && this.toggle.b == 1) || (this.hasExactly("Twin-Crest Power") && this.combatStartHp / this.maxHp >= 0.25 && this.transform) || (this.hasExactly("Victorious Axe") && this.rValue == 5 && this.toggle.weapon > 1) || (this.hasExactly("Quietus Gullveig") && this.toggle.weapon == 1) || (this.hasExactly("Raging Tempest") && this.buddy.adjacent < 2) || this.hasExactly("Golden Sunlight") || this.hasExactly("Eagle's Heart") || this.hasExactly("Lion's Heart") || this.hasExactly("Deer's Heart") || (this.hasExactly("Pure Storm") && this.buddy.adjacent < 2)) && this.initiator && rstorm < 2 && options.useGaleforce){
					roundText += this.name + " initiates again!<br>";
					if(this.hasExactly("Eagle's Heart") && (this.hasExactly("Pure Storm") && this.buddy.adjacent < 2) && rstorm == 0){
						roundText += this.attack(enemy,turn,galeused,1,dturn);
					}
					else{
						roundText += this.attack(enemy,turn,galeused,2,dturn);
					}
				}
				//Galeforce/Njorun's Zeal
				else if((this.hasExactly("Galeforce") || this.has("Njorun's Zeal")) && data.skills[this.specialIndex].charge <= this.charge && options.useGaleforce && !galeused && this.hp > 0 && enemy.hp > 0){
					roundText += this.name + " initiates again with " + data.skills[this.specialIndex].name + "!<br>";
					this.resetCharge();
					roundText += this.attack(enemy,turn,true,rstorm,dturn);
				}
				//Override
				else if(this.hasExactly("Override") && tlCheck == 1 && this.toggle.special == 1 && options.useGaleforce && !galeused && this.hp > 0 && enemy.hp > 0){
					roundText += this.name + " initiates again with " + data.skills[this.specialIndex].name + "!<br>";
					roundText += this.attack(enemy,turn,true,rstorm,dturn);
				}
				//Dance Check
				if(danceCount > 0 && this.hp > 0 && enemy.hp > 0){
					danceCount--;
					dturn++;
					roundText += this.name + " gets refreshed and goes again!<br>";
					roundText += this.attack(enemy,turn,galeused,rstorm,dturn);
				}
				//Remove enemy buffs after all combat is done (for next phase)
				if(!galeused && rstorm == 0 && danceCount == 0){
					enemy.bonus.dominance = false;
					enemy.bonus.stopD = false;
					enemy.bonus.vantage = false;
					enemy.bonus.dodge = false;
					enemy.bonus.nfus = false;
					enemy.bonus.bDoubler = false;
					enemy.bonus.penDoubler = false;
					enemy.bonus.starlight = false;
					enemy.bonus.nPenalty = false;
					enemy.bonus.divineFang = false;
					enemy.bonus.nullArmor = false;
					enemy.bonus.nullDragon = false;
					enemy.bonus.nullFlying = false;
					enemy.bonus.nullPanic = false;
					enemy.bonus.despacito = false;
					enemy.bonus.triAtk = false;
					enemy.bonus.autoD = false;
					enemy.bonus.dull = false;
					enemy.bonus.gStrat = false;
					enemy.bonus.enGarde = false;
					enemy.bonus.breathB = false;
					enemy.bonus.treachery = false;
					enemy.bonus.caff = false;
					enemy.bonus.resoB = false;
					enemy.bonus.resoS = false;
					enemy.bonus.bexblade = false;
					enemy.bonus.spectrum = false;
					enemy.bonus.fSight = false;
					enemy.bonus.rotten = false;
					enemy.bonus.essence = false;
					enemy.bonus.paranoia = false;
					enemy.bonus.incited = false;
					enemy.bonus.anathema = false;
					enemy.bonus.fWitness = false;
					enemy.bonus.dosage = false;
					enemy.bonus.preempt = false;
					enemy.bonus.pfollow = false;
					enemy.bonus.sdiff = false;
					enemy.bonus.dHex = false;
					enemy.bonus.fEmblem = false;
					enemy.bonus.nectar = 0;
					enemy.bonus.empathy = 0;
					enemy.bonus.divinely = 0;
				}
			}
			
			var tcsText = this.name + ":";
			var ecsText = enemy.name + ":";
			for(var i = 16; i < 20; i++){
				var vsVal = 0;
				var vsKey = "";
				if(i == 16){
					vsKey = "atk";
					vsVal = thisEffAtk - allStats[16];
				}
				else if(i == 17){
					vsKey = ", spd";
					vsVal = thisEffSpd - allStats[17];
				}
				else if(i == 18){
					vsKey = ", def";
					vsVal = thisEffDef - allStats[18];
				}
				else if(i == 19){
					vsKey = ", res";
					vsVal = thisEffRes - allStats[19];
				}
				if(vsVal < 0){
					tcsText += vsKey + " <span style=\"color:#fe4f6d\">" + vsVal + "</span>";
				}
				else if(vsVal == 0){
					tcsText += vsKey + " +" + vsVal;
				}
				else{
					tcsText += vsKey + " <span style=\"color:#56e8ff\">+" + vsVal + "</span>";
				}
			}
			for(var i = 20; i < 24; i++){
				var vsVal = 0;
				var vsKey = "";
				if(i == 20){
					vsKey = "atk";
					vsVal = enemyEffAtk - allStats[20];
				}
				else if(i == 21){
					vsKey = ", spd";
					vsVal = enemyEffSpd - allStats[21];
				}
				else if(i == 22){
					vsKey = ", def";
					vsVal = enemyEffDef - allStats[22];
				}
				else if(i == 23){
					vsKey = ", res";
					vsVal = enemyEffRes - allStats[23];
				}
				if(vsVal < 0){
					ecsText += vsKey + " <span style=\"color:#fe4f6d\">" + vsVal + "</span>";
				}
				else if(vsVal == 0){
					ecsText += vsKey + " +" + vsVal;
				}
				else{
					ecsText += vsKey + " <span style=\"color:#56e8ff\">+" + vsVal + "</span>";
				}
			}
			roundText = "<hr>" + tcsText + "<br>" + ecsText + "<hr style=\"border: 1px dashed #333333 ;\">" + roundText;
			return roundText;
		}
		else{
			roundText = "Unit does not have a weapon equipped, cannot initiate combat.";
			return roundText;
		}
	};
}

//////////////////////////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////////////////////////

//Purely utility

//////////////////////////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////////////////////////

function capitalize(string){
	if(string.length > 0){
		return string.charAt(0).toUpperCase() + string.slice(1);
	}
	else{
		return string;
	}
}

function replaceRecursive(original,replace){
	for(var key in replace){
		if(typeof original[key] == "object"){
			replaceRecursive(original[key],replace[key]);
		}
		else{
			original[key] = replace[key];
		}
	}
}

function changeDataVar(dataVar,newVal){
	var dataSplit = dataVar.split(".");
	var parsedVar = window;
	for(var level = 0; level < dataSplit.length; level++){
		if(dataSplit[level] == "challenger"){
			//Replace challenger with challenger[i]
			//This won't be the last run
			parsedVar = parsedVar[dataSplit[level]][options.challengerSelected];
		}
		else if(dataSplit[level] == "list"){
			//Replace list with list[i]
			//This won't be the last run
			parsedVar = parsedVar[dataSplit[level]][options.customEnemySelected];
		}
		else{
			if(level == dataSplit.length-1){
				//Last run - set the variable
				parsedVar[dataSplit[level]] = newVal;
			}
			else{
				parsedVar = parsedVar[dataSplit[level]];
			}
		}
		if(typeof parsedVar == "undefined"){
			break;
		}
	}
}

function beginsWith(fullString, substring){
	return (fullString.slice(0, substring.length) == substring);
}

function endsWith(fullString, substring){
	return (fullString.slice(-substring.length) == substring);
}

function getHtmlPrefix(hero){
	var htmlPrefix = "";
	if(hero.challenger){
		htmlPrefix = "challenger_";
	}
	else{
		htmlPrefix = "cl_enemy_";
	}
	return htmlPrefix;
}

function getSkillIndexFromId(skillid){
	var index = -1;
	for(var i = 0; i < data.skills.length; i++){
		if(data.skills[i].skill_id == skillid){
			index = i;
			break;
		}
	}
	//console.log("Looked for index of skill id " + skillid + "; found at " + index);
	return index;
}

function getIndexFromName(name,dataList,slot){
	//Skill/hero array is sorted by name + slot! (only name in case of heroes)
	name = name.toLowerCase();
	slot = slot || "";

	var leftBound = 0;
	var rightBound = dataList.length - 1;
	var checkingIndex;
	var testName;
	var testSlot;
	var testIsS;
	var found = -1;
	do{
		if(name.indexOf("generic") != -1){
			checkingIndex = Math.round((rightBound - leftBound) + leftBound);
		}
		else{
			checkingIndex = Math.round((rightBound - leftBound) / 2 + leftBound);
		}
		testName = dataList[checkingIndex].name.toLowerCase();
		testSlot = dataList[checkingIndex].slot || "";
		//console.log(name+", "+testName);
		if(testName + testSlot == name + slot){
			found = checkingIndex;
			break;
		}
		else if(testName + testSlot > name + slot || testName.indexOf("generic") != -1){
			rightBound = checkingIndex - 1;
		}
		else{
			leftBound = checkingIndex + 1;
		}
	}
	while(leftBound <= rightBound);

	return found;
}

function getAttackTypeFromWeapon(weaponType){
	if(data.physicalWeapons.indexOf(weaponType) != -1){
		return "physical";
	}
	else if(data.magicalWeapons.indexOf(weaponType) != -1){
		return "magical";
	}
	else{
		return "unknown";
	}
}

function verifyNumberInput(element,min,max){
	//contrains number between two values and returns it
	newVal = parseInt($(element).val());
	if(!newVal){
		//If input is blank, make it 0
		newVal = 0;
		$(element).val(0);
	}
	if(newVal < min){
		$(element).val(min);
		newVal = min;
	}
	else if(newVal > max){
		$(element).val(max);
		newVal = max;
	}
	return newVal;
}

function removeDiacritics (str) {
	//Copied from
	//https://stackoverflow.com/questions/18123501/replacing-accented-characters-with-plain-ascii-ones
	// added to d
	var defaultDiacriticsRemovalMap = [
		{'base':'A', 'letters':/[\u0041\u24B6\uFF21\u00C0\u00C1\u00C2\u1EA6\u1EA4\u1EAA\u1EA8\u00C3\u0100\u0102\u1EB0\u1EAE\u1EB4\u1EB2\u0226\u01E0\u00C4\u01DE\u1EA2\u00C5\u01FA\u01CD\u0200\u0202\u1EA0\u1EAC\u1EB6\u1E00\u0104\u023A\u2C6F]/g},
		{'base':'AA','letters':/[\uA732]/g},
		{'base':'AE','letters':/[\u00C6\u01FC\u01E2]/g},
		{'base':'AO','letters':/[\uA734]/g},
		{'base':'AU','letters':/[\uA736]/g},
		{'base':'AV','letters':/[\uA738\uA73A]/g},
		{'base':'AY','letters':/[\uA73C]/g},
		{'base':'B', 'letters':/[\u0042\u24B7\uFF22\u1E02\u1E04\u1E06\u0243\u0182\u0181]/g},
		{'base':'C', 'letters':/[\u0043\u24B8\uFF23\u0106\u0108\u010A\u010C\u00C7\u1E08\u0187\u023B\uA73E]/g},
		{'base':'D', 'letters':/[\u0044\u24B9\uFF24\u1E0A\u010E\u1E0C\u1E10\u1E12\u1E0E\u0110\u018B\u018A\u0189\uA779]/g},
		{'base':'DZ','letters':/[\u01F1\u01C4]/g},
		{'base':'Dz','letters':/[\u01F2\u01C5]/g},
		{'base':'E', 'letters':/[\u0045\u24BA\uFF25\u00C8\u00C9\u00CA\u1EC0\u1EBE\u1EC4\u1EC2\u1EBC\u0112\u1E14\u1E16\u0114\u0116\u00CB\u1EBA\u011A\u0204\u0206\u1EB8\u1EC6\u0228\u1E1C\u0118\u1E18\u1E1A\u0190\u018E]/g},
		{'base':'F', 'letters':/[\u0046\u24BB\uFF26\u1E1E\u0191\uA77B]/g},
		{'base':'G', 'letters':/[\u0047\u24BC\uFF27\u01F4\u011C\u1E20\u011E\u0120\u01E6\u0122\u01E4\u0193\uA7A0\uA77D\uA77E]/g},
		{'base':'H', 'letters':/[\u0048\u24BD\uFF28\u0124\u1E22\u1E26\u021E\u1E24\u1E28\u1E2A\u0126\u2C67\u2C75\uA78D]/g},
		{'base':'I', 'letters':/[\u0049\u24BE\uFF29\u00CC\u00CD\u00CE\u0128\u012A\u012C\u0130\u00CF\u1E2E\u1EC8\u01CF\u0208\u020A\u1ECA\u012E\u1E2C\u0197]/g},
		{'base':'J', 'letters':/[\u004A\u24BF\uFF2A\u0134\u0248]/g},
		{'base':'K', 'letters':/[\u004B\u24C0\uFF2B\u1E30\u01E8\u1E32\u0136\u1E34\u0198\u2C69\uA740\uA742\uA744\uA7A2]/g},
		{'base':'L', 'letters':/[\u004C\u24C1\uFF2C\u013F\u0139\u013D\u1E36\u1E38\u013B\u1E3C\u1E3A\u0141\u023D\u2C62\u2C60\uA748\uA746\uA780]/g},
		{'base':'LJ','letters':/[\u01C7]/g},
		{'base':'Lj','letters':/[\u01C8]/g},
		{'base':'M', 'letters':/[\u004D\u24C2\uFF2D\u1E3E\u1E40\u1E42\u2C6E\u019C]/g},
		{'base':'N', 'letters':/[\u004E\u24C3\uFF2E\u01F8\u0143\u00D1\u1E44\u0147\u1E46\u0145\u1E4A\u1E48\u0220\u019D\uA790\uA7A4]/g},
		{'base':'NJ','letters':/[\u01CA]/g},
		{'base':'Nj','letters':/[\u01CB]/g},
		{'base':'O', 'letters':/[\u004F\u24C4\uFF2F\u00D2\u00D3\u00D4\u1ED2\u1ED0\u1ED6\u1ED4\u00D5\u1E4C\u022C\u1E4E\u014C\u1E50\u1E52\u014E\u022E\u0230\u00D6\u022A\u1ECE\u0150\u01D1\u020C\u020E\u01A0\u1EDC\u1EDA\u1EE0\u1EDE\u1EE2\u1ECC\u1ED8\u01EA\u01EC\u00D8\u01FE\u0186\u019F\uA74A\uA74C]/g},
		{'base':'OI','letters':/[\u01A2]/g},
		{'base':'OO','letters':/[\uA74E]/g},
		{'base':'OU','letters':/[\u0222]/g},
		{'base':'P', 'letters':/[\u0050\u24C5\uFF30\u1E54\u1E56\u01A4\u2C63\uA750\uA752\uA754]/g},
		{'base':'Q', 'letters':/[\u0051\u24C6\uFF31\uA756\uA758\u024A]/g},
		{'base':'R', 'letters':/[\u0052\u24C7\uFF32\u0154\u1E58\u0158\u0210\u0212\u1E5A\u1E5C\u0156\u1E5E\u024C\u2C64\uA75A\uA7A6\uA782]/g},
		{'base':'S', 'letters':/[\u0053\u24C8\uFF33\u1E9E\u015A\u1E64\u015C\u1E60\u0160\u1E66\u1E62\u1E68\u0218\u015E\u2C7E\uA7A8\uA784]/g},
		{'base':'T', 'letters':/[\u0054\u24C9\uFF34\u1E6A\u0164\u1E6C\u021A\u0162\u1E70\u1E6E\u0166\u01AC\u01AE\u023E\uA786]/g},
		{'base':'TZ','letters':/[\uA728]/g},
		{'base':'U', 'letters':/[\u0055\u24CA\uFF35\u00D9\u00DA\u00DB\u0168\u1E78\u016A\u1E7A\u016C\u00DC\u01DB\u01D7\u01D5\u01D9\u1EE6\u016E\u0170\u01D3\u0214\u0216\u01AF\u1EEA\u1EE8\u1EEE\u1EEC\u1EF0\u1EE4\u1E72\u0172\u1E76\u1E74\u0244]/g},
		{'base':'V', 'letters':/[\u0056\u24CB\uFF36\u1E7C\u1E7E\u01B2\uA75E\u0245]/g},
		{'base':'VY','letters':/[\uA760]/g},
		{'base':'W', 'letters':/[\u0057\u24CC\uFF37\u1E80\u1E82\u0174\u1E86\u1E84\u1E88\u2C72]/g},
		{'base':'X', 'letters':/[\u0058\u24CD\uFF38\u1E8A\u1E8C]/g},
		{'base':'Y', 'letters':/[\u0059\u24CE\uFF39\u1EF2\u00DD\u0176\u1EF8\u0232\u1E8E\u0178\u1EF6\u1EF4\u01B3\u024E\u1EFE]/g},
		{'base':'Z', 'letters':/[\u005A\u24CF\uFF3A\u0179\u1E90\u017B\u017D\u1E92\u1E94\u01B5\u0224\u2C7F\u2C6B\uA762]/g},
		{'base':'a', 'letters':/[\u0061\u24D0\uFF41\u1E9A\u00E0\u00E1\u00E2\u1EA7\u1EA5\u1EAB\u1EA9\u00E3\u0101\u0103\u1EB1\u1EAF\u1EB5\u1EB3\u0227\u01E1\u00E4\u01DF\u1EA3\u00E5\u01FB\u01CE\u0201\u0203\u1EA1\u1EAD\u1EB7\u1E01\u0105\u2C65\u0250]/g},
		{'base':'aa','letters':/[\uA733]/g},
		{'base':'ae','letters':/[\u00E6\u01FD\u01E3]/g},
		{'base':'ao','letters':/[\uA735]/g},
		{'base':'au','letters':/[\uA737]/g},
		{'base':'av','letters':/[\uA739\uA73B]/g},
		{'base':'ay','letters':/[\uA73D]/g},
		{'base':'b', 'letters':/[\u0062\u24D1\uFF42\u1E03\u1E05\u1E07\u0180\u0183\u0253]/g},
		{'base':'c', 'letters':/[\u0063\u24D2\uFF43\u0107\u0109\u010B\u010D\u00E7\u1E09\u0188\u023C\uA73F\u2184]/g},
		{'base':'d', 'letters':/[\u0064\u24D3\uFF44\u1E0B\u010F\u1E0D\u1E11\u1E13\u1E0F\u0111\u018C\u0256\u0257\uA77A\u00F0]/g},
		{'base':'dz','letters':/[\u01F3\u01C6]/g},
		{'base':'e', 'letters':/[\u0065\u24D4\uFF45\u00E8\u00E9\u00EA\u1EC1\u1EBF\u1EC5\u1EC3\u1EBD\u0113\u1E15\u1E17\u0115\u0117\u00EB\u1EBB\u011B\u0205\u0207\u1EB9\u1EC7\u0229\u1E1D\u0119\u1E19\u1E1B\u0247\u025B\u01DD]/g},
		{'base':'f', 'letters':/[\u0066\u24D5\uFF46\u1E1F\u0192\uA77C]/g},
		{'base':'g', 'letters':/[\u0067\u24D6\uFF47\u01F5\u011D\u1E21\u011F\u0121\u01E7\u0123\u01E5\u0260\uA7A1\u1D79\uA77F]/g},
		{'base':'h', 'letters':/[\u0068\u24D7\uFF48\u0125\u1E23\u1E27\u021F\u1E25\u1E29\u1E2B\u1E96\u0127\u2C68\u2C76\u0265]/g},
		{'base':'hv','letters':/[\u0195]/g},
		{'base':'i', 'letters':/[\u0069\u24D8\uFF49\u00EC\u00ED\u00EE\u0129\u012B\u012D\u00EF\u1E2F\u1EC9\u01D0\u0209\u020B\u1ECB\u012F\u1E2D\u0268\u0131]/g},
		{'base':'j', 'letters':/[\u006A\u24D9\uFF4A\u0135\u01F0\u0249]/g},
		{'base':'k', 'letters':/[\u006B\u24DA\uFF4B\u1E31\u01E9\u1E33\u0137\u1E35\u0199\u2C6A\uA741\uA743\uA745\uA7A3]/g},
		{'base':'l', 'letters':/[\u006C\u24DB\uFF4C\u0140\u013A\u013E\u1E37\u1E39\u013C\u1E3D\u1E3B\u017F\u0142\u019A\u026B\u2C61\uA749\uA781\uA747]/g},
		{'base':'lj','letters':/[\u01C9]/g},
		{'base':'m', 'letters':/[\u006D\u24DC\uFF4D\u1E3F\u1E41\u1E43\u0271\u026F]/g},
		{'base':'n', 'letters':/[\u006E\u24DD\uFF4E\u01F9\u0144\u00F1\u1E45\u0148\u1E47\u0146\u1E4B\u1E49\u019E\u0272\u0149\uA791\uA7A5]/g},
		{'base':'nj','letters':/[\u01CC]/g},
		{'base':'o', 'letters':/[\u006F\u24DE\uFF4F\u00F2\u00F3\u00F4\u1ED3\u1ED1\u1ED7\u1ED5\u00F5\u1E4D\u022D\u1E4F\u014D\u1E51\u1E53\u014F\u022F\u0231\u00F6\u022B\u1ECF\u0151\u01D2\u020D\u020F\u01A1\u1EDD\u1EDB\u1EE1\u1EDF\u1EE3\u1ECD\u1ED9\u01EB\u01ED\u00F8\u01FF\u0254\uA74B\uA74D\u0275]/g},
		{'base':'oi','letters':/[\u01A3]/g},
		{'base':'ou','letters':/[\u0223]/g},
		{'base':'oo','letters':/[\uA74F]/g},
		{'base':'p','letters':/[\u0070\u24DF\uFF50\u1E55\u1E57\u01A5\u1D7D\uA751\uA753\uA755]/g},
		{'base':'q','letters':/[\u0071\u24E0\uFF51\u024B\uA757\uA759]/g},
		{'base':'r','letters':/[\u0072\u24E1\uFF52\u0155\u1E59\u0159\u0211\u0213\u1E5B\u1E5D\u0157\u1E5F\u024D\u027D\uA75B\uA7A7\uA783]/g},
		{'base':'s','letters':/[\u0073\u24E2\uFF53\u00DF\u015B\u1E65\u015D\u1E61\u0161\u1E67\u1E63\u1E69\u0219\u015F\u023F\uA7A9\uA785\u1E9B]/g},
		{'base':'t','letters':/[\u0074\u24E3\uFF54\u1E6B\u1E97\u0165\u1E6D\u021B\u0163\u1E71\u1E6F\u0167\u01AD\u0288\u2C66\uA787]/g},
		{'base':'tz','letters':/[\uA729]/g},
		{'base':'u','letters':/[\u0075\u24E4\uFF55\u00F9\u00FA\u00FB\u0169\u1E79\u016B\u1E7B\u016D\u00FC\u01DC\u01D8\u01D6\u01DA\u1EE7\u016F\u0171\u01D4\u0215\u0217\u01B0\u1EEB\u1EE9\u1EEF\u1EED\u1EF1\u1EE5\u1E73\u0173\u1E77\u1E75\u0289]/g},
		{'base':'v','letters':/[\u0076\u24E5\uFF56\u1E7D\u1E7F\u028B\uA75F\u028C]/g},
		{'base':'vy','letters':/[\uA761]/g},
		{'base':'w','letters':/[\u0077\u24E6\uFF57\u1E81\u1E83\u0175\u1E87\u1E85\u1E98\u1E89\u2C73]/g},
		{'base':'x','letters':/[\u0078\u24E7\uFF58\u1E8B\u1E8D]/g},
		{'base':'y','letters':/[\u0079\u24E8\uFF59\u1EF3\u00FD\u0177\u1EF9\u0233\u1E8F\u00FF\u1EF7\u1E99\u1EF5\u01B4\u024F\u1EFF]/g},
		{'base':'z','letters':/[\u007A\u24E9\uFF5A\u017A\u1E91\u017C\u017E\u1E93\u1E95\u01B6\u0225\u0240\u2C6C\uA763]/g}
	];

	for(var i=0; i<defaultDiacriticsRemovalMap.length; i++) {
		str = str.replace(defaultDiacriticsRemovalMap[i].letters, defaultDiacriticsRemovalMap[i].base);
	}

	return str;
}

function hideUpdateNotice(){
	$("#frame_updatenotice").fadeOut(300);
}

function doUpdateNotice(){
	//If localStorage is not supported, hopefully this just throws an error on this function and doesn't break anything else
	var currentUpdate = parseInt($("#frame_updatenotice").attr("data-update"));
	var lastUpdate = localStorage.getItem("lastUpdateShown") || 0;
	if(lastUpdate<currentUpdate){
		localStorage.setItem("lastUpdateShown",currentUpdate);
		//Don't show the notification until the page is well-loaded
		setTimeout(function(){
			$("#frame_updatenotice").fadeIn(1000);
		}, 1000);
	}
}

//converts generic unit file name to a more readable format
function changeGenericName(name){
	var prefix = "";
	var fullName = "";
	
	if(name.indexOf("axe") != -1){
		prefix = "Axe ";
	}
	else if(name.indexOf("lance") != -1){
		prefix = "Lance ";
	}
	else if(name.indexOf("sword") != -1){
		prefix = "Sword ";
	}
	else if(name.indexOf("red") != -1){
		prefix = "Red ";
	}
	else if(name.indexOf("blue") != -1){
		prefix = "Blue ";
	}
	else if(name.indexOf("green") != -1){
		prefix = "Green ";
	}
	
	if(name.indexOf("infantry") != -1){
		if(name.indexOf("staff") != -1){
			fullName = "Cleric";
		}
		else if(name.indexOf("bow") != -1){
			if(prefix == ""){
				fullName = "Bow Fighter";
			}
			else{
				fullName = prefix + "Bow";
			}
		}
		else if(name.indexOf("dagger") != -1){
			fullName = prefix + "Thief";
		}
		else if(name.indexOf("tome") != -1){
			fullName = prefix + "Mage";
		}
		else{
			fullName = prefix + "Fighter";
		}
	}
	else if(name.indexOf("manakete") != -1){
		fullName = prefix + "Manakete";
	}
	else if(name.indexOf("flying") != -1){
		if(name.indexOf("bow") != -1){
			fullName = "Bow Flier";
		}
		else{
			fullName = prefix + "Flier";
		}
	}
	else if(name.indexOf("dragon") != -1){
		fullName = prefix + "Dragon";
	}
	else if(name.indexOf("fafnir") != -1){
		fullName = prefix + "Fafnir";
	}
	else if(name.indexOf("armored") != -1){
		fullName = prefix + "Knight";
	}
	else if(name.indexOf("cavalry") != -1){
		if(name.indexOf("staff") != -1){
			fullName = "Troubadour";
		}
		else if(name.indexOf("bow") != -1){
			fullName = "Bow Cavalier";
		}
		else{
			fullName = prefix + "Cavalier";
		}
	}
	
	if(name.indexOf("generic") != -1){
		return fullName;
	}
	else{
		return name;
	}
}

function refreshStatsUI(prefix, hero){
	$("#"+prefix+"_hp").val(hero.hp);
	$("#"+prefix+"_atk").val(hero.atk);
	$("#"+prefix+"_spd").val(hero.spd);
	$("#"+prefix+"_def").val(hero.def);
	$("#"+prefix+"_res").val(hero.res);
}

function refreshBuffsUI(prefix){
	var damage = 0;
	$("#"+prefix+"_atk_buff").val(mass.buffs.atk);
	$("#"+prefix+"_spd_buff").val(mass.buffs.spd);
	$("#"+prefix+"_def_buff").val(mass.buffs.def);
	$("#"+prefix+"_res_buff").val(mass.buffs.res);
	$("#"+prefix+"_atk_debuff").val(mass.debuffs.atk);
	$("#"+prefix+"_spd_debuff").val(mass.debuffs.spd);
	$("#"+prefix+"_def_debuff").val(mass.debuffs.def);
	$("#"+prefix+"_res_debuff").val(mass.debuffs.res);
	$("#"+prefix+"_atk_spur").val(mass.spur.atk);
	$("#"+prefix+"_spd_spur").val(mass.spur.spd);
	$("#"+prefix+"_def_spur").val(mass.spur.def);
	$("#"+prefix+"_res_spur").val(mass.spur.res);
	$("#"+prefix+"_precharge").val(mass.precharge);
	if(enemies.cl.list.length > 0){
		$("#"+prefix+"_damage").val(enemies.cl.list[options.customEnemySelected].damage);
	}
	$("#"+prefix+"_merge").val(mass.merge);
}

function fetchAllySupport(hero){
	var values = {"atk":0,"spd":0,"def":0,"res":0};
	var aMod = 0;
	if(hero.buddy.adjacent > 0){
		aMod = 2;
	}
	else if(hero.buddy.two > 0){
		aMod = 1;
	}
	if(hero.buddy.rank == "S"){
		values = {"atk":aMod,"spd":aMod,"def":aMod,"res":aMod};
	}
	else if(hero.buddy.rank == "A"){
		values = {"atk":0,"spd":aMod,"def":aMod,"res":aMod};
	}
	else if(hero.buddy.rank == "B"){
		values = {"atk":0,"spd":0,"def":aMod,"res":aMod};
	}
	else if(hero.buddy.rank == "C"){
		values = {"atk":0,"spd":0,"def":0,"res":aMod};
	}
	return values;
}

function getEffStats(attacker, enemy, turn){
	/*[0] = this.atk, [1] = this.spd, [2] = this.def, [3] = this.res,
	  [4] = enemy.atk, [5] = enemy.spd, [6] = enemy.def, [7] = enemy.res,
	  [8] = bladecheck, [9] = cleancheck, [10] = result text,
	  [11] = enemy AOE Def, [12] = enemy AOE Res, [13] = Attacker AOE Atk
	  [14] = attacker stat null indicator, [15] = enemy stat null indicator,
	  [16] = visible this atk, [17] = visible this spd, [18] = visible this def, [19] = visible this res,
	  [20] = visible enemy atk, [21] = visible enemy spd, [22] = visible enemy def, [23] = visible enemy res*/
	
	var bladeCheck = true;
	var cleanCheck = true;
	var fightText = "";
	var attackerNull = false;
	var enemyNull = false;
	//statNull goes in order of Atk,Spd,Def,Res
	var attackerStatNull = [false,false,false,false];
	var enemyStatNull = [false,false,false,false];
	var cAllyValMod = fetchAllySupport(attacker);
	var eAllyValMod = fetchAllySupport(enemy);
	if(attacker.hasExactly("Queensblade") || enemy.hasExactly("Queensblade") || attacker.hasExactly("Breezy Spear") || enemy.hasExactly("Breezy Spear")){
		cAllyValMod = {"atk":0,"spd":0,"def":0,"res":0};
		eAllyValMod = {"atk":0,"spd":0,"def":0,"res":0};
		fightText += "All ally supports have been disabled.<br>";
	}
	
	var attackerEffAtk = attacker.atk + Math.max(attacker.buffs.atk,attacker.combatBuffs.atk) + Math.min(attacker.debuffs.atk,attacker.combatDebuffs.atk) + attacker.spur.atk + attacker.combatSpur.atk + cAllyValMod.atk;
	var attackerEffSpd = attacker.spd + Math.max(attacker.buffs.spd,attacker.combatBuffs.spd) + Math.min(attacker.debuffs.spd,attacker.combatDebuffs.spd) + attacker.spur.spd + attacker.combatSpur.spd + cAllyValMod.spd;
	var attackerEffDef = attacker.def + Math.max(attacker.buffs.def,attacker.combatBuffs.def) + Math.min(attacker.debuffs.def,attacker.combatDebuffs.def) + attacker.spur.def + attacker.combatSpur.def + cAllyValMod.def;
	var attackerEffRes = attacker.res + Math.max(attacker.buffs.res,attacker.combatBuffs.res) + Math.min(attacker.debuffs.res,attacker.combatDebuffs.res) + attacker.spur.res + attacker.combatSpur.res + cAllyValMod.res;
	var enemyEffAtk = enemy.atk + Math.max(enemy.buffs.atk,enemy.combatBuffs.atk) + Math.min(enemy.debuffs.atk,enemy.combatDebuffs.atk) + enemy.spur.atk + enemy.combatSpur.atk + eAllyValMod.atk;
	var enemyEffSpd = enemy.spd + Math.max(enemy.buffs.spd,enemy.combatBuffs.spd) + Math.min(enemy.debuffs.spd,enemy.combatDebuffs.spd) + enemy.spur.spd + enemy.combatSpur.spd + eAllyValMod.spd;
	var enemyEffDef = enemy.def + Math.max(enemy.buffs.def,enemy.combatBuffs.def) + Math.min(enemy.debuffs.def,enemy.combatDebuffs.def) + enemy.spur.def + enemy.combatSpur.def + eAllyValMod.def;
	var enemyEffRes = enemy.res + Math.max(enemy.buffs.res,enemy.combatBuffs.res) + Math.min(enemy.debuffs.res,enemy.combatDebuffs.res) + enemy.spur.res + enemy.combatSpur.res + eAllyValMod.res;
	
	var attackerVisAtk = attacker.atk + Math.max(attacker.buffs.atk,attacker.combatBuffs.atk) + Math.min(attacker.debuffs.atk,attacker.combatDebuffs.atk);
	var attackerVisSpd = attacker.spd + Math.max(attacker.buffs.spd,attacker.combatBuffs.spd) + Math.min(attacker.debuffs.spd,attacker.combatDebuffs.spd);
	var attackerVisDef = attacker.def + Math.max(attacker.buffs.def,attacker.combatBuffs.def) + Math.min(attacker.debuffs.def,attacker.combatDebuffs.def);
	var attackerVisRes = attacker.res + Math.max(attacker.buffs.res,attacker.combatBuffs.res) + Math.min(attacker.debuffs.res,attacker.combatDebuffs.res);
	var enemyVisAtk = enemy.atk + Math.max(enemy.buffs.atk,enemy.combatBuffs.atk) + Math.min(enemy.debuffs.atk,enemy.combatDebuffs.atk);
	var enemyVisSpd = enemy.spd + Math.max(enemy.buffs.spd,enemy.combatBuffs.spd) + Math.min(enemy.debuffs.spd,enemy.combatDebuffs.spd);
	var enemyVisDef = enemy.def + Math.max(enemy.buffs.def,enemy.combatBuffs.def) + Math.min(enemy.debuffs.def,enemy.combatDebuffs.def);
	var enemyVisRes = enemy.res + Math.max(enemy.buffs.res,enemy.combatBuffs.res) + Math.min(enemy.debuffs.res,enemy.combatDebuffs.res);
	
	var enemyAOEDef = enemyVisDef;
	var enemyAOERes = enemyVisRes;
	var attackerAOEAtk = attackerVisAtk;

	if(attacker.penalty.panic){
		attackerEffAtk = attacker.atk - Math.max(attacker.buffs.atk,attacker.combatBuffs.atk) + Math.min(attacker.debuffs.atk,attacker.combatDebuffs.atk) + attacker.spur.atk + attacker.combatSpur.atk + cAllyValMod.atk;
		attackerEffSpd = attacker.spd - Math.max(attacker.buffs.spd,attacker.combatBuffs.spd) + Math.min(attacker.debuffs.spd,attacker.combatDebuffs.spd) + attacker.spur.spd + attacker.combatSpur.spd + cAllyValMod.spd;
		attackerEffDef = attacker.def - Math.max(attacker.buffs.def,attacker.combatBuffs.def) + Math.min(attacker.debuffs.def,attacker.combatDebuffs.def) + attacker.spur.def + attacker.combatSpur.def + cAllyValMod.def;
		attackerEffRes = attacker.res - Math.max(attacker.buffs.res,attacker.combatBuffs.res) + Math.min(attacker.debuffs.res,attacker.combatDebuffs.res) + attacker.spur.res + attacker.combatSpur.res + cAllyValMod.res;
		attackerVisAtk = attacker.atk - Math.max(attacker.buffs.atk,attacker.combatBuffs.atk) + Math.min(attacker.debuffs.atk,attacker.combatDebuffs.atk);
		attackerVisSpd = attacker.spd - Math.max(attacker.buffs.spd,attacker.combatBuffs.spd) + Math.min(attacker.debuffs.spd,attacker.combatDebuffs.spd);
		attackerVisDef = attacker.def - Math.max(attacker.buffs.def,attacker.combatBuffs.def) + Math.min(attacker.debuffs.def,attacker.combatDebuffs.def);
		attackerVisRes = attacker.res - Math.max(attacker.buffs.res,attacker.combatBuffs.res) + Math.min(attacker.debuffs.res,attacker.combatDebuffs.res);
		attackerAOEAtk = attackerVisAtk;
		bladeCheck = false;
	}

	if(enemy.penalty.panic){
		enemyEffAtk = enemy.atk - Math.max(enemy.buffs.atk,enemy.combatBuffs.atk) + Math.min(enemy.debuffs.atk,enemy.combatDebuffs.atk) + enemy.spur.atk + enemy.combatSpur.atk + eAllyValMod.atk;
		enemyEffSpd = enemy.spd - Math.max(enemy.buffs.spd,enemy.combatBuffs.spd) + Math.min(enemy.debuffs.spd,enemy.combatDebuffs.spd) + enemy.spur.spd + enemy.combatSpur.spd + eAllyValMod.spd;
		enemyEffDef = enemy.def - Math.max(enemy.buffs.def,enemy.combatBuffs.def) + Math.min(enemy.debuffs.def,enemy.combatDebuffs.def) + enemy.spur.def + enemy.combatSpur.def + eAllyValMod.def;
		enemyEffRes = enemy.res - Math.max(enemy.buffs.res,enemy.combatBuffs.res) + Math.min(enemy.debuffs.res,enemy.combatDebuffs.res) + enemy.spur.res + enemy.combatSpur.res + eAllyValMod.res;
		enemyVisAtk = enemy.atk - Math.max(enemy.buffs.atk,enemy.combatBuffs.atk) + Math.min(enemy.debuffs.atk,enemy.combatDebuffs.atk);
		enemyVisSpd = enemy.spd - Math.max(enemy.buffs.spd,enemy.combatBuffs.spd) + Math.min(enemy.debuffs.spd,enemy.combatDebuffs.spd);
		enemyVisDef = enemy.def - Math.max(enemy.buffs.def,enemy.combatBuffs.def) + Math.min(enemy.debuffs.def,enemy.combatDebuffs.def);
		enemyVisRes = enemy.res - Math.max(enemy.buffs.res,enemy.combatBuffs.res) + Math.min(enemy.debuffs.res,enemy.combatDebuffs.res);
		enemyAOEDef = enemyVisDef;
		enemyAOERes = enemyVisRes;
		cleanCheck = false;
	}
	
	//Dull Ranged mechanic
	if((attacker.combatStartHp / attacker.maxHp >= 1.5 + attacker.has("Dull Ranged") * -0.5 || (attacker.hasExactly("Distant Def 4") && !attacker.initiator) || (attacker.hasExactly("Mulagir") && attacker.rValue > 0) || (attacker.hasExactly("Volunteer Bow") && attacker.combatStartHp / attacker.maxHp >= 0.25)) && enemy.range == "ranged"){
		//if panicked, leave negative value in.
		if(!enemy.penalty.panic){
			enemyEffAtk -= Math.max(enemy.buffs.atk,enemy.combatBuffs.atk);
			enemyEffSpd -= Math.max(enemy.buffs.spd,enemy.combatBuffs.spd);
			enemyEffDef -= Math.max(enemy.buffs.def,enemy.combatBuffs.def);
			enemyEffRes -= Math.max(enemy.buffs.res,enemy.combatBuffs.res);
		}
		fightText += enemy.name + "'s bonuses have been nullified.<br>";
		cleanCheck = false;
		enemyNull = true;
	}
	//Dull Close mechanic
	else if((attacker.combatStartHp / attacker.maxHp >= 1.5 + attacker.has("Dull Close") * -0.5 || (attacker.hasExactly("Close Def 4") && !attacker.initiator)) && enemy.range == "melee"){
		//if panicked, leave negative value in.
		if(!enemy.penalty.panic){
			enemyEffAtk -= Math.max(enemy.buffs.atk,enemy.combatBuffs.atk);
			enemyEffSpd -= Math.max(enemy.buffs.spd,enemy.combatBuffs.spd);
			enemyEffDef -= Math.max(enemy.buffs.def,enemy.combatBuffs.def);
			enemyEffRes -= Math.max(enemy.buffs.res,enemy.combatBuffs.res);
		}
		fightText += enemy.name + "'s bonuses have been nullified due to Dull Close.<br>";
		cleanCheck = false;
		enemyNull = true;
	}
	//Beorc's Blessing mechanic
	else if(attacker.hasExactly("Beorc's Blessing") && (enemy.moveType == "cavalry" || enemy.moveType == "flying")){
		//if panicked, leave negative value in.
		if(!enemy.penalty.panic){
			enemyEffAtk -= Math.max(enemy.buffs.atk,enemy.combatBuffs.atk);
			enemyEffSpd -= Math.max(enemy.buffs.spd,enemy.combatBuffs.spd);
			enemyEffDef -= Math.max(enemy.buffs.def,enemy.combatBuffs.def);
			enemyEffRes -= Math.max(enemy.buffs.res,enemy.combatBuffs.res);
		}
		fightText += enemy.name + "'s bonuses have been nullified due to Beorc's Blessing.<br>";
		cleanCheck = false;
		enemyNull = true;
	}
	//Mulagir mechanic
	else if(attacker.hasExactly("Mulagir") && enemy.weaponType.indexOf("tome") != -1){
		//if panicked, leave negative value in.
		if(!enemy.penalty.panic){
			enemyEffAtk -= Math.max(enemy.buffs.atk,enemy.combatBuffs.atk);
			enemyEffSpd -= Math.max(enemy.buffs.spd,enemy.combatBuffs.spd);
			enemyEffDef -= Math.max(enemy.buffs.def,enemy.combatBuffs.def);
			enemyEffRes -= Math.max(enemy.buffs.res,enemy.combatBuffs.res);
		}
		fightText += enemy.name + "'s bonuses have been nullified due to Mulagir.<br>";
		cleanCheck = false;
		enemyNull = true;
	}
	//Divine/Virtuous Naga & Fensalir mechanic
	else if(attacker.bonus.dull || attacker.hasExactly("Divine Naga") || attacker.has("Light and Dark") || ((attacker.has("Fensalir") || attacker.hasExactly("Dazzling Breath")) && attacker.rValue > 0) || (attacker.has("Observant Staff") && attacker.toggle.weapon == 1) || (attacker.hasExactly("War-God Mjolnir") && attacker.combatStartHp / attacker.maxHp >= 0.25 && (attacker.buddy.adjacent == 0 || attacker.rValue > 0)) || (attacker.hasExactly("Wily Fighter 4") && (!attacker.initiator || attacker.combatStartHp / attacker.maxHp >= 0.25)) || (attacker.has("Wily Fighter") && !attacker.initiator && attacker.hp / attacker.maxHp >= 1 - attacker.has("Wily Fighter") * 0.25) || (attacker.hasExactly("Wild Tiger Fang") && enemy.combatStartHp / enemy.maxHp >= 0.75) || (attacker.hasExactly("Ardent Durandal") && attacker.rValue == 5 && (attacker.initiator || attacker.toggle.weapon == 1)) || ((attacker.hasExactly("Awoken Breath") || attacker.hasExactly("Desert Spear") || attacker.hasExactly("Open Retainer+")) && attacker.buddy.adjacent + attacker.buddy.two + attacker.buddy.three > 0) || (attacker.hasExactly("Scepter of Love") && attacker.rValue == 5 && (attacker.initiator || attacker.toggle.weapon > 1)) || ((attacker.hasExactly("Captain's Sword") || (attacker.hasExactly("Kia Staff") && attacker.rValue == 5)) && attacker.combatStartHp / attacker.maxHp >= 0.25) || (attacker.hasCaptain("Storm of Blows") && attacker.toggle.sd == 0) || attacker.hasExactly("Protective") || attacker.hasExactly("Lull Echo")){
		//if panicked, leave negative value in.
		if(!enemy.penalty.panic){
			enemyEffAtk -= Math.max(enemy.buffs.atk,enemy.combatBuffs.atk);
			enemyEffSpd -= Math.max(enemy.buffs.spd,enemy.combatBuffs.spd);
			enemyEffDef -= Math.max(enemy.buffs.def,enemy.combatBuffs.def);
			enemyEffRes -= Math.max(enemy.buffs.res,enemy.combatBuffs.res);
		}
		fightText += enemy.name + "'s bonuses have been nullified.<br>";
		cleanCheck = false;
		enemyNull = true;
	}
	//Upgraded Keen Wolf Tomes and Zanbato/Ridersbane mechanic
	else if((attacker.hasExactly("Keen Raudrwolf+") || attacker.hasExactly("Keen Blarwolf+") || attacker.hasExactly("Keen Gronnwolf+") || attacker.hasExactly("Zanbato+") || attacker.hasExactly("Ridersbane+") || attacker.hasExactly("Poleaxe+")) && enemy.moveType == "cavalry" && attacker.rValue == 5){
		//if panicked, leave negative value in.
		if(!enemy.penalty.panic){
			enemyEffAtk -= Math.max(enemy.buffs.atk,enemy.combatBuffs.atk);
			enemyEffSpd -= Math.max(enemy.buffs.spd,enemy.combatBuffs.spd);
			enemyEffDef -= Math.max(enemy.buffs.def,enemy.combatBuffs.def);
			enemyEffRes -= Math.max(enemy.buffs.res,enemy.combatBuffs.res);
		}
		fightText += enemy.name + "'s bonuses have been nullified.<br>";
		cleanCheck = false;
		enemyNull = true;
	}
	//Upgraded Armorslaying weapon mechanic
	else if((attacker.hasExactly("Armorsmasher+") || attacker.hasExactly("Slaying Hammer+") || attacker.hasExactly("Slaying Spear+")) && enemy.moveType == "armored" && attacker.rValue == 5){
		//if panicked, leave negative value in.
		if(!enemy.penalty.panic){
			enemyEffAtk -= Math.max(enemy.buffs.atk,enemy.combatBuffs.atk);
			enemyEffSpd -= Math.max(enemy.buffs.spd,enemy.combatBuffs.spd);
			enemyEffDef -= Math.max(enemy.buffs.def,enemy.combatBuffs.def);
			enemyEffRes -= Math.max(enemy.buffs.res,enemy.combatBuffs.res);
		}
		fightText += enemy.name + "'s bonuses have been nullified.<br>";
		cleanCheck = false;
		enemyNull = true;
	}
	//Love Abounds Weapons + Hermit's Tome mechanic
	else if((attacker.has("Green Gift") || attacker.has("Gratia") || attacker.has("Blue Gift") || attacker.has("Casa Blanca") || attacker.hasExactly("Hermit's Tome")) && enemy.range == "ranged"){
		//if panicked, leave negative value in.
		if(!enemy.penalty.panic){
			enemyEffAtk -= Math.max(enemy.buffs.atk,enemy.combatBuffs.atk);
			enemyEffSpd -= Math.max(enemy.buffs.spd,enemy.combatBuffs.spd);
			enemyEffDef -= Math.max(enemy.buffs.def,enemy.combatBuffs.def);
			enemyEffRes -= Math.max(enemy.buffs.res,enemy.combatBuffs.res);
		}
		fightText += enemy.name + "'s bonuses have been nullified.<br>";
		cleanCheck = false;
		enemyNull = true;
	}
	//Larcei's Edge
	else if(attacker.hasExactly("Larcei's Edge") && (attacker.spd + attacker.buffs.spd + attacker.debuffs.spd + attacker.getPhantom("Spd") > enemy.spd + enemy.buffs.spd + enemy.debuffs.spd + enemy.getPhantom("Spd") || enemy.combatStartHp / enemy.maxHp == 1 || (attacker.rValue > 0 && enemy.combatStartHp / enemy.maxHp >= 0.75))){
		//if panicked, leave negative value in.
		if(!enemy.penalty.panic){
			enemyEffAtk -= Math.max(enemy.buffs.atk,enemy.combatBuffs.atk);
			enemyEffSpd -= Math.max(enemy.buffs.spd,enemy.combatBuffs.spd);
			enemyEffDef -= Math.max(enemy.buffs.def,enemy.combatBuffs.def);
			enemyEffRes -= Math.max(enemy.buffs.res,enemy.combatBuffs.res);
		}
		fightText += enemy.name + "'s bonuses have been nullified.<br>";
		cleanCheck = false;
		enemyNull = true;
	}
	else if((attacker.hasExactly("Dark Greatsword") && attacker.rValue == 5 && attacker.toggle.weapon == 1) || (attacker.hasExactly("Lance of Grado") && attacker.buddy.adjacent + attacker.buddy.two + attacker.buddy.three > 0) || (attacker.hasExactly("Spear of Assal") && attacker.rValue > 0 && attacker.buddy.adjacent + attacker.buddy.two + attacker.buddy.three > 0)){
		//if panicked, leave negative value in.
		if(!enemy.penalty.panic){
			enemyEffAtk -= Math.max(enemy.buffs.atk,enemy.combatBuffs.atk);
			enemyEffSpd -= Math.max(enemy.buffs.spd,enemy.combatBuffs.spd);
			enemyEffDef -= Math.max(enemy.buffs.def,enemy.combatBuffs.def);
			enemyEffRes -= Math.max(enemy.buffs.res,enemy.combatBuffs.res);
		}
		fightText += enemy.name + "'s bonuses have been nullified.<br>";
		cleanCheck = false;
		enemyNull = true;
	}
	//Grafcalibur
	else if((attacker.hasExactly("Grafcalibur") || (attacker.hasExactly("Stout Tomahawk") && attacker.rValue == 5)) && (attacker.initiator || attacker.buddy.adjacent > 0 || attacker.buddy.two > 0)){
		//if panicked, leave negative value in.
		if(!enemy.penalty.panic){
			enemyEffAtk -= Math.max(enemy.buffs.atk,enemy.combatBuffs.atk);
			enemyEffSpd -= Math.max(enemy.buffs.spd,enemy.combatBuffs.spd);
			enemyEffDef -= Math.max(enemy.buffs.def,enemy.combatBuffs.def);
			enemyEffRes -= Math.max(enemy.buffs.res,enemy.combatBuffs.res);
		}
		fightText += enemy.name + "'s bonuses have been nullified.<br>";
		cleanCheck = false;
		enemyNull = true;
	}
	else if(attacker.hasExactly("Bereft Lance") && (attacker.buddy.adjacent + attacker.buddy.two < 2 || attacker.rValue > 0)){
		//if panicked, leave negative value in.
		if(!enemy.penalty.panic){
			enemyEffAtk -= Math.max(enemy.buffs.atk,enemy.combatBuffs.atk);
			enemyEffSpd -= Math.max(enemy.buffs.spd,enemy.combatBuffs.spd);
			enemyEffDef -= Math.max(enemy.buffs.def,enemy.combatBuffs.def);
			enemyEffRes -= Math.max(enemy.buffs.res,enemy.combatBuffs.res);
		}
		fightText += enemy.name + "'s bonuses have been nullified.<br>";
		cleanCheck = false;
		enemyNull = true;
	}
	else if((attacker.hasExactly("Dragonskin 2") && (enemy.combatStartHp / enemy.maxHp >= 0.75 || !attacker.initiator)) || (attacker.hasExactly("Fell Wyrmscale") && attacker.combatStartHp / attacker.maxHp >= 0.25)){
		//if panicked, leave negative value in.
		if(!enemy.penalty.panic){
			enemyEffAtk -= Math.max(enemy.buffs.atk,enemy.combatBuffs.atk);
			enemyEffSpd -= Math.max(enemy.buffs.spd,enemy.combatBuffs.spd);
			enemyEffDef -= Math.max(enemy.buffs.def,enemy.combatBuffs.def);
			enemyEffRes -= Math.max(enemy.buffs.res,enemy.combatBuffs.res);
		}
		fightText += enemy.name + "'s bonuses have been nullified.<br>";
		cleanCheck = false;
		enemyNull = true;
	}
	else if((attacker.hasExactly("Deadly Miasma") && attacker.initiator) || (attacker.hasExactly("Endless Tempest") && attacker.buddy.spaces > 0) || enemy.vein == 4){
		//if panicked, leave negative value in.
		if(!enemy.penalty.panic){
			enemyEffAtk -= Math.max(enemy.buffs.atk,enemy.combatBuffs.atk);
			enemyEffSpd -= Math.max(enemy.buffs.spd,enemy.combatBuffs.spd);
			enemyEffDef -= Math.max(enemy.buffs.def,enemy.combatBuffs.def);
			enemyEffRes -= Math.max(enemy.buffs.res,enemy.combatBuffs.res);
		}
		fightText += enemy.name + "'s bonuses have been nullified.<br>";
		cleanCheck = false;
		enemyNull = true;
	}
	else{
		//Lull mechanic (B Skills)
		if(attacker.has("Lull Atk Spd")){
			//if panicked, leave negative value in.
			if(!enemy.penalty.panic){
				if(enemyStatNull[0] == false){
					enemyEffAtk -= Math.max(enemy.buffs.atk,enemy.combatBuffs.atk);
					enemyStatNull[0] = true;
				}
				if(enemyStatNull[1] == false){
					enemyEffSpd -= Math.max(enemy.buffs.spd,enemy.combatBuffs.spd);
					enemyStatNull[1] = true;
				}
			}
			fightText += enemy.name + "'s bonuses on atk and spd have been nullified due to " + data.skills[attacker.bIndex].name + ".<br>";
		}
		if(attacker.has("Lull Atk Def")){
			//if panicked, leave negative value in.
			if(!enemy.penalty.panic){
				if(enemyStatNull[0] == false){
					enemyEffAtk -= Math.max(enemy.buffs.atk,enemy.combatBuffs.atk);
					enemyStatNull[0] = true;
				}
				if(enemyStatNull[2] == false){
					enemyEffDef -= Math.max(enemy.buffs.def,enemy.combatBuffs.def);
					enemyStatNull[2] = true;
				}
			}
			fightText += enemy.name + "'s bonuses on atk and def have been nullified due to " + data.skills[attacker.bIndex].name + ".<br>";
		}
		if(attacker.has("Lull Atk Res")){
			//if panicked, leave negative value in.
			if(!enemy.penalty.panic){
				if(enemyStatNull[0] == false){
					enemyEffAtk -= Math.max(enemy.buffs.atk,enemy.combatBuffs.atk);
					enemyStatNull[0] = true;
				}
				if(enemyStatNull[3] == false){
					enemyEffRes -= Math.max(enemy.buffs.res,enemy.combatBuffs.res);
					enemyStatNull[3] = true;
				}
			}
			fightText += enemy.name + "'s bonuses on atk and res have been nullified due to " + data.skills[attacker.bIndex].name + ".<br>";
		}
		if(attacker.has("Lull Spd Def")){
			//if panicked, leave negative value in.
			if(!enemy.penalty.panic){
				if(enemyStatNull[1] == false){
					enemyEffSpd -= Math.max(enemy.buffs.spd,enemy.combatBuffs.spd);
					enemyStatNull[1] = true;
				}
				if(enemyStatNull[2] == false){
					enemyEffDef -= Math.max(enemy.buffs.def,enemy.combatBuffs.def);
					enemyStatNull[2] = true;
				}
			}
			fightText += enemy.name + "'s bonuses on spd and def have been nullified due to " + data.skills[attacker.bIndex].name + ".<br>";
		}
		if(attacker.has("Lull Spd Res")){
			//if panicked, leave negative value in.
			if(!enemy.penalty.panic){
				if(enemyStatNull[1] == false){
					enemyEffSpd -= Math.max(enemy.buffs.spd,enemy.combatBuffs.spd);
					enemyStatNull[1] = true;
				}
				if(enemyStatNull[3] == false){
					enemyEffRes -= Math.max(enemy.buffs.res,enemy.combatBuffs.res);
					enemyStatNull[3] = true;
				}
			}
			fightText += enemy.name + "'s bonuses on spd and res have been nullified due to " + data.skills[attacker.bIndex].name + ".<br>";
		}
		//Refine 5 and base are separated (Weapons)
		if(((attacker.hasExactly("Sun Dragonstone") || (attacker.hasExactly("Forseti") && enemy.combatStartHp / enemy.maxHp >= 0.75)) && attacker.rValue == 5) || (attacker.hasExactly("Spear of Assal") && attacker.rValue < 0 && (attacker.buddy.adjacent > 0 || attacker.buddy.two > 0)) || (attacker.hasExactly("Diva-Pair Parasol") && attackerVisDef + 5 >= enemyVisDef)){
			//if panicked, leave negative value in.
			if(!enemy.penalty.panic){
				if(enemyStatNull[0] == false){
					enemyEffAtk -= Math.max(enemy.buffs.atk,enemy.combatBuffs.atk);
					enemyStatNull[0] = true;
				}
				if(enemyStatNull[1] == false){
					enemyEffSpd -= Math.max(enemy.buffs.spd,enemy.combatBuffs.spd);
					enemyStatNull[1] = true;
				}
			}
			fightText += enemy.name + "'s bonuses on atk and spd have been nullified.<br>";
		}
		if(((attacker.hasExactly("Guardian's Axe") || attacker.hasExactly("Dark Royal Spear") || (attacker.has("Effie's Lance") && attacker.toggle.weapon == 1) || ((attacker.hasExactly("Loyalty Spear") || attacker.hasExactly("Hallowed Tyrfing")) && attacker.combatStartHp / attacker.maxHp >= 0.25) || (attacker.hasExactly("Wolfskin Fang") && (!attacker.initiator || enemy.combatStartHp / enemy.maxHp >= 0.75)) || (attacker.hasExactly("Moon Gradivus") && attacker.toggle.weapon == 1) || (attacker.hasExactly("Ragnell-Alondite") && (!attacker.initiator || enemy.combatStartHp / enemy.maxHp >= 0.75))) && attacker.rValue == 5) || ((attacker.has("Flowing Lance") || attacker.has("Deck Swabber") || attacker.has("Unbound Blade") || attacker.has("Unbound Axe") || attacker.has("Unbound Lance")) && attacker.buddy.adjacent == 0) || (attacker.hasExactly("Earthly Gae Bolg") && (enemy.moveType != "flying" || (attacker.rValue > 0 && attacker.combatStartHp / attacker.maxHp >= 0.5))) || (attacker.hasExactly("Gurgurant") && attacker.rValue > 0) || (attacker.hasExactly("Nectar Horn") && (!attacker.initiator || enemy.combatStartHp / enemy.maxHp >= 0.75)) || (attacker.hasExactly("Divine Toxin") && (attacker.transform == true || !attacker.initiator)) || (attacker.hasExactly("Atk Res Fortune") && (!attacker.initiator || attacker.transform == true)) || (attacker.hasExactly("Obsidian Lance") && attacker.rValue == 5) || (attacker.hasExactly("Delivering Antler") && (attacker.initiator || attacker.buddy.adjacent > 0 || attacker.buddy.two > 0))){
			//if panicked, leave negative value in.
			if(!enemy.penalty.panic){
				if(enemyStatNull[0] == false){
					enemyEffAtk -= Math.max(enemy.buffs.atk,enemy.combatBuffs.atk);
					enemyStatNull[0] = true;
				}
				if(enemyStatNull[2] == false){
					enemyEffDef -= Math.max(enemy.buffs.def,enemy.combatBuffs.def);
					enemyStatNull[2] = true;
				}
			}
			fightText += enemy.name + "'s bonuses on atk and def have been nullified.<br>";
		}
		if((attacker.has("Blackfire Breath") && attacker.toggle.weapon == 1) || ((attacker.hasExactly("Brilliant Starlight") || attacker.hasExactly("Arcane Caliburnus") || attacker.hasExactly("Silver of Dawn")) && attacker.combatStartHp / attacker.maxHp >= 0.25) || (attacker.hasExactly("Obscurite") && (attacker.initiator || ((attacker.buddy.adjacent > 0 || attacker.buddy.two > 0) && attacker.toggle.weapon > 1))) || ((attacker.hasExactly("Petrify") || attacker.hasExactly("Banshee TH")) && attacker.rValue == 5 && attacker.combatStartHp / attacker.maxHp >= 0.25) || (attacker.hasExactly("Beyond Reason") && (!attacker.initiator || enemy.combatStartHp / enemy.maxHp >= 0.75))){
			//if panicked, leave negative value in.
			if(!enemy.penalty.panic){
				if(enemyStatNull[0] == false){
					enemyEffAtk -= Math.max(enemy.buffs.atk,enemy.combatBuffs.atk);
					enemyStatNull[0] = true;
				}
				if(enemyStatNull[3] == false){
					enemyEffRes -= Math.max(enemy.buffs.res,enemy.combatBuffs.res);
					enemyStatNull[3] = true;
				}
			}
			fightText += enemy.name + "'s bonuses on atk and res have been nullified.<br>";
		}
	if(((attacker.has("Helm Bow") || attacker.has("Unbound Bow")) && attacker.toggle.weapon == 1) || ((attacker.hasExactly("Blade of Jehanna") || attacker.hasExactly("Arcane Luin") || ((attacker.hasExactly("Guardian's Bow") || attacker.hasExactly("Mirage Longbow") || attacker.hasExactly("Holy Yewfelle") || attacker.hasExactly("Luin")) && attacker.rValue == 5) || attacker.hasExactly("Breaker Bow")) && attacker.combatStartHp / attacker.maxHp >= 0.25) || (attacker.hasExactly("Mareeta's Sword") && attacker.rValue > 0 && (attacker.initiator || attacker.toggle.weapon == 1)) || (attacker.hasExactly("Brilliant Rapier") && (!attacker.initiator || enemy.combatStartHp / enemy.maxHp >= 0.75)) || (attacker.hasExactly("Atk Spd Fortune") && (!attacker.initiator || attacker.transform == true)) || attacker.hasExactly("Arcane Sly Knife") || (attacker.hasExactly("Deer's Heart") && (attacker.initiator || attacker.buddy.adjacent > 0 || attacker.buddy.two > 0))){
			//if panicked, leave negative value in.
			if(!enemy.penalty.panic){
				if(enemyStatNull[1] == false){
					enemyEffSpd -= Math.max(enemy.buffs.spd,enemy.combatBuffs.spd);
					enemyStatNull[1] = true;
				}
				if(enemyStatNull[2] == false){
					enemyEffDef -= Math.max(enemy.buffs.def,enemy.combatBuffs.def);
					enemyStatNull[2] = true;
				}
			}
			fightText += enemy.name + "'s bonuses on spd and def have been nullified.<br>";
		}
		if((attacker.hasExactly("Phantasm Tome") && (enemy.combatStartHp / enemy.maxHp >= 0.5 || (attacker.rValue > 0 && attacker.initiator))) || (attacker.hasExactly("Death") && attacker.rValue > 0) || (((attacker.hasExactly("Ifingr") && attacker.rValue == 5) || (attacker.hasExactly("Exotic Fruit Juice") && attacker.rValue > 0)) && attacker.combatStartHp / attacker.maxHp >= 0.25) || (attacker.hasExactly("Agnea's Arrow") && (attacker.initiator || attacker.toggle.weapon == 1) && turn % 2 == 1) || ((attacker.hasExactly("Baked Treats") || (attacker.hasExactly("Winds of Change") && attacker.rValue == 5) || attacker.hasExactly("Caring Magic")) && (attacker.initiator || attacker.buddy.adjacent > 0 || attacker.buddy.two > 0)) || (attacker.hasExactly("Arcane Thunder") && attacker.combatStartHp / attacker.maxHp >= 0.25) || (attacker.hasExactly("Hades O") && attacker.rValue == 5 && (attacker.initiator || enemy.range == "ranged")) || (attacker.hasExactly("Fluttering Fan") && attacker.buddy.rorc > 0) || (attacker.hasExactly("Tome of Storms") && attacker.rValue > 0 && (attacker.initiator || enemy.combatStartHp / enemy.maxHp >= 0.75))){
			//if panicked, leave negative value in.
			if(!enemy.penalty.panic){
				if(enemyStatNull[1] == false){
					enemyEffSpd -= Math.max(enemy.buffs.spd,enemy.combatBuffs.spd);
					enemyStatNull[1] = true;
				}
				if(enemyStatNull[3] == false){
					enemyEffRes -= Math.max(enemy.buffs.res,enemy.combatBuffs.res);
					enemyStatNull[3] = true;
				}
			}
			fightText += enemy.name + "'s bonuses on spd and res have been nullified.<br>";
		}
		if((attacker.hasExactly("Indignant Bow") && (enemy.initiator || enemy.combatStartHp / enemy.maxHp == 1)) || (attacker.hasExactly("Nurturing Breath") && attacker.rValue == 5 && attacker.prfVal > 0)){
			//if panicked, leave negative value in.
			var lullText = "atk";
			if(!enemy.penalty.panic){
				if(enemyStatNull[0] == false){
					enemyEffAtk -= Math.max(enemy.buffs.atk,enemy.combatBuffs.atk);
					enemyStatNull[0] = true;
				}
				if(attacker.hasExactly("Indignant Bow") && attacker.rValue > 0 && (enemy.initiator || enemy.combatStartHp / enemy.maxHp >= 0.75)){
					lullText = "atk & spd";
					if(enemyStatNull[1] == false){
						enemyEffSpd -= Math.max(enemy.buffs.spd,enemy.combatBuffs.spd);
						enemyStatNull[1] = true;
					}
				}
			}
			fightText += enemy.name + "'s bonuses on " + lullText + " have been nullified.<br>";
		}
		if(attacker.hasExactly("Craver's Tome") && attacker.rValue == 5 && attacker.combatStartHp / attacker.maxHp >= 0.25){
			//if panicked, leave negative value in.
			if(!enemy.penalty.panic){
				if(enemyStatNull[3] == false){
					enemyEffRes -= Math.max(enemy.buffs.res,enemy.combatBuffs.res);
					enemyStatNull[3] = true;
				}
			}
			fightText += enemy.name + "'s bonuses on res have been nullified.<br>";
		}
		if(((attacker.hasExactly("Binding Reginleif") && (attacker.initiator || attacker.buddy.adjacent + attacker.buddy.two > 0)) || (attacker.hasExactly("Heavenly Icicle") && (attacker.initiator || attacker.buddy.adjacent + attacker.buddy.two + attacker.buddy.three > 0))) && attacker.rValue == 5){
			//if panicked, leave negative value in.
			if(!enemy.penalty.panic){
				if(enemyStatNull[0] == false){
					enemyEffAtk -= Math.max(enemy.buffs.atk,enemy.combatBuffs.atk);
					enemyStatNull[0] = true;
				}
				if(enemyStatNull[1] == false){
					enemyEffSpd -= Math.max(enemy.buffs.spd,enemy.combatBuffs.spd);
					enemyStatNull[1] = true;
				}
				if(enemyStatNull[2] == false){
					enemyEffDef -= Math.max(enemy.buffs.def,enemy.combatBuffs.def);
					enemyStatNull[2] = true;
				}
			}
			fightText += enemy.name + "'s bonuses on atk/spd/def have been nullified.<br>";
		}
		if(attacker.support.lullAtk){
			//if panicked, leave negative value in.
			if(!enemy.penalty.panic){
				if(enemyStatNull[0] == false){
					enemyEffAtk -= Math.max(enemy.buffs.atk,enemy.combatBuffs.atk);
					enemyStatNull[0] = true;
				}
			}
			fightText += enemy.name + "'s bonuses on atk have been nullified due to Lull Atk Support.<br>";
		}
		if(attacker.support.lullSpd){
			//if panicked, leave negative value in.
			if(!enemy.penalty.panic){
				if(enemyStatNull[1] == false){
					enemyEffSpd -= Math.max(enemy.buffs.spd,enemy.combatBuffs.spd);
					enemyStatNull[1] = true;
				}
			}
			fightText += enemy.name + "'s bonuses on spd have been nullified due to Lull Spd Support.<br>";
		}
		if(attacker.support.lullDef){
			//if panicked, leave negative value in.
			if(!enemy.penalty.panic){
				if(enemyStatNull[2] == false){
					enemyEffDef -= Math.max(enemy.buffs.def,enemy.combatBuffs.def);
					enemyStatNull[2] = true;
				}
			}
			fightText += enemy.name + "'s bonuses on def have been nullified due to Lull Def Support.<br>";
		}
		if(attacker.support.lullRes){
			//if panicked, leave negative value in.
			if(!enemy.penalty.panic){
				if(enemyStatNull[3] == false){
					enemyEffRes -= Math.max(enemy.buffs.res,enemy.combatBuffs.res);
					enemyStatNull[3] = true;
				}
			}
			fightText += enemy.name + "'s bonuses on res have been nullified due to Lull Res Support.<br>";
		}
	}
	//Upheaval+ check happens last since it's an atk check
	if(attacker.hasExactly("Upheaval+") && (enemy.combatStartHp / enemy.maxHp < 1 || attackerVisAtk > enemyVisAtk)){
		//if panicked, leave negative value in.
		if(!enemy.penalty.panic){
			enemyEffAtk -= Math.max(enemy.buffs.atk,enemy.combatBuffs.atk);
			enemyEffSpd -= Math.max(enemy.buffs.spd,enemy.combatBuffs.spd);
			enemyEffDef -= Math.max(enemy.buffs.def,enemy.combatBuffs.def);
			enemyEffRes -= Math.max(enemy.buffs.res,enemy.combatBuffs.res);
		}
		fightText += enemy.name + "'s bonuses have been nullified.<br>";
		cleanCheck = false;
		enemyNull = true;
	}
	if(enemyNull){
		enemyStatNull = [true,true,true,true];
	}
	//check on attacker
	if((enemy.combatStartHp / enemy.maxHp >= 1.5 + enemy.has("Dull Ranged") * -0.5 || enemy.hasExactly("Distant Def 4") || (enemy.hasExactly("Mulagir") && enemy.rValue > 0) || (enemy.hasExactly("Volunteer Bow") && enemy.combatStartHp / enemy.maxHp >= 0.25)) && attacker.range == "ranged"){
		//if panicked, leave negative value in.
		if(!attacker.penalty.panic){
			attackerEffAtk -= Math.max(attacker.buffs.atk,attacker.combatBuffs.atk);
			attackerEffSpd -= Math.max(attacker.buffs.spd,attacker.combatBuffs.spd);
			attackerEffDef -= Math.max(attacker.buffs.def,attacker.combatBuffs.def);
			attackerEffRes -= Math.max(attacker.buffs.res,attacker.combatBuffs.res);
		}
		fightText += attacker.name + "'s bonuses have been nullified.<br>";
		bladeCheck = false;
		attackerNull = true;
	}
	else if((enemy.combatStartHp / enemy.maxHp >= 1.5 + enemy.has("Dull Close") * -0.5 || enemy.hasExactly("Close Def 4")) && attacker.range == "melee"){
		//if panicked, leave negative value in.
		if(!attacker.penalty.panic){
			attackerEffAtk -= Math.max(attacker.buffs.atk,attacker.combatBuffs.atk);
			attackerEffSpd -= Math.max(attacker.buffs.spd,attacker.combatBuffs.spd);
			attackerEffDef -= Math.max(attacker.buffs.def,attacker.combatBuffs.def);
			attackerEffRes -= Math.max(attacker.buffs.res,attacker.combatBuffs.res);
		}
		fightText += attacker.name + "'s bonuses have been nullified due to Dull Close.<br>";
		bladeCheck = false;
		attackerNull = true;
	}
	else if(enemy.has("Beorc") && (attacker.moveType == "cavalry" || attacker.moveType == "flying")){
		//if panicked, leave negative value in.
		if(!attacker.penalty.panic){
			attackerEffAtk -= Math.max(attacker.buffs.atk,attacker.combatBuffs.atk);
			attackerEffSpd -= Math.max(attacker.buffs.spd,attacker.combatBuffs.spd);
			attackerEffDef -= Math.max(attacker.buffs.def,attacker.combatBuffs.def);
			attackerEffRes -= Math.max(attacker.buffs.res,attacker.combatBuffs.res);
		}
		fightText += attacker.name + "'s bonuses have been nullified due to Beorc's Blessing.<br>";
		bladeCheck = false;
		attackerNull = true;
	}
	else if(enemy.hasExactly("Mulagir") && attacker.weaponType.indexOf("tome") != -1){
		//if panicked, leave negative value in.
		if(!attacker.penalty.panic){
			attackerEffAtk -= Math.max(attacker.buffs.atk,attacker.combatBuffs.atk);
			attackerEffSpd -= Math.max(attacker.buffs.spd,attacker.combatBuffs.spd);
			attackerEffDef -= Math.max(attacker.buffs.def,attacker.combatBuffs.def);
			attackerEffRes -= Math.max(attacker.buffs.res,attacker.combatBuffs.res);
		}
		fightText += attacker.name + "'s bonuses have been nullified due to Mulagir.<br>";
		bladeCheck = false;
		attackerNull = true;
	}
	else if(enemy.bonus.dull || enemy.hasExactly("Divine Naga") || enemy.has("Light and Dark") || ((enemy.has("Fensalir") || enemy.hasExactly("Dazzling Breath")) && enemy.rValue > 0) || (enemy.has("Observant Staff") && enemy.toggle.weapon == 1) || (enemy.hasExactly("War-God Mjolnir") && enemy.combatStartHp / enemy.maxHp >= 0.25 && (enemy.buddy.adjacent == 0 || enemy.rValue > 0)) || (enemy.hasExactly("Wily Fighter 4") && (attacker.initiator || enemy.combatStartHp / enemy.maxHp >= 0.25)) || (enemy.has("Wily Fighter") && attacker.initiator && enemy.hp / enemy.maxHp >= 1 - enemy.has("Wily Fighter") * 0.25) || (enemy.hasExactly("Wild Tiger Fang") && attacker.combatStartHp / attacker.maxHp >= 0.75) || (enemy.hasExactly("Ardent Durandal") && enemy.rValue == 5 && (enemy.initiator || enemy.toggle.weapon == 1)) || ((enemy.hasExactly("Awoken Breath") || enemy.hasExactly("Desert Spear") || enemy.hasExactly("Open Retainer+")) && enemy.buddy.adjacent + enemy.buddy.two + enemy.buddy.three > 0) || (enemy.hasExactly("Scepter of Love") && enemy.rValue == 5 && (!attacker.initiator || enemy.toggle.weapon > 1)) || ((enemy.hasExactly("Captain's Sword") || (enemy.hasExactly("Kia Staff") && enemy.rValue == 5)) && enemy.combatStartHp / enemy.maxHp >= 0.25) || (enemy.hasCaptain("Storm of Blows") && enemy.toggle.sd == 0) || enemy.hasExactly("Protective") || enemy.hasExactly("Lull Echo")){
		//if panicked, leave negative value in.
		if(!attacker.penalty.panic){
			attackerEffAtk -= Math.max(attacker.buffs.atk,attacker.combatBuffs.atk);
			attackerEffSpd -= Math.max(attacker.buffs.spd,attacker.combatBuffs.spd);
			attackerEffDef -= Math.max(attacker.buffs.def,attacker.combatBuffs.def);
			attackerEffRes -= Math.max(attacker.buffs.res,attacker.combatBuffs.res);
		}
		fightText += attacker.name + "'s bonuses have been nullified.<br>";
		bladeCheck = false;
		attackerNull = true;
	}
	else if((enemy.hasExactly("Keen Raudrwolf+") || enemy.hasExactly("Keen Blarwolf+") || enemy.hasExactly("Keen Gronnwolf+") || enemy.hasExactly("Zanbato+") || enemy.hasExactly("Ridersbane+") || enemy.hasExactly("Poleaxe+")) && attacker.moveType == "cavalry" && enemy.rValue == 5){
		//if panicked, leave negative value in.
		if(!attacker.penalty.panic){
			attackerEffAtk -= Math.max(attacker.buffs.atk,attacker.combatBuffs.atk);
			attackerEffSpd -= Math.max(attacker.buffs.spd,attacker.combatBuffs.spd);
			attackerEffDef -= Math.max(attacker.buffs.def,attacker.combatBuffs.def);
			attackerEffRes -= Math.max(attacker.buffs.res,attacker.combatBuffs.res);
		}
		fightText += attacker.name + "'s bonuses have been nullified.<br>";
		bladeCheck = false;
		attackerNull = true;
	}
	else if((enemy.hasExactly("Armorsmasher+") || enemy.hasExactly("Slaying Hammer+") || enemy.hasExactly("Slaying Spear+")) && attacker.moveType == "armored" && enemy.rValue == 5){
		//if panicked, leave negative value in.
		if(!attacker.penalty.panic){
			attackerEffAtk -= Math.max(attacker.buffs.atk,attacker.combatBuffs.atk);
			attackerEffSpd -= Math.max(attacker.buffs.spd,attacker.combatBuffs.spd);
			attackerEffDef -= Math.max(attacker.buffs.def,attacker.combatBuffs.def);
			attackerEffRes -= Math.max(attacker.buffs.res,attacker.combatBuffs.res);
		}
		fightText += attacker.name + "'s bonuses have been nullified.<br>";
		bladeCheck = false;
		attackerNull = true;
	}
	else if((enemy.has("Green Gift") || enemy.has("Gratia") || enemy.has("Blue Gift") || enemy.has("Casa Blanca") || enemy.hasExactly("Hermit's Tome")) && attacker.range == "ranged"){
		//if panicked, leave negative value in.
		if(!attacker.penalty.panic){
			attackerEffAtk -= Math.max(attacker.buffs.atk,attacker.combatBuffs.atk);
			attackerEffSpd -= Math.max(attacker.buffs.spd,attacker.combatBuffs.spd);
			attackerEffDef -= Math.max(attacker.buffs.def,attacker.combatBuffs.def);
			attackerEffRes -= Math.max(attacker.buffs.res,attacker.combatBuffs.res);
		}
		fightText += attacker.name + "'s bonuses have been nullified.<br>";
		bladeCheck = false;
		attackerNull = true;
	}
	else if(enemy.hasExactly("Larcei's Edge") && (enemy.spd + enemy.buffs.spd + enemy.debuffs.spd + enemy.getPhantom("Spd") > attacker.spd + attacker.buffs.spd + attacker.debuffs.spd + attacker.getPhantom("Spd") || attacker.combatStartHp / attacker.maxHp == 1 || (enemy.rValue > 0 && attacker.combatStartHp / attacker.maxHp >= 0.75))){
		//if panicked, leave negative value in.
		if(!attacker.penalty.panic){
			attackerEffAtk -= Math.max(attacker.buffs.atk,attacker.combatBuffs.atk);
			attackerEffSpd -= Math.max(attacker.buffs.spd,attacker.combatBuffs.spd);
			attackerEffDef -= Math.max(attacker.buffs.def,attacker.combatBuffs.def);
			attackerEffRes -= Math.max(attacker.buffs.res,attacker.combatBuffs.res);
		}
		fightText += attacker.name + "'s bonuses have been nullified.<br>";
		bladeCheck = false;
		attackerNull = true;
	}
	else if((enemy.hasExactly("Dark Greatsword") && enemy.rValue == 5 && enemy.toggle.weapon == 1) || (enemy.hasExactly("Lance of Grado") && enemy.buddy.adjacent + enemy.buddy.two + enemy.buddy.three > 0) || (enemy.hasExactly("Spear of Assal") && enemy.rValue > 0 && enemy.buddy.adjacent + enemy.buddy.two + enemy.buddy.three > 0)){
		//if panicked, leave negative value in.
		if(!attacker.penalty.panic){
			attackerEffAtk -= Math.max(attacker.buffs.atk,attacker.combatBuffs.atk);
			attackerEffSpd -= Math.max(attacker.buffs.spd,attacker.combatBuffs.spd);
			attackerEffDef -= Math.max(attacker.buffs.def,attacker.combatBuffs.def);
			attackerEffRes -= Math.max(attacker.buffs.res,attacker.combatBuffs.res);
		}
		fightText += attacker.name + "'s bonuses have been nullified.<br>";
		bladeCheck = false;
		attackerNull = true;
	}
	//Grafcalibur
	else if((enemy.hasExactly("Grafcalibur") || (enemy.hasExactly("Stout Tomahawk") && enemy.rValue == 5)) && (enemy.initiator || enemy.buddy.adjacent > 0 || enemy.buddy.two > 0)){
		//if panicked, leave negative value in.
		if(!attacker.penalty.panic){
			attackerEffAtk -= Math.max(attacker.buffs.atk,attacker.combatBuffs.atk);
			attackerEffSpd -= Math.max(attacker.buffs.spd,attacker.combatBuffs.spd);
			attackerEffDef -= Math.max(attacker.buffs.def,attacker.combatBuffs.def);
			attackerEffRes -= Math.max(attacker.buffs.res,attacker.combatBuffs.res);
		}
		fightText += attacker.name + "'s bonuses have been nullified.<br>";
		bladeCheck = false;
		attackerNull = true;
	}
	else if(enemy.hasExactly("Bereft Lance") && (enemy.buddy.adjacent + enemy.buddy.two < 2 || enemy.rValue > 0)){
		//if panicked, leave negative value in.
		if(!attacker.penalty.panic){
			attackerEffAtk -= Math.max(attacker.buffs.atk,attacker.combatBuffs.atk);
			attackerEffSpd -= Math.max(attacker.buffs.spd,attacker.combatBuffs.spd);
			attackerEffDef -= Math.max(attacker.buffs.def,attacker.combatBuffs.def);
			attackerEffRes -= Math.max(attacker.buffs.res,attacker.combatBuffs.res);
		}
		fightText += attacker.name + "'s bonuses have been nullified.<br>";
		bladeCheck = false;
		attackerNull = true;
	}
	//Dragonskin 2
	else if((enemy.hasExactly("Dragonskin 2") && (attacker.combatStartHp / attacker.maxHp >= 0.75 || attacker.initiator)) || (enemy.hasExactly("Fell Wyrmscale") && enemy.combatStartHp / enemy.maxHp >= 0.25)){
		//if panicked, leave negative value in.
		if(!attacker.penalty.panic){
			attackerEffAtk -= Math.max(attacker.buffs.atk,attacker.combatBuffs.atk);
			attackerEffSpd -= Math.max(attacker.buffs.spd,attacker.combatBuffs.spd);
			attackerEffDef -= Math.max(attacker.buffs.def,attacker.combatBuffs.def);
			attackerEffRes -= Math.max(attacker.buffs.res,attacker.combatBuffs.res);
		}
		fightText += attacker.name + "'s bonuses have been nullified.<br>";
		bladeCheck = false;
		attackerNull = true;
	}
	else if((enemy.hasExactly("Deadly Miasma") && enemy.initiator) || (enemy.hasExactly("Endless Tempest") && enemy.buddy.spaces > 0) || attacker.vein == 4){
		//if panicked, leave negative value in.
		if(!attacker.penalty.panic){
			attackerEffAtk -= Math.max(attacker.buffs.atk,attacker.combatBuffs.atk);
			attackerEffSpd -= Math.max(attacker.buffs.spd,attacker.combatBuffs.spd);
			attackerEffDef -= Math.max(attacker.buffs.def,attacker.combatBuffs.def);
			attackerEffRes -= Math.max(attacker.buffs.res,attacker.combatBuffs.res);
		}
		fightText += attacker.name + "'s bonuses have been nullified.<br>";
		bladeCheck = false;
		attackerNull = true;
	}
	else{
		//Lull mechanic (B Skills)
		if(enemy.has("Lull Atk Spd")){
			//if panicked, leave negative value in.
			if(!attacker.penalty.panic){
				if(attackerStatNull[0] == false){
					attackerEffAtk -= Math.max(attacker.buffs.atk,attacker.combatBuffs.atk);
					attackerStatNull[0] = true;
				}
				if(attackerStatNull[1] == false){
					attackerEffSpd -= Math.max(attacker.buffs.spd,attacker.combatBuffs.spd);
					attackerStatNull[1] = true;
				}
			}
			fightText += attacker.name + "'s bonuses on atk and spd have been nullified due to " + data.skills[enemy.bIndex].name + ".<br>";
		}
		if(enemy.has("Lull Atk Def")){
			//if panicked, leave negative value in.
			if(!attacker.penalty.panic){
				if(attackerStatNull[0] == false){
					attackerEffAtk -= Math.max(attacker.buffs.atk,attacker.combatBuffs.atk);
					attackerStatNull[0] = true;
				}
				if(attackerStatNull[2] == false){
					attackerEffDef -= Math.max(attacker.buffs.def,attacker.combatBuffs.def);
					attackerStatNull[2] = true;
				}
			}
			fightText += attacker.name + "'s bonuses on atk and def have been nullified due to " + data.skills[enemy.bIndex].name + ".<br>";
		}
		if(enemy.has("Lull Atk Res")){
			//if panicked, leave negative value in.
			if(!attacker.penalty.panic){
				if(attackerStatNull[0] == false){
					attackerEffAtk -= Math.max(attacker.buffs.atk,attacker.combatBuffs.atk);
					attackerStatNull[0] = true;
				}
				if(attackerStatNull[3] == false){
					attackerEffRes -= Math.max(attacker.buffs.res,attacker.combatBuffs.res);
					attackerStatNull[3] = true;
				}
			}
			fightText += attacker.name + "'s bonuses on atk and res have been nullified due to " + data.skills[enemy.bIndex].name + ".<br>";
		}
		if(enemy.has("Lull Spd Def")){
			//if panicked, leave negative value in.
			if(!attacker.penalty.panic){
				if(attackerStatNull[1] == false){
					attackerEffSpd -= Math.max(attacker.buffs.spd,attacker.combatBuffs.spd);
					attackerStatNull[1] = true;
				}
				if(attackerStatNull[2] == false){
					attackerEffDef -= Math.max(attacker.buffs.def,attacker.combatBuffs.def);
					attackerStatNull[2] = true;
				}
			}
			fightText += attacker.name + "'s bonuses on spd and def have been nullified due to " + data.skills[enemy.bIndex].name + ".<br>";
		}
		if(enemy.has("Lull Spd Res")){
			//if panicked, leave negative value in.
			if(!attacker.penalty.panic){
				if(attackerStatNull[1] == false){
					attackerEffSpd -= Math.max(attacker.buffs.spd,attacker.combatBuffs.spd);
					attackerStatNull[1] = true;
				}
				if(attackerStatNull[3] == false){
					attackerEffRes -= Math.max(attacker.buffs.res,attacker.combatBuffs.res);
					attackerStatNull[3] = true;
				}
			}
			fightText += attacker.name + "'s bonuses on spd and res have been nullified due to " + data.skills[enemy.bIndex].name + ".<br>";
		}
		//Refine 5 and base are separated (Weapons)
		if(((enemy.hasExactly("Sun Dragonstone") || (enemy.hasExactly("Forseti") && attacker.combatStartHp / attacker.maxHp >= 0.75)) && enemy.rValue == 5) || (enemy.hasExactly("Spear of Assal") && enemy.rValue < 0 && (enemy.buddy.adjacent > 0 || enemy.buddy.two > 0)) || (enemy.hasExactly("Diva-Pair Parasol") && enemyVisDef + 5 >= attackerVisDef)){
			//if panicked, leave negative value in.
			if(!attacker.penalty.panic){
				if(attackerStatNull[0] == false){
					attackerEffAtk -= Math.max(attacker.buffs.atk,attacker.combatBuffs.atk);
					attackerStatNull[0] = true;
				}
				if(attackerStatNull[1] == false){
					attackerEffSpd -= Math.max(attacker.buffs.spd,attacker.combatBuffs.spd);
					attackerStatNull[1] = true;
				}
			}
			fightText += attacker.name + "'s bonuses on atk and spd have been nullified.<br>";
		}
		if(((enemy.hasExactly("Guardian's Axe") || enemy.hasExactly("Dark Royal Spear") || (enemy.has("Effie's Lance") && enemy.toggle.weapon == 1) || ((enemy.hasExactly("Loyalty Spear") || enemy.hasExactly("Hallowed Tyrfing")) && enemy.combatStartHp / enemy.maxHp >= 0.25) || (enemy.hasExactly("Wolfskin Fang") && (attacker.initiator || attacker.combatStartHp / attacker.maxHp >= 0.75)) || (enemy.hasExactly("Moon Gradivus") && enemy.toggle.weapon == 1) || (enemy.hasExactly("Ragnell-Alondite") && (attacker.initiator || attacker.combatStartHp / attacker.maxHp >= 0.75))) && enemy.rValue == 5) || ((enemy.has("Flowing Lance") || enemy.has("Deck Swabber") || enemy.has("Unbound Blade") || enemy.has("Unbound Axe") || enemy.has("Unbound Lance")) && enemy.buddy.adjacent == 0) || (enemy.hasExactly("Earthly Gae Bolg") && (attacker.moveType != "flying" || (enemy.rValue > 0 && enemy.combatStartHp / enemy.maxHp >= 0.5))) || (enemy.hasExactly("Gurgurant") && enemy.rValue > 0) || (enemy.hasExactly("Nectar Horn") && (attacker.initiator || attacker.combatStartHp / attacker.maxHp >= 0.75)) || (enemy.hasExactly("Divine Toxin") && (enemy.transform == true || attacker.initiator)) || (enemy.hasExactly("Atk Res Fortune") && (attacker.initiator || enemy.transform == true)) || (enemy.hasExactly("Obsidian Lance") && enemy.rValue == 5) || (enemy.hasExactly("Delivering Antler") && (!attacker.initiator || enemy.buddy.adjacent > 0 || enemy.buddy.two > 0))){
			//if panicked, leave negative value in.
			if(!attacker.penalty.panic){
				if(attackerStatNull[0] == false){
					attackerEffAtk -= Math.max(attacker.buffs.atk,attacker.combatBuffs.atk);
					attackerStatNull[0] = true;
				}
				if(attackerStatNull[2] == false){
					attackerEffDef -= Math.max(attacker.buffs.def,attacker.combatBuffs.def);
					attackerStatNull[2] = true;
				}
			}
			fightText += attacker.name + "'s bonuses on atk and def have been nullified.<br>";
		}
		if((enemy.has("Blackfire Breath") && enemy.toggle.weapon == 1) || ((enemy.hasExactly("Brilliant Starlight") || enemy.hasExactly("Arcane Caliburnus") || enemy.hasExactly("Silver of Dawn")) && enemy.combatStartHp / enemy.maxHp >= 0.25) || (enemy.hasExactly("Obscurite") && (!attacker.initiator || ((enemy.buddy.adjacent > 0 || enemy.buddy.two > 0) && enemy.toggle.weapon > 1))) || ((enemy.hasExactly("Petrify") || enemy.hasExactly("Banshee TH")) && enemy.rValue == 5 && enemy.combatStartHp / enemy.maxHp >= 0.25) || (enemy.hasExactly("Beyond Reason") && (attacker.initiator || attacker.combatStartHp / attacker.maxHp >= 0.75))){
			//if panicked, leave negative value in.
			if(!attacker.penalty.panic){
				if(attackerStatNull[0] == false){
					attackerEffAtk -= Math.max(attacker.buffs.atk,attacker.combatBuffs.atk);
					attackerStatNull[0] = true;
				}
				if(attackerStatNull[3] == false){
					attackerEffRes -= Math.max(attacker.buffs.res,attacker.combatBuffs.res);
					attackerStatNull[3] = true;
				}
			}
			fightText += attacker.name + "'s bonuses on atk and res have been nullified.<br>";
		}
		if(((enemy.has("Helm Bow") || enemy.has("Unbound Bow")) && enemy.toggle.weapon == 1) || ((enemy.hasExactly("Blade of Jehanna") || enemy.hasExactly("Arcane Luin") || ((enemy.hasExactly("Guardian's Bow") || enemy.hasExactly("Mirage Longbow") || enemy.hasExactly("Holy Yewfelle") || enemy.hasExactly("Luin")) && enemy.rValue == 5) || enemy.hasExactly("Breaker Bow")) && enemy.combatStartHp / enemy.maxHp >= 0.25) || (enemy.hasExactly("Mareeta's Sword") && enemy.rValue > 0 && (!this.initiator || enemy.toggle.weapon == 1)) || (enemy.hasExactly("Brilliant Rapier") && (attacker.initiator || attacker.combatStartHp / attacker.maxHp >= 0.75)) || (enemy.hasExactly("Atk Spd Fortune") && (attacker.initiator || enemy.transform == true)) || enemy.hasExactly("Arcane Sly Knife") || (enemy.hasExactly("Deer's Heart") && (enemy.initiator || enemy.buddy.adjacent > 0 || enemy.buddy.two > 0))){
			//if panicked, leave negative value in.
			if(!attacker.penalty.panic){
				if(attackerStatNull[1] == false){
					attackerEffSpd -= Math.max(attacker.buffs.spd,attacker.combatBuffs.spd);
					attackerStatNull[1] = true;
				}
				if(attackerStatNull[2] == false){
					attackerEffDef -= Math.max(attacker.buffs.def,attacker.combatBuffs.def);
					attackerStatNull[2] = true;
				}
			}
			fightText += attacker.name + "'s bonuses on spd and def have been nullified.<br>";
		}
		if((enemy.hasExactly("Phantasm Tome") && (attacker.combatStartHp / attacker.maxHp >= 0.5 || (enemy.rValue > 0 && enemy.initiator))) || (enemy.hasExactly("Death") && enemy.rValue > 0) || (((enemy.hasExactly("Ifingr") && enemy.rValue == 5) || (enemy.hasExactly("Exotic Fruit Juice") && enemy.rValue > 0)) && enemy.combatStartHp / enemy.maxHp >= 0.25) || (enemy.hasExactly("Agnea's Arrow") && (enemy.initiator || enemy.toggle.weapon == 1) && turn % 2 == 1) || ((enemy.hasExactly("Baked Treats") || (enemy.hasExactly("Winds of Change") && enemy.rValue == 5) || enemy.hasExactly("Caring Magic")) && (enemy.initiator || enemy.buddy.adjacent > 0 || enemy.buddy.two > 0)) || (enemy.hasExactly("Arcane Thunder") && enemy.combatStartHp / enemy.maxHp >= 0.25) || (enemy.hasExactly("Hades O") && enemy.rValue == 5 && (enemy.initiator || attacker.range == "ranged")) || (enemy.hasExactly("Fluttering Fan") && enemy.buddy.rorc > 0) || (enemy.hasExactly("Tome of Storms") && enemy.rValue > 0 && (enemy.initiator || attacker.combatStartHp / attacker.maxHp >= 0.75))){
			//if panicked, leave negative value in.
			if(!attacker.penalty.panic){
				if(attackerStatNull[1] == false){
					attackerEffSpd -= Math.max(attacker.buffs.spd,attacker.combatBuffs.spd);
					attackerStatNull[1] = true;
				}
				if(attackerStatNull[3] == false){
					attackerEffRes -= Math.max(attacker.buffs.res,attacker.combatBuffs.res);
					attackerStatNull[3] = true;
				}
			}
			fightText += attacker.name + "'s bonuses on spd and res have been nullified.<br>";
		}
		if((enemy.hasExactly("Indignant Bow") && (attacker.initiator || attacker.combatStartHp / attacker.maxHp == 1)) || (enemy.hasExactly("Nurturing Breath") && enemy.rValue == 5 && enemy.prfVal > 0)){
			var lullText = "atk";
			//if panicked, leave negative value in.
			if(!attacker.penalty.panic){
				if(attackerStatNull[0] == false){
					attackerEffAtk -= Math.max(attacker.buffs.atk,attacker.combatBuffs.atk);
					attackerStatNull[0] = true;
				}
				if(enemy.hasExactly("Indignant Bow") && enemy.rValue > 0 && (attacker.initiator || attacker.combatStartHp / attacker.maxHp >= 0.75)){
					lullText = "atk & spd";
					if(attackerStatNull[1] == false){
						attackerEffSpd -= Math.max(attacker.buffs.spd,attacker.combatBuffs.spd);
						attackerStatNull[1] = true;
					}
				}
			}
			fightText += attacker.name + "'s bonuses on " + lullText + " have been nullified.<br>";
		}
		if(enemy.hasExactly("Craver's Tome") && enemy.rValue == 5 && enemy.combatStartHp / enemy.maxHp >= 0.25){
			//if panicked, leave negative value in.
			if(!attacker.penalty.panic){
				if(attackerStatNull[3] == false){
					attackerEffRes -= Math.max(attacker.buffs.res,attacker.combatBuffs.res);
					attackerStatNull[3] = true;
				}
			}
			fightText += attacker.name + "'s bonuses on res have been nullified.<br>";
		}
		if(((enemy.hasExactly("Binding Reginleif") && (enemy.initiator || enemy.buddy.adjacent + enemy.buddy.two > 0)) || (enemy.hasExactly("Heavenly Icicle") && (enemy.initiator || enemy.buddy.adjacent + enemy.buddy.two + enemy.buddy.three > 0))) && enemy.rValue == 5){
			//if panicked, leave negative value in.
			if(!attacker.penalty.panic){
				if(attackerStatNull[0] == false){
					attackerEffAtk -= Math.max(attacker.buffs.atk,attacker.combatBuffs.atk);
					attackerStatNull[0] = true;
				}
				if(attackerStatNull[1] == false){
					attackerEffSpd -= Math.max(attacker.buffs.spd,attacker.combatBuffs.spd);
					attackerStatNull[1] = true;
				}
				if(attackerStatNull[2] == false){
					attackerEffDef -= Math.max(attacker.buffs.def,attacker.combatBuffs.def);
					attackerStatNull[2] = true;
				}
			}
			fightText += attacker.name + "'s bonuses on atk/spd/def have been nullified.<br>";
		}
		if(enemy.support.lullAtk){
			//if panicked, leave negative value in.
			if(!attacker.penalty.panic){
				if(attackerStatNull[0] == false){
					attackerEffAtk -= Math.max(attacker.buffs.atk,attacker.combatBuffs.atk);
					attackerStatNull[0] = true;
				}
			}
			fightText += attacker.name + "'s bonuses on atk have been nullified due to Lull Atk Support.<br>";
		}
		if(enemy.support.lullSpd){
			//if panicked, leave negative value in.
			if(!attacker.penalty.panic){
				if(attackerStatNull[1] == false){
					attackerEffSpd -= Math.max(attacker.buffs.spd,attacker.combatBuffs.spd);
					attackerStatNull[1] = true;
				}
			}
			fightText += attacker.name + "'s bonuses on spd have been nullified due to Lull Spd Support.<br>";
		}
		if(enemy.support.lullDef){
			//if panicked, leave negative value in.
			if(!attacker.penalty.panic){
				if(attackerStatNull[2] == false){
					attackerEffDef -= Math.max(attacker.buffs.def,attacker.combatBuffs.def);
					attackerStatNull[2] = true;
				}
			}
			fightText += attacker.name + "'s bonuses on def have been nullified due to Lull Def Support.<br>";
		}
		if(enemy.support.lullRes){
			//if panicked, leave negative value in.
			if(!attacker.penalty.panic){
				if(attackerStatNull[3] == false){
					attackerEffRes -= Math.max(attacker.buffs.res,attacker.combatBuffs.res);
					attackerStatNull[3] = true;
				}
			}
			fightText += attacker.name + "'s bonuses on res have been nullified due to Lull Res Support.<br>";
		}
	}
	if(enemy.hasExactly("Upheaval+") && (attacker.combatStartHp / attacker.maxHp < 1 || enemyVisAtk > attackerVisAtk)){
		//if panicked, leave negative value in.
		if(!attacker.penalty.panic){
			attackerEffAtk -= Math.max(attacker.buffs.atk,attacker.combatBuffs.atk);
			attackerEffSpd -= Math.max(attacker.buffs.spd,attacker.combatBuffs.spd);
			attackerEffDef -= Math.max(attacker.buffs.def,attacker.combatBuffs.def);
			attackerEffRes -= Math.max(attacker.buffs.res,attacker.combatBuffs.res);
		}
		fightText += attacker.name + "'s bonuses have been nullified.<br>";
		bladeCheck = false;
		attackerNull = true;
	}
	if(attackerNull){
		attackerStatNull = [true,true,true,true];
	}
	
	//Exalted Falchion and Hrimfaxi mechanic
	if((attacker.hasExactly("Exalted Falchion") || (attacker.hasExactly("Warrior's Sword") && attacker.combatStartHp / attacker.maxHp >= 0.25) || (attacker.hasExactly("Sell-Spell Tome") && attacker.combatStartHp / attacker.maxHp >= 0.25 && attacker.dragonflower > 2) || (attacker.hasExactly("Icy Maltet") && attacker.rValue == 5 && attacker.toggle.weapon == 1) || (attacker.hasExactly("Razing Breath") && attacker.rValue == 5 && attacker.combatStartHp / attacker.maxHp >= 0.25)) && !attackerNull){
		//if not panicked, add buffs as additional combat buff
		if(!attacker.penalty.panic){
			var tBoost = [0,0,0,0];
			var tString = "";
			if(!attackerStatNull[0]){
				tBoost[0] = Math.max(attacker.buffs.atk,attacker.combatBuffs.atk);
				if(tBoost[0] > 0){
					attackerEffAtk += tBoost[0];
					tString += "+" + tBoost[0] + " atk ";
				}
			}
			if(!attackerStatNull[1]){
				tBoost[1] = Math.max(attacker.buffs.spd,attacker.combatBuffs.spd);
				if(tBoost[1] > 0){
					attackerEffSpd += tBoost[1];
					tString += "+" + tBoost[1] + " spd ";
				}
			}
			if(!attackerStatNull[2]){
				tBoost[2] = Math.max(attacker.buffs.def,attacker.combatBuffs.def);
				if(tBoost[2] > 0){
					attackerEffDef += tBoost[2];
					tString += "+" + tBoost[2] + " def ";
				}
			}
			if(!attackerStatNull[3]){
				tBoost[3] = Math.max(attacker.buffs.res,attacker.combatBuffs.res);
				if(tBoost[3] > 0){
					attackerEffRes += tBoost[3];
					tString += "+" + tBoost[3] + " res ";
				}
			}
			if(tString != ""){
				fightText += attacker.name + " has gained an additional " + tString + "from " + data.skills[attacker.weaponIndex].name + ".<br>";
			}
		}
	}
	if((enemy.hasExactly("Exalted Falchion") || (enemy.hasExactly("Warrior's Sword") && enemy.combatStartHp / enemy.maxHp >= 0.25) || (enemy.hasExactly("Sell-Spell Tome") && enemy.combatStartHp / enemy.maxHp >= 0.25 && enemy.dragonflower > 2) || (enemy.hasExactly("Icy Maltet") && enemy.rValue == 5 && enemy.toggle.weapon == 1) || (enemy.hasExactly("Razing Breath") && enemy.rValue == 5 && enemy.combatStartHp / enemy.maxHp >= 0.25)) && !enemyNull){
		//if not panicked, add buffs as additional combat buff
		if(!enemy.penalty.panic){
			var tBoost = [0,0,0,0];
			var tString = "";
			if(!enemyStatNull[0]){
				tBoost[0] = Math.max(enemy.buffs.atk,enemy.combatBuffs.atk);
				if(tBoost[0] > 0){
					enemyEffAtk += tBoost[0];
					tString += "+" + tBoost[0] + " atk ";
				}
			}
			if(!enemyStatNull[1]){
				tBoost[1] = Math.max(enemy.buffs.spd,enemy.combatBuffs.spd);
				if(tBoost[1] > 0){
					enemyEffSpd += tBoost[1];
					tString += "+" + tBoost[1] + " spd ";
				}
			}
			if(!enemyStatNull[2]){
				tBoost[2] = Math.max(enemy.buffs.def,enemy.combatBuffs.def);
				if(tBoost[2] > 0){
					enemyEffDef += tBoost[2];
					tString += "+" + tBoost[2] + " def ";
				}
			}
			if(!enemyStatNull[3]){
				tBoost[3] = Math.max(enemy.buffs.res,enemy.combatBuffs.res);
				if(tBoost[3] > 0){
					enemyEffRes += tBoost[3];
					tString += "+" + tBoost[3] + " res ";
				}
			}
			if(tString != ""){
				fightText += enemy.name + " has gained an additional " + tString + "from " + data.skills[enemy.weaponIndex].name + ".<br>";
			}
		}
	}
	//Hrimfaxi
	if(attacker.hasExactly("Hrimfaxi") && attacker.combatStartHp / attacker.maxHp >= 0.25){
		if(attacker.rValue > 0){
			var tBoost = [0,0,0,0];
			if(!attacker.penalty.panic){
				if(!attackerStatNull[0]){
					tBoost[0] = Math.max(attacker.buffs.atk,attacker.combatBuffs.atk);
				}
				if(!attackerStatNull[1]){
					tBoost[1] = Math.max(attacker.buffs.spd,attacker.combatBuffs.spd);
				}
				if(!attackerStatNull[2]){
					tBoost[2] = Math.max(attacker.buffs.def,attacker.combatBuffs.def);
				}
				if(!attackerStatNull[3]){
					tBoost[3] = Math.max(attacker.buffs.res,attacker.combatBuffs.res);
				}
			}
			if(attacker.buddy.adjacent > 0 || attacker.buddy.two > 0){
				tBoost[0] = Math.max(tBoost[0],attacker.buddy.buffs.atk);
				tBoost[1] = Math.max(tBoost[1],attacker.buddy.buffs.spd);
				tBoost[2] = Math.max(tBoost[2],attacker.buddy.buffs.def);
				tBoost[3] = Math.max(tBoost[3],attacker.buddy.buffs.res);
			}
			attackerEffAtk += tBoost[0];
			attackerEffSpd += tBoost[1];
			attackerEffDef += tBoost[2];
			attackerEffRes += tBoost[3];
			fightText += attacker.name + " has gained an additional +" + tBoost[0] + " atk/+" + tBoost[1] + " spd/+" + tBoost[2] + " def/+" + tBoost[3] + " res from " + data.skills[attacker.weaponIndex].name + ".<br>";
		}
		else{
			if(!attacker.penalty.panic && !attackerNull){
				var tBoost = [0,0,0,0];
				var tString = "";
				if(!attackerStatNull[0]){
					tBoost[0] = Math.max(attacker.buffs.atk,attacker.combatBuffs.atk);
					if(tBoost[0] > 0){
						attackerEffAtk += tBoost[0];
						tString += "+" + tBoost[0] + " atk ";
					}
				}
				if(!attackerStatNull[1]){
					tBoost[1] = Math.max(attacker.buffs.spd,attacker.combatBuffs.spd);
					if(tBoost[1] > 0){
						attackerEffSpd += tBoost[1];
						tString += "+" + tBoost[1] + " spd ";
					}
				}
				if(!attackerStatNull[2]){
					tBoost[2] = Math.max(attacker.buffs.def,attacker.combatBuffs.def);
					if(tBoost[2] > 0){
						attackerEffDef += tBoost[2];
						tString += "+" + tBoost[2] + " def ";
					}
				}
				if(!attackerStatNull[3]){
					tBoost[3] = Math.max(attacker.buffs.res,attacker.combatBuffs.res);
					if(tBoost[3] > 0){
						attackerEffRes += tBoost[3];
						tString += "+" + tBoost[3] + " res ";
					}
				}
				if(tString != ""){
					fightText += attacker.name + " has gained an additional " + tString + "from " + data.skills[attacker.weaponIndex].name + ".<br>";
				}
			}
		}
	}
	if(enemy.hasExactly("Hrimfaxi") && enemy.combatStartHp / enemy.maxHp >= 0.25){
		if(enemy.rValue > 0){
			var tBoost = [0,0,0,0];
			if(!enemy.penalty.panic){
				if(!enemyStatNull[0]){
					tBoost[0] = Math.max(enemy.buffs.atk,enemy.combatBuffs.atk);
				}
				if(!enemyStatNull[1]){
					tBoost[1] = Math.max(enemy.buffs.spd,enemy.combatBuffs.spd);
				}
				if(!enemyStatNull[2]){
					tBoost[2] = Math.max(enemy.buffs.def,enemy.combatBuffs.def);
				}
				if(!enemyStatNull[3]){
					tBoost[3] = Math.max(enemy.buffs.res,enemy.combatBuffs.res);
				}
			}
			if(enemy.buddy.adjacent > 0 || enemy.buddy.two > 0){
				tBoost[0] = Math.max(tBoost[0],enemy.buddy.buffs.atk);
				tBoost[1] = Math.max(tBoost[1],enemy.buddy.buffs.spd);
				tBoost[2] = Math.max(tBoost[2],enemy.buddy.buffs.def);
				tBoost[3] = Math.max(tBoost[3],enemy.buddy.buffs.res);
			}
			enemyEffAtk += tBoost[0];
			enemyEffSpd += tBoost[1];
			enemyEffDef += tBoost[2];
			enemyEffRes += tBoost[3];
			fightText += enemy.name + " has gained an additional +" + tBoost[0] + " atk/+" + tBoost[1] + " spd/+" + tBoost[2] + " def/+" + tBoost[3] + " res from " + data.skills[enemy.weaponIndex].name + ".<br>";
		}
		else{
			if(!enemy.penalty.panic && !enemyNull){
				var tBoost = [0,0,0,0];
				var tString = "";
				if(!enemyStatNull[0]){
					tBoost[0] = Math.max(enemy.buffs.atk,enemy.combatBuffs.atk);
					if(tBoost[0] > 0){
						enemyEffAtk += tBoost[0];
						tString += "+" + tBoost[0] + " atk ";
					}
				}
				if(!enemyStatNull[1]){
					tBoost[1] = Math.max(enemy.buffs.spd,enemy.combatBuffs.spd);
					if(tBoost[1] > 0){
						enemyEffSpd += tBoost[1];
						tString += "+" + tBoost[1] + " spd ";
					}
				}
				if(!enemyStatNull[2]){
					tBoost[2] = Math.max(enemy.buffs.def,enemy.combatBuffs.def);
					if(tBoost[2] > 0){
						enemyEffDef += tBoost[2];
						tString += "+" + tBoost[2] + " def ";
					}
				}
				if(!enemyStatNull[3]){
					tBoost[3] = Math.max(enemy.buffs.res,enemy.combatBuffs.res);
					if(tBoost[3] > 0){
						enemyEffRes += tBoost[3];
						tString += "+" + tBoost[3] + " res ";
					}
				}
				if(tString != ""){
					fightText += enemy.name + " has gained an additional " + tString + "from " + data.skills[enemy.weaponIndex].name + ".<br>";
				}
			}
		}
	}
	//Skills that don't boost all stats
	if((attacker.has("Bridal Orchid") || attacker.has("Bridal Sunflower")) && attacker.combatStartHp / attacker.maxHp >= 0.25 && !attackerNull){
		//if not panicked, add buffs as additional combat buff
		if(!attacker.penalty.panic){
			var tBoost = [0,0,0,0];
			var tString = "";
			if(!attackerStatNull[0] && (attacker.has("Bridal Orchid") || attacker.has("Bridal Sunflower"))){
				tBoost[0] = Math.max(attacker.buffs.atk,attacker.combatBuffs.atk);
				if(tBoost[0] > 0){
					attackerEffAtk += tBoost[0];
					tString += "+" + tBoost[0] + " atk ";
				}
			}
			if(!attackerStatNull[2] && attacker.has("Bridal Sunflower")){
				tBoost[2] = Math.max(attacker.buffs.def,attacker.combatBuffs.def);
				if(tBoost[2] > 0){
					attackerEffDef += tBoost[2];
					tString += "+" + tBoost[2] + " def ";
				}
			}
			if(!attackerStatNull[3] && attacker.has("Bridal Orchid")){
				tBoost[3] = Math.max(attacker.buffs.res,attacker.combatBuffs.res);
				if(tBoost[3] > 0){
					attackerEffRes += tBoost[3];
					tString += "+" + tBoost[3] + " res ";
				}
			}
			if(tString != ""){
				fightText += attacker.name + " has gained an additional " + tString + "from " + data.skills[attacker.weaponIndex].name + ".<br>";
			}
		}
	}
	if((enemy.has("Bridal Orchid") || enemy.has("Bridal Sunflower")) && enemy.combatStartHp / enemy.maxHp >= 0.25 && !enemyNull){
		//if not panicked, add buffs as additional combat buff
		if(!enemy.penalty.panic){
			var tBoost = [0,0,0,0];
			var tString = "";
			if(!enemyStatNull[0] && (enemy.has("Bridal Orchid") || enemy.has("Bridal Sunflower"))){
				tBoost[0] = Math.max(enemy.buffs.atk,enemy.combatBuffs.atk);
				if(tBoost[0] > 0){
					enemyEffAtk += tBoost[0];
					tString += "+" + tBoost[0] + " atk ";
				}
			}
			if(!enemyStatNull[2] && enemy.has("Bridal Sunflower")){
				tBoost[2] = Math.max(enemy.buffs.def,enemy.combatBuffs.def);
				if(tBoost[2] > 0){
					enemyEffDef += tBoost[2];
					tString += "+" + tBoost[2] + " def ";
				}
			}
			if(!enemyStatNull[3] && enemy.has("Bridal Orchid")){
				tBoost[3] = Math.max(enemy.buffs.res,enemy.combatBuffs.res);
				if(tBoost[3] > 0){
					enemyEffRes += tBoost[3];
					tString += "+" + tBoost[3] + " res ";
				}
			}
			if(tString != ""){
				fightText += enemy.name + " has gained an additional " + tString + "from " + data.skills[enemy.weaponIndex].name + ".<br>";
			}
		}
	}
	if(attacker.hasExactly("Cunning Bow") && attacker.rValue == 5 && attacker.combatStartHp / attacker.maxHp >= 0.25){
		//if not panicked, add buffs as additional combat buff
		if(!attacker.penalty.panic){
			var tBoost = 0;
			var tString = "";
			if(!attackerStatNull[0]){
				tBoost = Math.max(attacker.buffs.atk,attacker.combatBuffs.atk);
				if(tBoost > 0){
					attackerEffAtk += tBoost;
					tString += "+" + tBoost + " atk ";
				}
			}
			if(tString != ""){
				fightText += attacker.name + " has gained an additional " + tString + "from " + data.skills[attacker.weaponIndex].name + ".<br>";
			}
		}
	}
	if(enemy.hasExactly("Cunning Bow") && enemy.rValue == 5 && enemy.combatStartHp / enemy.maxHp >= 0.25){
		//if not panicked, add buffs as additional combat buff
		if(!enemy.penalty.panic){
			var tBoost = 0;
			var tString = "";
			if(!enemyStatNull[0]){
				tBoost = Math.max(enemy.buffs.atk,enemy.combatBuffs.atk);
				if(tBoost > 0){
					enemyEffAtk += tBoost;
					tString += "+" + tBoost + " atk ";
				}
			}
			if(tString != ""){
				fightText += enemy.name + " has gained an additional " + tString + "from " + data.skills[enemy.weaponIndex].name + ".<br>";
			}
		}
	}
	
	//Bonus Doubler mechanic
	if(attacker.has("Bonus Doubler")){
		var bonusCo = 0;
		if((attacker.hasSlot("Bonus Doubler","a") == 4 || attacker.hasExactly("D Bonus Doubler") || attacker.hasExactly("C Bonus Doubler")) && (Object.values(attacker.buffs).reduce((a, b) => a + b, 0) > 0 || Object.values(attacker.combatBuffs).reduce((a, b) => a + b, 0) > 0 || Object.values(attacker.bonus).reduce((a, item) => a + (item === true ? 1 : 0), 0) + attacker.bonus.extra > 0 || ((attacker.buddy.adjacent > 0 || attacker.buddy.two > 0) && (attacker.buddy.bonusCondition || attacker.buddy.buffs.atk > 0 || attacker.buddy.buffs.spd > 0 || attacker.buddy.buffs.def > 0 || attacker.buddy.buffs.res > 0)))){
			var tBoost = [0,0,0,0];
			if(!attacker.penalty.panic){
				if(!attackerStatNull[0]){
					tBoost[0] = Math.max(attacker.buffs.atk,attacker.combatBuffs.atk);
				}
				if(!attackerStatNull[1]){
					tBoost[1] = Math.max(attacker.buffs.spd,attacker.combatBuffs.spd);
				}
				if(!attackerStatNull[2]){
					tBoost[2] = Math.max(attacker.buffs.def,attacker.combatBuffs.def);
				}
				if(!attackerStatNull[3]){
					tBoost[3] = Math.max(attacker.buffs.res,attacker.combatBuffs.res);
				}
			}
			if(attacker.buddy.adjacent > 0 || attacker.buddy.two > 0){
				tBoost[0] = Math.max(tBoost[0],attacker.buddy.buffs.atk);
				tBoost[1] = Math.max(tBoost[1],attacker.buddy.buffs.spd);
				tBoost[2] = Math.max(tBoost[2],attacker.buddy.buffs.def);
				tBoost[3] = Math.max(tBoost[3],attacker.buddy.buffs.res);
			}
			if(attacker.hasSlot("Bonus Doubler","a") == 4){
				for(var i = 0; i < 4; i++){
					tBoost[i] += 4;
				}
			}
			attackerEffAtk += tBoost[0];
			attackerEffSpd += tBoost[1];
			attackerEffDef += tBoost[2];
			attackerEffRes += tBoost[3];
			fightText += attacker.name + " has gained an additional +" + tBoost[0] + " atk/+" + tBoost[1] + " spd/+" + tBoost[2] + " def/+" + tBoost[3] + " res from " + data.skills[attacker.aIndex].name + ".<br>";
		}
		else if(attacker.hasSlot("Bonus Doubler","a") > 0 && attacker.hasSlot("Bonus Doubler","a") < 4 && !attackerNull && !attacker.penalty.panic){
			bonusCo = (attacker.hasSlot("Bonus Doubler","a") * 0.25) + 0.25;
			var tBoost = [0,0,0,0];
			var tString = "";
			if(!attackerStatNull[0]){
				tBoost[0] = Math.floor(Math.max(attacker.buffs.atk,attacker.combatBuffs.atk) * bonusCo);
				if(tBoost[0] > 0){
					attackerEffAtk += tBoost[0];
					tString += "+" + tBoost[0] + " atk ";
				}
			}
			if(!attackerStatNull[1]){
				tBoost[1] = Math.floor(Math.max(attacker.buffs.spd,attacker.combatBuffs.spd) * bonusCo);
				if(tBoost[1] > 0){
					attackerEffSpd += tBoost[1];
					tString += "+" + tBoost[1] + " spd ";
				}
			}
			if(!attackerStatNull[2]){
				tBoost[2] = Math.floor(Math.max(attacker.buffs.def,attacker.combatBuffs.def) * bonusCo);
				if(tBoost[2] > 0){
					attackerEffDef += tBoost[2];
					tString += "+" + tBoost[2] + " def ";
				}
			}
			if(!attackerStatNull[3]){
				tBoost[3] = Math.floor(Math.max(attacker.buffs.res,attacker.combatBuffs.res) * bonusCo);
				if(tBoost[3] > 0){
					attackerEffRes += tBoost[3];
					tString += "+" + tBoost[3] + " res ";
				}
			}
			if(tString != ""){
				fightText += attacker.name + " has gained an additional " + tString + "from " + data.skills[attacker.aIndex].name + ".<br>";
			}
			bonusCo = 0;
		}
		if(attacker.hasSlot("Bonus Doubler","s") && !attackerNull && !attacker.penalty.panic){
			bonusCo = (attacker.hasSlot("Bonus Doubler","s") * 0.25) + 0.25;
			var tBoost = [0,0,0,0];
			var tString = "";
			if(!attackerStatNull[0]){
				tBoost[0] = Math.floor(Math.max(attacker.buffs.atk,attacker.combatBuffs.atk) * bonusCo);
				if(tBoost[0] > 0){
					attackerEffAtk += tBoost[0];
					tString += "+" + tBoost[0] + " atk ";
				}
			}
			if(!attackerStatNull[1]){
				tBoost[1] = Math.floor(Math.max(attacker.buffs.spd,attacker.combatBuffs.spd) * bonusCo);
				if(tBoost[1] > 0){
					attackerEffSpd += tBoost[1];
					tString += "+" + tBoost[1] + " spd ";
				}
			}
			if(!attackerStatNull[2]){
				tBoost[2] = Math.floor(Math.max(attacker.buffs.def,attacker.combatBuffs.def) * bonusCo);
				if(tBoost[2] > 0){
					attackerEffDef += tBoost[2];
					tString += "+" + tBoost[2] + " def ";
				}
			}
			if(!attackerStatNull[3]){
				tBoost[3] = Math.floor(Math.max(attacker.buffs.res,attacker.combatBuffs.res) * bonusCo);
				if(tBoost[3] > 0){
					attackerEffRes += tBoost[3];
					tString += "+" + tBoost[3] + " res ";
				}
			}
			if(tString != ""){
				fightText += attacker.name + " has gained an additional " + tString + "from " + data.skills[attacker.sIndex].name + ".<br>";
			}
		}
	}
	if(enemy.has("Bonus Doubler")){
		var bonusCo = 0;
		if((enemy.hasSlot("Bonus Doubler","a") == 4 || enemy.hasExactly("D Bonus Doubler") || enemy.hasExactly("C Bonus Doubler")) && (Object.values(enemy.buffs).reduce((a, b) => a + b, 0) > 0 || Object.values(enemy.combatBuffs).reduce((a, b) => a + b, 0) > 0 || Object.values(enemy.bonus).reduce((a, item) => a + (item === true ? 1 : 0), 0) + enemy.bonus.extra > 0 || ((enemy.buddy.adjacent > 0 || enemy.buddy.two > 0) && (enemy.buddy.bonusCondition || enemy.buddy.buffs.atk > 0 || enemy.buddy.buffs.spd > 0 || enemy.buddy.buffs.def > 0 || enemy.buddy.buffs.res > 0)))){
			var tBoost = [0,0,0,0];
			if(!enemy.penalty.panic){
				if(!enemyStatNull[0]){
					tBoost[0] = Math.max(enemy.buffs.atk,enemy.combatBuffs.atk);
				}
				if(!enemyStatNull[1]){
					tBoost[1] = Math.max(enemy.buffs.spd,enemy.combatBuffs.spd);
				}
				if(!enemyStatNull[2]){
					tBoost[2] = Math.max(enemy.buffs.def,enemy.combatBuffs.def);
				}
				if(!enemyStatNull[3]){
					tBoost[3] = Math.max(enemy.buffs.res,enemy.combatBuffs.res);
				}
			}
			if(enemy.buddy.adjacent > 0 || enemy.buddy.two > 0){
				tBoost[0] = Math.max(tBoost[0],enemy.buddy.buffs.atk);
				tBoost[1] = Math.max(tBoost[1],enemy.buddy.buffs.spd);
				tBoost[2] = Math.max(tBoost[2],enemy.buddy.buffs.def);
				tBoost[3] = Math.max(tBoost[3],enemy.buddy.buffs.res);
			}
			if(enemy.hasSlot("Bonus Doubler","a") == 4){
				for(var i = 0; i < 4; i++){
					tBoost[i] += 4;
				}
			}
			enemyEffAtk += tBoost[0];
			enemyEffSpd += tBoost[1];
			enemyEffDef += tBoost[2];
			enemyEffRes += tBoost[3];
			fightText += enemy.name + " has gained an additional +" + tBoost[0] + " atk/+" + tBoost[1] + " spd/+" + tBoost[2] + " def/+" + tBoost[3] + " res from " + data.skills[enemy.aIndex].name + ".<br>";
		}
		else if(enemy.hasSlot("Bonus Doubler","a") > 0 && enemy.hasSlot("Bonus Doubler","a") < 4 && !enemyNull && !enemy.penalty.panic){
			bonusCo = (enemy.hasSlot("Bonus Doubler","a") * 0.25) + 0.25;
			var tBoost = [0,0,0,0];
			var tString = "";
			if(!enemyStatNull[0]){
				tBoost[0] = Math.floor(Math.max(enemy.buffs.atk,enemy.combatBuffs.atk) * bonusCo);
				if(tBoost[0] > 0){
					enemyEffAtk += tBoost[0];
					tString += "+" + tBoost[0] + " atk ";
				}
			}
			if(!enemyStatNull[1]){
				tBoost[1] = Math.floor(Math.max(enemy.buffs.spd,enemy.combatBuffs.spd) * bonusCo);
				if(tBoost[1] > 0){
					enemyEffSpd += tBoost[1];
					tString += "+" + tBoost[1] + " spd ";
				}
			}
			if(!enemyStatNull[2]){
				tBoost[2] = Math.floor(Math.max(enemy.buffs.def,enemy.combatBuffs.def) * bonusCo);
				if(tBoost[2] > 0){
					enemyEffDef += tBoost[2];
					tString += "+" + tBoost[2] + " def ";
				}
			}
			if(!enemyStatNull[3]){
				tBoost[3] = Math.floor(Math.max(enemy.buffs.res,enemy.combatBuffs.res) * bonusCo);
				if(tBoost[3] > 0){
					enemyEffRes += tBoost[3];
					tString += "+" + tBoost[3] + " res ";
				}
			}
			if(tString != ""){
				fightText += enemy.name + " has gained an additional " + tString + "from " + data.skills[enemy.aIndex].name + ".<br>";
			}
			bonusCo = 0;
		}
		if(enemy.hasSlot("Bonus Doubler","s") && !enemyNull && !enemy.penalty.panic){
			bonusCo = (enemy.hasSlot("Bonus Doubler","s") * 0.25) + 0.25;
			var tBoost = [0,0,0,0];
			var tString = "";
			if(!enemyStatNull[0]){
				tBoost[0] = Math.floor(Math.max(enemy.buffs.atk,enemy.combatBuffs.atk) * bonusCo);
				if(tBoost[0] > 0){
					enemyEffAtk += tBoost[0];
					tString += "+" + tBoost[0] + " atk ";
				}
			}
			if(!enemyStatNull[1]){
				tBoost[1] = Math.floor(Math.max(enemy.buffs.spd,enemy.combatBuffs.spd) * bonusCo);
				if(tBoost[1] > 0){
					enemyEffSpd += tBoost[1];
					tString += "+" + tBoost[1] + " spd ";
				}
			}
			if(!enemyStatNull[2]){
				tBoost[2] = Math.floor(Math.max(enemy.buffs.def,enemy.combatBuffs.def) * bonusCo);
				if(tBoost[2] > 0){
					enemyEffDef += tBoost[2];
					tString += "+" + tBoost[2] + " def ";
				}
			}
			if(!enemyStatNull[3]){
				tBoost[3] = Math.floor(Math.max(enemy.buffs.res,enemy.combatBuffs.res) * bonusCo);
				if(tBoost[3] > 0){
					enemyEffRes += tBoost[3];
					tString += "+" + tBoost[3] + " res ";
				}
			}
			if(tString != ""){
				fightText += enemy.name + " has gained an additional " + tString + "from " + data.skills[enemy.sIndex].name + ".<br>";
			}
		}
	}
	//Bonus Doubler (Status)
	if(attacker.bonus.bDoubler && !attackerNull && !attacker.penalty.ploy){
		//if not panicked, add buffs as additional combat buff
		if(!attacker.penalty.panic){
			var tBoost = [0,0,0,0];
			var tString = "";
			if(!attackerStatNull[0]){
				tBoost[0] = Math.max(attacker.buffs.atk,attacker.combatBuffs.atk);
				if(tBoost[0] > 0){
					attackerEffAtk += tBoost[0];
					tString += "+" + tBoost[0] + " atk ";
				}
			}
			if(!attackerStatNull[1]){
				tBoost[1] = Math.max(attacker.buffs.spd,attacker.combatBuffs.spd);
				if(tBoost[1] > 0){
					attackerEffSpd += tBoost[1];
					tString += "+" + tBoost[1] + " spd ";
				}
			}
			if(!attackerStatNull[2]){
				tBoost[2] = Math.max(attacker.buffs.def,attacker.combatBuffs.def);
				if(tBoost[2] > 0){
					attackerEffDef += tBoost[2];
					tString += "+" + tBoost[2] + " def ";
				}
			}
			if(!attackerStatNull[3]){
				tBoost[3] = Math.max(attacker.buffs.res,attacker.combatBuffs.res);
				if(tBoost[3] > 0){
					attackerEffRes += tBoost[3];
					tString += "+" + tBoost[3] + " res ";
				}
			}
			if(tString != ""){
				fightText += attacker.name + " has gained an additional " + tString + "from Bonus Doubler (status).<br>";
			}
		}
	}
	if(enemy.bonus.bDoubler && !enemyNull && !enemy.penalty.ploy){
		//if not panicked, add buffs as additional combat buff
		if(!enemy.penalty.panic){
			var tBoost = [0,0,0,0];
			var tString = "";
			if(!enemyStatNull[0]){
				tBoost[0] = Math.max(enemy.buffs.atk,enemy.combatBuffs.atk);
				if(tBoost[0] > 0){
					enemyEffAtk += tBoost[0];
					tString += "+" + tBoost[0] + " atk ";
				}
			}
			if(!enemyStatNull[1]){
				tBoost[1] = Math.max(enemy.buffs.spd,enemy.combatBuffs.spd);
				if(tBoost[1] > 0){
					enemyEffSpd += tBoost[1];
					tString += "+" + tBoost[1] + " spd ";
				}
			}
			if(!enemyStatNull[2]){
				tBoost[2] = Math.max(enemy.buffs.def,enemy.combatBuffs.def);
				if(tBoost[2] > 0){
					enemyEffDef += tBoost[2];
					tString += "+" + tBoost[2] + " def ";
				}
			}
			if(!enemyStatNull[3]){
				tBoost[3] = Math.max(enemy.buffs.res,enemy.combatBuffs.res);
				if(tBoost[3] > 0){
					enemyEffRes += tBoost[3];
					tString += "+" + tBoost[3] + " res ";
				}
			}
			if(tString != ""){
				fightText += enemy.name + " has gained an additional " + tString + "from Bonus Doubler (status).<br>";
			}
		}
	}
	if(attacker.bonus.fEmblem && (Object.values(attacker.buffs).reduce((a, b) => a + b, 0) > 0 || Object.values(attacker.combatBuffs).reduce((a, b) => a + b, 0) > 0 || (Object.values(attacker.buddy.buffs).reduce((a, b) => a + b, 0) > 0 && attacker.buddy.adjacent + attacker.buddy.two > 0))){
		var tBoost = [0,0,0,0];
		if(!attacker.penalty.panic){
			if(!attackerStatNull[0]){
				tBoost[0] = Math.max(attacker.buffs.atk,attacker.combatBuffs.atk);
			}
			if(!attackerStatNull[1]){
				tBoost[1] = Math.max(attacker.buffs.spd,attacker.combatBuffs.spd);
			}
			if(!attackerStatNull[2]){
				tBoost[2] = Math.max(attacker.buffs.def,attacker.combatBuffs.def);
			}
			if(!attackerStatNull[3]){
				tBoost[3] = Math.max(attacker.buffs.res,attacker.combatBuffs.res);
			}
		}
		if(attacker.buddy.adjacent + attacker.buddy.two > 0){
			tBoost[0] = Math.max(tBoost[0],attacker.buddy.buffs.atk);
			tBoost[1] = Math.max(tBoost[1],attacker.buddy.buffs.spd);
			tBoost[2] = Math.max(tBoost[2],attacker.buddy.buffs.def);
			tBoost[3] = Math.max(tBoost[3],attacker.buddy.buffs.res);
		}
		attackerEffAtk += tBoost[0];
		attackerEffSpd += tBoost[1];
		attackerEffDef += tBoost[2];
		attackerEffRes += tBoost[3];
		fightText += attacker.name + " has gained an additional +" + tBoost[0] + " atk/+" + tBoost[1] + " spd/+" + tBoost[2] + " def/+" + tBoost[3] + " res from [Fire Emblem].<br>";
	}
	if(enemy.bonus.fEmblem && (Object.values(enemy.buffs).reduce((a, b) => a + b, 0) > 0 || Object.values(enemy.combatBuffs).reduce((a, b) => a + b, 0) > 0 || (Object.values(enemy.buddy.buffs).reduce((a, b) => a + b, 0) > 0 && enemy.buddy.adjacent + enemy.buddy.two > 0))){
		var tBoost = [0,0,0,0];
		if(!enemy.penalty.panic){
			if(!enemyStatNull[0]){
				tBoost[0] = Math.max(enemy.buffs.atk,enemy.combatBuffs.atk);
			}
			if(!enemyStatNull[1]){
				tBoost[1] = Math.max(enemy.buffs.spd,enemy.combatBuffs.spd);
			}
			if(!enemyStatNull[2]){
				tBoost[2] = Math.max(enemy.buffs.def,enemy.combatBuffs.def);
			}
			if(!enemyStatNull[3]){
				tBoost[3] = Math.max(enemy.buffs.res,enemy.combatBuffs.res);
			}
		}
		if(enemy.buddy.adjacent + enemy.buddy.two > 0){
			tBoost[0] = Math.max(tBoost[0],enemy.buddy.buffs.atk);
			tBoost[1] = Math.max(tBoost[1],enemy.buddy.buffs.spd);
			tBoost[2] = Math.max(tBoost[2],enemy.buddy.buffs.def);
			tBoost[3] = Math.max(tBoost[3],enemy.buddy.buffs.res);
		}
		enemyEffAtk += tBoost[0];
		enemyEffSpd += tBoost[1];
		enemyEffDef += tBoost[2];
		enemyEffRes += tBoost[3];
		fightText += enemy.name + " has gained an additional +" + tBoost[0] + " atk/+" + tBoost[1] + " spd/+" + tBoost[2] + " def/+" + tBoost[3] + " res from [Fire Emblem].<br>";
	}
	
	//Saizo's Star/Gloom Breath/Light of Dawn mechanic
	if(((attacker.hasExactly("Saizo's Star") || attacker.hasExactly("Gloom Breath")) && attacker.rValue == 5) || (attacker.hasExactly("Light of Dawn") && (attacker.rValue < 0 || (attacker.rValue > 0 && (enemy.combatStartHp / enemy.maxHp >= 0.75 || attacker.toggle.weapon == 1 || attacker.toggle.weapon == 3))))){
		var tBoost = [0,0,0,0];
		var tString = "";
		tBoost[0] -= Math.min(enemy.debuffs.atk,enemy.combatDebuffs.atk);
		tBoost[1] -= Math.min(enemy.debuffs.spd,enemy.combatDebuffs.spd);
		tBoost[2] -= Math.min(enemy.debuffs.def,enemy.combatDebuffs.def);
		tBoost[3] -= Math.min(enemy.debuffs.res,enemy.combatDebuffs.res);
		//if target is panicked, add reversed buffs as additional combat buff
		if(enemy.penalty.panic){
			tBoost[0] += Math.max(enemy.buffs.atk,enemy.combatBuffs.atk);
			tBoost[1] += Math.max(enemy.buffs.spd,enemy.combatBuffs.spd);
			tBoost[2] += Math.max(enemy.buffs.def,enemy.combatBuffs.def);
			tBoost[3] += Math.max(enemy.buffs.res,enemy.combatBuffs.res);
		}
		if(tBoost[0] > 0){
			attackerEffAtk += tBoost[0];
			tString += "+" + tBoost[0] + " atk ";
		}
		if(tBoost[1] > 0){
			attackerEffSpd += tBoost[1];
			tString += "+" + tBoost[1] + " spd ";
		}
		if(tBoost[2] > 0){
			attackerEffDef += tBoost[2];
			tString += "+" + tBoost[2] + " def ";
		}
		if(tBoost[3] > 0){
			attackerEffRes += tBoost[3];
			tString += "+" + tBoost[3] + " res ";
		}
		if(tString != ""){
			fightText += attacker.name + " has gained an additional " + tString + "from " + data.skills[attacker.weaponIndex].name + ".<br>";
		}
	}
	if(((enemy.hasExactly("Saizo's Star") || enemy.hasExactly("Gloom Breath")) && enemy.rValue == 5) || (enemy.hasExactly("Light of Dawn") && (enemy.rValue < 0 || (enemy.rValue > 0 && (attacker.combatStartHp / attacker.maxHp >= 0.75 || enemy.toggle.weapon == 1 || enemy.toggle.weapon == 3))))){
		var tBoost = [0,0,0,0];
		var tString = "";
		tBoost[0] -= Math.min(attacker.debuffs.atk,attacker.combatDebuffs.atk);
		tBoost[1] -= Math.min(attacker.debuffs.spd,attacker.combatDebuffs.spd);
		tBoost[2] -= Math.min(attacker.debuffs.def,attacker.combatDebuffs.def);
		tBoost[3] -= Math.min(attacker.debuffs.res,attacker.combatDebuffs.res);
		//if target is panicked, add reversed buffs as additional combat buff
		if(enemy.penalty.panic){
			tBoost[0] += Math.max(attacker.buffs.atk,attacker.combatBuffs.atk);
			tBoost[1] += Math.max(attacker.buffs.spd,attacker.combatBuffs.spd);
			tBoost[2] += Math.max(attacker.buffs.def,attacker.combatBuffs.def);
			tBoost[3] += Math.max(attacker.buffs.res,attacker.combatBuffs.res);
		}
		if(tBoost[0] > 0){
			enemyEffAtk += tBoost[0];
			tString += "+" + tBoost[0] + " atk ";
		}
		if(tBoost[1] > 0){
			enemyEffSpd += tBoost[1];
			tString += "+" + tBoost[1] + " spd ";
		}
		if(tBoost[2] > 0){
			enemyEffDef += tBoost[2];
			tString += "+" + tBoost[2] + " def ";
		}
		if(tBoost[3] > 0){
			enemyEffRes += tBoost[3];
			tString += "+" + tBoost[3] + " res ";
		}
		if(tString != ""){
			fightText += enemy.name + " has gained an additional " + tString + "from " + data.skills[enemy.weaponIndex].name + ".<br>";
		}
	}
	//Laegjarn's weapon boosts
	var statBonus = 0;
	if(attacker.hasExactly("Niu")){
		if(cleanCheck){
			if(!enemyStatNull[0]){
				statBonus += Math.max(enemy.buffs.atk,enemy.combatBuffs.atk);
			}
			if(!enemyStatNull[1]){
				statBonus += Math.max(enemy.buffs.spd,enemy.combatBuffs.spd);
			}
			if(!enemyStatNull[2]){
				statBonus += Math.max(enemy.buffs.def,enemy.combatBuffs.def);
			}
			if(!enemyStatNull[3]){
				statBonus += Math.max(enemy.buffs.res,enemy.combatBuffs.res);
			}
		}
		if(bladeCheck && attacker.rValue > 0){
			if(!attackerStatNull[0]){
				statBonus += Math.max(attacker.buffs.atk,attacker.combatBuffs.atk);
			}
			if(!attackerStatNull[1]){
				statBonus += Math.max(attacker.buffs.spd,attacker.combatBuffs.spd);
			}
			if(!attackerStatNull[2]){
				statBonus += Math.max(attacker.buffs.def,attacker.combatBuffs.def);
			}
			if(!attackerStatNull[3]){
				statBonus += Math.max(attacker.buffs.res,attacker.combatBuffs.res);
			}
		}
		if(attacker.rValue > 0){
			statBonus = Math.floor(statBonus * 0.4);
			statBonus = Math.min(statBonus,10);
		}
		else if(attacker.rValue < 0){
			statBonus = Math.floor(statBonus / 2);
		}
		attackerEffAtk += statBonus;
		attackerEffSpd += statBonus;
		attackerEffDef += statBonus;
		attackerEffRes += statBonus;
		if(statBonus > 0){
			fightText += attacker.name + " gains +" + statBonus + " bonus to all stats from " + data.skills[attacker.weaponIndex].name + ".<br>";
		}
		statBonus = 0;
	}
	else if(attacker.hasExactly("Flame of Muspell") && attacker.toggle.weapon == 1){
		if(cleanCheck){
			if(!enemyStatNull[0]){
				statBonus += Math.max(enemy.buffs.atk,enemy.combatBuffs.atk);
			}
			if(!enemyStatNull[1]){
				statBonus += Math.max(enemy.buffs.spd,enemy.combatBuffs.spd);
			}
			if(!enemyStatNull[2]){
				statBonus += Math.max(enemy.buffs.def,enemy.combatBuffs.def);
			}
			if(!enemyStatNull[3]){
				statBonus += Math.max(enemy.buffs.res,enemy.combatBuffs.res);
			}
		}
		if(bladeCheck){
			if(!attackerStatNull[0]){
				statBonus += Math.max(attacker.buffs.atk,attacker.combatBuffs.atk);
			}
			if(!attackerStatNull[1]){
				statBonus += Math.max(attacker.buffs.spd,attacker.combatBuffs.spd);
			}
			if(!attackerStatNull[2]){
				statBonus += Math.max(attacker.buffs.def,attacker.combatBuffs.def);
			}
			if(!attackerStatNull[3]){
				statBonus += Math.max(attacker.buffs.res,attacker.combatBuffs.res);
			}
		}
		statBonus = Math.floor(statBonus * 0.5);
		statBonus = Math.min(statBonus,12);
		attackerEffAtk += statBonus;
		attackerEffSpd += statBonus;
		attackerEffDef += statBonus;
		attackerEffRes += statBonus;
		if(statBonus > 0){
			fightText += attacker.name + " gains +" + statBonus + " bonus to all stats from " + data.skills[attacker.weaponIndex].name + ".<br>";
		}
		statBonus = 0;
	}
	else if(attacker.hasExactly("Worldsea Wave") && attacker.rValue == 5 && (attacker.initiator || attacker.toggle.weapon == 1)){
		if(cleanCheck){
			if(!enemyStatNull[0]){
				statBonus += Math.max(enemy.buffs.atk,enemy.combatBuffs.atk);
			}
			if(!enemyStatNull[1]){
				statBonus += Math.max(enemy.buffs.spd,enemy.combatBuffs.spd);
			}
			if(!enemyStatNull[2]){
				statBonus += Math.max(enemy.buffs.def,enemy.combatBuffs.def);
			}
			if(!enemyStatNull[3]){
				statBonus += Math.max(enemy.buffs.res,enemy.combatBuffs.res);
			}
		}
		if(bladeCheck){
			if(!attackerStatNull[0]){
				statBonus += Math.max(attacker.buffs.atk,attacker.combatBuffs.atk);
			}
			if(!attackerStatNull[1]){
				statBonus += Math.max(attacker.buffs.spd,attacker.combatBuffs.spd);
			}
			if(!attackerStatNull[2]){
				statBonus += Math.max(attacker.buffs.def,attacker.combatBuffs.def);
			}
			if(!attackerStatNull[3]){
				statBonus += Math.max(attacker.buffs.res,attacker.combatBuffs.res);
			}
		}
		statBonus = Math.floor(statBonus * 0.4);
		statBonus += 5;
		statBonus = Math.min(statBonus,10);
		attackerEffAtk += statBonus;
		attackerEffSpd += statBonus;
		if(statBonus > 0){
			fightText += attacker.name + " gains +" + statBonus + " bonus to atk and spd from " + data.skills[attacker.weaponIndex].name + ".<br>";
		}
		statBonus = 0;
	}
	if(enemy.hasExactly("Niu")){
		if(bladeCheck){
			if(!attackerStatNull[0]){
				statBonus += Math.max(attacker.buffs.atk,attacker.combatBuffs.atk);
			}
			if(!attackerStatNull[1]){
				statBonus += Math.max(attacker.buffs.spd,attacker.combatBuffs.spd);
			}
			if(!attackerStatNull[2]){
				statBonus += Math.max(attacker.buffs.def,attacker.combatBuffs.def);
			}
			if(!attackerStatNull[3]){
				statBonus += Math.max(attacker.buffs.res,attacker.combatBuffs.res);
			}
		}
		if(cleanCheck && enemy.rValue > 0){
			if(!enemyStatNull[0]){
				statBonus += Math.max(enemy.buffs.atk,enemy.combatBuffs.atk);
			}
			if(!enemyStatNull[1]){
				statBonus += Math.max(enemy.buffs.spd,enemy.combatBuffs.spd);
			}
			if(!enemyStatNull[2]){
				statBonus += Math.max(enemy.buffs.def,enemy.combatBuffs.def);
			}
			if(!enemyStatNull[3]){
				statBonus += Math.max(enemy.buffs.res,enemy.combatBuffs.res);
			}
		}
		if(enemy.rValue > 0){
			statBonus = Math.floor(statBonus * 0.4);
			statBonus = Math.min(statBonus,10);
		}
		else if(enemy.rValue < 0){
			statBonus = Math.floor(statBonus / 2);
		}
		enemyEffAtk += statBonus;
		enemyEffSpd += statBonus;
		enemyEffDef += statBonus;
		enemyEffRes += statBonus;
		if(statBonus > 0){
			fightText += enemy.name + " gains +" + statBonus + " bonus to all stats from " + data.skills[enemy.weaponIndex].name + ".<br>";
		}
		statBonus = 0;
	}
	else if(enemy.hasExactly("Flame of Muspell") && enemy.toggle.weapon == 1){
		if(bladeCheck){
			if(!attackerStatNull[0]){
				statBonus += Math.max(attacker.buffs.atk,attacker.combatBuffs.atk);
			}
			if(!attackerStatNull[1]){
				statBonus += Math.max(attacker.buffs.spd,attacker.combatBuffs.spd);
			}
			if(!attackerStatNull[2]){
				statBonus += Math.max(attacker.buffs.def,attacker.combatBuffs.def);
			}
			if(!attackerStatNull[3]){
				statBonus += Math.max(attacker.buffs.res,attacker.combatBuffs.res);
			}
		}
		if(cleanCheck){
			if(!enemyStatNull[0]){
				statBonus += Math.max(enemy.buffs.atk,enemy.combatBuffs.atk);
			}
			if(!enemyStatNull[1]){
				statBonus += Math.max(enemy.buffs.spd,enemy.combatBuffs.spd);
			}
			if(!enemyStatNull[2]){
				statBonus += Math.max(enemy.buffs.def,enemy.combatBuffs.def);
			}
			if(!enemyStatNull[3]){
				statBonus += Math.max(enemy.buffs.res,enemy.combatBuffs.res);
			}
		}
		statBonus = Math.floor(statBonus * 0.5);
		statBonus = Math.min(statBonus,12);
		enemyEffAtk += statBonus;
		enemyEffSpd += statBonus;
		enemyEffDef += statBonus;
		enemyEffRes += statBonus;
		if(statBonus > 0){
			fightText += enemy.name + " gains +" + statBonus + " bonus to all stats from " + data.skills[enemy.weaponIndex].name + ".<br>";
		}
		statBonus = 0;
	}
	else if(enemy.hasExactly("Worldsea Wave") && enemy.rValue == 5 && (enemy.initiator || enemy.toggle.weapon == 1)){
		if(bladeCheck){
			if(!attackerStatNull[0]){
				statBonus += Math.max(attacker.buffs.atk,attacker.combatBuffs.atk);
			}
			if(!attackerStatNull[1]){
				statBonus += Math.max(attacker.buffs.spd,attacker.combatBuffs.spd);
			}
			if(!attackerStatNull[2]){
				statBonus += Math.max(attacker.buffs.def,attacker.combatBuffs.def);
			}
			if(!attackerStatNull[3]){
				statBonus += Math.max(attacker.buffs.res,attacker.combatBuffs.res);
			}
		}
		if(cleanCheck){
			if(!enemyStatNull[0]){
				statBonus += Math.max(enemy.buffs.atk,enemy.combatBuffs.atk);
			}
			if(!enemyStatNull[1]){
				statBonus += Math.max(enemy.buffs.spd,enemy.combatBuffs.spd);
			}
			if(!enemyStatNull[2]){
				statBonus += Math.max(enemy.buffs.def,enemy.combatBuffs.def);
			}
			if(!enemyStatNull[3]){
				statBonus += Math.max(enemy.buffs.res,enemy.combatBuffs.res);
			}
		}
		statBonus = Math.floor(statBonus * 0.4);
		statBonus += 5;
		statBonus = Math.min(statBonus,10);
		enemyEffAtk += statBonus;
		enemyEffSpd += statBonus;
		if(statBonus > 0){
			fightText += enemy.name + " gains +" + statBonus + " bonus to atk and spd from " + data.skills[enemy.weaponIndex].name + ".<br>";
		}
		statBonus = 0;
	}
	
	//Cap visible stats to 99 as well as not allowing it to drop below 0
	attackerVisAtk = Math.max(0,attackerVisAtk);
	attackerVisSpd = Math.max(0,attackerVisSpd);
	attackerVisDef = Math.max(0,attackerVisDef);
	attackerVisRes = Math.max(0,attackerVisRes);
	attackerVisAtk = Math.min(99,attackerVisAtk);
	attackerVisSpd = Math.min(99,attackerVisSpd);
	attackerVisDef = Math.min(99,attackerVisDef);
	attackerVisRes = Math.min(99,attackerVisRes);
	enemyVisAtk = Math.max(0,enemyVisAtk);
	enemyVisSpd = Math.max(0,enemyVisSpd);
	enemyVisDef = Math.max(0,enemyVisDef);
	enemyVisRes = Math.max(0,enemyVisRes);
	enemyVisAtk = Math.min(99,enemyVisAtk);
	enemyVisSpd = Math.min(99,enemyVisSpd);
	enemyVisDef = Math.min(99,enemyVisDef);
	enemyVisRes = Math.min(99,enemyVisRes);
	
	//set stat to 0 if negative
	attackerEffAtk = Math.max(0,attackerEffAtk);
	attackerEffSpd = Math.max(0,attackerEffSpd);
	attackerEffDef = Math.max(0,attackerEffDef);
	attackerEffRes = Math.max(0,attackerEffRes);
	enemyEffAtk = Math.max(0,enemyEffAtk);
	enemyEffSpd = Math.max(0,enemyEffSpd);
	enemyEffDef = Math.max(0,enemyEffDef);
	enemyEffRes = Math.max(0,enemyEffRes);
	enemyAOEDef = Math.max(0,enemyAOEDef);
	enemyAOERes = Math.max(0,enemyAOERes);
	attackerAOEAtk = Math.max(0,attackerAOEAtk);
	
	var returnArray = [];
	returnArray.push(attackerEffAtk);
	returnArray.push(attackerEffSpd);
	returnArray.push(attackerEffDef);
	returnArray.push(attackerEffRes);
	returnArray.push(enemyEffAtk);
	returnArray.push(enemyEffSpd);
	returnArray.push(enemyEffDef);
	returnArray.push(enemyEffRes);
	returnArray.push(bladeCheck);
	returnArray.push(cleanCheck);
	returnArray.push(fightText);
	returnArray.push(enemyAOEDef);
	returnArray.push(enemyAOERes);
	returnArray.push(attackerAOEAtk);
	returnArray.push(attackerStatNull);
	returnArray.push(enemyStatNull);
	returnArray.push(attackerVisAtk);
	returnArray.push(attackerVisSpd);
	returnArray.push(attackerVisDef);
	returnArray.push(attackerVisRes);
	returnArray.push(enemyVisAtk);
	returnArray.push(enemyVisSpd);
	returnArray.push(enemyVisDef);
	returnArray.push(enemyVisRes);
	
	return returnArray;
}
//Function to check if a particular stat has a visible buff applied
//Return true if buff is there, false otherwise (includes negation skills)
function checkBuff(attacker, enemy, stat, turn){
	//attacker in this case refers to the unit you're actually checking the visible buff on
	//Stat order is atk,spd,def,res
	var sPos = 0;
	if(stat == "spd"){
		sPos = 1;
	}
	else if(stat == "def"){
		sPos = 2;
	}
	else if(stat == "res"){
		sPos = 3;
	}
	var allStats = getEffStats(attacker, enemy, turn);
	if(allStats[14][sPos] == true || (attacker.buffs[stat] == 0 && attacker.combatBuffs[stat] == 0)){
		return false;
	}
	else{
		return true;
	}
}
//Function to check if any visible buff is there at all, regardless of the stat
//Returns true if any buff exists, false otherwise (includes negation skills)
function checkAllBuffs(attacker, enemy, turn){
	//attacker in this case refers to the unit you're actually checking the visible buff on
	if(checkBuff(attacker, enemy, "atk", turn) || checkBuff(attacker, enemy, "spd", turn) || checkBuff(attacker, enemy, "def", turn) || checkBuff(attacker, enemy, "res", turn)){
		return true;
	}
	else{
		return false;
	}
}
//Function to toggle Duel Rules visibility
function toggleRules(){
	if($("#duel_rules_toggle").html() == "Hide"){
		$("#rules_other").hide();
		$("#rules_turnorder").hide();
		$("#duel_rules_toggle").html("Show");
		$("#frame_rules").height(33);
	}
	else if($("#duel_rules_toggle").html() == "Show"){
		$("#rules_other").show();
		$("#rules_turnorder").show();
		$("#duel_rules_toggle").html("Hide");
		$("#frame_rules").height(534);
	}
}
